import{P as je,r as We,R as He,_ as Gt,c as Ze,a as ds,t as ti,s as _i,m as w2,b as Fs,L as T2,d as ky,e as wg,C as Td,I as E2,f as C2,l as S2,i as jt,S as k2,F as M2,B as A2,u as e1,g as P2,h as t1,j as mo,k as I2,n as zh,o as ve,p as Nh,q as en,M as My,v as D2,N as Ay,w as lo,x as jh,y as i1,z as L2,A as R2,D as Py,E as ld,G as O2,H as z2}from"./main-Ciy2ASMr.js";const N2=n=>typeof n>"u"||n===null||n==="",cb=(n,e,t)=>(c,a,h)=>{const d=c[a];return t?new Error(`Property \`${a}\` on component \`${h}\` is using the \`requiredIf\` prop-validator combined with \`.isRequired\`. This is an invalid combination.`):typeof n!="function"?new Error("The `condition` argument passed to the `requiredIf` prop-validator was not a function."):typeof e!="function"?new Error("The `propType` argument passed to the `requiredIf` prop-validator was not a function."):n(c)&&N2(d)?new Error(`Invalid prop \`${a}\` supplied to \`${h}\`, this prop is conditionally required but has value \`${d}\`. The condition that made this prop required is: \`${n.toString()}\`.`):(je.checkPropTypes({[a]:e},c,"prop",h),null)};function Th(n,e){const t=cb(n,e,!1);return t.isRequired=cb(n,e,!0),t}function r1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:16,viewBox:"0 0 16 16",width:16,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M8 2a1 1 0 011 1v4h4a1 1 0 010 2H9v4a1 1 0 01-2 0V9H3a1 1 0 110-2h4V3a1 1 0 011-1z",fill:"currentColor",fillRule:"evenodd"}))}r1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function Iy(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M12 3a1 1 0 011 1v7h7a1 1 0 010 2h-7v7a1 1 0 01-2 0v-7H4a1 1 0 010-2h7V4a1 1 0 011-1z",fill:"currentColor",fillRule:"evenodd"}))}Iy.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function n1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M19 3a2 2 0 012 2v4h-1v10a2 2 0 01-2 2H6a2 2 0 01-2-2V9H3V5a2 2 0 012-2zm-1 6H6v10h12zm-4 3v2h-4v-2zm5-7H5v2h14z",fill:"currentColor"}))}n1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function s1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:16,viewBox:"0 0 16 16",width:16,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M9.284 2.589l.07.057 5 5 .011.013a.503.503 0 01.033.039l-.044-.052A.502.502 0 0114.5 8v.02a.503.503 0 01-.005.052L14.5 8a.502.502 0 01-.089.284l-.013.018a.503.503 0 01-.033.04l-.011.012-5 5a.5.5 0 01-.765-.638l.057-.07L12.793 8.5H2a.5.5 0 01-.09-.992L2 7.5h10.793L8.646 3.354a.5.5 0 01-.057-.638l.057-.07a.5.5 0 01.638-.057z",fill:"currentColor"}))}s1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function $f(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M13.613 5.21l.094.083 6 6a1 1 0 01.083 1.32l-.083.094-6 6a1 1 0 01-1.497-1.32l.083-.094L16.584 13H5a1 1 0 01-.117-1.993L5 11h11.586l-4.293-4.293a1 1 0 01-.083-1.32l.083-.094a1 1 0 011.32-.083z",fill:"currentColor"}))}$f.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function o1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:16,viewBox:"0 0 16 16",width:16,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M4.146 6.146a.5.5 0 01.638-.057l.07.057L8 9.293l3.146-3.147a.5.5 0 01.638-.057l.07.057a.5.5 0 01.057.638l-.057.07-3.5 3.5a.5.5 0 01-.638.057l-.07-.057-3.5-3.5a.5.5 0 010-.708z",fill:"currentColor"}))}o1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function a1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:16,viewBox:"0 0 16 16",width:16,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M9.146 4.146a.5.5 0 01.765.638l-.057.07L6.707 8l3.147 3.146a.5.5 0 01.057.638l-.057.07a.5.5 0 01-.638.057l-.07-.057-3.5-3.5a.5.5 0 01-.057-.638l.057-.07z",fill:"currentColor"}))}a1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function l1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:16,viewBox:"0 0 16 16",width:16,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M6.146 4.146a.5.5 0 01.638-.057l.07.057 3.5 3.5a.5.5 0 01.057.638l-.057.07-3.5 3.5a.5.5 0 01-.765-.638l.057-.07L9.293 8 6.146 4.854a.5.5 0 01-.057-.638z",fill:"currentColor"}))}l1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function c1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M20 5a1 1 0 010 2h-1v13a2 2 0 01-2 2H7a2 2 0 01-2-2V7H4a1 1 0 110-2zm-3 2H7v13h10zm-6 2v8h-1V9zm3 0v8h-1V9zm1-7v2H9V2z",fill:"currentColor"}))}c1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function h1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M20 14a1 1 0 01.993.883L21 15v3a3 3 0 01-2.824 2.995L18 21H6a3 3 0 01-2.995-2.824L3 18v-3a1 1 0 011.993-.117L5 15v3a1 1 0 00.883.993L6 19h12a1 1 0 00.993-.883L19 18v-3a1 1 0 011-1zM12 3a1 1 0 01.993.883L13 4v9.584l2.293-2.291a1 1 0 011.32-.083l.094.083a1 1 0 01.083 1.32l-.083.094-4 4a1 1 0 01-1.32.083l-.094-.083-4-4a1 1 0 011.32-1.497l.094.083L11 13.584V4a1 1 0 011-1z",fill:"currentColor"}))}h1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function u1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2zm0 2a8 8 0 100 16 8 8 0 000-16zm0 11a1 1 0 110 2 1 1 0 010-2zm1-8v6h-2V7z",fill:"currentColor"}))}u1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function d1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M11 3v2H5v14h14v-6h2v6a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2zm11-2a1 1 0 01.993.883L23 2v6a1 1 0 01-1.993.117L21 8V4.414l-7.293 7.293a1 1 0 01-1.497-1.32l.083-.094L19.584 3H16a1 1 0 01-.993-.883L15 2a1 1 0 01.883-.993L16 1z",fill:"currentColor"}))}d1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function p1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:16,viewBox:"0 0 16 16",width:16,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M3 7a1 1 0 110 2 1 1 0 010-2zm5 0a1 1 0 110 2 1 1 0 010-2zm5 0a1 1 0 110 2 1 1 0 010-2z",fill:"currentColor",fillRule:"evenodd"}))}p1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function f1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M20 7a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V9a2 2 0 012-2zM6 9H4v6h16V9h-2v3a1 1 0 01-2 0V9h-3v3a1 1 0 01-2 0V9H8v3a1 1 0 01-2 0z",fill:"currentColor"}))}f1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function Dy(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg",color:e,"data-test":t},We.createElement("path",{d:"M15 3l6 6v10a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2zm-.829 2H13v2a2 2 0 01-2 2H5v10h2v-4a2 2 0 012-2h6a2 2 0 012 2v4h2V9.829zM15 15H9v4h6zM11 5H5v2h6z",fill:"currentColor"}))}Dy.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};function m1(n){let{color:e,dataTest:t,ariaLabel:c}=n;return We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",color:e,"data-test":t},We.createElement("path",{fill:"currentColor",d:"M4 2v18h18v2H2V2h2zm18 10v6H6v-4l5-2 5 4 6-4zM6 3l5 3 5-2 6 4v2l-6 4-5-4-5 2V3z"}))}m1.propTypes={color:je.string,dataTest:je.string,ariaLabel:je.string};const Rs=["svg.jsx-4069423049{display:block;pointer-events:none;}",`svg.jsx-4069423049 .border.jsx-4069423049{fill:${Ze.grey800};}`,`svg.jsx-4069423049 .background.jsx-4069423049,svg.jsx-4069423049 .indeterminate.jsx-4069423049,svg.jsx-4069423049 .checkmark.jsx-4069423049{fill:${Ze.white};}`,`svg.checked.jsx-4069423049 .background.jsx-4069423049,svg.indeterminate.jsx-4069423049 .background.jsx-4069423049{fill:${Ze.teal500};}`,`svg.valid.jsx-4069423049 .background.jsx-4069423049{fill:${Ze.blue600};}`,`svg.warning.jsx-4069423049 .background.jsx-4069423049{fill:${Ze.yellow700};}`,`svg.error.jsx-4069423049 .background.jsx-4069423049{fill:${Ze.red500};}`,`svg.checked.jsx-4069423049 .border.jsx-4069423049,svg.indeterminate.jsx-4069423049 .border.jsx-4069423049{fill:${Ze.teal900};}`,"svg.jsx-4069423049:not(.checked) .checkmark.jsx-4069423049,svg.jsx-4069423049:not(.indeterminate) .indeterminate.jsx-4069423049{fill:none;}",`svg.jsx-4069423049:not(.checked):not(.indeterminate) .background.jsx-4069423049{fill:${Ze.white};}`];Rs.__hash="4069423049";function g1(n){let{className:e}=n;return He.createElement("svg",{viewBox:"0 0 18 18",xmlns:"http://www.w3.org/2000/svg",className:`jsx-${Rs.__hash} `+Gt.dynamic([["2753140462",[Ze.grey300,Ze.grey400,Ze.blue600,Ze.blue700,Ze.yellow700,Ze.yellow800,Ze.red500,Ze.red700]]])+" "+(e||"")},He.createElement("rect",{x:"0",y:"0",width:"18",height:"18",rx:"3",className:`jsx-${Rs.__hash} `+Gt.dynamic([["2753140462",[Ze.grey300,Ze.grey400,Ze.blue600,Ze.blue700,Ze.yellow700,Ze.yellow800,Ze.red500,Ze.red700]]])+" background"}),He.createElement("path",{d:"M15,0 C16.6568542,0 18,1.34314575 18,3 L18,15 C18,16.6568542 16.6568542,18 15,18 L3,18 C1.34314575,18 0,16.6568542 0,15 L0,3 C0,1.34314575 1.34314575,0 3,0 L15,0 Z M15,1 L3,1 C1.9456382,1 1.08183488,1.81587779 1.00548574,2.85073766 L1,3 L1,15 C1,16.0543618 1.81587779,16.9181651 2.85073766,16.9945143 L3,17 L15,17 C16.0543618,17 16.9181651,16.1841222 16.9945143,15.1492623 L17,15 L17,3 C17,1.9456382 16.1841222,1.08183488 15.1492623,1.00548574 L15,1 Z",className:`jsx-${Rs.__hash} `+Gt.dynamic([["2753140462",[Ze.grey300,Ze.grey400,Ze.blue600,Ze.blue700,Ze.yellow700,Ze.yellow800,Ze.red500,Ze.red700]]])+" border"}),He.createElement("path",{d:"M4.74451387,8.02852516 C4.39595738,8.11985643 4.12375034,8.39235188 4.03251575,8.74127768 C3.94128115,9.09020348 4.04521722,9.46125864 4.30437605,9.71182782 L7.29823844,12.7078028 C7.68753993,13.0973991 8.31859767,13.0973991 8.70789916,12.7078028 L13.695624,6.71585285 C13.9547828,6.46528367 14.0587189,6.09422851 13.9674843,5.74530271 C13.8762497,5.39637691 13.6040426,5.12388146 13.2554861,5.0325502 C12.9069296,4.94121893 12.5362672,5.04526513 12.2859632,5.30469855 L8.0030688,10.5910713 L5.71403676,8.30067351 C5.46373279,8.0412401 5.09307036,7.9371939 4.74451387,8.02852516 Z",className:`jsx-${Rs.__hash} `+Gt.dynamic([["2753140462",[Ze.grey300,Ze.grey400,Ze.blue600,Ze.blue700,Ze.yellow700,Ze.yellow800,Ze.red500,Ze.red700]]])+" checkmark"}),He.createElement("rect",{x:"4",y:"8",width:"10",height:"2",rx:"1",className:`jsx-${Rs.__hash} `+Gt.dynamic([["2753140462",[Ze.grey300,Ze.grey400,Ze.blue600,Ze.blue700,Ze.yellow700,Ze.yellow800,Ze.red500,Ze.red700]]])+" indeterminate"}),He.createElement(Gt,{id:Rs.__hash},Rs),He.createElement(Gt,{id:"2753140462",dynamic:[Ze.grey300,Ze.grey400,Ze.blue600,Ze.blue700,Ze.yellow700,Ze.yellow800,Ze.red500,Ze.red700]},["svg.__jsx-style-dynamic-selector{width:18px;height:18px;}",`svg.disabled.__jsx-style-dynamic-selector .background.__jsx-style-dynamic-selector{fill:${Ze.grey300};}`,`svg.disabled.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.grey400};}`,`svg.valid.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.blue600};}`,`svg.valid.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.valid.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.blue700};}`,`svg.warning.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.yellow700};}`,`svg.warning.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.warning.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.yellow800};}`,`svg.error.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.red500};}`,`svg.error.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.error.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.red700};}`]))}g1.propTypes={className:je.string};function y1(n){let{className:e}=n;return He.createElement("svg",{viewBox:"0 0 14 14",xmlns:"http://www.w3.org/2000/svg",className:`jsx-${Rs.__hash} `+Gt.dynamic([["86695588",[Ze.grey400,Ze.grey400,Ze.grey500,Ze.blue600,Ze.blue800,Ze.yellow700,Ze.yellow800,Ze.red500,Ze.red800]]])+" "+(e||"")},He.createElement("rect",{x:"0",y:"0",width:"14",height:"14",rx:"2",className:`jsx-${Rs.__hash} `+Gt.dynamic([["86695588",[Ze.grey400,Ze.grey400,Ze.grey500,Ze.blue600,Ze.blue800,Ze.yellow700,Ze.yellow800,Ze.red500,Ze.red800]]])+" background"}),He.createElement("path",{d:"M2,0 L12,0 C13.1045695,0 14,0.8954305 14,2 L14,12 C14,13.1045695 13.1045695,14 12,14 L2,14 C0.8954305,14 0,13.1045695 0,12 L0,2 C0,0.8954305 0.8954305,0 2,0 Z M2,1 C1.44771525,1 1,1.44771525 1,2 L1,12 C1,12.5522847 1.44771525,13 2,13 L12,13 C12.5522847,13 13,12.5522847 13,12 L13,2 C13,1.44771525 12.5522847,1 12,1 L2,1 Z",className:`jsx-${Rs.__hash} `+Gt.dynamic([["86695588",[Ze.grey400,Ze.grey400,Ze.grey500,Ze.blue600,Ze.blue800,Ze.yellow700,Ze.yellow800,Ze.red500,Ze.red800]]])+" border"}),He.createElement("path",{d:"M10.3520005,3.30015877 L5.54268293,8.03252726 L3.64634146,6.16652726 L2.28668615,7.5044281 L5.54310367,10.7010587 L11.7145993,4.628307 L10.3520005,3.30015877 Z M5.54268293,9.43547274 L5.61193184,9.36733181 L5.54226219,9.29894127 L5.47309681,9.367 L5.54268293,9.43547274 Z M10.6496329,4.41023392 L10.6495057,4.35652297 L10.5648412,4.35672356 L10.2854007,4.631693 L10.3553166,4.69984123 L10.6496329,4.41023392 Z M3.42891348,7.22439304 L3.35030905,7.22439304 L3.35034135,7.27820863 L3.64634146,7.56947274 L3.71331385,7.5035719 L3.42891348,7.22439304 Z",className:`jsx-${Rs.__hash} `+Gt.dynamic([["86695588",[Ze.grey400,Ze.grey400,Ze.grey500,Ze.blue600,Ze.blue800,Ze.yellow700,Ze.yellow800,Ze.red500,Ze.red800]]])+" checkmark"}),He.createElement("rect",{x:"3",y:"6",width:"8",height:"2",className:`jsx-${Rs.__hash} `+Gt.dynamic([["86695588",[Ze.grey400,Ze.grey400,Ze.grey500,Ze.blue600,Ze.blue800,Ze.yellow700,Ze.yellow800,Ze.red500,Ze.red800]]])+" indeterminate"}),He.createElement(Gt,{id:Rs.__hash},Rs),He.createElement(Gt,{id:"86695588",dynamic:[Ze.grey400,Ze.grey400,Ze.grey500,Ze.blue600,Ze.blue800,Ze.yellow700,Ze.yellow800,Ze.red500,Ze.red800]},["svg.__jsx-style-dynamic-selector{width:14px;height:14px;}",`svg.disabled.__jsx-style-dynamic-selector .background.__jsx-style-dynamic-selector{fill:${Ze.grey400};}`,`svg.disabled.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.grey400};}`,`svg.disabled.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.disabled.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.grey500};}`,`svg.valid.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.blue600};}`,`svg.valid.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.valid.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.blue800};}`,`svg.warning.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.yellow700};}`,`svg.warning.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.warning.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.yellow800};}`,`svg.error.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.red500};}`,`svg.error.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.error.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${Ze.red800};}`]))}y1.propTypes={className:je.string};function _h(n,e,t){return(e=j2(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function j2(n){var e=B2(n,"string");return typeof e=="symbol"?e:e+""}function B2(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var c=t.call(n,e||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Gf extends We.Component{constructor(){super(...arguments),_h(this,"ref",We.createRef()),_h(this,"handleChange",e=>{this.props.onChange&&this.props.onChange(this.createHandlerPayload(),e)}),_h(this,"handleBlur",e=>{this.props.onBlur&&this.props.onBlur(this.createHandlerPayload(),e)}),_h(this,"handleFocus",e=>{this.props.onFocus&&this.props.onFocus(this.createHandlerPayload(),e)}),_h(this,"handleKeyDown",e=>{this.props.onKeyDown&&this.props.onKeyDown(this.createHandlerPayload(),e)})}componentDidMount(){this.props.initialFocus&&this.ref.current.focus(),this.setIndeterminate(this.props.indeterminate)}componentDidUpdate(e){e.indeterminate!==this.props.indeterminate&&this.setIndeterminate(this.props.indeterminate)}setIndeterminate(e){this.ref.current.indeterminate=e}createHandlerPayload(){return{value:this.props.value,name:this.props.name,checked:!this.props.checked}}render(){const{checked:e=!1,indeterminate:t=!1,className:c,disabled:a,error:h,label:d,name:s,tabIndex:f,valid:b,value:x,warning:v,dense:g,dataTest:P="dhis2-uicore-checkbox"}=this.props,_=ds({checked:e,indeterminate:t,disabled:a,valid:b,error:h,warning:v});return He.createElement("label",{"data-test":P,className:Gt.dynamic([["1252368010",[Ze.grey900,ti.disabled,_i.dp4,ti.focus]]])+" "+(ds(c,{disabled:a,dense:g})||"")},He.createElement("input",{type:"checkbox",ref:this.ref,name:s,value:x,checked:e,disabled:a,tabIndex:f,onChange:this.handleChange,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur,className:Gt.dynamic([["1252368010",[Ze.grey900,ti.disabled,_i.dp4,ti.focus]]])}),He.createElement("div",{className:Gt.dynamic([["1252368010",[Ze.grey900,ti.disabled,_i.dp4,ti.focus]]])+" "+(ds("icon",{dense:g})||"")},g?He.createElement(y1,{className:_}):He.createElement(g1,{className:_})),d,He.createElement(Gt,{id:"1252368010",dynamic:[Ze.grey900,ti.disabled,_i.dp4,ti.focus]},[`label.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:relative;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;cursor:pointer;color:${Ze.grey900};font-size:14px;line-height:19px;}`,"label.dense.__jsx-style-dynamic-selector{font-size:14px;line-height:16px;}",`label.disabled.__jsx-style-dynamic-selector{cursor:not-allowed;color:${ti.disabled};}`,"input.__jsx-style-dynamic-selector{opacity:0;position:absolute;height:18px;width:18px;inset-inline-start:3px;}","label.dense.__jsx-style-dynamic-selector input.__jsx-style-dynamic-selector{height:14px;width:14px;}",`.icon.__jsx-style-dynamic-selector{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-inline-end:${_i.dp4};border:2px solid transparent;padding:1px;border-radius:5px;}`,"label.dense.__jsx-style-dynamic-selector .icon.__jsx-style-dynamic-selector{margin-inline-end:3px;border-radius:4px;}",`input.__jsx-style-dynamic-selector:focus+.icon.__jsx-style-dynamic-selector{outline:3px solid ${ti.focus};outline-offset:-3px;}`]))}}_h(Gf,"defaultProps",{checked:!1,indeterminate:!1,dataTest:"dhis2-uicore-checkbox"});const hb=w2(["checked","indeterminate"],je.bool);Gf.propTypes={checked:hb,className:je.string,dataTest:je.string,dense:je.bool,disabled:je.bool,error:Fs,indeterminate:hb,initialFocus:je.bool,label:je.node,name:je.string,tabIndex:je.string,valid:Fs,value:je.string,warning:Fs,onBlur:je.func,onChange:je.func,onFocus:je.func,onKeyDown:je.func};var F2=void 0;const U2=(n,e,t)=>{let c;return function(){for(var a=arguments.length,h=new Array(a),d=0;d<a;d++)h[d]=arguments[d];const s=F2,f=()=>{c=null,n.apply(s,h)};clearTimeout(c),c=setTimeout(f,e)}},x1=n=>{let{dataTest:e,onToggle:t,children:c,tabIndex:a="0",error:h,warning:d,valid:s,disabled:f,dense:b,className:x,inputRef:v}=n;const g=ds(x,"root",{error:h,warning:d,valid:s,disabled:f,dense:b});return He.createElement("div",{onClick:t,tabIndex:a,ref:v,"data-test":e,className:Gt.dynamic([["1568723238",[Ze.grey500,ti.focus,ti.focus,ti.valid,ti.warning,ti.error,Ze.grey100,Ze.grey500,ti.disabled]]])+" "+(g||"")},He.createElement("div",{className:Gt.dynamic([["1568723238",[Ze.grey500,ti.focus,ti.focus,ti.valid,ti.warning,ti.error,Ze.grey100,Ze.grey500,ti.disabled]]])+" root-children"},c),He.createElement("div",{className:Gt.dynamic([["1568723238",[Ze.grey500,ti.focus,ti.focus,ti.valid,ti.warning,ti.error,Ze.grey100,Ze.grey500,ti.disabled]]])+" root-right"},He.createElement(o1,null)),He.createElement(Gt,{id:"1568723238",dynamic:[Ze.grey500,ti.focus,ti.focus,ti.valid,ti.warning,ti.error,Ze.grey100,Ze.grey500,ti.disabled]},[`.root.__jsx-style-dynamic-selector{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:white;border-radius:3px;border:1px solid ${Ze.grey500};box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:40px;padding-block:6px;padding-inline:12px;box-shadow:inset 0 0 1px 0 rgba(48,54,60,0.1);}`,`.root.__jsx-style-dynamic-selector:not(.disabled):focus,.root.__jsx-style-dynamic-selector:not(.disabled):active{outline:none;box-shadow:inset 0 0 0 2px ${ti.focus};border-color:${ti.focus};}`,`.root.valid.__jsx-style-dynamic-selector{border-color:${ti.valid};}`,`.root.warning.__jsx-style-dynamic-selector{border-color:${ti.warning};}`,`.root.error.__jsx-style-dynamic-selector{border-color:${ti.error};}`,`.root.disabled.__jsx-style-dynamic-selector{background-color:${Ze.grey100};border-color:${Ze.grey500};color:${ti.disabled};cursor:not-allowed;}`,".root.dense.__jsx-style-dynamic-selector{padding-block:2px;padding-inline:8px;min-height:32px;}",".root-children.__jsx-style-dynamic-selector{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}",".root-right.__jsx-style-dynamic-selector{margin-block-start:4px;margin-inline-start:8px;}"]))};x1.propTypes={dataTest:je.string.isRequired,inputRef:je.object.isRequired,onToggle:je.func.isRequired,children:je.element,className:je.string,dense:je.bool,disabled:je.bool,error:Fs,tabIndex:je.string,valid:Fs,warning:Fs};const b1=n=>{let{children:e,dataTest:t,maxHeight:c="280px",menuWidth:a,onClick:h,selectRef:d}=n;return He.createElement(T2,{onBackdropClick:h,transparent:!0},He.createElement(ky,{reference:d,placement:"bottom-start",observeReferenceResize:!0},He.createElement("div",{"data-test":`${t}-menuwrapper`,className:Gt.dynamic([["1363246346",[a,c,Ze.white,Ze.grey200,wg.e300]]])},e,He.createElement(Gt,{id:"1363246346",dynamic:[a,c,Ze.white,Ze.grey200,wg.e300]},[`div.__jsx-style-dynamic-selector{width:${a};height:auto;max-height:${c};overflow:auto;background:${Ze.white};border:1px solid ${Ze.grey200};border-radius:3px;box-shadow:${wg.e300};}`]))))};b1.propTypes={dataTest:je.string.isRequired,menuWidth:je.string.isRequired,selectRef:je.object.isRequired,children:je.node,maxHeight:je.string,onClick:je.func};function _o(n,e,t){return(e=$2(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $2(n){var e=G2(n,"string");return typeof e=="symbol"?e:e+""}function G2(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var c=t.call(n,e||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const V2=27,H2=32,W2=38,Y2=40;class Ly extends We.Component{constructor(){super(...arguments),_o(this,"state",{open:!1,menuWidth:"auto"}),_o(this,"selectRef",He.createRef()),_o(this,"inputRef",He.createRef()),_o(this,"onResize",U2(()=>{const e=this.getMenuWidth();this.state.menuWidth!==e&&this.setState({menuWidth:e})},50)),_o(this,"handleFocusInput",()=>{this.inputRef.current.focus()}),_o(this,"onFocus",e=>{const{onFocus:t,disabled:c,selected:a}=this.props;c||!t||t({selected:a},e)}),_o(this,"handleOpen",()=>{this.setState({open:!0,menuWidth:this.getMenuWidth()})}),_o(this,"handleClose",()=>{this.setState({open:!1})}),_o(this,"onToggle",e=>{this.props.disabled||(e.stopPropagation(),this.state.open?this.handleClose():this.handleOpen())}),_o(this,"onOutsideClick",e=>{const{onBlur:t,disabled:c,selected:a}=this.props;c||(this.handleClose(),t&&t({selected:a},e))}),_o(this,"onKeyDown",e=>{const{onKeyDown:t,disabled:c,selected:a}=this.props;if(c||(t&&t({selected:a},e),e.defaultPrevented))return;e.stopPropagation();const{open:h}=this.state,{keyCode:d}=e,s=!h&&(d===H2||d===W2||d===Y2);if(h&&d===V2)return this.handleClose();if(s)return this.handleOpen()})}componentDidMount(){this.props.initialFocus&&this.inputRef.current.focus(),this.setState({menuWidth:this.getMenuWidth()}),window.addEventListener("resize",this.onResize)}componentWillUnmount(){window.removeEventListener("resize",this.onResize)}getMenuWidth(){const{offsetWidth:e}=this.inputRef.current,{menuWidth:t}=this.state;return e&&`${e}px`!==t?`${e}px`:t}render(){const{open:e,menuWidth:t}=this.state,{children:c,className:a,selected:h,onChange:d,tabIndex:s,maxHeight:f,error:b,warning:x,valid:v,disabled:g,dense:P,dataTest:_}=this.props,S={selected:h,onChange:d,options:c,disabled:g},k=He.cloneElement(this.props.input,S),A={selected:h,onChange:d,options:c,handleClose:this.handleClose,handleFocusInput:this.handleFocusInput},y=He.cloneElement(this.props.menu,A);return He.createElement("div",{className:a,ref:this.selectRef,onFocus:this.onFocus,onKeyDown:this.onKeyDown,"data-test":_},He.createElement(x1,{onToggle:this.onToggle,inputRef:this.inputRef,tabIndex:g?"-1":s,error:b,warning:x,valid:v,disabled:g,dense:P,dataTest:`${_}-input`},k),e&&He.createElement(b1,{onClick:this.onOutsideClick,maxHeight:f,selectRef:this.selectRef,menuWidth:t,dataTest:`${_}-menu`},y))}}_o(Ly,"defaultProps",{dataTest:"dhis2-uicore-select"});Ly.propTypes={input:je.element.isRequired,menu:je.element.isRequired,selected:je.oneOfType([je.string,je.arrayOf(je.string)]).isRequired,children:je.node,className:je.string,dataTest:je.string,dense:je.bool,disabled:je.bool,error:Fs,initialFocus:je.bool,maxHeight:je.string,tabIndex:je.string,valid:Fs,warning:Fs,onBlur:je.func,onChange:je.func,onFocus:je.func,onKeyDown:je.func};const v1=n=>{let{message:e,className:t,dataTest:c}=n;return He.createElement("div",{"data-test":c,className:Gt.dynamic([["3603755746",[_i.dp16,Ze.grey700,ti.fonts,_i.dp8,_i.dp24]]])+" "+(ds(t,"container")||"")},He.createElement("div",{className:Gt.dynamic([["3603755746",[_i.dp16,Ze.grey700,ti.fonts,_i.dp8,_i.dp24]]])},He.createElement(Td,{small:!0})),e,He.createElement(Gt,{id:"3603755746",dynamic:[_i.dp16,Ze.grey700,ti.fonts,_i.dp8,_i.dp24]},[`.container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:${_i.dp16};-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;color:${Ze.grey700};font-family:${ti.fonts};font-size:13px;padding-block:${_i.dp8};padding-inline:${_i.dp24};}`]))};v1.propTypes={dataTest:je.string.isRequired,className:je.string,message:je.string};const Qg=n=>{let{value:e,onChange:t,placeholder:c,className:a,dataTest:h}=n;return He.createElement("div",{className:Gt.dynamic([["730881408",[Ze.white,_i.dp8,_i.dp8,_i.dp4,_i.dp8]]])+" "+(a||"")},He.createElement(E2,{dense:!0,dataTest:h,value:e,onChange:t,type:"text",name:"filter",placeholder:c,initialFocus:!0}),He.createElement(Gt,{id:"730881408",dynamic:[Ze.white,_i.dp8,_i.dp8,_i.dp4,_i.dp8]},[`div.__jsx-style-dynamic-selector{position:-webkit-sticky;position:sticky;-webkit-inset-block-start:0;-ms-intb-rlock-start:0;inset-block-start:0;background:${Ze.white};padding-block-start:${_i.dp8};padding-inline-end:${_i.dp8};padding-block-end:${_i.dp4};padding-inline-start:${_i.dp8};z-index:1;}`]))};Qg.propTypes={dataTest:je.string.isRequired,value:je.string.isRequired,className:je.string,placeholder:je.string,onChange:je.func};const _1=n=>{let{message:e,className:t}=n;return He.createElement("div",{className:Gt.dynamic([["3788156646",[Ze.grey700,ti.fonts,_i.dp8,_i.dp24]]])+" "+(t||"")},e,He.createElement(Gt,{id:"3788156646",dynamic:[Ze.grey700,ti.fonts,_i.dp8,_i.dp24]},[`div.__jsx-style-dynamic-selector{color:${Ze.grey700};font-family:${ti.fonts};font-size:13px;line-height:16px;padding-block:${_i.dp8};padding-inline:${_i.dp24};text-align:center;}`]))};_1.propTypes={message:je.string.isRequired,className:je.string};const w1=n=>n&&"props"in n&&"value"in n.props&&"label"in n.props,T1=n=>He.Children.toArray(n).filter(e=>e!==null&&e!==!1&&e!==void 0),q2=(n,e)=>He.Children.toArray(e).find(t=>t.props?n===t.props.value:!1);function yf(){return yf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var c in t)({}).hasOwnProperty.call(t,c)&&(n[c]=t[c])}return n},yf.apply(null,arguments)}function ub(n,e,t){return(e=X2(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function X2(n){var e=Z2(n,"string");return typeof e=="symbol"?e:e+""}function Z2(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var c=t.call(n,e||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let E1=class extends We.Component{constructor(){super(...arguments),ub(this,"state",{filter:""}),ub(this,"onFilterChange",e=>{let{value:t}=e;this.setState({filter:t})})}render(){const{dataTest:e,options:t,onChange:c,selected:a,empty:h,handleClose:d,handleFocusInput:s,placeholder:f,noMatchText:b,Menu:x}=this.props,{filter:v}=this.state,g={onChange:c,selected:a,empty:h,handleClose:d,handleFocusInput:s,dataTest:e},P=T1(t);if(He.Children.count(P)===0||!v)return He.createElement(He.Fragment,null,He.createElement(Qg,{dataTest:`${e}-filterinput`,placeholder:f,value:v,onChange:this.onFilterChange}),He.createElement(x,yf({},g,{options:t})));const _=He.Children.map(t,k=>{if(!w1(k))return null;const{label:y}=k.props;return y.toLowerCase().includes(v.toLowerCase())?k:null}),S=He.Children.count(_)>0;return He.createElement(He.Fragment,null,He.createElement(Qg,{dataTest:`${e}-filterinput`,placeholder:f,value:v,onChange:this.onFilterChange}),S?He.createElement(x,yf({},g,{options:_})):He.createElement(_1,{message:b}))}};E1.propTypes={Menu:je.elementType.isRequired,dataTest:je.string.isRequired,noMatchText:je.string.isRequired,selected:je.oneOfType([je.string,je.arrayOf(je.string)]).isRequired,empty:je.node,handleClose:je.func,handleFocusInput:je.func,options:je.node,placeholder:je.string,onChange:je.func};const C1=n=>{let{message:e,className:t,dataTest:c}=n;return He.createElement("div",{"data-test":c,className:Gt.dynamic([["3788156646",[Ze.grey700,ti.fonts,_i.dp8,_i.dp24]]])+" "+(t||"")},e,He.createElement(Gt,{id:"3788156646",dynamic:[Ze.grey700,ti.fonts,_i.dp8,_i.dp24]},[`div.__jsx-style-dynamic-selector{color:${Ze.grey700};font-family:${ti.fonts};font-size:13px;line-height:16px;padding-block:${_i.dp8};padding-inline:${_i.dp24};text-align:center;}`]))};C1.propTypes={dataTest:je.string.isRequired,message:je.string.isRequired,className:je.string};const K2=4,db={styles:He.createElement(Gt,{id:"1892168270"},[`.jsx-1892168270{z-index:${S2.applicationTop};}`,'div[data-popper-reference-hidden="true"].jsx-1892168270{visibility:hidden;}']),className:"jsx-1892168270"},Q2={name:"offset",options:{offset:[0,K2]}},J2={name:"hide"},eC={name:"flip",options:{altBoundary:!0}},Vf=n=>{let{children:e,className:t,closeDelay:c=200,content:a,dataTest:h="dhis2-uicore-tooltip",maxWidth:d=300,openDelay:s=200,placement:f="top"}=n;const[b,x]=We.useState(!1),v=We.useRef(),g=We.useRef(null),P=We.useRef(null),_=()=>{clearTimeout(P.current),g.current=setTimeout(()=>{x(!0)},s)},S=()=>{clearTimeout(g.current),P.current=setTimeout(()=>{x(!1)},c)},k=()=>{clearTimeout(P.current),g.current=setTimeout(()=>{x(!0)},s)},A=()=>{clearTimeout(g.current),P.current=setTimeout(()=>{x(!1)},c)},y=I=>{I.key==="Escape"&&(P.current=setTimeout(()=>{x(!1)},c))};return We.useEffect(()=>(document.addEventListener("keydown",y),()=>{clearTimeout(g.current),clearTimeout(P.current),document.removeEventListener("keydown",y)}),[]),He.createElement(He.Fragment,null,typeof e=="function"?e({onMouseOver:_,onMouseOut:S,onFocus:k,onBlur:A,ref:v}):He.createElement("span",{onMouseOver:_,onMouseOut:S,onFocus:k,onBlur:A,ref:v,tabIndex:0,"aria-describedby":b?"tooltipContenDhis2Ui":"","data-test":`${h}-reference`,className:Gt.dynamic([["3515683788",[d,Ze.grey900,Ze.white]]])},e),b&&He.createElement(C2,null,He.createElement(ky,{className:db.className,placement:f,reference:v,modifiers:[Q2,eC,J2]},He.createElement("div",{id:"tooltipContenDhis2Ui",onMouseOver:_,onMouseOut:S,"data-test":`${h}-content`,role:"tooltip",className:Gt.dynamic([["3515683788",[d,Ze.grey900,Ze.white]]])+" "+(t||"")},a))),db.styles,He.createElement(Gt,{id:"3515683788",dynamic:[d,Ze.grey900,Ze.white]},[`div.__jsx-style-dynamic-selector{max-width:${d}px;}`,`div.__jsx-style-dynamic-selector{padding:4px 6px;background-color:${Ze.grey900};border-radius:3px;color:${Ze.white};font-size:13px;line-height:17px;}`]))};Vf.propTypes={children:je.oneOfType([je.node,je.func]),className:je.string,closeDelay:je.number,content:je.node,dataTest:je.string,maxWidth:je.number,openDelay:je.number,placement:je.oneOf(["top","right","bottom","left"])};const S1=n=>{let{onClear:e,clearText:t,className:c,dataTest:a}=n;return He.createElement(Vf,{openDelay:500,content:t},He.createElement("button",{"data-test":a,onClick:e,type:"button",className:Gt.dynamic([["2606883952",[Ze.grey500,Ze.grey800,Ze.grey200,ti.focus]]])+" "+(c||"")},He.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:Gt.dynamic([["2606883952",[Ze.grey500,Ze.grey800,Ze.grey200,ti.focus]]])},He.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16Zm3.536-5.879a1 1 0 1 1-1.415 1.414l-2.12-2.12-2.122 2.121a1 1 0 1 1-1.415-1.414L6.586 8 4.464 5.878A1 1 0 1 1 5.88 4.464L8 6.586l2.121-2.121a1 1 0 1 1 1.415 1.414L9.415 8l2.12 2.121Z",fill:"none",className:Gt.dynamic([["2606883952",[Ze.grey500,Ze.grey800,Ze.grey200,ti.focus]]])})),He.createElement(Gt,{id:"2606883952",dynamic:[Ze.grey500,Ze.grey800,Ze.grey200,ti.focus]},["button.__jsx-style-dynamic-selector{background:none;border:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;cursor:pointer;height:24px;width:24px;border-radius:3px;}",`button.__jsx-style-dynamic-selector svg.__jsx-style-dynamic-selector path.__jsx-style-dynamic-selector{fill:${Ze.grey500};}`,`button.__jsx-style-dynamic-selector:hover svg.__jsx-style-dynamic-selector path.__jsx-style-dynamic-selector{fill:${Ze.grey800};}`,`button.__jsx-style-dynamic-selector:hover{background:${Ze.grey200};}`,`button.__jsx-style-dynamic-selector:focus{outline:2px solid ${ti.focus};}`])))};S1.propTypes={clearText:je.string.isRequired,dataTest:je.string.isRequired,onClear:je.func.isRequired,className:je.string};const k1=n=>{let{placeholder:e,className:t,dataTest:c}=n;return e?He.createElement("div",{"data-test":c,className:Gt.dynamic([["1027033961",[Ze.grey600]]])+" "+(t||"")},e,He.createElement(Gt,{id:"1027033961",dynamic:[Ze.grey600]},[`div.__jsx-style-dynamic-selector{color:${Ze.grey600};-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}`])):null};k1.propTypes={dataTest:je.string.isRequired,className:je.string,placeholder:je.string};const M1=n=>{let{prefix:e,className:t,dataTest:c}=n;return e?He.createElement("div",{"data-test":c,className:Gt.dynamic([["1343055987",[Ze.grey600,_i.dp12]]])+" "+(t||"")},e,He.createElement(Gt,{id:"1343055987",dynamic:[Ze.grey600,_i.dp12]},[`div.__jsx-style-dynamic-selector{color:${Ze.grey600};padding-inline-end:${_i.dp12};font-size:14px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}`])):null};M1.propTypes={dataTest:je.string.isRequired,className:je.string,prefix:je.string};const tC="مسح",iC={Clear:tC,"No data found":"لم يتم إيجاد بيانات","Type to filter options":"اكتب لتصفية الخيارات","Loading options":"تحميل الخيارات","No options found":"لم يتم العثور على خيارات"},rC="مسح",nC={Clear:rC,"No data found":"","Type to filter options":"","Loading options":"","No options found":""},sC="پاککردنەوە",oC={Clear:sC,"No data found":"","Type to filter options":"","Loading options":"","No options found":""},aC="Vyčistit",lC={Clear:aC,"No data found":"Nenalezena žádná data","Type to filter options":"Zadáním filtrujete možnosti","Loading options":"Možnosti načítání","No options found":"Nenalezeny žádné možnosti"},cC="Clear",hC={Clear:cC,"No data found":"","Type to filter options":"","Loading options":"","No options found":""},uC="",dC={Clear:uC,"No data found":"","Type to filter options":"","Loading options":"","No options found":""},pC="Limpiar",fC={Clear:pC,"No data found":"Datos no encontrados","Type to filter options":"Escriba para filtrar opciones","Loading options":"Cargando las opciones","No options found":"No se ha encontrado ninguna opción"},mC="Limpiar",gC={Clear:mC,"No data found":"No se han encontrado datos","Type to filter options":"Escriba para filtrar opciones","Loading options":"Opciones de carga","No options found":"No se han encontrado opciones"},yC="Effacer",xC={Clear:yC,"No data found":"Aucune valeur trouvée","Type to filter options":"","Loading options":"Chargement des options","No options found":""},bC="Hapus",vC={Clear:bC,"No data found":"Tidak ada data yang ditemukan","Type to filter options":"Tipe opsi filter","Loading options":"Opsi mengunggah","No options found":"Opsi tidak tersedia"},_C="សម្អាត",wC={Clear:_C,"No data found":"មិនមានទិន្នន័យបង្ហាញ","Type to filter options":"វាយបញ្ចូលមុខងារដើម្បីច្រោះ","Loading options":"កំពុងទាញយកមុខងារ","No options found":"មិនមានមុខងារបង្ហាញ"},TC="ລຶບ",EC={Clear:TC,"No data found":"ບໍ່ພົບຂໍ້ມູນ","Type to filter options":"ປະເພດຕົວເລືອກການກອງ","Loading options":"ໂຫຼດຕົວເລືອກ","No options found":"ບໍ່ພົບຕົວເລືອກ"},CC="ရှင်းလင်းသည်",SC={Clear:CC,"No data found":"data မတွေ့ပါ။","Type to filter options":"","Loading options":"","No options found":""},kC="Fjern",MC={Clear:kC,"No data found":"Ingen data funnet","Type to filter options":"Skriv for å filtrere alternativer","Loading options":"Laster alternativer","No options found":"Ingen alternativer funnet"},AC="Duidelijk",PC={Clear:AC,"No data found":"Geen gegevens gevonden","Type to filter options":"Typ om opties te filteren","Loading options":"Laad opties","No options found":"Geen opties gevonden"},IC="پاک کردن",DC={Clear:IC,"No data found":"هیچ معلوماتی یافت نشد","Type to filter options":"","Loading options":"","No options found":""},LC="پاک یې کړئ",RC={Clear:LC,"No data found":"هېڅ ډاټا یا مالومات ونه موندل شول","Type to filter options":"","Loading options":"","No options found":""},OC="Limpar",zC={Clear:OC,"No data found":"Dado não encontrado","Type to filter options":"Tipo de opções de filtros","Loading options":"","No options found":""},NC="Limpar",jC={Clear:NC,"No data found":"Dado não encontrado","Type to filter options":"","Loading options":"","No options found":""},BC="Очистить",FC={Clear:BC,"No data found":"Данные не найдены","Type to filter options":"Начать печатать для фильтрации опций","Loading options":"Загрузка опций","No options found":"Опции не найдены"},UC="Klar",$C={Clear:UC,"No data found":"","Type to filter options":"","Loading options":"","No options found":""},GC="Hamós",VC={Clear:GC,"No data found":"","Type to filter options":"","Loading options":"","No options found":""},HC="Пок кардан",WC={Clear:HC,"No data found":"Ягон иттилоот ёфт нашуд","Type to filter options":"","Loading options":"","No options found":""},YC="Очистити",qC={Clear:YC,"No data found":"Даних не знайдено","Type to filter options":"Введіть параметри фільтра","Loading options":"Параметри завантаження","No options found":"Варіантів не знайдено"},XC="کلیئر",ZC={Clear:XC,"No data found":"کوئی ڈیٹا نہیں ملا","Type to filter options":"","Loading options":"","No options found":""},KC="Аниқ",QC={Clear:KC,"No data found":"Maʼlumotlar topilmadi","Type to filter options":"","Loading options":"","No options found":""},JC="Тозалаш",eS={Clear:JC,"No data found":"Маълумотлар топилмади","Type to filter options":"","Loading options":"Вариантлар юкланмоқда","No options found":""},tS="Аниқ",iS={Clear:tS,"No data found":"Maʼlumotlar topilmadi","Type to filter options":"","Loading options":"","No options found":""},rS="Xóa",nS={Clear:rS,"No data found":"Không tìm thấy dữ liệu","Type to filter options":"Nhập để lọc tùy chọn","Loading options":"","No options found":""},sS="清除",oS={Clear:sS,"No data found":"没有发现数据","Type to filter options":"键入过滤选项","Loading options":"加载选项","No options found":"没有找到选项"},aS="清除",lS={Clear:aS,"No data found":"没有数据被找到","Type to filter options":"","Loading options":"","No options found":""},Ir="default";jt.addResources("ar",Ir,iC);jt.addResources("ar_IQ",Ir,nC);jt.addResources("ckb",Ir,oC);jt.addResources("cs",Ir,lC);jt.addResources("da",Ir,hC);jt.addResources("en",Ir,dC);jt.addResources("es",Ir,fC);jt.addResources("es_419",Ir,gC);jt.addResources("fr",Ir,xC);jt.addResources("id",Ir,vC);jt.addResources("km",Ir,wC);jt.addResources("lo",Ir,EC);jt.addResources("my",Ir,SC);jt.addResources("nb",Ir,MC);jt.addResources("nl",Ir,PC);jt.addResources("prs",Ir,DC);jt.addResources("ps",Ir,RC);jt.addResources("pt",Ir,zC);jt.addResources("pt_BR",Ir,jC);jt.addResources("ru",Ir,FC);jt.addResources("sv",Ir,$C);jt.addResources("tet",Ir,VC);jt.addResources("tg",Ir,WC);jt.addResources("uk",Ir,qC);jt.addResources("ur",Ir,ZC);jt.addResources("uz_Latn",Ir,QC);jt.addResources("uz_UZ_Cyrl",Ir,eS);jt.addResources("uz_UZ_Latn",Ir,iS);jt.addResources("vi",Ir,nS);jt.addResources("zh",Ir,oS);jt.addResources("zh_CN",Ir,lS);const cS=(n,e)=>{e.stopPropagation(),e.preventDefault()},Ry=n=>{let{options:e,onChange:t,selected:c,empty:a="",handleFocusInput:h,handleClose:d,dataTest:s}=n;const f=T1(e);if(He.Children.count(f)===0)return typeof a=="string"?He.createElement(C1,{message:a,dataTest:`${s}-empty`}):a;const b=He.Children.map(e,x=>{if(!w1(x))return x;const{value:g,disabled:P}=x.props,_=g===c,S=(A,y)=>{const I={selected:g};y.stopPropagation(),t(I,y),d(),h()},k=_||P;return He.cloneElement(x,{...x.props,onClick:k?cS:S,active:_})});return He.createElement(He.Fragment,null,b)};Ry.propTypes={dataTest:je.string.isRequired,empty:je.node,handleClose:je.func,handleFocusInput:je.func,options:je.node,selected:je.string,onChange:je.func};const A1=n=>{let{dataTest:e,options:t,onChange:c,selected:a,empty:h,handleClose:d,handleFocusInput:s,placeholder:f,noMatchText:b}=n;return He.createElement(E1,{dataTest:e,options:t,onChange:c,selected:a,empty:h,handleClose:d,handleFocusInput:s,placeholder:f,noMatchText:b,Menu:Ry})};A1.propTypes={dataTest:je.string.isRequired,noMatchText:je.string.isRequired,empty:je.node,handleClose:je.func,handleFocusInput:je.func,options:je.node,placeholder:je.string,selected:je.string,onChange:je.func};const P1=n=>{let{options:e,selected:t,className:c}=n;const a=q2(t,e);if(!a){const s=`There is no option with the value: "${t}". Make sure that the value passed to the selected prop matches the value of an existing option.`;console.error(s)}const h=a&&a.props.icon,d=a?a.props.label:t;return He.createElement("div",{className:Gt.dynamic([["1914911415",[_i.dp8,_i.dp16,_i.dp16]]])+" "+(ds(c,"root")||"")},h&&He.createElement("div",{className:Gt.dynamic([["1914911415",[_i.dp8,_i.dp16,_i.dp16]]])+" root-icon"},h),d,He.createElement(Gt,{id:"1914911415",dynamic:[_i.dp8,_i.dp16,_i.dp16]},[".root.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}",`.root-icon.__jsx-style-dynamic-selector{margin-inline-end:${_i.dp8};width:${_i.dp16};height:${_i.dp16};overflow:hidden;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}`]))};P1.propTypes={className:je.string,options:je.node,selected:je.string};const I1=n=>{let{selected:e,onChange:t,clearable:c,clearText:a,placeholder:h,dataTest:d,prefix:s,options:f,className:b,disabled:x,inputMaxHeight:v="100px"}=n;const g=e&&typeof e=="string",P=_=>{const S={selected:""};_.stopPropagation(),t(S,_)};return He.createElement("div",{className:Gt.dynamic([["2186325794",[Ze.grey900]],["1331770409",[v]]])+" "+(ds("root",b)||"")},He.createElement(M1,{prefix:s,dataTest:`${d}-prefix`}),!g&&!s&&He.createElement(k1,{placeholder:h,dataTest:`${d}-placeholder`}),g&&He.createElement("div",{className:Gt.dynamic([["2186325794",[Ze.grey900]],["1331770409",[v]]])+" root-input"},He.createElement(P1,{selected:e,options:f})),g&&c&&!x&&He.createElement("div",{className:Gt.dynamic([["2186325794",[Ze.grey900]],["1331770409",[v]]])+" root-right"},He.createElement(S1,{onClear:P,clearText:a,dataTest:`${d}-clear`})),He.createElement(Gt,{id:"2186325794",dynamic:[Ze.grey900]},[`.root.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:${Ze.grey900};font-size:14px;line-height:16px;}`,".root-input.__jsx-style-dynamic-selector{overflow-y:auto;-webkit-flex:1;-ms-flex:1;flex:1;}",".root-right.__jsx-style-dynamic-selector{margin-inline-start:auto;}"]),He.createElement(Gt,{id:"1331770409",dynamic:[v]},[`.root-input.__jsx-style-dynamic-selector{max-height:${v};}`]))};I1.propTypes={dataTest:je.string.isRequired,className:je.string,clearText:Th(n=>n.clearable,je.string),clearable:je.bool,disabled:je.bool,inputMaxHeight:je.string,options:je.node,placeholder:je.string,prefix:je.string,selected:je.string,onChange:je.func};const D1=n=>{let{className:e,selected:t="",tabIndex:c,maxHeight:a,inputMaxHeight:h,onChange:d,onFocus:s,onKeyDown:f,onBlur:b,loading:x,error:v,warning:g,valid:P,disabled:_,children:S,clearable:k,clearText:A,filterable:y,filterPlaceholder:I,placeholder:D,prefix:w,empty:M,loadingText:z,noMatchText:Y,initialFocus:X,dense:Z,dataTest:j="dhis2-uicore-singleselect"}=n;const V=y?He.createElement(A1,{dataTest:j,empty:M,noMatchText:Y,placeholder:I}):He.createElement(Ry,{empty:M,dataTest:j});return He.createElement("div",{"data-test":j,className:Gt.dynamic([["2180377457",[_i.dp8]]])+" root"},He.createElement("div",{className:Gt.dynamic([["2180377457",[_i.dp8]]])+" root-input"},He.createElement(Ly,{className:e,selected:t,input:He.createElement(I1,{clearable:k,clearText:A,dataTest:j,placeholder:D,prefix:w,inputMaxHeight:h}),menu:V,tabIndex:c,maxHeight:a,onChange:d,onFocus:s,onKeyDown:f,onBlur:b,error:v,warning:g,valid:P,disabled:_,initialFocus:X,dense:Z},S,x&&He.createElement(v1,{message:z,dataTest:`${j}-loading`}))),He.createElement(k2,{error:v,valid:P,warning:g}),He.createElement(Gt,{id:"2180377457",dynamic:[_i.dp8]},[`.root.__jsx-style-dynamic-selector{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:${_i.dp8};}`,".root-input.__jsx-style-dynamic-selector{-webkit-flex:1;-ms-flex:1;flex:1;}"]))};D1.propTypes={children:je.node,className:je.string,clearText:Th(n=>n.clearable,je.string),clearable:je.bool,dataTest:je.string,dense:je.bool,disabled:je.bool,empty:je.node,error:Fs,filterPlaceholder:je.string,filterable:je.bool,initialFocus:je.bool,inputMaxHeight:je.string,loading:je.bool,loadingText:je.string,maxHeight:je.string,noMatchText:Th(n=>n.filterable,je.string),placeholder:je.string,prefix:je.string,selected:je.string,tabIndex:je.string,valid:Fs,warning:Fs,onBlur:je.func,onChange:je.func,onFocus:je.func,onKeyDown:je.func};function hS(n,e,t){return(e=uS(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function uS(n){var e=dS(n,"string");return typeof e=="symbol"?e:e+""}function dS(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var c=t.call(n,e||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Yu=(n,e)=>typeof n=="function"?n(e):n;class Os extends He.Component{render(){const{className:e,onChange:t,onFocus:c,onKeyDown:a,onBlur:h,required:d,label:s,valid:f,error:b,warning:x,disabled:v,loading:g,selected:P=Os.defaultProps.selected,tabIndex:_,helpText:S,validationText:k,maxHeight:A,inputMaxHeight:y,inputWidth:I,children:D,clearable:w,clearText:M=Os.defaultProps.clearText,filterable:z,filterPlaceholder:Y=Os.defaultProps.filterPlaceholder,placeholder:X,prefix:Z,empty:j=Os.defaultProps.empty,loadingText:V=Os.defaultProps.loadingText,noMatchText:$=Os.defaultProps.noMatchText,initialFocus:R,dense:L,dataTest:G=Os.defaultProps.dataTest}=this.props;return He.createElement(M2,{className:e,dataTest:G,disabled:v,required:d,label:s,helpText:S,validationText:k,error:b,warning:x,valid:f},He.createElement(A2,{width:I,minWidth:"100px"},He.createElement(D1,{selected:P,tabIndex:_,maxHeight:A,inputMaxHeight:y,onChange:t,onFocus:c,onKeyDown:a,onBlur:h,loading:g,error:b,warning:x,valid:f,disabled:v,clearable:w,clearText:Yu(M),filterable:z,filterPlaceholder:Yu(Y),placeholder:X,prefix:Z,empty:Yu(j),loadingText:Yu(V),noMatchText:Yu($),initialFocus:R,dense:L},D)))}}hS(Os,"defaultProps",{dataTest:"dhis2-uiwidgets-singleselectfield",selected:"",clearText:()=>jt.t("Clear"),empty:()=>jt.t("No data found"),filterPlaceholder:()=>jt.t("Type to filter options"),loadingText:()=>jt.t("Loading options"),noMatchText:()=>jt.t("No options found")});Os.propTypes={children:je.node,className:je.string,clearText:je.oneOfType([je.string,je.func]),clearable:je.bool,dataTest:je.string,dense:je.bool,disabled:je.bool,empty:je.oneOfType([je.node,je.func]),error:Fs,filterPlaceholder:je.oneOfType([je.node,je.func]),filterable:je.bool,helpText:je.string,initialFocus:je.bool,inputMaxHeight:je.string,inputWidth:je.string,label:je.string,loading:je.bool,loadingText:je.oneOfType([je.string,je.func]),maxHeight:je.string,noMatchText:je.oneOfType([je.string,je.func]),placeholder:je.string,prefix:je.string,required:je.bool,selected:je.string,tabIndex:je.string,valid:Fs,validationText:je.string,warning:Fs,onBlur:je.func,onChange:je.func,onFocus:je.func,onKeyDown:je.func};const yc=n=>{let{label:e,active:t,disabled:c,onClick:a,className:h,dataTest:d="dhis2-uicore-singleselectoption",value:s}=n;return He.createElement("div",{onClick:f=>a({},f),"data-test":d,"data-value":s,"data-label":e,className:Gt.dynamic([["3808134379",[Ze.grey900,_i.dp8,_i.dp12,Ze.grey200,Ze.teal700,Ze.white,Ze.grey500]]])+" "+(ds(h,{disabled:c,active:t})||"")},e,He.createElement(Gt,{id:"3808134379",dynamic:[Ze.grey900,_i.dp8,_i.dp12,Ze.grey200,Ze.teal700,Ze.white,Ze.grey500]},[`div.__jsx-style-dynamic-selector{cursor:pointer;font-size:14px;-webkit-text-decoration:none;text-decoration:none;color:${Ze.grey900};padding-block:${_i.dp8};padding-inline:${_i.dp12};}`,`div.__jsx-style-dynamic-selector:hover{background-color:${Ze.grey200};}`,`div.__jsx-style-dynamic-selector:active,div.active.__jsx-style-dynamic-selector{background-color:${Ze.teal700};color:${Ze.white};cursor:auto;}`,`div.disabled.__jsx-style-dynamic-selector{color:${Ze.grey500};cursor:not-allowed;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}`,"div.disabled.__jsx-style-dynamic-selector:hover{background-color:initial;}"]))};yc.propTypes={label:je.string.isRequired,value:je.string.isRequired,active:je.bool,className:je.string,dataTest:je.string,disabled:je.bool,onClick:je.func};class he extends Array{constructor(e,t){if(super(e),this.sign=t,Object.setPrototypeOf(this,he.prototype),e>he.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded")}static BigInt(e){var t=Math.floor,c=Number.isFinite;if(typeof e=="number"){if(e===0)return he.__zero();if(he.__isOneDigitInt(e))return 0>e?he.__oneDigit(-e,!0):he.__oneDigit(e,!1);if(!c(e)||t(e)!==e)throw new RangeError("The number "+e+" cannot be converted to BigInt because it is not an integer");return he.__fromDouble(e)}if(typeof e=="string"){const a=he.__fromString(e);if(a===null)throw new SyntaxError("Cannot convert "+e+" to a BigInt");return a}if(typeof e=="boolean")return e===!0?he.__oneDigit(1,!1):he.__zero();if(typeof e=="object"){if(e.constructor===he)return e;const a=he.__toPrimitive(e);return he.BigInt(a)}throw new TypeError("Cannot convert "+e+" to a BigInt")}toDebugString(){const e=["BigInt["];for(const t of this)e.push((t&&(t>>>0).toString(16))+", ");return e.push("]"),e.join("")}toString(e=10){if(2>e||36<e)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":e&e-1?he.__toStringGeneric(this,e,!1):he.__toStringBasePowerOfTwo(this,e)}valueOf(){throw new Error("Convert JSBI instances to native numbers using `toNumber`.")}static toNumber(e){const t=e.length;if(t===0)return 0;if(t===1){const k=e.__unsignedDigit(0);return e.sign?-k:k}const c=e.__digit(t-1),a=he.__clz30(c),h=30*t-a;if(1024<h)return e.sign?-1/0:1/0;let d=h-1,s=c,f=t-1;const b=a+3;let x=b===32?0:s<<b;x>>>=12;const v=b-12;let g=12<=b?0:s<<20+b,P=20+b;for(0<v&&0<f&&(f--,s=e.__digit(f),x|=s>>>30-v,g=s<<v+2,P=v+2);0<P&&0<f;)f--,s=e.__digit(f),g|=30<=P?s<<P-30:s>>>30-P,P-=30;const _=he.__decideRounding(e,P,f,s);if((_===1||_===0&&(1&g)==1)&&(g=g+1>>>0,g===0&&(x++,x>>>20!=0&&(x=0,d++,1023<d))))return e.sign?-1/0:1/0;const S=e.sign?-2147483648:0;return d=d+1023<<20,he.__kBitConversionInts[1]=S|d|x,he.__kBitConversionInts[0]=g,he.__kBitConversionDouble[0]}static unaryMinus(e){if(e.length===0)return e;const t=e.__copy();return t.sign=!e.sign,t}static bitwiseNot(e){return e.sign?he.__absoluteSubOne(e).__trim():he.__absoluteAddOne(e,!0)}static exponentiate(e,t){if(t.sign)throw new RangeError("Exponent must be positive");if(t.length===0)return he.__oneDigit(1,!1);if(e.length===0)return e;if(e.length===1&&e.__digit(0)===1)return e.sign&&!(1&t.__digit(0))?he.unaryMinus(e):e;if(1<t.length)throw new RangeError("BigInt too big");let c=t.__unsignedDigit(0);if(c===1)return e;if(c>=he.__kMaxLengthBits)throw new RangeError("BigInt too big");if(e.length===1&&e.__digit(0)===2){const d=1+(0|c/30),s=e.sign&&(1&c)!=0,f=new he(d,s);f.__initializeDigits();const b=1<<c%30;return f.__setDigit(d-1,b),f}let a=null,h=e;for(1&c&&(a=e),c>>=1;c!==0;c>>=1)h=he.multiply(h,h),1&c&&(a===null?a=h:a=he.multiply(a,h));return a}static multiply(e,t){if(e.length===0)return e;if(t.length===0)return t;let c=e.length+t.length;30<=e.__clzmsd()+t.__clzmsd()&&c--;const a=new he(c,e.sign!==t.sign);a.__initializeDigits();for(let h=0;h<e.length;h++)he.__multiplyAccumulate(t,e.__digit(h),a,h);return a.__trim()}static divide(e,t){if(t.length===0)throw new RangeError("Division by zero");if(0>he.__absoluteCompare(e,t))return he.__zero();const c=e.sign!==t.sign,a=t.__unsignedDigit(0);let h;if(t.length===1&&32767>=a){if(a===1)return c===e.sign?e:he.unaryMinus(e);h=he.__absoluteDivSmall(e,a,null)}else h=he.__absoluteDivLarge(e,t,!0,!1);return h.sign=c,h.__trim()}static remainder(e,t){if(t.length===0)throw new RangeError("Division by zero");if(0>he.__absoluteCompare(e,t))return e;const c=t.__unsignedDigit(0);if(t.length===1&&32767>=c){if(c===1)return he.__zero();const h=he.__absoluteModSmall(e,c);return h===0?he.__zero():he.__oneDigit(h,e.sign)}const a=he.__absoluteDivLarge(e,t,!1,!0);return a.sign=e.sign,a.__trim()}static add(e,t){const c=e.sign;return c===t.sign?he.__absoluteAdd(e,t,c):0<=he.__absoluteCompare(e,t)?he.__absoluteSub(e,t,c):he.__absoluteSub(t,e,!c)}static subtract(e,t){const c=e.sign;return c===t.sign?0<=he.__absoluteCompare(e,t)?he.__absoluteSub(e,t,c):he.__absoluteSub(t,e,!c):he.__absoluteAdd(e,t,c)}static leftShift(e,t){return t.length===0||e.length===0?e:t.sign?he.__rightShiftByAbsolute(e,t):he.__leftShiftByAbsolute(e,t)}static signedRightShift(e,t){return t.length===0||e.length===0?e:t.sign?he.__leftShiftByAbsolute(e,t):he.__rightShiftByAbsolute(e,t)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(e,t){return 0>he.__compareToBigInt(e,t)}static lessThanOrEqual(e,t){return 0>=he.__compareToBigInt(e,t)}static greaterThan(e,t){return 0<he.__compareToBigInt(e,t)}static greaterThanOrEqual(e,t){return 0<=he.__compareToBigInt(e,t)}static equal(e,t){if(e.sign!==t.sign||e.length!==t.length)return!1;for(let c=0;c<e.length;c++)if(e.__digit(c)!==t.__digit(c))return!1;return!0}static notEqual(e,t){return!he.equal(e,t)}static bitwiseAnd(e,t){var c=Math.max;if(!e.sign&&!t.sign)return he.__absoluteAnd(e,t).__trim();if(e.sign&&t.sign){const a=c(e.length,t.length)+1;let h=he.__absoluteSubOne(e,a);const d=he.__absoluteSubOne(t);return h=he.__absoluteOr(h,d,h),he.__absoluteAddOne(h,!0,h).__trim()}return e.sign&&([e,t]=[t,e]),he.__absoluteAndNot(e,he.__absoluteSubOne(t)).__trim()}static bitwiseXor(e,t){var c=Math.max;if(!e.sign&&!t.sign)return he.__absoluteXor(e,t).__trim();if(e.sign&&t.sign){const d=c(e.length,t.length),s=he.__absoluteSubOne(e,d),f=he.__absoluteSubOne(t);return he.__absoluteXor(s,f,s).__trim()}const a=c(e.length,t.length)+1;e.sign&&([e,t]=[t,e]);let h=he.__absoluteSubOne(t,a);return h=he.__absoluteXor(h,e,h),he.__absoluteAddOne(h,!0,h).__trim()}static bitwiseOr(e,t){var c=Math.max;const a=c(e.length,t.length);if(!e.sign&&!t.sign)return he.__absoluteOr(e,t).__trim();if(e.sign&&t.sign){let d=he.__absoluteSubOne(e,a);const s=he.__absoluteSubOne(t);return d=he.__absoluteAnd(d,s,d),he.__absoluteAddOne(d,!0,d).__trim()}e.sign&&([e,t]=[t,e]);let h=he.__absoluteSubOne(t,a);return h=he.__absoluteAndNot(h,e,h),he.__absoluteAddOne(h,!0,h).__trim()}static asIntN(e,t){var c=Math.floor;if(t.length===0)return t;if(e=c(e),0>e)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(e===0)return he.__zero();if(e>=he.__kMaxLengthBits)return t;const a=0|(e+29)/30;if(t.length<a)return t;const h=t.__unsignedDigit(a-1),d=1<<(e-1)%30;if(t.length===a&&h<d)return t;if((h&d)!==d)return he.__truncateToNBits(e,t);if(!t.sign)return he.__truncateAndSubFromPowerOfTwo(e,t,!0);if(!(h&d-1)){for(let s=a-2;0<=s;s--)if(t.__digit(s)!==0)return he.__truncateAndSubFromPowerOfTwo(e,t,!1);return t.length===a&&h===d?t:he.__truncateToNBits(e,t)}return he.__truncateAndSubFromPowerOfTwo(e,t,!1)}static asUintN(e,t){var c=Math.floor;if(t.length===0)return t;if(e=c(e),0>e)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(e===0)return he.__zero();if(t.sign){if(e>he.__kMaxLengthBits)throw new RangeError("BigInt too big");return he.__truncateAndSubFromPowerOfTwo(e,t,!1)}if(e>=he.__kMaxLengthBits)return t;const a=0|(e+29)/30;if(t.length<a)return t;const h=e%30;return t.length==a&&(h===0||!(t.__digit(a-1)>>>h))?t:he.__truncateToNBits(e,t)}static ADD(e,t){if(e=he.__toPrimitive(e),t=he.__toPrimitive(t),typeof e=="string")return typeof t!="string"&&(t=t.toString()),e+t;if(typeof t=="string")return e.toString()+t;if(e=he.__toNumeric(e),t=he.__toNumeric(t),he.__isBigInt(e)&&he.__isBigInt(t))return he.add(e,t);if(typeof e=="number"&&typeof t=="number")return e+t;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(e,t){return he.__compare(e,t,0)}static LE(e,t){return he.__compare(e,t,1)}static GT(e,t){return he.__compare(e,t,2)}static GE(e,t){return he.__compare(e,t,3)}static EQ(e,t){for(;;){if(he.__isBigInt(e))return he.__isBigInt(t)?he.equal(e,t):he.EQ(t,e);if(typeof e=="number"){if(he.__isBigInt(t))return he.__equalToNumber(t,e);if(typeof t!="object")return e==t;t=he.__toPrimitive(t)}else if(typeof e=="string"){if(he.__isBigInt(t))return e=he.__fromString(e),e!==null&&he.equal(e,t);if(typeof t!="object")return e==t;t=he.__toPrimitive(t)}else if(typeof e=="boolean"){if(he.__isBigInt(t))return he.__equalToNumber(t,+e);if(typeof t!="object")return e==t;t=he.__toPrimitive(t)}else if(typeof e=="symbol"){if(he.__isBigInt(t))return!1;if(typeof t!="object")return e==t;t=he.__toPrimitive(t)}else if(typeof e=="object"){if(typeof t=="object"&&t.constructor!==he)return e==t;e=he.__toPrimitive(e)}else return e==t}}static NE(e,t){return!he.EQ(e,t)}static DataViewGetBigInt64(e,t,c=!1){return he.asIntN(64,he.DataViewGetBigUint64(e,t,c))}static DataViewGetBigUint64(e,t,c=!1){const[a,h]=c?[4,0]:[0,4],d=e.getUint32(t+a,c),s=e.getUint32(t+h,c),f=new he(3,!1);return f.__setDigit(0,1073741823&s),f.__setDigit(1,(268435455&d)<<2|s>>>30),f.__setDigit(2,d>>>28),f.__trim()}static DataViewSetBigInt64(e,t,c,a=!1){he.DataViewSetBigUint64(e,t,c,a)}static DataViewSetBigUint64(e,t,c,a=!1){c=he.asUintN(64,c);let h=0,d=0;if(0<c.length&&(d=c.__digit(0),1<c.length)){const b=c.__digit(1);d|=b<<30,h=b>>>2,2<c.length&&(h|=c.__digit(2)<<28)}const[s,f]=a?[4,0]:[0,4];e.setUint32(t+s,h,a),e.setUint32(t+f,d,a)}static __zero(){return new he(0,!1)}static __oneDigit(e,t){const c=new he(1,t);return c.__setDigit(0,e),c}__copy(){const e=new he(this.length,this.sign);for(let t=0;t<this.length;t++)e[t]=this[t];return e}__trim(){let e=this.length,t=this[e-1];for(;t===0;)e--,t=this[e-1],this.pop();return e===0&&(this.sign=!1),this}__initializeDigits(){for(let e=0;e<this.length;e++)this[e]=0}static __decideRounding(e,t,c,a){if(0<t)return-1;let h;if(0>t)h=-t-1;else{if(c===0)return-1;c--,a=e.__digit(c),h=29}let d=1<<h;if(!(a&d))return-1;if(d-=1,(a&d)!=0)return 1;for(;0<c;)if(c--,e.__digit(c)!==0)return 1;return 0}static __fromDouble(e){he.__kBitConversionDouble[0]=e;const t=2047&he.__kBitConversionInts[1]>>>20,c=t-1023,a=(0|c/30)+1,h=new he(a,0>e);let d=1048575&he.__kBitConversionInts[1]|1048576,s=he.__kBitConversionInts[0];const f=20,b=c%30;let x,v=0;if(b<20){const g=f-b;v=g+32,x=d>>>g,d=d<<32-g|s>>>g,s<<=32-g}else if(b===20)v=32,x=d,d=s,s=0;else{const g=b-f;v=32-g,x=d<<g|s>>>32-g,d=s<<g,s=0}h.__setDigit(a-1,x);for(let g=a-2;0<=g;g--)0<v?(v-=30,x=d>>>2,d=d<<30|s>>>2,s<<=30):x=0,h.__setDigit(g,x);return h.__trim()}static __isWhitespace(e){return 13>=e&&9<=e||(159>=e?e==32:131071>=e?e==160||e==5760:196607>=e?(e&=131071,10>=e||e==40||e==41||e==47||e==95||e==4096):e==65279)}static __fromString(e,t=0){let c=0;const a=e.length;let h=0;if(h===a)return he.__zero();let d=e.charCodeAt(h);for(;he.__isWhitespace(d);){if(++h===a)return he.__zero();d=e.charCodeAt(h)}if(d===43){if(++h===a)return null;d=e.charCodeAt(h),c=1}else if(d===45){if(++h===a)return null;d=e.charCodeAt(h),c=-1}if(t===0){if(t=10,d===48){if(++h===a)return he.__zero();if(d=e.charCodeAt(h),d===88||d===120){if(t=16,++h===a)return null;d=e.charCodeAt(h)}else if(d===79||d===111){if(t=8,++h===a)return null;d=e.charCodeAt(h)}else if(d===66||d===98){if(t=2,++h===a)return null;d=e.charCodeAt(h)}}}else if(t===16&&d===48){if(++h===a)return he.__zero();if(d=e.charCodeAt(h),d===88||d===120){if(++h===a)return null;d=e.charCodeAt(h)}}if(c!=0&&t!==10)return null;for(;d===48;){if(++h===a)return he.__zero();d=e.charCodeAt(h)}const s=a-h;let f=he.__kMaxBitsPerChar[t],b=he.__kBitsPerCharTableMultiplier-1;if(s>1073741824/f)return null;const x=f*s+b>>>he.__kBitsPerCharTableShift,v=new he(0|(x+29)/30,!1),g=10>t?t:10,P=10<t?t-10:0;if(t&t-1){v.__initializeDigits();let _=!1,S=0;do{let k=0,A=1;for(;;){let I;if(d-48>>>0<g)I=d-48;else if((32|d)-97>>>0<P)I=(32|d)-87;else{_=!0;break}const D=A*t;if(1073741823<D)break;if(A=D,k=k*t+I,S++,++h===a){_=!0;break}d=e.charCodeAt(h)}b=30*he.__kBitsPerCharTableMultiplier-1;const y=0|(f*S+b>>>he.__kBitsPerCharTableShift)/30;v.__inplaceMultiplyAdd(A,k,y)}while(!_)}else{f>>=he.__kBitsPerCharTableShift;const _=[],S=[];let k=!1;do{let A=0,y=0;for(;;){let I;if(d-48>>>0<g)I=d-48;else if((32|d)-97>>>0<P)I=(32|d)-87;else{k=!0;break}if(y+=f,A=A<<f|I,++h===a){k=!0;break}if(d=e.charCodeAt(h),30<y+f)break}_.push(A),S.push(y)}while(!k);he.__fillFromParts(v,_,S)}if(h!==a){if(!he.__isWhitespace(d))return null;for(h++;h<a;h++)if(d=e.charCodeAt(h),!he.__isWhitespace(d))return null}return v.sign=c==-1,v.__trim()}static __fillFromParts(e,t,c){let a=0,h=0,d=0;for(let s=t.length-1;0<=s;s--){const f=t[s],b=c[s];h|=f<<d,d+=b,d===30?(e.__setDigit(a++,h),d=0,h=0):30<d&&(e.__setDigit(a++,1073741823&h),d-=30,h=f>>>b-d)}if(h!==0){if(a>=e.length)throw new Error("implementation bug");e.__setDigit(a++,h)}for(;a<e.length;a++)e.__setDigit(a,0)}static __toStringBasePowerOfTwo(e,t){const c=e.length;let a=t-1;a=(85&a>>>1)+(85&a),a=(51&a>>>2)+(51&a),a=(15&a>>>4)+(15&a);const h=a,d=t-1,s=e.__digit(c-1),f=he.__clz30(s);let b=0|(30*c-f+h-1)/h;if(e.sign&&b++,268435456<b)throw new Error("string too long");const x=Array(b);let v=b-1,g=0,P=0;for(let S=0;S<c-1;S++){const k=e.__digit(S),A=(g|k<<P)&d;x[v--]=he.__kConversionChars[A];const y=h-P;for(g=k>>>y,P=30-y;P>=h;)x[v--]=he.__kConversionChars[g&d],g>>>=h,P-=h}const _=(g|s<<P)&d;for(x[v--]=he.__kConversionChars[_],g=s>>>h-P;g!==0;)x[v--]=he.__kConversionChars[g&d],g>>>=h;if(e.sign&&(x[v--]="-"),v!=-1)throw new Error("implementation bug");return x.join("")}static __toStringGeneric(e,t,c){const a=e.length;if(a===0)return"";if(a===1){let S=e.__unsignedDigit(0).toString(t);return c===!1&&e.sign&&(S="-"+S),S}const h=30*a-he.__clz30(e.__digit(a-1)),d=he.__kMaxBitsPerChar[t],s=d-1;let f=h*he.__kBitsPerCharTableMultiplier;f+=s-1,f=0|f/s;const b=f+1>>1,x=he.exponentiate(he.__oneDigit(t,!1),he.__oneDigit(b,!1));let v,g;const P=x.__unsignedDigit(0);if(x.length===1&&32767>=P){v=new he(e.length,!1),v.__initializeDigits();let S=0;for(let k=2*e.length-1;0<=k;k--){const A=S<<15|e.__halfDigit(k);v.__setHalfDigit(k,0|A/P),S=0|A%P}g=S.toString(t)}else{const S=he.__absoluteDivLarge(e,x,!0,!0);v=S.quotient;const k=S.remainder.__trim();g=he.__toStringGeneric(k,t,!0)}v.__trim();let _=he.__toStringGeneric(v,t,!0);for(;g.length<b;)g="0"+g;return c===!1&&e.sign&&(_="-"+_),_+g}static __unequalSign(e){return e?-1:1}static __absoluteGreater(e){return e?-1:1}static __absoluteLess(e){return e?1:-1}static __compareToBigInt(e,t){const c=e.sign;if(c!==t.sign)return he.__unequalSign(c);const a=he.__absoluteCompare(e,t);return 0<a?he.__absoluteGreater(c):0>a?he.__absoluteLess(c):0}static __compareToNumber(e,t){if(he.__isOneDigitInt(t)){const c=e.sign,a=0>t;if(c!==a)return he.__unequalSign(c);if(e.length===0){if(a)throw new Error("implementation bug");return t===0?0:-1}if(1<e.length)return he.__absoluteGreater(c);const h=Math.abs(t),d=e.__unsignedDigit(0);return d>h?he.__absoluteGreater(c):d<h?he.__absoluteLess(c):0}return he.__compareToDouble(e,t)}static __compareToDouble(e,t){if(t!==t)return t;if(t===1/0)return-1;if(t===-1/0)return 1;const c=e.sign;if(c!==0>t)return he.__unequalSign(c);if(t===0)throw new Error("implementation bug: should be handled elsewhere");if(e.length===0)return-1;he.__kBitConversionDouble[0]=t;const a=2047&he.__kBitConversionInts[1]>>>20;if(a==2047)throw new Error("implementation bug: handled elsewhere");const h=a-1023;if(0>h)return he.__absoluteGreater(c);const d=e.length;let s=e.__digit(d-1);const f=he.__clz30(s),b=30*d-f,x=h+1;if(b<x)return he.__absoluteLess(c);if(b>x)return he.__absoluteGreater(c);let v=1048576|1048575&he.__kBitConversionInts[1],g=he.__kBitConversionInts[0];const P=20,_=29-f;if(_!==(0|(b-1)%30))throw new Error("implementation bug");let S,k=0;if(20>_){const A=P-_;k=A+32,S=v>>>A,v=v<<32-A|g>>>A,g<<=32-A}else if(_===20)k=32,S=v,v=g,g=0;else{const A=_-P;k=32-A,S=v<<A|g>>>32-A,v=g<<A,g=0}if(s>>>=0,S>>>=0,s>S)return he.__absoluteGreater(c);if(s<S)return he.__absoluteLess(c);for(let A=d-2;0<=A;A--){0<k?(k-=30,S=v>>>2,v=v<<30|g>>>2,g<<=30):S=0;const y=e.__unsignedDigit(A);if(y>S)return he.__absoluteGreater(c);if(y<S)return he.__absoluteLess(c)}if(v!==0||g!==0){if(k===0)throw new Error("implementation bug");return he.__absoluteLess(c)}return 0}static __equalToNumber(e,t){var c=Math.abs;return he.__isOneDigitInt(t)?t===0?e.length===0:e.length===1&&e.sign===0>t&&e.__unsignedDigit(0)===c(t):he.__compareToDouble(e,t)===0}static __comparisonResultToBool(e,t){return t===0?0>e:t===1?0>=e:t===2?0<e:t===3?0<=e:void 0}static __compare(e,t,c){if(e=he.__toPrimitive(e),t=he.__toPrimitive(t),typeof e=="string"&&typeof t=="string")switch(c){case 0:return e<t;case 1:return e<=t;case 2:return e>t;case 3:return e>=t}if(he.__isBigInt(e)&&typeof t=="string")return t=he.__fromString(t),t!==null&&he.__comparisonResultToBool(he.__compareToBigInt(e,t),c);if(typeof e=="string"&&he.__isBigInt(t))return e=he.__fromString(e),e!==null&&he.__comparisonResultToBool(he.__compareToBigInt(e,t),c);if(e=he.__toNumeric(e),t=he.__toNumeric(t),he.__isBigInt(e)){if(he.__isBigInt(t))return he.__comparisonResultToBool(he.__compareToBigInt(e,t),c);if(typeof t!="number")throw new Error("implementation bug");return he.__comparisonResultToBool(he.__compareToNumber(e,t),c)}if(typeof e!="number")throw new Error("implementation bug");if(he.__isBigInt(t))return he.__comparisonResultToBool(he.__compareToNumber(t,e),2^c);if(typeof t!="number")throw new Error("implementation bug");return c===0?e<t:c===1?e<=t:c===2?e>t:c===3?e>=t:void 0}__clzmsd(){return he.__clz30(this.__digit(this.length-1))}static __absoluteAdd(e,t,c){if(e.length<t.length)return he.__absoluteAdd(t,e,c);if(e.length===0)return e;if(t.length===0)return e.sign===c?e:he.unaryMinus(e);let a=e.length;(e.__clzmsd()===0||t.length===e.length&&t.__clzmsd()===0)&&a++;const h=new he(a,c);let d=0,s=0;for(;s<t.length;s++){const f=e.__digit(s)+t.__digit(s)+d;d=f>>>30,h.__setDigit(s,1073741823&f)}for(;s<e.length;s++){const f=e.__digit(s)+d;d=f>>>30,h.__setDigit(s,1073741823&f)}return s<h.length&&h.__setDigit(s,d),h.__trim()}static __absoluteSub(e,t,c){if(e.length===0)return e;if(t.length===0)return e.sign===c?e:he.unaryMinus(e);const a=new he(e.length,c);let h=0,d=0;for(;d<t.length;d++){const s=e.__digit(d)-t.__digit(d)-h;h=1&s>>>30,a.__setDigit(d,1073741823&s)}for(;d<e.length;d++){const s=e.__digit(d)-h;h=1&s>>>30,a.__setDigit(d,1073741823&s)}return a.__trim()}static __absoluteAddOne(e,t,c=null){const a=e.length;c===null?c=new he(a,t):c.sign=t;let h=1;for(let d=0;d<a;d++){const s=e.__digit(d)+h;h=s>>>30,c.__setDigit(d,1073741823&s)}return h!=0&&c.__setDigitGrow(a,1),c}static __absoluteSubOne(e,t){const c=e.length;t=t||c;const a=new he(t,!1);let h=1;for(let d=0;d<c;d++){const s=e.__digit(d)-h;h=1&s>>>30,a.__setDigit(d,1073741823&s)}if(h!=0)throw new Error("implementation bug");for(let d=c;d<t;d++)a.__setDigit(d,0);return a}static __absoluteAnd(e,t,c=null){let a=e.length,h=t.length,d=h;if(a<h){d=a;const b=e,x=a;e=t,a=h,t=b,h=x}let s=d;c===null?c=new he(s,!1):s=c.length;let f=0;for(;f<d;f++)c.__setDigit(f,e.__digit(f)&t.__digit(f));for(;f<s;f++)c.__setDigit(f,0);return c}static __absoluteAndNot(e,t,c=null){const a=e.length,h=t.length;let d=h;a<h&&(d=a);let s=a;c===null?c=new he(s,!1):s=c.length;let f=0;for(;f<d;f++)c.__setDigit(f,e.__digit(f)&~t.__digit(f));for(;f<a;f++)c.__setDigit(f,e.__digit(f));for(;f<s;f++)c.__setDigit(f,0);return c}static __absoluteOr(e,t,c=null){let a=e.length,h=t.length,d=h;if(a<h){d=a;const b=e,x=a;e=t,a=h,t=b,h=x}let s=a;c===null?c=new he(s,!1):s=c.length;let f=0;for(;f<d;f++)c.__setDigit(f,e.__digit(f)|t.__digit(f));for(;f<a;f++)c.__setDigit(f,e.__digit(f));for(;f<s;f++)c.__setDigit(f,0);return c}static __absoluteXor(e,t,c=null){let a=e.length,h=t.length,d=h;if(a<h){d=a;const b=e,x=a;e=t,a=h,t=b,h=x}let s=a;c===null?c=new he(s,!1):s=c.length;let f=0;for(;f<d;f++)c.__setDigit(f,e.__digit(f)^t.__digit(f));for(;f<a;f++)c.__setDigit(f,e.__digit(f));for(;f<s;f++)c.__setDigit(f,0);return c}static __absoluteCompare(e,t){const c=e.length-t.length;if(c!=0)return c;let a=e.length-1;for(;0<=a&&e.__digit(a)===t.__digit(a);)a--;return 0>a?0:e.__unsignedDigit(a)>t.__unsignedDigit(a)?1:-1}static __multiplyAccumulate(e,t,c,a){if(t===0)return;const h=32767&t,d=t>>>15;let s=0,f=0;for(let b,x=0;x<e.length;x++,a++){b=c.__digit(a);const v=e.__digit(x),g=32767&v,P=v>>>15,_=he.__imul(g,h),S=he.__imul(g,d),k=he.__imul(P,h),A=he.__imul(P,d);b+=f+_+s,s=b>>>30,b&=1073741823,b+=((32767&S)<<15)+((32767&k)<<15),s+=b>>>30,f=A+(S>>>15)+(k>>>15),c.__setDigit(a,1073741823&b)}for(;s!=0||f!==0;a++){let b=c.__digit(a);b+=s+f,f=0,s=b>>>30,c.__setDigit(a,1073741823&b)}}static __internalMultiplyAdd(e,t,c,a,h){let d=c,s=0;for(let f=0;f<a;f++){const b=e.__digit(f),x=he.__imul(32767&b,t),v=he.__imul(b>>>15,t),g=x+((32767&v)<<15)+s+d;d=g>>>30,s=v>>>15,h.__setDigit(f,1073741823&g)}if(h.length>a)for(h.__setDigit(a++,d+s);a<h.length;)h.__setDigit(a++,0);else if(d+s!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(e,t,c){c>this.length&&(c=this.length);const a=32767&e,h=e>>>15;let d=0,s=t;for(let f=0;f<c;f++){const b=this.__digit(f),x=32767&b,v=b>>>15,g=he.__imul(x,a),P=he.__imul(x,h),_=he.__imul(v,a),S=he.__imul(v,h);let k=s+g+d;d=k>>>30,k&=1073741823,k+=((32767&P)<<15)+((32767&_)<<15),d+=k>>>30,s=S+(P>>>15)+(_>>>15),this.__setDigit(f,1073741823&k)}if(d!=0||s!==0)throw new Error("implementation bug")}static __absoluteDivSmall(e,t,c=null){c===null&&(c=new he(e.length,!1));let a=0;for(let h,d=2*e.length-1;0<=d;d-=2){h=(a<<15|e.__halfDigit(d))>>>0;const s=0|h/t;a=0|h%t,h=(a<<15|e.__halfDigit(d-1))>>>0;const f=0|h/t;a=0|h%t,c.__setDigit(d>>>1,s<<15|f)}return c}static __absoluteModSmall(e,t){let c=0;for(let a=2*e.length-1;0<=a;a--)c=0|((c<<15|e.__halfDigit(a))>>>0)%t;return c}static __absoluteDivLarge(e,t,c,a){const h=t.__halfDigitLength(),d=t.length,s=e.__halfDigitLength()-h;let f=null;c&&(f=new he(s+2>>>1,!1),f.__initializeDigits());const b=new he(h+2>>>1,!1);b.__initializeDigits();const x=he.__clz15(t.__halfDigit(h-1));0<x&&(t=he.__specialLeftShift(t,x,0));const v=he.__specialLeftShift(e,x,1),g=t.__halfDigit(h-1);let P=0;for(let _,S=s;0<=S;S--){_=32767;const k=v.__halfDigit(S+h);if(k!==g){const y=(k<<15|v.__halfDigit(S+h-1))>>>0;_=0|y/g;let I=0|y%g;const D=t.__halfDigit(h-2),w=v.__halfDigit(S+h-2);for(;he.__imul(_,D)>>>0>(I<<16|w)>>>0&&(_--,I+=g,!(32767<I)););}he.__internalMultiplyAdd(t,_,0,d,b);let A=v.__inplaceSub(b,S,h+1);A!==0&&(A=v.__inplaceAdd(t,S,h),v.__setHalfDigit(S+h,32767&v.__halfDigit(S+h)+A),_--),c&&(1&S?P=_<<15:f.__setDigit(S>>>1,P|_))}if(a)return v.__inplaceRightShift(x),c?{quotient:f,remainder:v}:v;if(c)return f;throw new Error("unreachable")}static __clz15(e){return he.__clz30(e)-15}__inplaceAdd(e,t,c){let a=0;for(let h=0;h<c;h++){const d=this.__halfDigit(t+h)+e.__halfDigit(h)+a;a=d>>>15,this.__setHalfDigit(t+h,32767&d)}return a}__inplaceSub(e,t,c){let a=0;if(1&t){t>>=1;let h=this.__digit(t),d=32767&h,s=0;for(;s<c-1>>>1;s++){const x=e.__digit(s),v=(h>>>15)-(32767&x)-a;a=1&v>>>15,this.__setDigit(t+s,(32767&v)<<15|32767&d),h=this.__digit(t+s+1),d=(32767&h)-(x>>>15)-a,a=1&d>>>15}const f=e.__digit(s),b=(h>>>15)-(32767&f)-a;if(a=1&b>>>15,this.__setDigit(t+s,(32767&b)<<15|32767&d),t+s+1>=this.length)throw new RangeError("out of bounds");!(1&c)&&(h=this.__digit(t+s+1),d=(32767&h)-(f>>>15)-a,a=1&d>>>15,this.__setDigit(t+e.length,1073709056&h|32767&d))}else{t>>=1;let h=0;for(;h<e.length-1;h++){const x=this.__digit(t+h),v=e.__digit(h),g=(32767&x)-(32767&v)-a;a=1&g>>>15;const P=(x>>>15)-(v>>>15)-a;a=1&P>>>15,this.__setDigit(t+h,(32767&P)<<15|32767&g)}const d=this.__digit(t+h),s=e.__digit(h),f=(32767&d)-(32767&s)-a;a=1&f>>>15;let b=0;!(1&c)&&(b=(d>>>15)-(s>>>15)-a,a=1&b>>>15),this.__setDigit(t+h,(32767&b)<<15|32767&f)}return a}__inplaceRightShift(e){if(e===0)return;let t=this.__digit(0)>>>e;const c=this.length-1;for(let a=0;a<c;a++){const h=this.__digit(a+1);this.__setDigit(a,1073741823&h<<30-e|t),t=h>>>e}this.__setDigit(c,t)}static __specialLeftShift(e,t,c){const a=e.length,h=new he(a+c,!1);if(t===0){for(let s=0;s<a;s++)h.__setDigit(s,e.__digit(s));return 0<c&&h.__setDigit(a,0),h}let d=0;for(let s=0;s<a;s++){const f=e.__digit(s);h.__setDigit(s,1073741823&f<<t|d),d=f>>>30-t}return 0<c&&h.__setDigit(a,d),h}static __leftShiftByAbsolute(e,t){const c=he.__toShiftAmount(t);if(0>c)throw new RangeError("BigInt too big");const a=0|c/30,h=c%30,d=e.length,s=h!==0&&e.__digit(d-1)>>>30-h!=0,f=d+a+(s?1:0),b=new he(f,e.sign);if(h===0){let x=0;for(;x<a;x++)b.__setDigit(x,0);for(;x<f;x++)b.__setDigit(x,e.__digit(x-a))}else{let x=0;for(let v=0;v<a;v++)b.__setDigit(v,0);for(let v=0;v<d;v++){const g=e.__digit(v);b.__setDigit(v+a,1073741823&g<<h|x),x=g>>>30-h}if(s)b.__setDigit(d+a,x);else if(x!==0)throw new Error("implementation bug")}return b.__trim()}static __rightShiftByAbsolute(e,t){const c=e.length,a=e.sign,h=he.__toShiftAmount(t);if(0>h)return he.__rightShiftByMaximum(a);const d=0|h/30,s=h%30;let f=c-d;if(0>=f)return he.__rightShiftByMaximum(a);let b=!1;if(a){if(e.__digit(d)&(1<<s)-1)b=!0;else for(let v=0;v<d;v++)if(e.__digit(v)!==0){b=!0;break}}b&&s===0&&!~e.__digit(c-1)&&f++;let x=new he(f,a);if(s===0){x.__setDigit(f-1,0);for(let v=d;v<c;v++)x.__setDigit(v-d,e.__digit(v))}else{let v=e.__digit(d)>>>s;const g=c-d-1;for(let P=0;P<g;P++){const _=e.__digit(P+d+1);x.__setDigit(P,1073741823&_<<30-s|v),v=_>>>s}x.__setDigit(g,v)}return b&&(x=he.__absoluteAddOne(x,!0,x)),x.__trim()}static __rightShiftByMaximum(e){return e?he.__oneDigit(1,!0):he.__zero()}static __toShiftAmount(e){if(1<e.length)return-1;const t=e.__unsignedDigit(0);return t>he.__kMaxLengthBits?-1:t}static __toPrimitive(e,t="default"){if(typeof e!="object"||e.constructor===he)return e;if(typeof Symbol<"u"&&typeof Symbol.toPrimitive=="symbol"){const h=e[Symbol.toPrimitive];if(h){const d=h(t);if(typeof d!="object")return d;throw new TypeError("Cannot convert object to primitive value")}}const c=e.valueOf;if(c){const h=c.call(e);if(typeof h!="object")return h}const a=e.toString;if(a){const h=a.call(e);if(typeof h!="object")return h}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(e){return he.__isBigInt(e)?e:+e}static __isBigInt(e){return typeof e=="object"&&e!==null&&e.constructor===he}static __truncateToNBits(e,t){const c=0|(e+29)/30,a=new he(c,t.sign),h=c-1;for(let s=0;s<h;s++)a.__setDigit(s,t.__digit(s));let d=t.__digit(h);if(e%30!=0){const s=32-e%30;d=d<<s>>>s}return a.__setDigit(h,d),a.__trim()}static __truncateAndSubFromPowerOfTwo(e,t,c){var a=Math.min;const h=0|(e+29)/30,d=new he(h,c);let s=0;const f=h-1;let b=0;for(const P=a(f,t.length);s<P;s++){const _=0-t.__digit(s)-b;b=1&_>>>30,d.__setDigit(s,1073741823&_)}for(;s<f;s++)d.__setDigit(s,0|1073741823&-b);let x=f<t.length?t.__digit(f):0;const v=e%30;let g;if(v==0)g=0-x-b,g&=1073741823;else{const P=32-v;x=x<<P>>>P;const _=1<<32-P;g=_-x-b,g&=_-1}return d.__setDigit(f,g),d.__trim()}__digit(e){return this[e]}__unsignedDigit(e){return this[e]>>>0}__setDigit(e,t){this[e]=0|t}__setDigitGrow(e,t){this[e]=0|t}__halfDigitLength(){const e=this.length;return 32767>=this.__unsignedDigit(e-1)?2*e-1:2*e}__halfDigit(e){return 32767&this[e>>>1]>>>15*(1&e)}__setHalfDigit(e,t){const c=e>>>1,a=this.__digit(c),h=1&e?32767&a|t<<15:1073709056&a|32767&t;this.__setDigit(c,h)}static __digitPow(e,t){let c=1;for(;0<t;)1&t&&(c*=e),t>>>=1,e*=e;return c}static __isOneDigitInt(e){return(1073741823&e)===e}}he.__kMaxLength=33554432,he.__kMaxLengthBits=he.__kMaxLength<<5,he.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],he.__kBitsPerCharTableShift=5,he.__kBitsPerCharTableMultiplier=1<<he.__kBitsPerCharTableShift,he.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],he.__kBitConversionBuffer=new ArrayBuffer(8),he.__kBitConversionDouble=new Float64Array(he.__kBitConversionBuffer),he.__kBitConversionInts=new Int32Array(he.__kBitConversionBuffer),he.__clz30=Math.clz32?function(n){return Math.clz32(n)-2}:function(n){return n===0?30:0|29-(0|Math.log(n>>>0)/Math.LN2)},he.__imul=Math.imul||function(n,e){return 0|n*e};const Jg={};function na(n,e){Object.defineProperty(n.prototype,Symbol.toStringTag,{value:e,writable:!1,enumerable:!1,configurable:!0});for(const t of Object.getOwnPropertyNames(n)){const c=Object.getOwnPropertyDescriptor(n,t);c.configurable&&c.enumerable&&(c.enumerable=!1,Object.defineProperty(n,t,c))}for(const t of Object.getOwnPropertyNames(n.prototype)){const c=Object.getOwnPropertyDescriptor(n.prototype,t);c.configurable&&c.enumerable&&(c.enumerable=!1,Object.defineProperty(n.prototype,t,c))}ey(e,n),ey(`${e}.prototype`,n.prototype)}function ey(n,e){const t=`%${n}%`;if(Jg[t]!==void 0)throw new Error(`intrinsic ${n} already exists`);Jg[t]=e}function Pi(n){return Jg[n]}const Ai="slot-epochNanoSeconds",nl="slot-timezone-identifier",ii="slot-year",li="slot-month",pi="slot-day",ji="slot-hour",Bi="slot-minute",Fi="slot-second",Ui="slot-millisecond",$i="slot-microsecond",Gi="slot-nanosecond",wt="slot-calendar",Kn="slot-cached-instant",br="slot-time-zone",is="slot-years",Dn="slot-months",vs="slot-weeks",rs="slot-days",ns="slot-hours",ss="slot-minutes",os="slot-seconds",as="slot-milliseconds",ls="slot-microseconds",cs="slot-nanoseconds",sn="slot-calendar-identifier",L1=new WeakMap;function sa(n){L1.set(n,Object.create(null))}function Oy(n){return L1.get(n)}function An(n,...e){if(!n||typeof n!="object")return!1;const t=Oy(n);return!!t&&e.reduce((c,a)=>c&&a in t,!0)}function q(n,e){const t=Oy(n)[e];if(t===void 0)throw new TypeError(`Missing internal slot ${e}`);return t}function Yi(n,e,t){Oy(n)[e]=t}const pb=/\.[-A-Za-z_]|\.\.[-A-Za-z._]{1,12}|\.[-A-Za-z_][-A-Za-z._]{0,12}|[A-Za-z_][-A-Za-z._]{0,13}/,pS=new RegExp(`(?:(?:${pb.source})(?:\\/(?:${pb.source}))*|Etc/GMT[-+]\\d{1,2}|${/(?:[+\u2212-][0-2][0-9](?::?[0-5][0-9](?::?[0-5][0-9](?:[.,]\d{1,9})?)?)?)/.source})`),fb=/[A-Za-z0-9]{3,8}/,fS=new RegExp(`(?:${fb.source}(?:-${fb.source})*)`),R1=/(?:[+\u2212-]\d{6}|\d{4})/,xf=/(?:0[1-9]|1[0-2])/,ty=/(?:0[1-9]|[12]\d|3[01])/,mS=new RegExp(`(${R1.source})(?:-(${xf.source})-(${ty.source})|(${xf.source})(${ty.source}))`),O1=/(\d{2})(?::(\d{2})(?::(\d{2})(?:[.,](\d{1,9}))?)?|(\d{2})(?:(\d{2})(?:[.,](\d{1,9}))?)?)?/,z1=/([+\u2212-])([01][0-9]|2[0-3])(?::?([0-5][0-9])(?::?([0-5][0-9])(?:[.,](\d{1,9}))?)?)?/,N1=new RegExp(`(?:([zZ])|(?:${z1.source})?)(?:\\[(${pS.source})\\])?`),j1=new RegExp(`\\[u-ca=(${fS.source})\\]`),gS=new RegExp(`^${mS.source}(?:(?:T|\\s+)${O1.source})?${N1.source}(?:${j1.source})?$`,"i"),yS=new RegExp(`^T?${O1.source}(?:${N1.source})?(?:${j1.source})?$`,"i"),xS=new RegExp(`^(${R1.source})-?(${xf.source})$`),bS=new RegExp(`^(?:--)?(${xf.source})-?(${ty.source})$`),Tg=/(\d+)(?:[.,](\d{1,9}))?/,vS=new RegExp(`(?:${Tg.source}H)?(?:${Tg.source}M)?(?:${Tg.source}S)?`),_S=new RegExp(`^([+−-])?P${/(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?/.source}(?:T(?!$)${vS.source})?$`,"i"),B1=Array.prototype.includes,zy=Array.prototype.push,F1=globalThis.Intl.DateTimeFormat,wS=Math.min,TS=Math.max,ur=Math.abs,kn=Math.floor,cd=Math.sign,wh=Math.trunc,Ed=Number.isNaN,Rn=Number.isFinite,ES=Number,Cd=String,CS=Number.MAX_SAFE_INTEGER,U1=Object.assign,Vn=Object.create,SS=Object.getOwnPropertyDescriptor,kS=Object.is,Ny=Reflect.apply,on=he.BigInt(0),jy=he.BigInt(1),uc=he.BigInt(60),vr=he.BigInt(1e3),ho=he.BigInt(1e6),Ia=he.BigInt(1e9),MS=he.BigInt(-1),fl=he.multiply(he.BigInt(86400),Ia),hd=he.multiply(he.BigInt(-86400),he.BigInt(1e17)),ud=he.multiply(he.BigInt(86400),he.BigInt(1e17)),$1=he.multiply(he.BigInt(-388152),he.BigInt(1e13)),AS=he.multiply(fl,he.BigInt(3660)),G1=he.multiply(fl,he.BigInt(366)),V1=he.multiply(fl,he.BigInt(14)),PS=["iso8601","hebrew","islamic","islamic-umalqura","islamic-tbla","islamic-civil","islamic-rgsa","islamicc","persian","ethiopic","ethioaa","coptic","chinese","dangi","roc","indian","buddhist","japanese","gregory"];function H1(n){if(typeof n!="number"||!Rn(n))return!1;const e=ur(n);return kn(e)===e}function Dr(n){return typeof n=="object"&&n!==null||typeof n=="function"}function dd(n){if(typeof n=="bigint")throw new TypeError("Cannot convert BigInt to number");return ES(n)}function _r(n){const e=dd(n);if(Ed(e))return 0;const t=wh(e);return e===0?0:t}function Oi(n){if(typeof n=="symbol")throw new TypeError("Cannot convert a Symbol value to a String");return Cd(n)}function Mr(n){const e=_r(n);if(!Rn(e))throw new RangeError("infinity is out of range");return e}function pd(n,e){const t=_r(n);if(!Rn(t))throw new RangeError("infinity is out of range");if(t<1)throw e!==void 0?new RangeError(`property '${e}' cannot be a a number less than one`):new RangeError("Cannot convert a number less than one to a positive integer");return t}function Sn(n){const e=dd(n);if(Ed(e))return 0;if(!Rn(e))throw new RangeError("infinity is out of range");if(!H1(e))throw new RangeError(`unsupported fractional value ${e}`);return _r(e)}function Cn(n,e){return{quotient:he.divide(n,e),remainder:he.remainder(n,e)}}function By(n){return he.lessThan(n,on)?he.multiply(n,MS):n}function iy(n,...e){return zy.apply(n,e),n}const mb=new Map([["year",Mr],["month",pd],["monthCode",Oi],["day",pd],["hour",Mr],["minute",Mr],["second",Mr],["millisecond",Mr],["microsecond",Mr],["nanosecond",Mr],["years",Sn],["months",Sn],["weeks",Sn],["days",Sn],["hours",Sn],["minutes",Sn],["seconds",Sn],["milliseconds",Sn],["microseconds",Sn],["nanoseconds",Sn],["era",Oi],["eraYear",_r],["offset",Oi]]),IS=new Map([["hour",0],["minute",0],["second",0],["millisecond",0],["microsecond",0],["nanosecond",0]]),Bh=[["years","year","date"],["months","month","date"],["weeks","week","date"],["days","day","date"],["hours","hour","time"],["minutes","minute","time"],["seconds","second","time"],["milliseconds","millisecond","time"],["microseconds","microsecond","time"],["nanoseconds","nanosecond","time"]],bf=new Map(Bh.map(n=>[n[0],n[1]])),DS=new Map(Bh.map(([n,e])=>[e,n])),gb=Bh.map(([,n])=>n),yb=Array.from(bf.keys()).sort(),xb=new Map;function W1(n){let e=xb.get(n);return e===void 0&&(e=new F1("en-us",{timeZone:Cd(n),hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),xb.set(n,e)),e}function vn(n){return An(n,Ai)&&!An(n,br,wt)}function qo(n){return An(n,nl)}function nn(n){return An(n,sn)}function Zr(n){return An(n,is,Dn,rs,ns,ss,os,as,ls,cs)}function or(n){return An(n,"slot-date-brand")}function Kr(n){return An(n,ji,Bi,Fi,Ui,$i,Gi)&&!An(n,ii,li,pi)}function Wi(n){return An(n,ii,li,pi,ji,Bi,Fi,Ui,$i,Gi)}function mr(n){return An(n,"slot-year-month-brand")}function Ln(n){return An(n,"slot-month-day-brand")}function xi(n){return An(n,Ai,br,wt)}function Fh(n){if(An(n,wt)||An(n,br))throw new TypeError("with() does not support a calendar or timeZone property");if(n.calendar!==void 0)throw new TypeError("with() does not support a calendar property");if(n.timeZone!==void 0)throw new TypeError("with() does not support a timeZone property")}function Y1(n){let{ianaName:e,offset:t,z:c}=function(h){try{let d=Wy(h);if(d)return{ianaName:d.toString()}}catch{}try{const d=oa(h);if(d.z||d.offset||d.ianaName)return d}catch{}throw new RangeError(`Invalid time zone: ${h}`)}(n);return e||(c?"UTC":t)}function Sd(n,e){return e==="never"||e==="auto"&&n==="iso8601"?"":`[u-ca=${n}]`}function oa(n){const e=gS.exec(n);if(!e)throw new RangeError(`invalid ISO 8601 string: ${n}`);let t=e[1];if(t[0]==="−"&&(t=`-${t.slice(1)}`),t==="-000000")throw new RangeError(`invalid ISO 8601 string: ${n}`);const c=_r(t),a=_r(e[2]||e[4]),h=_r(e[3]||e[5]),d=_r(e[6]),s=e[6]!==void 0,f=_r(e[7]||e[10]);let b=_r(e[8]||e[11]);b===60&&(b=59);const x=(e[9]||e[12])+"000000000",v=_r(x.slice(0,3)),g=_r(x.slice(3,6)),P=_r(x.slice(6,9));let _,S=!1;if(e[13])_=void 0,S=!0;else if(e[14]&&e[15]){const y=e[14]==="-"||e[14]==="−"?"-":"+",I=e[15]||"00",D=e[16]||"00",w=e[17]||"00";let M=e[18]||"0";if(_=`${y}${I}:${D}`,+M){for(;M.endsWith("0");)M=M.slice(0,-1);_+=`:${w}.${M}`}else+w&&(_+=`:${w}`);_==="-00:00"&&(_="+00:00")}let k=e[19];if(k)try{k=Wy(k).toString()}catch{}const A=e[20];return Zy(c,a,h,d,f,b,v,g,P),{year:c,month:a,day:h,hasTime:s,hour:d,minute:f,second:b,millisecond:v,microsecond:g,nanosecond:P,ianaName:k,offset:_,z:S,calendar:A}}function q1(n){const e=xS.exec(n);let t,c,a,h;if(e){let d=e[1];if(d[0]==="−"&&(d=`-${d.slice(1)}`),d==="-000000")throw new RangeError(`invalid ISO 8601 string: ${n}`);t=_r(d),c=_r(e[2]),a=e[3]}else{let d;if({year:t,month:c,calendar:a,day:h,z:d}=oa(n),d)throw new RangeError("Z designator not supported for PlainYearMonth")}return{year:t,month:c,calendar:a,referenceISODay:h}}function X1(n){const e=bS.exec(n);let t,c,a,h;if(e)t=_r(e[1]),c=_r(e[2]);else{let d;if({month:t,day:c,calendar:a,year:h,z:d}=oa(n),d)throw new RangeError("Z designator not supported for PlainMonthDay")}return{month:t,day:c,calendar:a,referenceISOYear:h}}function LS(n){const e=_S.exec(n);if(!e)throw new RangeError(`invalid duration: ${n}`);if(e.slice(2).every(k=>k===void 0))throw new RangeError(`invalid duration: ${n}`);const t=e[1]==="-"||e[1]==="−"?-1:1,c=_r(e[2])*t,a=_r(e[3])*t,h=_r(e[4])*t,d=_r(e[5])*t,s=_r(e[6])*t;let f=e[7],b=_r(e[8])*t,x=e[9],v=_r(e[10])*t;const g=e[11]+"000000000";let P=_r(g.slice(0,3))*t,_=_r(g.slice(3,6))*t,S=_r(g.slice(6,9))*t;return f=f?t*_r(f)/10**f.length:0,x=x?t*_r(x)/10**x.length:0,{minutes:b,seconds:v,milliseconds:P,microseconds:_,nanoseconds:S}=function(A,y,I,D,w,M,z){let Y=A,X=y,Z=I,j=D,V=w,$=M,R=z;if(Y!==0){[X,Z,j,V,$,R].forEach(G=>{if(G!==0)throw new RangeError("only the smallest unit can be fractional")});const L=60*Y;X=wh(L),Z=L%1}if(Z!==0){[j,V,$,R].forEach(U=>{if(U!==0)throw new RangeError("only the smallest unit can be fractional")});const L=60*Z;j=wh(L);const G=L%1;if(G!==0){const U=1e3*G;V=wh(U);const F=U%1;if(F!==0){const H=1e3*F;$=wh(H);const W=H%1;W!==0&&(R=wh(1e3*W))}}}return{minutes:X,seconds:j,milliseconds:V,microseconds:$,nanoseconds:R}}(f,b,x,v,P,_,S),nm(c,a,h,d,s,b,v,P,_,S),{years:c,months:a,weeks:h,days:d,hours:s,minutes:b,seconds:v,milliseconds:P,microseconds:_,nanoseconds:S}}function RS(n){let{year:e,month:t,day:c,hour:a,minute:h,second:d,millisecond:s,microsecond:f,nanosecond:b,offset:x,z:v}=function(S){const k=oa(S);if(!k.z&&!k.offset)throw new RangeError("Temporal.Instant requires a time zone offset");return k}(n);if(!v&&!x)throw new RangeError("Temporal.Instant requires a time zone offset");const g=v?0:_c(x);({year:e,month:t,day:c,hour:a,minute:h,second:d,millisecond:s,microsecond:f,nanosecond:b}=qy(e,t,c,a,h,d,s,f,b-g));const P=yl(e,t,c,a,h,d,s,f,b);if(P===null)throw new RangeError("DateTime outside of supported range");return P}function vf(n,e,t,c){let a=n,h=e,d=t;switch(c){case"reject":ea(a,h,d);break;case"constrain":({year:a,month:h,day:d}=h_(a,h,d))}return{year:a,month:h,day:d}}function Hf(n,e,t,c,a,h,d){let s=n,f=e,b=t,x=c,v=a,g=h;switch(d){case"reject":rm(s,f,b,x,v,g);break;case"constrain":({hour:s,minute:f,second:b,millisecond:x,microsecond:v,nanosecond:g}=function(_,S,k,A,y,I){const D=Ns(_,0,23),w=Ns(S,0,59),M=Ns(k,0,59),z=Ns(A,0,999),Y=Ns(y,0,999),X=Ns(I,0,999);return{hour:D,minute:w,second:M,millisecond:z,microsecond:Y,nanosecond:X}}(s,f,b,x,v,g))}return{hour:s,minute:f,second:b,millisecond:x,microsecond:v,nanosecond:g}}function Tc(n){if(!Dr(n))return LS(Oi(n));if(Zr(n))return{years:q(n,is),months:q(n,Dn),weeks:q(n,vs),days:q(n,rs),hours:q(n,ns),minutes:q(n,ss),seconds:q(n,os),milliseconds:q(n,as),microseconds:q(n,ls),nanoseconds:q(n,cs)};const e={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};let t=function(_){if(!Dr(_))throw new TypeError("invalid duration-like");const S={years:void 0,months:void 0,weeks:void 0,days:void 0,hours:void 0,minutes:void 0,seconds:void 0,milliseconds:void 0,microseconds:void 0,nanoseconds:void 0};let k=!1;for(const A of yb){const y=_[A];y!==void 0&&(k=!0,S[A]=Sn(y))}if(!k)throw new TypeError("invalid duration-like");return S}(n);for(const P of yb){const _=t[P];_!==void 0&&(e[P]=_)}let{years:c,months:a,weeks:h,days:d,hours:s,minutes:f,seconds:b,milliseconds:x,microseconds:v,nanoseconds:g}=e;return nm(c,a,h,d,s,f,b,x,v,g),{years:c,months:a,weeks:h,days:d,hours:s,minutes:f,seconds:b,milliseconds:x,microseconds:v,nanoseconds:g}}function ln(n){return n===void 0?"constrain":bl(n,"overflow",["constrain","reject"],"constrain")}function fd(n){return n===void 0?"compatible":bl(n,"disambiguation",["compatible","earlier","later","reject"],"compatible")}function ws(n,e){return bl(n,"roundingMode",["ceil","floor","trunc","halfExpand"],e)}function kd(n){switch(n){case"ceil":return"floor";case"floor":return"ceil";default:return n}}function ry(n,e){return n===void 0?e:bl(n,"offset",["prefer","use","ignore","reject"],e)}function Md(n){return bl(n,"calendarName",["auto","always","never"],"auto")}function Oa(n,e,t){let c=1/0;e!==void 0&&(c=e),t||e===void 0||(c=e>1?e-1:1);const a=function(d,s,f,b,x){let v=d[s];if(v===void 0)return x;const g=dd(v);if(Ed(g)||g<f||g>b)throw new RangeError(`${String(s)} must be between ${f} and ${b}, not ${g}`);return kn(g)}(n,"roundingIncrement",1,c,1);if(e!==void 0&&e%a!=0)throw new RangeError(`Rounding increment must divide evenly into ${e}`);return a}function Fy(n,e){return Oa(n,{year:void 0,month:void 0,week:void 0,day:void 0,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[e],!1)}function Ad(n){const e=Mn(n,"smallestUnit","time",void 0);if(e==="hour"){const a=Bh.reduce((h,[d,s,f])=>(f==="time"&&s!=="hour"&&h.push(s,d),h),[]);throw new RangeError(`smallestUnit must be one of ${a.join(", ")}, not ${e}`)}switch(e){case"minute":return{precision:"minute",unit:"minute",increment:1};case"second":return{precision:0,unit:"second",increment:1};case"millisecond":return{precision:3,unit:"millisecond",increment:1};case"microsecond":return{precision:6,unit:"microsecond",increment:1};case"nanosecond":return{precision:9,unit:"nanosecond",increment:1}}let t=n.fractionalSecondDigits;if(t===void 0&&(t="auto"),typeof t!="number"){const a=Oi(t);if(a==="auto")return{precision:"auto",unit:"nanosecond",increment:1};throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${a}`)}if(Ed(t)||t<0||t>9)throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${t}`);const c=kn(t);switch(c){case 0:return{precision:c,unit:"second",increment:1};case 1:case 2:case 3:return{precision:c,unit:"millisecond",increment:10**(3-c)};case 4:case 5:case 6:return{precision:c,unit:"microsecond",increment:10**(6-c)};case 7:case 8:case 9:return{precision:c,unit:"nanosecond",increment:10**(9-c)};default:throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${t}`)}}const xc=Symbol("~required~");function Mn(n,e,t,c,a=[]){const h=[];for(const[,b,x]of Bh)t!=="datetime"&&t!==x||h.push(b);h.push(...a);let d=c;d===xc?d=void 0:d!==void 0&&h.push(d);const s=[...h];for(const b of h){const x=DS.get(b);x!==void 0&&s.push(x)}let f=bl(n,e,s,d);if(f===void 0&&c===xc)throw new RangeError(`${e} is required`);return bf.has(f)?bf.get(f):f}function nf(n){const e=n.relativeTo;if(e===void 0)return e;let t,c,a,h,d,s,f,b,x,v,g,P,_="option",S=!1;if(Dr(e)){if(xi(e)||or(e))return e;if(Wi(e))return Ah(e);v=Uh(e);const k=Zi(e,fn(v,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),[]),A=Vn(null);A.overflow="constrain",{year:t,month:c,day:a,hour:h,minute:d,second:s,millisecond:f,microsecond:b,nanosecond:x}=Pd(v,k,A),P=e.offset,P===void 0&&(_="wall"),g=e.timeZone}else{let k,A;({year:t,month:c,day:a,hour:h,minute:d,second:s,millisecond:f,microsecond:b,nanosecond:x,calendar:v,ianaName:k,offset:P,z:A}=oa(Oi(e))),k&&(g=k),A?_="exact":P||(_="wall"),v||(v=cn()),v=On(v),S=!0}if(g!==void 0){g=ps(g);let k=0;return _==="option"&&(k=_c(Oi(P))),Bn(wf(t,c,a,h,d,s,f,b,x,_,k,g,"compatible","reject",S),g,v)}return So(t,c,a,v)}function ny(n,e,t,c,a,h,d,s,f,b){for(const[x,v]of[["years",n],["months",e],["weeks",t],["days",c],["hours",a],["minutes",h],["seconds",d],["milliseconds",s],["microseconds",f],["nanoseconds",b]])if(v!==0)return bf.get(x);return"nanosecond"}function $s(n,e){return gb.indexOf(n)>gb.indexOf(e)?e:n}function Wf(n,e){let t=n;return t===void 0&&(t=Vn(null)),U1(Vn(null),t,{largestUnit:e})}function Zi(n,e,t,{emptySourceErrorMessage:c}={emptySourceErrorMessage:"no supported properties found"}){const a=Vn(null);let h=!1;for(const d of e){let s=n[d];if(s!==void 0)h=!0,mb.has(d)&&(s=mb.get(d)(s)),a[d]=s;else if(t!=="partial"){if(B1.call(t,d))throw new TypeError(`required property '${d}' missing or undefined`);s=IS.get(d),a[d]=s}}if(t==="partial"&&!h)throw new TypeError(c);if(a.era===void 0!=(a.eraYear===void 0))throw new RangeError("properties 'era' and 'eraYear' must be provided together");return a}function _f(n,e="complete"){const t=["hour","microsecond","millisecond","minute","nanosecond","second"],c=Zi(n,t,"partial",{emptySourceErrorMessage:"invalid time-like"}),a={};for(const h of t){const d=SS(c,h);d!==void 0?a[h]=d.value:e==="complete"&&(a[h]=0)}return a}function kr(n,e){let t=n;if(Dr(t)){if(or(t))return t;if(xi(t)&&(ln(e),t=Zs(q(t,br),q(t,Kn),q(t,wt))),Wi(t))return ln(e),So(q(t,ii),q(t,li),q(t,pi),q(t,wt));const f=Uh(t);return gl(f,Zi(t,fn(f,["day","month","monthCode","year"]),[]),e)}ln(e);const{year:c,month:a,day:h,calendar:d,z:s}=function(b){return oa(b)}(Oi(t));if(s)throw new RangeError("Z designator not supported for PlainDate");return new(Pi("%Temporal.PlainDate%"))(c,a,h,d)}function Pd(n,e,t){let{hour:c,minute:a,second:h,millisecond:d,microsecond:s,nanosecond:f}=_f(e);const b=ln(t),x=gl(n,e,t),v=q(x,ii),g=q(x,li),P=q(x,pi);return{hour:c,minute:a,second:h,millisecond:d,microsecond:s,nanosecond:f}=Hf(c,a,h,d,s,f,b),{year:v,month:g,day:P,hour:c,minute:a,second:h,millisecond:d,microsecond:s,nanosecond:f}}function lc(n,e){let t,c,a,h,d,s,f,b,x,v;if(Dr(n)){if(Wi(n))return n;if(xi(n))return ln(e),Zs(q(n,br),q(n,Kn),q(n,wt));if(or(n))return ln(e),zs(q(n,ii),q(n,li),q(n,pi),0,0,0,0,0,0,q(n,wt));v=Uh(n);const g=Zi(n,fn(v,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),[]);({year:t,month:c,day:a,hour:h,minute:d,second:s,millisecond:f,microsecond:b,nanosecond:x}=Pd(v,g,e))}else{let g;if(ln(e),{year:t,month:c,day:a,hour:h,minute:d,second:s,millisecond:f,microsecond:b,nanosecond:x,calendar:v,z:g}=function(_){return oa(_)}(Oi(n)),g)throw new RangeError("Z designator not supported for PlainDateTime");Zy(t,c,a,h,d,s,f,b,x),v===void 0&&(v=cn()),v=On(v)}return zs(t,c,a,h,d,s,f,b,x,v)}function Eh(n){if(Zr(n))return n;let{years:e,months:t,weeks:c,days:a,hours:h,minutes:d,seconds:s,milliseconds:f,microseconds:b,nanoseconds:x}=Tc(n);return new(Pi("%Temporal.Duration%"))(e,t,c,a,h,d,s,f,b,x)}function Zo(n){if(vn(n))return n;if(xi(n))return new(Pi("%Temporal.Instant%"))(q(n,Ai));const e=RS(Oi(n));return new(Pi("%Temporal.Instant%"))(e)}function bb(n,e){let t=n;if(Dr(t)){if(Ln(t))return t;let f,b;if(An(t,wt))f=q(t,wt),b=!1;else{let v=t.calendar;b=v===void 0,v===void 0&&(v=cn()),f=On(v)}t=t;const x=Zi(t,fn(f,["day","month","monthCode","year"]),[]);return b&&x.month!==void 0&&x.monthCode===void 0&&x.year===void 0&&(x.year=1972),Mh(f,x,e)}ln(e);let{month:c,day:a,referenceISOYear:h,calendar:d}=X1(Oi(t)),s=d;return s===void 0&&(s=cn()),s=On(s),h===void 0?(ea(1972,c,a),md(c,a,s)):Mh(s,md(c,a,s,h))}function Pa(n,e="constrain"){let t,c,a,h,d,s,f,b=n;if(Dr(b)){if(Kr(b))return b;if(xi(b)&&(b=Zs(q(b,br),q(b,Kn),q(b,wt))),Wi(b))return new(Pi("%Temporal.PlainTime%"))(q(b,ji),q(b,Bi),q(b,Fi),q(b,Ui),q(b,$i),q(b,Gi));if(f=Uh(b),Oi(f)!=="iso8601")throw new RangeError("PlainTime can only have iso8601 calendar");({hour:t,minute:c,second:a,millisecond:h,microsecond:d,nanosecond:s}=_f(b)),{hour:t,minute:c,second:a,millisecond:h,microsecond:d,nanosecond:s}=Hf(t,c,a,h,d,s,e)}else if({hour:t,minute:c,second:a,millisecond:h,microsecond:d,nanosecond:s,calendar:f}=function(v){const g=yS.exec(v);let P,_,S,k,A,y,I;if(g){P=_r(g[1]),_=_r(g[2]||g[5]),S=_r(g[3]||g[6]),S===60&&(S=59);const D=(g[4]||g[7])+"000000000";k=_r(D.slice(0,3)),A=_r(D.slice(3,6)),y=_r(D.slice(6,9)),I=g[15]}else{let D,w;if({hasTime:w,hour:P,minute:_,second:S,millisecond:k,microsecond:A,nanosecond:y,calendar:I,z:D}=oa(v),!w)throw new RangeError(`time is missing in string: ${v}`);if(D)throw new RangeError("Z designator not supported for PlainTime")}if(/[tT ][0-9][0-9]/.test(v))return{hour:P,minute:_,second:S,millisecond:k,microsecond:A,nanosecond:y,calendar:I};try{const{month:D,day:w}=X1(v);ea(1972,D,w)}catch{try{const{year:D,month:w}=q1(v);ea(D,w,1)}catch{return{hour:P,minute:_,second:S,millisecond:k,microsecond:A,nanosecond:y,calendar:I}}}throw new RangeError(`invalid ISO 8601 time-only string ${v}; may need a T prefix`)}(Oi(b)),rm(t,c,a,h,d,s),f!==void 0&&f!=="iso8601")throw new RangeError("PlainTime can only have iso8601 calendar");return new(Pi("%Temporal.PlainTime%"))(t,c,a,h,d,s)}function ed(n,e){if(Dr(n)){if(mr(n))return n;const s=Uh(n);return vc(s,Zi(n,fn(s,["month","monthCode","year"]),[]),e)}ln(e);let{year:t,month:c,referenceISODay:a,calendar:h}=q1(Oi(n)),d=h;return d===void 0&&(d=cn()),d=On(d),a===void 0?(ea(t,c,1),gd(t,c,d)):vc(d,gd(t,c,d,a))}function wf(n,e,t,c,a,h,d,s,f,b,x,v,g,P,_){const S=new(Pi("%Temporal.PlainDateTime%"))(n,e,t,c,a,h,d,s,f);if(b==="wall"||P==="ignore")return q(us(v,S,g),Ai);if(b==="exact"||P==="use"){const A=yl(n,e,t,c,a,h,d,s,f);if(A===null)throw new RangeError("ZonedDateTime outside of supported range");return he.subtract(A,he.BigInt(x))}const k=Tf(v,S);for(const A of k){const y=Oo(v,A),I=he.toNumber(Ls(he.BigInt(y),6e10,"halfExpand"));if(y===x||_&&I===x)return q(A,Ai)}if(P==="reject"){const A=Yy(x),y=qo(v)?q(v,nl):"time zone";throw new RangeError(`Offset ${A} is invalid for ${S.toString()} in ${y}`)}return q(r_(k,v,S,g),Ai)}function td(n,e){let t,c,a,h,d,s,f,b,x,v,g,P,_=!1,S="option";if(Dr(n)){if(xi(n))return n;P=Uh(n);const A=Zi(n,iy(fn(P,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),"timeZone","offset"),["timeZone"]);({year:t,month:c,day:a,hour:h,minute:d,second:s,millisecond:f,microsecond:b,nanosecond:x}=Pd(P,A,e)),v=ps(A.timeZone),g=A.offset,g===void 0?S="wall":g=Oi(g)}else{let A,y;if(ln(e),{year:t,month:c,day:a,hour:h,minute:d,second:s,millisecond:f,microsecond:b,nanosecond:x,ianaName:A,offset:g,z:y,calendar:P}=function(D){const w=oa(D);if(!w.ianaName)throw new RangeError("Temporal.ZonedDateTime requires a time zone ID in brackets");return w}(Oi(n)),!A)throw new RangeError("time zone ID required in brackets");y?S="exact":g||(S="wall"),v=new(Pi("%Temporal.TimeZone%"))(A),P||(P=cn()),P=On(P),_=!0}let k=0;return S==="option"&&(k=_c(g)),Bn(wf(t,c,a,h,d,s,f,b,x,S,k,v,fd(e),ry(e,"reject"),_),v,P)}function Z1(n,e,t,c,a){ea(e,t,c),u_(e,t,c),sa(n),Yi(n,ii,e),Yi(n,li,t),Yi(n,pi,c),Yi(n,wt,a),Yi(n,"slot-date-brand",!0)}function So(n,e,t,c=cn()){const a=Pi("%Temporal.PlainDate%"),h=Vn(a.prototype);return Z1(h,n,e,t,c),h}function K1(n,e,t,c,a,h,d,s,f,b,x){Zy(e,t,c,a,h,d,s,f,b),d_(e,t,c,a,h,d,s,f,b),sa(n),Yi(n,ii,e),Yi(n,li,t),Yi(n,pi,c),Yi(n,ji,a),Yi(n,Bi,h),Yi(n,Fi,d),Yi(n,Ui,s),Yi(n,$i,f),Yi(n,Gi,b),Yi(n,wt,x)}function zs(n,e,t,c,a,h,d,s,f,b=cn()){const x=Pi("%Temporal.PlainDateTime%"),v=Vn(x.prototype);return K1(v,n,e,t,c,a,h,d,s,f,b),v}function Q1(n,e,t,c,a){ea(a,e,t),u_(a,e,t),sa(n),Yi(n,li,e),Yi(n,pi,t),Yi(n,ii,a),Yi(n,wt,c),Yi(n,"slot-month-day-brand",!0)}function md(n,e,t=cn(),c=1972){const a=Pi("%Temporal.PlainMonthDay%"),h=Vn(a.prototype);return Q1(h,n,e,t,c),h}function J1(n,e,t,c,a){ea(e,t,a),function(d,s){Un(d,-271821,275760),d===-271821?Un(s,4,12):d===275760&&Un(s,1,9)}(e,t),sa(n),Yi(n,ii,e),Yi(n,li,t),Yi(n,pi,a),Yi(n,wt,c),Yi(n,"slot-year-month-brand",!0)}function gd(n,e,t=cn(),c=1){const a=Pi("%Temporal.PlainYearMonth%"),h=Vn(a.prototype);return J1(h,n,e,t,c),h}function e_(n,e,t,c){oc(e),sa(n),Yi(n,Ai,e),Yi(n,br,t),Yi(n,wt,c);const a=new(Pi("%Temporal.Instant%"))(q(n,Ai));Yi(n,Kn,a)}function Bn(n,e,t=cn()){const c=Pi("%Temporal.ZonedDateTime%"),a=Vn(c.prototype);return e_(a,n,e,t),a}function cn(){return new(Pi("%Temporal.Calendar%"))("iso8601")}function fn(n,e){let t=e;n.fields&&(t=n.fields(t));const c=[];for(const a of t){if(typeof a!="string")throw new TypeError("bad return from calendar.fields()");zy.call(c,a)}return c}function bc(n,e,t){const c=n.mergeFields;if(!c)return{...e,...t};const a=Reflect.apply(c,n,[e,t]);if(!Dr(a))throw new TypeError("bad return from calendar.mergeFields()");return a}function hs(n,e,t,c,a){let h=a;h===void 0&&(h=n.dateAdd);const d=Ny(h,n,[e,t,c]);if(!or(d))throw new TypeError("invalid result");return d}function ml(n,e,t,c,a){let h=a;h===void 0&&(h=n.dateUntil);const d=Ny(h,n,[e,t,c]);if(!Zr(d))throw new TypeError("invalid result");return d}function Yf(n,e){const t=n.year(e);if(t===void 0)throw new RangeError("calendar year result must be an integer");return Mr(t)}function qf(n,e){const t=n.month(e);if(t===void 0)throw new RangeError("calendar month result must be a positive integer");return pd(t)}function Id(n,e){const t=n.monthCode(e);if(t===void 0)throw new RangeError("calendar monthCode result must be a string");return Oi(t)}function Xf(n,e){const t=n.day(e);if(t===void 0)throw new RangeError("calendar day result must be a positive integer");return pd(t)}function Zf(n,e){let t=n.era(e);return t!==void 0&&(t=Oi(t)),t}function Kf(n,e){let t=n.eraYear(e);return t!==void 0&&(t=Mr(t)),t}function Uy(n,e){return n.dayOfWeek(e)}function $y(n,e){return n.dayOfYear(e)}function Gy(n,e){return n.weekOfYear(e)}function Vy(n,e){return n.daysInWeek(e)}function Dd(n,e){return n.daysInMonth(e)}function Qf(n,e){return n.daysInYear(e)}function Jf(n,e){return n.monthsInYear(e)}function em(n,e){return n.inLeapYear(e)}function On(n){let e=n;if(Dr(e)){if(An(e,wt))return q(e,wt);if(!("calendar"in e)||(e=e.calendar,Dr(e)&&!("calendar"in e)))return e}const t=Oi(e),c=Pi("%Temporal.Calendar%");if(x_(t))return new c(t);let a;try{({calendar:a}=oa(t))}catch{throw new RangeError(`Invalid calendar: ${t}`)}return a||(a="iso8601"),new c(a)}function Uh(n){if(An(n,wt))return q(n,wt);const{calendar:e}=n;return e===void 0?cn():On(e)}function Ld(n,e){return n===e?!0:Oi(n)===Oi(e)}function t_(n,e){if(n===e)return e;const t=Oi(n),c=Oi(e);if(t===c||t==="iso8601")return e;if(c==="iso8601")return n;throw new RangeError("irreconcilable calendars")}function gl(n,e,t){const c=n.dateFromFields(e,t);if(!or(c))throw new TypeError("invalid result");return c}function vc(n,e,t){const c=n.yearMonthFromFields(e,t);if(!mr(c))throw new TypeError("invalid result");return c}function Mh(n,e,t){const c=n.monthDayFromFields(e,t);if(!Ln(c))throw new TypeError("invalid result");return c}function ps(n){let e=n;if(Dr(e)){if(xi(e))return q(e,br);if(!("timeZone"in e)||(e=e.timeZone,Dr(e)&&!("timeZone"in e)))return e}const t=Y1(Oi(e));return new(Pi("%Temporal.TimeZone%"))(t)}function i_(n,e){return n===e?!0:Oi(n)===Oi(e)}function Ah(n){return So(q(n,ii),q(n,li),q(n,pi),q(n,wt))}function Hy(n){return new(Pi("%Temporal.PlainTime%"))(q(n,ji),q(n,Bi),q(n,Fi),q(n,Ui),q(n,$i),q(n,Gi))}function Oo(n,e){let t=n.getOffsetNanosecondsFor;if(typeof t!="function")throw new TypeError("getOffsetNanosecondsFor not callable");const c=Reflect.apply(t,n,[e]);if(typeof c!="number")throw new TypeError("bad return from getOffsetNanosecondsFor");if(!H1(c)||ur(c)>864e11)throw new RangeError("out-of-range return from getOffsetNanosecondsFor");return c}function sy(n,e){return Yy(Oo(n,e))}function Zs(n,e,t){const c=q(e,Ai),a=Oo(n,e);let{year:h,month:d,day:s,hour:f,minute:b,second:x,millisecond:v,microsecond:g,nanosecond:P}=s_(c);return{year:h,month:d,day:s,hour:f,minute:b,second:x,millisecond:v,microsecond:g,nanosecond:P}=qy(h,d,s,f,b,x,v,g,P+a),zs(h,d,s,f,b,x,v,g,P,t)}function us(n,e,t){return r_(Tf(n,e),n,e,t)}function r_(n,e,t,c){const a=Pi("%Temporal.Instant%"),h=n.length;if(h===1)return n[0];if(h)switch(c){case"compatible":case"earlier":return n[0];case"later":return n[h-1];case"reject":throw new RangeError("multiple instants found")}const d=q(t,ii),s=q(t,li),f=q(t,pi),b=q(t,ji),x=q(t,Bi),v=q(t,Fi),g=q(t,Ui),P=q(t,$i),_=q(t,Gi),S=yl(d,s,f,b,x,v,g,P,_);if(S===null)throw new RangeError("DateTime outside of supported range");const k=new a(he.subtract(S,fl)),A=new a(he.add(S,fl)),y=Oo(e,k),I=Oo(e,A)-y;switch(c){case"earlier":{const D=q(t,wt),w=Pi("%Temporal.PlainDateTime%"),M=ay(d,s,f,b,x,v,g,P,_,D,0,0,0,0,0,0,0,0,0,-I,void 0);return Tf(e,new w(M.year,M.month,M.day,M.hour,M.minute,M.second,M.millisecond,M.microsecond,M.nanosecond,D))[0]}case"compatible":case"later":{const D=q(t,wt),w=Pi("%Temporal.PlainDateTime%"),M=ay(d,s,f,b,x,v,g,P,_,D,0,0,0,0,0,0,0,0,0,I,void 0),z=Tf(e,new w(M.year,M.month,M.day,M.hour,M.minute,M.second,M.millisecond,M.microsecond,M.nanosecond,D));return z[z.length-1]}case"reject":throw new RangeError("no such instant found")}}function Tf(n,e){const t=n.getPossibleInstantsFor(e),c=[];for(const a of t){if(!vn(a))throw new TypeError("bad return from getPossibleInstantsFor");zy.call(c,a)}return c}function Ec(n){let e;return n<0||n>9999?e=(n<0?"-":"+")+`000000${ur(n)}`.slice(-6):e=`0000${n}`.slice(-4),e}function Ur(n){return`00${n}`.slice(-2)}function tm(n,e,t,c,a){if(a==="minute")return"";const h=`:${Ur(n)}`;let d,s=1e6*e+1e3*t+c;if(a==="auto"){if(s===0)return h;for(d=`${s}`.padStart(9,"0");d[d.length-1]==="0";)d=d.slice(0,-1)}else{if(a===0)return h;d=`${s}`.padStart(9,"0").slice(0,a)}return`${h}.${d}`}function vb(n,e,t){let c=e;c===void 0&&(c=new(Pi("%Temporal.TimeZone%"))("UTC"));const a=Zs(c,n,cn()),h=Ec(q(a,ii)),d=Ur(q(a,li)),s=Ur(q(a,pi)),f=Ur(q(a,ji)),b=Ur(q(a,Bi)),x=tm(q(a,Fi),q(a,Ui),q(a,$i),q(a,Gi),t);let v="Z";return e!==void 0&&(v=n_(Oo(c,n))),`${h}-${d}-${s}T${f}:${b}${x}${v}`}function Eg(n,e="auto",t){function c(X){return X<=CS?X.toString(10):he.BigInt(X).toString(10)}const a=q(n,is),h=q(n,Dn),d=q(n,vs),s=q(n,rs),f=q(n,ns),b=q(n,ss);let x=q(n,os),v=q(n,as),g=q(n,ls),P=q(n,cs);const _=Qo(a,h,d,s,f,b,x,v,g,P);if(t){const{unit:X,increment:Z,roundingMode:j}=t;({seconds:x,milliseconds:v,microseconds:g,nanoseconds:P}=xl(0,0,0,0,0,0,x,v,g,P,Z,X,j))}const S=[];a&&S.push(`${c(ur(a))}Y`),h&&S.push(`${c(ur(h))}M`),d&&S.push(`${c(ur(d))}W`),s&&S.push(`${c(ur(s))}D`);const k=[];f&&k.push(`${c(ur(f))}H`),b&&k.push(`${c(ur(b))}M`);const A=[];let y,I,D,w,M=Ph(0,0,0,x,v,g,P,0);({quotient:M,remainder:y}=Cn(M,vr)),{quotient:M,remainder:I}=Cn(M,vr),{quotient:w,remainder:D}=Cn(M,vr);const z=1e6*ur(he.toNumber(D))+1e3*ur(he.toNumber(I))+ur(he.toNumber(y));let Y;if(e==="auto"){if(z!==0)for(Y=`${z}`.padStart(9,"0");Y[Y.length-1]==="0";)Y=Y.slice(0,-1)}else e!==0&&(Y=`${z}`.padStart(9,"0").slice(0,e));return Y&&A.unshift(".",Y),he.equal(w,on)&&!A.length&&e==="auto"||A.unshift(By(w).toString()),A.length&&k.push(`${A.join("")}S`),k.length&&k.unshift("T"),S.length||k.length?`${_<0?"-":""}P${S.join("")}${k.join("")}`:"PT0S"}function _b(n,e="auto"){return`${Ec(q(n,ii))}-${Ur(q(n,li))}-${Ur(q(n,pi))}${Sd(Oi(q(n,wt)),e)}`}function wb(n,e,t="auto",c){let a=q(n,ii),h=q(n,li),d=q(n,pi),s=q(n,ji),f=q(n,Bi),b=q(n,Fi),x=q(n,Ui),v=q(n,$i),g=q(n,Gi);if(c){const{unit:P,increment:_,roundingMode:S}=c;({year:a,month:h,day:d,hour:s,minute:f,second:b,millisecond:x,microsecond:v,nanosecond:g}=ex(a,h,d,s,f,b,x,v,g,_,P,S))}return`${Ec(a)}-${Ur(h)}-${Ur(d)}T${Ur(s)}:${Ur(f)}${tm(b,x,v,g,e)}${Sd(Oi(q(n,wt)),t)}`}function Tb(n,e="auto"){let t=`${Ur(q(n,li))}-${Ur(q(n,pi))}`;const c=Oi(q(n,wt));(e==="always"||c!=="iso8601")&&(t=`${Ec(q(n,ii))}-${t}`);const a=Sd(c,e);return a&&(t+=a),t}function Eb(n,e="auto"){let t=`${Ec(q(n,ii))}-${Ur(q(n,li))}`;const c=Oi(q(n,wt));(e==="always"||c!=="iso8601")&&(t+=`-${Ur(q(n,pi))}`);const a=Sd(c,e);return a&&(t+=a),t}function Cb(n,e,t="auto",c="auto",a="auto",h){let d=q(n,Kn);if(h){const{unit:x,increment:v,roundingMode:g}=h,P=Cf(q(n,Ai),v,x,g);d=new(Pi("%Temporal.Instant%"))(P)}const s=q(n,br),f=Zs(s,d,cn());let b=`${Ec(q(f,ii))}-${Ur(q(f,li))}-${Ur(q(f,pi))}T${Ur(q(f,ji))}:${Ur(q(f,Bi))}${tm(q(f,Fi),q(f,Ui),q(f,$i),q(f,Gi),e)}`;return a!=="never"&&(b+=n_(Oo(s,d))),c!=="never"&&(b+=`[${s}]`),b+=Sd(Oi(q(n,wt)),t),b}function id(n){return b_.test(Cd(n))}function _c(n){const e=b_.exec(Cd(n));if(!e)throw new RangeError(`invalid time zone offset: ${n}`);return(e[1]==="-"||e[1]==="−"?-1:1)*(1e9*(60*(60*+e[2]+ +(e[3]||0))+ +(e[4]||0))+ +((e[5]||0)+"000000000").slice(0,9))}function Wy(n){return id(n)?Yy(_c(n)):W1(Cd(n)).resolvedOptions().timeZone}function Ma(n,e){const{year:t,month:c,day:a,hour:h,minute:d,second:s,millisecond:f,microsecond:b,nanosecond:x}=o_(n,e),v=yl(t,c,a,h,d,s,f,b,x);if(v===null)throw new RangeError("Date outside of supported range");return he.toNumber(he.subtract(v,n))}function Yy(n){const e=n<0?"-":"+",t=ur(n),c=t%1e9,a=kn(t/1e9)%60,h=kn(t/6e10)%60,d=Ur(kn(t/36e11)),s=Ur(h),f=Ur(a);let b="";if(c){let x=`${c}`.padStart(9,"0");for(;x[x.length-1]==="0";)x=x.slice(0,-1);b=`:${f}.${x}`}else a&&(b=`:${f}`);return`${e}${d}:${s}${b}`}function n_(n){let e=he.toNumber(Ls(he.BigInt(n),6e10,"halfExpand"));const t=e<0?"-":"+";e=ur(e);const c=e/6e10%60;return`${t}${Ur(kn(e/36e11))}:${Ur(c)}`}function yl(n,e,t,c,a,h,d,s,f){const b=new Date;b.setUTCHours(c,a,h,d),b.setUTCFullYear(n,e-1,t);const x=b.getTime();if(Ed(x))return null;let v=he.multiply(he.BigInt(x),ho);return v=he.add(v,he.multiply(he.BigInt(s),vr)),v=he.add(v,he.BigInt(f)),he.lessThan(v,hd)||he.greaterThan(v,ud)?null:v}function s_(n){const{quotient:e,remainder:t}=Cn(n,ho);let c=he.toNumber(e),a=he.toNumber(t);a<0&&(a+=1e6,c-=1);const h=kn(a/1e3)%1e3,d=a%1e3,s=new Date(c);return{epochMilliseconds:c,year:s.getUTCFullYear(),month:s.getUTCMonth()+1,day:s.getUTCDate(),hour:s.getUTCHours(),minute:s.getUTCMinutes(),second:s.getUTCSeconds(),millisecond:s.getUTCMilliseconds(),microsecond:h,nanosecond:d}}function o_(n,e){const{epochMilliseconds:t,millisecond:c,microsecond:a,nanosecond:h}=s_(n),{year:d,month:s,day:f,hour:b,minute:x,second:v}=function(P,_){const S=W1(P);return function(A){const y=A.split(/[^\w]+/);if(y.length!==7)throw new RangeError(`expected 7 parts in "${A}`);const I=+y[0],D=+y[1];let w=+y[2];const M=y[3].toUpperCase();if(M==="B"||M==="BC")w=1-w;else if(M!=="A"&&M!=="AD")throw new RangeError(`Unknown era ${M} in "${A}`);let z=+y[4];z===24&&(z=0);const Y=+y[5],X=+y[6];if(!(Rn(w)&&Rn(I)&&Rn(D)&&Rn(z)&&Rn(Y)&&Rn(X)))throw new RangeError(`Invalid number in "${A}`);return{year:w,month:I,day:D,hour:z,minute:Y,second:X}}(S.format(new Date(_)))}(e,t);return qy(d,s,f,b,x,v,c,a,h)}function Sb(n,e){return he.lessThan(n,e)?e:n}function a_(){return he.add(ix(),AS)}function l_(n,e){const t=a_(),c=he.greaterThan(n,t),a=c?he.subtract(n,G1):$1;let h=he.subtract(n,jy);const d=Ma(h,e);let s=h,f=d;for(;d===f&&he.greaterThan(h,a);)s=he.subtract(h,V1),f=Ma(s,e),d===f&&(h=s);return d===f?c?l_(he.subtract(t,fl),e):null:v_(b=>Ma(b,e),s,h,f,d)}function cl(n){return n===void 0?!1:n%4==0&&(n%100!=0||n%400==0)}function Da(n,e){return{standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]}[cl(n)?"leapyear":"standard"][e-1]}function Cg(n,e,t){const c=e+(e<3?10:-2),a=n-(e<3?1:0),h=kn(a/100),d=a-100*h,s=(t+kn(2.6*c-.2)+(d+kn(d/4))+(kn(h/4)-2*h))%7;return s+(s<=0?7:0)}function Ef(n,e,t){let c=t;for(let a=e-1;a>0;a--)c+=Da(n,a);return c}function Qo(n,e,t,c,a,h,d,s,f,b){for(const x of[n,e,t,c,a,h,d,s,f,b])if(x!==0)return x<0?-1:1;return 0}function sf(n,e){let t=n,c=e;if(!Rn(t)||!Rn(c))throw new RangeError("infinity is out of range");return c-=1,t+=kn(c/12),c%=12,c<0&&(c+=12),c+=1,{year:t,month:c}}function im(n,e,t){let c=n,a=e,h=t;if(!Rn(h))throw new RangeError("infinity is out of range");({year:c,month:a}=sf(c,a));let d=0,s=a>2?c:c-1;for(;d=cl(s)?366:365,h<-d;)c-=1,s-=1,h+=d;for(s+=1;d=cl(s)?366:365,h>d;)c+=1,s+=1,h-=d;for(;h<1;)({year:c,month:a}=sf(c,a-1)),h+=Da(c,a);for(;h>Da(c,a);)h-=Da(c,a),{year:c,month:a}=sf(c,a+1);return{year:c,month:a,day:h}}function qy(n,e,t,c,a,h,d,s,f){const{deltaDays:b,hour:x,minute:v,second:g,millisecond:P,microsecond:_,nanosecond:S}=Aa(c,a,h,d,s,f),{year:k,month:A,day:y}=im(n,e,t+b);return{year:k,month:A,day:y,hour:x,minute:v,second:g,millisecond:P,microsecond:_,nanosecond:S}}function Aa(n,e,t,c,a,h){let d=n,s=e,f=t,b=c,x=a,v=h;if(!(Rn(d)&&Rn(s)&&Rn(f)&&Rn(b)&&Rn(x)&&Rn(v)))throw new RangeError("infinity is out of range");x+=kn(v/1e3),v=mh(v,1e3),b+=kn(x/1e3),x=mh(x,1e3),f+=kn(b/1e3),b=mh(b,1e3),s+=kn(f/60),f=mh(f,60),d+=kn(s/60),s=mh(s,60);const g=kn(d/24);return d=mh(d,24),{deltaDays:g,hour:d,minute:s,second:f,millisecond:b,microsecond:x,nanosecond:v}}function Ph(n,e,t,c,a,h,d,s){const f=he.BigInt(n);let b=he.BigInt(d);n!==0&&(b=he.subtract(he.BigInt(d),he.BigInt(s)));const x=he.add(he.BigInt(e),he.multiply(f,he.BigInt(24))),v=he.add(he.BigInt(t),he.multiply(x,uc)),g=he.add(he.BigInt(c),he.multiply(v,uc)),P=he.add(he.BigInt(a),he.multiply(g,vr)),_=he.add(he.BigInt(h),he.multiply(P,vr));return he.add(he.BigInt(b),he.multiply(_,vr))}function Xy(n,e){const t=Pi("%Temporal.Instant%"),c=cd(he.toNumber(n));let a=he.BigInt(n),h=864e11;if(c===0)return{days:0,nanoseconds:on,dayLengthNs:h};if(!xi(e)){let y;return{quotient:y,remainder:a}=Cn(a,he.BigInt(h)),{days:he.toNumber(y),nanoseconds:a,dayLengthNs:h}}const d=q(e,Ai),s=q(e,Kn),f=he.add(d,a),b=new t(f),x=q(e,br),v=q(e,wt),g=Zs(x,s,v),P=Zs(x,b,v);let{days:_}=Jy(q(g,ii),q(g,li),q(g,pi),q(g,ji),q(g,Bi),q(g,Fi),q(g,Ui),q(g,$i),q(g,Gi),q(P,ii),q(P,li),q(P,pi),q(P,ji),q(P,Bi),q(P,Fi),q(P,Ui),q(P,$i),q(P,Gi),v,"day",Vn(null)),S=uo(s,x,v,0,0,0,_,0,0,0,0,0,0);if(c===1)for(;_>0&&he.greaterThan(S,f);)--_,S=uo(s,x,v,0,0,0,_,0,0,0,0,0,0);a=he.subtract(f,S);let k=!1,A=new t(S);do{const y=uo(A,x,v,0,0,0,c,0,0,0,0,0,0),I=q(A,Ai);h=he.toNumber(he.subtract(y,I)),k=he.greaterThan(he.multiply(he.subtract(a,he.BigInt(h)),he.BigInt(c)),on),k&&(a=he.subtract(a,he.BigInt(h)),A=new t(y),_+=c)}while(k);return{days:_,nanoseconds:a,dayLengthNs:ur(h)}}function Us(n,e,t,c,a,h,d,s,f){let b,x,v,g,P,_,S=n;if(xi(f)){const A=uo(q(f,Kn),q(f,br),q(f,wt),0,0,0,S,e,t,c,a,h,d),y=q(f,Ai);b=he.subtract(A,y)}else b=Ph(S,e,t,c,a,h,d,0);s==="year"||s==="month"||s==="week"||s==="day"?{days:S,nanoseconds:b}=Xy(b,f):S=0;const k=he.lessThan(b,on)?-1:1;switch(b=By(b),x=v=g=P=_=on,s){case"year":case"month":case"week":case"day":case"hour":({quotient:x,remainder:b}=Cn(b,vr)),{quotient:v,remainder:x}=Cn(x,vr),{quotient:g,remainder:v}=Cn(v,vr),{quotient:P,remainder:g}=Cn(g,uc),{quotient:_,remainder:P}=Cn(P,uc);break;case"minute":({quotient:x,remainder:b}=Cn(b,vr)),{quotient:v,remainder:x}=Cn(x,vr),{quotient:g,remainder:v}=Cn(v,vr),{quotient:P,remainder:g}=Cn(g,uc);break;case"second":({quotient:x,remainder:b}=Cn(b,vr)),{quotient:v,remainder:x}=Cn(x,vr),{quotient:g,remainder:v}=Cn(v,vr);break;case"millisecond":({quotient:x,remainder:b}=Cn(b,vr)),{quotient:v,remainder:x}=Cn(x,vr);break;case"microsecond":({quotient:x,remainder:b}=Cn(b,vr));break;case"nanosecond":break;default:throw new Error("assert not reached")}return{days:S,hours:he.toNumber(_)*k,minutes:he.toNumber(P)*k,seconds:he.toNumber(g)*k,milliseconds:he.toNumber(v)*k,microseconds:he.toNumber(x)*k,nanoseconds:he.toNumber(b)*k}}function Wp(n,e,t,c,a,h){let d=n,s=e,f=t,b=c;const x=Pi("%Temporal.Duration%"),v=Qo(d,s,f,b,0,0,0,0,0,0);let g,P;h&&(P=kr(h),g=q(P,wt));const _=new x(v),S=new x(0,v),k=new x(0,0,v);switch(a){case"year":break;case"month":{if(!g)throw new RangeError("a starting point is required for months balancing");const A=g.dateAdd,y=g.dateUntil;let I=P;for(;ur(d)>0;){const D=hs(g,I,_,void 0,A),w=Vn(null);w.largestUnit="month";const M=q(ml(g,I,D,w,y),Dn);I=D,s+=M,d-=v}}break;case"week":if(!g)throw new RangeError("a starting point is required for weeks balancing");for(;ur(d)>0;){let A;({relativeTo:P,days:A}=Zn(g,P,_)),b+=A,d-=v}for(;ur(s)>0;){let A;({relativeTo:P,days:A}=Zn(g,P,S)),b+=A,s-=v}break;default:for(;ur(d)>0;){if(!g)throw new RangeError("a starting point is required for balancing calendar units");let A;({relativeTo:P,days:A}=Zn(g,P,_)),b+=A,d-=v}for(;ur(s)>0;){if(!g)throw new RangeError("a starting point is required for balancing calendar units");let A;({relativeTo:P,days:A}=Zn(g,P,S)),b+=A,s-=v}for(;ur(f)>0;){if(!g)throw new RangeError("a starting point is required for balancing calendar units");let A;({relativeTo:P,days:A}=Zn(g,P,k)),b+=A,f-=v}}return{years:d,months:s,weeks:f,days:b}}function kb(n,e,t,c,a){if(xi(n)){const h=q(n,Kn),d=q(n,br),s=q(n,wt),f=Oo(d,h),b=uo(h,d,s,e,t,c,a,0,0,0,0,0,0);return Oo(d,new(Pi("%Temporal.Instant%"))(b))-f}return 0}function c_(n){return new(Pi("%Temporal.Duration%"))(-q(n,is),-q(n,Dn),-q(n,vs),-q(n,rs),-q(n,ns),-q(n,ss),-q(n,os),-q(n,as),-q(n,ls),-q(n,cs))}function Ns(n,e,t){return wS(t,TS(e,n))}function h_(n,e,t){const c=Ns(e,1,12);return{year:n,month:c,day:Ns(t,1,Da(n,c))}}function Un(n,e,t){if(n<e||n>t)throw new RangeError(`value out of range: ${e} <= ${n} <= ${t}`)}function ea(n,e,t){Un(e,1,12),Un(t,1,Da(n,e))}function u_(n,e,t){d_(n,e,t,12,0,0,0,0,0)}function rm(n,e,t,c,a,h){Un(n,0,23),Un(e,0,59),Un(t,0,59),Un(c,0,999),Un(a,0,999),Un(h,0,999)}function Zy(n,e,t,c,a,h,d,s,f){ea(n,e,t),rm(c,a,h,d,s,f)}function d_(n,e,t,c,a,h,d,s,f){if(Un(n,-271821,275760),n===-271821&&yl(n,e,t+1,c,a,h,d,s,f-1)==null||n===275760&&yl(n,e,t-1,c,a,h,d,s,f+1)==null)throw new RangeError("DateTime outside of supported range")}function oc(n){if(he.lessThan(n,hd)||he.greaterThan(n,ud))throw new RangeError("Instant outside of supported range")}function nm(n,e,t,c,a,h,d,s,f,b){const x=Qo(n,e,t,c,a,h,d,s,f,b);for(const v of[n,e,t,c,a,h,d,s,f,b]){if(!Rn(v))throw new RangeError("infinite values not allowed as duration fields");const g=cd(v);if(g!==0&&g!==x)throw new RangeError("mixed-sign values not allowed as duration fields")}}function Ky(n,e,t,c,a,h,d){switch(d){case"year":case"month":{const s=-hl(n,e,t,c,a,h);if(s===0)return{years:0,months:0,weeks:0,days:0};const f={year:n,month:e,day:t},b={year:c,month:a,day:h};let x=b.year-f.year,v=dc(n,e,t,x,0,0,0,"constrain"),g=-hl(v.year,v.month,v.day,c,a,h);if(g===0)return d==="year"?{years:x,months:0,weeks:0,days:0}:{years:0,months:12*x,weeks:0,days:0};let P=b.month-f.month;if(g!==s&&(x-=s,P+=12*s),v=dc(n,e,t,x,P,0,0,"constrain"),g=-hl(v.year,v.month,v.day,c,a,h),g===0)return d==="year"?{years:x,months:P,weeks:0,days:0}:{years:0,months:P+12*x,weeks:0,days:0};g!==s&&(P-=s,P===-s&&(x-=s,P=11*s),v=dc(n,e,t,x,P,0,0,"constrain"));let _=0;return _=v.month===b.month?b.day-v.day:s<0?-v.day-(Da(b.year,b.month)-b.day):b.day+(Da(v.year,v.month)-v.day),d==="month"&&(P+=12*x,x=0),{years:x,months:P,weeks:0,days:_}}case"week":case"day":{let s,f,b;hl(n,e,t,c,a,h)<0?(f={year:n,month:e,day:t},s={year:c,month:a,day:h},b=1):(f={year:c,month:a,day:h},s={year:n,month:e,day:t},b=-1);let x=Ef(s.year,s.month,s.day)-Ef(f.year,f.month,f.day);for(let g=f.year;g<s.year;++g)x+=cl(g)?366:365;let v=0;return d==="week"&&(v=kn(x/7),x%=7),v*=b,x*=b,{years:0,months:0,weeks:v,days:x}}default:throw new Error("assert not reached")}}function p_(n,e,t,c,a,h,d,s,f,b,x,v){let g=d-n,P=s-e,_=f-t,S=b-c,k=x-a,A=v-h;const y=Qo(0,0,0,0,g,P,_,S,k,A);g*=y,P*=y,_*=y,S*=y,k*=y,A*=y;let I=0;if({deltaDays:I,hour:g,minute:P,second:_,millisecond:S,microsecond:k,nanosecond:A}=Aa(g,P,_,S,k,A),I!=0)throw new Error("assertion failure in DifferenceTime: _bt_.[[Days]] should be 0");return g*=y,P*=y,_*=y,S*=y,k*=y,A*=y,{hours:g,minutes:P,seconds:_,milliseconds:S,microseconds:k,nanoseconds:A}}function Qy(n,e,t,c,a){const h=he.subtract(e,n),d=he.remainder(h,he.BigInt(864e11)),s=he.subtract(h,d),f=Ls(d,rx[c]*t,a),b=he.add(s,f),x=he.toNumber(he.remainder(b,vr)),v=he.toNumber(he.remainder(he.divide(b,vr),vr)),g=he.toNumber(he.remainder(he.divide(b,ho),vr));return{seconds:he.toNumber(he.divide(b,Ia)),milliseconds:g,microseconds:v,nanoseconds:x}}function Jy(n,e,t,c,a,h,d,s,f,b,x,v,g,P,_,S,k,A,y,I,D){let w=n,M=e,z=t,{hours:Y,minutes:X,seconds:Z,milliseconds:j,microseconds:V,nanoseconds:$}=p_(c,a,h,d,s,f,g,P,_,S,k,A);const R=Qo(0,0,0,0,Y,X,Z,j,V,$);hl(b,x,v,w,M,z)===-R&&({year:w,month:M,day:z}=im(w,M,z-R),{hours:Y,minutes:X,seconds:Z,milliseconds:j,microseconds:V,nanoseconds:$}=Us(-R,Y,X,Z,j,V,$,I));const L=So(w,M,z,y),G=So(b,x,v,y),U=Wf(D,$s("day",I));let{years:F,months:H,weeks:W,days:ne}=ml(y,L,G,U);return{days:ne,hours:Y,minutes:X,seconds:Z,milliseconds:j,microseconds:V,nanoseconds:$}=Us(ne,Y,X,Z,j,V,$,I),{years:F,months:H,weeks:W,days:ne,hours:Y,minutes:X,seconds:Z,milliseconds:j,microseconds:V,nanoseconds:$}}function f_(n,e,t,c,a,h){const d=he.subtract(e,n);if(he.equal(d,on))return{years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};const s=Pi("%Temporal.Instant%"),f=new s(n),b=new s(e),x=Zs(t,f,c),v=Zs(t,b,c);let{years:g,months:P,weeks:_,days:S}=Jy(q(x,ii),q(x,li),q(x,pi),q(x,ji),q(x,Bi),q(x,Fi),q(x,Ui),q(x,$i),q(x,Gi),q(v,ii),q(v,li),q(v,pi),q(v,ji),q(v,Bi),q(v,Fi),q(v,Ui),q(v,$i),q(v,Gi),c,a,h);const k=uo(f,t,c,g,P,_,0,0,0,0,0,0,0);let A=he.subtract(e,k);const y=Bn(k,t,c);({nanoseconds:A,days:S}=Xy(A,y));const{hours:I,minutes:D,seconds:w,milliseconds:M,microseconds:z,nanoseconds:Y}=Us(0,0,0,0,0,0,he.toNumber(A),"hour");return{years:g,months:P,weeks:_,days:S,hours:I,minutes:D,seconds:w,milliseconds:M,microseconds:z,nanoseconds:Y}}function Mb(n,e,t,c){const a=Zo(t);let h,d;[h,d]=n==="until"?[e,a]:[a,e];const s=Qi(c),f=Mn(s,"smallestUnit","time","nanosecond"),b=$s("second",f);let x=Mn(s,"largestUnit","time","auto");if(x==="auto"&&(x=b),$s(x,f)!==x)throw new RangeError(`largestUnit ${x} cannot be smaller than smallestUnit ${f}`);const v=ws(s,"trunc"),g=Oa(s,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[f],!1),P=q(h,Ai),_=q(d,Ai);let S,k,{seconds:A,milliseconds:y,microseconds:I,nanoseconds:D}=Qy(P,_,g,f,v);return{hours:S,minutes:k,seconds:A,milliseconds:y,microseconds:I,nanoseconds:D}=Us(0,0,0,A,y,I,D,x),new(Pi("%Temporal.Duration%"))(0,0,0,0,S,k,A,y,I,D)}function Ab(n,e,t,c){const a=n==="since"?-1:1,h=kr(t),d=q(e,wt),s=q(h,wt),f=Oi(d),b=Oi(s);if(f!==b)throw new RangeError(`cannot compute difference between dates of ${f} and ${b} calendars`);const x=Qi(c),v=Mn(x,"smallestUnit","date","day"),g=$s("day",v);let P=Mn(x,"largestUnit","date","auto");if(P==="auto"&&(P=g),$s(P,v)!==P)throw new RangeError(`largestUnit ${P} cannot be smaller than smallestUnit ${v}`);let _=ws(x,"trunc");n==="since"&&(_=kd(_));const S=Oa(x,void 0,!1),k=Wf(x,P);let{years:A,months:y,weeks:I,days:D}=ml(d,e,h,k);return v==="day"&&S===1||({years:A,months:y,weeks:I,days:D}=xl(A,y,I,D,0,0,0,0,0,0,S,v,_,e)),new(Pi("%Temporal.Duration%"))(a*A,a*y,a*I,a*D,0,0,0,0,0,0)}function Pb(n,e,t,c){const a=n==="since"?-1:1,h=lc(t),d=q(e,wt),s=q(h,wt),f=Oi(d),b=Oi(s);if(f!==b)throw new RangeError(`cannot compute difference between dates of ${f} and ${b} calendars`);const x=Qi(c),v=Mn(x,"smallestUnit","datetime","nanosecond"),g=$s("day",v);let P=Mn(x,"largestUnit","datetime","auto");if(P==="auto"&&(P=g),$s(P,v)!==P)throw new RangeError(`largestUnit ${P} cannot be smaller than smallestUnit ${v}`);let _=ws(x,"trunc");n==="since"&&(_=kd(_));const S=Fy(x,v);let{years:k,months:A,weeks:y,days:I,hours:D,minutes:w,seconds:M,milliseconds:z,microseconds:Y,nanoseconds:X}=Jy(q(e,ii),q(e,li),q(e,pi),q(e,ji),q(e,Bi),q(e,Fi),q(e,Ui),q(e,$i),q(e,Gi),q(h,ii),q(h,li),q(h,pi),q(h,ji),q(h,Bi),q(h,Fi),q(h,Ui),q(h,$i),q(h,Gi),d,P,x);const Z=Ah(e);return{years:k,months:A,weeks:y,days:I,hours:D,minutes:w,seconds:M,milliseconds:z,microseconds:Y,nanoseconds:X}=xl(k,A,y,I,D,w,M,z,Y,X,S,v,_,Z),{days:I,hours:D,minutes:w,seconds:M,milliseconds:z,microseconds:Y,nanoseconds:X}=Us(I,D,w,M,z,Y,X,P),new(Pi("%Temporal.Duration%"))(a*k,a*A,a*y,a*I,a*D,a*w,a*M,a*z,a*Y,a*X)}function Ib(n,e,t,c){const a=n==="since"?-1:1,h=Pa(t),d=Qi(c);let s=Mn(d,"largestUnit","time","auto");s==="auto"&&(s="hour");const f=Mn(d,"smallestUnit","time","nanosecond");if($s(s,f)!==s)throw new RangeError(`largestUnit ${s} cannot be smaller than smallestUnit ${f}`);let b=ws(d,"trunc");n==="since"&&(b=kd(b));const x=Oa(d,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[f],!1);let{hours:v,minutes:g,seconds:P,milliseconds:_,microseconds:S,nanoseconds:k}=p_(q(e,ji),q(e,Bi),q(e,Fi),q(e,Ui),q(e,$i),q(e,Gi),q(h,ji),q(h,Bi),q(h,Fi),q(h,Ui),q(h,$i),q(h,Gi));return{hours:v,minutes:g,seconds:P,milliseconds:_,microseconds:S,nanoseconds:k}=xl(0,0,0,0,v,g,P,_,S,k,x,f,b),{hours:v,minutes:g,seconds:P,milliseconds:_,microseconds:S,nanoseconds:k}=Us(0,v,g,P,_,S,k,s),new(Pi("%Temporal.Duration%"))(0,0,0,0,a*v,a*g,a*P,a*_,a*S,a*k)}function Db(n,e,t,c){const a=n==="since"?-1:1,h=ed(t),d=q(e,wt),s=q(h,wt),f=Oi(d),b=Oi(s);if(f!==b)throw new RangeError(`cannot compute difference between months of ${f} and ${b} calendars`);const x=Qi(c),v=Bh.reduce((Y,[X,Z,j])=>(j==="date"&&Z!=="week"&&Z!=="day"&&Y.push(Z,X),Y),[]),g=Mn(x,"smallestUnit","date","month");if(g==="week"||g==="day")throw new RangeError(`smallestUnit must be one of ${v.join(", ")}, not ${g}`);let P=Mn(x,"largestUnit","date","auto");if(P==="week"||P==="day")throw new RangeError(`largestUnit must be one of ${v.join(", ")}, not ${P}`);if(P==="auto"&&(P="year"),$s(P,g)!==P)throw new RangeError(`largestUnit ${P} cannot be smaller than smallestUnit ${g}`);let _=ws(x,"trunc");n==="since"&&(_=kd(_));const S=Oa(x,void 0,!1),k=fn(d,["monthCode","year"]),A=Zi(h,k,[]);A.day=1;const y=Zi(e,k,[]);y.day=1;const I=gl(d,A),D=gl(d,y),w=Wf(x,P);let{years:M,months:z}=ml(d,D,I,w);return g==="month"&&S===1||({years:M,months:z}=xl(M,z,0,0,0,0,0,0,0,0,S,g,_,D)),new(Pi("%Temporal.Duration%"))(a*M,a*z,0,0,0,0,0,0,0,0)}function Lb(n,e,t,c){const a=n==="since"?-1:1,h=td(t),d=q(e,wt),s=q(h,wt),f=Oi(d),b=Oi(s);if(f!==b)throw new RangeError(`cannot compute difference between dates of ${f} and ${b} calendars`);const x=Qi(c),v=Mn(x,"smallestUnit","datetime","nanosecond"),g=$s("hour",v);let P=Mn(x,"largestUnit","datetime","auto");if(P==="auto"&&(P=g),$s(P,v)!==P)throw new RangeError(`largestUnit ${P} cannot be smaller than smallestUnit ${v}`);let _=ws(x,"trunc");n==="since"&&(_=kd(_));const S=Fy(x,v),k=q(e,Ai),A=q(h,Ai);let y,I,D,w,M,z,Y,X,Z,j;if(P!=="year"&&P!=="month"&&P!=="week"&&P!=="day")y=0,I=0,D=0,w=0,{seconds:Y,milliseconds:X,microseconds:Z,nanoseconds:j}=Qy(k,A,S,v,_),{hours:M,minutes:z,seconds:Y,milliseconds:X,microseconds:Z,nanoseconds:j}=Us(0,0,0,Y,X,Z,j,P);else{const V=q(e,br);if(!i_(V,q(h,br)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");const $=Wf(x,P);({years:y,months:I,weeks:D,days:w,hours:M,minutes:z,seconds:Y,milliseconds:X,microseconds:Z,nanoseconds:j}=f_(k,A,V,d,P,$)),{years:y,months:I,weeks:D,days:w,hours:M,minutes:z,seconds:Y,milliseconds:X,microseconds:Z,nanoseconds:j}=xl(y,I,D,w,M,z,Y,X,Z,j,S,v,_,e),{years:y,months:I,weeks:D,days:w,hours:M,minutes:z,seconds:Y,milliseconds:X,microseconds:Z,nanoseconds:j}=y_(y,I,D,w,M,z,Y,X,Z,j,S,v,_,e)}return new(Pi("%Temporal.Duration%"))(a*y,a*I,a*D,a*w,a*M,a*z,a*Y,a*X,a*Z,a*j)}function dc(n,e,t,c,a,h,d,s){let f=n,b=e,x=t,v=h,g=d;return f+=c,b+=a,{year:f,month:b}=sf(f,b),{year:f,month:b,day:x}=vf(f,b,x,s),g+=7*v,x+=g,{year:f,month:b,day:x}=im(f,b,x),{year:f,month:b,day:x}}function m_(n,e,t,c,a,h,d,s,f,b,x,v){let g=n,P=e,_=t,S=c,k=a,A=h;g+=d,P+=s,_+=f,S+=b,k+=x,A+=v;let y=0;return{deltaDays:y,hour:g,minute:P,second:_,millisecond:S,microsecond:k,nanosecond:A}=Aa(g,P,_,S,k,A),{deltaDays:y,hour:g,minute:P,second:_,millisecond:S,microsecond:k,nanosecond:A}}function g_(n,e,t,c,a,h,d,s,f,b,x,v,g,P,_,S,k,A,y,I,D){const w=$s(ny(n,e,t,c,a,h,d,s,f,b),ny(x,v,g,P,_,S,k,A,y,I));let M,z,Y,X,Z,j,V,$,R,L;if(D)if(or(D)){const G=Pi("%Temporal.Duration%"),U=q(D,wt),F=new G(n,e,t,c,0,0,0,0,0,0),H=new G(x,v,g,P,0,0,0,0,0,0),W=U.dateAdd,ne=hs(U,D,F,void 0,W),ue=hs(U,ne,H,void 0,W),ie=$s("day",w),oe=Vn(null);oe.largestUnit=ie,{years:M,months:z,weeks:Y,days:X}=ml(U,D,ue,oe),{days:X,hours:Z,minutes:j,seconds:V,milliseconds:$,microseconds:R,nanoseconds:L}=Us(X,a+_,h+S,d+k,s+A,f+y,b+I,w)}else{const G=Pi("%Temporal.Instant%"),U=q(D,br),F=q(D,wt),H=uo(q(D,Kn),U,F,n,e,t,c,a,h,d,s,f,b),W=uo(new G(H),U,F,x,v,g,P,_,S,k,A,y,I);w!=="year"&&w!=="month"&&w!=="week"&&w!=="day"?(M=0,z=0,Y=0,X=0,{seconds:V,milliseconds:$,microseconds:R,nanoseconds:L}=Qy(q(D,Ai),W,1,"nanosecond","halfExpand"),{hours:Z,minutes:j,seconds:V,milliseconds:$,microseconds:R,nanoseconds:L}=Us(0,0,0,V,$,R,L,w)):{years:M,months:z,weeks:Y,days:X,hours:Z,minutes:j,seconds:V,milliseconds:$,microseconds:R,nanoseconds:L}=f_(q(D,Ai),W,U,F,w,Vn(null))}else{if(w==="year"||w==="month"||w==="week")throw new RangeError("relativeTo is required for years, months, or weeks arithmetic");M=z=Y=0,{days:X,hours:Z,minutes:j,seconds:V,milliseconds:$,microseconds:R,nanoseconds:L}=Us(c+P,a+_,h+S,d+k,s+A,f+y,b+I,w)}return nm(M,z,Y,X,Z,j,V,$,R,L),{years:M,months:z,weeks:Y,days:X,hours:Z,minutes:j,seconds:V,milliseconds:$,microseconds:R,nanoseconds:L}}function oy(n,e,t,c,a,h,d){let s=on;s=he.add(s,he.BigInt(d)),s=he.add(s,he.multiply(he.BigInt(h),vr)),s=he.add(s,he.multiply(he.BigInt(a),ho)),s=he.add(s,he.multiply(he.BigInt(c),Ia)),s=he.add(s,he.multiply(he.BigInt(t),he.BigInt(6e10))),s=he.add(s,he.multiply(he.BigInt(e),he.BigInt(36e11)));const f=he.add(n,s);return oc(f),f}function ay(n,e,t,c,a,h,d,s,f,b,x,v,g,P,_,S,k,A,y,I,D){let w=P,{deltaDays:M,hour:z,minute:Y,second:X,millisecond:Z,microsecond:j,nanosecond:V}=m_(c,a,h,d,s,f,_,S,k,A,y,I);w+=M;const $=Pi("%Temporal.Duration%"),R=hs(b,So(n,e,t,b),new $(x,v,g,w,0,0,0,0,0,0),D);return{year:q(R,ii),month:q(R,li),day:q(R,pi),hour:z,minute:Y,second:X,millisecond:Z,microsecond:j,nanosecond:V}}function uo(n,e,t,c,a,h,d,s,f,b,x,v,g,P){const _=Pi("%Temporal.Duration%");if(Qo(c,a,h,d,0,0,0,0,0,0)===0)return oy(q(n,Ai),s,f,b,x,v,g);const S=Zs(e,n,t),k=hs(t,So(q(S,ii),q(S,li),q(S,pi),t),new _(c,a,h,d,0,0,0,0,0,0),P),A=zs(q(k,ii),q(k,li),q(k,pi),q(S,ji),q(S,Bi),q(S,Fi),q(S,Ui),q(S,$i),q(S,Gi),t);return oy(q(us(e,A,"compatible"),Ai),s,f,b,x,v,g)}function Rb(n,e,t,c){const a=n==="subtract"?-1:1;let{years:h,months:d,weeks:s,days:f,hours:b,minutes:x,seconds:v,milliseconds:g,microseconds:P,nanoseconds:_}=Tc(t);const S=nf(Qi(c));return{years:h,months:d,weeks:s,days:f,hours:b,minutes:x,seconds:v,milliseconds:g,microseconds:P,nanoseconds:_}=g_(q(e,is),q(e,Dn),q(e,vs),q(e,rs),q(e,ns),q(e,ss),q(e,os),q(e,as),q(e,ls),q(e,cs),a*h,a*d,a*s,a*f,a*b,a*x,a*v,a*g,a*P,a*_,S),new(Pi("%Temporal.Duration%"))(h,d,s,f,b,x,v,g,P,_)}function Ob(n,e,t){const c=n==="subtract"?-1:1,{hours:a,minutes:h,seconds:d,milliseconds:s,microseconds:f,nanoseconds:b}=function(g,P){let _=Tc(g);for(const S of P)if(_[S]!==0)throw new RangeError(`Duration field ${S} not supported by Temporal.Instant. Try Temporal.ZonedDateTime instead.`);return _}(t,["years","months","weeks","days"]),x=oy(q(e,Ai),c*a,c*h,c*d,c*s,c*f,c*b);return new(Pi("%Temporal.Instant%"))(x)}function zb(n,e,t,c){const a=n==="subtract"?-1:1,{years:h,months:d,weeks:s,days:f,hours:b,minutes:x,seconds:v,milliseconds:g,microseconds:P,nanoseconds:_}=Tc(t),S=Qi(c),k=q(e,wt),{year:A,month:y,day:I,hour:D,minute:w,second:M,millisecond:z,microsecond:Y,nanosecond:X}=ay(q(e,ii),q(e,li),q(e,pi),q(e,ji),q(e,Bi),q(e,Fi),q(e,Ui),q(e,$i),q(e,Gi),k,a*h,a*d,a*s,a*f,a*b,a*x,a*v,a*g,a*P,a*_,S);return zs(A,y,I,D,w,M,z,Y,X,k)}function Nb(n,e,t){const c=n==="subtract"?-1:1,{hours:a,minutes:h,seconds:d,milliseconds:s,microseconds:f,nanoseconds:b}=Tc(t);let{hour:x,minute:v,second:g,millisecond:P,microsecond:_,nanosecond:S}=m_(q(e,ji),q(e,Bi),q(e,Fi),q(e,Ui),q(e,$i),q(e,Gi),c*a,c*h,c*d,c*s,c*f,c*b);return{hour:x,minute:v,second:g,millisecond:P,microsecond:_,nanosecond:S}=Hf(x,v,g,P,_,S,"reject"),new(Pi("%Temporal.PlainTime%"))(x,v,g,P,_,S)}function jb(n,e,t,c){let a=Tc(t);n==="subtract"&&(a={years:-a.years,months:-a.months,weeks:-a.weeks,days:-a.days,hours:-a.hours,minutes:-a.minutes,seconds:-a.seconds,milliseconds:-a.milliseconds,microseconds:-a.microseconds,nanoseconds:-a.nanoseconds});let{years:h,months:d,weeks:s,days:f,hours:b,minutes:x,seconds:v,milliseconds:g,microseconds:P,nanoseconds:_}=a;({days:f}=Us(f,b,x,v,g,P,_,"day"));const S=Qi(c),k=q(e,wt),A=fn(k,["monthCode","year"]),y=Zi(e,A,[]),I=Qo(h,d,s,f,0,0,0,0,0,0);y.day=I<0?pd(Dd(k,e)):1;const D=gl(k,y),w=new(Pi("%Temporal.Duration%"))(h,d,s,f,0,0,0,0,0,0),M=U1(Vn(null),S);return vc(k,Zi(hs(k,D,w,S),A,[]),M)}function Bb(n,e,t,c){const a=n==="subtract"?-1:1,{years:h,months:d,weeks:s,days:f,hours:b,minutes:x,seconds:v,milliseconds:g,microseconds:P,nanoseconds:_}=Tc(t),S=Qi(c),k=q(e,br),A=q(e,wt);return Bn(uo(q(e,Kn),k,A,a*h,a*d,a*s,a*f,a*b,a*x,a*v,a*g,a*P,a*_,S),k,A)}function Ls(n,e,t){if(e===1)return n;let{quotient:c,remainder:a}=Cn(n,he.BigInt(e));if(he.equal(a,on))return n;const h=he.lessThan(a,on)?-1:1;switch(t){case"ceil":h>0&&(c=he.add(c,he.BigInt(h)));break;case"floor":h<0&&(c=he.add(c,he.BigInt(h)));break;case"trunc":break;case"halfExpand":he.toNumber(By(he.multiply(a,he.BigInt(2))))>=e&&(c=he.add(c,he.BigInt(h)))}return he.multiply(c,he.BigInt(e))}function Cf(n,e,t,c){let a=he.remainder(n,he.BigInt(864e11));he.lessThan(a,on)&&(a=he.add(a,he.BigInt(864e11)));const h=he.subtract(n,a),d=Ls(a,rx[t]*e,c);return he.add(h,d)}function ex(n,e,t,c,a,h,d,s,f,b,x,v,g=864e11){const{deltaDays:P,hour:_,minute:S,second:k,millisecond:A,microsecond:y,nanosecond:I}=tx(c,a,h,d,s,f,b,x,v,g),{year:D,month:w,day:M}=im(n,e,t+P);return{year:D,month:w,day:M,hour:_,minute:S,second:k,millisecond:A,microsecond:y,nanosecond:I}}function tx(n,e,t,c,a,h,d,s,f,b=864e11){let x=on;switch(s){case"day":case"hour":x=he.BigInt(n);case"minute":x=he.add(he.multiply(x,uc),he.BigInt(e));case"second":x=he.add(he.multiply(x,uc),he.BigInt(t));case"millisecond":x=he.add(he.multiply(x,vr),he.BigInt(c));case"microsecond":x=he.add(he.multiply(x,vr),he.BigInt(a));case"nanosecond":x=he.add(he.multiply(x,vr),he.BigInt(h))}const v=s==="day"?b:rx[s],g=Ls(x,v*d,f),P=he.toNumber(he.divide(g,he.BigInt(v)));switch(s){case"day":return{deltaDays:P,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0};case"hour":return Aa(P,0,0,0,0,0);case"minute":return Aa(n,P,0,0,0,0);case"second":return Aa(n,e,P,0,0,0);case"millisecond":return Aa(n,e,t,P,0,0);case"microsecond":return Aa(n,e,t,c,P,0);case"nanosecond":return Aa(n,e,t,c,a,P);default:throw new Error(`Invalid unit ${s}`)}}function of(n,e){return Ky(q(n,ii),q(n,li),q(n,pi),q(e,ii),q(e,li),q(e,pi),"day").days}function Zn(n,e,t){const c=hs(n,e,t,void 0);return{relativeTo:c,days:of(e,c)}}function ly(n,e,t,c,a){const h=q(n,br),d=q(n,wt);return Bn(uo(q(n,Kn),h,d,e,t,c,a,0,0,0,0,0,0),h,d)}function y_(n,e,t,c,a,h,d,s,f,b,x,v,g,P){let _=n,S=e,k=t,A=c,y=a,I=h,D=d,w=s,M=f,z=b;if(!xi(P)||v==="year"||v==="month"||v==="week"||v==="day"||v==="nanosecond"&&x===1)return{years:_,months:S,weeks:k,days:A,hours:y,minutes:I,seconds:D,milliseconds:w,microseconds:M,nanoseconds:z};let Y=Ph(0,y,I,D,w,M,z,0);const X=cd(he.toNumber(Y)),Z=q(P,br),j=q(P,wt),V=uo(q(P,Kn),Z,j,_,S,k,A,0,0,0,0,0,0),$=uo(new(Pi("%Temporal.Instant%"))(V),Z,j,0,0,0,X,0,0,0,0,0,0),R=he.subtract($,V);return he.greaterThanOrEqual(he.multiply(he.subtract(Y,R),he.BigInt(X)),on)&&({years:_,months:S,weeks:k,days:A}=g_(_,S,k,A,0,0,0,0,0,0,0,0,0,X,0,0,0,0,0,0,P),Y=Cf(he.subtract(Y,R),x,v,g),{hours:y,minutes:I,seconds:D,milliseconds:w,microseconds:M,nanoseconds:z}=Us(0,0,0,0,0,0,he.toNumber(Y),"hour")),{years:_,months:S,weeks:k,days:A,hours:y,minutes:I,seconds:D,milliseconds:w,microseconds:M,nanoseconds:z}}function xl(n,e,t,c,a,h,d,s,f,b,x,v,g,P){let _=n,S=e,k=t,A=c,y=a,I=h,D=d,w=s,M=f,z=he.BigInt(b);const Y=Pi("%Temporal.Duration%");let X,Z,j,V,$=P;if($){if(xi($))Z=$,$=kr($);else if(!or($))throw new TypeError("starting point must be PlainDate or ZonedDateTime");X=q($,wt)}if(v==="year"||v==="month"||v==="week"||v==="day"){let R,L,G;z=Ph(0,y,I,D,w,M,b,0),Z&&(R=ly(Z,_,S,k,A)),{days:L,nanoseconds:z,dayLengthNs:G}=Xy(z,R),j=he.BigInt(G),A+=L,y=I=D=w=M=0}switch(v){case"year":{if(!X)throw new RangeError("A starting point is required for years rounding");const R=new Y(_),L=X.dateAdd,G=hs(X,$,R,void 0,L),U=hs(X,$,new Y(_,S,k),void 0,L);$=G,A+=of(G,U);const F=hs(X,$,{days:A},void 0,L),H=Vn(null);H.largestUnit="year";const W=ml(X,$,F,H).years;_+=W;const ne=$;$=hs(X,$,{years:W},void 0,L),A-=of(ne,$);const ue=new Y(A<0?-1:1);let{days:ie}=Zn(X,$,ue);ie=ur(ie);const oe=he.multiply(he.BigInt(ie),j);z=he.add(he.add(he.multiply(oe,he.BigInt(_)),he.multiply(he.BigInt(A),j)),z);const Te=Ls(z,he.toNumber(he.multiply(oe,he.BigInt(x))),g);V=he.toNumber(z)/he.toNumber(oe),_=he.toNumber(he.divide(Te,oe)),z=on,S=k=A=0;break}case"month":{if(!X)throw new RangeError("A starting point is required for months rounding");const R=new Y(_,S),L=X.dateAdd,G=hs(X,$,R,void 0,L),U=hs(X,$,new Y(_,S,k),void 0,L);$=G,A+=of(G,U);const F=cd(A),H=new Y(0,A<0?-1:1);let W;for({relativeTo:$,days:W}=Zn(X,$,H);ur(A)>=ur(W);)S+=F,A-=W,{relativeTo:$,days:W}=Zn(X,$,H);W=ur(W);const ne=he.multiply(he.BigInt(W),j);z=he.add(he.add(he.multiply(ne,he.BigInt(S)),he.multiply(he.BigInt(A),j)),z);const ue=Ls(z,he.toNumber(he.multiply(ne,he.BigInt(x))),g);V=he.toNumber(z)/he.toNumber(ne),S=he.toNumber(he.divide(ue,ne)),z=on,k=A=0;break}case"week":{if(!X)throw new RangeError("A starting point is required for weeks rounding");const R=cd(A),L=new Y(0,0,A<0?-1:1);let G;for({relativeTo:$,days:G}=Zn(X,$,L);ur(A)>=ur(G);)k+=R,A-=G,{relativeTo:$,days:G}=Zn(X,$,L);G=ur(G);const U=he.multiply(he.BigInt(G),j);z=he.add(he.add(he.multiply(U,he.BigInt(k)),he.multiply(he.BigInt(A),j)),z);const F=Ls(z,he.toNumber(he.multiply(U,he.BigInt(x))),g);V=he.toNumber(z)/he.toNumber(U),k=he.toNumber(he.divide(F,U)),z=on,A=0;break}case"day":{const R=j;z=he.add(he.multiply(R,he.BigInt(A)),z);const L=Ls(z,he.toNumber(he.multiply(R,he.BigInt(x))),g);V=he.toNumber(z)/he.toNumber(R),A=he.toNumber(he.divide(L,R)),z=on;break}case"hour":{let L=he.multiply(he.BigInt(y),he.BigInt(36e11));L=he.add(L,he.multiply(he.BigInt(I),he.BigInt(6e10))),L=he.add(L,he.multiply(he.BigInt(D),Ia)),L=he.add(L,he.multiply(he.BigInt(w),ho)),L=he.add(L,he.multiply(he.BigInt(M),vr)),L=he.add(L,z),V=he.toNumber(L)/36e11;const G=Ls(L,36e11*x,g);y=he.toNumber(he.divide(G,he.BigInt(36e11))),z=on,I=D=w=M=0;break}case"minute":{let L=he.multiply(he.BigInt(I),he.BigInt(6e10));L=he.add(L,he.multiply(he.BigInt(D),Ia)),L=he.add(L,he.multiply(he.BigInt(w),ho)),L=he.add(L,he.multiply(he.BigInt(M),vr)),L=he.add(L,z),V=he.toNumber(L)/6e10;const G=Ls(L,6e10*x,g);I=he.toNumber(he.divide(G,he.BigInt(6e10))),z=on,D=w=M=0;break}case"second":{let L=he.multiply(he.BigInt(D),Ia);L=he.add(L,he.multiply(he.BigInt(w),ho)),L=he.add(L,he.multiply(he.BigInt(M),vr)),L=he.add(L,z),V=he.toNumber(L)/1e9;const G=Ls(L,1e9*x,g);D=he.toNumber(he.divide(G,he.BigInt(1e9))),z=on,w=M=0;break}case"millisecond":{let L=he.multiply(he.BigInt(w),ho);L=he.add(L,he.multiply(he.BigInt(M),vr)),L=he.add(L,z),V=he.toNumber(L)/1e6;const G=Ls(L,1e6*x,g);w=he.toNumber(he.divide(G,he.BigInt(1e6))),z=on,M=0;break}case"microsecond":{let L=he.multiply(he.BigInt(M),vr);L=he.add(L,z),V=he.toNumber(L)/1e3;const G=Ls(L,1e3*x,g);M=he.toNumber(he.divide(G,he.BigInt(1e3))),z=on;break}case"nanosecond":V=he.toNumber(z),z=Ls(z,x,g)}return{years:_,months:S,weeks:k,days:A,hours:y,minutes:I,seconds:D,milliseconds:w,microseconds:M,nanoseconds:he.toNumber(z),total:V}}function hl(n,e,t,c,a,h){for(const[d,s]of[[n,c],[e,a],[t,h]])if(d!==s)return pc(d-s);return 0}function mh(n,e){let t=n%e;return kS(t,-0)?0:(t<0&&(t+=e),t)}function Sf(n){const e=nd(n);return globalThis.BigInt!==void 0?globalThis.BigInt(e.toString(10)):e}function nd(n){if(n instanceof he)return n;let e=n;if(typeof n=="object"){const t=n[Symbol.toPrimitive];t&&typeof t=="function"&&(e=Ny(t,n,["number"]))}switch(typeof e){case"undefined":case"object":case"number":case"symbol":default:throw new TypeError(`cannot convert ${typeof n} to bigint`);case"string":if(!e.match(/^\s*(?:[+-]?\d+\s*)?$/))throw new SyntaxError("invalid BigInt syntax");case"bigint":try{return he.BigInt(e.toString())}catch(t){throw t instanceof Error&&t.message.startsWith("Invalid integer")?new SyntaxError(t.message):t}case"boolean":return e?jy:on}}const ix=(()=>{let n=he.BigInt(Date.now()%1e6);return()=>{const e=he.BigInt(Date.now()),t=he.add(he.multiply(e,ho),n);return n=he.remainder(e,ho),he.greaterThan(t,ud)?ud:he.lessThan(t,hd)?hd:t}})();function pc(n){return n<0?-1:n>0?1:n}function Qi(n){if(n===void 0)return Vn(null);if(Dr(n)&&n!==null)return n;throw new TypeError("Options parameter must be an object, not "+(n===null?"null":typeof n))}function Ih(n,e){const t=Vn(null);return t[n]=e,t}function bl(n,e,t,c){let a=n[e];if(a!==void 0){if(a=Oi(a),!t.includes(a))throw new RangeError(`${e} must be one of ${t.join(", ")}, not ${a}`);return a}return c}function x_(n){return B1.call(PS,n)}const b_=new RegExp(`^${z1.source}$`);function v_(n,e,t,c=n(e),a=n(t)){let h=he.BigInt(e),d=he.BigInt(t),s=c,f=a;for(;he.greaterThan(he.subtract(d,h),jy);){const b=he.divide(he.add(h,d),he.BigInt(2)),x=n(b);if(x===s)h=b,s=x;else{if(x!==f)throw new Error(`invalid state in bisection ${s} - ${x} - ${f}`);d=b,f=x}}return d}const rx={hour:36e11,minute:6e10,second:1e9,millisecond:1e6,microsecond:1e3,nanosecond:1},__=Symbol("date"),w_=Symbol("ym"),T_=Symbol("md"),E_=Symbol("time"),C_=Symbol("datetime"),S_=Symbol("zoneddatetime"),k_=Symbol("instant"),Ch=Symbol("original"),cy=Symbol("timezone"),af=Symbol("timezone-id-given"),Ys=Symbol("calendar-id"),M_=Symbol("locale"),hy=Symbol("options"),sd=n=>({value:n,enumerable:!0,writable:!1,configurable:!0}),fc=globalThis.Intl.DateTimeFormat,ta=Object.assign,OS=Object.prototype.hasOwnProperty,zS=Reflect.apply;function tc(n,e){let t=n[e];return typeof t=="function"&&(t=new fc(n[M_],t(n[hy])),n[e]=t),t}function qu(n){let e=n[cy];return typeof e=="string"&&(e=ps(e),n[cy]=e),e}function wc(n,e={}){if(!(this instanceof wc))return new wc(n,e);const t=e!==void 0,c=t?ta({},e):{},a=new fc(n,c),h=a.resolvedOptions();if(t){const d=ta({},h);for(const s in d)zS(OS,c,[s])||delete d[s];this[hy]=d}else this[hy]=c;this[af]=c.timeZone?c.timeZone:null,this[M_]=h.locale,this[Ch]=a,this[cy]=h.timeZone,this[Ys]=h.calendar,this[__]=FS,this[w_]=jS,this[T_]=BS,this[E_]=NS,this[C_]=US,this[S_]=$S,this[k_]=GS}Object.defineProperty(wc,"name",{writable:!0,value:"DateTimeFormat"}),wc.supportedLocalesOf=function(n,e){return fc.supportedLocalesOf(n,e)};const Sg={resolvedOptions:sd(function(){return this[Ch].resolvedOptions()}),format:sd(function(e,...t){let{instant:c,formatter:a,timeZone:h}=Sh(e,this);return c&&a?(a=kf(a,h),a.format(c.epochMilliseconds)):this[Ch].format(e,...t)}),formatRange:sd(function(e,t){if(Dh(e)||Dh(t)){if(!A_(e,t))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");const{instant:c,formatter:a,timeZone:h}=Sh(e,this),{instant:d,formatter:s,timeZone:f}=Sh(t,this);if(h&&f&&h!==f)throw new RangeError("cannot format range between different time zones");if(c&&d&&a&&s&&a===s)return kf(a,h).formatRange(c.epochMilliseconds,d.epochMilliseconds)}return this[Ch].formatRange(e,t)})};"formatToParts"in fc.prototype&&(Sg.formatToParts=sd(function(e,...t){let{instant:c,formatter:a,timeZone:h}=Sh(e,this);return c&&a?(a=kf(a,h),a.formatToParts(c.epochMilliseconds)):this[Ch].formatToParts(e,...t)})),"formatRangeToParts"in fc.prototype&&(Sg.formatRangeToParts=sd(function(e,t){if(Dh(e)||Dh(t)){if(!A_(e,t))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");const{instant:c,formatter:a,timeZone:h}=Sh(e,this),{instant:d,formatter:s,timeZone:f}=Sh(t,this);if(h&&f&&h!==f)throw new RangeError("cannot format range between different time zones");if(c&&d&&a&&s&&a===s)return kf(a,h).formatRangeToParts(c.epochMilliseconds,d.epochMilliseconds)}return this[Ch].formatRangeToParts(e,t)})),wc.prototype=Object.create(fc.prototype,Sg),Object.defineProperty(wc,"prototype",{writable:!1,enumerable:!1,configurable:!1});const Cc=wc;function kf(n,e){if(!e)return n;const t=n.resolvedOptions();return t.timeZone===e?n:((t.dateStyle||t.timeStyle)&&(delete t.weekday,delete t.era,delete t.year,delete t.month,delete t.day,delete t.hour,delete t.minute,delete t.second,delete t.timeZoneName,delete t.hourCycle,delete t.hour12,delete t.dayPeriod),new fc(t.locale,{...t,timeZone:e}))}function Rd(n={},e={}){const t=ta({},n);for(const c of["year","month","day","hour","minute","second","weekday","dayPeriod","timeZoneName","dateStyle","timeStyle"])t[c]=c in e?e[c]:t[c],t[c]!==!1&&t[c]!==void 0||delete t[c];return t}function NS(n){let e=Rd(n,{year:!1,month:!1,day:!1,weekday:!1,timeZoneName:!1,dateStyle:!1});return om(e)||(e=ta({},e,{hour:"numeric",minute:"numeric",second:"numeric"})),e}function jS(n){let e=Rd(n,{day:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,dateStyle:!1,timeStyle:!1});return"year"in e||"month"in e||(e=ta(e,{year:"numeric",month:"numeric"})),e}function BS(n){let e=Rd(n,{year:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,dateStyle:!1,timeStyle:!1});return"month"in e||"day"in e||(e=ta({},e,{month:"numeric",day:"numeric"})),e}function FS(n){let e=Rd(n,{hour:!1,minute:!1,second:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});return sm(e)||(e=ta({},e,{year:"numeric",month:"numeric",day:"numeric"})),e}function US(n){let e=Rd(n,{timeZoneName:!1});return om(e)||sm(e)||(e=ta({},e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),e}function $S(n){let e=n;return om(e)||sm(e)||(e=ta({},e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),e.timeZoneName===void 0&&(e.timeZoneName="short")),e}function GS(n){let e=n;return om(e)||sm(e)||(e=ta({},e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),e}function sm(n){return"year"in n||"month"in n||"day"in n||"weekday"in n||"dateStyle"in n}function om(n){return"hour"in n||"minute"in n||"second"in n||"timeStyle"in n||"dayPeriod"in n}function Dh(n){return or(n)||Kr(n)||Wi(n)||xi(n)||mr(n)||Ln(n)||vn(n)}function A_(n,e){return!(!Dh(n)||!Dh(e))&&!(Kr(n)&&!Kr(e))&&!(or(n)&&!or(e))&&!(Wi(n)&&!Wi(e))&&!(xi(n)&&!xi(e))&&!(mr(n)&&!mr(e))&&!(Ln(n)&&!Ln(e))&&!(vn(n)&&!vn(e))}function Sh(n,e){const t=Pi("%Temporal.PlainDateTime%");if(Kr(n)){const c=new t(1970,1,1,q(n,ji),q(n,Bi),q(n,Fi),q(n,Ui),q(n,$i),q(n,Gi),e[Ys]);return{instant:us(qu(e),c,"compatible"),formatter:tc(e,E_)}}if(mr(n)){const c=q(n,ii),a=q(n,li),h=q(n,pi),d=Oi(q(n,wt));if(d!==e[Ys])throw new RangeError(`cannot format PlainYearMonth with calendar ${d} in locale with calendar ${e[Ys]}`);const s=new t(c,a,h,12,0,0,0,0,0,d);return{instant:us(qu(e),s,"compatible"),formatter:tc(e,w_)}}if(Ln(n)){const c=q(n,ii),a=q(n,li),h=q(n,pi),d=Oi(q(n,wt));if(d!==e[Ys])throw new RangeError(`cannot format PlainMonthDay with calendar ${d} in locale with calendar ${e[Ys]}`);const s=new t(c,a,h,12,0,0,0,0,0,d);return{instant:us(qu(e),s,"compatible"),formatter:tc(e,T_)}}if(or(n)){const c=q(n,ii),a=q(n,li),h=q(n,pi),d=Oi(q(n,wt));if(d!=="iso8601"&&d!==e[Ys])throw new RangeError(`cannot format PlainDate with calendar ${d} in locale with calendar ${e[Ys]}`);const s=new t(c,a,h,12,0,0,0,0,0,e[Ys]);return{instant:us(qu(e),s,"compatible"),formatter:tc(e,__)}}if(Wi(n)){const c=q(n,ii),a=q(n,li),h=q(n,pi),d=q(n,ji),s=q(n,Bi),f=q(n,Fi),b=q(n,Ui),x=q(n,$i),v=q(n,Gi),g=Oi(q(n,wt));if(g!=="iso8601"&&g!==e[Ys])throw new RangeError(`cannot format PlainDateTime with calendar ${g} in locale with calendar ${e[Ys]}`);let P=n;return g==="iso8601"&&(P=new t(c,a,h,d,s,f,b,x,v,e[Ys])),{instant:us(qu(e),P,"compatible"),formatter:tc(e,C_)}}if(xi(n)){const c=Oi(q(n,wt));if(c!=="iso8601"&&c!==e[Ys])throw new RangeError(`cannot format ZonedDateTime with calendar ${c} in locale with calendar ${e[Ys]}`);const a=Oi(q(n,br));if(e[af]&&e[af]!==a)throw new RangeError(`timeZone option ${e[af]} doesn't match actual time zone ${a}`);return{instant:q(n,Kn),formatter:tc(e,S_),timeZone:a}}return vn(n)?{instant:n,formatter:tc(e,k_)}:{}}class Do{constructor(e){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");const t=nd(e);oc(t),sa(this),Yi(this,Ai,t)}get epochSeconds(){if(!vn(this))throw new TypeError("invalid receiver");const e=q(this,Ai);return he.toNumber(he.divide(e,Ia))}get epochMilliseconds(){if(!vn(this))throw new TypeError("invalid receiver");const e=he.BigInt(q(this,Ai));return he.toNumber(he.divide(e,ho))}get epochMicroseconds(){if(!vn(this))throw new TypeError("invalid receiver");const e=he.BigInt(q(this,Ai));return Sf(he.divide(e,vr))}get epochNanoseconds(){if(!vn(this))throw new TypeError("invalid receiver");return Sf(he.BigInt(q(this,Ai)))}add(e){if(!vn(this))throw new TypeError("invalid receiver");return Ob("add",this,e)}subtract(e){if(!vn(this))throw new TypeError("invalid receiver");return Ob("subtract",this,e)}until(e,t){if(!vn(this))throw new TypeError("invalid receiver");return Mb("until",this,e,t)}since(e,t){if(!vn(this))throw new TypeError("invalid receiver");return Mb("since",this,e,t)}round(e){if(!vn(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");const t=typeof e=="string"?Ih("smallestUnit",e):Qi(e),c=Mn(t,"smallestUnit","time",xc),a=ws(t,"halfExpand"),h=Oa(t,{hour:24,minute:1440,second:86400,millisecond:864e5,microsecond:864e8,nanosecond:864e11}[c],!0),d=Cf(q(this,Ai),h,c,a);return new Do(d)}equals(e){if(!vn(this))throw new TypeError("invalid receiver");const t=Zo(e),c=q(this,Ai),a=q(t,Ai);return he.equal(he.BigInt(c),he.BigInt(a))}toString(e){if(!vn(this))throw new TypeError("invalid receiver");const t=Qi(e);let c=t.timeZone;c!==void 0&&(c=ps(c));const{precision:a,unit:h,increment:d}=Ad(t),s=ws(t,"trunc"),f=Cf(q(this,Ai),d,h,s);return vb(new Do(f),c,a)}toJSON(){if(!vn(this))throw new TypeError("invalid receiver");return vb(this,void 0,"auto")}toLocaleString(e,t){if(!vn(this))throw new TypeError("invalid receiver");return new Cc(e,t).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.Instant")}toZonedDateTime(e){if(!vn(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("invalid argument in toZonedDateTime");const t=e.calendar;if(t===void 0)throw new TypeError("missing calendar property in toZonedDateTime");const c=On(t),a=e.timeZone;if(a===void 0)throw new TypeError("missing timeZone property in toZonedDateTime");const h=ps(a);return Bn(q(this,Ai),h,c)}toZonedDateTimeISO(e){let t=e;if(!vn(this))throw new TypeError("invalid receiver");if(Dr(t)){const h=t.timeZone;h!==void 0&&(t=h)}const c=ps(t),a=cn();return Bn(q(this,Ai),c,a)}static fromEpochSeconds(e){const t=dd(e),c=he.multiply(he.BigInt(t),Ia);return oc(c),new Do(c)}static fromEpochMilliseconds(e){const t=dd(e),c=he.multiply(he.BigInt(t),ho);return oc(c),new Do(c)}static fromEpochMicroseconds(e){const t=nd(e),c=he.multiply(t,vr);return oc(c),new Do(c)}static fromEpochNanoseconds(e){const t=nd(e);return oc(t),new Do(t)}static from(e){return vn(e)?new Do(q(e,Ai)):Zo(e)}static compare(e,t){const c=Zo(e),a=Zo(t),h=q(c,Ai),d=q(a,Ai);return he.lessThan(h,d)?-1:he.greaterThan(h,d)?1:0}}na(Do,"Temporal.Instant");const Mf=Array.prototype.includes,VS=Array.prototype.push,HS=globalThis.Intl.DateTimeFormat,WS=Array.prototype.sort,YS=Math.abs,qS=Math.floor,uy=Object.entries,Fb=Object.keys,Qr={};class Af{constructor(e){if(arguments.length<1)throw new RangeError("missing argument: id is required");const t=Oi(e);if(!x_(t))throw new RangeError(`invalid calendar identifier ${t}`);sa(this),Yi(this,sn,t)}get id(){if(!nn(this))throw new TypeError("invalid receiver");return Oi(this)}dateFromFields(e,t){if(!nn(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("invalid fields");const c=Qi(t);return Qr[q(this,sn)].dateFromFields(e,c,this)}yearMonthFromFields(e,t){if(!nn(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("invalid fields");const c=Qi(t);return Qr[q(this,sn)].yearMonthFromFields(e,c,this)}monthDayFromFields(e,t){if(!nn(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("invalid fields");const c=Qi(t);return Qr[q(this,sn)].monthDayFromFields(e,c,this)}fields(e){if(!nn(this))throw new TypeError("invalid receiver");const t=[],c=new Set(["year","month","monthCode","day","hour","minute","second","millisecond","microsecond","nanosecond"]);for(const a of e){if(typeof a!="string")throw new TypeError("invalid fields");if(!c.has(a))throw new RangeError(`invalid field name ${a}`);c.delete(a),VS.call(t,a)}return Qr[q(this,sn)].fields(t)}mergeFields(e,t){if(!nn(this))throw new TypeError("invalid receiver");return Qr[q(this,sn)].mergeFields(e,t)}dateAdd(e,t,c){if(!nn(this))throw new TypeError("invalid receiver");const a=kr(e),h=Eh(t),d=ln(Qi(c)),{days:s}=Us(q(h,rs),q(h,ns),q(h,ss),q(h,os),q(h,as),q(h,ls),q(h,cs),"day");return Qr[q(this,sn)].dateAdd(a,q(h,is),q(h,Dn),q(h,vs),s,d,this)}dateUntil(e,t,c){if(!nn(this))throw new TypeError("invalid receiver");const a=kr(e),h=kr(t);let d=Mn(Qi(c),"largestUnit","date","auto");d==="auto"&&(d="day");const{years:s,months:f,weeks:b,days:x}=Qr[q(this,sn)].dateUntil(a,h,d);return new(Pi("%Temporal.Duration%"))(s,f,b,x,0,0,0,0,0,0)}year(e){let t=e;if(!nn(this))throw new TypeError("invalid receiver");return mr(t)||(t=kr(t)),Qr[q(this,sn)].year(t)}month(e){let t=e;if(!nn(this))throw new TypeError("invalid receiver");if(Ln(t))throw new TypeError("use monthCode on PlainMonthDay instead");return mr(t)||(t=kr(t)),Qr[q(this,sn)].month(t)}monthCode(e){let t=e;if(!nn(this))throw new TypeError("invalid receiver");return mr(t)||Ln(t)||(t=kr(t)),Qr[q(this,sn)].monthCode(t)}day(e){let t=e;if(!nn(this))throw new TypeError("invalid receiver");return Ln(t)||(t=kr(t)),Qr[q(this,sn)].day(t)}era(e){let t=e;if(!nn(this))throw new TypeError("invalid receiver");return mr(t)||(t=kr(t)),Qr[q(this,sn)].era(t)}eraYear(e){let t=e;if(!nn(this))throw new TypeError("invalid receiver");return mr(t)||(t=kr(t)),Qr[q(this,sn)].eraYear(t)}dayOfWeek(e){if(!nn(this))throw new TypeError("invalid receiver");const t=kr(e);return Qr[q(this,sn)].dayOfWeek(t)}dayOfYear(e){if(!nn(this))throw new TypeError("invalid receiver");const t=kr(e);return Qr[q(this,sn)].dayOfYear(t)}weekOfYear(e){if(!nn(this))throw new TypeError("invalid receiver");const t=kr(e);return Qr[q(this,sn)].weekOfYear(t)}daysInWeek(e){if(!nn(this))throw new TypeError("invalid receiver");const t=kr(e);return Qr[q(this,sn)].daysInWeek(t)}daysInMonth(e){let t=e;if(!nn(this))throw new TypeError("invalid receiver");return mr(t)||(t=kr(t)),Qr[q(this,sn)].daysInMonth(t)}daysInYear(e){let t=e;if(!nn(this))throw new TypeError("invalid receiver");return mr(t)||(t=kr(t)),Qr[q(this,sn)].daysInYear(t)}monthsInYear(e){let t=e;if(!nn(this))throw new TypeError("invalid receiver");return mr(t)||(t=kr(t)),Qr[q(this,sn)].monthsInYear(t)}inLeapYear(e){let t=e;if(!nn(this))throw new TypeError("invalid receiver");return mr(t)||(t=kr(t)),Qr[q(this,sn)].inLeapYear(t)}toString(){if(!nn(this))throw new TypeError("invalid receiver");return q(this,sn)}toJSON(){if(!nn(this))throw new TypeError("invalid receiver");return Oi(this)}static from(e){return On(e)}}function nx(n){if(!n.startsWith("M"))throw new RangeError(`Invalid month code: ${n}.  Month codes must start with M.`);const e=+n.slice(1);if(isNaN(e))throw new RangeError(`Invalid month code: ${n}`);return e}function La(n,e=!1){return`M${n.toString().padStart(2,"0")}${e?"L":""}`}function lf(n,e,t=12){let{month:c,monthCode:a}=n;if(a===void 0){if(c===void 0)throw new TypeError("Either month or monthCode are required");e==="reject"&&Un(c,1,t),e==="constrain"&&(c=Ns(c,1,t)),a=La(c)}else{const h=nx(a);if(c!==void 0&&c!==h)throw new RangeError(`monthCode ${a} and month ${c} must match if both are present`);if(a!==La(h))throw new RangeError(`Invalid month code: ${a}`);if(c=h,c<1||c>t)throw new RangeError(`Invalid monthCode: ${a}`)}return{...n,month:c,monthCode:a}}na(Af,"Temporal.Calendar"),ey("Temporal.Calendar.from",Af.from),Qr.iso8601={dateFromFields(n,e,t){const c=ln(e);let a=Zi(n,["day","month","monthCode","year"],["year","day"]);a=lf(a);let{year:h,month:d,day:s}=a;return{year:h,month:d,day:s}=vf(h,d,s,c),So(h,d,s,t)},yearMonthFromFields(n,e,t){const c=ln(e);let a=Zi(n,["month","monthCode","year"],["year"]);a=lf(a);let{year:h,month:d}=a;return{year:h,month:d}=function(f,b,x){let v=f,g=b;switch(x){case"reject":ea(v,g,1);break;case"constrain":({year:v,month:g}=h_(v,g))}return{year:v,month:g}}(h,d,c),gd(h,d,t,1)},monthDayFromFields(n,e,t){const c=ln(e);let a=Zi(n,["day","month","monthCode","year"],["day"]);if(a.month!==void 0&&a.year===void 0&&a.monthCode===void 0)throw new TypeError("either year or monthCode required with month");const h=a.monthCode===void 0;a=lf(a);let{month:d,day:s,year:f}=a;return{month:d,day:s}=vf(h?f:1972,d,s,c),md(d,s,t,1972)},fields:n=>n,mergeFields(n,e){const t={};for(const a of Fb(n))a!=="month"&&a!=="monthCode"&&(t[a]=n[a]);const c=Fb(e);for(const a of c)t[a]=e[a];if(!Mf.call(c,"month")&&!Mf.call(c,"monthCode")){const{month:a,monthCode:h}=n;a!==void 0&&(t.month=a),h!==void 0&&(t.monthCode=h)}return t},dateAdd(n,e,t,c,a,h,d){let s=q(n,ii),f=q(n,li),b=q(n,pi);return{year:s,month:f,day:b}=dc(s,f,b,e,t,c,a,h),So(s,f,b,d)},dateUntil:(n,e,t)=>Ky(q(n,ii),q(n,li),q(n,pi),q(e,ii),q(e,li),q(e,pi),t),year:n=>q(n,ii),era(){},eraYear(){},month:n=>q(n,li),monthCode:n=>La(q(n,li)),day:n=>q(n,pi),dayOfWeek:n=>Cg(q(n,ii),q(n,li),q(n,pi)),dayOfYear:n=>Ef(q(n,ii),q(n,li),q(n,pi)),weekOfYear:n=>function(t,c,a){const h=Ef(t,c,a),d=Cg(t,c,a)||7,s=Cg(t,1,1),f=kn((h-d+10)/7);return f<1?s===5||s===6&&cl(t-1)?53:52:f===53&&(cl(t)?366:365)-h<4-d?1:f}(q(n,ii),q(n,li),q(n,pi)),daysInWeek:()=>7,daysInMonth:n=>Da(q(n,ii),q(n,li)),daysInYear(n){let e=n;return An(e,ii)||(e=kr(e)),cl(q(e,ii))?366:365},monthsInYear:()=>12,inLeapYear(n){let e=n;return An(e,ii)||(e=kr(e)),cl(q(e,ii))}};class Hr{constructor(e){if(this.map=new Map,this.calls=0,this.hits=0,this.misses=0,this.now=globalThis.performance?globalThis.performance.now():Date.now(),e!==void 0){let t=0;for(const c of e.map.entries()){if(++t>Hr.MAX_CACHE_ENTRIES)break;this.map.set(...c)}}}get(e){const t=this.map.get(e);return t&&(this.hits++,this.report()),this.calls++,t}set(e,t){this.map.set(e,t),this.misses++,this.report()}report(){}setObject(e){if(Hr.objectMap.get(e))throw new RangeError("object already cached");Hr.objectMap.set(e,this),this.report()}static getCacheForObject(e){let t=Hr.objectMap.get(e);return t||(t=new Hr,Hr.objectMap.set(e,t)),t}}function P_({isoYear:n,isoMonth:e,isoDay:t}){return`${Ec(n)}-${Ur(e)}-${Ur(t)}T00:00Z`}function kg(n,e){return{years:n.year-e.year,months:n.month-e.month,days:n.day-e.day}}Hr.objectMap=new WeakMap,Hr.MAX_CACHE_ENTRIES=1e3;class $h{constructor(){this.eraLength="short",this.hasEra=!0}getFormatter(){return this.formatter===void 0&&(this.formatter=new HS(`en-US-u-ca-${this.id}`,{day:"numeric",month:"numeric",year:"numeric",era:this.eraLength,timeZone:"UTC"})),this.formatter}isoToCalendarDate(e,t){const{year:c,month:a,day:h}=e,d=JSON.stringify({func:"isoToCalendarDate",isoYear:c,isoMonth:a,isoDay:h,id:this.id}),s=t.get(d);if(s)return s;const f=this.getFormatter();let b,x;try{x=P_({isoYear:c,isoMonth:a,isoDay:h}),b=f.formatToParts(new Date(x))}catch{throw new RangeError(`Invalid ISO date: ${JSON.stringify({isoYear:c,isoMonth:a,isoDay:h})}`)}const v={};for(let{type:P,value:_}of b){if(P==="year"&&(v.eraYear=+_),P==="relatedYear"&&(v.eraYear=+_),P==="month"){const S=/^([0-9]*)(.*?)$/.exec(_);if(!S||S.length!=3||!S[1]&&!S[2])throw new RangeError(`Unexpected month: ${_}`);if(v.month=S[1]?+S[1]:1,v.month<1)throw new RangeError(`Invalid month ${_} from ${x}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10527)`);if(v.month>13)throw new RangeError(`Invalid month ${_} from ${x}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10529)`);S[2]&&(v.monthExtra=S[2])}P==="day"&&(v.day=+_),this.hasEra&&P==="era"&&_!=null&&_!==""&&(_=_.split(" (")[0],v.era=_.normalize("NFD").replace(/[^-0-9 \p{L}]/gu,"").replace(" ","-").toLowerCase())}if(v.eraYear===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);if(this.reviseIntlEra){const{era:P,eraYear:_}=this.reviseIntlEra(v,e);v.era=P,v.eraYear=_}this.checkIcuBugs&&this.checkIcuBugs(e);const g=this.adjustCalendarDate(v,t,"constrain",!0);if(g.year===void 0)throw new RangeError(`Missing year converting ${JSON.stringify(e)}`);if(g.month===void 0)throw new RangeError(`Missing month converting ${JSON.stringify(e)}`);if(g.day===void 0)throw new RangeError(`Missing day converting ${JSON.stringify(e)}`);return t.set(d,g),["constrain","reject"].forEach(P=>{const _=JSON.stringify({func:"calendarToIsoDate",year:g.year,month:g.month,day:g.day,overflow:P,id:this.id});t.set(_,e)}),g}validateCalendarDate(e){const{era:t,month:c,year:a,day:h,eraYear:d,monthCode:s,monthExtra:f}=e;if(f!==void 0)throw new RangeError("Unexpected `monthExtra` value");if(a===void 0&&d===void 0)throw new TypeError("year or eraYear is required");if(c===void 0&&s===void 0)throw new TypeError("month or monthCode is required");if(h===void 0)throw new RangeError("Missing day");if(s!==void 0){if(typeof s!="string")throw new RangeError("monthCode must be a string, not "+typeof s);if(!/^M([01]?\d)(L?)$/.test(s))throw new RangeError(`Invalid monthCode: ${s}`)}if(this.constantEra){if(t!==void 0&&t!==this.constantEra)throw new RangeError(`era must be ${this.constantEra}, not ${t}`);if(d!==void 0&&a!==void 0&&d!==a)throw new RangeError(`eraYear ${d} does not match year ${a}`)}}adjustCalendarDate(e,t,c="constrain",a=!1){if(this.calendarType==="lunisolar")throw new RangeError("Override required for lunisolar calendars");let h=e;if(this.validateCalendarDate(h),this.constantEra){const{year:b,eraYear:x}=h;h={...h,era:this.constantEra,year:b!==void 0?b:x,eraYear:x!==void 0?x:b}}const d=this.monthsInYear(h,t);let{month:s,monthCode:f}=h;return{month:s,monthCode:f}=lf(h,c,d),{...h,month:s,monthCode:f}}regulateMonthDayNaive(e,t,c){const a=this.monthsInYear(e,c);let{month:h,day:d}=e;return t==="reject"?(Un(h,1,a),Un(d,1,this.maximumMonthLength(e))):(h=Ns(h,1,a),d=Ns(d,1,this.maximumMonthLength({...e,month:h}))),{...e,month:h,day:d}}calendarToIsoDate(e,t="constrain",c){const a=e;let h=this.adjustCalendarDate(e,c,t,!1);h=this.regulateMonthDayNaive(h,t,c);const{year:d,month:s,day:f}=h,b=JSON.stringify({func:"calendarToIsoDate",year:d,month:s,day:f,overflow:t,id:this.id});let x,v=c.get(b);if(v||a.year!==void 0&&a.month!==void 0&&a.day!==void 0&&(a.year!==h.year||a.month!==h.month||a.day!==h.day)&&(x=JSON.stringify({func:"calendarToIsoDate",year:a.year,month:a.month,day:a.day,overflow:t,id:this.id}),v=c.get(x),v))return v;let g=this.estimateIsoDate({year:d,month:s,day:f});const P=I=>{let D=this.addDaysIso(g,I);if(h.day>this.minimumMonthLength(h)){let w=this.isoToCalendarDate(D,c);for(;w.month!==s||w.year!==d;){if(t==="reject")throw new RangeError(`day ${f} does not exist in month ${s} of year ${d}`);D=this.addDaysIso(D,-1),w=this.isoToCalendarDate(D,c)}}return D};let _=0,S=this.isoToCalendarDate(g,c),k=kg(h,S);if(k.years!==0||k.months!==0||k.days!==0){const I=365*k.years+30*k.months+k.days;g=this.addDaysIso(g,I),S=this.isoToCalendarDate(g,c),k=kg(h,S),k.years===0&&k.months===0?g=P(k.days):_=this.compareCalendarDates(h,S)}let A=8,y=!1;for(;_;){g=this.addDaysIso(g,_*A);const I=S;S=this.isoToCalendarDate(g,c);const D=_;if(_=this.compareCalendarDates(h,S),_){if(k=kg(h,S),k.years===0&&k.months===0)g=P(k.days),_=0,y=h.day>this.minimumMonthLength(h);else if(D&&_!==D)if(A>1)A/=2;else{if(t==="reject")throw new RangeError(`Can't find ISO date from calendar date: ${JSON.stringify({...a})}`);this.compareCalendarDates(S,I)>0&&(g=this.addDaysIso(g,-1)),y=!0,_=0}}}if(c.set(b,g),x&&c.set(x,g),h.year===void 0||h.month===void 0||h.day===void 0||h.monthCode===void 0||this.hasEra&&(h.era===void 0||h.eraYear===void 0))throw new RangeError("Unexpected missing property");if(!y){const I=JSON.stringify({func:"isoToCalendarDate",isoYear:g.year,isoMonth:g.month,isoDay:g.day,id:this.id});c.set(I,h)}return g}temporalToCalendarDate(e,t){const c={year:q(e,ii),month:q(e,li),day:q(e,pi)};return this.isoToCalendarDate(c,t)}compareCalendarDates(e,t){const c=Zi(e,["day","month","year"],["day","month","year"]),a=Zi(t,["day","month","year"],["day","month","year"]);return c.year!==a.year?pc(c.year-a.year):c.month!==a.month?pc(c.month-a.month):c.day!==a.day?pc(c.day-a.day):0}regulateDate(e,t="constrain",c){const a=this.calendarToIsoDate(e,t,c);return this.isoToCalendarDate(a,c)}addDaysIso(e,t){return dc(e.year,e.month,e.day,0,0,0,t,"constrain")}addDaysCalendar(e,t,c){const a=this.calendarToIsoDate(e,"constrain",c),h=this.addDaysIso(a,t);return this.isoToCalendarDate(h,c)}addMonthsCalendar(e,t,c,a){let h=e;const{day:d}=h;for(let s=0,f=YS(t);s<f;s++){const{month:b}=h,x=h,v=t<0?-Math.max(d,this.daysInPreviousMonth(h,a)):this.daysInMonth(h,a),g=this.calendarToIsoDate(h,"constrain",a);let P=this.addDaysIso(g,v);if(h=this.isoToCalendarDate(P,a),t>0){const _=this.monthsInYear(x,a);for(;h.month-1!=b%_;)P=this.addDaysIso(P,-1),h=this.isoToCalendarDate(P,a)}h.day!==d&&(h=this.regulateDate({...h,day:d},"constrain",a))}if(c==="reject"&&h.day!==d)throw new RangeError(`Day ${d} does not exist in resulting calendar month`);return h}addCalendar(e,{years:t=0,months:c=0,weeks:a=0,days:h=0},d,s){const{year:f,day:b,monthCode:x}=e,v=this.adjustCalendarDate({year:f+t,monthCode:x,day:b},s),g=this.addMonthsCalendar(v,c,d,s),P=h+7*a;return this.addDaysCalendar(g,P,s)}untilCalendar(e,t,c,a){let h=0,d=0,s=0,f=0;switch(c){case"day":h=this.calendarDaysUntil(e,t,a);break;case"week":{const b=this.calendarDaysUntil(e,t,a);h=b%7,d=(b-h)/7;break}case"month":case"year":{const b=t.year-e.year,x=t.month-e.month,v=t.day-e.day,g=this.compareCalendarDates(t,e);if(!g)return{years:0,months:0,weeks:0,days:0};c==="year"&&b&&(f=x*g<0||x===0&&v*g<0?b-g:b);let P,_=f?this.addCalendar(e,{years:f},"constrain",a):e;do s+=g,P=_,_=this.addMonthsCalendar(P,g,"constrain",a),_.day!==e.day&&(_=this.regulateDate({..._,day:e.day},"constrain",a));while(this.compareCalendarDates(t,_)*g>=0);s-=g,h=this.calendarDaysUntil(P,t,a);break}}return{years:f,months:s,weeks:d,days:h}}daysInMonth(e,t){const{day:c}=e,a=this.maximumMonthLength(e),h=this.minimumMonthLength(e);if(h===a)return h;const d=c<=a-h?a:h,s=this.calendarToIsoDate(e,"constrain",t),f=this.addDaysIso(s,d),b=this.isoToCalendarDate(f,t),x=this.addDaysIso(f,-b.day);return this.isoToCalendarDate(x,t).day}daysInPreviousMonth(e,t){const{day:c,month:a,year:h}=e;let d={year:a>1?h:h-1,month:a,day:1};const s=a>1?a-1:this.monthsInYear(d,t);d={...d,month:s};const f=this.minimumMonthLength(d),b=this.maximumMonthLength(d);if(f===b)return b;const x=this.calendarToIsoDate(e,"constrain",t),v=this.addDaysIso(x,-c);return this.isoToCalendarDate(v,t).day}startOfCalendarYear(e){return{year:e.year,month:1,monthCode:"M01",day:1}}startOfCalendarMonth(e){return{year:e.year,month:e.month,day:1}}calendarDaysUntil(e,t,c){const a=this.calendarToIsoDate(e,"constrain",c),h=this.calendarToIsoDate(t,"constrain",c);return this.isoDaysUntil(a,h)}isoDaysUntil(e,t){return Ky(e.year,e.month,e.day,t.year,t.month,t.day,"day").days}monthDayFromFields(e,t,c){let a,h,d,s,f,{year:b,month:x,monthCode:v,day:g,era:P,eraYear:_}=e;if(v===void 0){if(b===void 0&&(P===void 0||_===void 0))throw new TypeError("`monthCode`, `year`, or `era` and `eraYear` is required");({monthCode:v,year:b}=this.adjustCalendarDate({year:b,month:x,monthCode:v,day:g,era:P,eraYear:_},c,t))}const{year:S}=this.isoToCalendarDate({year:1972,month:1,day:1},c);for(let k=0;k<100;k++){const A=this.adjustCalendarDate({day:g,monthCode:v,year:S-k},c),y=this.calendarToIsoDate(A,"constrain",c),I=this.isoToCalendarDate(y,c);if({year:a,month:h,day:d}=y,I.monthCode===v&&I.day===g)return{month:h,day:d,year:a};t==="constrain"&&(s===void 0||I.monthCode===s.monthCode&&I.day>s.day)&&(s=I,f=y)}if(t==="constrain"&&f!==void 0)return f;throw new RangeError(`No recent ${this.id} year with monthCode ${v} and day ${g}`)}}class XS extends $h{constructor(){super(...arguments),this.id="hebrew",this.calendarType="lunisolar",this.months={Tishri:{leap:1,regular:1,monthCode:"M01",days:30},Heshvan:{leap:2,regular:2,monthCode:"M02",days:{min:29,max:30}},Kislev:{leap:3,regular:3,monthCode:"M03",days:{min:29,max:30}},Tevet:{leap:4,regular:4,monthCode:"M04",days:29},Shevat:{leap:5,regular:5,monthCode:"M05",days:30},Adar:{leap:void 0,regular:6,monthCode:"M06",days:29},"Adar I":{leap:6,regular:void 0,monthCode:"M05L",days:30},"Adar II":{leap:7,regular:void 0,monthCode:"M06",days:29},Nisan:{leap:8,regular:7,monthCode:"M07",days:30},Iyar:{leap:9,regular:8,monthCode:"M08",days:29},Sivan:{leap:10,regular:9,monthCode:"M09",days:30},Tamuz:{leap:11,regular:10,monthCode:"M10",days:29},Av:{leap:12,regular:11,monthCode:"M11",days:30},Elul:{leap:13,regular:12,monthCode:"M12",days:29}},this.hasEra=!1}inLeapYear(e){const{year:t}=e;return(7*t+1)%19<7}monthsInYear(e){return this.inLeapYear(e)?13:12}minimumMonthLength(e){return this.minMaxMonthLength(e,"min")}maximumMonthLength(e){return this.minMaxMonthLength(e,"max")}minMaxMonthLength(e,t){const{month:c,year:a}=e,h=this.getMonthCode(a,c),d=uy(this.months).find(f=>f[1].monthCode===h);if(d===void 0)throw new RangeError(`unmatched Hebrew month: ${c}`);const s=d[1].days;return typeof s=="number"?s:s[t]}estimateIsoDate(e){const{year:t}=e;return{year:t-3760,month:1,day:1}}getMonthCode(e,t){return this.inLeapYear({year:e})?t===6?La(5,!0):La(t<6?t:t-1):La(t)}adjustCalendarDate(e,t,c="constrain",a=!1){let{year:h,eraYear:d,month:s,monthCode:f,day:b,monthExtra:x}=e;if(h===void 0&&d!==void 0&&(h=d),d===void 0&&h!==void 0&&(d=h),a){if(x){const v=this.months[x];if(!v)throw new RangeError(`Unrecognized month from formatToParts: ${x}`);s=this.inLeapYear({year:h})?v.leap:v.regular}return f=this.getMonthCode(h,s),{year:h,month:s,day:b,era:void 0,eraYear:d,monthCode:f}}if(this.validateCalendarDate(e),s===void 0)if(f.endsWith("L")){if(f!=="M05L")throw new RangeError(`Hebrew leap month must have monthCode M05L, not ${f}`);if(s=6,!this.inLeapYear({year:h})){if(c==="reject")throw new RangeError(`Hebrew monthCode M05L is invalid in year ${h} which is not a leap year`);s=5,b=30,f="M05"}}else{s=nx(f),this.inLeapYear({year:h})&&s>=6&&s++;const v=this.monthsInYear({year:h});if(s<1||s>v)throw new RangeError(`Invalid monthCode: ${f}`)}else if(c==="reject"?(Un(s,1,this.monthsInYear({year:h})),Un(b,1,this.maximumMonthLength({year:h,month:s}))):(s=Ns(s,1,this.monthsInYear({year:h})),b=Ns(b,1,this.maximumMonthLength({year:h,month:s}))),f===void 0)f=this.getMonthCode(h,s);else if(this.getMonthCode(h,s)!==f)throw new RangeError(`monthCode ${f} doesn't correspond to month ${s} in Hebrew year ${h}`);return{...e,day:b,month:s,monthCode:f,year:h,eraYear:d}}}class Gh extends $h{constructor(){super(...arguments),this.calendarType="lunar",this.DAYS_PER_ISLAMIC_YEAR=354+11/30,this.DAYS_PER_ISO_YEAR=365.2425,this.constantEra="ah"}inLeapYear(e,t){return this.daysInMonth({year:e.year,month:12,day:1},t)===30}monthsInYear(){return 12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}estimateIsoDate(e){const{year:t}=this.adjustCalendarDate(e);return{year:qS(t*this.DAYS_PER_ISLAMIC_YEAR/this.DAYS_PER_ISO_YEAR)+622,month:1,day:1}}}class I_ extends Gh{constructor(){super(...arguments),this.id="islamic"}}class ZS extends Gh{constructor(){super(...arguments),this.id="islamic-umalqura"}}class KS extends Gh{constructor(){super(...arguments),this.id="islamic-tbla"}}class QS extends Gh{constructor(){super(...arguments),this.id="islamic-civil"}}class JS extends Gh{constructor(){super(...arguments),this.id="islamic-rgsa"}}class ek extends Gh{constructor(){super(...arguments),this.id="islamicc"}}class tk extends $h{constructor(){super(...arguments),this.id="persian",this.calendarType="solar",this.constantEra="ap"}inLeapYear(e,t){return I_.prototype.inLeapYear.call(this,e,t)}monthsInYear(){return 12}minimumMonthLength(e){const{month:t}=e;return t===12?29:t<=6?31:30}maximumMonthLength(e){const{month:t}=e;return t===12?30:t<=6?31:30}estimateIsoDate(e){const{year:t}=this.adjustCalendarDate(e);return{year:t+621,month:1,day:1}}}class ik extends $h{constructor(){super(...arguments),this.id="indian",this.calendarType="solar",this.constantEra="saka",this.months={1:{length:30,month:3,day:22,leap:{length:31,month:3,day:21}},2:{length:31,month:4,day:21},3:{length:31,month:5,day:22},4:{length:31,month:6,day:22},5:{length:31,month:7,day:23},6:{length:31,month:8,day:23},7:{length:30,month:9,day:23},8:{length:30,month:10,day:23},9:{length:30,month:11,day:22},10:{length:30,month:12,day:22},11:{length:30,month:1,nextYear:!0,day:21},12:{length:30,month:2,nextYear:!0,day:20}},this.vulnerableToBceBug=new Date("0000-01-01T00:00Z").toLocaleDateString("en-US-u-ca-indian",{timeZone:"UTC"})!=="10/11/-79 Saka"}inLeapYear(e){return D_(e.year+78)}monthsInYear(){return 12}minimumMonthLength(e){return this.getMonthInfo(e).length}maximumMonthLength(e){return this.getMonthInfo(e).length}getMonthInfo(e){const{month:t}=e;let c=this.months[t];if(c===void 0)throw new RangeError(`Invalid month: ${t}`);return this.inLeapYear(e)&&c.leap&&(c=c.leap),c}estimateIsoDate(e){const t=this.adjustCalendarDate(e),c=this.getMonthInfo(t);return dc(t.year+78+(c.nextYear?1:0),c.month,c.day,0,0,0,t.day-1,"constrain")}checkIcuBugs(e){if(this.vulnerableToBceBug&&e.year<1)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 0001-01-01 (see https://bugs.chromium.org/p/v8/issues/detail?id=10529)`)}}function D_(n){return n%4==0&&(n%100!=0||n%400==0)}class Od extends $h{constructor(e,t){super(),this.calendarType="solar",this.v8IsVulnerableToJulianBug=new Date("+001001-01-01T00:00Z").toLocaleDateString("en-US-u-ca-japanese",{timeZone:"UTC"}).startsWith("12"),this.calendarIsVulnerableToJulianBug=!1,this.id=e;const{eras:c,anchorEra:a}=function(d){let s,f=d;if(f.length===0)throw new RangeError("Invalid era data: eras are required");if(f.length===1&&f[0].reverseOf)throw new RangeError("Invalid era data: anchor era cannot count years backwards");if(f.length===1&&!f[0].name)throw new RangeError("Invalid era data: at least one named era is required");if(f.filter(x=>x.reverseOf!=null).length>1)throw new RangeError("Invalid era data: only one era can count years backwards");f.forEach(x=>{if(x.isAnchor||!x.anchorEpoch&&!x.reverseOf){if(s)throw new RangeError("Invalid era data: cannot have multiple anchor eras");s=x,x.anchorEpoch={year:x.hasYearZero?0:1}}else if(!x.name)throw new RangeError("If era name is blank, it must be the anchor era")}),f=f.filter(x=>x.name),f.forEach(x=>{const{reverseOf:v}=x;if(v){const g=f.find(P=>P.name===v);if(g===void 0)throw new RangeError(`Invalid era data: unmatched reverseOf era: ${v}`);x.reverseOf=g,x.anchorEpoch=g.anchorEpoch,x.isoEpoch=g.isoEpoch}x.anchorEpoch.month===void 0&&(x.anchorEpoch.month=1),x.anchorEpoch.day===void 0&&(x.anchorEpoch.day=1)}),WS.call(f,(x,v)=>{if(x.reverseOf)return 1;if(v.reverseOf)return-1;if(!x.isoEpoch||!v.isoEpoch)throw new RangeError("Invalid era data: missing ISO epoch");return v.isoEpoch.year-x.isoEpoch.year});const b=f[f.length-1].reverseOf;if(b&&b!==f[f.length-2])throw new RangeError("Invalid era data: invalid reverse-sign era");return f.forEach((x,v)=>{x.genericName="era"+(f.length-1-v)}),{eras:f,anchorEra:s||f[0]}}(t);this.anchorEra=a,this.eras=c}inLeapYear(e){const{year:t}=this.estimateIsoDate({month:1,day:1,year:e.year});return D_(t)}monthsInYear(){return 12}minimumMonthLength(e){const{month:t}=e;return t===2?this.inLeapYear(e)?29:28:[4,6,9,11].indexOf(t)>=0?30:31}maximumMonthLength(e){return this.minimumMonthLength(e)}completeEraYear(e){const t=(s,f)=>{const b=e[s];if(b!=null&&b!=f)throw new RangeError(`Input ${s} ${b} doesn't match calculated value ${f}`)},c=s=>{let f;const b={...e,year:s},x=this.eras.find((v,g)=>{if(g===this.eras.length-1){if(v.reverseOf){if(s>0)throw new RangeError(`Signed year ${s} is invalid for era ${v.name}`);return f=v.anchorEpoch.year-s,!0}return f=s-v.anchorEpoch.year+(v.hasYearZero?0:1),!0}return this.compareCalendarDates(b,v.anchorEpoch)>=0&&(f=s-v.anchorEpoch.year+(v.hasYearZero?0:1),!0)});if(!x)throw new RangeError(`Year ${s} was not matched by any era`);return{eraYear:f,era:x.name}};let{year:a,eraYear:h,era:d}=e;if(a!=null)({eraYear:h,era:d}=c(a)),t("era",d),t("eraYear",h);else{if(h==null)throw new RangeError("Either `year` or `eraYear` and `era` are required");{const s=d===void 0?void 0:this.eras.find(f=>f.name===d||f.genericName===d);if(!s)throw new RangeError(`Era ${d} (ISO year ${h}) was not matched by any era`);if(h<1&&s.reverseOf)throw new RangeError(`Years in ${d} era must be positive, not ${a}`);a=s.reverseOf?s.anchorEpoch.year-h:h+s.anchorEpoch.year-(s.hasYearZero?0:1),t("year",a),{eraYear:h,era:d}=c(a)}}return{...e,year:a,eraYear:h,era:d}}adjustCalendarDate(e,t,c="constrain"){let a=e;const{month:h,monthCode:d}=a;return h===void 0&&(a={...a,month:nx(d)}),this.validateCalendarDate(a),a=this.completeEraYear(a),super.adjustCalendarDate(a,t,c)}estimateIsoDate(e){const t=this.adjustCalendarDate(e),{year:c,month:a,day:h}=t,{anchorEra:d}=this;return vf(c+d.isoEpoch.year-(d.hasYearZero?0:1),a,h,"constrain")}checkIcuBugs(e){if(this.calendarIsVulnerableToJulianBug&&this.v8IsVulnerableToJulianBug&&hl(e.year,e.month,e.day,1582,10,15)<0)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 1582-10-15 (see https://bugs.chromium.org/p/chromium/issues/detail?id=1173158)`)}}class sx extends Od{constructor(e,t){super(e,t)}inLeapYear(e){const{year:t}=e;return(t+1)%4==0}monthsInYear(){return 13}minimumMonthLength(e){const{month:t}=e;return t===13?this.inLeapYear(e)?6:5:30}maximumMonthLength(e){return this.minimumMonthLength(e)}}class rk extends sx{constructor(){super("ethioaa",[{name:"era0",isoEpoch:{year:-5492,month:7,day:17}}])}}class nk extends sx{constructor(){super("coptic",[{name:"era1",isoEpoch:{year:284,month:8,day:29}},{name:"era0",reverseOf:"era1"}])}}class sk extends sx{constructor(){super("ethiopic",[{name:"era0",isoEpoch:{year:-5492,month:7,day:17}},{name:"era1",isoEpoch:{year:8,month:8,day:27},anchorEpoch:{year:5501}}])}}class ok extends Od{constructor(){super("roc",[{name:"minguo",isoEpoch:{year:1912,month:1,day:1}},{name:"before-roc",reverseOf:"minguo"}]),this.calendarIsVulnerableToJulianBug=!0}}class ak extends Od{constructor(){super("buddhist",[{name:"be",hasYearZero:!0,isoEpoch:{year:-543,month:1,day:1}}]),this.calendarIsVulnerableToJulianBug=!0}}class lk extends Od{constructor(){super("gregory",[{name:"ce",isoEpoch:{year:1,month:1,day:1}},{name:"bce",reverseOf:"ce"}])}reviseIntlEra(e){let{era:t,eraYear:c}=e;return t!=="bc"&&t!=="b"||(t="bce"),t!=="ad"&&t!=="a"||(t="ce"),{era:t,eraYear:c}}}class ck extends Od{constructor(){super("japanese",[{name:"reiwa",isoEpoch:{year:2019,month:5,day:1},anchorEpoch:{year:2019,month:5,day:1}},{name:"heisei",isoEpoch:{year:1989,month:1,day:8},anchorEpoch:{year:1989,month:1,day:8}},{name:"showa",isoEpoch:{year:1926,month:12,day:25},anchorEpoch:{year:1926,month:12,day:25}},{name:"taisho",isoEpoch:{year:1912,month:7,day:30},anchorEpoch:{year:1912,month:7,day:30}},{name:"meiji",isoEpoch:{year:1868,month:9,day:8},anchorEpoch:{year:1868,month:9,day:8}},{name:"ce",isoEpoch:{year:1,month:1,day:1}},{name:"bce",reverseOf:"ce"}]),this.calendarIsVulnerableToJulianBug=!0,this.eraLength="long"}reviseIntlEra(e,t){const{era:c,eraYear:a}=e,{year:h}=t;return this.eras.find(d=>d.name===c)?{era:c,eraYear:a}:h<1?{era:"bce",eraYear:1-h}:{era:"ce",eraYear:h}}}class L_ extends $h{constructor(){super(...arguments),this.calendarType="lunisolar",this.hasEra=!1}inLeapYear(e,t){const c=this.getMonthList(e.year,t);return uy(c).length===13}monthsInYear(e,t){return this.inLeapYear(e,t)?13:12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}getMonthList(e,t){if(e===void 0)throw new TypeError("Missing year");const c=JSON.stringify({func:"getMonthList",calendarYear:e,id:this.id}),a=t.get(c);if(a)return a;const h=this.getFormatter(),d=(k,A)=>{const y=P_({isoYear:k,isoMonth:2,isoDay:1}),I=new Date(y);I.setUTCDate(A+1);const D=h.formatToParts(I),w=D.find(Y=>Y.type==="month").value,M=+D.find(Y=>Y.type==="day").value;let z=D.find(Y=>Y.type==="relatedYear");if(z===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);return z=+z.value,{calendarMonthString:w,calendarDay:M,calendarYearToVerify:z}};let s=17,{calendarMonthString:f,calendarDay:b,calendarYearToVerify:x}=d(e,s);f!=="1"&&(s+=29,{calendarMonthString:f,calendarDay:b}=d(e,s)),s-=b-5;const v={};let g,P,_=1,S=!1;do({calendarMonthString:f,calendarDay:b,calendarYearToVerify:x}=d(e,s)),g&&(v[P].daysInMonth=g+30-b),x!==e?S=!0:(v[f]={monthIndex:_++},s+=30),g=b,P=f;while(!S);return v[P].daysInMonth=g+30-b,t.set(c,v),v}estimateIsoDate(e){const{year:t,month:c}=e;return{year:t,month:c>=12?12:c+1,day:1}}adjustCalendarDate(e,t,c="constrain",a=!1){let{year:h,month:d,monthExtra:s,day:f,monthCode:b,eraYear:x}=e;if(a){if(h=x,s&&s!=="bis")throw new RangeError(`Unexpected leap month suffix: ${s}`);const v=La(d,s!==void 0),g=`${d}${s||""}`,P=this.getMonthList(h,t)[g];if(P===void 0)throw new RangeError(`Unmatched month ${g} in Chinese year ${h}`);return d=P.monthIndex,{year:h,month:d,day:f,era:void 0,eraYear:x,monthCode:v}}if(this.validateCalendarDate(e),h===void 0&&(h=x),x===void 0&&(x=h),d===void 0){const v=this.getMonthList(h,t);let g=b.replace("L","bis").slice(1);g[0]==="0"&&(g=g.slice(1));let P=v[g];if(d=P&&P.monthIndex,d===void 0&&b.endsWith("L")&&!Mf.call(["M01L","M12L","M13L"],b)&&c==="constrain"){let _=b.slice(1,-1);_[0]==="0"&&(_=_.slice(1)),P=v[_],P&&({daysInMonth:f,monthIndex:d}=P,b=La(_))}if(d===void 0)throw new RangeError(`Unmatched month ${b} in Chinese year ${h}`)}else if(b===void 0){const v=this.getMonthList(h,t),g=uy(v),P=g.length;c==="reject"?(Un(d,1,P),Un(f,1,this.maximumMonthLength())):(d=Ns(d,1,P),f=Ns(f,1,this.maximumMonthLength()));const _=g.find(([,S])=>S.monthIndex===d);if(_===void 0)throw new RangeError(`Invalid month ${d} in Chinese year ${h}`);b=La(_[0].replace("bis",""),_[0].indexOf("bis")!==-1)}else{const v=this.getMonthList(h,t);let g=b.replace("L","bis").slice(1);g[0]==="0"&&(g=g.slice(1));const P=v[g];if(!P)throw new RangeError(`Unmatched monthCode ${b} in Chinese year ${h}`);if(d!==P.monthIndex)throw new RangeError(`monthCode ${b} doesn't correspond to month ${d} in Chinese year ${h}`)}return{...e,year:h,eraYear:x,month:d,monthCode:b,day:f}}}class hk extends L_{constructor(){super(...arguments),this.id="chinese"}}class uk extends L_{constructor(){super(...arguments),this.id="dangi"}}const dk={helper:void 0,dateFromFields(n,e,t){const c=ln(e),a=new Hr,h=Zi(n,["day","era","eraYear","month","monthCode","year"],["day"]),{year:d,month:s,day:f}=this.helper.calendarToIsoDate(h,c,a),b=So(d,s,f,t);return a.setObject(b),b},yearMonthFromFields(n,e,t){const c=ln(e),a=new Hr,h=Zi(n,["era","eraYear","month","monthCode","year"],[]),{year:d,month:s,day:f}=this.helper.calendarToIsoDate({...h,day:1},c,a),b=gd(d,s,t,f);return a.setObject(b),b},monthDayFromFields(n,e,t){const c=ln(e),a=new Hr,h=Zi(n,["day","era","eraYear","month","monthCode","year"],["day"]),{year:d,month:s,day:f}=this.helper.monthDayFromFields(h,c,a),b=md(s,f,t,d);return a.setObject(b),b},fields(n){let e=n;return Mf.call(e,"year")&&(e=[...e,"era","eraYear"]),e},mergeFields(n,e){const t={...n},c={...e},{month:a,monthCode:h,year:d,era:s,eraYear:f,...b}=t,{month:x,monthCode:v,year:g,era:P,eraYear:_}=c;return x===void 0&&v===void 0&&(b.month=a,b.monthCode=h),g===void 0&&P===void 0&&_===void 0&&(b.year=d),{...b,...c}},dateAdd(n,e,t,c,a,h,d){const s=Hr.getCacheForObject(n),f=this.helper.temporalToCalendarDate(n,s),b=this.helper.addCalendar(f,{years:e,months:t,weeks:c,days:a},h,s),x=this.helper.calendarToIsoDate(b,"constrain",s),{year:v,month:g,day:P}=x,_=So(v,g,P,d);return new Hr(s).setObject(_),_},dateUntil(n,e,t){const c=Hr.getCacheForObject(n),a=Hr.getCacheForObject(e),h=this.helper.temporalToCalendarDate(n,c),d=this.helper.temporalToCalendarDate(e,a);return this.helper.untilCalendar(h,d,t,c)},year(n){const e=Hr.getCacheForObject(n);return this.helper.temporalToCalendarDate(n,e).year},month(n){const e=Hr.getCacheForObject(n);return this.helper.temporalToCalendarDate(n,e).month},day(n){const e=Hr.getCacheForObject(n);return this.helper.temporalToCalendarDate(n,e).day},era(n){if(!this.helper.hasEra)return;const e=Hr.getCacheForObject(n);return this.helper.temporalToCalendarDate(n,e).era},eraYear(n){if(!this.helper.hasEra)return;const e=Hr.getCacheForObject(n);return this.helper.temporalToCalendarDate(n,e).eraYear},monthCode(n){const e=Hr.getCacheForObject(n);return this.helper.temporalToCalendarDate(n,e).monthCode},dayOfWeek:n=>Qr.iso8601.dayOfWeek(n),dayOfYear(n){const e=Hr.getCacheForObject(n),t=this.helper.isoToCalendarDate(n,e),c=this.helper.startOfCalendarYear(t);return this.helper.calendarDaysUntil(c,t,e)+1},weekOfYear:n=>Qr.iso8601.weekOfYear(n),daysInWeek:n=>Qr.iso8601.daysInWeek(n),daysInMonth(n){const e=Hr.getCacheForObject(n),t=this.helper.temporalToCalendarDate(n,e),c=this.helper.maximumMonthLength(t);if(c===this.helper.minimumMonthLength(t))return c;const a=this.helper.startOfCalendarMonth(t),h=this.helper.addMonthsCalendar(a,1,"constrain",e);return this.helper.calendarDaysUntil(a,h,e)},daysInYear(n){let e=n;An(e,ii)||(e=kr(e));const t=Hr.getCacheForObject(e),c=this.helper.temporalToCalendarDate(e,t),a=this.helper.startOfCalendarYear(c),h=this.helper.addCalendar(a,{years:1},"constrain",t);return this.helper.calendarDaysUntil(a,h,t)},monthsInYear(n){const e=Hr.getCacheForObject(n),t=this.helper.temporalToCalendarDate(n,e);return this.helper.monthsInYear(t,e)},inLeapYear(n){let e=n;An(e,ii)||(e=kr(e));const t=Hr.getCacheForObject(e),c=this.helper.temporalToCalendarDate(e,t);return this.helper.inLeapYear(c,t)}};for(const n of[XS,tk,sk,rk,nk,hk,uk,ok,ik,ak,lk,ck,I_,ZS,KS,QS,JS,ek]){const e=new n;Qr[e.id]={...dk,helper:e}}class zd{constructor(e,t,c,a=cn()){const h=Mr(e),d=Mr(t),s=Mr(c),f=On(a);if(arguments.length<3)throw new RangeError("missing argument: isoYear, isoMonth and isoDay are required");Z1(this,h,d,s,f)}get calendar(){if(!or(this))throw new TypeError("invalid receiver");return q(this,wt)}get era(){if(!or(this))throw new TypeError("invalid receiver");return Zf(q(this,wt),this)}get eraYear(){if(!or(this))throw new TypeError("invalid receiver");return Kf(q(this,wt),this)}get year(){if(!or(this))throw new TypeError("invalid receiver");return Yf(q(this,wt),this)}get month(){if(!or(this))throw new TypeError("invalid receiver");return qf(q(this,wt),this)}get monthCode(){if(!or(this))throw new TypeError("invalid receiver");return Id(q(this,wt),this)}get day(){if(!or(this))throw new TypeError("invalid receiver");return Xf(q(this,wt),this)}get dayOfWeek(){if(!or(this))throw new TypeError("invalid receiver");return Uy(q(this,wt),this)}get dayOfYear(){if(!or(this))throw new TypeError("invalid receiver");return $y(q(this,wt),this)}get weekOfYear(){if(!or(this))throw new TypeError("invalid receiver");return Gy(q(this,wt),this)}get daysInWeek(){if(!or(this))throw new TypeError("invalid receiver");return Vy(q(this,wt),this)}get daysInMonth(){if(!or(this))throw new TypeError("invalid receiver");return Dd(q(this,wt),this)}get daysInYear(){if(!or(this))throw new TypeError("invalid receiver");return Qf(q(this,wt),this)}get monthsInYear(){if(!or(this))throw new TypeError("invalid receiver");return Jf(q(this,wt),this)}get inLeapYear(){if(!or(this))throw new TypeError("invalid receiver");return em(q(this,wt),this)}with(e,t){if(!or(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("invalid argument");Fh(e);const c=q(this,wt),a=fn(c,["day","month","monthCode","year"]),h=Zi(e,a,"partial");if(!h)throw new TypeError("invalid date-like");let d=Zi(this,a,[]);return d=bc(c,d,h),d=Zi(d,a,[]),gl(c,d,Qi(t))}withCalendar(e){if(!or(this))throw new TypeError("invalid receiver");const t=On(e);return new zd(q(this,ii),q(this,li),q(this,pi),t)}add(e,t){if(!or(this))throw new TypeError("invalid receiver");const c=Eh(e),a=Qi(t);return hs(q(this,wt),this,c,a)}subtract(e,t){if(!or(this))throw new TypeError("invalid receiver");const c=c_(Eh(e)),a=Qi(t);return hs(q(this,wt),this,c,a)}until(e,t){if(!or(this))throw new TypeError("invalid receiver");return Ab("until",this,e,t)}since(e,t){if(!or(this))throw new TypeError("invalid receiver");return Ab("since",this,e,t)}equals(e){if(!or(this))throw new TypeError("invalid receiver");const t=kr(e);for(const c of[ii,li,pi])if(q(this,c)!==q(t,c))return!1;return Ld(q(this,wt),q(t,wt))}toString(e){if(!or(this))throw new TypeError("invalid receiver");return _b(this,Md(Qi(e)))}toJSON(){if(!or(this))throw new TypeError("invalid receiver");return _b(this)}toLocaleString(e,t){if(!or(this))throw new TypeError("invalid receiver");return new Cc(e,t).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainDate")}toPlainDateTime(e){if(!or(this))throw new TypeError("invalid receiver");const t=q(this,ii),c=q(this,li),a=q(this,pi),h=q(this,wt);if(e===void 0)return zs(t,c,a,0,0,0,0,0,0,h);const d=Pa(e);return zs(t,c,a,q(d,ji),q(d,Bi),q(d,Fi),q(d,Ui),q(d,$i),q(d,Gi),h)}toZonedDateTime(e){if(!or(this))throw new TypeError("invalid receiver");let t,c;if(Dr(e)){const _=e.timeZone;_===void 0?t=ps(e):(t=ps(_),c=e.plainTime)}else t=ps(e);const a=q(this,ii),h=q(this,li),d=q(this,pi),s=q(this,wt);let f=0,b=0,x=0,v=0,g=0,P=0;return c!==void 0&&(c=Pa(c),f=q(c,ji),b=q(c,Bi),x=q(c,Fi),v=q(c,Ui),g=q(c,$i),P=q(c,Gi)),Bn(q(us(t,zs(a,h,d,f,b,x,v,g,P,s),"compatible"),Ai),t,s)}toPlainYearMonth(){if(!or(this))throw new TypeError("invalid receiver");const e=q(this,wt);return vc(e,Zi(this,fn(e,["monthCode","year"]),[]))}toPlainMonthDay(){if(!or(this))throw new TypeError("invalid receiver");const e=q(this,wt);return Mh(e,Zi(this,fn(e,["day","monthCode"]),[]))}getISOFields(){if(!or(this))throw new TypeError("invalid receiver");return{calendar:q(this,wt),isoDay:q(this,pi),isoMonth:q(this,li),isoYear:q(this,ii)}}static from(e,t){const c=Qi(t);return or(e)?(ln(c),So(q(e,ii),q(e,li),q(e,pi),q(e,wt))):kr(e,c)}static compare(e,t){const c=kr(e),a=kr(t);return hl(q(c,ii),q(c,li),q(c,pi),q(a,ii),q(a,li),q(a,pi))}}na(zd,"Temporal.PlainDate");class Nd{constructor(e,t,c,a=0,h=0,d=0,s=0,f=0,b=0,x=cn()){const v=Mr(e),g=Mr(t),P=Mr(c),_=Mr(a),S=Mr(h),k=Mr(d),A=Mr(s),y=Mr(f),I=Mr(b),D=On(x);if(arguments.length<3)throw new RangeError("missing argument: isoYear, isoMonth and isoDay are required");K1(this,v,g,P,_,S,k,A,y,I,D)}get calendar(){if(!Wi(this))throw new TypeError("invalid receiver");return q(this,wt)}get year(){if(!Wi(this))throw new TypeError("invalid receiver");return Yf(q(this,wt),this)}get month(){if(!Wi(this))throw new TypeError("invalid receiver");return qf(q(this,wt),this)}get monthCode(){if(!Wi(this))throw new TypeError("invalid receiver");return Id(q(this,wt),this)}get day(){if(!Wi(this))throw new TypeError("invalid receiver");return Xf(q(this,wt),this)}get hour(){if(!Wi(this))throw new TypeError("invalid receiver");return q(this,ji)}get minute(){if(!Wi(this))throw new TypeError("invalid receiver");return q(this,Bi)}get second(){if(!Wi(this))throw new TypeError("invalid receiver");return q(this,Fi)}get millisecond(){if(!Wi(this))throw new TypeError("invalid receiver");return q(this,Ui)}get microsecond(){if(!Wi(this))throw new TypeError("invalid receiver");return q(this,$i)}get nanosecond(){if(!Wi(this))throw new TypeError("invalid receiver");return q(this,Gi)}get era(){if(!Wi(this))throw new TypeError("invalid receiver");return Zf(q(this,wt),this)}get eraYear(){if(!Wi(this))throw new TypeError("invalid receiver");return Kf(q(this,wt),this)}get dayOfWeek(){if(!Wi(this))throw new TypeError("invalid receiver");return Uy(q(this,wt),this)}get dayOfYear(){if(!Wi(this))throw new TypeError("invalid receiver");return $y(q(this,wt),this)}get weekOfYear(){if(!Wi(this))throw new TypeError("invalid receiver");return Gy(q(this,wt),this)}get daysInWeek(){if(!Wi(this))throw new TypeError("invalid receiver");return Vy(q(this,wt),this)}get daysInYear(){if(!Wi(this))throw new TypeError("invalid receiver");return Qf(q(this,wt),this)}get daysInMonth(){if(!Wi(this))throw new TypeError("invalid receiver");return Dd(q(this,wt),this)}get monthsInYear(){if(!Wi(this))throw new TypeError("invalid receiver");return Jf(q(this,wt),this)}get inLeapYear(){if(!Wi(this))throw new TypeError("invalid receiver");return em(q(this,wt),this)}with(e,t){if(!Wi(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("invalid argument");Fh(e);const c=Qi(t),a=q(this,wt),h=fn(a,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),d=Zi(e,h,"partial");if(!d)throw new TypeError("invalid date-time-like");let s=Zi(this,h,[]);s=bc(a,s,d),s=Zi(s,h,[]);const{year:f,month:b,day:x,hour:v,minute:g,second:P,millisecond:_,microsecond:S,nanosecond:k}=Pd(a,s,c);return zs(f,b,x,v,g,P,_,S,k,a)}withPlainTime(e){if(!Wi(this))throw new TypeError("invalid receiver");const t=q(this,ii),c=q(this,li),a=q(this,pi),h=q(this,wt);if(e===void 0)return zs(t,c,a,0,0,0,0,0,0,h);const d=Pa(e);return zs(t,c,a,q(d,ji),q(d,Bi),q(d,Fi),q(d,Ui),q(d,$i),q(d,Gi),h)}withPlainDate(e){if(!Wi(this))throw new TypeError("invalid receiver");const t=kr(e),c=q(t,ii),a=q(t,li),h=q(t,pi);let d=q(t,wt);const s=q(this,ji),f=q(this,Bi),b=q(this,Fi),x=q(this,Ui),v=q(this,$i),g=q(this,Gi);return d=t_(q(this,wt),d),zs(c,a,h,s,f,b,x,v,g,d)}withCalendar(e){if(!Wi(this))throw new TypeError("invalid receiver");const t=On(e);return new Nd(q(this,ii),q(this,li),q(this,pi),q(this,ji),q(this,Bi),q(this,Fi),q(this,Ui),q(this,$i),q(this,Gi),t)}add(e,t){if(!Wi(this))throw new TypeError("invalid receiver");return zb("add",this,e,t)}subtract(e,t){if(!Wi(this))throw new TypeError("invalid receiver");return zb("subtract",this,e,t)}until(e,t){if(!Wi(this))throw new TypeError("invalid receiver");return Pb("until",this,e,t)}since(e,t){if(!Wi(this))throw new TypeError("invalid receiver");return Pb("since",this,e,t)}round(e){if(!Wi(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");const t=typeof e=="string"?Ih("smallestUnit",e):Qi(e),c=Mn(t,"smallestUnit","time",xc,["day"]),a=ws(t,"halfExpand"),h=Oa(t,{day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[c],!1);let d=q(this,ii),s=q(this,li),f=q(this,pi),b=q(this,ji),x=q(this,Bi),v=q(this,Fi),g=q(this,Ui),P=q(this,$i),_=q(this,Gi);return{year:d,month:s,day:f,hour:b,minute:x,second:v,millisecond:g,microsecond:P,nanosecond:_}=ex(d,s,f,b,x,v,g,P,_,h,c,a),zs(d,s,f,b,x,v,g,P,_,q(this,wt))}equals(e){if(!Wi(this))throw new TypeError("invalid receiver");const t=lc(e);for(const c of[ii,li,pi,ji,Bi,Fi,Ui,$i,Gi])if(q(this,c)!==q(t,c))return!1;return Ld(q(this,wt),q(t,wt))}toString(e){if(!Wi(this))throw new TypeError("invalid receiver");const t=Qi(e),{precision:c,unit:a,increment:h}=Ad(t);return wb(this,c,Md(t),{unit:a,increment:h,roundingMode:ws(t,"trunc")})}toJSON(){if(!Wi(this))throw new TypeError("invalid receiver");return wb(this,"auto")}toLocaleString(e,t){if(!Wi(this))throw new TypeError("invalid receiver");return new Cc(e,t).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainDateTime")}toZonedDateTime(e,t){if(!Wi(this))throw new TypeError("invalid receiver");const c=ps(e);return Bn(q(us(c,this,fd(Qi(t))),Ai),c,q(this,wt))}toPlainDate(){if(!Wi(this))throw new TypeError("invalid receiver");return Ah(this)}toPlainYearMonth(){if(!Wi(this))throw new TypeError("invalid receiver");const e=q(this,wt);return vc(e,Zi(this,fn(e,["monthCode","year"]),[]))}toPlainMonthDay(){if(!Wi(this))throw new TypeError("invalid receiver");const e=q(this,wt);return Mh(e,Zi(this,fn(e,["day","monthCode"]),[]))}toPlainTime(){if(!Wi(this))throw new TypeError("invalid receiver");return Hy(this)}getISOFields(){if(!Wi(this))throw new TypeError("invalid receiver");return{calendar:q(this,wt),isoDay:q(this,pi),isoHour:q(this,ji),isoMicrosecond:q(this,$i),isoMillisecond:q(this,Ui),isoMinute:q(this,Bi),isoMonth:q(this,li),isoNanosecond:q(this,Gi),isoSecond:q(this,Fi),isoYear:q(this,ii)}}static from(e,t){const c=Qi(t);return Wi(e)?(ln(c),zs(q(e,ii),q(e,li),q(e,pi),q(e,ji),q(e,Bi),q(e,Fi),q(e,Ui),q(e,$i),q(e,Gi),q(e,wt))):lc(e,c)}static compare(e,t){const c=lc(e),a=lc(t);for(const h of[ii,li,pi,ji,Bi,Fi,Ui,$i,Gi]){const d=q(c,h),s=q(a,h);if(d!==s)return pc(d-s)}return 0}}na(Nd,"Temporal.PlainDateTime");class ul{constructor(e=0,t=0,c=0,a=0,h=0,d=0,s=0,f=0,b=0,x=0){const v=Sn(e),g=Sn(t),P=Sn(c),_=Sn(a),S=Sn(h),k=Sn(d),A=Sn(s),y=Sn(f),I=Sn(b),D=Sn(x);nm(v,g,P,_,S,k,A,y,I,D),sa(this),Yi(this,is,v),Yi(this,Dn,g),Yi(this,vs,P),Yi(this,rs,_),Yi(this,ns,S),Yi(this,ss,k),Yi(this,os,A),Yi(this,as,y),Yi(this,ls,I),Yi(this,cs,D)}get years(){if(!Zr(this))throw new TypeError("invalid receiver");return q(this,is)}get months(){if(!Zr(this))throw new TypeError("invalid receiver");return q(this,Dn)}get weeks(){if(!Zr(this))throw new TypeError("invalid receiver");return q(this,vs)}get days(){if(!Zr(this))throw new TypeError("invalid receiver");return q(this,rs)}get hours(){if(!Zr(this))throw new TypeError("invalid receiver");return q(this,ns)}get minutes(){if(!Zr(this))throw new TypeError("invalid receiver");return q(this,ss)}get seconds(){if(!Zr(this))throw new TypeError("invalid receiver");return q(this,os)}get milliseconds(){if(!Zr(this))throw new TypeError("invalid receiver");return q(this,as)}get microseconds(){if(!Zr(this))throw new TypeError("invalid receiver");return q(this,ls)}get nanoseconds(){if(!Zr(this))throw new TypeError("invalid receiver");return q(this,cs)}get sign(){if(!Zr(this))throw new TypeError("invalid receiver");return Qo(q(this,is),q(this,Dn),q(this,vs),q(this,rs),q(this,ns),q(this,ss),q(this,os),q(this,as),q(this,ls),q(this,cs))}get blank(){if(!Zr(this))throw new TypeError("invalid receiver");return Qo(q(this,is),q(this,Dn),q(this,vs),q(this,rs),q(this,ns),q(this,ss),q(this,os),q(this,as),q(this,ls),q(this,cs))===0}with(e){if(!Zr(this))throw new TypeError("invalid receiver");const t=Zi(e,["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"],"partial");if(!t)throw new TypeError("invalid duration-like");const{years:c=q(this,is),months:a=q(this,Dn),weeks:h=q(this,vs),days:d=q(this,rs),hours:s=q(this,ns),minutes:f=q(this,ss),seconds:b=q(this,os),milliseconds:x=q(this,as),microseconds:v=q(this,ls),nanoseconds:g=q(this,cs)}=t;return new ul(c,a,h,d,s,f,b,x,v,g)}negated(){if(!Zr(this))throw new TypeError("invalid receiver");return c_(this)}abs(){if(!Zr(this))throw new TypeError("invalid receiver");return new ul(Math.abs(q(this,is)),Math.abs(q(this,Dn)),Math.abs(q(this,vs)),Math.abs(q(this,rs)),Math.abs(q(this,ns)),Math.abs(q(this,ss)),Math.abs(q(this,os)),Math.abs(q(this,as)),Math.abs(q(this,ls)),Math.abs(q(this,cs)))}add(e,t){if(!Zr(this))throw new TypeError("invalid receiver");return Rb("add",this,e,t)}subtract(e,t){if(!Zr(this))throw new TypeError("invalid receiver");return Rb("subtract",this,e,t)}round(e){if(!Zr(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");let t=q(this,is),c=q(this,Dn),a=q(this,vs),h=q(this,rs),d=q(this,ns),s=q(this,ss),f=q(this,os),b=q(this,as),x=q(this,ls),v=q(this,cs),g=ny(t,c,a,h,d,s,f,b,x,v);const P=typeof e=="string"?Ih("smallestUnit",e):Qi(e);let _=Mn(P,"smallestUnit","datetime",void 0),S=!0;_||(S=!1,_="nanosecond"),g=$s(g,_);let k=Mn(P,"largestUnit","datetime",void 0,["auto"]),A=!0;if(k||(A=!1,k=g),k==="auto"&&(k=g),!S&&!A)throw new RangeError("at least one of smallestUnit or largestUnit is required");if($s(k,_)!==k)throw new RangeError(`largestUnit ${k} cannot be smaller than smallestUnit ${_}`);const y=ws(P,"halfExpand"),I=Fy(P,_);let D=nf(P);return{years:t,months:c,weeks:a,days:h}=Wp(t,c,a,h,k,D),{years:t,months:c,weeks:a,days:h,hours:d,minutes:s,seconds:f,milliseconds:b,microseconds:x,nanoseconds:v}=xl(t,c,a,h,d,s,f,b,x,v,I,_,y,D),{years:t,months:c,weeks:a,days:h,hours:d,minutes:s,seconds:f,milliseconds:b,microseconds:x,nanoseconds:v}=y_(t,c,a,h,d,s,f,b,x,v,I,_,y,D),{years:t,months:c,weeks:a,days:h}=function(M,z,Y,X,Z,j){let V=M,$=z,R=Y,L=X;const G=Pi("%Temporal.Duration%"),U=Qo(V,$,R,L,0,0,0,0,0,0);if(U===0)return{years:V,months:$,weeks:R,days:L};let F,H;j&&(H=kr(j),F=q(H,wt));const W=new G(U),ne=new G(0,U),ue=new G(0,0,U);switch(Z){case"year":{if(!F)throw new RangeError("a starting point is required for years balancing");let ie,oe,Te;for({relativeTo:ie,days:oe}=Zn(F,H,W);ur(L)>=ur(oe);)L-=oe,V+=U,H=ie,{relativeTo:ie,days:oe}=Zn(F,H,W);for({relativeTo:ie,days:Te}=Zn(F,H,ne);ur(L)>=ur(Te);)L-=Te,$+=U,H=ie,{relativeTo:ie,days:Te}=Zn(F,H,ne);const ge=F.dateAdd;ie=hs(F,H,W,void 0,ge);const we=F.dateUntil,K=Vn(null);K.largestUnit="month";let Q=ml(F,H,ie,K,we),ae=q(Q,Dn);for(;ur($)>=ur(ae);){$-=ae,V+=U,H=ie,ie=hs(F,H,W,void 0,ge);const ye=Vn(null);ye.largestUnit="month",Q=ml(F,H,ie,ye,we),ae=q(Q,Dn)}break}case"month":{if(!F)throw new RangeError("a starting point is required for months balancing");let ie,oe;for({relativeTo:ie,days:oe}=Zn(F,H,ne);ur(L)>=ur(oe);)L-=oe,$+=U,H=ie,{relativeTo:ie,days:oe}=Zn(F,H,ne);break}case"week":{if(!F)throw new RangeError("a starting point is required for weeks balancing");let ie,oe;for({relativeTo:ie,days:oe}=Zn(F,H,ue);ur(L)>=ur(oe);)L-=oe,R+=U,H=ie,{relativeTo:ie,days:oe}=Zn(F,H,ue);break}}return{years:V,months:$,weeks:R,days:L}}(t,c,a,h,k,D),xi(D)&&(D=ly(D,t,c,a,0)),{days:h,hours:d,minutes:s,seconds:f,milliseconds:b,microseconds:x,nanoseconds:v}=Us(h,d,s,f,b,x,v,k,D),new ul(t,c,a,h,d,s,f,b,x,v)}total(e){if(!Zr(this))throw new TypeError("invalid receiver");let t=q(this,is),c=q(this,Dn),a=q(this,vs),h=q(this,rs),d=q(this,ns),s=q(this,ss),f=q(this,os),b=q(this,as),x=q(this,ls),v=q(this,cs);if(e===void 0)throw new TypeError("options argument is required");const g=typeof e=="string"?Ih("unit",e):Qi(e),P=Mn(g,"unit","datetime",xc),_=nf(g);let S;({years:t,months:c,weeks:a,days:h}=Wp(t,c,a,h,P,_)),xi(_)&&(S=ly(_,t,c,a,0)),{days:h,hours:d,minutes:s,seconds:f,milliseconds:b,microseconds:x,nanoseconds:v}=Us(h,d,s,f,b,x,v,P,S);const{total:k}=xl(t,c,a,h,d,s,f,b,x,v,1,P,"trunc",_);return k}toString(e){if(!Zr(this))throw new TypeError("invalid receiver");const t=Qi(e),{precision:c,unit:a,increment:h}=Ad(t);if(c==="minute")throw new RangeError('smallestUnit must not be "minute"');return Eg(this,c,{unit:a,increment:h,roundingMode:ws(t,"trunc")})}toJSON(){if(!Zr(this))throw new TypeError("invalid receiver");return Eg(this)}toLocaleString(e,t){if(!Zr(this))throw new TypeError("invalid receiver");return typeof Intl<"u"&&Intl.DurationFormat!==void 0?new Intl.DurationFormat(e,t).format(this):(console.warn("Temporal.Duration.prototype.toLocaleString() requires Intl.DurationFormat."),Eg(this))}valueOf(){throw new TypeError("use compare() to compare Temporal.Duration")}static from(e){return Zr(e)?new ul(q(e,is),q(e,Dn),q(e,vs),q(e,rs),q(e,ns),q(e,ss),q(e,os),q(e,as),q(e,ls),q(e,cs)):Eh(e)}static compare(e,t,c){const a=Eh(e),h=Eh(t),d=nf(Qi(c)),s=q(a,is),f=q(a,Dn),b=q(a,vs);let x=q(a,rs);const v=q(a,ns),g=q(a,ss),P=q(a,os),_=q(a,as),S=q(a,ls);let k=q(a,cs);const A=q(h,is),y=q(h,Dn),I=q(h,vs);let D=q(h,rs);const w=q(h,ns),M=q(h,ss),z=q(h,os),Y=q(h,as),X=q(h,ls);let Z=q(h,cs);const j=kb(d,s,f,b,x),V=kb(d,A,y,I,D);s===0&&A===0&&f===0&&y===0&&b===0&&I===0||({days:x}=Wp(s,f,b,x,"day",d),{days:D}=Wp(A,y,I,D,"day",d));const $=Ph(x,v,g,P,_,S,k,j),R=Ph(D,w,M,z,Y,X,Z,V);return pc(he.toNumber(he.subtract($,R)))}}na(ul,"Temporal.Duration");const pk=Object.create;class ox{constructor(e,t,c=cn(),a=1972){const h=Mr(e),d=Mr(t),s=On(c),f=Mr(a);if(arguments.length<2)throw new RangeError("missing argument: isoMonth and isoDay are required");Q1(this,h,d,s,f)}get monthCode(){if(!Ln(this))throw new TypeError("invalid receiver");return Id(q(this,wt),this)}get day(){if(!Ln(this))throw new TypeError("invalid receiver");return Xf(q(this,wt),this)}get calendar(){if(!Ln(this))throw new TypeError("invalid receiver");return q(this,wt)}with(e,t){if(!Ln(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("invalid argument");Fh(e);const c=q(this,wt),a=fn(c,["day","month","monthCode","year"]),h=Zi(e,a,"partial");if(!h)throw new TypeError("invalid month-day-like");let d=Zi(this,a,[]);return d=bc(c,d,h),d=Zi(d,a,[]),Mh(c,d,Qi(t))}equals(e){if(!Ln(this))throw new TypeError("invalid receiver");const t=bb(e);for(const c of[li,pi,ii])if(q(this,c)!==q(t,c))return!1;return Ld(q(this,wt),q(t,wt))}toString(e){if(!Ln(this))throw new TypeError("invalid receiver");return Tb(this,Md(Qi(e)))}toJSON(){if(!Ln(this))throw new TypeError("invalid receiver");return Tb(this)}toLocaleString(e,t){if(!Ln(this))throw new TypeError("invalid receiver");return new Cc(e,t).format(this)}valueOf(){throw new TypeError("use equals() to compare Temporal.PlainMonthDay")}toPlainDate(e){if(!Ln(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("argument should be an object");const t=q(this,wt),c=fn(t,["day","monthCode"]),a=Zi(this,c,[]),h=fn(t,["year"]);let d=bc(t,a,Zi(e,h,[]));d=Zi(d,[...new Set([...c,...h])],[]);const s=pk(null);return s.overflow="reject",gl(t,d,s)}getISOFields(){if(!Ln(this))throw new TypeError("invalid receiver");return{calendar:q(this,wt),isoDay:q(this,pi),isoMonth:q(this,li),isoYear:q(this,ii)}}static from(e,t){const c=Qi(t);return Ln(e)?(ln(c),md(q(e,li),q(e,pi),q(e,wt),q(e,ii))):bb(e,c)}}na(ox,"Temporal.PlainMonthDay");const ax=()=>new(Pi("%Temporal.Instant%"))(ix()),Ub=(n,e=al())=>{const t=ps(e),c=On(n);return Zs(t,ax(),c)},Mg=(n=al())=>{const e=ps(n),t=cn();return Zs(e,ax(),t)},$b=(n,e=al())=>{const t=ps(e),c=On(n);return Bn(ix(),t,c)},al=()=>function(){const e=new F1("en-us");return new(Pi("%Temporal.TimeZone%"))(Y1(e.resolvedOptions().timeZone))}(),R_={instant:ax,plainDateTime:Ub,plainDateTimeISO:Mg,plainDate:(n,e=al())=>Ah(Ub(n,e)),plainDateISO:(n=al())=>Ah(Mg(n)),plainTimeISO:(n=al())=>Hy(Mg(n)),timeZone:al,zonedDateTime:$b,zonedDateTimeISO:(n=al())=>$b(cn(),n),[Symbol.toStringTag]:"Temporal.Now"};Object.defineProperty(R_,Symbol.toStringTag,{value:"Temporal.Now",writable:!1,enumerable:!1,configurable:!0});const fk=Object.assign;function Gb(n,e,t){let c=q(n,ji),a=q(n,Bi),h=q(n,Fi),d=q(n,Ui),s=q(n,$i),f=q(n,Gi);if(t){const{unit:b,increment:x,roundingMode:v}=t;({hour:c,minute:a,second:h,millisecond:d,microsecond:s,nanosecond:f}=tx(c,a,h,d,s,f,x,b,v))}return`${Ur(c)}:${Ur(a)}${tm(h,d,s,f,e)}`}class mc{constructor(e=0,t=0,c=0,a=0,h=0,d=0){const s=Mr(e),f=Mr(t),b=Mr(c),x=Mr(a),v=Mr(h),g=Mr(d);rm(s,f,b,x,v,g),sa(this),Yi(this,ji,s),Yi(this,Bi,f),Yi(this,Fi,b),Yi(this,Ui,x),Yi(this,$i,v),Yi(this,Gi,g),Yi(this,wt,cn())}get calendar(){if(!Kr(this))throw new TypeError("invalid receiver");return q(this,wt)}get hour(){if(!Kr(this))throw new TypeError("invalid receiver");return q(this,ji)}get minute(){if(!Kr(this))throw new TypeError("invalid receiver");return q(this,Bi)}get second(){if(!Kr(this))throw new TypeError("invalid receiver");return q(this,Fi)}get millisecond(){if(!Kr(this))throw new TypeError("invalid receiver");return q(this,Ui)}get microsecond(){if(!Kr(this))throw new TypeError("invalid receiver");return q(this,$i)}get nanosecond(){if(!Kr(this))throw new TypeError("invalid receiver");return q(this,Gi)}with(e,t){if(!Kr(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("invalid argument");Fh(e);const c=_f(e,"partial"),a=ln(Qi(t)),h=_f(this);let{hour:d,minute:s,second:f,millisecond:b,microsecond:x,nanosecond:v}=fk(h,c);return{hour:d,minute:s,second:f,millisecond:b,microsecond:x,nanosecond:v}=Hf(d,s,f,b,x,v,a),new mc(d,s,f,b,x,v)}add(e){if(!Kr(this))throw new TypeError("invalid receiver");return Nb("add",this,e)}subtract(e){if(!Kr(this))throw new TypeError("invalid receiver");return Nb("subtract",this,e)}until(e,t){if(!Kr(this))throw new TypeError("invalid receiver");return Ib("until",this,e,t)}since(e,t){if(!Kr(this))throw new TypeError("invalid receiver");return Ib("since",this,e,t)}round(e){if(!Kr(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");const t=typeof e=="string"?Ih("smallestUnit",e):Qi(e),c=Mn(t,"smallestUnit","time",xc),a=ws(t,"halfExpand"),h=Oa(t,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[c],!1);let d=q(this,ji),s=q(this,Bi),f=q(this,Fi),b=q(this,Ui),x=q(this,$i),v=q(this,Gi);return{hour:d,minute:s,second:f,millisecond:b,microsecond:x,nanosecond:v}=tx(d,s,f,b,x,v,h,c,a),new mc(d,s,f,b,x,v)}equals(e){if(!Kr(this))throw new TypeError("invalid receiver");const t=Pa(e);for(const c of[ji,Bi,Fi,Ui,$i,Gi])if(q(this,c)!==q(t,c))return!1;return!0}toString(e){if(!Kr(this))throw new TypeError("invalid receiver");const t=Qi(e),{precision:c,unit:a,increment:h}=Ad(t);return Gb(this,c,{unit:a,increment:h,roundingMode:ws(t,"trunc")})}toJSON(){if(!Kr(this))throw new TypeError("invalid receiver");return Gb(this,"auto")}toLocaleString(e,t){if(!Kr(this))throw new TypeError("invalid receiver");return new Cc(e,t).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainTime")}toPlainDateTime(e){if(!Kr(this))throw new TypeError("invalid receiver");const t=kr(e),c=q(t,ii),a=q(t,li),h=q(t,pi),d=q(t,wt);return zs(c,a,h,q(this,ji),q(this,Bi),q(this,Fi),q(this,Ui),q(this,$i),q(this,Gi),d)}toZonedDateTime(e){if(!Kr(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("invalid argument");const t=e.plainDate;if(t===void 0)throw new TypeError("missing date property");const c=kr(t),a=e.timeZone;if(a===void 0)throw new TypeError("missing timeZone property");const h=ps(a),d=q(c,ii),s=q(c,li),f=q(c,pi),b=q(c,wt),x=q(this,ji),v=q(this,Bi),g=q(this,Fi),P=q(this,Ui),_=q(this,$i),S=q(this,Gi);return Bn(q(us(h,new(Pi("%Temporal.PlainDateTime%"))(d,s,f,x,v,g,P,_,S,b),"compatible"),Ai),h,b)}getISOFields(){if(!Kr(this))throw new TypeError("invalid receiver");return{calendar:q(this,wt),isoHour:q(this,ji),isoMicrosecond:q(this,$i),isoMillisecond:q(this,Ui),isoMinute:q(this,Bi),isoNanosecond:q(this,Gi),isoSecond:q(this,Fi)}}static from(e,t){const c=ln(Qi(t));return Kr(e)?new mc(q(e,ji),q(e,Bi),q(e,Fi),q(e,Ui),q(e,$i),q(e,Gi)):Pa(e,c)}static compare(e,t){const c=Pa(e),a=Pa(t);for(const h of[ji,Bi,Fi,Ui,$i,Gi]){const d=q(c,h),s=q(a,h);if(d!==s)return pc(d-s)}return 0}}na(mc,"Temporal.PlainTime");class lx{constructor(e){if(arguments.length<1)throw new RangeError("missing argument: identifier is required");const t=Wy(e);sa(this),Yi(this,nl,t)}get id(){if(!qo(this))throw new TypeError("invalid receiver");return Oi(this)}getOffsetNanosecondsFor(e){if(!qo(this))throw new TypeError("invalid receiver");const t=Zo(e),c=q(this,nl);return id(c)?_c(c):Ma(q(t,Ai),c)}getOffsetStringFor(e){if(!qo(this))throw new TypeError("invalid receiver");return sy(this,Zo(e))}getPlainDateTimeFor(e,t=cn()){return Zs(this,Zo(e),On(t))}getInstantFor(e,t){if(!qo(this))throw new TypeError("invalid receiver");return us(this,lc(e),fd(Qi(t)))}getPossibleInstantsFor(e){if(!qo(this))throw new TypeError("invalid receiver");const t=lc(e),c=Pi("%Temporal.Instant%"),a=q(this,nl);if(id(a)){const h=yl(q(t,ii),q(t,li),q(t,pi),q(t,ji),q(t,Bi),q(t,Fi),q(t,Ui),q(t,$i),q(t,Gi));if(h===null)throw new RangeError("DateTime outside of supported range");const d=_c(a);return[new c(he.subtract(h,he.BigInt(d)))]}return function(d,s,f,b,x,v,g,P,_,S){const k=yl(s,f,b,x,v,g,P,_,S);if(k===null)throw new RangeError("DateTime outside of supported range");let A=he.subtract(k,fl);he.lessThan(A,hd)&&(A=k);let y=he.add(k,fl);he.greaterThan(y,ud)&&(y=k);const I=Ma(A,d),D=Ma(y,d);return(I===D?[I]:[I,D]).map(w=>{const M=he.subtract(k,he.BigInt(w)),z=o_(M,d);if(s===z.year&&f===z.month&&b===z.day&&x===z.hour&&v===z.minute&&g===z.second&&P===z.millisecond&&_===z.microsecond&&S===z.nanosecond)return M}).filter(w=>w!==void 0)}(a,q(t,ii),q(t,li),q(t,pi),q(t,ji),q(t,Bi),q(t,Fi),q(t,Ui),q(t,$i),q(t,Gi)).map(h=>new c(h))}getNextTransition(e){if(!qo(this))throw new TypeError("invalid receiver");const t=Zo(e),c=q(this,nl);if(id(c)||c==="UTC")return null;let a=q(t,Ai);const h=Pi("%Temporal.Instant%");return a=function(s,f){const b=he.add(s,G1),x=Sb(a_(),b);let v=Sb($1,s);const g=Ma(v,f);let P=v,_=g;for(;g===_&&he.lessThan(he.BigInt(v),x);)P=he.add(v,V1),_=Ma(P,f),g===_&&(v=P);return g===_?null:v_(S=>Ma(S,f),v,P,g,_)}(a,c),a===null?null:new h(a)}getPreviousTransition(e){if(!qo(this))throw new TypeError("invalid receiver");const t=Zo(e),c=q(this,nl);if(id(c)||c==="UTC")return null;let a=q(t,Ai);const h=Pi("%Temporal.Instant%");return a=l_(a,c),a===null?null:new h(a)}toString(){if(!qo(this))throw new TypeError("invalid receiver");return Oi(q(this,nl))}toJSON(){if(!qo(this))throw new TypeError("invalid receiver");return Oi(this)}static from(e){return ps(e)}}na(lx,"Temporal.TimeZone");const mk=Object.create;class cx{constructor(e,t,c=cn(),a=1){const h=Mr(e),d=Mr(t),s=On(c),f=Mr(a);if(arguments.length<2)throw new RangeError("missing argument: isoYear and isoMonth are required");J1(this,h,d,s,f)}get year(){if(!mr(this))throw new TypeError("invalid receiver");return Yf(q(this,wt),this)}get month(){if(!mr(this))throw new TypeError("invalid receiver");return qf(q(this,wt),this)}get monthCode(){if(!mr(this))throw new TypeError("invalid receiver");return Id(q(this,wt),this)}get calendar(){if(!mr(this))throw new TypeError("invalid receiver");return q(this,wt)}get era(){if(!mr(this))throw new TypeError("invalid receiver");return Zf(q(this,wt),this)}get eraYear(){if(!mr(this))throw new TypeError("invalid receiver");return Kf(q(this,wt),this)}get daysInMonth(){if(!mr(this))throw new TypeError("invalid receiver");return Dd(q(this,wt),this)}get daysInYear(){if(!mr(this))throw new TypeError("invalid receiver");return Qf(q(this,wt),this)}get monthsInYear(){if(!mr(this))throw new TypeError("invalid receiver");return Jf(q(this,wt),this)}get inLeapYear(){if(!mr(this))throw new TypeError("invalid receiver");return em(q(this,wt),this)}with(e,t){if(!mr(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("invalid argument");Fh(e);const c=q(this,wt),a=fn(c,["month","monthCode","year"]),h=Zi(e,a,"partial");if(!h)throw new TypeError("invalid year-month-like");let d=Zi(this,a,[]);return d=bc(c,d,h),d=Zi(d,a,[]),vc(c,d,Qi(t))}add(e,t){if(!mr(this))throw new TypeError("invalid receiver");return jb("add",this,e,t)}subtract(e,t){if(!mr(this))throw new TypeError("invalid receiver");return jb("subtract",this,e,t)}until(e,t){if(!mr(this))throw new TypeError("invalid receiver");return Db("until",this,e,t)}since(e,t){if(!mr(this))throw new TypeError("invalid receiver");return Db("since",this,e,t)}equals(e){if(!mr(this))throw new TypeError("invalid receiver");const t=ed(e);for(const c of[ii,li,pi])if(q(this,c)!==q(t,c))return!1;return Ld(q(this,wt),q(t,wt))}toString(e){if(!mr(this))throw new TypeError("invalid receiver");return Eb(this,Md(Qi(e)))}toJSON(){if(!mr(this))throw new TypeError("invalid receiver");return Eb(this)}toLocaleString(e,t){if(!mr(this))throw new TypeError("invalid receiver");return new Cc(e,t).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainYearMonth")}toPlainDate(e){if(!mr(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("argument should be an object");const t=q(this,wt),c=fn(t,["monthCode","year"]),a=Zi(this,c,[]),h=fn(t,["day"]);let d=bc(t,a,Zi(e,h,[]));d=Zi(d,[...new Set([...c,...h])],[]);const s=mk(null);return s.overflow="reject",gl(t,d,s)}getISOFields(){if(!mr(this))throw new TypeError("invalid receiver");return{calendar:q(this,wt),isoDay:q(this,pi),isoMonth:q(this,li),isoYear:q(this,ii)}}static from(e,t){const c=Qi(t);return mr(e)?(ln(c),gd(q(e,ii),q(e,li),q(e,wt),q(e,pi))):ed(e,c)}static compare(e,t){const c=ed(e),a=ed(t);return hl(q(c,ii),q(c,li),q(c,pi),q(a,ii),q(a,li),q(a,pi))}}na(cx,"Temporal.PlainYearMonth");class hx{constructor(e,t,c=cn()){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");e_(this,nd(e),ps(t),On(c))}get calendar(){if(!xi(this))throw new TypeError("invalid receiver");return q(this,wt)}get timeZone(){if(!xi(this))throw new TypeError("invalid receiver");return q(this,br)}get year(){if(!xi(this))throw new TypeError("invalid receiver");return Yf(q(this,wt),Lr(this))}get month(){if(!xi(this))throw new TypeError("invalid receiver");return qf(q(this,wt),Lr(this))}get monthCode(){if(!xi(this))throw new TypeError("invalid receiver");return Id(q(this,wt),Lr(this))}get day(){if(!xi(this))throw new TypeError("invalid receiver");return Xf(q(this,wt),Lr(this))}get hour(){if(!xi(this))throw new TypeError("invalid receiver");return q(Lr(this),ji)}get minute(){if(!xi(this))throw new TypeError("invalid receiver");return q(Lr(this),Bi)}get second(){if(!xi(this))throw new TypeError("invalid receiver");return q(Lr(this),Fi)}get millisecond(){if(!xi(this))throw new TypeError("invalid receiver");return q(Lr(this),Ui)}get microsecond(){if(!xi(this))throw new TypeError("invalid receiver");return q(Lr(this),$i)}get nanosecond(){if(!xi(this))throw new TypeError("invalid receiver");return q(Lr(this),Gi)}get era(){if(!xi(this))throw new TypeError("invalid receiver");return Zf(q(this,wt),Lr(this))}get eraYear(){if(!xi(this))throw new TypeError("invalid receiver");return Kf(q(this,wt),Lr(this))}get epochSeconds(){if(!xi(this))throw new TypeError("invalid receiver");const e=q(this,Ai);return he.toNumber(he.divide(e,Ia))}get epochMilliseconds(){if(!xi(this))throw new TypeError("invalid receiver");const e=q(this,Ai);return he.toNumber(he.divide(e,ho))}get epochMicroseconds(){if(!xi(this))throw new TypeError("invalid receiver");const e=q(this,Ai);return Sf(he.divide(e,vr))}get epochNanoseconds(){if(!xi(this))throw new TypeError("invalid receiver");return Sf(q(this,Ai))}get dayOfWeek(){if(!xi(this))throw new TypeError("invalid receiver");return Uy(q(this,wt),Lr(this))}get dayOfYear(){if(!xi(this))throw new TypeError("invalid receiver");return $y(q(this,wt),Lr(this))}get weekOfYear(){if(!xi(this))throw new TypeError("invalid receiver");return Gy(q(this,wt),Lr(this))}get hoursInDay(){if(!xi(this))throw new TypeError("invalid receiver");const e=Lr(this),t=Pi("%Temporal.PlainDateTime%"),c=q(e,ii),a=q(e,li),h=q(e,pi),d=new t(c,a,h,0,0,0,0,0,0),s=dc(c,a,h,0,0,0,1,"reject"),f=new t(s.year,s.month,s.day,0,0,0,0,0,0),b=q(this,br),x=q(us(b,d,"compatible"),Ai),v=q(us(b,f,"compatible"),Ai);return he.toNumber(he.subtract(v,x))/36e11}get daysInWeek(){if(!xi(this))throw new TypeError("invalid receiver");return Vy(q(this,wt),Lr(this))}get daysInMonth(){if(!xi(this))throw new TypeError("invalid receiver");return Dd(q(this,wt),Lr(this))}get daysInYear(){if(!xi(this))throw new TypeError("invalid receiver");return Qf(q(this,wt),Lr(this))}get monthsInYear(){if(!xi(this))throw new TypeError("invalid receiver");return Jf(q(this,wt),Lr(this))}get inLeapYear(){if(!xi(this))throw new TypeError("invalid receiver");return em(q(this,wt),Lr(this))}get offset(){if(!xi(this))throw new TypeError("invalid receiver");return sy(q(this,br),q(this,Kn))}get offsetNanoseconds(){if(!xi(this))throw new TypeError("invalid receiver");return Oo(q(this,br),q(this,Kn))}with(e,t){if(!xi(this))throw new TypeError("invalid receiver");if(!Dr(e))throw new TypeError("invalid zoned-date-time-like");Fh(e);const c=Qi(t),a=fd(c),h=ry(c,"prefer"),d=q(this,br),s=q(this,wt),f=iy(fn(s,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),"offset"),b=Zi(e,f,"partial"),x=iy(f,"timeZone");let v=Zi(this,x,["timeZone","offset"]);v=bc(s,v,b),v=Zi(v,x,["timeZone","offset"]);let{year:g,month:P,day:_,hour:S,minute:k,second:A,millisecond:y,microsecond:I,nanosecond:D}=Pd(s,v,c);return Bn(wf(g,P,_,S,k,A,y,I,D,"option",_c(v.offset),d,a,h,!1),q(this,br),s)}withPlainDate(e){if(!xi(this))throw new TypeError("invalid receiver");const t=kr(e),c=q(t,ii),a=q(t,li),h=q(t,pi);let d=q(t,wt);const s=Lr(this),f=q(s,ji),b=q(s,Bi),x=q(s,Fi),v=q(s,Ui),g=q(s,$i),P=q(s,Gi);d=t_(q(this,wt),d);const _=q(this,br);return Bn(q(us(_,new(Pi("%Temporal.PlainDateTime%"))(c,a,h,f,b,x,v,g,P,d),"compatible"),Ai),_,d)}withPlainTime(e){if(!xi(this))throw new TypeError("invalid receiver");const t=Pi("%Temporal.PlainTime%"),c=e===void 0?new t:Pa(e),a=Lr(this),h=q(a,ii),d=q(a,li),s=q(a,pi),f=q(this,wt),b=q(c,ji),x=q(c,Bi),v=q(c,Fi),g=q(c,Ui),P=q(c,$i),_=q(c,Gi),S=q(this,br);return Bn(q(us(S,new(Pi("%Temporal.PlainDateTime%"))(h,d,s,b,x,v,g,P,_,f),"compatible"),Ai),S,f)}withTimeZone(e){if(!xi(this))throw new TypeError("invalid receiver");const t=ps(e);return Bn(q(this,Ai),t,q(this,wt))}withCalendar(e){if(!xi(this))throw new TypeError("invalid receiver");const t=On(e);return Bn(q(this,Ai),q(this,br),t)}add(e,t){if(!xi(this))throw new TypeError("invalid receiver");return Bb("add",this,e,t)}subtract(e,t){if(!xi(this))throw new TypeError("invalid receiver");return Bb("subtract",this,e,t)}until(e,t){if(!xi(this))throw new TypeError("invalid receiver");return Lb("until",this,e,t)}since(e,t){if(!xi(this))throw new TypeError("invalid receiver");return Lb("since",this,e,t)}round(e){if(!xi(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");const t=typeof e=="string"?Ih("smallestUnit",e):Qi(e),c=Mn(t,"smallestUnit","time",xc,["day"]),a=ws(t,"halfExpand"),h=Oa(t,{day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[c],!1),d=Lr(this);let s=q(d,ii),f=q(d,li),b=q(d,pi),x=q(d,ji),v=q(d,Bi),g=q(d,Fi),P=q(d,Ui),_=q(d,$i),S=q(d,Gi);const k=Pi("%Temporal.PlainDateTime%"),A=q(this,br),y=q(this,wt),I=us(A,new k(q(d,ii),q(d,li),q(d,pi),0,0,0,0,0,0),"compatible"),D=uo(I,A,y,0,0,0,1,0,0,0,0,0,0),w=he.subtract(D,he.BigInt(q(I,Ai)));if(he.equal(w,on))throw new RangeError("cannot round a ZonedDateTime in a calendar with zero-length days");return{year:s,month:f,day:b,hour:x,minute:v,second:g,millisecond:P,microsecond:_,nanosecond:S}=ex(s,f,b,x,v,g,P,_,S,h,c,a,he.toNumber(w)),Bn(wf(s,f,b,x,v,g,P,_,S,"option",Oo(A,q(this,Kn)),A,"compatible","prefer",!1),A,q(this,wt))}equals(e){if(!xi(this))throw new TypeError("invalid receiver");const t=td(e),c=q(this,Ai),a=q(t,Ai);return!!he.equal(he.BigInt(c),he.BigInt(a))&&!!i_(q(this,br),q(t,br))&&Ld(q(this,wt),q(t,wt))}toString(e){if(!xi(this))throw new TypeError("invalid receiver");const t=Qi(e),{precision:c,unit:a,increment:h}=Ad(t),d=ws(t,"trunc");return Cb(this,c,Md(t),function(f){return bl(f,"timeZoneName",["auto","never"],"auto")}(t),function(f){return bl(f,"offset",["auto","never"],"auto")}(t),{unit:a,increment:h,roundingMode:d})}toLocaleString(e,t){if(!xi(this))throw new TypeError("invalid receiver");return new Cc(e,t).format(this)}toJSON(){if(!xi(this))throw new TypeError("invalid receiver");return Cb(this,"auto")}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.ZonedDateTime")}startOfDay(){if(!xi(this))throw new TypeError("invalid receiver");const e=Lr(this),t=Pi("%Temporal.PlainDateTime%"),c=q(this,wt),a=new t(q(e,ii),q(e,li),q(e,pi),0,0,0,0,0,0,c),h=q(this,br);return Bn(q(us(h,a,"compatible"),Ai),h,c)}toInstant(){if(!xi(this))throw new TypeError("invalid receiver");return new(Pi("%Temporal.Instant%"))(q(this,Ai))}toPlainDate(){if(!xi(this))throw new TypeError("invalid receiver");return Ah(Lr(this))}toPlainTime(){if(!xi(this))throw new TypeError("invalid receiver");return Hy(Lr(this))}toPlainDateTime(){if(!xi(this))throw new TypeError("invalid receiver");return Lr(this)}toPlainYearMonth(){if(!xi(this))throw new TypeError("invalid receiver");const e=q(this,wt);return vc(e,Zi(this,fn(e,["monthCode","year"]),[]))}toPlainMonthDay(){if(!xi(this))throw new TypeError("invalid receiver");const e=q(this,wt);return Mh(e,Zi(this,fn(e,["day","monthCode"]),[]))}getISOFields(){if(!xi(this))throw new TypeError("invalid receiver");const e=Lr(this),t=q(this,br);return{calendar:q(this,wt),isoDay:q(e,pi),isoHour:q(e,ji),isoMicrosecond:q(e,$i),isoMillisecond:q(e,Ui),isoMinute:q(e,Bi),isoMonth:q(e,li),isoNanosecond:q(e,Gi),isoSecond:q(e,Fi),isoYear:q(e,ii),offset:sy(t,q(this,Kn)),timeZone:t}}static from(e,t){const c=Qi(t);return xi(e)?(ln(c),fd(c),ry(c,"reject"),Bn(q(e,Ai),q(e,br),q(e,wt))):td(e,c)}static compare(e,t){const c=td(e),a=td(t),h=q(c,Ai),d=q(a,Ai);return he.lessThan(he.BigInt(h),he.BigInt(d))?-1:he.greaterThan(he.BigInt(h),he.BigInt(d))?1:0}}function Lr(n){return Zs(q(n,br),q(n,Kn),q(n,wt))}na(hx,"Temporal.ZonedDateTime");var pn=Object.freeze({__proto__:null,Instant:Do,Calendar:Af,PlainDate:zd,PlainDateTime:Nd,Duration:ul,PlainMonthDay:ox,Now:R_,PlainTime:mc,TimeZone:lx,PlainYearMonth:cx,ZonedDateTime:hx});const gk=[Do,Af,zd,Nd,ul,ox,mc,lx,cx,hx];for(const n of gk){const e=Object.getOwnPropertyDescriptor(n,"prototype");(e.configurable||e.enumerable||e.writable)&&(e.configurable=!1,e.enumerable=!1,e.writable=!1,Object.defineProperty(n,"prototype",e))}const yk=n=>{let{execute:e,variables:t,singular:c,immediate:a,onComplete:h,onError:d}=n;const[s]=e1(e),[f,b]=We.useState({called:!!a,loading:!!a}),x=We.useRef(t),v=We.useRef([]),g=We.useCallback(()=>{v.current.forEach(S=>S.abort()),v.current=[]},[]),P=We.useCallback(()=>{g(),b(S=>({called:S.called,loading:!1,error:new P2({type:"aborted",message:"Aborted"})}))},[g]),_=We.useCallback(function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};b(y=>!y.called||!y.loading?{called:!0,loading:!0}:y),c&&g();const k=new AbortController;v.current.push(k),x.current={...x.current,...S};const A={variables:x.current,signal:k.signal,onComplete:h,onError:d};return s(A).then(y=>k.signal.aborted?new Promise(()=>{}):(b({called:!0,loading:!1,data:y}),y)).catch(y=>(k.signal.aborted||b({called:!0,loading:!1,error:y}),new Promise(()=>{})))},[g,h,d,c,s]);return We.useEffect(()=>(a&&_(),g),[]),{refetch:_,abort:P,...f}},xk={},Pf=function(n){let{onComplete:e,onError:t,variables:c=xk,lazy:a=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=t1(),[d]=e1(n,{warn:!0,name:"mutation"}),s=We.useCallback(P=>h.mutate(d,P),[h,d]),{refetch:f,called:b,loading:x,error:v,data:g}=yk({execute:s,variables:c,singular:!1,immediate:!a,onComplete:e,onError:t});return[f,{engine:h,called:b,loading:x,error:v,data:g}]},O_=n=>{let{children:e,open:t,dataTest:c}=n;return He.createElement("div",{"data-test":c,className:"jsx-3677374542 "+(ds({open:t})||"")},e,He.createElement(Gt,{id:"3677374542"},["div.jsx-3677374542{height:0;overflow:hidden;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}",".open.jsx-3677374542{height:auto;}"]))};O_.propTypes={children:je.node,dataTest:je.string,open:je.bool};const bk=()=>He.createElement("div",{className:"jsx-2503342345"},He.createElement(Gt,{id:"2503342345"},["div.jsx-2503342345{width:24px;}"])),vk=()=>He.createElement("div",{className:"nodeArrow"},He.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"jsx-4098137027"},He.createElement("path",{d:"M15.7041 10.3329L12.1495 14.3318C12.0699 14.4213 11.9301 14.4213 11.8505 14.3318L8.29589 10.3329C8.18124 10.2039 8.2728 10 8.44537 10H15.5546C15.7272 10 15.8188 10.2039 15.7041 10.3329Z",className:"jsx-4098137027"}),He.createElement(Gt,{id:"4098137027"},["svg.jsx-4098137027{fill:inherit;height:24px;width:24px;vertical-align:middle;pointer-events:none;}"]))),z_=n=>{let{open:e,onOpen:t,onClose:c,dataTest:a}=n;const h=e?c:t;return He.createElement("div",{"data-test":a,onClick:d=>h&&h({open:!e},d),className:Gt.dynamic([["375729792",[Ze.grey400,Ze.grey900,Ze.grey100]]])+" "+(ds({open:e})||"")},He.createElement("span",{className:Gt.dynamic([["375729792",[Ze.grey400,Ze.grey900,Ze.grey100]]])},He.createElement(vk,null)),He.createElement(Gt,{id:"375729792",dynamic:[Ze.grey400,Ze.grey900,Ze.grey100]},["div.__jsx-style-dynamic-selector{width:24px;position:relative;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}",`div.__jsx-style-dynamic-selector:after{background:${Ze.grey400};height:calc(100% - 24px);inset-inline-start:12px;position:absolute;top:15px;width:1px;z-index:1;}`,".open.__jsx-style-dynamic-selector:after{content:'';}",`span.__jsx-style-dynamic-selector{display:block;position:relative;z-index:2;fill:${Ze.grey900};}`,"div.__jsx-style-dynamic-selector .nodeArrow{vertical-align:top;-webkit-transform:rotate(-90deg);-ms-transform:rotate(-90deg);transform:rotate(-90deg);-webkit-transition:-webkit-transform 0.1s ease-out;-webkit-transition:transform 0.1s ease-out;transition:transform 0.1s ease-out;}","div.__jsx-style-dynamic-selector .nodeArrow:dir(rtl){-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg);}",".open.__jsx-style-dynamic-selector .nodeArrow{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}",".open.__jsx-style-dynamic-selector .nodeArrow:dir(rtl){-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}",`div.__jsx-style-dynamic-selector:hover{cursor:pointer;border-radius:3px;background:${Ze.grey100};}`,"div.__jsx-style-dynamic-selector:hover.__jsx-style-dynamic-selector:after{background:#bcc8d4;}"]))};z_.propTypes={dataTest:je.string.isRequired,open:je.bool,onClose:je.func,onOpen:je.func};const N_=n=>{let{open:e,className:t,component:c,children:a,icon:h,onOpen:d,onClose:s,dataTest:f="dhis2-uicore-node"}=n;const b=!!He.Children.toArray(a).filter(g=>g).length,x=!h&&b,v=!h&&!b;return He.createElement("div",{"data-test":f,className:"jsx-1433072554 "+(ds("node",t)||"")},h&&He.createElement("div",{"data-test":`${f}-icon`,className:"jsx-1433072554"},h),x&&He.createElement(z_,{open:e,onOpen:d,onClose:s,dataTest:`${f}-toggle`}),v&&He.createElement(bk,null),He.createElement("div",{"data-test":`${f}-content`,className:"jsx-1433072554"},He.createElement("div",{"data-test":`${f}-label`,className:"jsx-1433072554"},c),He.createElement(O_,{open:e,dataTest:`${f}-leaves`},a)),He.createElement(Gt,{id:"1433072554"},[".node.jsx-1433072554{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}"]))};N_.propTypes={children:je.node,className:je.string,component:je.element,dataTest:je.string,icon:je.node,open:je.bool,onClose:je.func,onOpen:je.func};const j_=(n,e)=>n.some(c=>e===c?!0:c.startsWith(`${e}/`)),_k=(n,e)=>n.replace(new RegExp(`^.*(/${e})`),"$1"),wk=n=>[...n].sort((e,t)=>e.displayName.localeCompare(t.displayName)),Tk={"No children match filter":"","Could not load children":"تعذر تحميل الأبناء","Error: {{ ERRORMESSAGE }}":"خطأ: {{ ERRORMESSAGE }}"},Ek={"No children match filter":"Filtru neodpovídají žádné podřízené","Could not load children":"Nelze načíst podřazené","Error: {{ ERRORMESSAGE }}":"Chyba: {{ ERRORMESSAGE }}"},Ck={"No children match filter":"No children match filter","Could not load children":"Could not load children","Error: {{ ERRORMESSAGE }}":"Error: {{ ERRORMESSAGE }}"},Sk={"No children match filter":"Sin filtros de coincidencia en los elementos inferiores","Could not load children":"No se pudo cargar los elementos inferiores","Error: {{ ERRORMESSAGE }}":"Error: {{ ERRORMESSAGE }}"},kk={"No children match filter":"Ningún descendiente coincide con el filtro","Could not load children":"No se han podido cargar los descendientes","Error: {{ ERRORMESSAGE }}":"Error: {{ ERRORMESSAGE }}"},Mk={"No children match filter":"","Could not load children":"","Error: {{ ERRORMESSAGE }}":"Erreur : {{ ERRORMESSAGE }}"},Ak={"No children match filter":"ບໍ່ພົບເດັກນ້ອຍທີ່ກົງກັບຕົວກອງ","Could not load children":"ບໍ່ສາມາດໂຫຼດເດັກນ້ອຍໄດ້","Error: {{ ERRORMESSAGE }}":"ຂໍ້ຜິດພາດ {{ ERRORMESSAGE }}"},Pk={"No children match filter":"Ingen underenheter matcher filter","Could not load children":"Kunne ikke laste underordnede enheter","Error: {{ ERRORMESSAGE }}":"Feil: {{ ERRORMESSAGE }}"},Ik={"No children match filter":"Er komen geen kinderen overeen met het filter","Could not load children":"Kan kinderen niet laden","Error: {{ ERRORMESSAGE }}":"Fout: {{ ERRORMESSAGE }}"},Dk={"No children match filter":"Nenhum filho corresponde ao filtro","Could not load children":"Não foi possível carregar as crianças","Error: {{ ERRORMESSAGE }}":"Erro: {{ ERRORMESSAGE }}"},Lk={"No children match filter":"Нет дочерних единиц, соответствующих фильтру","Could not load children":"¨Не удалось загрузить дочерние единицы","Error: {{ ERRORMESSAGE }}":"Ошибка: {{ ERRORMESSAGE }}"},Rk={"No children match filter":"Немає дочірніх об'єктів, які відповідають фільтру","Could not load children":"Не вдалося завантажити дочірні об'єкти","Error: {{ ERRORMESSAGE }}":"Помилка: {{ ERRORMESSAGE }}"},Ok={"No children match filter":"","Could not load children":"Bolalar yuklanmadi","Error: {{ ERRORMESSAGE }}":""},zk={"No children match filter":"Фильтрга мос бўлган авлод мавжуд эмас","Could not load children":"Болалар юкланмади","Error: {{ ERRORMESSAGE }}":"Хатолик: {{ ERRORMESSAGE }}"},Nk={"No children match filter":"","Could not load children":"Bolalar yuklanmadi","Error: {{ ERRORMESSAGE }}":""},jk={"No children match filter":"Không có đơn vị con phù hợp với bộ lọc","Could not load children":"Không thể tải đơn vị con","Error: {{ ERRORMESSAGE }}":"Lỗi: {{ ERRORMESSAGE }}"},Bk={"No children match filter":"没有下属匹配过滤器","Could not load children":"无法加载下属","Error: {{ ERRORMESSAGE }}":"错误：{{ ERRORMESSAGE }}"},Fk={"No children match filter":"","Could not load children":"无法加载下属","Error: {{ ERRORMESSAGE }}":""},Qn="default";jt.addResources("ar",Qn,Tk);jt.addResources("cs",Qn,Ek);jt.addResources("en",Qn,Ck);jt.addResources("es",Qn,Sk);jt.addResources("es_419",Qn,kk);jt.addResources("fr",Qn,Mk);jt.addResources("lo",Qn,Ak);jt.addResources("nb",Qn,Pk);jt.addResources("nl",Qn,Ik);jt.addResources("pt",Qn,Dk);jt.addResources("ru",Qn,Lk);jt.addResources("uk",Qn,Rk);jt.addResources("uz_Latn",Qn,Ok);jt.addResources("uz_UZ_Cyrl",Qn,zk);jt.addResources("uz_UZ_Latn",Qn,Nk);jt.addResources("vi",Qn,jk);jt.addResources("zh",Qn,Bk);jt.addResources("zh_CN",Qn,Fk);const Uk="[a-zA-Z][a-zA-Z0-9]{10}",$k=new RegExp(`(/${Uk})+`),Xs=(n,e,t,c,a)=>{if(!$k.test(n[e]))return new Error(`Invalid org unit path \`${n[e]}\` supplied to \`${t}.${a}\``)},B_=n=>{let{children:e,dataTest:t}=n;return He.createElement("span",{"data-test":`${t}-error`,className:Gt.dynamic([["3198585030",[Ze.grey800,_i.dp4,ti.error]]])},e,He.createElement(Gt,{id:"3198585030",dynamic:[Ze.grey800,_i.dp4,ti.error]},[`span.__jsx-style-dynamic-selector{font-size:14px;color:${Ze.grey800};margin:${_i.dp4};color:${ti.error};}`]))};B_.propTypes={children:je.any.isRequired,dataTest:je.string.isRequired};const Gk=(n,e)=>e.some(t=>{const c=!t.match(new RegExp(`${n}$`)),a=t.match(new RegExp(n));return c&&a}),ux=n=>{let{checked:e,children:t,onChange:c,loading:a}=n;return He.createElement("span",{onClick:h=>{c({checked:!e},h)},className:Gt.dynamic([["321503310",[Ze.grey900,Ze.teal700]]])+" "+(ds({checked:e,loading:a})||"")},t,He.createElement(Gt,{id:"321503310",dynamic:[Ze.grey900,Ze.teal700]},[`span.__jsx-style-dynamic-selector{background:transparent;border-radius:3px;color:${Ze.grey900};cursor:pointer;display:inline-block;font-size:14px;line-height:24px;padding:0 5px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;}`,`.checked.__jsx-style-dynamic-selector{background:${Ze.teal700};color:white;}`,".loading.__jsx-style-dynamic-selector{cursor:auto;}"]))};ux.propTypes={children:je.any.isRequired,checked:je.bool,loading:je.bool,onChange:je.func};const F_=n=>{let{children:e,loading:t,onToggleOpen:c}=n;return He.createElement(ux,{checked:!1,loading:t,onChange:c},e)};F_.propTypes={children:je.any.isRequired,onToggleOpen:je.func.isRequired,loading:je.bool};const U_=n=>{let{dataTest:e}=n;return He.createElement("svg",{height:"18px",version:"1.1",viewBox:"0 0 18 18",width:"18px","data-test":`${e}-iconempty`,className:"jsx-3201893673"},He.createElement("g",{fill:"none",fillRule:"evenodd",id:"icon/empty",stroke:"none",strokeWidth:"1",className:"jsx-3201893673"}),He.createElement(Gt,{id:"3201893673"},["svg.jsx-3201893673{display:block;margin:3px 0;}"]))};U_.propTypes={dataTest:je.string.isRequired};const $_=n=>{let{dataTest:e}=n;return He.createElement("svg",{width:"18px",height:"18px",viewBox:"0 0 18 18",version:"1.1","data-test":`${e}-iconfolderclosed`,className:"jsx-3201893673"},He.createElement("g",{id:"icon/folder/closed",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",className:"jsx-3201893673"},He.createElement("path",{d:"M2,3.5 C1.17157288,3.5 0.5,4.17157288 0.5,5 L0.5,13 C0.5,13.8284271 1.17157288,14.5 2,14.5 L12,14.5 C12.8284271,14.5 13.5,13.8284271 13.5,13 L13.5,7 C13.5,6.17157288 12.8284271,5.5 12,5.5 L6.69098301,5.5 L5.82917961,3.7763932 C5.7444836,3.60700119 5.57135204,3.5 5.38196601,3.5 L2,3.5 Z",id:"Path-2",stroke:"#6C7787",fill:"#D5DDE5",className:"jsx-3201893673"})),He.createElement(Gt,{id:"3201893673"},["svg.jsx-3201893673{display:block;margin:3px 0;}"]))};$_.propTypes={dataTest:je.string.isRequired};const G_=n=>{let{dataTest:e}=n;return He.createElement("svg",{width:"18px",height:"18px",viewBox:"0 0 18 18",version:"1.1","data-test":`${e}-iconfolderopen`,className:"jsx-2091325045"},He.createElement("g",{id:"icon/folder/open",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",className:"jsx-2091325045"},He.createElement("g",{id:"Group",transform:"translate(0.000000, 3.000000)",stroke:"#6C7787",className:"jsx-2091325045"},He.createElement("path",{d:"M2,0.5 C1.17157288,0.5 0.5,1.17157288 0.5,2 L0.5,10 C0.5,10.8284271 1.17157288,11.5 2,11.5 L12,11.5 C12.8284271,11.5 13.5,10.8284271 13.5,10 L13.5,4 C13.5,3.17157288 12.8284271,2.5 12,2.5 L6.69098301,2.5 L5.82917961,0.776393202 C5.7444836,0.607001188 5.57135204,0.5 5.38196601,0.5 L2,0.5 Z",id:"Path-2",fill:"#A0ADBA",className:"jsx-2091325045"}),He.createElement("path",{d:"M1.53632259,10.7093809 C1.47575089,10.7941813 1.44318932,10.8957885 1.44318932,11 C1.44318932,11.2761424 1.66704695,11.5 1.94318932,11.5 L12.4853821,11.5 C12.6468577,11.5 12.7983931,11.4220172 12.8922488,11.2906191 L16.4636774,6.2906191 C16.5242491,6.20581872 16.5568107,6.10421149 16.5568107,6 C16.5568107,5.72385763 16.3329531,5.5 16.0568107,5.5 L5.5146179,5.5 C5.35314234,5.5 5.20160692,5.57798284 5.10775116,5.7093809 L1.53632259,10.7093809 Z",id:"Path-3",fill:"#FBFCFD",className:"jsx-2091325045"}))),He.createElement(Gt,{id:"2091325045"},["svg.jsx-2091325045{margin:3px 0;display:block;}"]))};G_.propTypes={dataTest:je.string.isRequired};const V_=n=>{let{dataTest:e}=n;return He.createElement("svg",{height:"18px",version:"1.1",viewBox:"0 0 18 18",width:"18px","data-test":`${e}-iconsingle`,className:"jsx-3201893673"},He.createElement("g",{fill:"none",fillRule:"evenodd",id:"icon/single",stroke:"none",strokeWidth:"1",className:"jsx-3201893673"},He.createElement("rect",{fill:"#A0ADBA",height:"4",id:"Rectangle",rx:"1",width:"4",x:"7",y:"7",className:"jsx-3201893673"})),He.createElement(Gt,{id:"3201893673"},["svg.jsx-3201893673{display:block;margin:3px 0;}"]))};V_.propTypes={dataTest:je.string.isRequired};const H_=n=>{let{loading:e,hasChildren:t,open:c,dataTest:a}=n;return e?He.createElement(U_,{dataTest:a}):t?c?He.createElement(G_,{dataTest:a}):He.createElement($_,{dataTest:a}):He.createElement(V_,{dataTest:a})};H_.propTypes={dataTest:je.string.isRequired,hasChildren:je.bool,loading:je.bool,open:je.bool};const W_=n=>{let{checked:e,dataTest:t,hasChildren:c,indeterminate:a,children:h,loading:d,name:s,open:f,value:b,onChange:x}=n;const v=He.createElement(H_,{loading:d,open:f,hasChildren:c,dataTest:t}),g=He.createElement(He.Fragment,null,He.createElement("span",{className:"jsx-1000763175"},v),h,He.createElement(Gt,{id:"1000763175"},["span.jsx-1000763175{display:inline-block;margin-inline-end:4px;}"]));return He.createElement(He.Fragment,null,He.createElement(Gf,{dense:!0,checked:e,name:s,value:b,label:g,indeterminate:a,onChange:x}))};W_.propTypes={checked:je.bool.isRequired,children:je.any.isRequired,dataTest:je.string.isRequired,hasChildren:je.bool.isRequired,indeterminate:je.bool.isRequired,loading:je.bool.isRequired,name:je.string.isRequired,open:je.bool.isRequired,value:je.string.isRequired,onChange:je.func.isRequired};const cf=n=>{let{highlighted:e,children:t}=n;return He.createElement("div",{className:Gt.dynamic([["1387769986",[Ze.teal200]]])+" "+(ds({highlighted:e})||"")},He.createElement("span",{className:Gt.dynamic([["1387769986",[Ze.teal200]]])},t),He.createElement(Gt,{id:"1387769986",dynamic:[Ze.teal200]},["div.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}","span.__jsx-style-dynamic-selector{display:block;}",`.highlighted.__jsx-style-dynamic-selector{background:${Ze.teal200};padding-inline-end:4px;}`]))};cf.propTypes={children:je.node,highlighted:je.bool};const Vk=n=>{let{selected:e,path:t,checked:c,singleSelection:a}=n;const h=e.indexOf(t);if(c&&h!==-1)return e;if(a&&c)return[t];if(c)return[...e,t];if(h===-1)return e;if(a)return[];if(e.indexOf(t)===0)return e.slice(1);const d=e.slice(0,h),s=e.slice(h+1);return[...d,...s]},Y_=n=>{let{checked:e,children:t,dataTest:c,disableSelection:a,fullPath:h,hasChildren:d,hasSelectedDescendants:s,highlighted:f,loading:b,node:x,onChange:v,onToggleOpen:g,open:P,rootId:_,selected:S,singleSelection:k}=n;const A=(y,I)=>{let{checked:D}=y;const w=Vk({path:h,selected:S,checked:D,singleSelection:k,rootId:_}),M={...x,path:h,checked:D,selected:w};v(M,I)};return a?He.createElement(cf,{highlighted:f},He.createElement(F_,{loading:b,onToggleOpen:g},t)):k?He.createElement(cf,{highlighted:f},He.createElement(ux,{checked:e,onChange:A,loading:b},t)):He.createElement(cf,{highlighted:f},He.createElement(W_,{dataTest:c,checked:e,name:"org-unit",value:x.id,loading:b,indeterminate:!e&&s,onChange:A,open:P,hasChildren:d},t))};Y_.propTypes={children:je.any.isRequired,dataTest:je.string.isRequired,fullPath:je.string.isRequired,hasChildren:je.bool.isRequired,loading:je.bool.isRequired,node:je.shape({displayName:je.string.isRequired,id:je.string.isRequired,children:je.number,path:je.string}).isRequired,open:je.bool.isRequired,rootId:je.string.isRequired,onChange:je.func.isRequired,onToggleOpen:je.func.isRequired,checked:je.bool,disableSelection:je.bool,hasSelectedDescendants:je.bool,highlighted:je.bool,selected:je.arrayOf(Xs),singleSelection:je.bool};const Vb={styles:He.createElement(Gt,{id:"358163430"},[".extrasmall.jsx-358163430{display:block;margin:3px 0;}"]),className:"jsx-358163430"},q_=()=>He.createElement("div",{className:"jsx-2503342345"},He.createElement(Td,{extrasmall:!0,className:Vb.className}),He.createElement("style",null,Vb.styles),He.createElement(Gt,{id:"2503342345"},["div.jsx-2503342345{width:24px;}"])),Hk={orgUnit:{resource:"organisationUnits",id:n=>{let{id:e}=n;return e},params:{fields:"children[id,path,displayName]"}}},Wk=n=>{let{node:e,suppressAlphabeticalSorting:t,onComplete:c}=n;const a=We.useRef(!1),{called:h,loading:d,error:s,data:f}=mo(Hk,{variables:{id:e.id}}),b=We.useMemo(()=>{if(!f)return;if(!e.children)return[];const{orgUnit:x}=f;return t?x.children:wk(x.children)},[f,t]);return We.useEffect(()=>{c&&b&&!a.current&&(c({...e,children:b}),a.current=!0)},[c,b,a]),{called:h,loading:d,error:s||null,data:b}},Yk=n=>{let{orgChildren:e,filter:t,node:c}=n;return t!=null&&t.length?e.filter(a=>j_(t,`${c.path}/${a.id}`)):e},X_=n=>{let{node:e,autoExpandLoadingError:t,dataTest:c,disableSelection:a,expanded:h,filter:d,highlighted:s,isUserDataViewFallback:f,onChange:b,onChildrenLoaded:x,onCollapse:v,onExpand:g,parentPath:P,renderNodeLabel:_,rootId:S,selected:k,singleSelection:A,suppressAlphabeticalSorting:y,OrganisationUnitNode:I}=n;const D=Wk({node:e,isUserDataViewFallback:f,suppressAlphabeticalSorting:y,onComplete:x}),w=D.called&&!D.loading&&!D.error,M=w?Yk({orgChildren:D.data,filter:d,node:e}):[];return He.createElement(He.Fragment,null,D.loading&&He.createElement(q_,null),D.error&&`Error: ${D.error}`,w&&!M.length&&jt.t("No children match filter"),!!M.length&&M.map(z=>{const Y=`${P}/${z.id}`;return He.createElement(I,{autoExpandLoadingError:t,dataTest:c,disableSelection:a,displayName:z.displayName,expanded:h,filter:d,highlighted:s,id:z.id,isUserDataViewFallback:f,key:Y,onChange:b,onChildrenLoaded:x,onCollapse:v,onExpand:g,path:Y,renderNodeLabel:_,rootId:S,selected:k,singleSelection:A,suppressAlphabeticalSorting:y})}))};X_.propTypes={OrganisationUnitNode:je.func.isRequired,dataTest:je.string.isRequired,node:je.object.isRequired,parentPath:je.string.isRequired,renderNodeLabel:je.func.isRequired,rootId:je.string.isRequired,onChange:je.func.isRequired,autoExpandLoadingError:je.bool,disableSelection:je.bool,expanded:je.arrayOf(Xs),filter:je.arrayOf(Xs),highlighted:je.arrayOf(Xs),isUserDataViewFallback:je.bool,selected:je.arrayOf(Xs),singleSelection:je.bool,suppressAlphabeticalSorting:je.bool,onChildrenLoaded:je.func,onCollapse:je.func,onExpand:je.func};const qk=n=>{let{path:e,expanded:t,onExpand:c,onCollapse:a,errorMessage:h,autoExpandLoadingError:d}=n;const s=d&&!!h,[f,b]=We.useState(!!h);We.useEffect(()=>{s&&!f&&(c({path:e}),b(!0))},[s,f]);const x=s&&!f||!!t.includes(e);return{open:x,onToggleOpen:()=>x?a({path:e}):c({path:e}),openedOnceDueToError:f}},Xk={orgUnit:{resource:"organisationUnits",id:n=>{let{id:e}=n;return e},params:n=>{let{isUserDataViewFallback:e}=n;return{isUserDataViewFallback:e,fields:["path","children::size"]}}}},Zk=(n,e)=>{let{displayName:t,isUserDataViewFallback:c}=e;if(!t)throw new Error('"displayName" is required');const a={id:n,isUserDataViewFallback:c},{loading:h,error:d,data:s={}}=mo(Xk,{variables:a});return{loading:h,error:d||null,data:{id:n,displayName:t,...s.orgUnit}}},dx=n=>{let{autoExpandLoadingError:e,dataTest:t,disableSelection:c,displayName:a,expanded:h,highlighted:d,id:s,isUserDataViewFallback:f,path:b,renderNodeLabel:x,rootId:v,selected:g,singleSelection:P,filter:_,suppressAlphabeticalSorting:S,onChange:k,onChildrenLoaded:A,onCollapse:y,onExpand:I}=n;const D=Zk(s,{isUserDataViewFallback:f,displayName:a}),w=_k(b,v),M={displayName:a,id:s,...D.data,path:w},z=!!M.children&&M.children>0,Y=Gk(w,g),X=d.includes(b),{open:Z,onToggleOpen:j}=qk({autoExpandLoadingError:e,errorMessage:D.error&&D.error.toString(),path:w,expanded:h,onExpand:I,onCollapse:y}),V=!!g.find(U=>U.match(new RegExp(`${w}$`))),$=x({disableSelection:c,hasChildren:z,hasSelectedDescendants:Y,loading:D.loading,error:D.error,selected:g,open:Z,path:b,singleSelection:P,node:M,label:a,checked:V,highlighted:X}),R=He.createElement(Y_,{node:M,fullPath:b,open:Z,loading:D.loading,checked:V,rootId:v,onChange:k,dataTest:`${t}-label`,selected:g,hasChildren:z,highlighted:X,onToggleOpen:j,disableSelection:c,singleSelection:P,hasSelectedDescendants:Y},$),L=z&&!Z&&!D.error,G=z&&Z&&!D.error;return He.createElement(N_,{dataTest:`${t}-node`,open:Z,onOpen:j,onClose:j,component:R,icon:D.loading&&He.createElement(q_,null)},D.error&&He.createElement(B_,{dataTest:t},jt.t("Could not load children")),L&&He.createElement("span",{"data-test":`${t}-placeholder`}),G&&He.createElement(X_,{OrganisationUnitNode:dx,node:M,autoExpandLoadingError:e,dataTest:t,disableSelection:c,expanded:h,filter:_,highlighted:d,isUserDataViewFallback:f,onChange:k,onChildrenLoaded:A,onCollapse:y,onExpand:I,parentPath:b,renderNodeLabel:x,rootId:v,selected:g,singleSelection:P,suppressAlphabeticalSorting:S}))};dx.propTypes={dataTest:je.string.isRequired,id:je.string.isRequired,renderNodeLabel:je.func.isRequired,rootId:je.string.isRequired,onChange:je.func.isRequired,autoExpandLoadingError:je.bool,disableSelection:je.bool,displayName:je.string,expanded:je.arrayOf(Xs),filter:je.arrayOf(Xs),highlighted:je.arrayOf(Xs),isUserDataViewFallback:je.bool,path:Xs,selected:je.arrayOf(Xs),singleSelection:je.bool,suppressAlphabeticalSorting:je.bool,onChildrenLoaded:je.func,onCollapse:je.func,onExpand:je.func};const Kk=n=>{let{label:e}=n;return e},Qk=(n,e)=>n!=null&&n.length?e.filter(t=>j_(n,`/${t}`)):e,Z_=n=>{let{dataTest:e="dhis2-uiwidgets-orgunittree-error",error:t}=n;return He.createElement("div",{"data-test":e},jt.t("Error: {{ ERRORMESSAGE }}",{ERRORMESSAGE:t,nsSeparator:">"}))};Z_.propTypes={error:je.string.isRequired,dataTest:je.string};const K_=n=>{let{dataTest:e="dhis2-uiwidgets-orgunittree-loading"}=n;return He.createElement("div",{"data-test":e,className:"jsx-814846266"},He.createElement(Td,{small:!0}),He.createElement(Gt,{id:"814846266"},["div.jsx-814846266{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}"]))};K_.propTypes={dataTest:je.string};const Jk=n=>Array.from(new Set(n)),eM=n=>{const e=n.replace(/^\//,"").split("/"),t=e.map((c,a)=>`/${e.slice(0,a+1).join("/")}`);return Jk(t)},tM=n=>n.reduce((e,t)=>{const c=eM(t);return[...e,...c]},[]),iM=n=>{let{expanded:e,setExpanded:t,onExpand:c,onCollapse:a}=n;return{handleExpand:s=>{let{path:f,...b}=s;e.includes(f)||(t([...e,f]),c&&c({path:f,...b}))},handleCollapse:s=>{let{path:f,...b}=s;const x=e.indexOf(f);if(x!==-1){const v=x===0?e.slice(1):[...e.slice(0,x),...e.slice(x+1)];t(v),a&&a({path:f,...b})}}}},rM=n=>{let{initiallyExpanded:e,onExpand:t,onCollapse:c,expandedControlled:a,handleExpandControlled:h,handleCollapseControlled:d}=n;const s=!!a,f=s?[]:tM(e),[b,x]=We.useState(f);if(s)return{expanded:a,handleExpand:h,handleCollapse:d};const{handleExpand:v,handleCollapse:g}=iM({expanded:b,setExpanded:x,onExpand:t,onCollapse:c});return{expanded:b,handleExpand:v,handleCollapse:g}},nM=n=>{const[e,t]=We.useState(0);return We.useEffect(()=>{const c=e+1;n===!0&&t(c)},[n]),e},sM=n=>{const t=Object.entries(n).map(c=>{let[a,h]=c;const d=h.displayName||"";return[a,{...h,displayName:d}]});return Object.fromEntries(t)},oM=n=>n.reduce((e,t)=>({...e,[t]:{id:t,resource:"organisationUnits",params:c=>{let{isUserDataViewFallback:a}=c;return{isUserDataViewFallback:a,fields:["displayName","path","id"]}}}}),{}),aM=function(n){let{isUserDataViewFallback:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=We.useMemo(()=>oM(n),[n]),a=mo(t,{variables:{isUserDataViewFallback:e}}),{called:h,loading:d,error:s,data:f,refetch:b}=a,x=We.useMemo(()=>f&&sM(f),[f]);return{called:h,loading:d,error:s||null,data:x||null,refetch:b}},Yp=[],Q_=n=>{let{onChange:e,roots:t,autoExpandLoadingError:c,dataTest:a="dhis2-uiwidgets-orgunittree",disableSelection:h,forceReload:d,highlighted:s=Yp,isUserDataViewFallback:f,initiallyExpanded:b=Yp,filter:x=Yp,renderNodeLabel:v=Kk,selected:g=Yp,singleSelection:P,suppressAlphabeticalSorting:_,expanded:S,handleExpand:k,handleCollapse:A,onExpand:y,onCollapse:I,onChildrenLoaded:D}=n;const w=Qk(x,Array.isArray(t)?t:[t]),M=nM(d),[z,Y]=We.useState(M),{called:X,loading:Z,error:j,data:V,refetch:$}=aM(w,{isUserDataViewFallback:f,suppressAlphabeticalSorting:_}),{expanded:R,handleExpand:L,handleCollapse:G}=rM({initiallyExpanded:b,onExpand:y,onCollapse:I,expandedControlled:S,handleExpandControlled:k,handleCollapseControlled:A});We.useEffect(()=>($&&M>0&&M!==z&&($(),Y(M)),()=>console.warn("@TODO: Why does this component unmount after a force reload?")),[M,z,$]);const U=!X||Z;return He.createElement("div",{"data-test":a},U&&He.createElement(K_,null),j&&He.createElement(Z_,{error:j}),!j&&!U&&w.map(F=>{const H=V[F];return He.createElement(dx,{key:H.path,rootId:F,autoExpandLoadingError:c,dataTest:a,disableSelection:h,displayName:H.displayName,expanded:R,highlighted:s,id:F,isUserDataViewFallback:f,filter:x,path:H.path,renderNodeLabel:v,selected:g,singleSelection:P,suppressAlphabeticalSorting:_,onChange:e,onChildrenLoaded:D,onCollapse:G,onExpand:L})}))};Q_.propTypes={roots:je.oneOfType([je.string,je.arrayOf(je.string)]).isRequired,onChange:je.func.isRequired,autoExpandLoadingError:je.bool,dataTest:je.string,disableSelection:je.bool,expanded:Th(n=>!!n.handleExpand||!!n.handleCollapse,je.arrayOf(je.string)),filter:je.arrayOf(Xs),forceReload:je.bool,handleCollapse:Th(n=>!!n.expanded||!!n.handleExpand,je.func),handleExpand:Th(n=>!!n.expanded||!!n.handleCollapse,je.func),highlighted:je.arrayOf(Xs),initiallyExpanded:je.arrayOf(Xs),isUserDataViewFallback:je.bool,renderNodeLabel:je.func,selected:je.arrayOf(Xs),singleSelection:je.bool,suppressAlphabeticalSorting:je.bool,onChildrenLoaded:je.func,onCollapse:je.func,onExpand:je.func};const If=He.forwardRef((n,e)=>{let{icon:t,onClick:c,selected:a,disabled:h,children:d,className:s,dataTest:f="dhis2-uicore-tab"}=n,b=We.useRef(null);e&&(b=e);const[x,v]=We.useState(!1);return We.useEffect(()=>{(()=>{const P=b.current.scrollWidth>b.current.clientWidth;v(P)})()},[]),He.createElement("button",{onClick:h?void 0:g=>c({},g),"data-test":f,ref:b,role:"tab","aria-selected":a?"true":"false","aria-disabled":h?"true":"false",onFocus:h?void 0:g=>c({},g),tabIndex:-1,className:Gt.dynamic([["2433456263",[Ze.grey400,Ze.grey600,ti.focus,Ze.grey600,Ze.grey900,Ze.grey600,Ze.grey800,ti.primary800,ti.primary700,ti.primary700,ti.primary700,Ze.grey500,Ze.grey500]]])+` ${ds("tab",s,{selected:a,disabled:h})}`},t,x?He.createElement(Vf,{content:d,maxWidth:"100%"},He.createElement("span",{ref:b,className:Gt.dynamic([["2433456263",[Ze.grey400,Ze.grey600,ti.focus,Ze.grey600,Ze.grey900,Ze.grey600,Ze.grey800,ti.primary800,ti.primary700,ti.primary700,ti.primary700,Ze.grey500,Ze.grey500]]])},d)):He.createElement("span",{ref:b,className:Gt.dynamic([["2433456263",[Ze.grey400,Ze.grey600,ti.focus,Ze.grey600,Ze.grey900,Ze.grey600,Ze.grey800,ti.primary800,ti.primary700,ti.primary700,ti.primary700,Ze.grey500,Ze.grey500]]])},d),He.createElement(Gt,{id:"2433456263",dynamic:[Ze.grey400,Ze.grey600,ti.focus,Ze.grey600,Ze.grey900,Ze.grey600,Ze.grey800,ti.primary800,ti.primary700,ti.primary700,ti.primary700,Ze.grey500,Ze.grey500]},[`button.__jsx-style-dynamic-selector{-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;position:relative;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;vertical-align:bottom;height:100%;padding:16px 16px 11px;background-color:transparent;outline:none;border:none;border-bottom:1px solid ${Ze.grey400};color:${Ze.grey600};font-size:14px;line-height:20px;cursor:pointer;}`,".fixed>button.__jsx-style-dynamic-selector{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}","button.__jsx-style-dynamic-selector::after{content:' ';display:block;position:absolute;bottom:-1px;inset-inline-start:0;height:4px;width:100%;background-color:transparent;}","span.__jsx-style-dynamic-selector{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;max-width:320px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;-webkit-transition:fill 150ms ease-in-out;transition:fill 150ms ease-in-out;}",`button.__jsx-style-dynamic-selector:focus{outline:3px solid ${ti.focus};outline-offset:-3px;}`,"button.__jsx-style-dynamic-selector:focus.__jsx-style-dynamic-selector:not(:focus-visible){outline:none;}",`button.__jsx-style-dynamic-selector>svg{fill:${Ze.grey600};width:14px;height:14px;margin:0 4px 0 0;}`,`button.__jsx-style-dynamic-selector:hover{color:${Ze.grey900};}`,`button.__jsx-style-dynamic-selector:hover.__jsx-style-dynamic-selector::after{background-color:${Ze.grey600};height:2px;}`,`button.__jsx-style-dynamic-selector:active.__jsx-style-dynamic-selector::after{background-color:${Ze.grey800};}`,`button.selected.__jsx-style-dynamic-selector{color:${ti.primary800};}`,`button.selected.__jsx-style-dynamic-selector::after{background-color:${ti.primary700};-webkit-transition:background-color 150ms ease-in-out;transition:background-color 150ms ease-in-out;}`,`button.selected.__jsx-style-dynamic-selector:hover.__jsx-style-dynamic-selector::after{background-color:${ti.primary700};height:4px;}`,`button.selected.__jsx-style-dynamic-selector>svg{fill:${ti.primary700};}`,`button.disabled.__jsx-style-dynamic-selector{color:${Ze.grey500};cursor:not-allowed;}`,"button.disabled.__jsx-style-dynamic-selector:hover,button.selected.__jsx-style-dynamic-selector:hover{background-color:transparent;}",`button.disabled.__jsx-style-dynamic-selector>svg{fill:${Ze.grey500};}`]))});If.propTypes={children:je.node,className:je.string,dataTest:je.string,disabled:je.bool,icon:je.element,selected:je.bool,onClick:je.func};If.displayName="Tab";const dy=250,lM=.5;function cM(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const c=n.scrollLeft,a=hM(n,c,t),h=a-c,d=uM({scrollBox:n,callback:e,startValue:c,endValue:a,change:h});window.requestAnimationFrame(d)}function hM(n,e,t){const c=n.clientWidth*lM;return Math.floor(e+c*(t?-1:1))}function uM(n){let{scrollBox:e,callback:t,startValue:c,endValue:a,change:h}=n,d,s,f;return function b(x){d||(d=x),s=x-d,f=dM({currentTime:s,DURATION:dy,startValue:c,change:h}),s>=dy?(f!==a&&(e.scrollLeft=a),t&&t()):(e.scrollLeft=f,window.requestAnimationFrame(b))}}function dM(n){let{currentTime:e,startValue:t,change:c}=n;return(e/=dy/2)<1?c/2*e*e+t:-c/2*(--e*(e-2)-1)+t}let qp;const py="__vertical-scrollbar-height-test__",pM=`
    .${py} {
        position: absolute;
        top: -9999px;
        width: 100px;
        height: 100px;
        overflow-x: scroll;
    }
    .${py}::-webkit-scrollbar {
        display: none;
    }
`;function fM(){if(qp)return qp;const n=document.createElement("style");n.innerHTML=pM;const e=document.createElement("div");return e.classList.add(py),document.body.appendChild(n),document.body.appendChild(e),qp=e.offsetHeight-e.clientHeight,document.body.removeChild(n),document.body.removeChild(e),qp}const Df=n=>{let{children:e,disabled:t,hidden:c,onClick:a}=n;return He.createElement("button",{onClick:t?void 0:a,className:Gt.dynamic([["2701682090",[Ze.white,Ze.grey400,Ze.grey600,Ze.grey100,Ze.grey200,Ze.grey500]]])+" "+(ds("scroll-button",{disabled:t,hidden:c})||"")},e,He.createElement(Gt,{id:"2701682090",dynamic:[Ze.white,Ze.grey400,Ze.grey600,Ze.grey100,Ze.grey200,Ze.grey500]},[`.scroll-button.__jsx-style-dynamic-selector{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:inherit;background-color:${Ze.white};border:none;border-bottom:1px solid ${Ze.grey400};outline:none;padding:16px 16px 11px 16px;cursor:pointer;}`,".scroll-button.hidden.__jsx-style-dynamic-selector{display:none;}",`.scroll-button.__jsx-style-dynamic-selector svg{width:20px;height:20px;fill:${Ze.grey600};-webkit-transition:opacity 150ms ease-in-out;transition:opacity 150ms ease-in-out;opacity:1;}`,`.scroll-button.__jsx-style-dynamic-selector:hover{background-color:${Ze.grey100};}`,`.scroll-button.__jsx-style-dynamic-selector:active{background-color:${Ze.grey200};}`,".scroll-button.disabled.__jsx-style-dynamic-selector{cursor:not-allowed;}",".scroll-button.disabled.__jsx-style-dynamic-selector:hover{background-color:transparent;}",`.scroll-button.disabled.__jsx-style-dynamic-selector svg{fill:${Ze.grey500};}`]))};Df.displayName="ScrollButton";Df.propTypes={children:je.any.isRequired,disabled:je.bool,hidden:je.bool,onClick:je.func};function Ea(n,e,t){return(e=mM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mM(n){var e=gM(n,"string");return typeof e=="symbol"?e:e+""}function gM(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var c=t.call(n,e||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class J_ extends We.Component{constructor(e){super(e),Ea(this,"scrollBox",We.createRef()),Ea(this,"scrollArea",We.createRef()),Ea(this,"horizontalScrollBarHeight",fM()),Ea(this,"scrollBoxResizeObserver",null),Ea(this,"calculateShouldHideButtons",()=>{this.setState({hideScrollButtonsInitialized:!1});const{current:t}=this.scrollBox,{current:c}=this.scrollArea,a=c.offsetWidth,h=t.offsetWidth,d=a<=h;this.setState({hideScrollButtons:d}),d||(this.state.scrolledToStart&&this.scrollLeft(),this.state.scrolledToEnd&&this.scrollRight()),this.setState({hideScrollButtonsInitialized:!0})}),Ea(this,"scrollRight",()=>this.scroll()),Ea(this,"scrollLeft",()=>this.scroll(!0)),Ea(this,"animatedScrollCallback",()=>{this.updateScrolledToStates(),this.attachSideScrollListener()}),Ea(this,"updateScrolledToStates",()=>{const{scrollLeft:t,offsetWidth:c}=this.scrollBox.current,{offsetWidth:a}=this.scrollArea.current,h=t<=0,d=t+c>=a;(this.state.scrolledToStart!==h||this.state.scrolledToEnd!==d)&&this.setState({scrolledToStart:h,scrolledToEnd:d})}),this.state={scrolledToStart:!0,scrolledToEnd:!1,hideScrollButtonsInitialized:!1,hideScrollButtons:!1},this.scrollBoxResizeObserver=new ResizeObserver(this.calculateShouldHideButtons)}componentDidMount(){this.scrollSelectedTabIntoView(),this.attachSideScrollListener(),this.manageShouldHideButtons()}componentWillUnmount(){this.removeSideScrollListener(),this.scrollBoxResizeObserver.disconnect()}manageShouldHideButtons(){const{current:e}=this.scrollBox;this.scrollBoxResizeObserver.observe(e),this.calculateShouldHideButtons()}scroll(e){this.removeSideScrollListener(),cM(this.scrollBox.current,this.animatedScrollCallback,e)}scrollSelectedTabIntoView(){const e=this.scrollBox.current,t=e.querySelector(".tab.selected");if(t){const c=t.offsetLeft+t.offsetWidth;c>e.offsetWidth&&(e.scrollLeft=c-e.offsetWidth)}}attachSideScrollListener(){this.scrollBox.current.addEventListener("scroll",this.updateScrolledToStates)}removeSideScrollListener(){this.scrollBox.current.removeEventListener("scroll",this.updateScrolledToStates)}render(){const{scrolledToStart:e,scrolledToEnd:t,hideScrollButtonsInitialized:c,hideScrollButtons:a}=this.state,{children:h,className:d,dataTest:s}=this.props,f=!c||a;return He.createElement("div",{"data-test":s,className:"jsx-191575146 "+Gt.dynamic([["4174900658",[-this.horizontalScrollBarHeight]]])+" "+(ds("scroll-bar",d)||"")},He.createElement(Df,{disabled:e,onClick:this.scrollLeft,hidden:f},He.createElement(a1,null)),He.createElement("div",{className:"jsx-191575146 "+Gt.dynamic([["4174900658",[-this.horizontalScrollBarHeight]]])+" scroll-box-clipper"},He.createElement("div",{ref:this.scrollBox,className:"jsx-191575146 "+Gt.dynamic([["4174900658",[-this.horizontalScrollBarHeight]]])+" scroll-box"},He.createElement("div",{ref:this.scrollArea,className:"jsx-191575146 "+Gt.dynamic([["4174900658",[-this.horizontalScrollBarHeight]]])+" scroll-area"},h))),He.createElement(Df,{disabled:t,onClick:this.scrollRight,hidden:f},He.createElement(l1,null)),He.createElement(Gt,{id:"4174900658",dynamic:[-this.horizontalScrollBarHeight]},[`.scroll-box.__jsx-style-dynamic-selector{margin-bottom:${-this.horizontalScrollBarHeight}px;}`]),He.createElement(Gt,{id:"191575146"},[".scroll-bar.jsx-191575146{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;}",".scroll-box-clipper.jsx-191575146{overflow-y:hidden;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}",".scroll-box.jsx-191575146{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;overflow-x:scroll;-webkit-overflow-scrolling:touch;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}",".scroll-box.jsx-191575146::-webkit-scrollbar{display:none;}",".scroll-area.jsx-191575146{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;overflow-x:hidden;}"]))}}J_.propTypes={children:je.node.isRequired,dataTest:je.string.isRequired,className:je.string};const fy=n=>{let{children:e,fixed:t,dataTest:c}=n;const a=We.useRef(null),h=We.useMemo(()=>He.Children.map(e,()=>He.createRef()),[e]),d=s=>{const f=document.activeElement;if(a.current&&a.current===f){h.length>0&&h[0].current&&h[0].current.focus();return}const b=h.findIndex(x=>x.current===f);if(b!==-1){if(s.key==="ArrowRight"){s.preventDefault();const x=(b+1)%h.length;h[x].current.focus()}if(s.key==="ArrowLeft"){s.preventDefault();const x=(b-1+h.length)%h.length;h[x].current.focus()}}};return He.createElement("div",{ref:a,"data-test":c,role:"tablist",tabIndex:0,onKeyDown:d,className:Gt.dynamic([["771129571",[Ze.grey400,Ze.white]]])+" "+(ds({fixed:t})||"")},He.Children.map(e,(s,f)=>He.isValidElement(s)?He.cloneElement(s,{ref:h[f]}):He.createElement("span",{ref:h[f],tabIndex:-1,className:Gt.dynamic([["771129571",[Ze.grey400,Ze.white]]])},s)),He.createElement(Gt,{id:"771129571",dynamic:[Ze.grey400,Ze.white]},[`div.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;position:relative;overflow:hidden;box-shadow:inset 0 -1px 0 0 ${Ze.grey400};-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;background:${Ze.white};}`]))};fy.propTypes={dataTest:je.string.isRequired,children:je.node,fixed:je.bool};const ew=n=>{let{fixed:e,children:t,className:c,scrollable:a,dataTest:h="dhis2-uicore-tabbar"}=n;return a?He.createElement("div",{className:c,"data-test":h},He.createElement(J_,{dataTest:`${h}-scrollbar`},He.createElement(fy,{fixed:e,dataTest:`${h}-tabs`},t))):He.createElement("div",{className:c,"data-test":h},He.createElement(fy,{fixed:e,dataTest:`${h}-tabs`},t))};ew.propTypes={children:je.node,className:je.string,dataTest:je.string,fixed:je.bool,scrollable:je.bool};var px={};Object.defineProperty(px,"__esModule",{value:!0});px.parse=TM;px.serialize=EM;const yM=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,xM=/^[\u0021-\u003A\u003C-\u007E]*$/,bM=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,vM=/^[\u0020-\u003A\u003D-\u007E]*$/,_M=Object.prototype.toString,wM=(()=>{const n=function(){};return n.prototype=Object.create(null),n})();function TM(n,e){const t=new wM,c=n.length;if(c<2)return t;const a=(e==null?void 0:e.decode)||CM;let h=0;do{const d=n.indexOf("=",h);if(d===-1)break;const s=n.indexOf(";",h),f=s===-1?c:s;if(d>f){h=n.lastIndexOf(";",d-1)+1;continue}const b=Hb(n,h,d),x=Wb(n,d,b),v=n.slice(b,x);if(t[v]===void 0){let g=Hb(n,d+1,f),P=Wb(n,f,g);const _=a(n.slice(g,P));t[v]=_}h=f+1}while(h<c);return t}function Hb(n,e,t){do{const c=n.charCodeAt(e);if(c!==32&&c!==9)return e}while(++e<t);return t}function Wb(n,e,t){for(;e>t;){const c=n.charCodeAt(--e);if(c!==32&&c!==9)return e+1}return t}function EM(n,e,t){const c=(t==null?void 0:t.encode)||encodeURIComponent;if(!yM.test(n))throw new TypeError(`argument name is invalid: ${n}`);const a=c(e);if(!xM.test(a))throw new TypeError(`argument val is invalid: ${e}`);let h=n+"="+a;if(!t)return h;if(t.maxAge!==void 0){if(!Number.isInteger(t.maxAge))throw new TypeError(`option maxAge is invalid: ${t.maxAge}`);h+="; Max-Age="+t.maxAge}if(t.domain){if(!bM.test(t.domain))throw new TypeError(`option domain is invalid: ${t.domain}`);h+="; Domain="+t.domain}if(t.path){if(!vM.test(t.path))throw new TypeError(`option path is invalid: ${t.path}`);h+="; Path="+t.path}if(t.expires){if(!SM(t.expires)||!Number.isFinite(t.expires.valueOf()))throw new TypeError(`option expires is invalid: ${t.expires}`);h+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(h+="; HttpOnly"),t.secure&&(h+="; Secure"),t.partitioned&&(h+="; Partitioned"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():void 0){case"low":h+="; Priority=Low";break;case"medium":h+="; Priority=Medium";break;case"high":h+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${t.priority}`)}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:case"strict":h+="; SameSite=Strict";break;case"lax":h+="; SameSite=Lax";break;case"none":h+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${t.sameSite}`)}return h}function CM(n){if(n.indexOf("%")===-1)return n;try{return decodeURIComponent(n)}catch{return n}}function SM(n){return _M.call(n)==="[object Date]"}/**
 * react-router v7.1.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Yb="popstate";function kM(n={}){function e(a,h){let{pathname:d="/",search:s="",hash:f=""}=za(a.location.hash.substring(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),yd("",{pathname:d,search:s,hash:f},h.state&&h.state.usr||null,h.state&&h.state.key||"default")}function t(a,h){let d=a.document.querySelector("base"),s="";if(d&&d.getAttribute("href")){let f=a.location.href,b=f.indexOf("#");s=b===-1?f:f.slice(0,b)}return s+"#"+(typeof h=="string"?h:vl(h))}function c(a,h){Gn(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(h)})`)}return AM(e,t,c,n)}function yr(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Gn(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function MM(){return Math.random().toString(36).substring(2,10)}function qb(n,e){return{usr:n.state,key:n.key,idx:e}}function yd(n,e,t=null,c){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?za(e):e,state:t,key:e&&e.key||c||MM()}}function vl({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function za(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let c=n.indexOf("?");c>=0&&(e.search=n.substring(c),n=n.substring(0,c)),n&&(e.pathname=n)}return e}function AM(n,e,t,c={}){let{window:a=document.defaultView,v5Compat:h=!1}=c,d=a.history,s="POP",f=null,b=x();b==null&&(b=0,d.replaceState({...d.state,idx:b},""));function x(){return(d.state||{idx:null}).idx}function v(){s="POP";let k=x(),A=k==null?null:k-b;b=k,f&&f({action:s,location:S.location,delta:A})}function g(k,A){s="PUSH";let y=yd(S.location,k,A);t(y,k),b=x()+1;let I=qb(y,b),D=S.createHref(y);try{d.pushState(I,"",D)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;a.location.assign(D)}h&&f&&f({action:s,location:S.location,delta:1})}function P(k,A){s="REPLACE";let y=yd(S.location,k,A);t(y,k),b=x();let I=qb(y,b),D=S.createHref(y);d.replaceState(I,"",D),h&&f&&f({action:s,location:S.location,delta:0})}function _(k){let A=a.location.origin!=="null"?a.location.origin:a.location.href,y=typeof k=="string"?k:vl(k);return y=y.replace(/ $/,"%20"),yr(A,`No window.location.(origin|href) available to create URL for href: ${y}`),new URL(y,A)}let S={get action(){return s},get location(){return n(a,d)},listen(k){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(Yb,v),f=k,()=>{a.removeEventListener(Yb,v),f=null}},createHref(k){return e(a,k)},createURL:_,encodeLocation(k){let A=_(k);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:g,replace:P,go(k){return d.go(k)}};return S}var PM=new Set(["lazy","caseSensitive","path","id","index","children"]);function IM(n){return n.index===!0}function Lf(n,e,t=[],c={}){return n.map((a,h)=>{let d=[...t,String(h)],s=typeof a.id=="string"?a.id:d.join("-");if(yr(a.index!==!0||!a.children,"Cannot specify children on an index route"),yr(!c[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),IM(a)){let f={...a,...e(a),id:s};return c[s]=f,f}else{let f={...a,...e(a),id:s,children:void 0};return c[s]=f,a.children&&(f.children=Lf(a.children,e,d,c)),f}})}function ll(n,e,t="/"){return hf(n,e,t,!1)}function hf(n,e,t,c){let a=typeof e=="string"?za(e):e,h=zo(a.pathname||"/",t);if(h==null)return null;let d=tw(n);LM(d);let s=null;for(let f=0;s==null&&f<d.length;++f){let b=VM(h);s=$M(d[f],b,c)}return s}function DM(n,e){let{route:t,pathname:c,params:a}=n;return{id:t.id,pathname:c,params:a,data:e[t.id],handle:t.handle}}function tw(n,e=[],t=[],c=""){let a=(h,d,s)=>{let f={relativePath:s===void 0?h.path||"":s,caseSensitive:h.caseSensitive===!0,childrenIndex:d,route:h};f.relativePath.startsWith("/")&&(yr(f.relativePath.startsWith(c),`Absolute route path "${f.relativePath}" nested under path "${c}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(c.length));let b=Jo([c,f.relativePath]),x=t.concat(f);h.children&&h.children.length>0&&(yr(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${b}".`),tw(h.children,e,x,b)),!(h.path==null&&!h.index)&&e.push({path:b,score:FM(b,h.index),routesMeta:x})};return n.forEach((h,d)=>{var s;if(h.path===""||!((s=h.path)!=null&&s.includes("?")))a(h,d);else for(let f of iw(h.path))a(h,d,f)}),e}function iw(n){let e=n.split("/");if(e.length===0)return[];let[t,...c]=e,a=t.endsWith("?"),h=t.replace(/\?$/,"");if(c.length===0)return a?[h,""]:[h];let d=iw(c.join("/")),s=[];return s.push(...d.map(f=>f===""?h:[h,f].join("/"))),a&&s.push(...d),s.map(f=>n.startsWith("/")&&f===""?"/":f)}function LM(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:UM(e.routesMeta.map(c=>c.childrenIndex),t.routesMeta.map(c=>c.childrenIndex)))}var RM=/^:[\w-]+$/,OM=3,zM=2,NM=1,jM=10,BM=-2,Xb=n=>n==="*";function FM(n,e){let t=n.split("/"),c=t.length;return t.some(Xb)&&(c+=BM),e&&(c+=zM),t.filter(a=>!Xb(a)).reduce((a,h)=>a+(RM.test(h)?OM:h===""?NM:jM),c)}function UM(n,e){return n.length===e.length&&n.slice(0,-1).every((c,a)=>c===e[a])?n[n.length-1]-e[e.length-1]:0}function $M(n,e,t=!1){let{routesMeta:c}=n,a={},h="/",d=[];for(let s=0;s<c.length;++s){let f=c[s],b=s===c.length-1,x=h==="/"?e:e.slice(h.length)||"/",v=Rf({path:f.relativePath,caseSensitive:f.caseSensitive,end:b},x),g=f.route;if(!v&&b&&t&&!c[c.length-1].route.index&&(v=Rf({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},x)),!v)return null;Object.assign(a,v.params),d.push({params:a,pathname:Jo([h,v.pathname]),pathnameBase:YM(Jo([h,v.pathnameBase])),route:g}),v.pathnameBase!=="/"&&(h=Jo([h,v.pathnameBase]))}return d}function Rf(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,c]=GM(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let h=a[0],d=h.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:c.reduce((b,{paramName:x,isOptional:v},g)=>{if(x==="*"){let _=s[g]||"";d=h.slice(0,h.length-_.length).replace(/(.)\/+$/,"$1")}const P=s[g];return v&&!P?b[x]=void 0:b[x]=(P||"").replace(/%2F/g,"/"),b},{}),pathname:h,pathnameBase:d,pattern:n}}function GM(n,e=!1,t=!0){Gn(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let c=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,s,f)=>(c.push({paramName:s,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(c.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),c]}function VM(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Gn(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function zo(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,c=n.charAt(t);return c&&c!=="/"?null:n.slice(t)||"/"}function HM(n,e="/"){let{pathname:t,search:c="",hash:a=""}=typeof n=="string"?za(n):n;return{pathname:t?t.startsWith("/")?t:WM(t,e):e,search:qM(c),hash:XM(a)}}function WM(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Ag(n,e,t,c){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(c)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rw(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function am(n){let e=rw(n);return e.map((t,c)=>c===e.length-1?t.pathname:t.pathnameBase)}function lm(n,e,t,c=!1){let a;typeof n=="string"?a=za(n):(a={...n},yr(!a.pathname||!a.pathname.includes("?"),Ag("?","pathname","search",a)),yr(!a.pathname||!a.pathname.includes("#"),Ag("#","pathname","hash",a)),yr(!a.search||!a.search.includes("#"),Ag("#","search","hash",a)));let h=n===""||a.pathname==="",d=h?"/":a.pathname,s;if(d==null)s=t;else{let v=e.length-1;if(!c&&d.startsWith("..")){let g=d.split("/");for(;g[0]==="..";)g.shift(),v-=1;a.pathname=g.join("/")}s=v>=0?e[v]:"/"}let f=HM(a,s),b=d&&d!=="/"&&d.endsWith("/"),x=(h||d===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(b||x)&&(f.pathname+="/"),f}var Jo=n=>n.join("/").replace(/\/\/+/g,"/"),YM=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),qM=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,XM=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,Of=class{constructor(n,e,t,c=!1){this.status=n,this.statusText=e||"",this.internal=c,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function cm(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var nw=["POST","PUT","PATCH","DELETE"],ZM=new Set(nw),KM=["GET",...nw],QM=new Set(KM),JM=new Set([301,302,303,307,308]),eA=new Set([307,308]),Pg={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},tA={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Xu={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},fx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,iA=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),sw="remix-router-transitions",ow=Symbol("ResetLoaderData");function rA(n){const e=n.window?n.window:typeof window<"u"?window:void 0,t=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u";yr(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let c=n.mapRouteProperties||iA,a={},h=Lf(n.routes,c,void 0,a),d,s=n.basename||"/",f=n.dataStrategy||lA,b=n.patchRoutesOnNavigation,x={...n.future},v=null,g=new Set,P=null,_=null,S=null,k=n.hydrationData!=null,A=ll(h,n.history.location,s),y=null;if(A==null&&!b){let ht=wo(404,{pathname:n.history.location.pathname}),{matches:xt,route:At}=ov(h);A=xt,y={[At.id]:ht}}A&&!n.hydrationData&&Vi(A,h,n.history.location.pathname).active&&(A=null);let I;if(A)if(A.some(ht=>ht.route.lazy))I=!1;else if(!A.some(ht=>ht.route.loader))I=!0;else{let ht=n.hydrationData?n.hydrationData.loaderData:null,xt=n.hydrationData?n.hydrationData.errors:null;if(xt){let At=A.findIndex(Nt=>xt[Nt.route.id]!==void 0);I=A.slice(0,At+1).every(Nt=>!gy(Nt.route,ht,xt))}else I=A.every(At=>!gy(At.route,ht,xt))}else{I=!1,A=[];let ht=Vi(null,h,n.history.location.pathname);ht.active&&ht.matches&&(A=ht.matches)}let D,w={historyAction:n.history.action,location:n.history.location,matches:A,initialized:I,navigation:Pg,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||y,fetchers:new Map,blockers:new Map},M="POP",z=!1,Y,X=!1,Z=new Map,j=null,V=!1,$=!1,R=new Set,L=new Map,G=0,U=-1,F=new Map,H=new Set,W=new Map,ne=new Map,ue=new Set,ie=new Map,oe,Te=null;function ge(){if(v=n.history.listen(({action:ht,location:xt,delta:At})=>{if(oe){oe(),oe=void 0;return}Gn(ie.size===0||At!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Nt=Ct({currentLocation:w.location,nextLocation:xt,historyAction:ht});if(Nt&&At!=null){let Wt=new Promise(mi=>{oe=mi});n.history.go(At*-1),pt(Nt,{state:"blocked",location:xt,proceed(){pt(Nt,{state:"proceeding",proceed:void 0,reset:void 0,location:xt}),Wt.then(()=>n.history.go(At))},reset(){let mi=new Map(w.blockers);mi.set(Nt,Xu),Q({blockers:mi})}});return}return re(ht,xt)}),t){bA(e,Z);let ht=()=>vA(e,Z);e.addEventListener("pagehide",ht),j=()=>e.removeEventListener("pagehide",ht)}return w.initialized||re("POP",w.location,{initialHydration:!0}),D}function we(){v&&v(),j&&j(),g.clear(),Y&&Y.abort(),w.fetchers.forEach((ht,xt)=>Fe(xt)),w.blockers.forEach((ht,xt)=>Rt(xt))}function K(ht){return g.add(ht),()=>g.delete(ht)}function Q(ht,xt={}){w={...w,...ht};let At=[],Nt=[];w.fetchers.forEach((Wt,mi)=>{Wt.state==="idle"&&(ue.has(mi)?At.push(mi):Nt.push(mi))}),ue.forEach(Wt=>{!w.fetchers.has(Wt)&&!L.has(Wt)&&At.push(Wt)}),[...g].forEach(Wt=>Wt(w,{deletedFetchers:At,viewTransitionOpts:xt.viewTransitionOpts,flushSync:xt.flushSync===!0})),At.forEach(Wt=>Fe(Wt)),Nt.forEach(Wt=>w.fetchers.delete(Wt))}function ae(ht,xt,{flushSync:At}={}){var fe,ke;let Nt=w.actionData!=null&&w.navigation.formMethod!=null&&Lo(w.navigation.formMethod)&&w.navigation.state==="loading"&&((fe=ht.state)==null?void 0:fe._isRedirect)!==!0,Wt;xt.actionData?Object.keys(xt.actionData).length>0?Wt=xt.actionData:Wt=null:Nt?Wt=w.actionData:Wt=null;let mi=xt.loaderData?nv(w.loaderData,xt.loaderData,xt.matches||[],xt.errors):w.loaderData,Di=w.blockers;Di.size>0&&(Di=new Map(Di),Di.forEach((Ne,qe)=>Di.set(qe,Xu)));let hi=z===!0||w.navigation.formMethod!=null&&Lo(w.navigation.formMethod)&&((ke=ht.state)==null?void 0:ke._isRedirect)!==!0;d&&(h=d,d=void 0),V||M==="POP"||(M==="PUSH"?n.history.push(ht,ht.state):M==="REPLACE"&&n.history.replace(ht,ht.state));let $e;if(M==="POP"){let Ne=Z.get(w.location.pathname);Ne&&Ne.has(ht.pathname)?$e={currentLocation:w.location,nextLocation:ht}:Z.has(ht.pathname)&&($e={currentLocation:ht,nextLocation:w.location})}else if(X){let Ne=Z.get(w.location.pathname);Ne?Ne.add(ht.pathname):(Ne=new Set([ht.pathname]),Z.set(w.location.pathname,Ne)),$e={currentLocation:w.location,nextLocation:ht}}Q({...xt,actionData:Wt,loaderData:mi,historyAction:M,location:ht,initialized:!0,navigation:Pg,revalidation:"idle",restoreScrollPosition:Ji(ht,xt.matches||w.matches),preventScrollReset:hi,blockers:Di},{viewTransitionOpts:$e,flushSync:At===!0}),M="POP",z=!1,X=!1,V=!1,$=!1,Te==null||Te.resolve(),Te=null}async function ye(ht,xt){if(typeof ht=="number"){n.history.go(ht);return}let At=my(w.location,w.matches,s,ht,xt==null?void 0:xt.fromRouteId,xt==null?void 0:xt.relative),{path:Nt,submission:Wt,error:mi}=Zb(!1,At,xt),Di=w.location,hi=yd(w.location,Nt,xt&&xt.state);hi={...hi,...n.history.encodeLocation(hi)};let $e=xt&&xt.replace!=null?xt.replace:void 0,fe="PUSH";$e===!0?fe="REPLACE":$e===!1||Wt!=null&&Lo(Wt.formMethod)&&Wt.formAction===w.location.pathname+w.location.search&&(fe="REPLACE");let ke=xt&&"preventScrollReset"in xt?xt.preventScrollReset===!0:void 0,Ne=(xt&&xt.flushSync)===!0,qe=Ct({currentLocation:Di,nextLocation:hi,historyAction:fe});if(qe){pt(qe,{state:"blocked",location:hi,proceed(){pt(qe,{state:"proceeding",proceed:void 0,reset:void 0,location:hi}),ye(ht,xt)},reset(){let it=new Map(w.blockers);it.set(qe,Xu),Q({blockers:it})}});return}await re(fe,hi,{submission:Wt,pendingError:mi,preventScrollReset:ke,replace:xt&&xt.replace,enableViewTransition:xt&&xt.viewTransition,flushSync:Ne})}function J(){Te||(Te=_A()),Ee(),Q({revalidation:"loading"});let ht=Te.promise;return w.navigation.state==="submitting"?ht:w.navigation.state==="idle"?(re(w.historyAction,w.location,{startUninterruptedRevalidation:!0}),ht):(re(M||w.historyAction,w.navigation.location,{overrideNavigation:w.navigation,enableViewTransition:X===!0}),ht)}async function re(ht,xt,At){Y&&Y.abort(),Y=null,M=ht,V=(At&&At.startUninterruptedRevalidation)===!0,Vt(w.location,w.matches),z=(At&&At.preventScrollReset)===!0,X=(At&&At.enableViewTransition)===!0;let Nt=d||h,Wt=At&&At.overrideNavigation,mi=ll(Nt,xt,s),Di=(At&&At.flushSync)===!0,hi=Vi(mi,Nt,xt.pathname);if(hi.active&&hi.matches&&(mi=hi.matches),!mi){let{error:lt,notFoundMatches:st,route:tt}=Et(xt.pathname);ae(xt,{matches:st,loaderData:{},errors:{[tt.id]:lt}},{flushSync:Di});return}if(w.initialized&&!$&&fA(w.location,xt)&&!(At&&At.submission&&Lo(At.submission.formMethod))){ae(xt,{matches:mi},{flushSync:Di});return}Y=new AbortController;let $e=gh(n.history,xt,Y.signal,At&&At.submission),fe;if(At&&At.pendingError)fe=[ac(mi).route.id,{type:"error",error:At.pendingError}];else if(At&&At.submission&&Lo(At.submission.formMethod)){let lt=await ce($e,xt,At.submission,mi,hi.active,{replace:At.replace,flushSync:Di});if(lt.shortCircuited)return;if(lt.pendingActionResult){let[st,tt]=lt.pendingActionResult;if(ao(tt)&&cm(tt.error)&&tt.error.status===404){Y=null,ae(xt,{matches:lt.matches,loaderData:{},errors:{[st]:tt.error}});return}}mi=lt.matches||mi,fe=lt.pendingActionResult,Wt=Ig(xt,At.submission),Di=!1,hi.active=!1,$e=gh(n.history,$e.url,$e.signal)}let{shortCircuited:ke,matches:Ne,loaderData:qe,errors:it}=await pe($e,xt,mi,hi.active,Wt,At&&At.submission,At&&At.fetcherSubmission,At&&At.replace,At&&At.initialHydration===!0,Di,fe);ke||(Y=null,ae(xt,{matches:Ne||mi,...sv(fe),loaderData:qe,errors:it}))}async function ce(ht,xt,At,Nt,Wt,mi={}){Ee();let Di=yA(xt,At);if(Q({navigation:Di},{flushSync:mi.flushSync===!0}),Wt){let fe=await ar(Nt,xt.pathname,ht.signal);if(fe.type==="aborted")return{shortCircuited:!0};if(fe.type==="error"){let ke=ac(fe.partialMatches).route.id;return{matches:fe.partialMatches,pendingActionResult:[ke,{type:"error",error:fe.error}]}}else if(fe.matches)Nt=fe.matches;else{let{notFoundMatches:ke,error:Ne,route:qe}=Et(xt.pathname);return{matches:ke,pendingActionResult:[qe.id,{type:"error",error:Ne}]}}}let hi,$e=rd(Nt,xt);if(!$e.route.action&&!$e.route.lazy)hi={type:"error",error:wo(405,{method:ht.method,pathname:xt.pathname,routeId:$e.route.id})};else if(hi=(await Xe("action",w,ht,[$e],Nt,null))[$e.route.id],ht.signal.aborted)return{shortCircuited:!0};if(cc(hi)){let fe;return mi&&mi.replace!=null?fe=mi.replace:fe=tv(hi.response.headers.get("Location"),new URL(ht.url),s)===w.location.pathname+w.location.search,await Ue(ht,hi,!0,{submission:At,replace:fe}),{shortCircuited:!0}}if(ao(hi)){let fe=ac(Nt,$e.route.id);return(mi&&mi.replace)!==!0&&(M="PUSH"),{matches:Nt,pendingActionResult:[fe.route.id,hi]}}return{matches:Nt,pendingActionResult:[$e.route.id,hi]}}async function pe(ht,xt,At,Nt,Wt,mi,Di,hi,$e,fe,ke){let Ne=Wt||Ig(xt,mi),qe=mi||Di||lv(Ne),it=!V&&!$e;if(Nt){if(it){let Si=xe(ke);Q({navigation:Ne,...Si!==void 0?{actionData:Si}:{}},{flushSync:fe})}let yi=await ar(At,xt.pathname,ht.signal);if(yi.type==="aborted")return{shortCircuited:!0};if(yi.type==="error"){let Si=ac(yi.partialMatches).route.id;return{matches:yi.partialMatches,loaderData:{},errors:{[Si]:yi.error}}}else if(yi.matches)At=yi.matches;else{let{error:Si,notFoundMatches:Ni,route:Li}=Et(xt.pathname);return{matches:Ni,loaderData:{},errors:{[Li.id]:Si}}}}let lt=d||h,[st,tt]=Qb(n.history,w,At,qe,xt,$e===!0,$,R,ue,W,H,lt,s,ke);if(U=++G,st.length===0&&tt.length===0){let yi=ut();return ae(xt,{matches:At,loaderData:{},errors:ke&&ao(ke[1])?{[ke[0]]:ke[1].error}:null,...sv(ke),...yi?{fetchers:new Map(w.fetchers)}:{}},{flushSync:fe}),{shortCircuited:!0}}if(it){let yi={};if(!Nt){yi.navigation=Ne;let Si=xe(ke);Si!==void 0&&(yi.actionData=Si)}tt.length>0&&(yi.fetchers=Me(tt)),Q(yi,{flushSync:fe})}tt.forEach(yi=>{rt(yi.key),yi.controller&&L.set(yi.key,yi.controller)});let ft=()=>tt.forEach(yi=>rt(yi.key));Y&&Y.signal.addEventListener("abort",ft);let{loaderResults:St,fetcherResults:Lt}=await Pe(w,At,st,tt,ht);if(ht.signal.aborted)return{shortCircuited:!0};Y&&Y.signal.removeEventListener("abort",ft),tt.forEach(yi=>L.delete(yi.key));let It=Xp(St);if(It)return await Ue(ht,It.result,!0,{replace:hi}),{shortCircuited:!0};if(It=Xp(Lt),It)return H.add(It.key),await Ue(ht,It.result,!0,{replace:hi}),{shortCircuited:!0};let{loaderData:si,errors:Zt}=rv(w,At,St,ke,tt,Lt);$e&&w.errors&&(Zt={...w.errors,...Zt});let ui=ut(),gi=mt(U),zi=ui||gi||tt.length>0;return{matches:At,loaderData:si,errors:Zt,...zi?{fetchers:new Map(w.fetchers)}:{}}}function xe(ht){if(ht&&!ao(ht[1]))return{[ht[0]]:ht[1].data};if(w.actionData)return Object.keys(w.actionData).length===0?null:w.actionData}function Me(ht){return ht.forEach(xt=>{let At=w.fetchers.get(xt.key),Nt=Zu(void 0,At?At.data:void 0);w.fetchers.set(xt.key,Nt)}),new Map(w.fetchers)}async function _e(ht,xt,At,Nt){rt(ht);let Wt=(Nt&&Nt.flushSync)===!0,mi=d||h,Di=my(w.location,w.matches,s,At,xt,Nt==null?void 0:Nt.relative),hi=ll(mi,Di,s),$e=Vi(hi,mi,Di);if($e.active&&$e.matches&&(hi=$e.matches),!hi){Oe(ht,xt,wo(404,{pathname:Di}),{flushSync:Wt});return}let{path:fe,submission:ke,error:Ne}=Zb(!0,Di,Nt);if(Ne){Oe(ht,xt,Ne,{flushSync:Wt});return}let qe=rd(hi,fe),it=(Nt&&Nt.preventScrollReset)===!0;if(ke&&Lo(ke.formMethod)){await Ce(ht,xt,fe,qe,hi,$e.active,Wt,it,ke);return}W.set(ht,{routeId:xt,path:fe}),await Le(ht,xt,fe,qe,hi,$e.active,Wt,it,ke)}async function Ce(ht,xt,At,Nt,Wt,mi,Di,hi,$e){Ee(),W.delete(ht);function fe(rr){if(!rr.route.action&&!rr.route.lazy){let Ar=wo(405,{method:$e.formMethod,pathname:At,routeId:xt});return Oe(ht,xt,Ar,{flushSync:Di}),!0}return!1}if(!mi&&fe(Nt))return;let ke=w.fetchers.get(ht);Ie(ht,xA($e,ke),{flushSync:Di});let Ne=new AbortController,qe=gh(n.history,At,Ne.signal,$e);if(mi){let rr=await ar(Wt,At,qe.signal);if(rr.type==="aborted")return;if(rr.type==="error"){Oe(ht,xt,rr.error,{flushSync:Di});return}else if(rr.matches){if(Wt=rr.matches,Nt=rd(Wt,At),fe(Nt))return}else{Oe(ht,xt,wo(404,{pathname:At}),{flushSync:Di});return}}L.set(ht,Ne);let it=G,st=(await Xe("action",w,qe,[Nt],Wt,ht))[Nt.route.id];if(qe.signal.aborted){L.get(ht)===Ne&&L.delete(ht);return}if(ue.has(ht)){if(cc(st)||ao(st)){Ie(ht,rl(void 0));return}}else{if(cc(st))if(L.delete(ht),U>it){Ie(ht,rl(void 0));return}else return H.add(ht),Ie(ht,Zu($e)),Ue(qe,st,!1,{fetcherSubmission:$e,preventScrollReset:hi});if(ao(st)){Oe(ht,xt,st.error);return}}let tt=w.navigation.location||w.location,ft=gh(n.history,tt,Ne.signal),St=d||h,Lt=w.navigation.state!=="idle"?ll(St,w.navigation.location,s):w.matches;yr(Lt,"Didn't find any matches after fetcher action");let It=++G;F.set(ht,It);let si=Zu($e,st.data);w.fetchers.set(ht,si);let[Zt,ui]=Qb(n.history,w,Lt,$e,tt,!1,$,R,ue,W,H,St,s,[Nt.route.id,st]);ui.filter(rr=>rr.key!==ht).forEach(rr=>{let Ar=rr.key,Jr=w.fetchers.get(Ar),_n=Zu(void 0,Jr?Jr.data:void 0);w.fetchers.set(Ar,_n),rt(Ar),rr.controller&&L.set(Ar,rr.controller)}),Q({fetchers:new Map(w.fetchers)});let gi=()=>ui.forEach(rr=>rt(rr.key));Ne.signal.addEventListener("abort",gi);let{loaderResults:zi,fetcherResults:yi}=await Pe(w,Lt,Zt,ui,ft);if(Ne.signal.aborted)return;Ne.signal.removeEventListener("abort",gi),F.delete(ht),L.delete(ht),ui.forEach(rr=>L.delete(rr.key));let Si=Xp(zi);if(Si)return Ue(ft,Si.result,!1,{preventScrollReset:hi});if(Si=Xp(yi),Si)return H.add(Si.key),Ue(ft,Si.result,!1,{preventScrollReset:hi});let{loaderData:Ni,errors:Li}=rv(w,Lt,zi,void 0,ui,yi);if(w.fetchers.has(ht)){let rr=rl(st.data);w.fetchers.set(ht,rr)}mt(It),w.navigation.state==="loading"&&It>U?(yr(M,"Expected pending action"),Y&&Y.abort(),ae(w.navigation.location,{matches:Lt,loaderData:Ni,errors:Li,fetchers:new Map(w.fetchers)})):(Q({errors:Li,loaderData:nv(w.loaderData,Ni,Lt,Li),fetchers:new Map(w.fetchers)}),$=!1)}async function Le(ht,xt,At,Nt,Wt,mi,Di,hi,$e){let fe=w.fetchers.get(ht);Ie(ht,Zu($e,fe?fe.data:void 0),{flushSync:Di});let ke=new AbortController,Ne=gh(n.history,At,ke.signal);if(mi){let st=await ar(Wt,At,Ne.signal);if(st.type==="aborted")return;if(st.type==="error"){Oe(ht,xt,st.error,{flushSync:Di});return}else if(st.matches)Wt=st.matches,Nt=rd(Wt,At);else{Oe(ht,xt,wo(404,{pathname:At}),{flushSync:Di});return}}L.set(ht,ke);let qe=G,lt=(await Xe("loader",w,Ne,[Nt],Wt,ht))[Nt.route.id];if(L.get(ht)===ke&&L.delete(ht),!Ne.signal.aborted){if(ue.has(ht)){Ie(ht,rl(void 0));return}if(cc(lt))if(U>qe){Ie(ht,rl(void 0));return}else{H.add(ht),await Ue(Ne,lt,!1,{preventScrollReset:hi});return}if(ao(lt)){Oe(ht,xt,lt.error);return}Ie(ht,rl(lt.data))}}async function Ue(ht,xt,At,{submission:Nt,fetcherSubmission:Wt,preventScrollReset:mi,replace:Di}={}){xt.response.headers.has("X-Remix-Revalidate")&&($=!0);let hi=xt.response.headers.get("Location");yr(hi,"Expected a Location header on the redirect Response"),hi=tv(hi,new URL(ht.url),s);let $e=yd(w.location,hi,{_isRedirect:!0});if(t){let lt=!1;if(xt.response.headers.has("X-Remix-Reload-Document"))lt=!0;else if(fx.test(hi)){const st=n.history.createURL(hi);lt=st.origin!==e.location.origin||zo(st.pathname,s)==null}if(lt){Di?e.location.replace(hi):e.location.assign(hi);return}}Y=null;let fe=Di===!0||xt.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:ke,formAction:Ne,formEncType:qe}=w.navigation;!Nt&&!Wt&&ke&&Ne&&qe&&(Nt=lv(w.navigation));let it=Nt||Wt;if(eA.has(xt.response.status)&&it&&Lo(it.formMethod))await re(fe,$e,{submission:{...it,formAction:hi},preventScrollReset:mi||z,enableViewTransition:At?X:void 0});else{let lt=Ig($e,Nt);await re(fe,$e,{overrideNavigation:lt,fetcherSubmission:Wt,preventScrollReset:mi||z,enableViewTransition:At?X:void 0})}}async function Xe(ht,xt,At,Nt,Wt,mi){let Di,hi={};try{Di=await cA(f,ht,xt,At,Nt,Wt,mi,a,c)}catch($e){return Nt.forEach(fe=>{hi[fe.route.id]={type:"error",error:$e}}),hi}for(let[$e,fe]of Object.entries(Di))if(mA(fe)){let ke=fe.result;hi[$e]={type:"redirect",response:dA(ke,At,$e,Wt,s)}}else hi[$e]=await uA(fe);return hi}async function Pe(ht,xt,At,Nt,Wt){let mi=Xe("loader",ht,Wt,At,xt,null),Di=Promise.all(Nt.map(async fe=>{if(fe.matches&&fe.match&&fe.controller){let Ne=(await Xe("loader",ht,gh(n.history,fe.path,fe.controller.signal),[fe.match],fe.matches,fe.key))[fe.match.route.id];return{[fe.key]:Ne}}else return Promise.resolve({[fe.key]:{type:"error",error:wo(404,{pathname:fe.path})}})})),hi=await mi,$e=(await Di).reduce((fe,ke)=>Object.assign(fe,ke),{});return{loaderResults:hi,fetcherResults:$e}}function Ee(){$=!0,W.forEach((ht,xt)=>{L.has(xt)&&R.add(xt),rt(xt)})}function Ie(ht,xt,At={}){w.fetchers.set(ht,xt),Q({fetchers:new Map(w.fetchers)},{flushSync:(At&&At.flushSync)===!0})}function Oe(ht,xt,At,Nt={}){let Wt=ac(w.matches,xt);Fe(ht),Q({errors:{[Wt.route.id]:At},fetchers:new Map(w.fetchers)},{flushSync:(Nt&&Nt.flushSync)===!0})}function Re(ht){return ne.set(ht,(ne.get(ht)||0)+1),ue.has(ht)&&ue.delete(ht),w.fetchers.get(ht)||tA}function Fe(ht){let xt=w.fetchers.get(ht);L.has(ht)&&!(xt&&xt.state==="loading"&&F.has(ht))&&rt(ht),W.delete(ht),F.delete(ht),H.delete(ht),ue.delete(ht),R.delete(ht),w.fetchers.delete(ht)}function Ke(ht){let xt=(ne.get(ht)||0)-1;xt<=0?(ne.delete(ht),ue.add(ht)):ne.set(ht,xt),Q({fetchers:new Map(w.fetchers)})}function rt(ht){let xt=L.get(ht);xt&&(xt.abort(),L.delete(ht))}function at(ht){for(let xt of ht){let At=Re(xt),Nt=rl(At.data);w.fetchers.set(xt,Nt)}}function ut(){let ht=[],xt=!1;for(let At of H){let Nt=w.fetchers.get(At);yr(Nt,`Expected fetcher: ${At}`),Nt.state==="loading"&&(H.delete(At),ht.push(At),xt=!0)}return at(ht),xt}function mt(ht){let xt=[];for(let[At,Nt]of F)if(Nt<ht){let Wt=w.fetchers.get(At);yr(Wt,`Expected fetcher: ${At}`),Wt.state==="loading"&&(rt(At),F.delete(At),xt.push(At))}return at(xt),xt.length>0}function Tt(ht,xt){let At=w.blockers.get(ht)||Xu;return ie.get(ht)!==xt&&ie.set(ht,xt),At}function Rt(ht){w.blockers.delete(ht),ie.delete(ht)}function pt(ht,xt){let At=w.blockers.get(ht)||Xu;yr(At.state==="unblocked"&&xt.state==="blocked"||At.state==="blocked"&&xt.state==="blocked"||At.state==="blocked"&&xt.state==="proceeding"||At.state==="blocked"&&xt.state==="unblocked"||At.state==="proceeding"&&xt.state==="unblocked",`Invalid blocker state transition: ${At.state} -> ${xt.state}`);let Nt=new Map(w.blockers);Nt.set(ht,xt),Q({blockers:Nt})}function Ct({currentLocation:ht,nextLocation:xt,historyAction:At}){if(ie.size===0)return;ie.size>1&&Gn(!1,"A router only supports one blocker at a time");let Nt=Array.from(ie.entries()),[Wt,mi]=Nt[Nt.length-1],Di=w.blockers.get(Wt);if(!(Di&&Di.state==="proceeding")&&mi({currentLocation:ht,nextLocation:xt,historyAction:At}))return Wt}function Et(ht){let xt=wo(404,{pathname:ht}),At=d||h,{matches:Nt,route:Wt}=ov(At);return{notFoundMatches:Nt,route:Wt,error:xt}}function ri(ht,xt,At){if(P=ht,S=xt,_=At||null,!k&&w.navigation===Pg){k=!0;let Nt=Ji(w.location,w.matches);Nt!=null&&Q({restoreScrollPosition:Nt})}return()=>{P=null,S=null,_=null}}function ci(ht,xt){return _&&_(ht,xt.map(Nt=>DM(Nt,w.loaderData)))||ht.key}function Vt(ht,xt){if(P&&S){let At=ci(ht,xt);P[At]=S()}}function Ji(ht,xt){if(P){let At=ci(ht,xt),Nt=P[At];if(typeof Nt=="number")return Nt}return null}function Vi(ht,xt,At){if(b)if(ht){if(Object.keys(ht[0].params).length>0)return{active:!0,matches:hf(xt,At,s,!0)}}else return{active:!0,matches:hf(xt,At,s,!0)||[]};return{active:!1,matches:null}}async function ar(ht,xt,At){if(!b)return{type:"success",matches:ht};let Nt=ht;for(;;){let Wt=d==null,mi=d||h,Di=a;try{await b({path:xt,matches:Nt,patch:(fe,ke)=>{At.aborted||ev(fe,ke,mi,Di,c)}})}catch(fe){return{type:"error",error:fe,partialMatches:Nt}}finally{Wt&&!At.aborted&&(h=[...h])}if(At.aborted)return{type:"aborted"};let hi=ll(mi,xt,s);if(hi)return{type:"success",matches:hi};let $e=hf(mi,xt,s,!0);if(!$e||Nt.length===$e.length&&Nt.every((fe,ke)=>fe.route.id===$e[ke].route.id))return{type:"success",matches:null};Nt=$e}}function Tr(ht){a={},d=Lf(ht,c,void 0,a)}function Xi(ht,xt){let At=d==null;ev(ht,xt,d||h,a,c),At&&(h=[...h],Q({}))}return D={get basename(){return s},get future(){return x},get state(){return w},get routes(){return h},get window(){return e},initialize:ge,subscribe:K,enableScrollRestoration:ri,navigate:ye,fetch:_e,revalidate:J,createHref:ht=>n.history.createHref(ht),encodeLocation:ht=>n.history.encodeLocation(ht),getFetcher:Re,deleteFetcher:Ke,dispose:we,getBlocker:Tt,deleteBlocker:Rt,patchRoutes:Xi,_internalFetchControllers:L,_internalSetRoutes:Tr},D}function nA(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function my(n,e,t,c,a,h){let d,s;if(a){d=[];for(let b of e)if(d.push(b),b.route.id===a){s=b;break}}else d=e,s=e[e.length-1];let f=lm(c||".",am(d),zo(n.pathname,t)||n.pathname,h==="path");if(c==null&&(f.search=n.search,f.hash=n.hash),(c==null||c===""||c===".")&&s){let b=mx(f.search);if(s.route.index&&!b)f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&b){let x=new URLSearchParams(f.search),v=x.getAll("index");x.delete("index"),v.filter(P=>P).forEach(P=>x.append("index",P));let g=x.toString();f.search=g?`?${g}`:""}}return t!=="/"&&(f.pathname=f.pathname==="/"?t:Jo([t,f.pathname])),vl(f)}function Zb(n,e,t){if(!t||!nA(t))return{path:e};if(t.formMethod&&!gA(t.formMethod))return{path:e,error:wo(405,{method:t.formMethod})};let c=()=>({path:e,error:wo(400,{type:"invalid-body"})}),h=(t.formMethod||"get").toUpperCase(),d=lw(e);if(t.body!==void 0){if(t.formEncType==="text/plain"){if(!Lo(h))return c();let v=typeof t.body=="string"?t.body:t.body instanceof FormData||t.body instanceof URLSearchParams?Array.from(t.body.entries()).reduce((g,[P,_])=>`${g}${P}=${_}
`,""):String(t.body);return{path:e,submission:{formMethod:h,formAction:d,formEncType:t.formEncType,formData:void 0,json:void 0,text:v}}}else if(t.formEncType==="application/json"){if(!Lo(h))return c();try{let v=typeof t.body=="string"?JSON.parse(t.body):t.body;return{path:e,submission:{formMethod:h,formAction:d,formEncType:t.formEncType,formData:void 0,json:v,text:void 0}}}catch{return c()}}}yr(typeof FormData=="function","FormData is not available in this environment");let s,f;if(t.formData)s=yy(t.formData),f=t.formData;else if(t.body instanceof FormData)s=yy(t.body),f=t.body;else if(t.body instanceof URLSearchParams)s=t.body,f=iv(s);else if(t.body==null)s=new URLSearchParams,f=new FormData;else try{s=new URLSearchParams(t.body),f=iv(s)}catch{return c()}let b={formMethod:h,formAction:d,formEncType:t&&t.formEncType||"application/x-www-form-urlencoded",formData:f,json:void 0,text:void 0};if(Lo(b.formMethod))return{path:e,submission:b};let x=za(e);return n&&x.search&&mx(x.search)&&s.append("index",""),x.search=`?${s}`,{path:vl(x),submission:b}}function Kb(n,e,t=!1){let c=n.findIndex(a=>a.route.id===e);return c>=0?n.slice(0,t?c+1:c):n}function Qb(n,e,t,c,a,h,d,s,f,b,x,v,g,P){let _=P?ao(P[1])?P[1].error:P[1].data:void 0,S=n.createURL(e.location),k=n.createURL(a),A=t;h&&e.errors?A=Kb(t,Object.keys(e.errors)[0],!0):P&&ao(P[1])&&(A=Kb(t,P[0]));let y=P?P[1].statusCode:void 0,I=y&&y>=400,D=A.filter((M,z)=>{let{route:Y}=M;if(Y.lazy)return!0;if(Y.loader==null)return!1;if(h)return gy(Y,e.loaderData,e.errors);if(sA(e.loaderData,e.matches[z],M))return!0;let X=e.matches[z],Z=M;return Jb(M,{currentUrl:S,currentParams:X.params,nextUrl:k,nextParams:Z.params,...c,actionResult:_,actionStatus:y,defaultShouldRevalidate:I?!1:d||S.pathname+S.search===k.pathname+k.search||S.search!==k.search||oA(X,Z)})}),w=[];return b.forEach((M,z)=>{if(h||!t.some(V=>V.route.id===M.routeId)||f.has(z))return;let Y=ll(v,M.path,g);if(!Y){w.push({key:z,routeId:M.routeId,path:M.path,matches:null,match:null,controller:null});return}let X=e.fetchers.get(z),Z=rd(Y,M.path),j=!1;x.has(z)?j=!1:s.has(z)?(s.delete(z),j=!0):X&&X.state!=="idle"&&X.data===void 0?j=d:j=Jb(Z,{currentUrl:S,currentParams:e.matches[e.matches.length-1].params,nextUrl:k,nextParams:t[t.length-1].params,...c,actionResult:_,actionStatus:y,defaultShouldRevalidate:I?!1:d}),j&&w.push({key:z,routeId:M.routeId,path:M.path,matches:Y,match:Z,controller:new AbortController})}),[D,w]}function gy(n,e,t){if(n.lazy)return!0;if(!n.loader)return!1;let c=e!=null&&e[n.id]!==void 0,a=t!=null&&t[n.id]!==void 0;return!c&&a?!1:typeof n.loader=="function"&&n.loader.hydrate===!0?!0:!c&&!a}function sA(n,e,t){let c=!e||t.route.id!==e.route.id,a=!n.hasOwnProperty(t.route.id);return c||a}function oA(n,e){let t=n.route.path;return n.pathname!==e.pathname||t!=null&&t.endsWith("*")&&n.params["*"]!==e.params["*"]}function Jb(n,e){if(n.route.shouldRevalidate){let t=n.route.shouldRevalidate(e);if(typeof t=="boolean")return t}return e.defaultShouldRevalidate}function ev(n,e,t,c,a){let h;if(n){let f=c[n];yr(f,`No route found to patch children into: routeId = ${n}`),f.children||(f.children=[]),h=f.children}else h=t;let d=e.filter(f=>!h.some(b=>aw(f,b))),s=Lf(d,a,[n||"_","patch",String((h==null?void 0:h.length)||"0")],c);h.push(...s)}function aw(n,e){return"id"in n&&"id"in e&&n.id===e.id?!0:n.index===e.index&&n.path===e.path&&n.caseSensitive===e.caseSensitive?(!n.children||n.children.length===0)&&(!e.children||e.children.length===0)?!0:n.children.every((t,c)=>{var a;return(a=e.children)==null?void 0:a.some(h=>aw(t,h))}):!1}async function aA(n,e,t){if(!n.lazy)return;let c=await n.lazy();if(!n.lazy)return;let a=t[n.id];yr(a,"No route found in manifest");let h={};for(let d in c){let f=a[d]!==void 0&&d!=="hasErrorBoundary";Gn(!f,`Route "${a.id}" has a static property "${d}" defined but its lazy function is also returning a value for this property. The lazy route property "${d}" will be ignored.`),!f&&!PM.has(d)&&(h[d]=c[d])}Object.assign(a,h),Object.assign(a,{...e(a),lazy:void 0})}async function lA({matches:n}){let e=n.filter(c=>c.shouldLoad);return(await Promise.all(e.map(c=>c.resolve()))).reduce((c,a,h)=>Object.assign(c,{[e[h].route.id]:a}),{})}async function cA(n,e,t,c,a,h,d,s,f,b){let x=h.map(P=>P.route.lazy?aA(P.route,f,s):void 0),v=h.map((P,_)=>{let S=x[_],k=a.some(y=>y.route.id===P.route.id);return{...P,shouldLoad:k,resolve:async y=>(y&&c.method==="GET"&&(P.route.lazy||P.route.loader)&&(k=!0),k?hA(e,c,P,S,y,b):Promise.resolve({type:"data",result:void 0}))}}),g=await n({matches:v,request:c,params:h[0].params,fetcherKey:d,context:b});try{await Promise.all(x)}catch{}return g}async function hA(n,e,t,c,a,h){let d,s,f=b=>{let x,v=new Promise((_,S)=>x=S);s=()=>x(),e.signal.addEventListener("abort",s);let g=_=>typeof b!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${n}" [routeId: ${t.route.id}]`)):b({request:e,params:t.params,context:h},..._!==void 0?[_]:[]),P=(async()=>{try{return{type:"data",result:await(a?a(S=>g(S)):g())}}catch(_){return{type:"error",result:_}}})();return Promise.race([P,v])};try{let b=t.route[n];if(c)if(b){let x,[v]=await Promise.all([f(b).catch(g=>{x=g}),c]);if(x!==void 0)throw x;d=v}else if(await c,b=t.route[n],b)d=await f(b);else if(n==="action"){let x=new URL(e.url),v=x.pathname+x.search;throw wo(405,{method:e.method,pathname:v,routeId:t.route.id})}else return{type:"data",result:void 0};else if(b)d=await f(b);else{let x=new URL(e.url),v=x.pathname+x.search;throw wo(404,{pathname:v})}}catch(b){return{type:"error",result:b}}finally{s&&e.signal.removeEventListener("abort",s)}return d}async function uA(n){var c,a,h,d;let{result:e,type:t}=n;if(cw(e)){let s;try{let f=e.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?e.body==null?s=null:s=await e.json():s=await e.text()}catch(f){return{type:"error",error:f}}return t==="error"?{type:"error",error:new Of(e.status,e.statusText,s),statusCode:e.status,headers:e.headers}:{type:"data",data:s,statusCode:e.status,headers:e.headers}}if(t==="error"){if(av(e)){if(e.data instanceof Error)return{type:"error",error:e.data,statusCode:(c=e.init)==null?void 0:c.status};e=new Of(((a=e.init)==null?void 0:a.status)||500,void 0,e.data)}return{type:"error",error:e,statusCode:cm(e)?e.status:void 0}}return av(e)?{type:"data",data:e.data,statusCode:(h=e.init)==null?void 0:h.status,headers:(d=e.init)!=null&&d.headers?new Headers(e.init.headers):void 0}:{type:"data",data:e}}function dA(n,e,t,c,a){let h=n.headers.get("Location");if(yr(h,"Redirects returned/thrown from loaders/actions must have a Location header"),!fx.test(h)){let d=c.slice(0,c.findIndex(s=>s.route.id===t)+1);h=my(new URL(e.url),d,a,h),n.headers.set("Location",h)}return n}function tv(n,e,t){if(fx.test(n)){let c=n,a=c.startsWith("//")?new URL(e.protocol+c):new URL(c),h=zo(a.pathname,t)!=null;if(a.origin===e.origin&&h)return a.pathname+a.search+a.hash}return n}function gh(n,e,t,c){let a=n.createURL(lw(e)).toString(),h={signal:t};if(c&&Lo(c.formMethod)){let{formMethod:d,formEncType:s}=c;h.method=d.toUpperCase(),s==="application/json"?(h.headers=new Headers({"Content-Type":s}),h.body=JSON.stringify(c.json)):s==="text/plain"?h.body=c.text:s==="application/x-www-form-urlencoded"&&c.formData?h.body=yy(c.formData):h.body=c.formData}return new Request(a,h)}function yy(n){let e=new URLSearchParams;for(let[t,c]of n.entries())e.append(t,typeof c=="string"?c:c.name);return e}function iv(n){let e=new FormData;for(let[t,c]of n.entries())e.append(t,c);return e}function pA(n,e,t,c=!1,a=!1){let h={},d=null,s,f=!1,b={},x=t&&ao(t[1])?t[1].error:void 0;return n.forEach(v=>{if(!(v.route.id in e))return;let g=v.route.id,P=e[g];if(yr(!cc(P),"Cannot handle redirect results in processLoaderData"),ao(P)){let _=P.error;if(x!==void 0&&(_=x,x=void 0),d=d||{},a)d[g]=_;else{let S=ac(n,g);d[S.route.id]==null&&(d[S.route.id]=_)}c||(h[g]=ow),f||(f=!0,s=cm(P.error)?P.error.status:500),P.headers&&(b[g]=P.headers)}else h[g]=P.data,P.statusCode&&P.statusCode!==200&&!f&&(s=P.statusCode),P.headers&&(b[g]=P.headers)}),x!==void 0&&t&&(d={[t[0]]:x},h[t[0]]=void 0),{loaderData:h,errors:d,statusCode:s||200,loaderHeaders:b}}function rv(n,e,t,c,a,h){let{loaderData:d,errors:s}=pA(e,t,c);return a.forEach(f=>{let{key:b,match:x,controller:v}=f,g=h[b];if(yr(g,"Did not find corresponding fetcher result"),!(v&&v.signal.aborted))if(ao(g)){let P=ac(n.matches,x==null?void 0:x.route.id);s&&s[P.route.id]||(s={...s,[P.route.id]:g.error}),n.fetchers.delete(b)}else if(cc(g))yr(!1,"Unhandled fetcher revalidation redirect");else{let P=rl(g.data);n.fetchers.set(b,P)}}),{loaderData:d,errors:s}}function nv(n,e,t,c){let a=Object.entries(e).filter(([,h])=>h!==ow).reduce((h,[d,s])=>(h[d]=s,h),{});for(let h of t){let d=h.route.id;if(!e.hasOwnProperty(d)&&n.hasOwnProperty(d)&&h.route.loader&&(a[d]=n[d]),c&&c.hasOwnProperty(d))break}return a}function sv(n){return n?ao(n[1])?{actionData:{}}:{actionData:{[n[0]]:n[1].data}}:{}}function ac(n,e){return(e?n.slice(0,n.findIndex(c=>c.route.id===e)+1):[...n]).reverse().find(c=>c.route.hasErrorBoundary===!0)||n[0]}function ov(n){let e=n.length===1?n[0]:n.find(t=>t.index||!t.path||t.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function wo(n,{pathname:e,routeId:t,method:c,type:a,message:h}={}){let d="Unknown Server Error",s="Unknown @remix-run/router error";return n===400?(d="Bad Request",c&&e&&t?s=`You made a ${c} request to "${e}" but did not provide a \`loader\` for route "${t}", so there is no way to handle the request.`:a==="invalid-body"&&(s="Unable to encode submission body")):n===403?(d="Forbidden",s=`Route "${t}" does not match URL "${e}"`):n===404?(d="Not Found",s=`No route matches URL "${e}"`):n===405&&(d="Method Not Allowed",c&&e&&t?s=`You made a ${c.toUpperCase()} request to "${e}" but did not provide an \`action\` for route "${t}", so there is no way to handle the request.`:c&&(s=`Invalid request method "${c.toUpperCase()}"`)),new Of(n||500,d,new Error(s),!0)}function Xp(n){let e=Object.entries(n);for(let t=e.length-1;t>=0;t--){let[c,a]=e[t];if(cc(a))return{key:c,result:a}}}function lw(n){let e=typeof n=="string"?za(n):n;return vl({...e,hash:""})}function fA(n,e){return n.pathname!==e.pathname||n.search!==e.search?!1:n.hash===""?e.hash!=="":n.hash===e.hash?!0:e.hash!==""}function mA(n){return cw(n.result)&&JM.has(n.result.status)}function ao(n){return n.type==="error"}function cc(n){return(n&&n.type)==="redirect"}function av(n){return typeof n=="object"&&n!=null&&"type"in n&&"data"in n&&"init"in n&&n.type==="DataWithResponseInit"}function cw(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function gA(n){return QM.has(n.toUpperCase())}function Lo(n){return ZM.has(n.toUpperCase())}function mx(n){return new URLSearchParams(n).getAll("index").some(e=>e==="")}function rd(n,e){let t=typeof e=="string"?za(e).search:e.search;if(n[n.length-1].route.index&&mx(t||""))return n[n.length-1];let c=rw(n);return c[c.length-1]}function lv(n){let{formMethod:e,formAction:t,formEncType:c,text:a,formData:h,json:d}=n;if(!(!e||!t||!c)){if(a!=null)return{formMethod:e,formAction:t,formEncType:c,formData:void 0,json:void 0,text:a};if(h!=null)return{formMethod:e,formAction:t,formEncType:c,formData:h,json:void 0,text:void 0};if(d!==void 0)return{formMethod:e,formAction:t,formEncType:c,formData:void 0,json:d,text:void 0}}}function Ig(n,e){return e?{state:"loading",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function yA(n,e){return{state:"submitting",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Zu(n,e){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function xA(n,e){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e?e.data:void 0}}function rl(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function bA(n,e){try{let t=n.sessionStorage.getItem(sw);if(t){let c=JSON.parse(t);for(let[a,h]of Object.entries(c||{}))h&&Array.isArray(h)&&e.set(a,new Set(h||[]))}}catch{}}function vA(n,e){if(e.size>0){let t={};for(let[c,a]of e)t[c]=[...a];try{n.sessionStorage.setItem(sw,JSON.stringify(t))}catch(c){Gn(!1,`Failed to save applied view transitions in sessionStorage (${c}).`)}}}function _A(){let n,e,t=new Promise((c,a)=>{n=async h=>{c(h);try{await t}catch{}},e=async h=>{a(h);try{await t}catch{}}});return{promise:t,resolve:n,reject:e}}var Sc=We.createContext(null);Sc.displayName="DataRouter";var jd=We.createContext(null);jd.displayName="DataRouterState";var gx=We.createContext({isTransitioning:!1});gx.displayName="ViewTransition";var hw=We.createContext(new Map);hw.displayName="Fetchers";var wA=We.createContext(null);wA.displayName="Await";var jo=We.createContext(null);jo.displayName="Navigation";var hm=We.createContext(null);hm.displayName="Location";var aa=We.createContext({outlet:null,matches:[],isDataRoute:!1});aa.displayName="Route";var yx=We.createContext(null);yx.displayName="RouteError";function TA(n,{relative:e}={}){yr(Vh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:c}=We.useContext(jo),{hash:a,pathname:h,search:d}=Hh(n,{relative:e}),s=h;return t!=="/"&&(s=h==="/"?t:Jo([t,h])),c.createHref({pathname:s,search:d,hash:a})}function Vh(){return We.useContext(hm)!=null}function Na(){return yr(Vh(),"useLocation() may be used only in the context of a <Router> component."),We.useContext(hm).location}var uw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function dw(n){We.useContext(jo).static||We.useLayoutEffect(n)}function xx(){let{isDataRoute:n}=We.useContext(aa);return n?OA():EA()}function EA(){yr(Vh(),"useNavigate() may be used only in the context of a <Router> component.");let n=We.useContext(Sc),{basename:e,navigator:t}=We.useContext(jo),{matches:c}=We.useContext(aa),{pathname:a}=Na(),h=JSON.stringify(am(c)),d=We.useRef(!1);return dw(()=>{d.current=!0}),We.useCallback((f,b={})=>{if(Gn(d.current,uw),!d.current)return;if(typeof f=="number"){t.go(f);return}let x=lm(f,JSON.parse(h),a,b.relative==="path");n==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:Jo([e,x.pathname])),(b.replace?t.replace:t.push)(x,b.state,b)},[e,t,h,a,n])}We.createContext(null);function Hh(n,{relative:e}={}){let{matches:t}=We.useContext(aa),{pathname:c}=Na(),a=JSON.stringify(am(t));return We.useMemo(()=>lm(n,JSON.parse(a),c,e==="path"),[n,a,c,e])}function CA(n,e,t,c){yr(Vh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=We.useContext(jo),{matches:h}=We.useContext(aa),d=h[h.length-1],s=d?d.params:{},f=d?d.pathname:"/",b=d?d.pathnameBase:"/",x=d&&d.route;{let A=x&&x.path||"";fw(f,!x||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let v=Na(),g;g=v;let P=g.pathname||"/",_=P;if(b!=="/"){let A=b.replace(/^\//,"").split("/");_="/"+P.replace(/^\//,"").split("/").slice(A.length).join("/")}let S=ll(n,{pathname:_});return Gn(x||S!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),Gn(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),PA(S&&S.map(A=>Object.assign({},A,{params:Object.assign({},s,A.params),pathname:Jo([b,a.encodeLocation?a.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?b:Jo([b,a.encodeLocation?a.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),h,t,c)}function SA(){let n=pw(),e=cm(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,c="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:c},h={padding:"2px 4px",backgroundColor:c},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=We.createElement(We.Fragment,null,We.createElement("p",null,"💿 Hey developer 👋"),We.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",We.createElement("code",{style:h},"ErrorBoundary")," or"," ",We.createElement("code",{style:h},"errorElement")," prop on your route.")),We.createElement(We.Fragment,null,We.createElement("h2",null,"Unexpected Application Error!"),We.createElement("h3",{style:{fontStyle:"italic"}},e),t?We.createElement("pre",{style:a},t):null,d)}var kA=We.createElement(SA,null),MA=class extends We.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?We.createElement(aa.Provider,{value:this.props.routeContext},We.createElement(yx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function AA({routeContext:n,match:e,children:t}){let c=We.useContext(Sc);return c&&c.static&&c.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(c.staticContext._deepestRenderedBoundaryId=e.route.id),We.createElement(aa.Provider,{value:n},t)}function PA(n,e=[],t=null,c=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,h=t==null?void 0:t.errors;if(h!=null){let f=a.findIndex(b=>b.route.id&&(h==null?void 0:h[b.route.id])!==void 0);yr(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let d=!1,s=-1;if(t)for(let f=0;f<a.length;f++){let b=a[f];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(s=f),b.route.id){let{loaderData:x,errors:v}=t,g=b.route.loader&&!x.hasOwnProperty(b.route.id)&&(!v||v[b.route.id]===void 0);if(b.route.lazy||g){d=!0,s>=0?a=a.slice(0,s+1):a=[a[0]];break}}}return a.reduceRight((f,b,x)=>{let v,g=!1,P=null,_=null;t&&(v=h&&b.route.id?h[b.route.id]:void 0,P=b.route.errorElement||kA,d&&(s<0&&x===0?(fw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,_=null):s===x&&(g=!0,_=b.route.hydrateFallbackElement||null)));let S=e.concat(a.slice(0,x+1)),k=()=>{let A;return v?A=P:g?A=_:b.route.Component?A=We.createElement(b.route.Component,null):b.route.element?A=b.route.element:A=f,We.createElement(AA,{match:b,routeContext:{outlet:f,matches:S,isDataRoute:t!=null},children:A})};return t&&(b.route.ErrorBoundary||b.route.errorElement||x===0)?We.createElement(MA,{location:t.location,revalidation:t.revalidation,component:P,error:v,children:k(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):k()},null)}function bx(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function IA(n){let e=We.useContext(Sc);return yr(e,bx(n)),e}function DA(n){let e=We.useContext(jd);return yr(e,bx(n)),e}function LA(n){let e=We.useContext(aa);return yr(e,bx(n)),e}function vx(n){let e=LA(n),t=e.matches[e.matches.length-1];return yr(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function RA(){return vx("useRouteId")}function pw(){var c;let n=We.useContext(yx),e=DA("useRouteError"),t=vx("useRouteError");return n!==void 0?n:(c=e.errors)==null?void 0:c[t]}function OA(){let{router:n}=IA("useNavigate"),e=vx("useNavigate"),t=We.useRef(!1);return dw(()=>{t.current=!0}),We.useCallback(async(a,h={})=>{Gn(t.current,uw),t.current&&(typeof a=="number"?n.navigate(a):await n.navigate(a,{fromRouteId:e,...h}))},[n,e])}var cv={};function fw(n,e,t){!e&&!cv[n]&&(cv[n]=!0,Gn(!1,t))}var hv={};function uv(n,e){!n&&!hv[e]&&(hv[e]=!0,console.warn(e))}function zA(n){let e={hasErrorBoundary:n.hasErrorBoundary||n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&(n.element&&Gn(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(e,{element:We.createElement(n.Component),Component:void 0})),n.HydrateFallback&&(n.hydrateFallbackElement&&Gn(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(e,{hydrateFallbackElement:We.createElement(n.HydrateFallback),HydrateFallback:void 0})),n.ErrorBoundary&&(n.errorElement&&Gn(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(e,{errorElement:We.createElement(n.ErrorBoundary),ErrorBoundary:void 0})),e}var NA=class{constructor(){this.status="pending",this.promise=new Promise((n,e)=>{this.resolve=t=>{this.status==="pending"&&(this.status="resolved",n(t))},this.reject=t=>{this.status==="pending"&&(this.status="rejected",e(t))}})}};function jA({router:n,flushSync:e}){let[t,c]=We.useState(n.state),[a,h]=We.useState(),[d,s]=We.useState({isTransitioning:!1}),[f,b]=We.useState(),[x,v]=We.useState(),[g,P]=We.useState(),_=We.useRef(new Map),S=We.useCallback((I,{deletedFetchers:D,flushSync:w,viewTransitionOpts:M})=>{I.fetchers.forEach((Y,X)=>{Y.data!==void 0&&_.current.set(X,Y.data)}),D.forEach(Y=>_.current.delete(Y)),uv(w===!1||e!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let z=n.window!=null&&n.window.document!=null&&typeof n.window.document.startViewTransition=="function";if(uv(M==null||z,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!M||!z){e&&w?e(()=>c(I)):We.startTransition(()=>c(I));return}if(e&&w){e(()=>{x&&(f&&f.resolve(),x.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:M.currentLocation,nextLocation:M.nextLocation})});let Y=n.window.document.startViewTransition(()=>{e(()=>c(I))});Y.finished.finally(()=>{e(()=>{b(void 0),v(void 0),h(void 0),s({isTransitioning:!1})})}),e(()=>v(Y));return}x?(f&&f.resolve(),x.skipTransition(),P({state:I,currentLocation:M.currentLocation,nextLocation:M.nextLocation})):(h(I),s({isTransitioning:!0,flushSync:!1,currentLocation:M.currentLocation,nextLocation:M.nextLocation}))},[n.window,e,x,f]);We.useLayoutEffect(()=>n.subscribe(S),[n,S]),We.useEffect(()=>{d.isTransitioning&&!d.flushSync&&b(new NA)},[d]),We.useEffect(()=>{if(f&&a&&n.window){let I=a,D=f.promise,w=n.window.document.startViewTransition(async()=>{We.startTransition(()=>c(I)),await D});w.finished.finally(()=>{b(void 0),v(void 0),h(void 0),s({isTransitioning:!1})}),v(w)}},[a,f,n.window]),We.useEffect(()=>{f&&a&&t.location.key===a.location.key&&f.resolve()},[f,x,t.location,a]),We.useEffect(()=>{!d.isTransitioning&&g&&(h(g.state),s({isTransitioning:!0,flushSync:!1,currentLocation:g.currentLocation,nextLocation:g.nextLocation}),P(void 0))},[d.isTransitioning,g]);let k=We.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:I=>n.navigate(I),push:(I,D,w)=>n.navigate(I,{state:D,preventScrollReset:w==null?void 0:w.preventScrollReset}),replace:(I,D,w)=>n.navigate(I,{replace:!0,state:D,preventScrollReset:w==null?void 0:w.preventScrollReset})}),[n]),A=n.basename||"/",y=We.useMemo(()=>({router:n,navigator:k,static:!1,basename:A}),[n,k,A]);return We.createElement(We.Fragment,null,We.createElement(Sc.Provider,{value:y},We.createElement(jd.Provider,{value:t},We.createElement(hw.Provider,{value:_.current},We.createElement(gx.Provider,{value:d},We.createElement($A,{basename:A,location:t.location,navigationType:t.historyAction,navigator:k},We.createElement(BA,{routes:n.routes,future:n.future,state:t})))))),null)}var BA=We.memo(FA);function FA({routes:n,future:e,state:t}){return CA(n,void 0,t,e)}function UA({to:n,replace:e,state:t,relative:c}){yr(Vh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=We.useContext(jo);Gn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:h}=We.useContext(aa),{pathname:d}=Na(),s=xx(),f=lm(n,am(h),d,c==="path"),b=JSON.stringify(f);return We.useEffect(()=>{s(JSON.parse(b),{replace:e,state:t,relative:c})},[s,b,c,e,t]),null}function $A({basename:n="/",children:e=null,location:t,navigationType:c="POP",navigator:a,static:h=!1}){yr(!Vh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=n.replace(/^\/*/,"/"),s=We.useMemo(()=>({basename:d,navigator:a,static:h,future:{}}),[d,a,h]);typeof t=="string"&&(t=za(t));let{pathname:f="/",search:b="",hash:x="",state:v=null,key:g="default"}=t,P=We.useMemo(()=>{let _=zo(f,d);return _==null?null:{location:{pathname:_,search:b,hash:x,state:v,key:g},navigationType:c}},[d,f,b,x,v,g,c]);return Gn(P!=null,`<Router basename="${d}"> is not able to match the URL "${f}${b}${x}" because it does not start with the basename, so the <Router> won't render anything.`),P==null?null:We.createElement(jo.Provider,{value:s},We.createElement(hm.Provider,{children:e,value:P}))}var uf="get",df="application/x-www-form-urlencoded";function um(n){return n!=null&&typeof n.tagName=="string"}function GA(n){return um(n)&&n.tagName.toLowerCase()==="button"}function VA(n){return um(n)&&n.tagName.toLowerCase()==="form"}function HA(n){return um(n)&&n.tagName.toLowerCase()==="input"}function WA(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function YA(n,e){return n.button===0&&(!e||e==="_self")&&!WA(n)}var Zp=null;function qA(){if(Zp===null)try{new FormData(document.createElement("form"),0),Zp=!1}catch{Zp=!0}return Zp}var XA=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dg(n){return n!=null&&!XA.has(n)?(Gn(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${df}"`),null):n}function ZA(n,e){let t,c,a,h,d;if(VA(n)){let s=n.getAttribute("action");c=s?zo(s,e):null,t=n.getAttribute("method")||uf,a=Dg(n.getAttribute("enctype"))||df,h=new FormData(n)}else if(GA(n)||HA(n)&&(n.type==="submit"||n.type==="image")){let s=n.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=n.getAttribute("formaction")||s.getAttribute("action");if(c=f?zo(f,e):null,t=n.getAttribute("formmethod")||s.getAttribute("method")||uf,a=Dg(n.getAttribute("formenctype"))||Dg(s.getAttribute("enctype"))||df,h=new FormData(s,n),!qA()){let{name:b,type:x,value:v}=n;if(x==="image"){let g=b?`${b}.`:"";h.append(`${g}x`,"0"),h.append(`${g}y`,"0")}else b&&h.append(b,v)}}else{if(um(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=uf,c=null,a=df,d=n}return h&&a==="text/plain"&&(d=h,h=void 0),{action:c,method:t.toLowerCase(),encType:a,formData:h,body:d}}function _x(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function KA(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function QA(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function JA(n,e,t){let c=await Promise.all(n.map(async a=>{let h=e.routes[a.route.id];if(h){let d=await KA(h,t);return d.links?d.links():[]}return[]}));return rP(c.flat(1).filter(QA).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function dv(n,e,t,c,a,h){let d=(f,b)=>t[b]?f.route.id!==t[b].route.id:!0,s=(f,b)=>{var x;return t[b].pathname!==f.pathname||((x=t[b].route.path)==null?void 0:x.endsWith("*"))&&t[b].params["*"]!==f.params["*"]};return h==="assets"?e.filter((f,b)=>d(f,b)||s(f,b)):h==="data"?e.filter((f,b)=>{var v;let x=c.routes[f.route.id];if(!x||!x.hasLoader)return!1;if(d(f,b)||s(f,b))return!0;if(f.route.shouldRevalidate){let g=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((v=t[0])==null?void 0:v.params)||{},nextUrl:new URL(n,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function eP(n,e){return tP(n.map(t=>{let c=e.routes[t.route.id];if(!c)return[];let a=[c.module];return c.imports&&(a=a.concat(c.imports)),a}).flat(1))}function tP(n){return[...new Set(n)]}function iP(n){let e={},t=Object.keys(n).sort();for(let c of t)e[c]=n[c];return e}function rP(n,e){let t=new Set;return new Set(e),n.reduce((c,a)=>{let h=JSON.stringify(iP(a));return t.has(h)||(t.add(h),c.push({key:h,link:a})),c},[])}function nP(n){let e=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function sP(){let n=We.useContext(Sc);return _x(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function oP(){let n=We.useContext(jd);return _x(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var wx=We.createContext(void 0);wx.displayName="FrameworkContext";function mw(){let n=We.useContext(wx);return _x(n,"You must render this element inside a <HydratedRouter> element"),n}function aP(n,e){let t=We.useContext(wx),[c,a]=We.useState(!1),[h,d]=We.useState(!1),{onFocus:s,onBlur:f,onMouseEnter:b,onMouseLeave:x,onTouchStart:v}=e,g=We.useRef(null);We.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let S=A=>{A.forEach(y=>{d(y.isIntersecting)})},k=new IntersectionObserver(S,{threshold:.5});return g.current&&k.observe(g.current),()=>{k.disconnect()}}},[n]),We.useEffect(()=>{if(c){let S=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(S)}}},[c]);let P=()=>{a(!0)},_=()=>{a(!1),d(!1)};return t?n!=="intent"?[h,g,{}]:[h,g,{onFocus:Ku(s,P),onBlur:Ku(f,_),onMouseEnter:Ku(b,P),onMouseLeave:Ku(x,_),onTouchStart:Ku(v,P)}]:[!1,g,{}]}function Ku(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function lP({page:n,...e}){let{router:t}=sP(),c=We.useMemo(()=>ll(t.routes,n,t.basename),[t.routes,n,t.basename]);return c?We.createElement(hP,{page:n,matches:c,...e}):null}function cP(n){let{manifest:e,routeModules:t}=mw(),[c,a]=We.useState([]);return We.useEffect(()=>{let h=!1;return JA(n,e,t).then(d=>{h||a(d)}),()=>{h=!0}},[n,e,t]),c}function hP({page:n,matches:e,...t}){let c=Na(),{manifest:a,routeModules:h}=mw(),{loaderData:d,matches:s}=oP(),f=We.useMemo(()=>dv(n,e,s,a,c,"data"),[n,e,s,a,c]),b=We.useMemo(()=>dv(n,e,s,a,c,"assets"),[n,e,s,a,c]),x=We.useMemo(()=>{if(n===c.pathname+c.search+c.hash)return[];let P=new Set,_=!1;if(e.forEach(k=>{var y;let A=a.routes[k.route.id];!A||!A.hasLoader||(!f.some(I=>I.route.id===k.route.id)&&k.route.id in d&&((y=h[k.route.id])!=null&&y.shouldRevalidate)||A.hasClientLoader?_=!0:P.add(k.route.id))}),P.size===0)return[];let S=nP(n);return _&&P.size>0&&S.searchParams.set("_routes",e.filter(k=>P.has(k.route.id)).map(k=>k.route.id).join(",")),[S.pathname+S.search]},[d,c,a,f,e,n,h]),v=We.useMemo(()=>eP(b,a),[b,a]),g=cP(b);return We.createElement(We.Fragment,null,x.map(P=>We.createElement("link",{key:P,rel:"prefetch",as:"fetch",href:P,...t})),v.map(P=>We.createElement("link",{key:P,rel:"modulepreload",href:P,...t})),g.map(({key:P,link:_})=>We.createElement("link",{key:P,..._})))}function uP(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var gw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{gw&&(window.__reactRouterVersion="7.1.3")}catch{}function dP(n,e){return rA({basename:e==null?void 0:e.basename,future:e==null?void 0:e.future,history:kM({window:e==null?void 0:e.window}),hydrationData:pP(),routes:n,mapRouteProperties:zA,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function pP(){let n=window==null?void 0:window.__staticRouterHydrationData;return n&&n.errors&&(n={...n,errors:fP(n.errors)}),n}function fP(n){if(!n)return null;let e=Object.entries(n),t={};for(let[c,a]of e)if(a&&a.__type==="RouteErrorResponse")t[c]=new Of(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let h=window[a.__subType];if(typeof h=="function")try{let d=new h(a.message);d.stack="",t[c]=d}catch{}}if(t[c]==null){let h=new Error(a.message);h.stack="",t[c]=h}}else t[c]=a;return t}var yw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tx=We.forwardRef(function({onClick:e,discover:t="render",prefetch:c="none",relative:a,reloadDocument:h,replace:d,state:s,target:f,to:b,preventScrollReset:x,viewTransition:v,...g},P){let{basename:_}=We.useContext(jo),S=typeof b=="string"&&yw.test(b),k,A=!1;if(typeof b=="string"&&S&&(k=b,gw))try{let X=new URL(window.location.href),Z=b.startsWith("//")?new URL(X.protocol+b):new URL(b),j=zo(Z.pathname,_);Z.origin===X.origin&&j!=null?b=j+Z.search+Z.hash:A=!0}catch{Gn(!1,`<Link to="${b}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=TA(b,{relative:a}),[I,D,w]=aP(c,g),M=xP(b,{replace:d,state:s,target:f,preventScrollReset:x,relative:a,viewTransition:v});function z(X){e&&e(X),X.defaultPrevented||M(X)}let Y=We.createElement("a",{...g,...w,href:k||y,onClick:A||h?e:z,ref:uP(P,D),target:f,"data-discover":!S&&t==="render"?"true":void 0});return I&&!S?We.createElement(We.Fragment,null,Y,We.createElement(lP,{page:y})):Y});Tx.displayName="Link";var mP=We.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:c="",end:a=!1,style:h,to:d,viewTransition:s,children:f,...b},x){let v=Hh(d,{relative:b.relative}),g=Na(),P=We.useContext(jd),{navigator:_,basename:S}=We.useContext(jo),k=P!=null&&TP(v)&&s===!0,A=_.encodeLocation?_.encodeLocation(v).pathname:v.pathname,y=g.pathname,I=P&&P.navigation&&P.navigation.location?P.navigation.location.pathname:null;t||(y=y.toLowerCase(),I=I?I.toLowerCase():null,A=A.toLowerCase()),I&&S&&(I=zo(I,S)||I);const D=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let w=y===A||!a&&y.startsWith(A)&&y.charAt(D)==="/",M=I!=null&&(I===A||!a&&I.startsWith(A)&&I.charAt(A.length)==="/"),z={isActive:w,isPending:M,isTransitioning:k},Y=w?e:void 0,X;typeof c=="function"?X=c(z):X=[c,w?"active":null,M?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let Z=typeof h=="function"?h(z):h;return We.createElement(Tx,{...b,"aria-current":Y,className:X,ref:x,style:Z,to:d,viewTransition:s},typeof f=="function"?f(z):f)});mP.displayName="NavLink";var gP=We.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:c,replace:a,state:h,method:d=uf,action:s,onSubmit:f,relative:b,preventScrollReset:x,viewTransition:v,...g},P)=>{let _=_P(),S=wP(s,{relative:b}),k=d.toLowerCase()==="get"?"get":"post",A=typeof s=="string"&&yw.test(s),y=I=>{if(f&&f(I),I.defaultPrevented)return;I.preventDefault();let D=I.nativeEvent.submitter,w=(D==null?void 0:D.getAttribute("formmethod"))||d;_(D||I.currentTarget,{fetcherKey:e,method:w,navigate:t,replace:a,state:h,relative:b,preventScrollReset:x,viewTransition:v})};return We.createElement("form",{ref:P,method:k,action:S,onSubmit:c?f:y,...g,"data-discover":!A&&n==="render"?"true":void 0})});gP.displayName="Form";function yP(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function xw(n){let e=We.useContext(Sc);return yr(e,yP(n)),e}function xP(n,{target:e,replace:t,state:c,preventScrollReset:a,relative:h,viewTransition:d}={}){let s=xx(),f=Na(),b=Hh(n,{relative:h});return We.useCallback(x=>{if(YA(x,e)){x.preventDefault();let v=t!==void 0?t:vl(f)===vl(b);s(n,{replace:v,state:c,preventScrollReset:a,relative:h,viewTransition:d})}},[f,s,b,t,c,e,n,a,h,d])}var bP=0,vP=()=>`__${String(++bP)}__`;function _P(){let{router:n}=xw("useSubmit"),{basename:e}=We.useContext(jo),t=RA();return We.useCallback(async(c,a={})=>{let{action:h,method:d,encType:s,formData:f,body:b}=ZA(c,e);if(a.navigate===!1){let x=a.fetcherKey||vP();await n.fetch(x,t,a.action||h,{preventScrollReset:a.preventScrollReset,formData:f,body:b,formMethod:a.method||d,formEncType:a.encType||s,flushSync:a.flushSync})}else await n.navigate(a.action||h,{preventScrollReset:a.preventScrollReset,formData:f,body:b,formMethod:a.method||d,formEncType:a.encType||s,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[n,e,t])}function wP(n,{relative:e}={}){let{basename:t}=We.useContext(jo),c=We.useContext(aa);yr(c,"useFormAction must be used inside a RouteContext");let[a]=c.matches.slice(-1),h={...Hh(n||".",{relative:e})},d=Na();if(n==null){h.search=d.search;let s=new URLSearchParams(h.search),f=s.getAll("index");if(f.some(x=>x==="")){s.delete("index"),f.filter(v=>v).forEach(v=>s.append("index",v));let x=s.toString();h.search=x?`?${x}`:""}}return(!n||n===".")&&a.route.index&&(h.search=h.search?h.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(h.pathname=h.pathname==="/"?t:Jo([t,h.pathname])),vl(h)}function TP(n,e={}){let t=We.useContext(gx);yr(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:c}=xw("useViewTransitionState"),a=Hh(n,{relative:e.relative});if(!t.isTransitioning)return!1;let h=zo(t.currentLocation.pathname,c)||t.currentLocation.pathname,d=zo(t.nextLocation.pathname,c)||t.nextLocation.pathname;return Rf(a.pathname,d)!=null||Rf(a.pathname,h)!=null}new TextEncoder;/**
 * react-router v7.1.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function EP(n){return We.createElement(jA,{flushSync:I2.flushSync,...n})}const CP="_outerContainer_otz9c_1",SP="_container_otz9c_5",kP="_sendButton_otz9c_10",MP="_error_otz9c_16",AP="_ok_otz9c_29",PP="_tips_otz9c_35",yh={outerContainer:CP,container:SP,sendButton:kP,error:MP,ok:AP,tips:PP},IP={routes:{resource:"routes",params:{paging:!1,filter:"code:eq:chap",fields:"*"}}},bw=()=>{var c;const{data:n,loading:e,error:t}=mo(IP);return{route:(c=n==null?void 0:n.routes)==null?void 0:c.routes[0],error:t,loading:e}},vw={data:({url:n})=>({name:"chap",code:"chap",disabled:!1,url:n,headers:{"Content-Type":"application/json"}})},DP={type:"update",resource:"routes",id:({id:n})=>n,...vw},LP={type:"create",resource:"routes",...vw},RP=n=>{const[e,t]=Pf(LP),[c,a]=Pf(DP);return n?{mutate:c,...a}:{mutate:e,...t}},OP=()=>{const n="https://docs.dhis2.org/en/develop/using-the-api/dhis-core-version-241/route.html",e="https://github.com/dhis2-chap/chap-core",[t,c]=We.useState(""),[a,h]=We.useState(void 0),{mutate:d,error:s,loading:f,called:b,engine:x}=RP(a),{loading:v,route:g,error:P}=bw(),{baseUrl:_}=zh(),S=async()=>{await d({id:a==null?void 0:a.id,url:t})};We.useEffect(()=>{g&&(c(g.url),h(g))},[g]);const k=()=>{window.location.replace("#/settings")};return ve.jsxs("div",{className:yh.outerContainer,children:[ve.jsxs("div",{className:yh.container,children:[ve.jsx("h2",{children:"Configure route"}),ve.jsxs("p",{children:["CHAP requires that you set up a"," ",ve.jsx("a",{about:"_blank",href:n,children:"route"})," ","in DHIS2 to enable communication with the CHAP Core server."]}),ve.jsxs("p",{children:["You also needs to set up the CHAP server itself. Setup guide",ve.jsxs("a",{about:"_blank",href:e,children:[" ","github.com/dhis2/chap-core"]}),"."]}),ve.jsx("p",{children:`By clicking "Save" you create a new route in DHIS2, with name 'chap' and code 'chap'.`}),ve.jsx("p",{children:ve.jsx("a",{about:"_blank",href:_+"/api/routes?fields=*",children:"Existing routes in DHIS2 ➔"})}),ve.jsx(Nh,{value:t,onChange:A=>c(A.value),placeholder:"http://chap:8000/**",label:"URL"}),ve.jsx("div",{className:yh.sendButton,children:ve.jsx(en,{disabled:b||t==="",onClick:S,icon:ve.jsx(Dy,{}),primary:!0,children:"Save"})}),b&&!s&&!f&&ve.jsxs(ve.Fragment,{children:[ve.jsx("p",{className:yh.ok,children:"Route successfully created!"}),ve.jsx("div",{className:yh.sendButton,children:ve.jsx(en,{icon:ve.jsx(s1,{}),onClick:k,children:"Test route"})})]}),ve.jsx("p",{children:f&&"Setting up route..."})]}),s&&ve.jsx("div",{className:yh.error,children:ve.jsxs("span",{children:["ERROR",ve.jsx("pre",{children:JSON.stringify(s,null,2)})]})})]})},zP=()=>ve.jsx(OP,{}),pv=()=>{const n=pw();return console.error(n),ve.jsxs("div",{id:"error-page",children:[ve.jsx("h1",{children:"Oops!"}),ve.jsx("p",{children:"Sorry, an unexpected error has occurred."}),ve.jsx("p",{children:ve.jsx("i",{children:(n==null?void 0:n.statusText)||(n==null?void 0:n.message)})})]})},NP="_innerNavBar_bw29d_1",jP="_leftNavBarLinks_bw29d_12",BP="_outerNavBar_bw29d_17",Lg={innerNavBar:NP,leftNavBarLinks:jP,outerNavBar:BP},FP=({path:n,label:e})=>{const{pathname:t}=Hh({});return ve.jsx(My,{label:e,href:`#${n}`,active:t===n||n!=="/"&&t.startsWith(n)})},_w="1400px",UP=[{label:"Evaluate",path:"/evaluate"},{label:"Predict",path:"/predict"}],$P=()=>{const n=xx(),e=()=>{n("/settings")};return ve.jsx("div",{children:ve.jsx("div",{className:Lg.outerNavBar,children:ve.jsxs("div",{className:Lg.innerNavBar,style:{maxWidth:_w},children:[ve.jsx("div",{className:Lg.leftNavBarLinks,children:UP.map(({path:t,label:c},a)=>ve.jsx(FP,{path:t,label:c},a))}),ve.jsx(en,{small:!0,icon:ve.jsx(D2,{}),onClick:e,children:"Settings"})]})})})},GP="_warningMargin_z0zs1_1",VP="_warningMarginInner_z0zs1_6",fv={warningMargin:GP,warningMarginInner:VP},HP={routes:{resource:"routes",params:{paging:!1,filter:"code:eq:chap",fields:"*"}}},WP=()=>{var c;const{data:n,loading:e,error:t}=mo(HP);return{route:(c=n==null?void 0:n.routes)==null?void 0:c.routes[0],error:t,loading:e}},YP=()=>{const{loading:n,route:e,error:t}=WP();return!e&&!n?ve.jsx("div",{className:fv.warningMargin,style:{maxWidth:_w},children:ve.jsx("div",{className:fv.warningMarginInner,children:ve.jsxs(Ay,{warning:!0,title:"Missing route",children:["No route for CHAP was found. Functionality is limited."," ",ve.jsx(Tx,{to:"/settings",children:"Go to settings ➔"})]})})}):ve.jsx(ve.Fragment,{})},qP="1400px",XP={maxWidth:qP,marginLeft:"auto",marginRight:"auto",padding:"20px 10px 20px 10px"},Rg=({component:n})=>ve.jsxs(ve.Fragment,{children:[ve.jsx($P,{}),ve.jsx(YP,{}),ve.jsx("div",{style:XP,children:n})]}),ZP="_drawerWrapper_1jnc9_1",KP={drawerWrapper:ZP};function xy(){return xy=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(n[c]=t[c])}return n},xy.apply(this,arguments)}var QP=function(e,t){var c={left:{top:0,left:0,transform:"translate3d(-100%, 0, 0)",width:t,height:"100vh"},right:{top:0,right:0,transform:"translate3d(100%, 0, 0)",width:t,height:"100vh"},bottom:{left:0,right:0,bottom:0,transform:"translate3d(0, 100%, 0)",width:"100%",height:t},top:{left:0,right:0,top:0,transform:"translate3d(0, -100%, 0)",width:"100%",height:t}};return c[e]},Ex=function(e){var t=e.open,c=e.onClose,a=c===void 0?function(){}:c,h=e.children,d=e.style,s=e.enableOverlay,f=s===void 0?!0:s,b=e.overlayColor,x=b===void 0?"#000":b,v=e.overlayOpacity,g=v===void 0?.4:v,P=e.zIndex,_=P===void 0?100:P,S=e.duration,k=S===void 0?500:S,A=e.direction,y=e.size,I=y===void 0?250:y,D=e.className,w=e.customIdSuffix,M=e.lockBackgroundScroll,z=M===void 0?!1:M,Y=e.overlayClassName,X=Y===void 0?"":Y,Z=We.useRef(null);We.useEffect(function(){var R=function(){Z.current=window.document.querySelector("body"),Z.current&&z&&(Z.current.style.overflow=t?"hidden":"")};R()},[t]);var j=We.useMemo(function(){return w||(Math.random()+1).toString(36).substring(7)},[w]),V={backgroundColor:x.toString(),opacity:g,zIndex:_},$=xy({zIndex:_+1,transitionDuration:k+"ms"},QP(A,I),d);return He.createElement("div",{id:"EZDrawer"+j,className:"EZDrawer"},He.createElement("input",{type:"checkbox",id:"EZDrawer__checkbox"+j,className:"EZDrawer__checkbox",onChange:a,checked:t}),He.createElement("nav",{role:"navigation",id:"EZDrawer__container"+j,style:$,className:"EZDrawer__container "+D},h),f&&He.createElement("label",{htmlFor:"EZDrawer__checkbox"+j,id:"EZDrawer__overlay"+j,className:"EZDrawer__overlay "+X,style:V}))};const JP="_formWrapper_6d4wk_1",e3={formWrapper:JP},t3=({value:n,onChange:e})=>ve.jsx("div",{children:ve.jsxs(Os,{onChange:({selected:t})=>e(t),selected:n,label:"Period type",children:[ve.jsx(yc,{value:"week",label:"Weekly"}),ve.jsx(yc,{value:"month",label:"Monthly"})]})}),i3="_datePicker_1yiz7_1",r3="_label_1yiz7_5",n3="_content_1yiz7_14",s3="_box_1yiz7_18",o3="_inputDiv_1yiz7_23",a3="_input_1yiz7_23",xh={datePicker:i3,label:r3,content:n3,box:s3,inputDiv:o3,input:a3},mv=({label:n,name:e,onChange:t,periodeType:c})=>{const a=We.useRef(null);return ve.jsxs("div",{className:xh.datePicker,style:{opacity:c===""?.6:1},children:[ve.jsx("label",{className:xh.label,children:n}),ve.jsx("div",{className:xh.content,children:ve.jsx("div",{className:xh.box,children:ve.jsx("div",{className:xh.inputDiv,children:ve.jsx("input",{disabled:c==="",className:xh.input,ref:a,type:c,name:e,onChange:h=>t(h.target.value)})})})})]})},l3="_timePeriodeSelector_fpkps_1",c3="_timePeriodeSelectorInputFields_fpkps_7",h3="_timePeriodeSelectorInputFieldsChild_fpkps_13",Kp={timePeriodeSelector:l3,timePeriodeSelectorInputFields:c3,timePeriodeSelectorInputFieldsChild:h3},u3=(n,e,t)=>t==="week"?d3(n,e):t==="month"?m3(n,e):[],d3=(n,e)=>{let[t,c]=n.split("-W").map(Number),[a,h]=e.split("-W").map(Number);if(a-t>100)return[];let d=[];for(let s=t;s<=a;s++){let f=f3(s),b=s===t?c:1,x=s===a?h:f;for(let v=b;v<=x;v++){let g=`${s}W${String(v).padStart(2,"0")}`;d.push({endDate:void 0,startDate:void 0,id:g})}}return d},p3=n=>{n=new Date(+n),n.setHours(0,0,0,0),n.setDate(n.getDate()+4-(n.getDay()||7));var e=new Date(n.getFullYear(),0,1),t=Math.ceil(((n-e)/864e5+1)/7);return[n.getFullYear(),t]},f3=n=>{var e=new Date(n,11,31),t=p3(e)[1];return t==1?52:t},m3=(n,e)=>{const[t,c]=n.split("-").map(Number),[a,h]=e.split("-").map(Number);if(a-t>100)return[];let d=[],s=t,f=c;for(;s<a||s===a&&f<=h;){let b=String(f).padStart(2,"0");d.push({id:`${s}${b}`,endDate:void 0,startDate:void 0}),f++,f>12&&(f=1,s++)}return d},ww=({setTimePeriods:n})=>{const[e,t]=We.useState(""),[c,a]=We.useState(""),[h,d]=We.useState(""),s=f=>{a(""),d(""),t(f)};return We.useEffect(()=>{n(u3(c,h,e))},[c,h]),ve.jsxs("div",{children:[ve.jsx("h3",{children:"Period"}),ve.jsxs("div",{className:Kp.timePeriodeSelector,children:[ve.jsx(t3,{value:e,onChange:s}),ve.jsxs("div",{className:Kp.timePeriodeSelectorInputFields,children:[ve.jsx("div",{className:Kp.timePeriodeSelectorInputFieldsChild,children:ve.jsx(mv,{periodeType:e,label:"Dateset start:",name:"",onChange:a})}),ve.jsx("div",{className:Kp.timePeriodeSelectorInputFieldsChild,children:ve.jsx(mv,{periodeType:e,label:"Dateset end:",name:"",onChange:d})})]})]})]})},g3="_error_1rljs_1",y3={error:g3},x3={roots:{resource:"organisationUnits",params:()=>({fields:["id","displayName~rename(name)","path"],userDataViewFallback:!0})}},b3=()=>{var c;const{loading:n,error:e,data:t}=mo(x3);return{roots:(c=t==null?void 0:t.roots)==null?void 0:c.organisationUnits,error:e,loading:n}},v3=({selectedOrgUnits:n,onChange:e})=>{const{roots:t,error:c}=b3();return We.useEffect(()=>{if(t&&!n){const[a]=t;e({...a,selected:[a.path]})}},[t]),t?ve.jsxs("div",{children:[ve.jsx("h3",{children:jt.t("Organisation units")}),ve.jsx(Q_,{roots:t.map(a=>a.id),selected:n==null?void 0:n.map(a=>a.path),onChange:e,initiallyExpanded:t.map(a=>a.path)})]}):c?ve.jsx("div",{children:c.message}):null},_3={levels:{resource:"organisationUnitLevels",params:{fields:["id","displayName~rename(name)","level"],order:"level:asc",paging:!1}}},w3=()=>{var c;const{loading:n,error:e,data:t}=mo(_3);return{levels:(c=t==null?void 0:t.levels)==null?void 0:c.organisationUnitLevels,error:e,loading:n}},T3="_selectField_2clxr_1",E3={selectField:T3},C3=({orgUnitLevels:n,onChange:e})=>{const{levels:t,loading:c,error:a}=w3(),h=d=>{const s={id:d.selected,level:t.find(f=>f.id===d.selected).level};e(s)};return We.useEffect(()=>{var d;(t==null?void 0:t.length)>2&&!n&&e({id:(d=t[1])==null?void 0:d.id,level:t[1].level})},[t,n,e]),t?ve.jsx("div",{className:E3.selectField,children:ve.jsx(Os,{label:jt.t("Organisation unit level"),helpText:jt.t("Organisation unit level to import data to"),tabIndex:"1",selected:n==null?void 0:n.id,loading:c,error:!!a,onChange:h,children:t.map((d,s)=>ve.jsx(yc,{value:d.id,label:d.name},d.id))})}):null},Tw=({setOrgUnits:n,orgUnits:e,orgUnitLevel:t,setOrgUnitLevel:c})=>{const a=d=>{d.checked?n([...e,d]):n(e.filter(s=>s.path!==d.path))};function h(){if(e.length===0)return!0;const d=e[0].path.split("/").length;return e.every(s=>s.path.split("/").length===d)}return ve.jsxs(ve.Fragment,{children:[ve.jsx(v3,{selectedOrgUnits:e,onChange:d=>{a(d)}}),!h()&&ve.jsx("p",{className:y3.error,children:"Only select organization units that are one the same level."}),ve.jsx(C3,{orgUnitLevels:t,onChange:c})]})},S3=({dataElements:n=[],periodes:e=[],orgUnit:t={}}={})=>({request:{resource:"analytics",params:{paging:!1,dimension:`dx:${n.join(";")},ou:${t},pe:${e.join(";")}`}}}),k3=(n,e,t)=>{var s,f,b;const c=n.map(x=>x.dataSource);if(c.length===0)return{data:[],metaData:{},error:"",loading:!1};const{loading:a,error:h,data:d}=mo(S3({dataElements:c,periodes:e,orgUnit:t}));return!a&&d&&!h?{data:(s=d==null?void 0:d.request)==null?void 0:s.rows,metaData:(b=(f=d==null?void 0:d.request)==null?void 0:f.metaData)==null?void 0:b.items,error:h,loading:a}:{data:d,metaData:{},error:h,loading:a}},M3={geojson:{resource:"organisationUnits.geojson",params:({level:n})=>({level:n})}},A3=n=>({features:n.geojson.features.map(({type:e,id:t,geometry:c,properties:a})=>({type:e,id:t,properties:a,geometry:c})),...n}),P3=(n,e)=>({type:"FeatureCollection",features:n.features.filter(t=>e.some(c=>c.id===t.id||t.properties.parentGraph.includes(c.id)))}),I3=(n,e)=>{const{data:t,loading:c,error:a}=mo(M3,{variables:{level:n}});return{data:t&&P3(A3(t),e),error:a,loading:c}},D3="_text_b9rbg_1",L3={text:D3},R3=({selectedPeriodItems:n,setGeoJSon:e,setObservations:t,setFeatureDataItemMapper:c,setAnalyticsMetaData:a,setStartDownload:h,orgUnitLevel:d,selectedOrgUnits:s,analyticsDataLayers:f,setErrorMessages:b})=>{if(d==null)return ve.jsx(ve.Fragment,{});const x="LEVEL-"+d.id+";"+s.map(w=>w.id).join(";"),v=w=>w.map(M=>M.id),{data:g,error:P,loading:_,metaData:S}=k3(f,v(n),x),{data:k,error:A,loading:y}=I3(d.level,s),I=w=>w.map(M=>({featureName:f.filter(z=>z.dataSource===M)[0].feature,dataItemId:M})),D=w=>{const M=[...new Set(w.map(Y=>Y[0]))],z=I(M);return c(z),w.map(Y=>({featureName:z.filter(X=>X.dataItemId===Y[0])[0].featureName,orgUnit:Y[1],period:Y[2],value:parseFloat(Y[3])}))};return We.useEffect(()=>{if(!(_||y)&&(g&&k&&(b([]),e(k),t(D(g)),a(S)),P||A)){const w=[];P&&w.push({description:JSON.stringify(P),title:"Analytics request failed"}),A&&w.push({description:JSON.stringify(A),title:"OrgUnits request failed"}),b(w),h(M=>({...M,startDownload:!1}))}},[_,y]),ve.jsx("p",{className:L3.text,children:"Downloading data.."})};var Ew={exports:{}};(function(n){(function(e,t){n.exports?(t.default=t,n.exports=e&&e.document?t(e):t):(e.Highcharts&&e.Highcharts.error(16,!0),e.Highcharts=t(e))})(typeof window<"u"?window:lo,function(e){var t={};function c(a,h,d,s){!a.hasOwnProperty(h)&&(a[h]=s.apply(null,d),e&&typeof CustomEvent=="function"&&e.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:h,module:a[h]}})))}return c(t,"Core/Globals.js",[],function(){var a,h;return(h=a||(a={})).SVG_NS="http://www.w3.org/2000/svg",h.product="Highcharts",h.version="11.4.8",h.win=e!==void 0?e:{},h.doc=h.win.document,h.svg=h.doc&&h.doc.createElementNS&&!!h.doc.createElementNS(h.SVG_NS,"svg").createSVGRect,h.userAgent=h.win.navigator&&h.win.navigator.userAgent||"",h.isChrome=h.win.chrome,h.isFirefox=h.userAgent.indexOf("Firefox")!==-1,h.isMS=/(edge|msie|trident)/i.test(h.userAgent)&&!h.win.opera,h.isSafari=!h.isChrome&&h.userAgent.indexOf("Safari")!==-1,h.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(h.userAgent),h.isWebKit=h.userAgent.indexOf("AppleWebKit")!==-1,h.deg2rad=2*Math.PI/360,h.hasBidiBug=h.isFirefox&&4>parseInt(h.userAgent.split("Firefox/")[1],10),h.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],h.noop=function(){},h.supportsPassiveEvents=function(){let d=!1;if(!h.isMS){let s=Object.defineProperty({},"passive",{get:function(){d=!0}});h.win.addEventListener&&h.win.removeEventListener&&(h.win.addEventListener("testPassive",h.noop,s),h.win.removeEventListener("testPassive",h.noop,s))}return d}(),h.charts=[],h.composed=[],h.dateFormats={},h.seriesTypes={},h.symbolSizes={},h.chartCount=0,a}),c(t,"Core/Utilities.js",[t["Core/Globals.js"]],function(a){let h,{charts:d,doc:s,win:f}=a;function b(R,L,G,U){let F=L?"Highcharts error":"Highcharts warning";R===32&&(R=`${F}: Deprecated member`);let H=k(R),W=H?`${F} #${R}: www.highcharts.com/errors/${R}/`:R.toString();if(U!==void 0){let ne="";H&&(W+="?"),Z(U,function(ue,ie){ne+=`
 - ${ie}: ${ue}`,H&&(W+=encodeURI(ie)+"="+encodeURI(ue))}),W+=ne}V(a,"displayError",{chart:G,code:R,message:W,params:U},function(){if(L)throw Error(W);f.console&&b.messages.indexOf(W)===-1&&console.warn(W)}),b.messages.push(W)}function x(R,L){return parseInt(R,L||10)}function v(R){return typeof R=="string"}function g(R){let L=Object.prototype.toString.call(R);return L==="[object Array]"||L==="[object Array Iterator]"}function P(R,L){return!!R&&typeof R=="object"&&(!L||!g(R))}function _(R){return P(R)&&typeof R.nodeType=="number"}function S(R){let L=R&&R.constructor;return!!(P(R,!0)&&!_(R)&&L&&L.name&&L.name!=="Object")}function k(R){return typeof R=="number"&&!isNaN(R)&&R<1/0&&R>-1/0}function A(R){return R!=null}function y(R,L,G){let U,F=v(L)&&!A(G),H=(W,ne)=>{A(W)?R.setAttribute(ne,W):F?(U=R.getAttribute(ne))||ne!=="class"||(U=R.getAttribute(ne+"Name")):R.removeAttribute(ne)};return v(L)?H(G,L):Z(L,H),U}function I(R){return g(R)?R:[R]}function D(R,L){let G;for(G in R||(R={}),L)R[G]=L[G];return R}function w(){let R=arguments,L=R.length;for(let G=0;G<L;G++){let U=R[G];if(U!=null)return U}}function M(R,L){D(R.style,L)}function z(R){return Math.pow(10,Math.floor(Math.log(R)/Math.LN10))}function Y(R,L){return R>1e14?R:parseFloat(R.toPrecision(L||14))}b.messages=[],Math.easeInOutSine=function(R){return-.5*(Math.cos(Math.PI*R)-1)};let X=Array.prototype.find?function(R,L){return R.find(L)}:function(R,L){let G,U=R.length;for(G=0;G<U;G++)if(L(R[G],G))return R[G]};function Z(R,L,G){for(let U in R)Object.hasOwnProperty.call(R,U)&&L.call(G||R[U],R[U],U,R)}function j(R,L,G){function U(W,ne){let ue=R.removeEventListener;ue&&ue.call(R,W,ne,!1)}function F(W){let ne,ue;R.nodeName&&(L?(ne={})[L]=!0:ne=W,Z(ne,function(ie,oe){if(W[oe])for(ue=W[oe].length;ue--;)U(oe,W[oe][ue].fn)}))}let H=typeof R=="function"&&R.prototype||R;if(Object.hasOwnProperty.call(H,"hcEvents")){let W=H.hcEvents;if(L){let ne=W[L]||[];G?(W[L]=ne.filter(function(ue){return G!==ue.fn}),U(L,G)):(F(W),W[L]=[])}else F(W),delete H.hcEvents}}function V(R,L,G,U){if(G=G||{},s.createEvent&&(R.dispatchEvent||R.fireEvent&&R!==a)){let F=s.createEvent("Events");F.initEvent(L,!0,!0),G=D(F,G),R.dispatchEvent?R.dispatchEvent(G):R.fireEvent(L,G)}else if(R.hcEvents){G.target||D(G,{preventDefault:function(){G.defaultPrevented=!0},target:R,type:L});let F=[],H=R,W=!1;for(;H.hcEvents;)Object.hasOwnProperty.call(H,"hcEvents")&&H.hcEvents[L]&&(F.length&&(W=!0),F.unshift.apply(F,H.hcEvents[L])),H=Object.getPrototypeOf(H);W&&F.sort((ne,ue)=>ne.order-ue.order),F.forEach(ne=>{ne.fn.call(R,G)===!1&&G.preventDefault()})}U&&!G.defaultPrevented&&U.call(R,G)}Z({map:"map",each:"forEach",grep:"filter",reduce:"reduce",some:"some"},function(R,L){a[L]=function(G){return b(32,!1,void 0,{[`Highcharts.${L}`]:`use Array.${R}`}),Array.prototype[R].apply(G,[].slice.call(arguments,1))}});let $=function(){let R=Math.random().toString(36).substring(2,9)+"-",L=0;return function(){return"highcharts-"+(h?"":R)+L++}}();return f.jQuery&&(f.jQuery.fn.highcharts=function(){let R=[].slice.call(arguments);if(this[0])return R[0]?(new a[v(R[0])?R.shift():"Chart"](this[0],R[0],R[1]),this):d[y(this[0],"data-highcharts-chart")]}),{addEvent:function(R,L,G,U={}){let F=typeof R=="function"&&R.prototype||R;Object.hasOwnProperty.call(F,"hcEvents")||(F.hcEvents={});let H=F.hcEvents;a.Point&&R instanceof a.Point&&R.series&&R.series.chart&&(R.series.chart.runTrackerClick=!0);let W=R.addEventListener;W&&W.call(R,L,G,!!a.supportsPassiveEvents&&{passive:U.passive===void 0?L.indexOf("touch")!==-1:U.passive,capture:!1}),H[L]||(H[L]=[]);let ne={fn:G,order:typeof U.order=="number"?U.order:1/0};return H[L].push(ne),H[L].sort((ue,ie)=>ue.order-ie.order),function(){j(R,L,G)}},arrayMax:function(R){let L=R.length,G=R[0];for(;L--;)R[L]>G&&(G=R[L]);return G},arrayMin:function(R){let L=R.length,G=R[0];for(;L--;)R[L]<G&&(G=R[L]);return G},attr:y,clamp:function(R,L,G){return R>L?R<G?R:G:L},clearTimeout:function(R){A(R)&&clearTimeout(R)},correctFloat:Y,createElement:function(R,L,G,U,F){let H=s.createElement(R);return L&&D(H,L),F&&M(H,{padding:"0",border:"none",margin:"0"}),G&&M(H,G),U&&U.appendChild(H),H},crisp:(R,L=0,G)=>{let U=L%2/2,F=G?-1:1;return(Math.round(R*F-U)+U)*F},css:M,defined:A,destroyObjectProperties:function(R,L,G){Z(R,function(U,F){U!==L&&(U!=null&&U.destroy)&&U.destroy(),(U!=null&&U.destroy||!G)&&delete R[F]})},diffObjects:function(R,L,G,U){let F={};return function H(W,ne,ue,ie){let oe=G?ne:W;Z(W,function(Te,ge){if(!ie&&U&&U.indexOf(ge)>-1&&ne[ge]){Te=I(Te),ue[ge]=[];for(let we=0;we<Math.max(Te.length,ne[ge].length);we++)ne[ge][we]&&(Te[we]===void 0?ue[ge][we]=ne[ge][we]:(ue[ge][we]={},H(Te[we],ne[ge][we],ue[ge][we],ie+1)))}else P(Te,!0)&&!Te.nodeType?(ue[ge]=g(Te)?[]:{},H(Te,ne[ge]||{},ue[ge],ie+1),Object.keys(ue[ge]).length!==0||ge==="colorAxis"&&ie===0||delete ue[ge]):(W[ge]!==ne[ge]||ge in W&&!(ge in ne))&&ge!=="__proto__"&&ge!=="constructor"&&(ue[ge]=oe[ge])})}(R,L,F,0),F},discardElement:function(R){R&&R.parentElement&&R.parentElement.removeChild(R)},erase:function(R,L){let G=R.length;for(;G--;)if(R[G]===L){R.splice(G,1);break}},error:b,extend:D,extendClass:function(R,L){let G=function(){};return G.prototype=new R,D(G.prototype,L),G},find:X,fireEvent:V,getClosestDistance:function(R,L){let G,U,F,H=!L;return R.forEach(W=>{if(W.length>1)for(F=W.length-1;F>0;F--)(U=W[F]-W[F-1])<0&&!H?(L==null||L(),L=void 0):U&&(G===void 0||U<G)&&(G=U)}),G},getMagnitude:z,getNestedProperty:function(R,L){let G=R.split(".");for(;G.length&&A(L);){let U=G.shift();if(U===void 0||U==="__proto__")return;if(U==="this"){let H;return P(L)&&(H=L["@this"]),H??L}let F=L[U];if(!A(F)||typeof F=="function"||typeof F.nodeType=="number"||F===f)return;L=F}return L},getStyle:function R(L,G,U){let F;if(G==="width"){let W=Math.min(L.offsetWidth,L.scrollWidth),ne=L.getBoundingClientRect&&L.getBoundingClientRect().width;return ne<W&&ne>=W-1&&(W=Math.floor(ne)),Math.max(0,W-(R(L,"padding-left",!0)||0)-(R(L,"padding-right",!0)||0))}if(G==="height")return Math.max(0,Math.min(L.offsetHeight,L.scrollHeight)-(R(L,"padding-top",!0)||0)-(R(L,"padding-bottom",!0)||0));let H=f.getComputedStyle(L,void 0);return H&&(F=H.getPropertyValue(G),w(U,G!=="opacity")&&(F=x(F))),F},inArray:function(R,L,G){return b(32,!1,void 0,{"Highcharts.inArray":"use Array.indexOf"}),L.indexOf(R,G)},insertItem:function(R,L){let G,U=R.options.index,F=L.length;for(G=R.options.isInternal?F:0;G<F+1;G++)if(!L[G]||k(U)&&U<w(L[G].options.index,L[G]._i)||L[G].options.isInternal){L.splice(G,0,R);break}return G},isArray:g,isClass:S,isDOMElement:_,isFunction:function(R){return typeof R=="function"},isNumber:k,isObject:P,isString:v,keys:function(R){return b(32,!1,void 0,{"Highcharts.keys":"use Object.keys"}),Object.keys(R)},merge:function(){let R,L=arguments,G={},U=function(H,W){return typeof H!="object"&&(H={}),Z(W,function(ne,ue){ue!=="__proto__"&&ue!=="constructor"&&(!P(ne,!0)||S(ne)||_(ne)?H[ue]=W[ue]:H[ue]=U(H[ue]||{},ne))}),H};L[0]===!0&&(G=L[1],L=Array.prototype.slice.call(L,2));let F=L.length;for(R=0;R<F;R++)G=U(G,L[R]);return G},normalizeTickInterval:function(R,L,G,U,F){let H,W=R;G=w(G,z(R));let ne=R/G;for(!L&&(L=F?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],U===!1&&(G===1?L=L.filter(function(ue){return ue%1==0}):G<=.1&&(L=[1/G]))),H=0;H<L.length&&(W=L[H],(!F||!(W*G>=R))&&(F||!(ne<=(L[H]+(L[H+1]||L[H]))/2)));H++);return Y(W*G,-Math.round(Math.log(.001)/Math.LN10))},objectEach:Z,offset:function(R){let L=s.documentElement,G=R.parentElement||R.parentNode?R.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:G.top+(f.pageYOffset||L.scrollTop)-(L.clientTop||0),left:G.left+(f.pageXOffset||L.scrollLeft)-(L.clientLeft||0),width:G.width,height:G.height}},pad:function(R,L,G){return Array((L||2)+1-String(R).replace("-","").length).join(G||"0")+R},pick:w,pInt:x,pushUnique:function(R,L){return 0>R.indexOf(L)&&!!R.push(L)},relativeLength:function(R,L,G){return/%$/.test(R)?L*parseFloat(R)/100+(G||0):parseFloat(R)},removeEvent:j,replaceNested:function(R,...L){let G,U;do for(U of(G=R,L))R=R.replace(U[0],U[1]);while(R!==G);return R},splat:I,stableSort:function(R,L){let G,U,F=R.length;for(U=0;U<F;U++)R[U].safeI=U;for(R.sort(function(H,W){return(G=L(H,W))===0?H.safeI-W.safeI:G}),U=0;U<F;U++)delete R[U].safeI},syncTimeout:function(R,L,G){return L>0?setTimeout(R,L,G):(R.call(0,G),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},uniqueKey:$,useSerialIds:function(R){return h=w(R,h)},wrap:function(R,L,G){let U=R[L];R[L]=function(){let F=arguments,H=this;return G.apply(this,[function(){return U.apply(H,arguments.length?arguments:F)}].concat([].slice.call(arguments)))}}}}),c(t,"Core/Chart/ChartDefaults.js",[],function(){return{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"}}),c(t,"Core/Color/Palettes.js",[],function(){return{colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"]}}),c(t,"Core/Time.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h){let{win:d}=a,{defined:s,error:f,extend:b,isNumber:x,isObject:v,merge:g,objectEach:P,pad:_,pick:S,splat:k,timeUnits:A}=h,y=a.isSafari&&d.Intl&&d.Intl.DateTimeFormat.prototype.formatRange,I=a.isSafari&&d.Intl&&!d.Intl.DateTimeFormat.prototype.formatRange;class D{constructor(M){this.options={},this.useUTC=!1,this.variableTimezone=!1,this.Date=d.Date,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.update(M)}get(M,z){if(this.variableTimezone||this.timezoneOffset){let Y=z.getTime(),X=Y-this.getTimezoneOffset(z);z.setTime(X);let Z=z["getUTC"+M]();return z.setTime(Y),Z}return this.useUTC?z["getUTC"+M]():z["get"+M]()}set(M,z,Y){if(this.variableTimezone||this.timezoneOffset){if(M==="Milliseconds"||M==="Seconds"||M==="Minutes"&&this.getTimezoneOffset(z)%36e5==0)return z["setUTC"+M](Y);let X=this.getTimezoneOffset(z),Z=z.getTime()-X;z.setTime(Z),z["setUTC"+M](Y);let j=this.getTimezoneOffset(z);return Z=z.getTime()+j,z.setTime(Z)}return this.useUTC||y&&M==="FullYear"?z["setUTC"+M](Y):z["set"+M](Y)}update(M={}){let z=S(M.useUTC,!0);this.options=M=g(!0,this.options,M),this.Date=M.Date||d.Date||Date,this.useUTC=z,this.timezoneOffset=z&&M.timezoneOffset||void 0,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.variableTimezone=z&&!!(M.getTimezoneOffset||M.timezone)}makeTime(M,z,Y,X,Z,j){let V,$,R;return this.useUTC?(V=this.Date.UTC.apply(0,arguments),$=this.getTimezoneOffset(V),V+=$,$!==(R=this.getTimezoneOffset(V))?V+=R-$:$-36e5!==this.getTimezoneOffset(V-36e5)||I||(V-=36e5)):V=new this.Date(M,z,S(Y,1),S(X,0),S(Z,0),S(j,0)).getTime(),V}timezoneOffsetFunction(){let M=this,z=this.options,Y=z.getTimezoneOffset;return this.useUTC?z.timezone?X=>{try{let Z=`shortOffset,${z.timezone||""}`,[j,V,$,R,L=0]=(D.formatCache[Z]=D.formatCache[Z]||Intl.DateTimeFormat("en",{timeZone:z.timezone,timeZoneName:"shortOffset"})).format(X).split(/(GMT|:)/).map(Number),G=-(36e5*($+L/60));if(x(G))return G}catch{f(34)}return 0}:this.useUTC&&Y?X=>6e4*Y(X.valueOf()):()=>6e4*(M.timezoneOffset||0):X=>6e4*new Date(X.toString()).getTimezoneOffset()}dateFormat(M,z,Y){if(!s(z)||isNaN(z))return a.defaultOptions.lang&&a.defaultOptions.lang.invalidDate||"";M=S(M,"%Y-%m-%d %H:%M:%S");let X=this,Z=new this.Date(z),j=this.get("Hours",Z),V=this.get("Day",Z),$=this.get("Date",Z),R=this.get("Month",Z),L=this.get("FullYear",Z),G=a.defaultOptions.lang,U=G&&G.weekdays,F=G&&G.shortWeekdays;return P(b({a:F?F[V]:U[V].substr(0,3),A:U[V],d:_($),e:_($,2," "),w:V,b:G.shortMonths[R],B:G.months[R],m:_(R+1),o:R+1,y:L.toString().substr(2,2),Y:L,H:_(j),k:j,I:_(j%12||12),l:j%12||12,M:_(this.get("Minutes",Z)),p:j<12?"AM":"PM",P:j<12?"am":"pm",S:_(this.get("Seconds",Z)),L:_(Math.floor(z%1e3),3)},a.dateFormats),function(H,W){for(;M.indexOf("%"+W)!==-1;)M=M.replace("%"+W,typeof H=="function"?H.call(X,z):H)}),Y?M.substr(0,1).toUpperCase()+M.substr(1):M}resolveDTLFormat(M){return v(M,!0)?M:{main:(M=k(M))[0],from:M[1],to:M[2]}}getTimeTicks(M,z,Y,X){let Z,j,V,$,R=this,L=R.Date,G=[],U={},F=new L(z),H=M.unitRange,W=M.count||1;if(X=S(X,1),s(z)){R.set("Milliseconds",F,H>=A.second?0:W*Math.floor(R.get("Milliseconds",F)/W)),H>=A.second&&R.set("Seconds",F,H>=A.minute?0:W*Math.floor(R.get("Seconds",F)/W)),H>=A.minute&&R.set("Minutes",F,H>=A.hour?0:W*Math.floor(R.get("Minutes",F)/W)),H>=A.hour&&R.set("Hours",F,H>=A.day?0:W*Math.floor(R.get("Hours",F)/W)),H>=A.day&&R.set("Date",F,H>=A.month?1:Math.max(1,W*Math.floor(R.get("Date",F)/W))),H>=A.month&&(R.set("Month",F,H>=A.year?0:W*Math.floor(R.get("Month",F)/W)),j=R.get("FullYear",F)),H>=A.year&&(j-=j%W,R.set("FullYear",F,j)),H===A.week&&($=R.get("Day",F),R.set("Date",F,R.get("Date",F)-$+X+($<X?-7:0))),j=R.get("FullYear",F);let ne=R.get("Month",F),ue=R.get("Date",F),ie=R.get("Hours",F);z=F.getTime(),(R.variableTimezone||!R.useUTC)&&s(Y)&&(V=Y-z>4*A.month||R.getTimezoneOffset(z)!==R.getTimezoneOffset(Y));let oe=F.getTime();for(Z=1;oe<Y;)G.push(oe),H===A.year?oe=R.makeTime(j+Z*W,0):H===A.month?oe=R.makeTime(j,ne+Z*W):V&&(H===A.day||H===A.week)?oe=R.makeTime(j,ne,ue+Z*W*(H===A.day?1:7)):V&&H===A.hour&&W>1?oe=R.makeTime(j,ne,ue,ie+Z*W):oe+=H*W,Z++;G.push(oe),H<=A.hour&&G.length<1e4&&G.forEach(function(Te){Te%18e5==0&&R.dateFormat("%H%M%S%L",Te)==="000000000"&&(U[Te]="day")})}return G.info=b(M,{higherRanks:U,totalRange:H*W}),G}getDateFormat(M,z,Y,X){let Z=this.dateFormat("%m-%d %H:%M:%S.%L",z),j="01-01 00:00:00.000",V={millisecond:15,second:12,minute:9,hour:6,day:3},$="millisecond",R=$;for($ in A){if(M===A.week&&+this.dateFormat("%w",z)===Y&&Z.substr(6)===j.substr(6)){$="week";break}if(A[$]>M){$=R;break}if(V[$]&&Z.substr(V[$])!==j.substr(V[$]))break;$!=="week"&&(R=$)}return this.resolveDTLFormat(X[$]).main}}return D.formatCache={},D}),c(t,"Core/Defaults.js",[t["Core/Chart/ChartDefaults.js"],t["Core/Globals.js"],t["Core/Color/Palettes.js"],t["Core/Time.js"],t["Core/Utilities.js"]],function(a,h,d,s,f){let{isTouchDevice:b}=h,{fireEvent:x,merge:v}=f,g={colors:d.colors,symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{buttonTheme:{fill:"#f7f7f7",padding:8,r:2,stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontSize:"0.8em",fontWeight:"normal"},states:{hover:{fill:"#e6e6e6"},select:{fill:"#e6e9ff",style:{color:"#000000",fontWeight:"bold"}},disabled:{style:{color:"#cccccc"}}}}},time:{Date:void 0,getTimezoneOffset:void 0,timezone:void 0,timezoneOffset:0,useUTC:!0},chart:a,title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:"",align:"center",widthAdjust:-44},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",events:{},layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:{duration:300,easing:_=>Math.sqrt(1-Math.pow(_-1,2))},borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %e %b, %H:%M:%S.%L",second:"%A, %e %b, %H:%M:%S",minute:"%A, %e %b, %H:%M",hour:"%A, %e %b, %H:%M",day:"%A, %e %b %Y",week:"Week from %A, %e %b %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,shape:"callout",shared:!1,snap:b?25:10,headerFormat:'<span style="font-size: 0.8em">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,shadow:!0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}};g.chart.styledMode=!1;let P=new s(g.time);return{defaultOptions:g,defaultTime:P,getOptions:function(){return g},setOptions:function(_){return x(h,"setOptions",{options:_}),v(!0,g,_),(_.time||_.global)&&(h.time?h.time.update(v(g.global,g.time,_.global,_.time)):h.time=P),g}}}),c(t,"Core/Color/Color.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h){let{isNumber:d,merge:s,pInt:f}=h;class b{static parse(v){return v?new b(v):b.None}constructor(v){let g,P,_,S;this.rgba=[NaN,NaN,NaN,NaN],this.input=v;let k=a.Color;if(k&&k!==b)return new k(v);if(typeof v=="object"&&v.stops!==void 0)this.stops=v.stops.map(A=>new b(A[1]));else if(typeof v=="string"){if(this.input=v=b.names[v.toLowerCase()]||v,v.charAt(0)==="#"){let A=v.length,y=parseInt(v.substr(1),16);A===7?P=[(16711680&y)>>16,(65280&y)>>8,255&y,1]:A===4&&(P=[(3840&y)>>4|(3840&y)>>8,(240&y)>>4|240&y,(15&y)<<4|15&y,1])}if(!P)for(_=b.parsers.length;_--&&!P;)(g=(S=b.parsers[_]).regex.exec(v))&&(P=S.parse(g))}P&&(this.rgba=P)}get(v){let g=this.input,P=this.rgba;if(typeof g=="object"&&this.stops!==void 0){let _=s(g);return _.stops=[].slice.call(_.stops),this.stops.forEach((S,k)=>{_.stops[k]=[_.stops[k][0],S.get(v)]}),_}return P&&d(P[0])?v!=="rgb"&&(v||P[3]!==1)?v==="a"?`${P[3]}`:"rgba("+P.join(",")+")":"rgb("+P[0]+","+P[1]+","+P[2]+")":g}brighten(v){let g=this.rgba;if(this.stops)this.stops.forEach(function(P){P.brighten(v)});else if(d(v)&&v!==0)for(let P=0;P<3;P++)g[P]+=f(255*v),g[P]<0&&(g[P]=0),g[P]>255&&(g[P]=255);return this}setOpacity(v){return this.rgba[3]=v,this}tweenTo(v,g){let P=this.rgba,_=v.rgba;if(!d(P[0])||!d(_[0]))return v.input||"none";let S=_[3]!==1||P[3]!==1;return(S?"rgba(":"rgb(")+Math.round(_[0]+(P[0]-_[0])*(1-g))+","+Math.round(_[1]+(P[1]-_[1])*(1-g))+","+Math.round(_[2]+(P[2]-_[2])*(1-g))+(S?","+(_[3]+(P[3]-_[3])*(1-g)):"")+")"}}return b.names={white:"#ffffff",black:"#000000"},b.parsers=[{regex:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?(?:\.\d+)?)\s*\)/,parse:function(x){return[f(x[1]),f(x[2]),f(x[3]),parseFloat(x[4],10)]}},{regex:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/,parse:function(x){return[f(x[1]),f(x[2]),f(x[3]),1]}}],b.None=new b(""),b}),c(t,"Core/Animation/Fx.js",[t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h,d){let{parse:s}=a,{win:f}=h,{isNumber:b,objectEach:x}=d;class v{constructor(P,_,S){this.pos=NaN,this.options=_,this.elem=P,this.prop=S}dSetter(){let P=this.paths,_=P&&P[0],S=P&&P[1],k=this.now||0,A=[];if(k!==1&&_&&S)if(_.length===S.length&&k<1)for(let y=0;y<S.length;y++){let I=_[y],D=S[y],w=[];for(let M=0;M<D.length;M++){let z=I[M],Y=D[M];b(z)&&b(Y)&&!(D[0]==="A"&&(M===4||M===5))?w[M]=z+k*(Y-z):w[M]=Y}A.push(w)}else A=S;else A=this.toD||[];this.elem.attr("d",A,void 0,!0)}update(){let P=this.elem,_=this.prop,S=this.now,k=this.options.step;this[_+"Setter"]?this[_+"Setter"]():P.attr?P.element&&P.attr(_,S,null,!0):P.style[_]=S+this.unit,k&&k.call(P,S,this)}run(P,_,S){let k=this,A=k.options,y=function(w){return!y.stopped&&k.step(w)},I=f.requestAnimationFrame||function(w){setTimeout(w,13)},D=function(){for(let w=0;w<v.timers.length;w++)v.timers[w]()||v.timers.splice(w--,1);v.timers.length&&I(D)};P!==_||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=P,this.end=_,this.unit=S,this.now=this.start,this.pos=0,y.elem=this.elem,y.prop=this.prop,y()&&v.timers.push(y)===1&&I(D)):(delete A.curAnim[this.prop],A.complete&&Object.keys(A.curAnim).length===0&&A.complete.call(this.elem))}step(P){let _,S,k=+new Date,A=this.options,y=this.elem,I=A.complete,D=A.duration,w=A.curAnim;return y.attr&&!y.element?_=!1:P||k>=D+this.startTime?(this.now=this.end,this.pos=1,this.update(),w[this.prop]=!0,S=!0,x(w,function(M){M!==!0&&(S=!1)}),S&&I&&I.call(y),_=!1):(this.pos=A.easing((k-this.startTime)/D),this.now=this.start+(this.end-this.start)*this.pos,this.update(),_=!0),_}initPath(P,_,S){let k=P.startX,A=P.endX,y=S.slice(),I=P.isArea,D=I?2:1,w=_&&S.length>_.length&&S.hasStackedCliffs,M,z,Y,X,Z=_&&_.slice();if(!Z||w)return[y,y];function j($,R){for(;$.length<z;){let L=$[0],G=R[z-$.length];if(G&&L[0]==="M"&&(G[0]==="C"?$[0]=["C",L[1],L[2],L[1],L[2],L[1],L[2]]:$[0]=["L",L[1],L[2]]),$.unshift(L),I){let U=$.pop();$.push($[$.length-1],U)}}}function V($){for(;$.length<z;){let R=$[Math.floor($.length/D)-1].slice();if(R[0]==="C"&&(R[1]=R[5],R[2]=R[6]),I){let L=$[Math.floor($.length/D)].slice();$.splice($.length/2,0,R,L)}else $.push(R)}}if(k&&A&&A.length){for(Y=0;Y<k.length;Y++){if(k[Y]===A[0]){M=Y;break}if(k[0]===A[A.length-k.length+Y]){M=Y,X=!0;break}if(k[k.length-1]===A[A.length-k.length+Y]){M=k.length-Y;break}}M===void 0&&(Z=[])}return Z.length&&b(M)&&(z=y.length+M*D,X?(j(Z,y),V(y)):(j(y,Z),V(Z))),[Z,y]}fillSetter(){v.prototype.strokeSetter.apply(this,arguments)}strokeSetter(){this.elem.attr(this.prop,s(this.start).tweenTo(s(this.end),this.pos),void 0,!0)}}return v.timers=[],v}),c(t,"Core/Animation/AnimationUtilities.js",[t["Core/Animation/Fx.js"],t["Core/Utilities.js"]],function(a,h){let{defined:d,getStyle:s,isArray:f,isNumber:b,isObject:x,merge:v,objectEach:g,pick:P}=h;function _(k){return x(k)?v({duration:500,defer:0},k):{duration:k?500:0,defer:0}}function S(k,A){let y=a.timers.length;for(;y--;)a.timers[y].elem!==k||A&&A!==a.timers[y].prop||(a.timers[y].stopped=!0)}return{animate:function(k,A,y){let I,D="",w,M,z;x(y)||(z=arguments,y={duration:z[2],easing:z[3],complete:z[4]}),b(y.duration)||(y.duration=400),y.easing=typeof y.easing=="function"?y.easing:Math[y.easing]||Math.easeInOutSine,y.curAnim=v(A),g(A,function(Y,X){S(k,X),M=new a(k,y,X),w=void 0,X==="d"&&f(A.d)?(M.paths=M.initPath(k,k.pathArray,A.d),M.toD=A.d,I=0,w=1):k.attr?I=k.attr(X):(I=parseFloat(s(k,X))||0,X!=="opacity"&&(D="px")),w||(w=Y),typeof w=="string"&&w.match("px")&&(w=w.replace(/px/g,"")),M.run(I,w,D)})},animObject:_,getDeferredAnimation:function(k,A,y){let I=_(A),D=y?[y]:k.series,w=0,M=0;return D.forEach(z=>{let Y=_(z.options.animation);w=x(A)&&d(A.defer)?I.defer:Math.max(w,Y.duration+Y.defer),M=Math.min(I.duration,Y.duration)}),k.renderer.forExport&&(w=0),{defer:Math.max(0,w-M),duration:Math.min(w,M)}},setAnimation:function(k,A){A.renderer.globalAnimation=P(k,A.options.chart.animation,!0)},stop:S}}),c(t,"Core/Renderer/HTML/AST.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h){let{SVG_NS:d,win:s}=a,{attr:f,createElement:b,css:x,error:v,isFunction:g,isString:P,objectEach:_,splat:S}=h,{trustedTypes:k}=s,A=k&&g(k.createPolicy)&&k.createPolicy("highcharts",{createHTML:w=>w}),y=A?A.createHTML(""):"",I=function(){try{return!!new DOMParser().parseFromString(y,"text/html")}catch{return!1}}();class D{static filterUserAttributes(M){return _(M,(z,Y)=>{let X=!0;D.allowedAttributes.indexOf(Y)===-1&&(X=!1),["background","dynsrc","href","lowsrc","src"].indexOf(Y)!==-1&&(X=P(z)&&D.allowedReferences.some(Z=>z.indexOf(Z)===0)),X||(v(33,!1,void 0,{"Invalid attribute in config":`${Y}`}),delete M[Y]),P(z)&&M[Y]&&(M[Y]=z.replace(/</g,"&lt;"))}),M}static parseStyle(M){return M.split(";").reduce((z,Y)=>{let X=Y.split(":").map(j=>j.trim()),Z=X.shift();return Z&&X.length&&(z[Z.replace(/-([a-z])/g,j=>j[1].toUpperCase())]=X.join(":")),z},{})}static setElementHTML(M,z){M.innerHTML=D.emptyHTML,z&&new D(z).addToDOM(M)}constructor(M){this.nodes=typeof M=="string"?this.parseMarkup(M):M}addToDOM(M){return function z(Y,X){let Z;return S(Y).forEach(function(j){let V,$=j.tagName,R=j.textContent?a.doc.createTextNode(j.textContent):void 0,L=D.bypassHTMLFiltering;if($)if($==="#text")V=R;else if(D.allowedTags.indexOf($)!==-1||L){let G=$==="svg"?d:X.namespaceURI||d,U=a.doc.createElementNS(G,$),F=j.attributes||{};_(j,function(H,W){W!=="tagName"&&W!=="attributes"&&W!=="children"&&W!=="style"&&W!=="textContent"&&(F[W]=H)}),f(U,L?F:D.filterUserAttributes(F)),j.style&&x(U,j.style),R&&U.appendChild(R),z(j.children||[],U),V=U}else v(33,!1,void 0,{"Invalid tagName in config":$});V&&X.appendChild(V),Z=V}),Z}(this.nodes,M)}parseMarkup(M){let z,Y=[];if(M=M.trim().replace(/ style=(["'])/g," data-style=$1"),I)z=new DOMParser().parseFromString(A?A.createHTML(M):M,"text/html");else{let Z=b("div");Z.innerHTML=M,z={body:Z}}let X=(Z,j)=>{let V=Z.nodeName.toLowerCase(),$={tagName:V};V==="#text"&&($.textContent=Z.textContent||"");let R=Z.attributes;if(R){let L={};[].forEach.call(R,G=>{G.name==="data-style"?$.style=D.parseStyle(G.value):L[G.name]=G.value}),$.attributes=L}if(Z.childNodes.length){let L=[];[].forEach.call(Z.childNodes,G=>{X(G,L)}),L.length&&($.children=L)}j.push($)};return[].forEach.call(z.body.childNodes,Z=>X(Z,Y)),Y}}return D.allowedAttributes=["alt","aria-controls","aria-describedby","aria-expanded","aria-haspopup","aria-hidden","aria-label","aria-labelledby","aria-live","aria-pressed","aria-readonly","aria-roledescription","aria-selected","class","clip-path","color","colspan","cx","cy","d","dx","dy","disabled","fill","filterUnits","flood-color","flood-opacity","height","href","id","in","in2","markerHeight","markerWidth","offset","opacity","operator","orient","padding","paddingLeft","paddingRight","patternUnits","r","radius","refX","refY","role","scope","slope","src","startOffset","stdDeviation","stroke","stroke-linecap","stroke-width","style","tableValues","result","rowspan","summary","target","tabindex","text-align","text-anchor","textAnchor","textLength","title","type","valign","width","x","x1","x2","xlink:href","y","y1","y2","zIndex"],D.allowedReferences=["https://","http://","mailto:","/","../","./","#"],D.allowedTags=["a","abbr","b","br","button","caption","circle","clipPath","code","dd","defs","div","dl","dt","em","feComponentTransfer","feComposite","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMorphology","feOffset","feMerge","feMergeNode","filter","h1","h2","h3","h4","h5","h6","hr","i","img","li","linearGradient","marker","ol","p","path","pattern","pre","rect","small","span","stop","strong","style","sub","sup","svg","table","text","textPath","thead","title","tbody","tspan","td","th","tr","u","ul","#text"],D.emptyHTML=y,D.bypassHTMLFiltering=!1,D}),c(t,"Core/Templating.js",[t["Core/Defaults.js"],t["Core/Utilities.js"]],function(a,h){let{defaultOptions:d,defaultTime:s}=a,{extend:f,getNestedProperty:b,isArray:x,isNumber:v,isObject:g,pick:P,pInt:_}=h,S={add:(y,I)=>y+I,divide:(y,I)=>I!==0?y/I:"",eq:(y,I)=>y==I,each:function(y){let I=arguments[arguments.length-1];return!!x(y)&&y.map((D,w)=>k(I.body,f(g(D)?D:{"@this":D},{"@index":w,"@first":w===0,"@last":w===y.length-1}))).join("")},ge:(y,I)=>y>=I,gt:(y,I)=>y>I,if:y=>!!y,le:(y,I)=>y<=I,lt:(y,I)=>y<I,multiply:(y,I)=>y*I,ne:(y,I)=>y!=I,subtract:(y,I)=>y-I,unless:y=>!y};function k(y="",I,D){let w=/\{([\w\:\.\,;\-\/<>%@"'’= #\(\)]+)\}/g,M=/\(([\w\:\.\,;\-\/<>%@"'= ]+)\)/g,z=[],Y=/f$/,X=/\.(\d)/,Z=d.lang,j=D&&D.time||s,V=D&&D.numberFormatter||A,$=(F="")=>{let H;return F==="true"||F!=="false"&&((H=Number(F)).toString()===F?H:b(F,I))},R,L,G=0,U;for(;(R=w.exec(y))!==null;){let F=M.exec(R[1]);F&&(R=F,U=!0),L&&L.isBlock||(L={ctx:I,expression:R[1],find:R[0],isBlock:R[1].charAt(0)==="#",start:R.index,startInner:R.index+R[0].length,length:R[0].length});let H=R[1].split(" ")[0].replace("#","");S[H]&&(L.isBlock&&H===L.fn&&G++,L.fn||(L.fn=H));let W=R[1]==="else";if(L.isBlock&&L.fn&&(R[1]===`/${L.fn}`||W))if(G)!W&&G--;else{let ne=L.startInner,ue=y.substr(ne,R.index-ne);L.body===void 0?(L.body=ue,L.startInner=R.index+R[0].length):L.elseBody=ue,L.find+=ue+R[0],W||(z.push(L),L=void 0)}else L.isBlock||z.push(L);if(F&&!(L!=null&&L.isBlock))break}return z.forEach(F=>{let H,W,{body:ne,elseBody:ue,expression:ie,fn:oe}=F;if(oe){let Te=[F],ge=ie.split(" ");for(W=S[oe].length;W--;)Te.unshift($(ge[W+1]));H=S[oe].apply(I,Te),F.isBlock&&typeof H=="boolean"&&(H=k(H?ne:ue,I,D))}else{let Te=ie.split(":");if(H=$(Te.shift()||""),Te.length&&typeof H=="number"){let ge=Te.join(":");if(Y.test(ge)){let we=parseInt((ge.match(X)||["","-1"])[1],10);H!==null&&(H=V(H,we,Z.decimalPoint,ge.indexOf(",")>-1?Z.thousandsSep:""))}else H=j.dateFormat(ge,H)}}y=y.replace(F.find,P(H,""))}),U?k(y,I,D):y}function A(y,I,D,w){let M,z;y=+y||0,I=+I;let Y=d.lang,X=(y.toString().split(".")[1]||"").split("e")[0].length,Z=y.toString().split("e"),j=I;I===-1?I=Math.min(X,20):v(I)?I&&Z[1]&&Z[1]<0&&((z=I+ +Z[1])>=0?(Z[0]=(+Z[0]).toExponential(z).split("e")[0],I=z):(Z[0]=Z[0].split(".")[0]||0,y=I<20?(Z[0]*Math.pow(10,Z[1])).toFixed(I):0,Z[1]=0)):I=2;let V=(Math.abs(Z[1]?Z[0]:y)+Math.pow(10,-Math.max(I,X)-1)).toFixed(I),$=String(_(V)),R=$.length>3?$.length%3:0;return D=P(D,Y.decimalPoint),w=P(w,Y.thousandsSep),M=(y<0?"-":"")+(R?$.substr(0,R)+w:""),0>+Z[1]&&!j?M="0":M+=$.substr(R).replace(/(\d{3})(?=\d)/g,"$1"+w),I?M+=D+V.slice(-I):+M==0&&(M="0"),Z[1]&&+M!=0&&(M+="e"+Z[1]),M}return{dateFormat:function(y,I,D){return s.dateFormat(y,I,D)},format:k,helpers:S,numberFormat:A}}),c(t,"Core/Renderer/RendererRegistry.js",[t["Core/Globals.js"]],function(a){var h,d;let s;return(d=h||(h={})).rendererTypes={},d.getRendererType=function(f=s){return d.rendererTypes[f]||d.rendererTypes[s]},d.registerRendererType=function(f,b,x){d.rendererTypes[f]=b,(!s||x)&&(s=f,a.Renderer=b)},h}),c(t,"Core/Renderer/RendererUtilities.js",[t["Core/Utilities.js"]],function(a){var h;let{clamp:d,pick:s,pushUnique:f,stableSort:b}=a;return(h||(h={})).distribute=function x(v,g,P){let _=v,S=_.reducedLen||g,k=($,R)=>$.target-R.target,A=[],y=v.length,I=[],D=A.push,w,M,z,Y=!0,X,Z,j=0,V;for(w=y;w--;)j+=v[w].size;if(j>S){for(b(v,($,R)=>(R.rank||0)-($.rank||0)),z=(V=v[0].rank===v[v.length-1].rank)?y/2:-1,M=V?z:y-1;z&&j>S;)X=v[w=Math.floor(M)],f(I,w)&&(j-=X.size),M+=z,V&&M>=v.length&&(z/=2,M=z);I.sort(($,R)=>R-$).forEach($=>D.apply(A,v.splice($,1)))}for(b(v,k),v=v.map($=>({size:$.size,targets:[$.target],align:s($.align,.5)}));Y;){for(w=v.length;w--;)X=v[w],Z=(Math.min.apply(0,X.targets)+Math.max.apply(0,X.targets))/2,X.pos=d(Z-X.size*X.align,0,g-X.size);for(w=v.length,Y=!1;w--;)w>0&&v[w-1].pos+v[w-1].size>v[w].pos&&(v[w-1].size+=v[w].size,v[w-1].targets=v[w-1].targets.concat(v[w].targets),v[w-1].align=.5,v[w-1].pos+v[w-1].size>g&&(v[w-1].pos=g-v[w-1].size),v.splice(w,1),Y=!0)}return D.apply(_,A),w=0,v.some($=>{let R=0;return($.targets||[]).some(()=>(_[w].pos=$.pos+R,P!==void 0&&Math.abs(_[w].pos-_[w].target)>P?(_.slice(0,w+1).forEach(L=>delete L.pos),_.reducedLen=(_.reducedLen||g)-.1*g,_.reducedLen>.1*g&&x(_,g,P),!0):(R+=_[w].size,w++,!1)))}),b(_,k),_},h}),c(t,"Core/Renderer/SVG/SVGElement.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h,d,s){let{animate:f,animObject:b,stop:x}=a,{deg2rad:v,doc:g,svg:P,SVG_NS:_,win:S}=d,{addEvent:k,attr:A,createElement:y,crisp:I,css:D,defined:w,erase:M,extend:z,fireEvent:Y,isArray:X,isFunction:Z,isObject:j,isString:V,merge:$,objectEach:R,pick:L,pInt:G,pushUnique:U,replaceNested:F,syncTimeout:H,uniqueKey:W}=s;class ne{_defaultGetter(ie){let oe=L(this[ie+"Value"],this[ie],this.element?this.element.getAttribute(ie):null,0);return/^-?[\d\.]+$/.test(oe)&&(oe=parseFloat(oe)),oe}_defaultSetter(ie,oe,Te){Te.setAttribute(oe,ie)}add(ie){let oe,Te=this.renderer,ge=this.element;return ie&&(this.parentGroup=ie),this.textStr!==void 0&&this.element.nodeName==="text"&&Te.buildText(this),this.added=!0,(!ie||ie.handleZ||this.zIndex)&&(oe=this.zIndexSetter()),oe||(ie?ie.element:Te.box).appendChild(ge),this.onAdd&&this.onAdd(),this}addClass(ie,oe){let Te=oe?"":this.attr("class")||"";return(ie=(ie||"").split(/ /g).reduce(function(ge,we){return Te.indexOf(we)===-1&&ge.push(we),ge},Te?[Te]:[]).join(" "))!==Te&&this.attr("class",ie),this}afterSetters(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)}align(ie,oe,Te,ge=!0){let we,K,Q,ae,ye={},J=this.renderer,re=J.alignedObjects,ce=!!ie;ie?(this.alignOptions=ie,this.alignByTranslate=oe,this.alignTo=Te):(ie=this.alignOptions||{},oe=this.alignByTranslate,Te=this.alignTo);let pe=!Te||V(Te)?Te||"renderer":void 0;pe&&(ce&&U(re,this),Te=void 0);let xe=L(Te,J[pe],J),Me=ie.align,_e=ie.verticalAlign;return we=(xe.x||0)+(ie.x||0),K=(xe.y||0)+(ie.y||0),Me==="right"?Q=1:Me==="center"&&(Q=2),Q&&(we+=((xe.width||0)-(ie.width||0))/Q),ye[oe?"translateX":"x"]=Math.round(we),_e==="bottom"?ae=1:_e==="middle"&&(ae=2),ae&&(K+=((xe.height||0)-(ie.height||0))/ae),ye[oe?"translateY":"y"]=Math.round(K),ge&&(this[this.placed?"animate":"attr"](ye),this.placed=!0),this.alignAttr=ye,this}alignSetter(ie){let oe={left:"start",center:"middle",right:"end"};oe[ie]&&(this.alignValue=ie,this.element.setAttribute("text-anchor",oe[ie]))}animate(ie,oe,Te){let ge=b(L(oe,this.renderer.globalAnimation,!0)),we=ge.defer;return g.hidden&&(ge.duration=0),ge.duration!==0?(Te&&(ge.complete=Te),H(()=>{this.element&&f(this,ie,ge)},we)):(this.attr(ie,void 0,Te||ge.complete),R(ie,function(K,Q){ge.step&&ge.step.call(this,K,{prop:Q,pos:1,elem:this})},this)),this}applyTextOutline(ie){let oe=this.element;ie.indexOf("contrast")!==-1&&(ie=ie.replace(/contrast/g,this.renderer.getContrast(oe.style.fill)));let Te=ie.split(" "),ge=Te[Te.length-1],we=Te[0];if(we&&we!=="none"&&d.svg){this.fakeTS=!0,we=we.replace(/(^[\d\.]+)(.*?)$/g,function(J,re,ce){return 2*Number(re)+ce}),this.removeTextOutline();let K=g.createElementNS(_,"tspan");A(K,{class:"highcharts-text-outline",fill:ge,stroke:ge,"stroke-width":we,"stroke-linejoin":"round"});let Q=oe.querySelector("textPath")||oe;[].forEach.call(Q.childNodes,J=>{let re=J.cloneNode(!0);re.removeAttribute&&["fill","stroke","stroke-width","stroke"].forEach(ce=>re.removeAttribute(ce)),K.appendChild(re)});let ae=0;[].forEach.call(Q.querySelectorAll("text tspan"),J=>{ae+=Number(J.getAttribute("dy"))});let ye=g.createElementNS(_,"tspan");ye.textContent="​",A(ye,{x:Number(oe.getAttribute("x")),dy:-ae}),K.appendChild(ye),Q.insertBefore(K,Q.firstChild)}}attr(ie,oe,Te,ge){let{element:we}=this,K=ne.symbolCustomAttribs,Q,ae,ye=this,J;return typeof ie=="string"&&oe!==void 0&&(Q=ie,(ie={})[Q]=oe),typeof ie=="string"?ye=(this[ie+"Getter"]||this._defaultGetter).call(this,ie,we):(R(ie,function(re,ce){J=!1,ge||x(this,ce),this.symbolName&&K.indexOf(ce)!==-1&&(ae||(this.symbolAttr(ie),ae=!0),J=!0),this.rotation&&(ce==="x"||ce==="y")&&(this.doTransform=!0),J||(this[ce+"Setter"]||this._defaultSetter).call(this,re,ce,we)},this),this.afterSetters()),Te&&Te.call(this),ye}clip(ie){if(ie&&!ie.clipPath){let oe=W()+"-",Te=this.renderer.createElement("clipPath").attr({id:oe}).add(this.renderer.defs);z(ie,{clipPath:Te,id:oe,count:0}),ie.add(Te)}return this.attr("clip-path",ie?`url(${this.renderer.url}#${ie.id})`:"none")}crisp(ie,oe){oe=Math.round(oe||ie.strokeWidth||0);let Te=ie.x||this.x||0,ge=ie.y||this.y||0,we=(ie.width||this.width||0)+Te,K=(ie.height||this.height||0)+ge,Q=I(Te,oe),ae=I(ge,oe);return z(ie,{x:Q,y:ae,width:I(we,oe)-Q,height:I(K,oe)-ae}),w(ie.strokeWidth)&&(ie.strokeWidth=oe),ie}complexColor(ie,oe,Te){let ge=this.renderer,we,K,Q,ae,ye,J,re,ce,pe,xe,Me=[],_e;Y(this.renderer,"complexColor",{args:arguments},function(){if(ie.radialGradient?K="radialGradient":ie.linearGradient&&(K="linearGradient"),K){if(Q=ie[K],ye=ge.gradients,J=ie.stops,pe=Te.radialReference,X(Q)&&(ie[K]=Q={x1:Q[0],y1:Q[1],x2:Q[2],y2:Q[3],gradientUnits:"userSpaceOnUse"}),K==="radialGradient"&&pe&&!w(Q.gradientUnits)&&(ae=Q,Q=$(Q,ge.getRadialAttr(pe,ae),{gradientUnits:"userSpaceOnUse"})),R(Q,function(Ce,Le){Le!=="id"&&Me.push(Le,Ce)}),R(J,function(Ce){Me.push(Ce)}),ye[Me=Me.join(",")])xe=ye[Me].attr("id");else{Q.id=xe=W();let Ce=ye[Me]=ge.createElement(K).attr(Q).add(ge.defs);Ce.radAttr=ae,Ce.stops=[],J.forEach(function(Le){Le[1].indexOf("rgba")===0?(re=(we=h.parse(Le[1])).get("rgb"),ce=we.get("a")):(re=Le[1],ce=1);let Ue=ge.createElement("stop").attr({offset:Le[0],"stop-color":re,"stop-opacity":ce}).add(Ce);Ce.stops.push(Ue)})}_e="url("+ge.url+"#"+xe+")",Te.setAttribute(oe,_e),Te.gradient=Me,ie.toString=function(){return _e}}})}css(ie){let oe=this.styles,Te={},ge=this.element,we,K=!oe;if(oe&&R(ie,function(Q,ae){oe&&oe[ae]!==Q&&(Te[ae]=Q,K=!0)}),K){oe&&(ie=z(oe,Te)),ie.width===null||ie.width==="auto"?delete this.textWidth:ge.nodeName.toLowerCase()==="text"&&ie.width&&(we=this.textWidth=G(ie.width)),z(this.styles,ie),we&&!P&&this.renderer.forExport&&delete ie.width;let Q=$(ie);ge.namespaceURI===this.SVG_NS&&(["textOutline","textOverflow","width"].forEach(ae=>Q&&delete Q[ae]),Q.color&&(Q.fill=Q.color)),D(ge,Q)}return this.added&&(this.element.nodeName==="text"&&this.renderer.buildText(this),ie.textOutline&&this.applyTextOutline(ie.textOutline)),this}dashstyleSetter(ie){let oe,Te=this["stroke-width"];if(Te==="inherit"&&(Te=1),ie=ie&&ie.toLowerCase()){let ge=ie.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(oe=ge.length;oe--;)ge[oe]=""+G(ge[oe])*L(Te,NaN);ie=ge.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",ie)}}destroy(){var ae;let ie=this,oe=ie.element||{},Te=ie.renderer,ge=oe.ownerSVGElement,we=oe.nodeName==="SPAN"&&ie.parentGroup||void 0,K,Q;if(oe.onclick=oe.onmouseout=oe.onmouseover=oe.onmousemove=oe.point=null,x(ie),ie.clipPath&&ge){let ye=ie.clipPath;[].forEach.call(ge.querySelectorAll("[clip-path],[CLIP-PATH]"),function(J){J.getAttribute("clip-path").indexOf(ye.element.id)>-1&&J.removeAttribute("clip-path")}),ie.clipPath=ye.destroy()}if(ie.connector=(ae=ie.connector)==null?void 0:ae.destroy(),ie.stops){for(Q=0;Q<ie.stops.length;Q++)ie.stops[Q].destroy();ie.stops.length=0,ie.stops=void 0}for(ie.safeRemoveChild(oe);we&&we.div&&we.div.childNodes.length===0;)K=we.parentGroup,ie.safeRemoveChild(we.div),delete we.div,we=K;ie.alignOptions&&M(Te.alignedObjects,ie),R(ie,function(ye,J){ie[J]&&ie[J].parentGroup===ie&&ie[J].destroy&&ie[J].destroy(),delete ie[J]})}dSetter(ie,oe,Te){X(ie)&&(typeof ie[0]=="string"&&(ie=this.renderer.pathToSegments(ie)),this.pathArray=ie,ie=ie.reduce((ge,we,K)=>we&&we.join?(K?ge+" ":"")+we.join(" "):(we||"").toString(),"")),/(NaN| {2}|^$)/.test(ie)&&(ie="M 0 0"),this[oe]!==ie&&(Te.setAttribute(oe,ie),this[oe]=ie)}fillSetter(ie,oe,Te){typeof ie=="string"?Te.setAttribute(oe,ie):ie&&this.complexColor(ie,oe,Te)}hrefSetter(ie,oe,Te){Te.setAttributeNS("http://www.w3.org/1999/xlink",oe,ie)}getBBox(ie,oe){let Te,ge,we,K,{alignValue:Q,element:ae,renderer:ye,styles:J,textStr:re}=this,{cache:ce,cacheKeys:pe}=ye,xe=ae.namespaceURI===this.SVG_NS,Me=L(oe,this.rotation,0),_e=ye.styledMode?ae&&ne.prototype.getStyle.call(ae,"font-size"):J.fontSize;if(w(re)&&((K=re.toString()).indexOf("<")===-1&&(K=K.replace(/\d/g,"0")),K+=["",ye.rootFontSize,_e,Me,this.textWidth,Q,J.textOverflow,J.fontWeight].join(",")),K&&!ie&&(Te=ce[K]),!Te||Te.polygon){if(xe||ye.forExport){try{we=this.fakeTS&&function(Le){let Ue=ae.querySelector(".highcharts-text-outline");Ue&&D(Ue,{display:Le})},Z(we)&&we("none"),Te=ae.getBBox?z({},ae.getBBox()):{width:ae.offsetWidth,height:ae.offsetHeight,x:0,y:0},Z(we)&&we("")}catch{}(!Te||Te.width<0)&&(Te={x:0,y:0,width:0,height:0})}else Te=this.htmlGetBBox();ge=Te.height,xe&&(Te.height=ge={"11px,17":14,"13px,20":16}[`${_e||""},${Math.round(ge)}`]||ge),Me&&(Te=this.getRotatedBox(Te,Me));let Ce={bBox:Te};Y(this,"afterGetBBox",Ce),Te=Ce.bBox}if(K&&(re===""||Te.height>0)){for(;pe.length>250;)delete ce[pe.shift()];ce[K]||pe.push(K),ce[K]=Te}return Te}getRotatedBox(ie,oe){let{x:Te,y:ge,width:we,height:K}=ie,{alignValue:Q,translateY:ae,rotationOriginX:ye=0,rotationOriginY:J=0}=this,re={right:1,center:.5}[Q||0]||0,ce=Number(this.element.getAttribute("y")||0)-(ae?0:ge),pe=oe*v,xe=(oe-90)*v,Me=Math.cos(pe),_e=Math.sin(pe),Ce=we*Me,Le=we*_e,Ue=Math.cos(xe),Xe=Math.sin(xe),[[Pe,Ee],[Ie,Oe]]=[ye,J].map(ri=>[ri-ri*Me,ri*_e]),Re=Te+re*(we-Ce)+Pe+Oe+ce*Ue,Fe=Re+Ce,Ke=Fe-K*Ue,rt=Ke-Ce,at=ge+ce-re*Le-Ee+Ie+ce*Xe,ut=at+Le,mt=ut-K*Xe,Tt=mt-Le,Rt=Math.min(Re,Fe,Ke,rt),pt=Math.min(at,ut,mt,Tt),Ct=Math.max(Re,Fe,Ke,rt)-Rt,Et=Math.max(at,ut,mt,Tt)-pt;return{x:Rt,y:pt,width:Ct,height:Et,polygon:[[Re,at],[Fe,ut],[Ke,mt],[rt,Tt]]}}getStyle(ie){return S.getComputedStyle(this.element||this,"").getPropertyValue(ie)}hasClass(ie){return(""+this.attr("class")).split(" ").indexOf(ie)!==-1}hide(){return this.attr({visibility:"hidden"})}htmlGetBBox(){return{height:0,width:0,x:0,y:0}}constructor(ie,oe){this.onEvents={},this.opacity=1,this.SVG_NS=_,this.element=oe==="span"||oe==="body"?y(oe):g.createElementNS(this.SVG_NS,oe),this.renderer=ie,this.styles={},Y(this,"afterInit")}on(ie,oe){let{onEvents:Te}=this;return Te[ie]&&Te[ie](),Te[ie]=k(this.element,ie,oe),this}opacitySetter(ie,oe,Te){let ge=Number(Number(ie).toFixed(3));this.opacity=ge,Te.setAttribute(oe,ge)}reAlign(){var ie;(ie=this.alignOptions)!=null&&ie.width&&this.alignOptions.align!=="left"&&(this.alignOptions.width=this.getBBox().width,this.placed=!1,this.align())}removeClass(ie){return this.attr("class",(""+this.attr("class")).replace(V(ie)?RegExp(`(^| )${ie}( |$)`):ie," ").replace(/ +/g," ").trim())}removeTextOutline(){let ie=this.element.querySelector("tspan.highcharts-text-outline");ie&&this.safeRemoveChild(ie)}safeRemoveChild(ie){let oe=ie.parentNode;oe&&oe.removeChild(ie)}setRadialReference(ie){let oe=this.element.gradient&&this.renderer.gradients[this.element.gradient];return this.element.radialReference=ie,oe&&oe.radAttr&&oe.animate(this.renderer.getRadialAttr(ie,oe.radAttr)),this}shadow(ie){var we;let{renderer:oe}=this,Te=$(((we=this.parentGroup)==null?void 0:we.rotation)===90?{offsetX:-1,offsetY:-1}:{},j(ie)?ie:{}),ge=oe.shadowDefinition(Te);return this.attr({filter:ie?`url(${oe.url}#${ge})`:"none"})}show(ie=!0){return this.attr({visibility:ie?"inherit":"visible"})}"stroke-widthSetter"(ie,oe,Te){this[oe]=ie,Te.setAttribute(oe,ie)}strokeWidth(){if(!this.renderer.styledMode)return this["stroke-width"]||0;let ie=this.getStyle("stroke-width"),oe=0,Te;return/px$/.test(ie)?oe=G(ie):ie!==""&&(A(Te=g.createElementNS(_,"rect"),{width:ie,"stroke-width":0}),this.element.parentNode.appendChild(Te),oe=Te.getBBox().width,Te.parentNode.removeChild(Te)),oe}symbolAttr(ie){let oe=this;ne.symbolCustomAttribs.forEach(function(Te){oe[Te]=L(ie[Te],oe[Te])}),oe.attr({d:oe.renderer.symbols[oe.symbolName](oe.x,oe.y,oe.width,oe.height,oe)})}textSetter(ie){ie!==this.textStr&&(delete this.textPxLength,this.textStr=ie,this.added&&this.renderer.buildText(this),this.reAlign())}titleSetter(ie){let oe=this.element,Te=oe.getElementsByTagName("title")[0]||g.createElementNS(this.SVG_NS,"title");oe.insertBefore?oe.insertBefore(Te,oe.firstChild):oe.appendChild(Te),Te.textContent=F(L(ie,""),[/<[^>]*>/g,""]).replace(/&lt;/g,"<").replace(/&gt;/g,">")}toFront(){let ie=this.element;return ie.parentNode.appendChild(ie),this}translate(ie,oe){return this.attr({translateX:ie,translateY:oe})}updateTransform(ie="transform"){var ce;let{element:oe,matrix:Te,rotation:ge=0,rotationOriginX:we,rotationOriginY:K,scaleX:Q,scaleY:ae,translateX:ye=0,translateY:J=0}=this,re=["translate("+ye+","+J+")"];w(Te)&&re.push("matrix("+Te.join(",")+")"),ge&&(re.push("rotate("+ge+" "+L(we,oe.getAttribute("x"),0)+" "+L(K,oe.getAttribute("y")||0)+")"),((ce=this.text)==null?void 0:ce.element.tagName)==="SPAN"&&this.text.attr({rotation:ge,rotationOriginX:(we||0)-this.padding,rotationOriginY:(K||0)-this.padding})),(w(Q)||w(ae))&&re.push("scale("+L(Q,1)+" "+L(ae,1)+")"),re.length&&!(this.text||this).textPath&&oe.setAttribute(ie,re.join(" "))}visibilitySetter(ie,oe,Te){ie==="inherit"?Te.removeAttribute(oe):this[oe]!==ie&&Te.setAttribute(oe,ie),this[oe]=ie}xGetter(ie){return this.element.nodeName==="circle"&&(ie==="x"?ie="cx":ie==="y"&&(ie="cy")),this._defaultGetter(ie)}zIndexSetter(ie,oe){let Te=this.renderer,ge=this.parentGroup,we=(ge||Te).element||Te.box,K=this.element,Q=we===Te.box,ae,ye,J,re=!1,ce,pe=this.added,xe;if(w(ie)?(K.setAttribute("data-z-index",ie),ie=+ie,this[oe]===ie&&(pe=!1)):w(this[oe])&&K.removeAttribute("data-z-index"),this[oe]=ie,pe){for((ie=this.zIndex)&&ge&&(ge.handleZ=!0),xe=(ae=we.childNodes).length-1;xe>=0&&!re;xe--)ce=!w(J=(ye=ae[xe]).getAttribute("data-z-index")),ye!==K&&(ie<0&&ce&&!Q&&!xe?(we.insertBefore(K,ae[xe]),re=!0):(G(J)<=ie||ce&&(!w(ie)||ie>=0))&&(we.insertBefore(K,ae[xe+1]),re=!0));re||(we.insertBefore(K,ae[Q?3:0]),re=!0)}return re}}return ne.symbolCustomAttribs=["anchorX","anchorY","clockwise","end","height","innerR","r","start","width","x","y"],ne.prototype.strokeSetter=ne.prototype.fillSetter,ne.prototype.yGetter=ne.prototype.xGetter,ne.prototype.matrixSetter=ne.prototype.rotationOriginXSetter=ne.prototype.rotationOriginYSetter=ne.prototype.rotationSetter=ne.prototype.scaleXSetter=ne.prototype.scaleYSetter=ne.prototype.translateXSetter=ne.prototype.translateYSetter=ne.prototype.verticalAlignSetter=function(ue,ie){this[ie]=ue,this.doTransform=!0},ne}),c(t,"Core/Renderer/SVG/SVGLabel.js",[t["Core/Renderer/SVG/SVGElement.js"],t["Core/Utilities.js"]],function(a,h){let{defined:d,extend:s,isNumber:f,merge:b,pick:x,removeEvent:v}=h;class g extends a{constructor(_,S,k,A,y,I,D,w,M,z){let Y;super(_,"g"),this.paddingLeftSetter=this.paddingSetter,this.paddingRightSetter=this.paddingSetter,this.doUpdate=!1,this.textStr=S,this.x=k,this.y=A,this.anchorX=I,this.anchorY=D,this.baseline=M,this.className=z,this.addClass(z==="button"?"highcharts-no-tooltip":"highcharts-label"),z&&this.addClass("highcharts-"+z),this.text=_.text(void 0,0,0,w).attr({zIndex:1}),typeof y=="string"&&((Y=/^url\((.*?)\)$/.test(y))||this.renderer.symbols[y])&&(this.symbolKey=y),this.bBox=g.emptyBBox,this.padding=3,this.baselineOffset=0,this.needsBox=_.styledMode||Y,this.deferredAttr={},this.alignFactor=0}alignSetter(_){let S={left:0,center:.5,right:1}[_];S!==this.alignFactor&&(this.alignFactor=S,this.bBox&&f(this.xSetting)&&this.attr({x:this.xSetting}))}anchorXSetter(_,S){this.anchorX=_,this.boxAttr(S,Math.round(_)-this.getCrispAdjust()-this.xSetting)}anchorYSetter(_,S){this.anchorY=_,this.boxAttr(S,_-this.ySetting)}boxAttr(_,S){this.box?this.box.attr(_,S):this.deferredAttr[_]=S}css(_){if(_){let S={};_=b(_),g.textProps.forEach(k=>{_[k]!==void 0&&(S[k]=_[k],delete _[k])}),this.text.css(S),"fontSize"in S||"fontWeight"in S?this.updateTextPadding():("width"in S||"textOverflow"in S)&&this.updateBoxSize()}return a.prototype.css.call(this,_)}destroy(){v(this.element,"mouseenter"),v(this.element,"mouseleave"),this.text&&this.text.destroy(),this.box&&(this.box=this.box.destroy()),a.prototype.destroy.call(this)}fillSetter(_,S){_&&(this.needsBox=!0),this.fill=_,this.boxAttr(S,_)}getBBox(_,S){this.textStr&&this.bBox.width===0&&this.bBox.height===0&&this.updateBoxSize();let{padding:k,height:A=0,translateX:y=0,translateY:I=0,width:D=0}=this,w=x(this.paddingLeft,k),M=S??(this.rotation||0),z={width:D,height:A,x:y+this.bBox.x-w,y:I+this.bBox.y-k+this.baselineOffset};return M&&(z=this.getRotatedBox(z,M)),z}getCrispAdjust(){return(this.renderer.styledMode&&this.box?this.box.strokeWidth():this["stroke-width"]?parseInt(this["stroke-width"],10):0)%2/2}heightSetter(_){this.heightSetting=_,this.doUpdate=!0}afterSetters(){super.afterSetters(),this.doUpdate&&(this.updateBoxSize(),this.doUpdate=!1)}onAdd(){this.text.add(this),this.attr({text:x(this.textStr,""),x:this.x||0,y:this.y||0}),this.box&&d(this.anchorX)&&this.attr({anchorX:this.anchorX,anchorY:this.anchorY})}paddingSetter(_,S){f(_)?_!==this[S]&&(this[S]=_,this.updateTextPadding()):this[S]=void 0}rSetter(_,S){this.boxAttr(S,_)}strokeSetter(_,S){this.stroke=_,this.boxAttr(S,_)}"stroke-widthSetter"(_,S){_&&(this.needsBox=!0),this["stroke-width"]=_,this.boxAttr(S,_)}"text-alignSetter"(_){this.textAlign=_}textSetter(_){_!==void 0&&this.text.attr({text:_}),this.updateTextPadding(),this.reAlign()}updateBoxSize(){let _,S=this.text,k={},A=this.padding,y=this.bBox=(!f(this.widthSetting)||!f(this.heightSetting)||this.textAlign)&&d(S.textStr)?S.getBBox(void 0,0):g.emptyBBox;this.width=this.getPaddedWidth(),this.height=(this.heightSetting||y.height||0)+2*A;let I=this.renderer.fontMetrics(S);if(this.baselineOffset=A+Math.min((this.text.firstLineMetrics||I).b,y.height||1/0),this.heightSetting&&(this.baselineOffset+=(this.heightSetting-I.h)/2),this.needsBox&&!S.textPath){if(!this.box){let D=this.box=this.symbolKey?this.renderer.symbol(this.symbolKey):this.renderer.rect();D.addClass((this.className==="button"?"":"highcharts-label-box")+(this.className?" highcharts-"+this.className+"-box":"")),D.add(this)}_=this.getCrispAdjust(),k.x=_,k.y=(this.baseline?-this.baselineOffset:0)+_,k.width=Math.round(this.width),k.height=Math.round(this.height),this.box.attr(s(k,this.deferredAttr)),this.deferredAttr={}}}updateTextPadding(){let _=this.text;if(!_.textPath){this.updateBoxSize();let S=this.baseline?0:this.baselineOffset,k=x(this.paddingLeft,this.padding);d(this.widthSetting)&&this.bBox&&(this.textAlign==="center"||this.textAlign==="right")&&(k+={center:.5,right:1}[this.textAlign]*(this.widthSetting-this.bBox.width)),(k!==_.x||S!==_.y)&&(_.attr("x",k),_.hasBoxWidthChanged&&(this.bBox=_.getBBox(!0)),S!==void 0&&_.attr("y",S)),_.x=k,_.y=S}}widthSetter(_){this.widthSetting=f(_)?_:void 0,this.doUpdate=!0}getPaddedWidth(){let _=this.padding,S=x(this.paddingLeft,_),k=x(this.paddingRight,_);return(this.widthSetting||this.bBox.width||0)+S+k}xSetter(_){this.x=_,this.alignFactor&&(_-=this.alignFactor*this.getPaddedWidth(),this["forceAnimate:x"]=!0),this.xSetting=Math.round(_),this.attr("translateX",this.xSetting)}ySetter(_){this.ySetting=this.y=Math.round(_),this.attr("translateY",this.ySetting)}}return g.emptyBBox={width:0,height:0,x:0,y:0},g.textProps=["color","direction","fontFamily","fontSize","fontStyle","fontWeight","lineHeight","textAlign","textDecoration","textOutline","textOverflow","whiteSpace","width"],g}),c(t,"Core/Renderer/SVG/Symbols.js",[t["Core/Utilities.js"]],function(a){let{defined:h,isNumber:d,pick:s}=a;function f(v,g,P,_,S){let k=[];if(S){let A=S.start||0,y=s(S.r,P),I=s(S.r,_||P),D=2e-4/(S.borderRadius?1:Math.max(y,1)),w=Math.abs((S.end||0)-A-2*Math.PI)<D,M=(S.end||0)-(w?D:0),z=S.innerR,Y=s(S.open,w),X=Math.cos(A),Z=Math.sin(A),j=Math.cos(M),V=Math.sin(M),$=s(S.longArc,M-A-Math.PI<D?0:1),R=["A",y,I,0,$,s(S.clockwise,1),v+y*j,g+I*V];R.params={start:A,end:M,cx:v,cy:g},k.push(["M",v+y*X,g+I*Z],R),h(z)&&((R=["A",z,z,0,$,h(S.clockwise)?1-S.clockwise:0,v+z*X,g+z*Z]).params={start:M,end:A,cx:v,cy:g},k.push(Y?["M",v+z*j,g+z*V]:["L",v+z*j,g+z*V],R)),Y||k.push(["Z"])}return k}function b(v,g,P,_,S){return S&&S.r?x(v,g,P,_,S):[["M",v,g],["L",v+P,g],["L",v+P,g+_],["L",v,g+_],["Z"]]}function x(v,g,P,_,S){let k=(S==null?void 0:S.r)||0;return[["M",v+k,g],["L",v+P-k,g],["A",k,k,0,0,1,v+P,g+k],["L",v+P,g+_-k],["A",k,k,0,0,1,v+P-k,g+_],["L",v+k,g+_],["A",k,k,0,0,1,v,g+_-k],["L",v,g+k],["A",k,k,0,0,1,v+k,g],["Z"]]}return{arc:f,callout:function(v,g,P,_,S){let k=Math.min(S&&S.r||0,P,_),A=k+6,y=S&&S.anchorX,I=S&&S.anchorY||0,D=x(v,g,P,_,{r:k});if(!d(y)||y<P&&y>0&&I<_&&I>0)return D;if(v+y>P-A)if(I>g+A&&I<g+_-A)D.splice(3,1,["L",v+P,I-6],["L",v+P+6,I],["L",v+P,I+6],["L",v+P,g+_-k]);else if(y<P){let w=I<g+A,M=w?g:g+_;D.splice(w?2:5,0,["L",y,I],["L",v+P-k,M])}else D.splice(3,1,["L",v+P,_/2],["L",y,I],["L",v+P,_/2],["L",v+P,g+_-k]);else if(v+y<A)if(I>g+A&&I<g+_-A)D.splice(7,1,["L",v,I+6],["L",v-6,I],["L",v,I-6],["L",v,g+k]);else if(y>0){let w=I<g+A,M=w?g:g+_;D.splice(w?1:6,0,["L",y,I],["L",v+k,M])}else D.splice(7,1,["L",v,_/2],["L",y,I],["L",v,_/2],["L",v,g+k]);else I>_&&y<P-A?D.splice(5,1,["L",y+6,g+_],["L",y,g+_+6],["L",y-6,g+_],["L",v+k,g+_]):I<0&&y>A&&D.splice(1,1,["L",y-6,g],["L",y,g-6],["L",y+6,g],["L",P-k,g]);return D},circle:function(v,g,P,_){return f(v+P/2,g+_/2,P/2,_/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},diamond:function(v,g,P,_){return[["M",v+P/2,g],["L",v+P,g+_/2],["L",v+P/2,g+_],["L",v,g+_/2],["Z"]]},rect:b,roundedRect:x,square:b,triangle:function(v,g,P,_){return[["M",v+P/2,g],["L",v+P,g+_],["L",v,g+_],["Z"]]},"triangle-down":function(v,g,P,_){return[["M",v,g],["L",v+P,g],["L",v+P/2,g+_],["Z"]]}}}),c(t,"Core/Renderer/SVG/TextBuilder.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h,d){let{doc:s,SVG_NS:f,win:b}=h,{attr:x,extend:v,fireEvent:g,isString:P,objectEach:_,pick:S}=d;return class{constructor(k){let A=k.styles;this.renderer=k.renderer,this.svgElement=k,this.width=k.textWidth,this.textLineHeight=A&&A.lineHeight,this.textOutline=A&&A.textOutline,this.ellipsis=!!(A&&A.textOverflow==="ellipsis"),this.noWrap=!!(A&&A.whiteSpace==="nowrap")}buildSVG(){let k=this.svgElement,A=k.element,y=k.renderer,I=S(k.textStr,"").toString(),D=I.indexOf("<")!==-1,w=A.childNodes,M=!k.added&&y.box,z=[I,this.ellipsis,this.noWrap,this.textLineHeight,this.textOutline,k.getStyle("font-size"),this.width].join(",");if(z!==k.textCache){k.textCache=z,delete k.actualWidth;for(let Y=w.length;Y--;)A.removeChild(w[Y]);if(D||this.ellipsis||this.width||k.textPath||I.indexOf(" ")!==-1&&(!this.noWrap||/<br.*?>/g.test(I))){if(I!==""){M&&M.appendChild(A);let Y=new a(I);this.modifyTree(Y.nodes),Y.addToDOM(A),this.modifyDOM(),this.ellipsis&&(A.textContent||"").indexOf("…")!==-1&&k.attr("title",this.unescapeEntities(k.textStr||"",["&lt;","&gt;"])),M&&M.removeChild(A)}}else A.appendChild(s.createTextNode(this.unescapeEntities(I)));P(this.textOutline)&&k.applyTextOutline&&k.applyTextOutline(this.textOutline)}}modifyDOM(){let k,A=this.svgElement,y=x(A.element,"x");for(A.firstLineMetrics=void 0;(k=A.element.firstChild)&&/^[\s\u200B]*$/.test(k.textContent||" ");)A.element.removeChild(k);[].forEach.call(A.element.querySelectorAll("tspan.highcharts-br"),(M,z)=>{M.nextSibling&&M.previousSibling&&(z===0&&M.previousSibling.nodeType===1&&(A.firstLineMetrics=A.renderer.fontMetrics(M.previousSibling)),x(M,{dy:this.getLineHeight(M.nextSibling),x:y}))});let I=this.width||0;if(!I)return;let D=(M,z)=>{let Y=M.textContent||"",X=Y.replace(/([^\^])-/g,"$1- ").split(" "),Z=!this.noWrap&&(X.length>1||A.element.childNodes.length>1),j=this.getLineHeight(z),V=0,$=A.actualWidth;if(this.ellipsis)Y&&this.truncate(M,Y,void 0,0,Math.max(0,I-.8*j),(R,L)=>R.substring(0,L)+"…");else if(Z){let R=[],L=[];for(;z.firstChild&&z.firstChild!==M;)L.push(z.firstChild),z.removeChild(z.firstChild);for(;X.length;)X.length&&!this.noWrap&&V>0&&(R.push(M.textContent||""),M.textContent=X.join(" ").replace(/- /g,"-")),this.truncate(M,void 0,X,V===0&&$||0,I,(G,U)=>X.slice(0,U).join(" ").replace(/- /g,"-")),$=A.actualWidth,V++;L.forEach(G=>{z.insertBefore(G,M)}),R.forEach(G=>{z.insertBefore(s.createTextNode(G),M);let U=s.createElementNS(f,"tspan");U.textContent="​",x(U,{dy:j,x:y}),z.insertBefore(U,M)})}},w=M=>{[].slice.call(M.childNodes).forEach(z=>{z.nodeType===b.Node.TEXT_NODE?D(z,M):(z.className.baseVal.indexOf("highcharts-br")!==-1&&(A.actualWidth=0),w(z))})};w(A.element)}getLineHeight(k){let A=k.nodeType===b.Node.TEXT_NODE?k.parentElement:k;return this.textLineHeight?parseInt(this.textLineHeight.toString(),10):this.renderer.fontMetrics(A||this.svgElement.element).h}modifyTree(k){let A=(y,I)=>{let{attributes:D={},children:w,style:M={},tagName:z}=y,Y=this.renderer.styledMode;if(z==="b"||z==="strong"?Y?D.class="highcharts-strong":M.fontWeight="bold":(z==="i"||z==="em")&&(Y?D.class="highcharts-emphasized":M.fontStyle="italic"),M&&M.color&&(M.fill=M.color),z==="br"){D.class="highcharts-br",y.textContent="​";let X=k[I+1];X&&X.textContent&&(X.textContent=X.textContent.replace(/^ +/gm,""))}else z==="a"&&w&&w.some(X=>X.tagName==="#text")&&(y.children=[{children:w,tagName:"tspan"}]);z!=="#text"&&z!=="a"&&(y.tagName="tspan"),v(y,{attributes:D,style:M}),w&&w.filter(X=>X.tagName!=="#text").forEach(A)};k.forEach(A),g(this.svgElement,"afterModifyTree",{nodes:k})}truncate(k,A,y,I,D,w){let M,z,Y=this.svgElement,{rotation:X}=Y,Z=[],j=y?1:0,V=(A||y||"").length,$=V,R=function(L,G){let U=G||L,F=k.parentNode;if(F&&Z[U]===void 0&&F.getSubStringLength)try{Z[U]=I+F.getSubStringLength(0,y?U+1:U)}catch{}return Z[U]};if(Y.rotation=0,I+(z=R(k.textContent.length))>D){for(;j<=V;)$=Math.ceil((j+V)/2),y&&(M=w(y,$)),z=R($,M&&M.length-1),j===V?j=V+1:z>D?V=$-1:j=$;V===0?k.textContent="":A&&V===A.length-1||(k.textContent=M||w(A||y,$))}y&&y.splice(0,$),Y.actualWidth=z,Y.rotation=X}unescapeEntities(k,A){return _(this.renderer.escapes,function(y,I){A&&A.indexOf(y)!==-1||(k=k.toString().replace(RegExp(y,"g"),I))}),k}}}),c(t,"Core/Renderer/SVG/SVGRenderer.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Defaults.js"],t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Renderer/RendererRegistry.js"],t["Core/Renderer/SVG/SVGElement.js"],t["Core/Renderer/SVG/SVGLabel.js"],t["Core/Renderer/SVG/Symbols.js"],t["Core/Renderer/SVG/TextBuilder.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b,x,v,g,P){let _,{defaultOptions:S}=h,{charts:k,deg2rad:A,doc:y,isFirefox:I,isMS:D,isWebKit:w,noop:M,SVG_NS:z,symbolSizes:Y,win:X}=s,{addEvent:Z,attr:j,createElement:V,crisp:$,css:R,defined:L,destroyObjectProperties:G,extend:U,isArray:F,isNumber:H,isObject:W,isString:ne,merge:ue,pick:ie,pInt:oe,replaceNested:Te,uniqueKey:ge}=P;class we{constructor(Q,ae,ye,J,re,ce,pe){let xe,Me,_e=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),Ce=_e.element;pe||_e.css(this.getStyle(J||{})),Q.appendChild(Ce),j(Q,"dir","ltr"),Q.innerHTML.indexOf("xmlns")===-1&&j(Ce,"xmlns",this.SVG_NS),this.box=Ce,this.boxWrapper=_e,this.alignedObjects=[],this.url=this.getReferenceURL(),this.createElement("desc").add().element.appendChild(y.createTextNode("Created with Highcharts 11.4.8")),this.defs=this.createElement("defs").add(),this.allowHTML=ce,this.forExport=re,this.styledMode=pe,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.rootFontSize=_e.getStyle("font-size"),this.setSize(ae,ye,!1),I&&Q.getBoundingClientRect&&((xe=function(){R(Q,{left:0,top:0}),Me=Q.getBoundingClientRect(),R(Q,{left:Math.ceil(Me.left)-Me.left+"px",top:Math.ceil(Me.top)-Me.top+"px"})})(),this.unSubPixelFix=Z(X,"resize",xe))}definition(Q){return new a([Q]).addToDOM(this.defs.element)}getReferenceURL(){if((I||w)&&y.getElementsByTagName("base").length){if(!L(_)){let Q=ge(),ae=new a([{tagName:"svg",attributes:{width:8,height:8},children:[{tagName:"defs",children:[{tagName:"clipPath",attributes:{id:Q},children:[{tagName:"rect",attributes:{width:4,height:4}}]}]},{tagName:"rect",attributes:{id:"hitme",width:8,height:8,"clip-path":`url(#${Q})`,fill:"rgba(0,0,0,0.001)"}}]}]).addToDOM(y.body);R(ae,{position:"fixed",top:0,left:0,zIndex:9e5});let ye=y.elementFromPoint(6,6);_=(ye&&ye.id)==="hitme",y.body.removeChild(ae)}if(_)return Te(X.location.href.split("#")[0],[/<[^>]*>/g,""],[/([\('\)])/g,"\\$1"],[/ /g,"%20"])}return""}getStyle(Q){return this.style=U({fontFamily:"Helvetica, Arial, sans-serif",fontSize:"1rem"},Q),this.style}setStyle(Q){this.boxWrapper.css(this.getStyle(Q))}isHidden(){return!this.boxWrapper.getBBox().width}destroy(){let Q=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),G(this.gradients||{}),this.gradients=null,this.defs=Q.destroy(),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null,null}createElement(Q){return new this.Element(this,Q)}getRadialAttr(Q,ae){return{cx:Q[0]-Q[2]/2+(ae.cx||0)*Q[2],cy:Q[1]-Q[2]/2+(ae.cy||0)*Q[2],r:(ae.r||0)*Q[2]}}shadowDefinition(Q){let ae=[`highcharts-drop-shadow-${this.chartIndex}`,...Object.keys(Q).map(J=>`${J}-${Q[J]}`)].join("-").toLowerCase().replace(/[^a-z\d\-]/g,""),ye=ue({color:"#000000",offsetX:1,offsetY:1,opacity:.15,width:5},Q);return this.defs.element.querySelector(`#${ae}`)||this.definition({tagName:"filter",attributes:{id:ae,filterUnits:ye.filterUnits},children:this.getShadowFilterContent(ye)}),ae}getShadowFilterContent(Q){return[{tagName:"feDropShadow",attributes:{dx:Q.offsetX,dy:Q.offsetY,"flood-color":Q.color,"flood-opacity":Math.min(5*Q.opacity,1),stdDeviation:Q.width/2}}]}buildText(Q){new g(Q).buildSVG()}getContrast(Q){let ae=d.parse(Q).rgba.map(J=>{let re=J/255;return re<=.03928?re/12.92:Math.pow((re+.055)/1.055,2.4)}),ye=.2126*ae[0]+.7152*ae[1]+.0722*ae[2];return 1.05/(ye+.05)>(ye+.05)/.05?"#FFFFFF":"#000000"}button(Q,ae,ye,J,re={},ce,pe,xe,Me,_e){let Ce=this.label(Q,ae,ye,Me,void 0,void 0,_e,void 0,"button"),Le=this.styledMode,Ue=arguments,Xe=0;re=ue(S.global.buttonTheme,re),Le&&(delete re.fill,delete re.stroke,delete re["stroke-width"]);let Pe=re.states||{},Ee=re.style||{};delete re.states,delete re.style;let Ie=[a.filterUserAttributes(re)],Oe=[Ee];return Le||["hover","select","disabled"].forEach((Re,Fe)=>{Ie.push(ue(Ie[0],a.filterUserAttributes(Ue[Fe+5]||Pe[Re]||{}))),Oe.push(Ie[Fe+1].style),delete Ie[Fe+1].style}),Z(Ce.element,D?"mouseover":"mouseenter",function(){Xe!==3&&Ce.setState(1)}),Z(Ce.element,D?"mouseout":"mouseleave",function(){Xe!==3&&Ce.setState(Xe)}),Ce.setState=(Re=0)=>{if(Re!==1&&(Ce.state=Xe=Re),Ce.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][Re]),!Le){Ce.attr(Ie[Re]);let Fe=Oe[Re];W(Fe)&&Ce.css(Fe)}},Ce.attr(Ie[0]),!Le&&(Ce.css(U({cursor:"default"},Ee)),_e&&Ce.text.css({pointerEvents:"none"})),Ce.on("touchstart",Re=>Re.stopPropagation()).on("click",function(Re){Xe!==3&&J.call(Ce,Re)})}crispLine(Q,ae){let[ye,J]=Q;return L(ye[1])&&ye[1]===J[1]&&(ye[1]=J[1]=$(ye[1],ae)),L(ye[2])&&ye[2]===J[2]&&(ye[2]=J[2]=$(ye[2],ae)),Q}path(Q){let ae=this.styledMode?{}:{fill:"none"};return F(Q)?ae.d=Q:W(Q)&&U(ae,Q),this.createElement("path").attr(ae)}circle(Q,ae,ye){let J=W(Q)?Q:Q===void 0?{}:{x:Q,y:ae,r:ye},re=this.createElement("circle");return re.xSetter=re.ySetter=function(ce,pe,xe){xe.setAttribute("c"+pe,ce)},re.attr(J)}arc(Q,ae,ye,J,re,ce){let pe;W(Q)?(ae=(pe=Q).y,ye=pe.r,J=pe.innerR,re=pe.start,ce=pe.end,Q=pe.x):pe={innerR:J,start:re,end:ce};let xe=this.symbol("arc",Q,ae,ye,ye,pe);return xe.r=ye,xe}rect(Q,ae,ye,J,re,ce){let pe=W(Q)?Q:Q===void 0?{}:{x:Q,y:ae,r:re,width:Math.max(ye||0,0),height:Math.max(J||0,0)},xe=this.createElement("rect");return this.styledMode||(ce!==void 0&&(pe["stroke-width"]=ce,U(pe,xe.crisp(pe))),pe.fill="none"),xe.rSetter=function(Me,_e,Ce){xe.r=Me,j(Ce,{rx:Me,ry:Me})},xe.rGetter=function(){return xe.r||0},xe.attr(pe)}roundedRect(Q){return this.symbol("roundedRect").attr(Q)}setSize(Q,ae,ye){this.width=Q,this.height=ae,this.boxWrapper.animate({width:Q,height:ae},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:ie(ye,!0)?void 0:0}),this.alignElements()}g(Q){let ae=this.createElement("g");return Q?ae.attr({class:"highcharts-"+Q}):ae}image(Q,ae,ye,J,re,ce){let pe={preserveAspectRatio:"none"};H(ae)&&(pe.x=ae),H(ye)&&(pe.y=ye),H(J)&&(pe.width=J),H(re)&&(pe.height=re);let xe=this.createElement("image").attr(pe),Me=function(_e){xe.attr({href:Q}),ce.call(xe,_e)};if(ce){xe.attr({href:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="});let _e=new X.Image;Z(_e,"load",Me),_e.src=Q,_e.complete&&Me({})}else xe.attr({href:Q});return xe}symbol(Q,ae,ye,J,re,ce){let pe,xe,Me,_e,Ce=this,Le=/^url\((.*?)\)$/,Ue=Le.test(Q),Xe=!Ue&&(this.symbols[Q]?Q:"circle"),Pe=Xe&&this.symbols[Xe];if(Pe)typeof ae=="number"&&(xe=Pe.call(this.symbols,ae||0,ye||0,J||0,re||0,ce)),pe=this.path(xe),Ce.styledMode||pe.attr("fill","none"),U(pe,{symbolName:Xe||void 0,x:ae,y:ye,width:J,height:re}),ce&&U(pe,ce);else if(Ue){Me=Q.match(Le)[1];let Ee=pe=this.image(Me);Ee.imgwidth=ie(ce&&ce.width,Y[Me]&&Y[Me].width),Ee.imgheight=ie(ce&&ce.height,Y[Me]&&Y[Me].height),_e=Ie=>Ie.attr({width:Ie.width,height:Ie.height}),["width","height"].forEach(Ie=>{Ee[`${Ie}Setter`]=function(Oe,Re){this[Re]=Oe;let{alignByTranslate:Fe,element:Ke,width:rt,height:at,imgwidth:ut,imgheight:mt}=this,Tt=Re==="width"?ut:mt,Rt=1;ce&&ce.backgroundSize==="within"&&rt&&at&&ut&&mt?(Rt=Math.min(rt/ut,at/mt),j(Ke,{width:Math.round(ut*Rt),height:Math.round(mt*Rt)})):Ke&&Tt&&Ke.setAttribute(Re,Tt),!Fe&&ut&&mt&&this.translate(((rt||0)-ut*Rt)/2,((at||0)-mt*Rt)/2)}}),L(ae)&&Ee.attr({x:ae,y:ye}),Ee.isImg=!0,Ee.symbolUrl=Q,L(Ee.imgwidth)&&L(Ee.imgheight)?_e(Ee):(Ee.attr({width:0,height:0}),V("img",{onload:function(){let Ie=k[Ce.chartIndex];this.width===0&&(R(this,{position:"absolute",top:"-999em"}),y.body.appendChild(this)),Y[Me]={width:this.width,height:this.height},Ee.imgwidth=this.width,Ee.imgheight=this.height,Ee.element&&_e(Ee),this.parentNode&&this.parentNode.removeChild(this),Ce.imgCount--,Ce.imgCount||!Ie||Ie.hasLoaded||Ie.onload()},src:Me}),this.imgCount++)}return pe}clipRect(Q,ae,ye,J){return this.rect(Q,ae,ye,J,0)}text(Q,ae,ye,J){let re={};if(J&&(this.allowHTML||!this.forExport))return this.html(Q,ae,ye);re.x=Math.round(ae||0),ye&&(re.y=Math.round(ye)),L(Q)&&(re.text=Q);let ce=this.createElement("text").attr(re);return J&&(!this.forExport||this.allowHTML)||(ce.xSetter=function(pe,xe,Me){let _e=Me.getElementsByTagName("tspan"),Ce=Me.getAttribute(xe);for(let Le=0,Ue;Le<_e.length;Le++)(Ue=_e[Le]).getAttribute(xe)===Ce&&Ue.setAttribute(xe,pe);Me.setAttribute(xe,pe)}),ce}fontMetrics(Q){let ae=oe(b.prototype.getStyle.call(Q,"font-size")||0),ye=ae<24?ae+3:Math.round(1.2*ae),J=Math.round(.8*ye);return{h:ye,b:J,f:ae}}rotCorr(Q,ae,ye){let J=Q;return ae&&ye&&(J=Math.max(J*Math.cos(ae*A),4)),{x:-Q/3*Math.sin(ae*A),y:J}}pathToSegments(Q){let ae=[],ye=[],J={A:8,C:7,H:2,L:3,M:3,Q:5,S:5,T:3,V:2};for(let re=0;re<Q.length;re++)ne(ye[0])&&H(Q[re])&&ye.length===J[ye[0].toUpperCase()]&&Q.splice(re,0,ye[0].replace("M","L").replace("m","l")),typeof Q[re]=="string"&&(ye.length&&ae.push(ye.slice(0)),ye.length=0),ye.push(Q[re]);return ae.push(ye.slice(0)),ae}label(Q,ae,ye,J,re,ce,pe,xe,Me){return new x(this,Q,ae,ye,J,re,ce,pe,xe,Me)}alignElements(){this.alignedObjects.forEach(Q=>Q.align())}}return U(we.prototype,{Element:b,SVG_NS:z,escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},symbols:v,draw:M}),f.registerRendererType("svg",we,!0),we}),c(t,"Core/Renderer/HTML/HTMLElement.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Globals.js"],t["Core/Renderer/SVG/SVGElement.js"],t["Core/Utilities.js"]],function(a,h,d,s){let{composed:f}=h,{attr:b,css:x,createElement:v,defined:g,extend:P,pInt:_,pushUnique:S}=s;function k(D,w,M){var Y;let z=((Y=this.div)==null?void 0:Y.style)||M.style;d.prototype[`${w}Setter`].call(this,D,w,M),z&&(z[w]=D)}let A=(D,w)=>{var M;if(!D.div){let z=b(D.element,"class"),Y=D.css,X=v("div",z?{className:z}:void 0,{position:"absolute",left:`${D.translateX||0}px`,top:`${D.translateY||0}px`,...D.styles,display:D.display,opacity:D.opacity,visibility:D.visibility},((M=D.parentGroup)==null?void 0:M.div)||w);D.classSetter=(Z,j,V)=>{V.setAttribute("class",Z),X.className=Z},D.translateXSetter=D.translateYSetter=(Z,j)=>{D[j]=Z,X.style[j==="translateX"?"left":"top"]=`${Z}px`,D.doTransform=!0},D.opacitySetter=D.visibilitySetter=k,D.css=Z=>(Y.call(D,Z),Z.cursor&&(X.style.cursor=Z.cursor),Z.pointerEvents&&(X.style.pointerEvents=Z.pointerEvents),D),D.on=function(){return d.prototype.on.apply({element:X,onEvents:D.onEvents},arguments),D},D.div=X}return D.div};class y extends d{static compose(w){S(f,this.compose)&&(w.prototype.html=function(M,z,Y){return new y(this,"span").attr({text:M,x:Math.round(z),y:Math.round(Y)})})}constructor(w,M){super(w,M),this.css({position:"absolute",...w.styledMode?{}:{fontFamily:w.style.fontFamily,fontSize:w.style.fontSize}}),this.element.style.whiteSpace="nowrap"}getSpanCorrection(w,M,z){this.xCorr=-w*z,this.yCorr=-M}css(w){let M,{element:z}=this,Y=z.tagName==="SPAN"&&w&&"width"in w,X=Y&&w.width;return Y&&(delete w.width,this.textWidth=_(X)||void 0,M=!0),(w==null?void 0:w.textOverflow)==="ellipsis"&&(w.whiteSpace="nowrap",w.overflow="hidden"),P(this.styles,w),x(z,w),M&&this.updateTransform(),this}htmlGetBBox(){let{element:w}=this;return{x:w.offsetLeft,y:w.offsetTop,width:w.offsetWidth,height:w.offsetHeight}}updateTransform(){var H;if(!this.added){this.alignOnAdd=!0;return}let{element:w,renderer:M,rotation:z,rotationOriginX:Y,rotationOriginY:X,styles:Z,textAlign:j="left",textWidth:V,translateX:$=0,translateY:R=0,x:L=0,y:G=0}=this,U={left:0,center:.5,right:1}[j],F=Z.whiteSpace;if(x(w,{marginLeft:`${$}px`,marginTop:`${R}px`}),w.tagName==="SPAN"){let W=[z,j,w.innerHTML,V,this.textAlign].join(","),ne=-(((H=this.parentGroup)==null?void 0:H.padding)*1)||0,ue,ie=!1;if(V!==this.oldTextWidth){let K=this.textPxLength?this.textPxLength:(x(w,{width:"",whiteSpace:F||"nowrap"}),w.offsetWidth),Q=V||0;(Q>this.oldTextWidth||K>Q)&&(/[ \-]/.test(w.textContent||w.innerText)||w.style.textOverflow==="ellipsis")&&(x(w,{width:K>Q||z?V+"px":"auto",display:"block",whiteSpace:F||"normal"}),this.oldTextWidth=V,ie=!0)}this.hasBoxWidthChanged=ie,W!==this.cTT&&(ue=M.fontMetrics(w).b,g(z)&&(z!==(this.oldRotation||0)||j!==this.oldAlign)&&this.setSpanRotation(z,ne,ne),this.getSpanCorrection(!g(z)&&this.textPxLength||w.offsetWidth,ue,U));let{xCorr:oe=0,yCorr:Te=0}=this,ge=(Y??L)-oe-L-ne,we=(X??G)-Te-G-ne;x(w,{left:`${L+oe}px`,top:`${G+Te}px`,transformOrigin:`${ge}px ${we}px`}),this.cTT=W,this.oldRotation=z,this.oldAlign=j}}setSpanRotation(w,M,z){x(this.element,{transform:`rotate(${w}deg)`,transformOrigin:`${M}% ${z}px`})}add(w){let M,z=this.renderer.box.parentNode,Y=[];if(this.parentGroup=w,w&&!(M=w.div)){let X=w;for(;X;)Y.push(X),X=X.parentGroup;for(let Z of Y.reverse())M=A(Z,z)}return(M||z).appendChild(this.element),this.added=!0,this.alignOnAdd&&this.updateTransform(),this}textSetter(w){w!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,a.setElementHTML(this.element,w??""),this.textStr=w,this.doTransform=!0)}alignSetter(w){this.alignValue=this.textAlign=w,this.doTransform=!0}xSetter(w,M){this[M]=w,this.doTransform=!0}}let I=y.prototype;return I.visibilitySetter=I.opacitySetter=k,I.ySetter=I.rotationSetter=I.rotationOriginXSetter=I.rotationOriginYSetter=I.xSetter,y}),c(t,"Core/Axis/AxisDefaults.js",[],function(){var a,h;return(h=a||(a={})).xAxis={alignTicks:!0,allowDecimals:void 0,panningEnabled:!0,zIndex:2,zoomEnabled:!0,dateTimeLabelFormats:{millisecond:{main:"%H:%M:%S.%L",range:!1},second:{main:"%H:%M:%S",range:!1},minute:{main:"%H:%M",range:!1},hour:{main:"%H:%M",range:!1},day:{main:"%e %b"},week:{main:"%e %b"},month:{main:"%b '%y"},year:{main:"%Y"}},endOnTick:!1,gridLineDashStyle:"Solid",gridZIndex:1,labels:{autoRotationLimit:80,distance:15,enabled:!0,indentation:10,overflow:"justify",reserveSpace:void 0,rotation:void 0,staggerLines:0,step:0,useHTML:!1,zIndex:7,style:{color:"#333333",cursor:"default",fontSize:"0.8em"}},maxPadding:.01,minorGridLineDashStyle:"Solid",minorTickLength:2,minorTickPosition:"outside",minorTicksPerMajor:5,minPadding:.01,offset:void 0,reversed:void 0,reversedStacks:!1,showEmpty:!0,showFirstLabel:!0,showLastLabel:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",useHTML:!1,x:0,y:0,style:{color:"#666666",fontSize:"0.8em"}},visible:!0,minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#333333",lineWidth:1,gridLineColor:"#e6e6e6",gridLineWidth:void 0,tickColor:"#333333"},h.yAxis={reversedStacks:!0,endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:void 0},startOnTick:!0,title:{text:"Values"},stackLabels:{animation:{},allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){let{numberFormatter:d}=this.axis.chart;return d(this.total||0,-1)},style:{color:"#000000",fontSize:"0.7em",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},a}),c(t,"Core/Foundation.js",[t["Core/Utilities.js"]],function(a){var h;let{addEvent:d,isFunction:s,objectEach:f,removeEvent:b}=a;return(h||(h={})).registerEventOptions=function(x,v){x.eventOptions=x.eventOptions||{},f(v.events,function(g,P){x.eventOptions[P]!==g&&(x.eventOptions[P]&&(b(x,P,x.eventOptions[P]),delete x.eventOptions[P]),s(g)&&(x.eventOptions[P]=g,d(x,P,g,{order:0})))})},h}),c(t,"Core/Axis/Tick.js",[t["Core/Templating.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h,d){let{deg2rad:s}=h,{clamp:f,correctFloat:b,defined:x,destroyObjectProperties:v,extend:g,fireEvent:P,isNumber:_,merge:S,objectEach:k,pick:A}=d;return class{constructor(y,I,D,w,M){this.isNew=!0,this.isNewLabel=!0,this.axis=y,this.pos=I,this.type=D||"",this.parameters=M||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,P(this,"init"),D||w||this.addLabel()}addLabel(){let y=this,I=y.axis,D=I.options,w=I.chart,M=I.categories,z=I.logarithmic,Y=I.names,X=y.pos,Z=A(y.options&&y.options.labels,D.labels),j=I.tickPositions,V=X===j[0],$=X===j[j.length-1],R=(!Z.step||Z.step===1)&&I.tickInterval===1,L=j.info,G=y.label,U,F,H,W=this.parameters.category||(M?A(M[X],Y[X],X):X);z&&_(W)&&(W=b(z.lin2log(W))),I.dateTime&&(L?U=(F=w.time.resolveDTLFormat(D.dateTimeLabelFormats[!D.grid&&L.higherRanks[X]||L.unitName])).main:_(W)&&(U=I.dateTime.getXDateFormat(W,D.dateTimeLabelFormats||{}))),y.isFirst=V,y.isLast=$;let ne={axis:I,chart:w,dateTimeLabelFormat:U,isFirst:V,isLast:$,pos:X,tick:y,tickPositionInfo:L,value:W};P(this,"labelFormat",ne);let ue=Te=>Z.formatter?Z.formatter.call(Te,Te):Z.format?(Te.text=I.defaultLabelFormatter.call(Te),a.format(Z.format,Te,w)):I.defaultLabelFormatter.call(Te),ie=ue.call(ne,ne),oe=F&&F.list;oe?y.shortenLabel=function(){for(H=0;H<oe.length;H++)if(g(ne,{dateTimeLabelFormat:oe[H]}),G.attr({text:ue.call(ne,ne)}),G.getBBox().width<I.getSlotWidth(y)-2*(Z.padding||0))return;G.attr({text:""})}:y.shortenLabel=void 0,R&&I._addedPlotLB&&y.moveLabel(ie,Z),x(G)||y.movedLabel?G&&G.textStr!==ie&&!R&&(!G.textWidth||Z.style.width||G.styles.width||G.css({width:null}),G.attr({text:ie}),G.textPxLength=G.getBBox().width):(y.label=G=y.createLabel(ie,Z),y.rotation=0)}createLabel(y,I,D){let w=this.axis,M=w.chart,z=x(y)&&I.enabled?M.renderer.text(y,D==null?void 0:D.x,D==null?void 0:D.y,I.useHTML).add(w.labelGroup):void 0;return z&&(M.styledMode||z.css(S(I.style)),z.textPxLength=z.getBBox().width),z}destroy(){v(this,this.axis)}getPosition(y,I,D,w){let M=this.axis,z=M.chart,Y=w&&z.oldChartHeight||z.chartHeight,X={x:y?b(M.translate(I+D,void 0,void 0,w)+M.transB):M.left+M.offset+(M.opposite?(w&&z.oldChartWidth||z.chartWidth)-M.right-M.left:0),y:y?Y-M.bottom+M.offset-(M.opposite?M.height:0):b(Y-M.translate(I+D,void 0,void 0,w)-M.transB)};return X.y=f(X.y,-1e9,1e9),P(this,"afterGetPosition",{pos:X}),X}getLabelPosition(y,I,D,w,M,z,Y,X){let Z,j,V=this.axis,$=V.transA,R=V.isLinked&&V.linkedParent?V.linkedParent.reversed:V.reversed,L=V.staggerLines,G=V.tickRotCorr||{x:0,y:0},U=w||V.reserveSpaceDefault?0:-V.labelOffset*(V.labelAlign==="center"?.5:1),F=M.distance,H={};return Z=V.side===0?D.rotation?-F:-D.getBBox().height:V.side===2?G.y+F:Math.cos(D.rotation*s)*(G.y-D.getBBox(!1,0).height/2),x(M.y)&&(Z=V.side===0&&V.horiz?M.y+Z:M.y),y=y+A(M.x,[0,1,0,-1][V.side]*F)+U+G.x-(z&&w?z*$*(R?-1:1):0),I=I+Z-(z&&!w?z*$*(R?1:-1):0),L&&(j=Y/(X||1)%L,V.opposite&&(j=L-j-1),I+=j*(V.labelOffset/L)),H.x=y,H.y=Math.round(I),P(this,"afterGetLabelPosition",{pos:H,tickmarkOffset:z,index:Y}),H}getLabelSize(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0}getMarkPath(y,I,D,w,M=!1,z){return z.crispLine([["M",y,I],["L",y+(M?0:-D),I+(M?D:0)]],w)}handleOverflow(y){let I=this.axis,D=I.options.labels,w=y.x,M=I.chart.chartWidth,z=I.chart.spacing,Y=A(I.labelLeft,Math.min(I.pos,z[3])),X=A(I.labelRight,Math.max(I.isRadial?0:I.pos+I.len,M-z[1])),Z=this.label,j=this.rotation,V={left:0,center:.5,right:1}[I.labelAlign||Z.attr("align")],$=Z.getBBox().width,R=I.getSlotWidth(this),L={},G=R,U=1,F,H,W;j||D.overflow!=="justify"?j<0&&w-V*$<Y?W=Math.round(w/Math.cos(j*s)-Y):j>0&&w+V*$>X&&(W=Math.round((M-w)/Math.cos(j*s))):(F=w-V*$,H=w+(1-V)*$,F<Y?G=y.x+G*(1-V)-Y:H>X&&(G=X-y.x+G*V,U=-1),(G=Math.min(R,G))<R&&I.labelAlign==="center"&&(y.x+=U*(R-G-V*(R-Math.min($,G)))),($>G||I.autoRotation&&(Z.styles||{}).width)&&(W=G)),W&&(this.shortenLabel?this.shortenLabel():(L.width=Math.floor(W)+"px",(D.style||{}).textOverflow||(L.textOverflow="ellipsis"),Z.css(L)))}moveLabel(y,I){let D=this,w=D.label,M=D.axis,z=!1,Y;w&&w.textStr===y?(D.movedLabel=w,z=!0,delete D.label):k(M.ticks,function(X){z||X.isNew||X===D||!X.label||X.label.textStr!==y||(D.movedLabel=X.label,z=!0,X.labelPos=D.movedLabel.xy,delete X.label)}),!z&&(D.labelPos||w)&&(Y=D.labelPos||w.xy,D.movedLabel=D.createLabel(y,I,Y),D.movedLabel&&D.movedLabel.attr({opacity:0}))}render(y,I,D){let w=this.axis,M=w.horiz,z=this.pos,Y=A(this.tickmarkOffset,w.tickmarkOffset),X=this.getPosition(M,z,Y,I),Z=X.x,j=X.y,V=w.pos,$=V+w.len,R=M?Z:j;!w.chart.polar&&this.isNew&&(b(R)<V||R>$)&&(D=0);let L=A(D,this.label&&this.label.newOpacity,1);D=A(D,1),this.isActive=!0,this.renderGridLine(I,D),this.renderMark(X,D),this.renderLabel(X,I,L,y),this.isNew=!1,P(this,"afterRender")}renderGridLine(y,I){let D=this.axis,w=D.options,M={},z=this.pos,Y=this.type,X=A(this.tickmarkOffset,D.tickmarkOffset),Z=D.chart.renderer,j=this.gridLine,V,$=w.gridLineWidth,R=w.gridLineColor,L=w.gridLineDashStyle;this.type==="minor"&&($=w.minorGridLineWidth,R=w.minorGridLineColor,L=w.minorGridLineDashStyle),j||(D.chart.styledMode||(M.stroke=R,M["stroke-width"]=$||0,M.dashstyle=L),Y||(M.zIndex=1),y&&(I=0),this.gridLine=j=Z.path().attr(M).addClass("highcharts-"+(Y?Y+"-":"")+"grid-line").add(D.gridGroup)),j&&(V=D.getPlotLinePath({value:z+X,lineWidth:j.strokeWidth(),force:"pass",old:y,acrossPanes:!1}))&&j[y||this.isNew?"attr":"animate"]({d:V,opacity:I})}renderMark(y,I){let D=this.axis,w=D.options,M=D.chart.renderer,z=this.type,Y=D.tickSize(z?z+"Tick":"tick"),X=y.x,Z=y.y,j=A(w[z!=="minor"?"tickWidth":"minorTickWidth"],!z&&D.isXAxis?1:0),V=w[z!=="minor"?"tickColor":"minorTickColor"],$=this.mark,R=!$;Y&&(D.opposite&&(Y[0]=-Y[0]),$||(this.mark=$=M.path().addClass("highcharts-"+(z?z+"-":"")+"tick").add(D.axisGroup),D.chart.styledMode||$.attr({stroke:V,"stroke-width":j})),$[R?"attr":"animate"]({d:this.getMarkPath(X,Z,Y[0],$.strokeWidth(),D.horiz,M),opacity:I}))}renderLabel(y,I,D,w){let M=this.axis,z=M.horiz,Y=M.options,X=this.label,Z=Y.labels,j=Z.step,V=A(this.tickmarkOffset,M.tickmarkOffset),$=y.x,R=y.y,L=!0;X&&_($)&&(X.xy=y=this.getLabelPosition($,R,X,z,Z,V,w,j),(!this.isFirst||this.isLast||Y.showFirstLabel)&&(!this.isLast||this.isFirst||Y.showLastLabel)?!z||Z.step||Z.rotation||I||D===0||this.handleOverflow(y):L=!1,j&&w%j&&(L=!1),L&&_(y.y)?(y.opacity=D,X[this.isNewLabel?"attr":"animate"](y).show(!0),this.isNewLabel=!1):(X.hide(),this.isNewLabel=!0))}replaceMovedLabel(){let y=this.label,I=this.axis;y&&!this.isNew&&(y.animate({opacity:0},void 0,y.destroy),delete this.label),I.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel}}}),c(t,"Core/Axis/Axis.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Axis/AxisDefaults.js"],t["Core/Color/Color.js"],t["Core/Defaults.js"],t["Core/Foundation.js"],t["Core/Globals.js"],t["Core/Axis/Tick.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b,x,v){let{animObject:g}=a,{xAxis:P,yAxis:_}=h,{defaultOptions:S}=s,{registerEventOptions:k}=f,{deg2rad:A}=b,{arrayMax:y,arrayMin:I,clamp:D,correctFloat:w,defined:M,destroyObjectProperties:z,erase:Y,error:X,extend:Z,fireEvent:j,getClosestDistance:V,insertItem:$,isArray:R,isNumber:L,isString:G,merge:U,normalizeTickInterval:F,objectEach:H,pick:W,relativeLength:ne,removeEvent:ue,splat:ie,syncTimeout:oe}=v,Te=(we,K)=>F(K,void 0,void 0,W(we.options.allowDecimals,K<.5||we.tickAmount!==void 0),!!we.tickAmount);Z(S,{xAxis:P,yAxis:U(P,_)});class ge{constructor(K,Q,ae){this.init(K,Q,ae)}init(K,Q,ae=this.coll){let ye=ae==="xAxis",J=this.isZAxis||(K.inverted?!ye:ye);this.chart=K,this.horiz=J,this.isXAxis=ye,this.coll=ae,j(this,"init",{userOptions:Q}),this.opposite=W(Q.opposite,this.opposite),this.side=W(Q.side,this.side,J?this.opposite?0:2:this.opposite?1:3),this.setOptions(Q);let re=this.options,ce=re.labels;this.type??(this.type=re.type||"linear"),this.uniqueNames??(this.uniqueNames=re.uniqueNames??!0),j(this,"afterSetType"),this.userOptions=Q,this.minPixelPadding=0,this.reversed=W(re.reversed,this.reversed),this.visible=re.visible,this.zoomEnabled=re.zoomEnabled,this.hasNames=this.type==="category"||re.categories===!0,this.categories=R(re.categories)&&re.categories||(this.hasNames?[]:void 0),this.names||(this.names=[],this.names.keys={}),this.plotLinesAndBandsGroups={},this.positiveValuesOnly=!!this.logarithmic,this.isLinked=M(re.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len??(this.len=0),this.minRange=this.userMinRange=re.minRange||re.maxZoom,this.range=re.range,this.offset=re.offset||0,this.max=void 0,this.min=void 0;let pe=W(re.crosshair,ie(K.options.tooltip.crosshairs)[ye?0:1]);this.crosshair=pe===!0?{}:pe,K.axes.indexOf(this)===-1&&(ye?K.axes.splice(K.xAxis.length,0,this):K.axes.push(this),$(this,K[this.coll])),K.orderItems(this.coll),this.series=this.series||[],K.inverted&&!this.isZAxis&&ye&&!M(this.reversed)&&(this.reversed=!0),this.labelRotation=L(ce.rotation)?ce.rotation:void 0,k(this,re),j(this,"afterInit")}setOptions(K){let Q=this.horiz?{labels:{autoRotation:[-45],padding:4},margin:15}:{labels:{padding:1},title:{rotation:90*this.side}};this.options=U(Q,S[this.coll],K),j(this,"afterSetOptions",{userOptions:K})}defaultLabelFormatter(){let K=this.axis,{numberFormatter:Q}=this.chart,ae=L(this.value)?this.value:NaN,ye=K.chart.time,J=K.categories,re=this.dateTimeLabelFormat,ce=S.lang,pe=ce.numericSymbols,xe=ce.numericSymbolMagnitude||1e3,Me=K.logarithmic?Math.abs(ae):K.tickInterval,_e=pe&&pe.length,Ce,Le;if(J)Le=`${this.value}`;else if(re)Le=ye.dateFormat(re,ae);else if(_e&&pe&&Me>=1e3)for(;_e--&&Le===void 0;)Me>=(Ce=Math.pow(xe,_e+1))&&10*ae%Ce==0&&pe[_e]!==null&&ae!==0&&(Le=Q(ae/Ce,-1)+pe[_e]);return Le===void 0&&(Le=Math.abs(ae)>=1e4?Q(ae,-1):Q(ae,-1,void 0,"")),Le}getSeriesExtremes(){let K,Q=this;j(this,"getSeriesExtremes",null,function(){Q.hasVisibleSeries=!1,Q.dataMin=Q.dataMax=Q.threshold=void 0,Q.softThreshold=!Q.isXAxis,Q.series.forEach(ae=>{if(ae.reserveSpace()){let ye=ae.options,J,re=ye.threshold,ce,pe;if(Q.hasVisibleSeries=!0,Q.positiveValuesOnly&&0>=(re||0)&&(re=void 0),Q.isXAxis)(J=ae.xData)&&J.length&&(J=Q.logarithmic?J.filter(xe=>xe>0):J,ce=(K=ae.getXExtremes(J)).min,pe=K.max,L(ce)||ce instanceof Date||(J=J.filter(L),ce=(K=ae.getXExtremes(J)).min,pe=K.max),J.length&&(Q.dataMin=Math.min(W(Q.dataMin,ce),ce),Q.dataMax=Math.max(W(Q.dataMax,pe),pe)));else{let xe=ae.applyExtremes();L(xe.dataMin)&&(ce=xe.dataMin,Q.dataMin=Math.min(W(Q.dataMin,ce),ce)),L(xe.dataMax)&&(pe=xe.dataMax,Q.dataMax=Math.max(W(Q.dataMax,pe),pe)),M(re)&&(Q.threshold=re),(!ye.softThreshold||Q.positiveValuesOnly)&&(Q.softThreshold=!1)}}})}),j(this,"afterGetSeriesExtremes")}translate(K,Q,ae,ye,J,re){var Xe;let ce=this.linkedParent||this,pe=ye&&ce.old?ce.old.min:ce.min;if(!L(pe))return NaN;let xe=ce.minPixelPadding,Me=(ce.isOrdinal||((Xe=ce.brokenAxis)==null?void 0:Xe.hasBreaks)||ce.logarithmic&&J)&&ce.lin2val,_e=1,Ce=0,Le=ye&&ce.old?ce.old.transA:ce.transA,Ue=0;return Le||(Le=ce.transA),ae&&(_e*=-1,Ce=ce.len),ce.reversed&&(_e*=-1,Ce-=_e*(ce.sector||ce.len)),Q?(Ue=(K=K*_e+Ce-xe)/Le+pe,Me&&(Ue=ce.lin2val(Ue))):(Me&&(K=ce.val2lin(K)),Ue=_e*(K-pe)*Le+Ce+_e*xe+(L(re)?Le*re:0),ce.isRadial||(Ue=w(Ue))),Ue}toPixels(K,Q){return this.translate(K,!1,!this.horiz,void 0,!0)+(Q?0:this.pos)}toValue(K,Q){return this.translate(K-(Q?0:this.pos),!0,!this.horiz,void 0,!0)}getPlotLinePath(K){let Q=this,ae=Q.chart,ye=Q.left,J=Q.top,re=K.old,ce=K.value,pe=K.lineWidth,xe=re&&ae.oldChartHeight||ae.chartHeight,Me=re&&ae.oldChartWidth||ae.chartWidth,_e=Q.transB,Ce=K.translatedValue,Le=K.force,Ue,Xe,Pe,Ee,Ie;function Oe(Fe,Ke,rt){return Le!=="pass"&&(Fe<Ke||Fe>rt)&&(Le?Fe=D(Fe,Ke,rt):Ie=!0),Fe}let Re={value:ce,lineWidth:pe,old:re,force:Le,acrossPanes:K.acrossPanes,translatedValue:Ce};return j(this,"getPlotLinePath",Re,function(Fe){Ue=Pe=(Ce=D(Ce=W(Ce,Q.translate(ce,void 0,void 0,re)),-1e9,1e9))+_e,Xe=Ee=xe-Ce-_e,L(Ce)?Q.horiz?(Xe=J,Ee=xe-Q.bottom+(Q.options.isInternal?0:ae.scrollablePixelsY||0),Ue=Pe=Oe(Ue,ye,ye+Q.width)):(Ue=ye,Pe=Me-Q.right+(ae.scrollablePixelsX||0),Xe=Ee=Oe(Xe,J,J+Q.height)):(Ie=!0,Le=!1),Fe.path=Ie&&!Le?void 0:ae.renderer.crispLine([["M",Ue,Xe],["L",Pe,Ee]],pe||1)}),Re.path}getLinearTickPositions(K,Q,ae){let ye,J,re,ce=w(Math.floor(Q/K)*K),pe=w(Math.ceil(ae/K)*K),xe=[];if(w(ce+K)===ce&&(re=20),this.single)return[Q];for(ye=ce;ye<=pe&&(xe.push(ye),(ye=w(ye+K,re))!==J);)J=ye;return xe}getMinorTickInterval(){let{minorTicks:K,minorTickInterval:Q}=this.options;return K===!0?W(Q,"auto"):K!==!1?Q:void 0}getMinorTickPositions(){let K=this.options,Q=this.tickPositions,ae=this.minorTickInterval,ye=this.pointRangePadding||0,J=(this.min||0)-ye,re=(this.max||0)+ye,ce=re-J,pe=[],xe;if(ce&&ce/ae<this.len/3){let Me=this.logarithmic;if(Me)this.paddedTicks.forEach(function(_e,Ce,Le){Ce&&pe.push.apply(pe,Me.getLogTickPositions(ae,Le[Ce-1],Le[Ce],!0))});else if(this.dateTime&&this.getMinorTickInterval()==="auto")pe=pe.concat(this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(ae),J,re,K.startOfWeek));else for(xe=J+(Q[0]-J)%ae;xe<=re&&xe!==pe[0];xe+=ae)pe.push(xe)}return pe.length!==0&&this.trimTicks(pe),pe}adjustForMinRange(){let K=this.options,Q=this.logarithmic,{max:ae,min:ye,minRange:J}=this,re,ce,pe,xe;this.isXAxis&&J===void 0&&!Q&&(J=M(K.min)||M(K.max)||M(K.floor)||M(K.ceiling)?null:Math.min(5*(V(this.series.map(Me=>{var _e;return(Me.xIncrement?(_e=Me.xData)==null?void 0:_e.slice(0,2):Me.xData)||[]}))||0),this.dataMax-this.dataMin)),L(ae)&&L(ye)&&L(J)&&ae-ye<J&&(ce=this.dataMax-this.dataMin>=J,re=(J-ae+ye)/2,pe=[ye-re,W(K.min,ye-re)],ce&&(pe[2]=Q?Q.log2lin(this.dataMin):this.dataMin),xe=[(ye=y(pe))+J,W(K.max,ye+J)],ce&&(xe[2]=Q?Q.log2lin(this.dataMax):this.dataMax),(ae=I(xe))-ye<J&&(pe[0]=ae-J,pe[1]=W(K.min,ae-J),ye=y(pe))),this.minRange=J,this.min=ye,this.max=ae}getClosest(){let K,Q;if(this.categories)Q=1;else{let ae=[];this.series.forEach(function(ye){var re;let J=ye.closestPointRange;((re=ye.xData)==null?void 0:re.length)===1?ae.push(ye.xData[0]):!ye.noSharedTooltip&&M(J)&&ye.reserveSpace()&&(Q=M(Q)?Math.min(Q,J):J)}),ae.length&&(ae.sort((ye,J)=>ye-J),K=V([ae]))}return K&&Q?Math.min(K,Q):K||Q}nameToX(K){let Q=R(this.options.categories),ae=Q?this.categories:this.names,ye=K.options.x,J;return K.series.requireSorting=!1,M(ye)||(ye=this.uniqueNames&&ae?Q?ae.indexOf(K.name):W(ae.keys[K.name],-1):K.series.autoIncrement()),ye===-1?!Q&&ae&&(J=ae.length):J=ye,J!==void 0?(this.names[J]=K.name,this.names.keys[K.name]=J):K.x&&(J=K.x),J}updateNames(){let K=this,Q=this.names;Q.length>0&&(Object.keys(Q.keys).forEach(function(ae){delete Q.keys[ae]}),Q.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(ae=>{ae.xIncrement=null,(!ae.points||ae.isDirtyData)&&(K.max=Math.max(K.max,ae.xData.length-1),ae.processData(),ae.generatePoints()),ae.data.forEach(function(ye,J){let re;ye!=null&&ye.options&&ye.name!==void 0&&(re=K.nameToX(ye))!==void 0&&re!==ye.x&&(ye.x=re,ae.xData[J]=re)})}))}setAxisTranslation(){let K=this,Q=K.max-K.min,ae=K.linkedParent,ye=!!K.categories,J=K.isXAxis,re=K.axisPointRange||0,ce,pe=0,xe=0,Me,_e=K.transA;(J||ye||re)&&(ce=K.getClosest(),ae?(pe=ae.minPointOffset,xe=ae.pointRangePadding):K.series.forEach(function(Ce){let Le=ye?1:J?W(Ce.options.pointRange,ce,0):K.axisPointRange||0,Ue=Ce.options.pointPlacement;if(re=Math.max(re,Le),!K.single||ye){let Xe=Ce.is("xrange")?!J:J;pe=Math.max(pe,Xe&&G(Ue)?0:Le/2),xe=Math.max(xe,Xe&&Ue==="on"?0:Le)}}),Me=K.ordinal&&K.ordinal.slope&&ce?K.ordinal.slope/ce:1,K.minPointOffset=pe*=Me,K.pointRangePadding=xe*=Me,K.pointRange=Math.min(re,K.single&&ye?1:Q),J&&ce&&(K.closestPointRange=ce)),K.translationSlope=K.transA=_e=K.staticScale||K.len/(Q+xe||1),K.transB=K.horiz?K.left:K.bottom,K.minPixelPadding=_e*pe,j(this,"afterSetAxisTranslation")}minFromRange(){let{max:K,min:Q}=this;return L(K)&&L(Q)&&K-Q||void 0}setTickInterval(K){var Ct,Et,ri,ci;let{categories:Q,chart:ae,dataMax:ye,dataMin:J,dateTime:re,isXAxis:ce,logarithmic:pe,options:xe,softThreshold:Me}=this,_e=L(this.threshold)?this.threshold:void 0,Ce=this.minRange||0,{ceiling:Le,floor:Ue,linkedTo:Xe,softMax:Pe,softMin:Ee}=xe,Ie=L(Xe)&&((Ct=ae[this.coll])==null?void 0:Ct[Xe]),Oe=xe.tickPixelInterval,Re=xe.maxPadding,Fe=xe.minPadding,Ke=0,rt,at=L(xe.tickInterval)&&xe.tickInterval>=0?xe.tickInterval:void 0,ut,mt,Tt,Rt;if(re||Q||Ie||this.getTickAmount(),Tt=W(this.userMin,xe.min),Rt=W(this.userMax,xe.max),Ie?(this.linkedParent=Ie,rt=Ie.getExtremes(),this.min=W(rt.min,rt.dataMin),this.max=W(rt.max,rt.dataMax),this.type!==Ie.type&&X(11,!0,ae)):(Me&&M(_e)&&L(ye)&&L(J)&&(J>=_e?(ut=_e,Fe=0):ye<=_e&&(mt=_e,Re=0)),this.min=W(Tt,ut,J),this.max=W(Rt,mt,ye)),L(this.max)&&L(this.min)&&(pe&&(this.positiveValuesOnly&&!K&&0>=Math.min(this.min,W(J,this.min))&&X(10,!0,ae),this.min=w(pe.log2lin(this.min),16),this.max=w(pe.log2lin(this.max),16)),this.range&&L(J)&&(this.userMin=this.min=Tt=Math.max(J,this.minFromRange()||0),this.userMax=Rt=this.max,this.range=void 0)),j(this,"foundExtremes"),this.adjustForMinRange(),L(this.min)&&L(this.max)){if(!L(this.userMin)&&L(Ee)&&Ee<this.min&&(this.min=Tt=Ee),!L(this.userMax)&&L(Pe)&&Pe>this.max&&(this.max=Rt=Pe),Q||this.axisPointRange||(Et=this.stacking)!=null&&Et.usePercentage||Ie||!(Ke=this.max-this.min)||(!M(Tt)&&Fe&&(this.min-=Ke*Fe),M(Rt)||!Re||(this.max+=Ke*Re)),!L(this.userMin)&&L(Ue)&&(this.min=Math.max(this.min,Ue)),!L(this.userMax)&&L(Le)&&(this.max=Math.min(this.max,Le)),Me&&L(J)&&L(ye)){let Vt=_e||0;!M(Tt)&&this.min<Vt&&J>=Vt?this.min=xe.minRange?Math.min(Vt,this.max-Ce):Vt:!M(Rt)&&this.max>Vt&&ye<=Vt&&(this.max=xe.minRange?Math.max(Vt,this.min+Ce):Vt)}!ae.polar&&this.min>this.max&&(M(xe.min)?this.max=this.min:M(xe.max)&&(this.min=this.max)),Ke=this.max-this.min}if(this.min!==this.max&&L(this.min)&&L(this.max)?Ie&&!at&&Oe===Ie.options.tickPixelInterval?this.tickInterval=at=Ie.tickInterval:this.tickInterval=W(at,this.tickAmount?Ke/Math.max(this.tickAmount-1,1):void 0,Q?1:Ke*Oe/Math.max(this.len,Oe)):this.tickInterval=1,ce&&!K){let Vt=this.min!==((ri=this.old)==null?void 0:ri.min)||this.max!==((ci=this.old)==null?void 0:ci.max);this.series.forEach(function(Ji){var Vi;Ji.forceCrop=(Vi=Ji.forceCropping)==null?void 0:Vi.call(Ji),Ji.processData(Vt)}),j(this,"postProcessData",{hasExtremesChanged:Vt})}this.setAxisTranslation(),j(this,"initialAxisTranslation"),this.pointRange&&!at&&(this.tickInterval=Math.max(this.pointRange,this.tickInterval));let pt=W(xe.minTickInterval,re&&!this.series.some(Vt=>Vt.noSharedTooltip)?this.closestPointRange:0);!at&&this.tickInterval<pt&&(this.tickInterval=pt),re||pe||at||(this.tickInterval=Te(this,this.tickInterval)),this.tickAmount||(this.tickInterval=this.unsquish()),this.setTickPositions()}setTickPositions(){var Me,_e;let K=this.options,Q=K.tickPositions,ae=K.tickPositioner,ye=this.getMinorTickInterval(),J=!this.isPanning,re=J&&K.startOnTick,ce=J&&K.endOnTick,pe=[],xe;if(this.tickmarkOffset=this.categories&&K.tickmarkPlacement==="between"&&this.tickInterval===1?.5:0,this.single=this.min===this.max&&M(this.min)&&!this.tickAmount&&(this.min%1==0||K.allowDecimals!==!1),Q)pe=Q.slice();else if(L(this.min)&&L(this.max)){if(!((Me=this.ordinal)!=null&&Me.positions)&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200))pe=[this.min,this.max],X(19,!1,this.chart);else if(this.dateTime)pe=this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(this.tickInterval,K.units),this.min,this.max,K.startOfWeek,(_e=this.ordinal)==null?void 0:_e.positions,this.closestPointRange,!0);else if(this.logarithmic)pe=this.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else{let Ce=this.tickInterval,Le=Ce;for(;Le<=2*Ce&&(pe=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&pe.length>this.tickAmount);)this.tickInterval=Te(this,Le*=1.1)}pe.length>this.len&&(pe=[pe[0],pe[pe.length-1]])[0]===pe[1]&&(pe.length=1),ae&&(this.tickPositions=pe,(xe=ae.apply(this,[this.min,this.max]))&&(pe=xe))}this.tickPositions=pe,this.minorTickInterval=ye==="auto"&&this.tickInterval?this.tickInterval/K.minorTicksPerMajor:ye,this.paddedTicks=pe.slice(0),this.trimTicks(pe,re,ce),!this.isLinked&&L(this.min)&&L(this.max)&&(this.single&&pe.length<2&&!this.categories&&!this.series.some(Ce=>Ce.is("heatmap")&&Ce.options.pointPlacement==="between")&&(this.min-=.5,this.max+=.5),Q||xe||this.adjustTickAmount()),j(this,"afterSetTickPositions")}trimTicks(K,Q,ae){let ye=K[0],J=K[K.length-1],re=!this.isOrdinal&&this.minPointOffset||0;if(j(this,"trimTicks"),!this.isLinked){if(Q&&ye!==-1/0)this.min=ye;else for(;this.min-re>K[0];)K.shift();if(ae)this.max=J;else for(;this.max+re<K[K.length-1];)K.pop();K.length===0&&M(ye)&&!this.options.tickPositions&&K.push((J+ye)/2)}}alignToOthers(){let K,Q=this,ae=Q.chart,ye=[this],J=Q.options,re=ae.options.chart,ce=this.coll==="yAxis"&&re.alignThresholds,pe=[];if(Q.thresholdAlignment=void 0,(re.alignTicks!==!1&&J.alignTicks||ce)&&J.startOnTick!==!1&&J.endOnTick!==!1&&!Q.logarithmic){let xe=_e=>{let{horiz:Ce,options:Le}=_e;return[Ce?Le.left:Le.top,Le.width,Le.height,Le.pane].join(",")},Me=xe(this);ae[this.coll].forEach(function(_e){let{series:Ce}=_e;Ce.length&&Ce.some(Le=>Le.visible)&&_e!==Q&&xe(_e)===Me&&(K=!0,ye.push(_e))})}if(K&&ce){ye.forEach(Me=>{let _e=Me.getThresholdAlignment(Q);L(_e)&&pe.push(_e)});let xe=pe.length>1?pe.reduce((Me,_e)=>Me+=_e,0)/pe.length:void 0;ye.forEach(Me=>{Me.thresholdAlignment=xe})}return K}getThresholdAlignment(K){if((!L(this.dataMin)||this!==K&&this.series.some(Q=>Q.isDirty||Q.isDirtyData))&&this.getSeriesExtremes(),L(this.threshold)){let Q=D((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1);return this.options.reversed&&(Q=1-Q),Q}}getTickAmount(){let K=this.options,Q=K.tickPixelInterval,ae=K.tickAmount;M(K.tickInterval)||ae||!(this.len<Q)||this.isRadial||this.logarithmic||!K.startOnTick||!K.endOnTick||(ae=2),!ae&&this.alignToOthers()&&(ae=Math.ceil(this.len/Q)+1),ae<4&&(this.finalTickAmt=ae,ae=5),this.tickAmount=ae}adjustTickAmount(){let K=this,{finalTickAmt:Q,max:ae,min:ye,options:J,tickPositions:re,tickAmount:ce,thresholdAlignment:pe}=K,xe=re==null?void 0:re.length,Me=W(K.threshold,K.softThreshold?0:null),_e,Ce,Le=K.tickInterval,Ue,Xe=()=>re.push(w(re[re.length-1]+Le)),Pe=()=>re.unshift(w(re[0]-Le));if(L(pe)&&(Ue=pe<.5?Math.ceil(pe*(ce-1)):Math.floor(pe*(ce-1)),J.reversed&&(Ue=ce-1-Ue)),K.hasData()&&L(ye)&&L(ae)){let Ee=()=>{K.transA*=(xe-1)/(ce-1),K.min=J.startOnTick?re[0]:Math.min(ye,re[0]),K.max=J.endOnTick?re[re.length-1]:Math.max(ae,re[re.length-1])};if(L(Ue)&&L(K.threshold)){for(;re[Ue]!==Me||re.length!==ce||re[0]>ye||re[re.length-1]<ae;){for(re.length=0,re.push(K.threshold);re.length<ce;)re[Ue]===void 0||re[Ue]>K.threshold?Pe():Xe();if(Le>8*K.tickInterval)break;Le*=2}Ee()}else if(xe<ce){for(;re.length<ce;)re.length%2||ye===Me?Xe():Pe();Ee()}if(M(Q)){for(Ce=_e=re.length;Ce--;)(Q===3&&Ce%2==1||Q<=2&&Ce>0&&Ce<_e-1)&&re.splice(Ce,1);K.finalTickAmt=void 0}}}setScale(){var re,ce;let{coll:K,stacking:Q}=this,ae=!1,ye=!1;this.series.forEach(pe=>{ae=ae||pe.isDirtyData||pe.isDirty,ye=ye||pe.xAxis&&pe.xAxis.isDirty||!1}),this.setAxisSize();let J=this.len!==(this.old&&this.old.len);J||ae||ye||this.isLinked||this.forceRedraw||this.userMin!==(this.old&&this.old.userMin)||this.userMax!==(this.old&&this.old.userMax)||this.alignToOthers()?(Q&&K==="yAxis"&&Q.buildStacks(),this.forceRedraw=!1,this.userMinRange||(this.minRange=void 0),this.getSeriesExtremes(),this.setTickInterval(),Q&&K==="xAxis"&&Q.buildStacks(),this.isDirty||(this.isDirty=J||this.min!==((re=this.old)==null?void 0:re.min)||this.max!==((ce=this.old)==null?void 0:ce.max))):Q&&Q.cleanStacks(),ae&&delete this.allExtremes,j(this,"afterSetScale")}setExtremes(K,Q,ae=!0,ye,J){this.series.forEach(re=>{delete re.kdTree}),j(this,"setExtremes",J=Z(J,{min:K,max:Q}),re=>{this.userMin=re.min,this.userMax=re.max,this.eventArgs=re,ae&&this.chart.redraw(ye)})}setAxisSize(){let K=this.chart,Q=this.options,ae=Q.offsets||[0,0,0,0],ye=this.horiz,J=this.width=Math.round(ne(W(Q.width,K.plotWidth-ae[3]+ae[1]),K.plotWidth)),re=this.height=Math.round(ne(W(Q.height,K.plotHeight-ae[0]+ae[2]),K.plotHeight)),ce=this.top=Math.round(ne(W(Q.top,K.plotTop+ae[0]),K.plotHeight,K.plotTop)),pe=this.left=Math.round(ne(W(Q.left,K.plotLeft+ae[3]),K.plotWidth,K.plotLeft));this.bottom=K.chartHeight-re-ce,this.right=K.chartWidth-J-pe,this.len=Math.max(ye?J:re,0),this.pos=ye?pe:ce}getExtremes(){let K=this.logarithmic;return{min:K?w(K.lin2log(this.min)):this.min,max:K?w(K.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}}getThreshold(K){let Q=this.logarithmic,ae=Q?Q.lin2log(this.min):this.min,ye=Q?Q.lin2log(this.max):this.max;return K===null||K===-1/0?K=ae:K===1/0?K=ye:ae>K?K=ae:ye<K&&(K=ye),this.translate(K,0,1,0,1)}autoLabelAlign(K){let Q=(W(K,0)-90*this.side+720)%360,ae={align:"center"};return j(this,"autoLabelAlign",ae,function(ye){Q>15&&Q<165?ye.align="right":Q>195&&Q<345&&(ye.align="left")}),ae.align}tickSize(K){let Q=this.options,ae=W(Q[K==="tick"?"tickWidth":"minorTickWidth"],K==="tick"&&this.isXAxis&&!this.categories?1:0),ye=Q[K==="tick"?"tickLength":"minorTickLength"],J;ae&&ye&&(Q[K+"Position"]==="inside"&&(ye=-ye),J=[ye,ae]);let re={tickSize:J};return j(this,"afterTickSize",re),re.tickSize}labelMetrics(){let K=this.chart.renderer,Q=this.ticks,ae=Q[Object.keys(Q)[0]]||{};return this.chart.renderer.fontMetrics(ae.label||ae.movedLabel||K.box)}unsquish(){let K=this.options.labels,Q=K.padding||0,ae=this.horiz,ye=this.tickInterval,J=this.len/(((this.categories?1:0)+this.max-this.min)/ye),re=K.rotation,ce=w(.8*this.labelMetrics().h),pe=Math.max(this.max-this.min,0),xe=function(Ue){let Xe=(Ue+2*Q)/(J||1);return(Xe=Xe>1?Math.ceil(Xe):1)*ye>pe&&Ue!==1/0&&J!==1/0&&pe&&(Xe=Math.ceil(pe/ye)),w(Xe*ye)},Me=ye,_e,Ce=Number.MAX_VALUE,Le;if(ae){if(!K.staggerLines&&(L(re)?Le=[re]:J<K.autoRotationLimit&&(Le=K.autoRotation)),Le){let Ue,Xe;for(let Pe of Le)(Pe===re||Pe&&Pe>=-90&&Pe<=90)&&(Xe=(Ue=xe(Math.abs(ce/Math.sin(A*Pe))))+Math.abs(Pe/360))<Ce&&(Ce=Xe,_e=Pe,Me=Ue)}}else Me=xe(.75*ce);return this.autoRotation=Le,this.labelRotation=W(_e,L(re)?re:0),K.step?ye:Me}getSlotWidth(K){let Q=this.chart,ae=this.horiz,ye=this.options.labels,J=Math.max(this.tickPositions.length-(this.categories?0:1),1),re=Q.margin[3];if(K&&L(K.slotWidth))return K.slotWidth;if(ae&&ye.step<2)return ye.rotation?0:(this.staggerLines||1)*this.len/J;if(!ae){let ce=ye.style.width;if(ce!==void 0)return parseInt(String(ce),10);if(re)return re-Q.spacing[3]}return .33*Q.chartWidth}renderUnsquish(){let K=this.chart,Q=K.renderer,ae=this.tickPositions,ye=this.ticks,J=this.options.labels,re=J.style,ce=this.horiz,pe=this.getSlotWidth(),xe=Math.max(1,Math.round(pe-(ce?2*(J.padding||0):J.distance||0))),Me={},_e=this.labelMetrics(),Ce=re.textOverflow,Le,Ue,Xe=0,Pe,Ee;if(G(J.rotation)||(Me.rotation=J.rotation||0),ae.forEach(function(Ie){let Oe=ye[Ie];Oe.movedLabel&&Oe.replaceMovedLabel(),Oe&&Oe.label&&Oe.label.textPxLength>Xe&&(Xe=Oe.label.textPxLength)}),this.maxLabelLength=Xe,this.autoRotation)Xe>xe&&Xe>_e.h?Me.rotation=this.labelRotation:this.labelRotation=0;else if(pe&&(Le=xe,!Ce))for(Ue="clip",Ee=ae.length;!ce&&Ee--;)(Pe=ye[ae[Ee]].label)&&(Pe.styles.textOverflow==="ellipsis"?Pe.css({textOverflow:"clip"}):Pe.textPxLength>pe&&Pe.css({width:pe+"px"}),Pe.getBBox().height>this.len/ae.length-(_e.h-_e.f)&&(Pe.specificTextOverflow="ellipsis"));Me.rotation&&(Le=Xe>.5*K.chartHeight?.33*K.chartHeight:Xe,Ce||(Ue="ellipsis")),this.labelAlign=J.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(Me.align=this.labelAlign),ae.forEach(function(Ie){let Oe=ye[Ie],Re=Oe&&Oe.label,Fe=re.width,Ke={};Re&&(Re.attr(Me),Oe.shortenLabel?Oe.shortenLabel():Le&&!Fe&&re.whiteSpace!=="nowrap"&&(Le<Re.textPxLength||Re.element.tagName==="SPAN")?(Ke.width=Le+"px",Ce||(Ke.textOverflow=Re.specificTextOverflow||Ue),Re.css(Ke)):!Re.styles.width||Ke.width||Fe||Re.css({width:null}),delete Re.specificTextOverflow,Oe.rotation=Me.rotation)},this),this.tickRotCorr=Q.rotCorr(_e.b,this.labelRotation||0,this.side!==0)}hasData(){return this.series.some(function(K){return K.hasData()})||this.options.showEmpty&&M(this.min)&&M(this.max)}addTitle(K){let Q,ae=this.chart.renderer,ye=this.horiz,J=this.opposite,re=this.options.title,ce=this.chart.styledMode;this.axisTitle||((Q=re.textAlign)||(Q=(ye?{low:"left",middle:"center",high:"right"}:{low:J?"right":"left",middle:"center",high:J?"left":"right"})[re.align]),this.axisTitle=ae.text(re.text||"",0,0,re.useHTML).attr({zIndex:7,rotation:re.rotation||0,align:Q}).addClass("highcharts-axis-title"),ce||this.axisTitle.css(U(re.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),ce||re.style.width||this.isRadial||this.axisTitle.css({width:this.len+"px"}),this.axisTitle[K?"show":"hide"](K)}generateTick(K){let Q=this.ticks;Q[K]?Q[K].addLabel():Q[K]=new x(this,K)}createGroups(){let{axisParent:K,chart:Q,coll:ae,options:ye}=this,J=Q.renderer,re=(ce,pe,xe)=>J.g(ce).attr({zIndex:xe}).addClass(`highcharts-${ae.toLowerCase()}${pe} `+(this.isRadial?`highcharts-radial-axis${pe} `:"")+(ye.className||"")).add(K);this.axisGroup||(this.gridGroup=re("grid","-grid",ye.gridZIndex),this.axisGroup=re("axis","",ye.zIndex),this.labelGroup=re("axis-labels","-labels",ye.labels.zIndex))}getOffset(){let K=this,{chart:Q,horiz:ae,options:ye,side:J,ticks:re,tickPositions:ce,coll:pe}=K,xe=Q.inverted&&!K.isZAxis?[1,0,3,2][J]:J,Me=K.hasData(),_e=ye.title,Ce=ye.labels,Le=L(ye.crossing),Ue=Q.axisOffset,Xe=Q.clipOffset,Pe=[-1,1,1,-1][J],Ee,Ie=0,Oe,Re=0,Fe=0,Ke,rt;if(K.showAxis=Ee=Me||ye.showEmpty,K.staggerLines=K.horiz&&Ce.staggerLines||void 0,K.createGroups(),Me||K.isLinked?(ce.forEach(function(at){K.generateTick(at)}),K.renderUnsquish(),K.reserveSpaceDefault=J===0||J===2||{1:"left",3:"right"}[J]===K.labelAlign,W(Ce.reserveSpace,!Le&&null,K.labelAlign==="center"||null,K.reserveSpaceDefault)&&ce.forEach(function(at){Fe=Math.max(re[at].getLabelSize(),Fe)}),K.staggerLines&&(Fe*=K.staggerLines),K.labelOffset=Fe*(K.opposite?-1:1)):H(re,function(at,ut){at.destroy(),delete re[ut]}),_e!=null&&_e.text&&_e.enabled!==!1&&(K.addTitle(Ee),Ee&&!Le&&_e.reserveSpace!==!1&&(K.titleOffset=Ie=K.axisTitle.getBBox()[ae?"height":"width"],Re=M(Oe=_e.offset)?0:W(_e.margin,ae?5:10))),K.renderLine(),K.offset=Pe*W(ye.offset,Ue[J]?Ue[J]+(ye.margin||0):0),K.tickRotCorr=K.tickRotCorr||{x:0,y:0},rt=J===0?-K.labelMetrics().h:J===2?K.tickRotCorr.y:0,Ke=Math.abs(Fe)+Re,Fe&&(Ke-=rt,Ke+=Pe*(ae?W(Ce.y,K.tickRotCorr.y+Pe*Ce.distance):W(Ce.x,Pe*Ce.distance))),K.axisTitleMargin=W(Oe,Ke),K.getMaxLabelDimensions&&(K.maxLabelDimensions=K.getMaxLabelDimensions(re,ce)),pe!=="colorAxis"&&Xe){let at=this.tickSize("tick");Ue[J]=Math.max(Ue[J],(K.axisTitleMargin||0)+Ie+Pe*K.offset,Ke,ce&&ce.length&&at?at[0]+Pe*K.offset:0);let ut=!K.axisLine||ye.offset?0:K.axisLine.strokeWidth()/2;Xe[xe]=Math.max(Xe[xe],ut)}j(this,"afterGetOffset")}getLinePath(K){let Q=this.chart,ae=this.opposite,ye=this.offset,J=this.horiz,re=this.left+(ae?this.width:0)+ye,ce=Q.chartHeight-this.bottom-(ae?this.height:0)+ye;return ae&&(K*=-1),Q.renderer.crispLine([["M",J?this.left:re,J?ce:this.top],["L",J?Q.chartWidth-this.right:re,J?ce:Q.chartHeight-this.bottom]],K)}renderLine(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))}getTitlePosition(K){let Q=this.horiz,ae=this.left,ye=this.top,J=this.len,re=this.options.title,ce=Q?ae:ye,pe=this.opposite,xe=this.offset,Me=re.x,_e=re.y,Ce=this.chart.renderer.fontMetrics(K),Le=K?Math.max(K.getBBox(!1,0).height-Ce.h-1,0):0,Ue={low:ce+(Q?0:J),middle:ce+J/2,high:ce+(Q?J:0)}[re.align],Xe=(Q?ye+this.height:ae)+(Q?1:-1)*(pe?-1:1)*(this.axisTitleMargin||0)+[-Le,Le,Ce.f,-Le][this.side],Pe={x:Q?Ue+Me:Xe+(pe?this.width:0)+xe+Me,y:Q?Xe+_e-(pe?this.height:0)+xe:Ue+_e};return j(this,"afterGetTitlePosition",{titlePosition:Pe}),Pe}renderMinorTick(K,Q){let ae=this.minorTicks;ae[K]||(ae[K]=new x(this,K,"minor")),Q&&ae[K].isNew&&ae[K].render(null,!0),ae[K].render(null,!1,1)}renderTick(K,Q,ae){let ye=this.isLinked,J=this.ticks;(!ye||K>=this.min&&K<=this.max||this.grid&&this.grid.isColumn)&&(J[K]||(J[K]=new x(this,K)),ae&&J[K].isNew&&J[K].render(Q,!0,-1),J[K].render(Q))}render(){let K,Q,ae=this,ye=ae.chart,J=ae.logarithmic,re=ye.renderer,ce=ae.options,pe=ae.isLinked,xe=ae.tickPositions,Me=ae.axisTitle,_e=ae.ticks,Ce=ae.minorTicks,Le=ae.alternateBands,Ue=ce.stackLabels,Xe=ce.alternateGridColor,Pe=ce.crossing,Ee=ae.tickmarkOffset,Ie=ae.axisLine,Oe=ae.showAxis,Re=g(re.globalAnimation);if(ae.labelEdge.length=0,ae.overlap=!1,[_e,Ce,Le].forEach(function(Fe){H(Fe,function(Ke){Ke.isActive=!1})}),L(Pe)){let Fe=this.isXAxis?ye.yAxis[0]:ye.xAxis[0],Ke=[1,-1,-1,1][this.side];if(Fe){let rt=Fe.toPixels(Pe,!0);ae.horiz&&(rt=Fe.len-rt),ae.offset=Ke*rt}}if(ae.hasData()||pe){let Fe=ae.chart.hasRendered&&ae.old&&L(ae.old.min);ae.minorTickInterval&&!ae.categories&&ae.getMinorTickPositions().forEach(function(Ke){ae.renderMinorTick(Ke,Fe)}),xe.length&&(xe.forEach(function(Ke,rt){ae.renderTick(Ke,rt,Fe)}),Ee&&(ae.min===0||ae.single)&&(_e[-1]||(_e[-1]=new x(ae,-1,null,!0)),_e[-1].render(-1))),Xe&&xe.forEach(function(Ke,rt){Q=xe[rt+1]!==void 0?xe[rt+1]+Ee:ae.max-Ee,rt%2==0&&Ke<ae.max&&Q<=ae.max+(ye.polar?-Ee:Ee)&&(Le[Ke]||(Le[Ke]=new b.PlotLineOrBand(ae,{})),K=Ke+Ee,Le[Ke].options={from:J?J.lin2log(K):K,to:J?J.lin2log(Q):Q,color:Xe,className:"highcharts-alternate-grid"},Le[Ke].render(),Le[Ke].isActive=!0)}),ae._addedPlotLB||(ae._addedPlotLB=!0,(ce.plotLines||[]).concat(ce.plotBands||[]).forEach(function(Ke){ae.addPlotBandOrLine(Ke)}))}[_e,Ce,Le].forEach(function(Fe){let Ke=[],rt=Re.duration;H(Fe,function(at,ut){at.isActive||(at.render(ut,!1,0),at.isActive=!1,Ke.push(ut))}),oe(function(){let at=Ke.length;for(;at--;)Fe[Ke[at]]&&!Fe[Ke[at]].isActive&&(Fe[Ke[at]].destroy(),delete Fe[Ke[at]])},Fe!==Le&&ye.hasRendered&&rt?rt:0)}),Ie&&(Ie[Ie.isPlaced?"animate":"attr"]({d:this.getLinePath(Ie.strokeWidth())}),Ie.isPlaced=!0,Ie[Oe?"show":"hide"](Oe)),Me&&Oe&&(Me[Me.isNew?"attr":"animate"](ae.getTitlePosition(Me)),Me.isNew=!1),Ue&&Ue.enabled&&ae.stacking&&ae.stacking.renderStackTotals(),ae.old={len:ae.len,max:ae.max,min:ae.min,transA:ae.transA,userMax:ae.userMax,userMin:ae.userMin},ae.isDirty=!1,j(this,"afterRender")}redraw(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(K){K.render()})),this.series.forEach(function(K){K.isDirty=!0})}getKeepProps(){return this.keepProps||ge.keepProps}destroy(K){let Q=this,ae=Q.plotLinesAndBands,ye=this.eventOptions;if(j(this,"destroy",{keepEvents:K}),K||ue(Q),[Q.ticks,Q.minorTicks,Q.alternateBands].forEach(function(J){z(J)}),ae){let J=ae.length;for(;J--;)ae[J].destroy()}for(let J in["axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(re){Q[re]&&(Q[re]=Q[re].destroy())}),Q.plotLinesAndBandsGroups)Q.plotLinesAndBandsGroups[J]=Q.plotLinesAndBandsGroups[J].destroy();H(Q,function(J,re){Q.getKeepProps().indexOf(re)===-1&&delete Q[re]}),this.eventOptions=ye}drawCrosshair(K,Q){let ae=this.crosshair,ye=W(ae&&ae.snap,!0),J=this.chart,re,ce,pe,xe=this.cross,Me;if(j(this,"drawCrosshair",{e:K,point:Q}),K||(K=this.cross&&this.cross.e),ae&&(M(Q)||!ye)!==!1){if(ye?M(Q)&&(ce=W(this.coll!=="colorAxis"?Q.crosshairPos:null,this.isXAxis?Q.plotX:this.len-Q.plotY)):ce=K&&(this.horiz?K.chartX-this.pos:this.len-K.chartY+this.pos),M(ce)&&(Me={value:Q&&(this.isXAxis?Q.x:W(Q.stackY,Q.y)),translatedValue:ce},J.polar&&Z(Me,{isCrosshair:!0,chartX:K&&K.chartX,chartY:K&&K.chartY,point:Q}),re=this.getPlotLinePath(Me)||null),!M(re)){this.hideCrosshair();return}pe=this.categories&&!this.isRadial,xe||(this.cross=xe=J.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(pe?"category ":"thin ")+(ae.className||"")).attr({zIndex:W(ae.zIndex,2)}).add(),!J.styledMode&&(xe.attr({stroke:ae.color||(pe?d.parse("#ccd3ff").setOpacity(.25).get():"#cccccc"),"stroke-width":W(ae.width,1)}).css({"pointer-events":"none"}),ae.dashStyle&&xe.attr({dashstyle:ae.dashStyle}))),xe.show().attr({d:re}),pe&&!ae.width&&xe.attr({"stroke-width":this.transA}),this.cross.e=K}else this.hideCrosshair();j(this,"afterDrawCrosshair",{e:K,point:Q})}hideCrosshair(){this.cross&&this.cross.hide(),j(this,"afterHideCrosshair")}update(K,Q){let ae=this.chart;K=U(this.userOptions,K),this.destroy(!0),this.init(ae,K),ae.isDirtyBox=!0,W(Q,!0)&&ae.redraw()}remove(K){let Q=this.chart,ae=this.coll,ye=this.series,J=ye.length;for(;J--;)ye[J]&&ye[J].remove(!1);Y(Q.axes,this),Y(Q[ae]||[],this),Q.orderItems(ae),this.destroy(),Q.isDirtyBox=!0,W(K,!0)&&Q.redraw()}setTitle(K,Q){this.update({title:K},Q)}setCategories(K,Q){this.update({categories:K},Q)}}return ge.keepProps=["coll","extKey","hcEvents","len","names","series","userMax","userMin"],ge}),c(t,"Core/Axis/DateTimeAxis.js",[t["Core/Utilities.js"]],function(a){var h;let{addEvent:d,getMagnitude:s,normalizeTickInterval:f,timeUnits:b}=a;return function(x){function v(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function g(){if(this.type!=="datetime"){this.dateTime=void 0;return}this.dateTime||(this.dateTime=new P(this))}x.compose=function(_){return _.keepProps.includes("dateTime")||(_.keepProps.push("dateTime"),_.prototype.getTimeTicks=v,d(_,"afterSetType",g)),_};class P{constructor(S){this.axis=S}normalizeTimeTickInterval(S,k){let A=k||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],y=A[A.length-1],I=b[y[0]],D=y[1],w;for(w=0;w<A.length&&(I=b[(y=A[w])[0]],D=y[1],!A[w+1]||!(S<=(I*D[D.length-1]+b[A[w+1][0]])/2));w++);I===b.year&&S<5*I&&(D=[1,2,5]);let M=f(S/I,D,y[0]==="year"?Math.max(s(S/I),1):1);return{unitRange:I,count:M,unitName:y[0]}}getXDateFormat(S,k){let{axis:A}=this,y=A.chart.time;return A.closestPointRange?y.getDateFormat(A.closestPointRange,S,A.options.startOfWeek,k)||y.resolveDTLFormat(k.year).main:y.resolveDTLFormat(k.day).main}}x.Additions=P}(h||(h={})),h}),c(t,"Core/Axis/LogarithmicAxis.js",[t["Core/Utilities.js"]],function(a){var h;let{addEvent:d,normalizeTickInterval:s,pick:f}=a;return function(b){function x(){this.type!=="logarithmic"?this.logarithmic=void 0:this.logarithmic??(this.logarithmic=new g(this))}function v(){let P=this.logarithmic;P&&(this.lin2val=function(_){return P.lin2log(_)},this.val2lin=function(_){return P.log2lin(_)})}b.compose=function(P){return P.keepProps.includes("logarithmic")||(P.keepProps.push("logarithmic"),d(P,"afterSetType",x),d(P,"afterInit",v)),P};class g{constructor(_){this.axis=_}getLogTickPositions(_,S,k,A){let y=this.axis,I=y.len,D=y.options,w=[];if(A||(this.minorAutoInterval=void 0),_>=.5)_=Math.round(_),w=y.getLinearTickPositions(_,S,k);else if(_>=.08){let M,z,Y,X,Z,j,V,$=Math.floor(S);for(M=_>.3?[1,2,4]:_>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],z=$;z<k+1&&!V;z++)for(Y=0,X=M.length;Y<X&&!V;Y++)(Z=this.log2lin(this.lin2log(z)*M[Y]))>S&&(!A||j<=k)&&j!==void 0&&w.push(j),j>k&&(V=!0),j=Z}else{let M=this.lin2log(S),z=this.lin2log(k),Y=A?y.getMinorTickInterval():D.tickInterval,X=D.tickPixelInterval/(A?5:1),Z=A?I/y.tickPositions.length:I;_=s(_=f(Y==="auto"?null:Y,this.minorAutoInterval,(z-M)*X/(Z||1))),w=y.getLinearTickPositions(_,M,z).map(this.log2lin),A||(this.minorAutoInterval=_/5)}return A||(y.tickInterval=_),w}lin2log(_){return Math.pow(10,_)}log2lin(_){return Math.log(_)/Math.LN10}}b.Additions=g}(h||(h={})),h}),c(t,"Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js",[t["Core/Utilities.js"]],function(a){var h;let{erase:d,extend:s,isNumber:f}=a;return function(b){let x;function v(y){return this.addPlotBandOrLine(y,"plotBands")}function g(y,I){let D=this.userOptions,w=new x(this,y);if(this.visible&&(w=w.render()),w){if(this._addedPlotLB||(this._addedPlotLB=!0,(D.plotLines||[]).concat(D.plotBands||[]).forEach(M=>{this.addPlotBandOrLine(M)})),I){let M=D[I]||[];M.push(y),D[I]=M}this.plotLinesAndBands.push(w)}return w}function P(y){return this.addPlotBandOrLine(y,"plotLines")}function _(y,I,D){D=D||this.options;let w=this.getPlotLinePath({value:I,force:!0,acrossPanes:D.acrossPanes}),M=[],z=this.horiz,Y=!f(this.min)||!f(this.max)||y<this.min&&I<this.min||y>this.max&&I>this.max,X=this.getPlotLinePath({value:y,force:!0,acrossPanes:D.acrossPanes}),Z,j=1,V;if(X&&w)for(Y&&(V=X.toString()===w.toString(),j=0),Z=0;Z<X.length;Z+=2){let $=X[Z],R=X[Z+1],L=w[Z],G=w[Z+1];($[0]==="M"||$[0]==="L")&&(R[0]==="M"||R[0]==="L")&&(L[0]==="M"||L[0]==="L")&&(G[0]==="M"||G[0]==="L")&&(z&&L[1]===$[1]?(L[1]+=j,G[1]+=j):z||L[2]!==$[2]||(L[2]+=j,G[2]+=j),M.push(["M",$[1],$[2]],["L",R[1],R[2]],["L",G[1],G[2]],["L",L[1],L[2]],["Z"])),M.isFlat=V}return M}function S(y){this.removePlotBandOrLine(y)}function k(y){let I=this.plotLinesAndBands,D=this.options,w=this.userOptions;if(I){let M=I.length;for(;M--;)I[M].id===y&&I[M].destroy();[D.plotLines||[],w.plotLines||[],D.plotBands||[],w.plotBands||[]].forEach(function(z){for(M=z.length;M--;)(z[M]||{}).id===y&&d(z,z[M])})}}function A(y){this.removePlotBandOrLine(y)}b.compose=function(y,I){let D=I.prototype;return D.addPlotBand||(x=y,s(D,{addPlotBand:v,addPlotLine:P,addPlotBandOrLine:g,getPlotBandPath:_,removePlotBand:S,removePlotLine:A,removePlotBandOrLine:k})),I}}(h||(h={})),h}),c(t,"Core/Axis/PlotLineOrBand/PlotLineOrBand.js",[t["Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js"],t["Core/Utilities.js"]],function(a,h){let{addEvent:d,arrayMax:s,arrayMin:f,defined:b,destroyObjectProperties:x,erase:v,fireEvent:g,merge:P,objectEach:_,pick:S}=h;class k{static compose(y,I){return d(y,"afterInit",function(){this.labelCollectors.push(()=>{var w;let D=[];for(let M of this.axes)for(let{label:z,options:Y}of M.plotLinesAndBands)z&&!((w=Y==null?void 0:Y.label)!=null&&w.allowOverlap)&&D.push(z);return D})}),a.compose(k,I)}constructor(y,I){this.axis=y,this.options=I,this.id=I.id}render(){g(this,"render");let{axis:y,options:I}=this,{horiz:D,logarithmic:w}=y,{color:M,events:z,zIndex:Y=0}=I,X={},Z=y.chart.renderer,j=I.to,V=I.from,$=I.value,R=I.borderWidth,L=I.label,{label:G,svgElem:U}=this,F=[],H,W=b(V)&&b(j),ne=b($),ue=!U,ie={class:"highcharts-plot-"+(W?"band ":"line ")+(I.className||"")},oe=W?"bands":"lines";if(!y.chart.styledMode&&(ne?(ie.stroke=M||"#999999",ie["stroke-width"]=S(I.width,1),I.dashStyle&&(ie.dashstyle=I.dashStyle)):W&&(ie.fill=M||"#e6e9ff",R&&(ie.stroke=I.borderColor,ie["stroke-width"]=R))),X.zIndex=Y,oe+="-"+Y,(H=y.plotLinesAndBandsGroups[oe])||(y.plotLinesAndBandsGroups[oe]=H=Z.g("plot-"+oe).attr(X).add()),U||(this.svgElem=U=Z.path().attr(ie).add(H)),b($))F=y.getPlotLinePath({value:(w==null?void 0:w.log2lin($))??$,lineWidth:U.strokeWidth(),acrossPanes:I.acrossPanes});else{if(!(b(V)&&b(j)))return;F=y.getPlotBandPath((w==null?void 0:w.log2lin(V))??V,(w==null?void 0:w.log2lin(j))??j,I)}return!this.eventsAdded&&z&&(_(z,(Te,ge)=>{U==null||U.on(ge,we=>{z[ge].apply(this,[we])})}),this.eventsAdded=!0),(ue||!U.d)&&(F!=null&&F.length)?U.attr({d:F}):U&&(F?(U.show(),U.animate({d:F})):U.d&&(U.hide(),G&&(this.label=G=G.destroy()))),L&&(b(L.text)||b(L.formatter))&&(F!=null&&F.length)&&y.width>0&&y.height>0&&!F.isFlat?(L=P({align:D&&W?"center":void 0,x:D?!W&&4:10,verticalAlign:!D&&W?"middle":void 0,y:D?W?16:10:W?6:-4,rotation:D&&!W?90:0,...W?{inside:!0}:{}},L),this.renderLabel(L,F,W,Y)):G&&G.hide(),this}renderLabel(y,I,D,w){var L;let M=this.axis,z=M.chart.renderer,Y=y.inside,X=this.label;X||(this.label=X=z.text(this.getLabelText(y),0,0,y.useHTML).attr({align:y.textAlign||y.align,rotation:y.rotation,class:"highcharts-plot-"+(D?"band":"line")+"-label "+(y.className||""),zIndex:w}),M.chart.styledMode||X.css(P({fontSize:"0.8em",textOverflow:D&&!Y?"":"ellipsis"},y.style)),X.add());let Z=I.xBounds||[I[0][1],I[1][1],D?I[2][1]:I[0][1]],j=I.yBounds||[I[0][2],I[1][2],D?I[2][2]:I[0][2]],V=f(Z),$=f(j),R=s(Z)-V;X.align(y,!1,{x:V,y:$,width:R,height:s(j)-$}),(!X.alignValue||X.alignValue==="left"||b(Y))&&X.css({width:(((L=y.style)==null?void 0:L.width)||(D&&Y?R:X.rotation===90?M.height-(X.alignAttr.y-M.top):(y.clip?M.width:M.chart.chartWidth)-(X.alignAttr.x-M.left)))+"px"}),X.show(!0)}getLabelText(y){return b(y.formatter)?y.formatter.call(this):y.text}destroy(){v(this.axis.plotLinesAndBands,this),delete this.axis,x(this)}}return k}),c(t,"Core/Tooltip.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Templating.js"],t["Core/Globals.js"],t["Core/Renderer/RendererUtilities.js"],t["Core/Renderer/RendererRegistry.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b){var x;let{animObject:v}=a,{format:g}=h,{composed:P,doc:_,isSafari:S}=d,{distribute:k}=s,{addEvent:A,clamp:y,css:I,discardElement:D,extend:w,fireEvent:M,isArray:z,isNumber:Y,isString:X,merge:Z,pick:j,pushUnique:V,splat:$,syncTimeout:R}=b;class L{constructor(U,F,H){this.allowShared=!0,this.crosshairs=[],this.distance=0,this.isHidden=!0,this.isSticky=!1,this.options={},this.outside=!1,this.chart=U,this.init(U,F),this.pointer=H}bodyFormatter(U){return U.map(function(F){let H=F.series.tooltipOptions;return(H[(F.point.formatPrefix||"point")+"Formatter"]||F.point.tooltipFormatter).call(F.point,H[(F.point.formatPrefix||"point")+"Format"]||"")})}cleanSplit(U){this.chart.series.forEach(function(F){let H=F&&F.tt;H&&(!H.isActive||U?F.tt=H.destroy():H.isActive=!1)})}defaultFormatter(U){let F,H=this.points||$(this);return(F=(F=[U.tooltipFooterHeaderFormatter(H[0])]).concat(U.bodyFormatter(H))).push(U.tooltipFooterHeaderFormatter(H[0],!0)),F}destroy(){this.label&&(this.label=this.label.destroy()),this.split&&(this.cleanSplit(!0),this.tt&&(this.tt=this.tt.destroy())),this.renderer&&(this.renderer=this.renderer.destroy(),D(this.container)),b.clearTimeout(this.hideTimer)}getAnchor(U,F){let H,{chart:W,pointer:ne}=this,ue=W.inverted,ie=W.plotTop,oe=W.plotLeft;if((U=$(U))[0].series&&U[0].series.yAxis&&!U[0].series.yAxis.options.reversedStacks&&(U=U.slice().reverse()),this.followPointer&&F)F.chartX===void 0&&(F=ne.normalize(F)),H=[F.chartX-oe,F.chartY-ie];else if(U[0].tooltipPos)H=U[0].tooltipPos;else{let Te=0,ge=0;U.forEach(function(we){let K=we.pos(!0);K&&(Te+=K[0],ge+=K[1])}),Te/=U.length,ge/=U.length,this.shared&&U.length>1&&F&&(ue?Te=F.chartX:ge=F.chartY),H=[Te-oe,ge-ie]}return H.map(Math.round)}getClassName(U,F,H){let W=this.options,ne=U.series,ue=ne.options;return[W.className,"highcharts-label",H&&"highcharts-tooltip-header",F?"highcharts-tooltip-box":"highcharts-tooltip",!H&&"highcharts-color-"+j(U.colorIndex,ne.colorIndex),ue&&ue.className].filter(X).join(" ")}getLabel({anchorX:U,anchorY:F}={anchorX:0,anchorY:0}){let H=this,W=this.chart.styledMode,ne=this.options,ue=this.split&&this.allowShared,ie=this.container,oe=this.chart.renderer;if(this.label){let Te=!this.label.hasClass("highcharts-label");(!ue&&Te||ue&&!Te)&&this.destroy()}if(!this.label){if(this.outside){let Te=this.chart.options.chart.style,ge=f.getRendererType();this.container=ie=d.doc.createElement("div"),ie.className="highcharts-tooltip-container",I(ie,{position:"absolute",top:"1px",pointerEvents:"none",zIndex:Math.max(this.options.style.zIndex||0,(Te&&Te.zIndex||0)+3)}),this.renderer=oe=new ge(ie,0,0,Te,void 0,void 0,oe.styledMode)}if(ue?this.label=oe.g("tooltip"):(this.label=oe.label("",U,F,ne.shape,void 0,void 0,ne.useHTML,void 0,"tooltip").attr({padding:ne.padding,r:ne.borderRadius}),W||this.label.attr({fill:ne.backgroundColor,"stroke-width":ne.borderWidth||0}).css(ne.style).css({pointerEvents:ne.style.pointerEvents||(this.shouldStickOnContact()?"auto":"none")})),H.outside){let Te=this.label;[Te.xSetter,Te.ySetter].forEach((ge,we)=>{Te[we?"ySetter":"xSetter"]=K=>{ge.call(Te,H.distance),Te[we?"y":"x"]=K,ie&&(ie.style[we?"top":"left"]=`${K}px`)}})}this.label.attr({zIndex:8}).shadow(ne.shadow).add()}return ie&&!ie.parentElement&&d.doc.body.appendChild(ie),this.label}getPlayingField(){let{body:U,documentElement:F}=_,{chart:H,distance:W,outside:ne}=this;return{width:ne?Math.max(U.scrollWidth,F.scrollWidth,U.offsetWidth,F.offsetWidth,F.clientWidth)-2*W:H.chartWidth,height:ne?Math.max(U.scrollHeight,F.scrollHeight,U.offsetHeight,F.offsetHeight,F.clientHeight):H.chartHeight}}getPosition(U,F,H){var Re,Fe;let{distance:W,chart:ne,outside:ue,pointer:ie}=this,{inverted:oe,plotLeft:Te,plotTop:ge,polar:we}=ne,{plotX:K=0,plotY:Q=0}=H,ae={},ye=oe&&H.h||0,{height:J,width:re}=this.getPlayingField(),ce=ie.getChartPosition(),pe=Ke=>Ke*ce.scaleX,xe=Ke=>Ke*ce.scaleY,Me=Ke=>{let rt=Ke==="x";return[Ke,rt?re:J,rt?U:F].concat(ue?[rt?pe(U):xe(F),rt?ce.left-W+pe(K+Te):ce.top-W+xe(Q+ge),0,rt?re:J]:[rt?U:F,rt?K+Te:Q+ge,rt?Te:ge,rt?Te+ne.plotWidth:ge+ne.plotHeight])},_e=Me("y"),Ce=Me("x"),Le,Ue=!!H.negative;!we&&((Fe=(Re=ne.hoverSeries)==null?void 0:Re.yAxis)!=null&&Fe.reversed)&&(Ue=!Ue);let Xe=!this.followPointer&&j(H.ttBelow,!we&&!oe===Ue),Pe=function(Ke,rt,at,ut,mt,Tt,Rt){let pt=ue?Ke==="y"?xe(W):pe(W):W,Ct=(at-ut)/2,Et=ut<mt-W,ri=mt+W+ut<rt,ci=mt-pt-at+Ct,Vt=mt+pt-Ct;if(Xe&&ri)ae[Ke]=Vt;else if(!Xe&&Et)ae[Ke]=ci;else if(Et)ae[Ke]=Math.min(Rt-ut,ci-ye<0?ci:ci-ye);else{if(!ri)return!1;ae[Ke]=Math.max(Tt,Vt+ye+at>rt?Vt:Vt+ye)}},Ee=function(Ke,rt,at,ut,mt){if(mt<W||mt>rt-W)return!1;mt<at/2?ae[Ke]=1:mt>rt-ut/2?ae[Ke]=rt-ut-2:ae[Ke]=mt-at/2},Ie=function(Ke){[_e,Ce]=[Ce,_e],Le=Ke},Oe=()=>{Pe.apply(0,_e)!==!1?Ee.apply(0,Ce)!==!1||Le||(Ie(!0),Oe()):Le?ae.x=ae.y=0:(Ie(!0),Oe())};return(oe&&!we||this.len>1)&&Ie(),Oe(),ae}hide(U){let F=this;b.clearTimeout(this.hideTimer),U=j(U,this.options.hideDelay),this.isHidden||(this.hideTimer=R(function(){let H=F.getLabel();F.getLabel().animate({opacity:0},{duration:U&&150,complete:()=>{H.hide(),F.container&&F.container.remove()}}),F.isHidden=!0},U))}init(U,F){this.chart=U,this.options=F,this.crosshairs=[],this.isHidden=!0,this.split=F.split&&!U.inverted&&!U.polar,this.shared=F.shared||this.split,this.outside=j(F.outside,!!(U.scrollablePixelsX||U.scrollablePixelsY))}shouldStickOnContact(U){return!!(!this.followPointer&&this.options.stickOnContact&&(!U||this.pointer.inClass(U.target,"highcharts-tooltip")))}move(U,F,H,W){let ne=this,ue=v(!ne.isHidden&&ne.options.animation),ie=ne.followPointer||(ne.len||0)>1,oe={x:U,y:F};ie||(oe.anchorX=H,oe.anchorY=W),ue.step=()=>ne.drawTracker(),ne.getLabel().animate(oe,ue)}refresh(U,F){let{chart:H,options:W,pointer:ne,shared:ue}=this,ie=$(U),oe=ie[0],Te=[],ge=W.format,we=W.formatter||this.defaultFormatter,K=H.styledMode,Q={},ae=this.allowShared;if(!W.enabled||!oe.series)return;b.clearTimeout(this.hideTimer),this.allowShared=!(!z(U)&&U.series&&U.series.noSharedTooltip),ae=ae&&!this.allowShared,this.followPointer=!this.split&&oe.series.tooltipOptions.followPointer;let ye=this.getAnchor(U,F),J=ye[0],re=ye[1];ue&&this.allowShared?(ne.applyInactiveState(ie),ie.forEach(function(xe){xe.setState("hover"),Te.push(xe.getLabelConfig())}),(Q=oe.getLabelConfig()).points=Te):Q=oe.getLabelConfig(),this.len=Te.length;let ce=X(ge)?g(ge,Q,H):we.call(Q,this),pe=oe.series;if(this.distance=j(pe.tooltipOptions.distance,16),ce===!1)this.hide();else{if(this.split&&this.allowShared)this.renderSplit(ce,ie);else{let xe=J,Me=re;if(F&&ne.isDirectTouch&&(xe=F.chartX-H.plotLeft,Me=F.chartY-H.plotTop),H.polar||pe.options.clip===!1||ie.some(_e=>ne.isDirectTouch||_e.series.shouldShowTooltip(xe,Me))){let _e=this.getLabel(ae&&this.tt||{});(!W.style.width||K)&&_e.css({width:(this.outside?this.getPlayingField():H.spacingBox).width+"px"}),_e.attr({class:this.getClassName(oe),text:ce&&ce.join?ce.join(""):ce}),this.outside&&_e.attr({x:y(_e.x||0,0,this.getPlayingField().width-(_e.width||0))}),K||_e.attr({stroke:W.borderColor||oe.color||pe.color||"#666666"}),this.updatePosition({plotX:J,plotY:re,negative:oe.negative,ttBelow:oe.ttBelow,h:ye[2]||0})}else{this.hide();return}}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}M(this,"refresh")}renderSplit(U,F){var rt;let H=this,{chart:W,chart:{chartWidth:ne,chartHeight:ue,plotHeight:ie,plotLeft:oe,plotTop:Te,scrollablePixelsY:ge=0,scrollablePixelsX:we,styledMode:K},distance:Q,options:ae,options:{positioner:ye},pointer:J}=H,{scrollLeft:re=0,scrollTop:ce=0}=((rt=W.scrollablePlotArea)==null?void 0:rt.scrollingContainer)||{},pe=H.outside&&typeof we!="number"?_.documentElement.getBoundingClientRect():{left:re,right:re+ne,top:ce,bottom:ce+ue},xe=H.getLabel(),Me=this.renderer||W.renderer,_e=!!(W.xAxis[0]&&W.xAxis[0].opposite),{left:Ce,top:Le}=J.getChartPosition(),Ue=Te+ce,Xe=0,Pe=ie-ge;function Ee(at,ut,mt,Tt,Rt=!0){let pt,Ct;return mt?(pt=_e?0:Pe,Ct=y(at-Tt/2,pe.left,pe.right-Tt-(H.outside?Ce:0))):(pt=ut-Ue,Ct=y(Ct=Rt?at-Tt-Q:at+Q,Rt?Ct:pe.left,pe.right)),{x:Ct,y:pt}}X(U)&&(U=[!1,U]);let Ie=U.slice(0,F.length+1).reduce(function(at,ut,mt){if(ut!==!1&&ut!==""){let Tt=F[mt-1]||{isHeader:!0,plotX:F[0].plotX,plotY:ie,series:{}},Rt=Tt.isHeader,pt=Rt?H:Tt.series,Ct=pt.tt=function(Ji,Vi,ar){let Tr=Ji,{isHeader:Xi,series:ht}=Vi;if(!Tr){let xt={padding:ae.padding,r:ae.borderRadius};K||(xt.fill=ae.backgroundColor,xt["stroke-width"]=ae.borderWidth??1),Tr=Me.label("",0,0,ae[Xi?"headerShape":"shape"],void 0,void 0,ae.useHTML).addClass(H.getClassName(Vi,!0,Xi)).attr(xt).add(xe)}return Tr.isActive=!0,Tr.attr({text:ar}),K||Tr.css(ae.style).attr({stroke:ae.borderColor||Vi.color||ht.color||"#333333"}),Tr}(pt.tt,Tt,ut.toString()),Et=Ct.getBBox(),ri=Et.width+Ct.strokeWidth();Rt&&(Xe=Et.height,Pe+=Xe,_e&&(Ue-=Xe));let{anchorX:ci,anchorY:Vt}=function(Ji){let Vi,ar,{isHeader:Tr,plotX:Xi=0,plotY:ht=0,series:xt}=Ji;if(Tr)Vi=Math.max(oe+Xi,oe),ar=Te+ie/2;else{let{xAxis:At,yAxis:Nt}=xt;Vi=At.pos+y(Xi,-Q,At.len+Q),xt.shouldShowTooltip(0,Nt.pos-Te+ht,{ignoreX:!0})&&(ar=Nt.pos+ht)}return{anchorX:Vi=y(Vi,pe.left-Q,pe.right+Q),anchorY:ar}}(Tt);if(typeof Vt=="number"){let Ji=Et.height+1,Vi=ye?ye.call(H,ri,Ji,Tt):Ee(ci,Vt,Rt,ri);at.push({align:ye?0:void 0,anchorX:ci,anchorY:Vt,boxWidth:ri,point:Tt,rank:j(Vi.rank,Rt?1:0),size:Ji,target:Vi.y,tt:Ct,x:Vi.x})}else Ct.isActive=!1}return at},[]);!ye&&Ie.some(at=>{let{outside:ut}=H,mt=(ut?Ce:0)+at.anchorX;return mt<pe.left&&mt+at.boxWidth<pe.right||mt<Ce-pe.left+at.boxWidth&&pe.right-mt>mt})&&(Ie=Ie.map(at=>{let{x:ut,y:mt}=Ee(at.anchorX,at.anchorY,at.point.isHeader,at.boxWidth,!1);return w(at,{target:mt,x:ut})})),H.cleanSplit(),k(Ie,Pe);let Oe={left:Ce,right:Ce};Ie.forEach(function(at){let{x:ut,boxWidth:mt,isHeader:Tt}=at;!Tt&&(H.outside&&Ce+ut<Oe.left&&(Oe.left=Ce+ut),!Tt&&H.outside&&Oe.left+mt>Oe.right&&(Oe.right=Ce+ut))}),Ie.forEach(function(at){let{x:ut,anchorX:mt,anchorY:Tt,pos:Rt,point:{isHeader:pt}}=at,Ct={visibility:Rt===void 0?"hidden":"inherit",x:ut,y:(Rt||0)+Ue,anchorX:mt,anchorY:Tt};if(H.outside&&ut<mt){let Et=Ce-Oe.left;Et>0&&(pt||(Ct.x=ut+Et,Ct.anchorX=mt+Et),pt&&(Ct.x=(Oe.right-Oe.left)/2,Ct.anchorX=mt+Et))}at.tt.attr(Ct)});let{container:Re,outside:Fe,renderer:Ke}=H;if(Fe&&Re&&Ke){let{width:at,height:ut,x:mt,y:Tt}=xe.getBBox();Ke.setSize(at+mt,ut+Tt,!1),Re.style.left=Oe.left+"px",Re.style.top=Le+"px"}S&&xe.attr({opacity:xe.opacity===1?.999:1})}drawTracker(){if(!this.shouldStickOnContact()){this.tracker&&(this.tracker=this.tracker.destroy());return}let U=this.chart,F=this.label,H=this.shared?U.hoverPoints:U.hoverPoint;if(!F||!H)return;let W={x:0,y:0,width:0,height:0},ne=this.getAnchor(H),ue=F.getBBox();ne[0]+=U.plotLeft-(F.translateX||0),ne[1]+=U.plotTop-(F.translateY||0),W.x=Math.min(0,ne[0]),W.y=Math.min(0,ne[1]),W.width=ne[0]<0?Math.max(Math.abs(ne[0]),ue.width-ne[0]):Math.max(Math.abs(ne[0]),ue.width),W.height=ne[1]<0?Math.max(Math.abs(ne[1]),ue.height-Math.abs(ne[1])):Math.max(Math.abs(ne[1]),ue.height),this.tracker?this.tracker.attr(W):(this.tracker=F.renderer.rect(W).addClass("highcharts-tracker").add(F),U.styledMode||this.tracker.attr({fill:"rgba(0,0,0,0)"}))}styledModeFormat(U){return U.replace('style="font-size: 0.8em"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex} {series.options.className} {point.options.className}"')}tooltipFooterHeaderFormatter(U,F){let H=U.series,W=H.tooltipOptions,ne=H.xAxis,ue=ne&&ne.dateTime,ie={isFooter:F,labelConfig:U},oe=W.xDateFormat,Te=W[F?"footerFormat":"headerFormat"];return M(this,"headerFormatter",ie,function(ge){ue&&!oe&&Y(U.key)&&(oe=ue.getXDateFormat(U.key,W.dateTimeLabelFormats)),ue&&oe&&(U.point&&U.point.tooltipDateKeys||["key"]).forEach(function(we){Te=Te.replace("{point."+we+"}","{point."+we+":"+oe+"}")}),H.chart.styledMode&&(Te=this.styledModeFormat(Te)),ge.text=g(Te,{point:U,series:H},this.chart)}),ie.text}update(U){this.destroy(),this.init(this.chart,Z(!0,this.options,U))}updatePosition(U){let{chart:F,container:H,distance:W,options:ne,pointer:ue,renderer:ie}=this,{height:oe=0,width:Te=0}=this.getLabel(),{left:ge,top:we,scaleX:K,scaleY:Q}=ue.getChartPosition(),ae=(ne.positioner||this.getPosition).call(this,Te,oe,U),ye=(U.plotX||0)+F.plotLeft,J=(U.plotY||0)+F.plotTop,re;ie&&H&&(ne.positioner&&(ae.x+=ge-W,ae.y+=we-W),re=(ne.borderWidth||0)+2*W+2,ie.setSize(Te+re,oe+re,!1),(K!==1||Q!==1)&&(I(H,{transform:`scale(${K}, ${Q})`}),ye*=K,J*=Q),ye+=ge-ae.x,J+=we-ae.y),this.move(Math.round(ae.x),Math.round(ae.y||0),ye,J)}}return(x=L).compose=function(G){V(P,"Core.Tooltip")&&A(G,"afterInit",function(){let U=this.chart;U.options.tooltip&&(U.tooltip=new x(U,U.options.tooltip,this))})},L}),c(t,"Core/Series/Point.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Animation/AnimationUtilities.js"],t["Core/Defaults.js"],t["Core/Templating.js"],t["Core/Utilities.js"]],function(a,h,d,s,f){let{animObject:b}=h,{defaultOptions:x}=d,{format:v}=s,{addEvent:g,crisp:P,erase:_,extend:S,fireEvent:k,getNestedProperty:A,isArray:y,isFunction:I,isNumber:D,isObject:w,merge:M,pick:z,syncTimeout:Y,removeEvent:X,uniqueKey:Z}=f;class j{animateBeforeDestroy(){let $=this,R={x:$.startXPos,opacity:0},L=$.getGraphicalProps();L.singular.forEach(function(G){$[G]=$[G].animate(G==="dataLabel"?{x:$[G].startXPos,y:$[G].startYPos,opacity:0}:R)}),L.plural.forEach(function(G){$[G].forEach(function(U){U.element&&U.animate(S({x:$.startXPos},U.startYPos?{x:U.startXPos,y:U.startYPos}:{}))})})}applyOptions($,R){let L=this.series,G=L.options.pointValKey||L.pointValKey;return S(this,$=j.prototype.optionsToObject.call(this,$)),this.options=this.options?S(this.options,$):$,$.group&&delete this.group,$.dataLabels&&delete this.dataLabels,G&&(this.y=j.prototype.getNestedProperty.call(this,G)),this.selected&&(this.state="select"),"name"in this&&R===void 0&&L.xAxis&&L.xAxis.hasNames&&(this.x=L.xAxis.nameToX(this)),this.x===void 0&&L?this.x=R??L.autoIncrement():D($.x)&&L.options.relativeXValue&&(this.x=L.autoIncrement($.x)),this.isNull=this.isValid&&!this.isValid(),this.formatPrefix=this.isNull?"null":"point",this}destroy(){if(!this.destroyed){let $=this,R=$.series,L=R.chart,G=R.options.dataSorting,U=L.hoverPoints,F=b($.series.chart.renderer.globalAnimation),H=()=>{for(let W in($.graphic||$.graphics||$.dataLabel||$.dataLabels)&&(X($),$.destroyElements()),$)delete $[W]};$.legendItem&&L.legend.destroyItem($),U&&($.setState(),_(U,$),U.length||(L.hoverPoints=null)),$===L.hoverPoint&&$.onMouseOut(),G&&G.enabled?(this.animateBeforeDestroy(),Y(H,F.duration)):H(),L.pointCount--}this.destroyed=!0}destroyElements($){let R=this,L=R.getGraphicalProps($);L.singular.forEach(function(G){R[G]=R[G].destroy()}),L.plural.forEach(function(G){R[G].forEach(function(U){U&&U.element&&U.destroy()}),delete R[G]})}firePointEvent($,R,L){let G=this,U=this.series.options;G.manageEvent($),$==="click"&&U.allowPointSelect&&(L=function(F){!G.destroyed&&G.select&&G.select(null,F.ctrlKey||F.metaKey||F.shiftKey)}),k(G,$,R,L)}getClassName(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(this.colorIndex!==void 0?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")}getGraphicalProps($){let R,L,G=this,U=[],F={singular:[],plural:[]};for(($=$||{graphic:1,dataLabel:1}).graphic&&U.push("graphic","connector"),$.dataLabel&&U.push("dataLabel","dataLabelPath","dataLabelUpper"),L=U.length;L--;)G[R=U[L]]&&F.singular.push(R);return["graphic","dataLabel"].forEach(function(H){let W=H+"s";$[H]&&G[W]&&F.plural.push(W)}),F}getLabelConfig(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}}getNestedProperty($){return $?$.indexOf("custom.")===0?A($,this.options):this[$]:void 0}getZone(){let $=this.series,R=$.zones,L=$.zoneAxis||"y",G,U=0;for(G=R[0];this[L]>=G.value;)G=R[++U];return this.nonZonedColor||(this.nonZonedColor=this.color),G&&G.color&&!this.options.color?this.color=G.color:this.color=this.nonZonedColor,G}hasNewShapeType(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType}constructor($,R,L){this.formatPrefix="point",this.visible=!0,this.series=$,this.applyOptions(R,L),this.id??(this.id=Z()),this.resolveColor(),$.chart.pointCount++,k(this,"afterInit")}isValid(){return(D(this.x)||this.x instanceof Date)&&D(this.y)}optionsToObject($){let R=this.series,L=R.options.keys,G=L||R.pointArrayMap||["y"],U=G.length,F={},H,W=0,ne=0;if(D($)||$===null)F[G[0]]=$;else if(y($))for(!L&&$.length>U&&((H=typeof $[0])=="string"?F.name=$[0]:H==="number"&&(F.x=$[0]),W++);ne<U;)L&&$[W]===void 0||(G[ne].indexOf(".")>0?j.prototype.setNestedProperty(F,$[W],G[ne]):F[G[ne]]=$[W]),W++,ne++;else typeof $=="object"&&(F=$,$.dataLabels&&(R.hasDataLabels=()=>!0),$.marker&&(R._hasPointMarkers=!0));return F}pos($,R=this.plotY){if(!this.destroyed){let{plotX:L,series:G}=this,{chart:U,xAxis:F,yAxis:H}=G,W=0,ne=0;if(D(L)&&D(R))return $&&(W=F?F.pos:U.plotLeft,ne=H?H.pos:U.plotTop),U.inverted&&F&&H?[H.len-R+ne,F.len-L+W]:[L+W,R+ne]}}resolveColor(){let $=this.series,R=$.chart.options.chart,L=$.chart.styledMode,G,U,F=R.colorCount,H;delete this.nonZonedColor,$.options.colorByPoint?(L||(G=(U=$.options.colors||$.chart.options.colors)[$.colorCounter],F=U.length),H=$.colorCounter,$.colorCounter++,$.colorCounter===F&&($.colorCounter=0)):(L||(G=$.color),H=$.colorIndex),this.colorIndex=z(this.options.colorIndex,H),this.color=z(this.options.color,G)}setNestedProperty($,R,L){return L.split(".").reduce(function(G,U,F,H){let W=H.length-1===F;return G[U]=W?R:w(G[U],!0)?G[U]:{},G[U]},$),$}shouldDraw(){return!this.isNull}tooltipFormatter($){let R=this.series,L=R.tooltipOptions,G=z(L.valueDecimals,""),U=L.valuePrefix||"",F=L.valueSuffix||"";return R.chart.styledMode&&($=R.chart.tooltip.styledModeFormat($)),(R.pointArrayMap||["y"]).forEach(function(H){H="{point."+H,(U||F)&&($=$.replace(RegExp(H+"}","g"),U+H+"}"+F)),$=$.replace(RegExp(H+"}","g"),H+":,."+G+"f}")}),v($,{point:this,series:this.series},R.chart)}update($,R,L,G){let U,F=this,H=F.series,W=F.graphic,ne=H.chart,ue=H.options;function ie(){F.applyOptions($);let oe=W&&F.hasMockGraphic,Te=F.y===null?!oe:oe;W&&Te&&(F.graphic=W.destroy(),delete F.hasMockGraphic),w($,!0)&&(W&&W.element&&$&&$.marker&&$.marker.symbol!==void 0&&(F.graphic=W.destroy()),$!=null&&$.dataLabels&&F.dataLabel&&(F.dataLabel=F.dataLabel.destroy())),U=F.index,H.updateParallelArrays(F,U),ue.data[U]=w(ue.data[U],!0)||w($,!0)?F.options:z($,ue.data[U]),H.isDirty=H.isDirtyData=!0,!H.fixedBox&&H.hasCartesianSeries&&(ne.isDirtyBox=!0),ue.legendType==="point"&&(ne.isDirtyLegend=!0),R&&ne.redraw(L)}R=z(R,!0),G===!1?ie():F.firePointEvent("update",{options:$},ie)}remove($,R){this.series.removePoint(this.series.data.indexOf(this),$,R)}select($,R){let L=this,G=L.series,U=G.chart;$=z($,!L.selected),this.selectedStaging=$,L.firePointEvent($?"select":"unselect",{accumulate:R},function(){L.selected=L.options.selected=$,G.options.data[G.data.indexOf(L)]=L.options,L.setState($&&"select"),R||U.getSelectedPoints().forEach(function(F){let H=F.series;F.selected&&F!==L&&(F.selected=F.options.selected=!1,H.options.data[H.data.indexOf(F)]=F.options,F.setState(U.hoverPoints&&H.options.inactiveOtherPoints?"inactive":""),F.firePointEvent("unselect"))})}),delete this.selectedStaging}onMouseOver($){let{inverted:R,pointer:L}=this.series.chart;L&&($=$?L.normalize($):L.getChartCoordinatesFromPoint(this,R),L.runPointActions($,this))}onMouseOut(){let $=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||($.hoverPoints||[]).forEach(function(R){R.setState()}),$.hoverPoints=$.hoverPoint=null}manageEvent($){var G,U,F,H,W,ne;let R=M(this.series.options.point,this.options),L=(G=R.events)==null?void 0:G[$];I(L)&&(!((U=this.hcEvents)!=null&&U[$])||((H=(F=this.hcEvents)==null?void 0:F[$])==null?void 0:H.map(ue=>ue.fn).indexOf(L))===-1)?((W=this.importedUserEvent)==null||W.call(this),this.importedUserEvent=g(this,$,L)):this.importedUserEvent&&!L&&((ne=this.hcEvents)!=null&&ne[$])&&(X(this,$),delete this.hcEvents[$],Object.keys(this.hcEvents)||delete this.importedUserEvent)}setState($,R){var ce;let L=this.series,G=this.state,U=L.options.states[$||"normal"]||{},F=x.plotOptions[L.type].marker&&L.options.marker,H=F&&F.enabled===!1,W=F&&F.states&&F.states[$||"normal"]||{},ne=W.enabled===!1,ue=this.marker||{},ie=L.chart,oe=F&&L.markerAttribs,Te=L.halo,ge,we,K,Q=L.stateMarkerGraphic,ae;if(($=$||"")===this.state&&!R||this.selected&&$!=="select"||U.enabled===!1||$&&(ne||H&&W.enabled===!1)||$&&ue.states&&ue.states[$]&&ue.states[$].enabled===!1)return;if(this.state=$,oe&&(ge=L.markerAttribs(this,$)),this.graphic&&!this.hasMockGraphic){if(G&&this.graphic.removeClass("highcharts-point-"+G),$&&this.graphic.addClass("highcharts-point-"+$),!ie.styledMode){we=L.pointAttribs(this,$),K=z(ie.options.chart.animation,U.animation);let pe=we.opacity;L.options.inactiveOtherPoints&&D(pe)&&(this.dataLabels||[]).forEach(function(xe){xe&&!xe.hasClass("highcharts-data-label-hidden")&&(xe.animate({opacity:pe},K),xe.connector&&xe.connector.animate({opacity:pe},K))}),this.graphic.animate(we,K)}ge&&this.graphic.animate(ge,z(ie.options.chart.animation,W.animation,F.animation)),Q&&Q.hide()}else $&&W&&(ae=ue.symbol||L.symbol,Q&&Q.currentSymbol!==ae&&(Q=Q.destroy()),ge&&(Q?Q[R?"animate":"attr"]({x:ge.x,y:ge.y}):ae&&(L.stateMarkerGraphic=Q=ie.renderer.symbol(ae,ge.x,ge.y,ge.width,ge.height).add(L.markerGroup),Q.currentSymbol=ae)),!ie.styledMode&&Q&&this.state!=="inactive"&&Q.attr(L.pointAttribs(this,$))),Q&&(Q[$&&this.isInside?"show":"hide"](),Q.element.point=this,Q.addClass(this.getClassName(),!0));let ye=U.halo,J=this.graphic||Q,re=J&&J.visibility||"inherit";ye&&ye.size&&J&&re!=="hidden"&&!this.isCluster?(Te||(L.halo=Te=ie.renderer.path().add(J.parentGroup)),Te.show()[R?"animate":"attr"]({d:this.haloPath(ye.size)}),Te.attr({class:"highcharts-halo highcharts-color-"+z(this.colorIndex,L.colorIndex)+(this.className?" "+this.className:""),visibility:re,zIndex:-1}),Te.point=this,ie.styledMode||Te.attr(S({fill:this.color||L.color,"fill-opacity":ye.opacity},a.filterUserAttributes(ye.attributes||{})))):(ce=Te==null?void 0:Te.point)!=null&&ce.haloPath&&!Te.point.destroyed&&Te.animate({d:Te.point.haloPath(0)},null,Te.hide),k(this,"afterSetState",{state:$})}haloPath($){let R=this.pos();return R?this.series.chart.renderer.symbols.circle(P(R[0],1)-$,R[1]-$,2*$,2*$):[]}}return j}),c(t,"Core/Pointer.js",[t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h,d){var s;let{parse:f}=a,{charts:b,composed:x,isTouchDevice:v}=h,{addEvent:g,attr:P,css:_,extend:S,find:k,fireEvent:A,isNumber:y,isObject:I,objectEach:D,offset:w,pick:M,pushUnique:z,splat:Y}=d;class X{applyInactiveState(j){let V=[],$;(j||[]).forEach(function(R){$=R.series,V.push($),$.linkedParent&&V.push($.linkedParent),$.linkedSeries&&(V=V.concat($.linkedSeries)),$.navigatorSeries&&V.push($.navigatorSeries)}),this.chart.series.forEach(function(R){V.indexOf(R)===-1?R.setState("inactive",!0):R.options.inactiveOtherPoints&&R.setAllPointsToState("inactive")})}destroy(){let j=this;this.eventsToUnbind.forEach(V=>V()),this.eventsToUnbind=[],!h.chartCount&&(X.unbindDocumentMouseUp&&X.unbindDocumentMouseUp.forEach(V=>V()),X.unbindDocumentTouchEnd&&(X.unbindDocumentTouchEnd=X.unbindDocumentTouchEnd())),clearInterval(j.tooltipTimeout),D(j,function(V,$){j[$]=void 0})}getSelectionMarkerAttrs(j,V){let $={args:{chartX:j,chartY:V},attrs:{},shapeType:"rect"};return A(this,"getSelectionMarkerAttrs",$,R=>{let L,{chart:G,zoomHor:U,zoomVert:F}=this,{mouseDownX:H=0,mouseDownY:W=0}=G,ne=R.attrs;ne.x=G.plotLeft,ne.y=G.plotTop,ne.width=U?1:G.plotWidth,ne.height=F?1:G.plotHeight,U&&(L=j-H,ne.width=Math.max(1,Math.abs(L)),ne.x=(L>0?0:L)+H),F&&(L=V-W,ne.height=Math.max(1,Math.abs(L)),ne.y=(L>0?0:L)+W)}),$}drag(j){let{chart:V}=this,{mouseDownX:$=0,mouseDownY:R=0}=V,{panning:L,panKey:G,selectionMarkerFill:U}=V.options.chart,F=V.plotLeft,H=V.plotTop,W=V.plotWidth,ne=V.plotHeight,ue=I(L)?L.enabled:L,ie=G&&j[`${G}Key`],oe=j.chartX,Te=j.chartY,ge,we=this.selectionMarker;if((!we||!we.touch)&&(oe<F?oe=F:oe>F+W&&(oe=F+W),Te<H?Te=H:Te>H+ne&&(Te=H+ne),this.hasDragged=Math.sqrt(Math.pow($-oe,2)+Math.pow(R-Te,2)),this.hasDragged>10)){ge=V.isInsidePlot($-F,R-H,{visiblePlotOnly:!0});let{shapeType:K,attrs:Q}=this.getSelectionMarkerAttrs(oe,Te);(V.hasCartesianSeries||V.mapView)&&this.hasZoom&&ge&&!ie&&!we&&(this.selectionMarker=we=V.renderer[K](),we.attr({class:"highcharts-selection-marker",zIndex:7}).add(),V.styledMode||we.attr({fill:U||f("#334eff").setOpacity(.25).get()})),we&&we.attr(Q),ge&&!we&&ue&&V.pan(j,L)}}dragStart(j){let V=this.chart;V.mouseIsDown=j.type,V.cancelClick=!1,V.mouseDownX=j.chartX,V.mouseDownY=j.chartY}getSelectionBox(j){let V={args:{marker:j},result:j.getBBox()};return A(this,"getSelectionBox",V),V.result}drop(j){let V,{chart:$,selectionMarker:R}=this;for(let L of $.axes)L.isPanning&&(L.isPanning=!1,(L.options.startOnTick||L.options.endOnTick||L.series.some(G=>G.boosted))&&(L.forceRedraw=!0,L.setExtremes(L.userMin,L.userMax,!1),V=!0));if(V&&$.redraw(),R&&j){if(this.hasDragged){let L=this.getSelectionBox(R);$.transform({axes:$.axes.filter(G=>G.zoomEnabled&&(G.coll==="xAxis"&&this.zoomX||G.coll==="yAxis"&&this.zoomY)),selection:{originalEvent:j,xAxis:[],yAxis:[],...L},from:L})}y($.index)&&(this.selectionMarker=R.destroy())}$&&y($.index)&&(_($.container,{cursor:$._cursor}),$.cancelClick=this.hasDragged>10,$.mouseIsDown=!1,this.hasDragged=0,this.pinchDown=[])}findNearestKDPoint(j,V,$){let R;return j.forEach(function(L){let G=!(L.noSharedTooltip&&V)&&0>L.options.findNearestPointBy.indexOf("y"),U=L.searchPoint($,G);I(U,!0)&&U.series&&(!I(R,!0)||function(F,H){var ie,oe;let W=F.distX-H.distX,ne=F.dist-H.dist,ue=((ie=H.series.group)==null?void 0:ie.zIndex)-((oe=F.series.group)==null?void 0:oe.zIndex);return W!==0&&V?W:ne!==0?ne:ue!==0?ue:F.series.index>H.series.index?-1:1}(R,U)>0)&&(R=U)}),R}getChartCoordinatesFromPoint(j,V){let{xAxis:$,yAxis:R}=j.series,L=j.shapeArgs;if($&&R){let G=j.clientX??j.plotX??0,U=j.plotY||0;return j.isNode&&L&&y(L.x)&&y(L.y)&&(G=L.x,U=L.y),V?{chartX:R.len+R.pos-U,chartY:$.len+$.pos-G}:{chartX:G+$.pos,chartY:U+R.pos}}if(L&&L.x&&L.y)return{chartX:L.x,chartY:L.y}}getChartPosition(){if(this.chartPosition)return this.chartPosition;let{container:j}=this.chart,V=w(j);this.chartPosition={left:V.left,top:V.top,scaleX:1,scaleY:1};let{offsetHeight:$,offsetWidth:R}=j;return R>2&&$>2&&(this.chartPosition.scaleX=V.width/R,this.chartPosition.scaleY=V.height/$),this.chartPosition}getCoordinates(j){let V={xAxis:[],yAxis:[]};for(let $ of this.chart.axes)V[$.isXAxis?"xAxis":"yAxis"].push({axis:$,value:$.toValue(j[$.horiz?"chartX":"chartY"])});return V}getHoverData(j,V,$,R,L,G){let U=[],F=function(ie){return ie.visible&&!(!L&&ie.directTouch)&&M(ie.options.enableMouseTracking,!0)},H=V,W,ne={chartX:G?G.chartX:void 0,chartY:G?G.chartY:void 0,shared:L};A(this,"beforeGetHoverData",ne),W=H&&!H.stickyTracking?[H]:$.filter(ie=>ie.stickyTracking&&(ne.filter||F)(ie));let ue=R&&j||!G?j:this.findNearestKDPoint(W,L,G);return H=ue&&ue.series,ue&&(L&&!H.noSharedTooltip?(W=$.filter(function(ie){return ne.filter?ne.filter(ie):F(ie)&&!ie.noSharedTooltip})).forEach(function(ie){let oe=k(ie.points,function(Te){return Te.x===ue.x&&!Te.isNull});I(oe)&&(ie.boosted&&ie.boost&&(oe=ie.boost.getPoint(oe)),U.push(oe))}):U.push(ue)),A(this,"afterGetHoverData",ne={hoverPoint:ue}),{hoverPoint:ne.hoverPoint,hoverSeries:H,hoverPoints:U}}getPointFromEvent(j){let V=j.target,$;for(;V&&!$;)$=V.point,V=V.parentNode;return $}onTrackerMouseOut(j){let V=this.chart,$=j.relatedTarget,R=V.hoverSeries;this.isDirectTouch=!1,!R||!$||R.stickyTracking||this.inClass($,"highcharts-tooltip")||this.inClass($,"highcharts-series-"+R.index)&&this.inClass($,"highcharts-tracker")||R.onMouseOut()}inClass(j,V){let $=j,R;for(;$;){if(R=P($,"class")){if(R.indexOf(V)!==-1)return!0;if(R.indexOf("highcharts-container")!==-1)return!1}$=$.parentElement}}constructor(j,V){var $;this.hasDragged=0,this.pointerCaptureEventsToUnbind=[],this.eventsToUnbind=[],this.options=V,this.chart=j,this.runChartClick=!!(($=V.chart.events)!=null&&$.click),this.pinchDown=[],this.setDOMEvents(),A(this,"afterInit")}normalize(j,V){let $=j.touches,R=$?$.length?$.item(0):M($.changedTouches,j.changedTouches)[0]:j;V||(V=this.getChartPosition());let L=R.pageX-V.left,G=R.pageY-V.top;return S(j,{chartX:Math.round(L/=V.scaleX),chartY:Math.round(G/=V.scaleY)})}onContainerClick(j){let V=this.chart,$=V.hoverPoint,R=this.normalize(j),L=V.plotLeft,G=V.plotTop;!V.cancelClick&&($&&this.inClass(R.target,"highcharts-tracker")?(A($.series,"click",S(R,{point:$})),V.hoverPoint&&$.firePointEvent("click",R)):(S(R,this.getCoordinates(R)),V.isInsidePlot(R.chartX-L,R.chartY-G,{visiblePlotOnly:!0})&&A(V,"click",R)))}onContainerMouseDown(j){var $;let V=(1&(j.buttons||j.button))==1;j=this.normalize(j),h.isFirefox&&j.button!==0&&this.onContainerMouseMove(j),(j.button===void 0||V)&&(this.zoomOption(j),V&&(($=j.preventDefault)==null||$.call(j)),this.dragStart(j))}onContainerMouseLeave(j){let{pointer:V}=b[M(X.hoverChartIndex,-1)]||{};j=this.normalize(j),this.onContainerMouseMove(j),V&&!this.inClass(j.relatedTarget,"highcharts-tooltip")&&(V.reset(),V.chartPosition=void 0)}onContainerMouseEnter(){delete this.chartPosition}onContainerMouseMove(j){let V=this.chart,$=V.tooltip,R=this.normalize(j);this.setHoverChartIndex(j),(V.mouseIsDown==="mousedown"||this.touchSelect(R))&&this.drag(R),!V.openMenu&&(this.inClass(R.target,"highcharts-tracker")||V.isInsidePlot(R.chartX-V.plotLeft,R.chartY-V.plotTop,{visiblePlotOnly:!0}))&&!($&&$.shouldStickOnContact(R))&&(this.inClass(R.target,"highcharts-no-tooltip")?this.reset(!1,0):this.runPointActions(R))}onDocumentTouchEnd(j){this.onDocumentMouseUp(j)}onContainerTouchMove(j){this.touchSelect(j)?this.onContainerMouseMove(j):this.touch(j)}onContainerTouchStart(j){this.touchSelect(j)?this.onContainerMouseDown(j):(this.zoomOption(j),this.touch(j,!0))}onDocumentMouseMove(j){let V=this.chart,$=V.tooltip,R=this.chartPosition,L=this.normalize(j,R);!R||V.isInsidePlot(L.chartX-V.plotLeft,L.chartY-V.plotTop,{visiblePlotOnly:!0})||$&&$.shouldStickOnContact(L)||L.target!==V.container.ownerDocument&&this.inClass(L.target,"highcharts-tracker")||this.reset()}onDocumentMouseUp(j){var V,$;($=(V=b[M(X.hoverChartIndex,-1)])==null?void 0:V.pointer)==null||$.drop(j)}pinch(j){let V=this,{chart:$,hasZoom:R,lastTouches:L}=V,G=[].map.call(j.touches||[],ne=>V.normalize(ne)),U=G.length,F=U===1&&(V.inClass(j.target,"highcharts-tracker")&&$.runTrackerClick||V.runChartClick),H=$.tooltip,W=U===1&&M(H==null?void 0:H.options.followTouchMove,!0);U>1?V.initiated=!0:W&&(V.initiated=!1),R&&V.initiated&&!F&&j.cancelable!==!1&&j.preventDefault(),j.type==="touchstart"?(V.pinchDown=G,V.res=!0,$.mouseDownX=j.chartX):W?this.runPointActions(V.normalize(j)):L&&(A($,"touchpan",{originalEvent:j,touches:G},()=>{let ne=ue=>{let ie=ue[0],oe=ue[1]||ie;return{x:ie.chartX,y:ie.chartY,width:oe.chartX-ie.chartX,height:oe.chartY-ie.chartY}};$.transform({axes:$.axes.filter(ue=>ue.zoomEnabled&&(this.zoomHor&&ue.horiz||this.zoomVert&&!ue.horiz)),to:ne(G),from:ne(L),trigger:j.type})}),V.res&&(V.res=!1,this.reset(!1,0))),V.lastTouches=G}reset(j,V){let $=this.chart,R=$.hoverSeries,L=$.hoverPoint,G=$.hoverPoints,U=$.tooltip,F=U&&U.shared?G:L;j&&F&&Y(F).forEach(function(H){H.series.isCartesian&&H.plotX===void 0&&(j=!1)}),j?U&&F&&Y(F).length&&(U.refresh(F),U.shared&&G?G.forEach(function(H){H.setState(H.state,!0),H.series.isCartesian&&(H.series.xAxis.crosshair&&H.series.xAxis.drawCrosshair(null,H),H.series.yAxis.crosshair&&H.series.yAxis.drawCrosshair(null,H))}):L&&(L.setState(L.state,!0),$.axes.forEach(function(H){H.crosshair&&L.series[H.coll]===H&&H.drawCrosshair(null,L)}))):(L&&L.onMouseOut(),G&&G.forEach(function(H){H.setState()}),R&&R.onMouseOut(),U&&U.hide(V),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),$.axes.forEach(function(H){H.hideCrosshair()}),$.hoverPoints=$.hoverPoint=void 0)}runPointActions(j,V,$){let R=this.chart,L=R.series,G=R.tooltip&&R.tooltip.options.enabled?R.tooltip:void 0,U=!!G&&G.shared,F=V||R.hoverPoint,H=F&&F.series||R.hoverSeries,W=(!j||j.type!=="touchmove")&&(!!V||H&&H.directTouch&&this.isDirectTouch),ne=this.getHoverData(F,H,L,W,U,j);F=ne.hoverPoint,H=ne.hoverSeries;let ue=ne.hoverPoints,ie=H&&H.tooltipOptions.followPointer&&!H.tooltipOptions.split,oe=U&&H&&!H.noSharedTooltip;if(F&&($||F!==R.hoverPoint||G&&G.isHidden)){if((R.hoverPoints||[]).forEach(function(Te){ue.indexOf(Te)===-1&&Te.setState()}),R.hoverSeries!==H&&H.onMouseOver(),this.applyInactiveState(ue),(ue||[]).forEach(function(Te){Te.setState("hover")}),R.hoverPoint&&R.hoverPoint.firePointEvent("mouseOut"),!F.series)return;R.hoverPoints=ue,R.hoverPoint=F,F.firePointEvent("mouseOver",void 0,()=>{G&&F&&G.refresh(oe?ue:F,j)})}else if(ie&&G&&!G.isHidden){let Te=G.getAnchor([{}],j);R.isInsidePlot(Te[0],Te[1],{visiblePlotOnly:!0})&&G.updatePosition({plotX:Te[0],plotY:Te[1]})}this.unDocMouseMove||(this.unDocMouseMove=g(R.container.ownerDocument,"mousemove",Te=>{var ge,we;return(we=(ge=b[X.hoverChartIndex??-1])==null?void 0:ge.pointer)==null?void 0:we.onDocumentMouseMove(Te)}),this.eventsToUnbind.push(this.unDocMouseMove)),R.axes.forEach(function(Te){let ge,we=M((Te.crosshair||{}).snap,!0);!we||(ge=R.hoverPoint)&&ge.series[Te.coll]===Te||(ge=k(ue,K=>K.series&&K.series[Te.coll]===Te)),ge||!we?Te.drawCrosshair(j,ge):Te.hideCrosshair()})}setDOMEvents(){let j=this.chart.container,V=j.ownerDocument;j.onmousedown=this.onContainerMouseDown.bind(this),j.onmousemove=this.onContainerMouseMove.bind(this),j.onclick=this.onContainerClick.bind(this),this.eventsToUnbind.push(g(j,"mouseenter",this.onContainerMouseEnter.bind(this)),g(j,"mouseleave",this.onContainerMouseLeave.bind(this))),X.unbindDocumentMouseUp||(X.unbindDocumentMouseUp=[]),X.unbindDocumentMouseUp.push(g(V,"mouseup",this.onDocumentMouseUp.bind(this)));let $=this.chart.renderTo.parentElement;for(;$&&$.tagName!=="BODY";)this.eventsToUnbind.push(g($,"scroll",()=>{delete this.chartPosition})),$=$.parentElement;this.eventsToUnbind.push(g(j,"touchstart",this.onContainerTouchStart.bind(this),{passive:!1}),g(j,"touchmove",this.onContainerTouchMove.bind(this),{passive:!1})),X.unbindDocumentTouchEnd||(X.unbindDocumentTouchEnd=g(V,"touchend",this.onDocumentTouchEnd.bind(this),{passive:!1})),this.setPointerCapture(),g(this.chart,"redraw",this.setPointerCapture.bind(this))}setPointerCapture(){var L,G;if(!v)return;let j=this.pointerCaptureEventsToUnbind,V=this.chart,$=V.container,R=M((L=V.options.tooltip)==null?void 0:L.followTouchMove,!0)&&V.series.some(U=>U.options.findNearestPointBy.indexOf("y")>-1);!this.hasPointerCapture&&R?(j.push(g($,"pointerdown",U=>{var F,H;(F=U.target)!=null&&F.hasPointerCapture(U.pointerId)&&((H=U.target)==null||H.releasePointerCapture(U.pointerId))}),g($,"pointermove",U=>{var F,H;(H=(F=V.pointer)==null?void 0:F.getPointFromEvent(U))==null||H.onMouseOver(U)})),V.styledMode||_($,{"touch-action":"none"}),$.className+=" highcharts-no-touch-action",this.hasPointerCapture=!0):this.hasPointerCapture&&!R&&(j.forEach(U=>U()),j.length=0,V.styledMode||_($,{"touch-action":M((G=V.options.chart.style)==null?void 0:G["touch-action"],"manipulation")}),$.className=$.className.replace(" highcharts-no-touch-action",""),this.hasPointerCapture=!1)}setHoverChartIndex(j){var R;let V=this.chart,$=h.charts[M(X.hoverChartIndex,-1)];if($&&$!==V){let L={relatedTarget:V.container};j&&!(j!=null&&j.relatedTarget)&&(j={...L,...j}),(R=$.pointer)==null||R.onContainerMouseLeave(j||L)}$&&$.mouseIsDown||(X.hoverChartIndex=V.index)}touch(j,V){let $,{chart:R,pinchDown:L=[]}=this;this.setHoverChartIndex(),(j=this.normalize(j)).touches.length===1?R.isInsidePlot(j.chartX-R.plotLeft,j.chartY-R.plotTop,{visiblePlotOnly:!0})&&!R.openMenu?(V&&this.runPointActions(j),j.type==="touchmove"&&($=!!L[0]&&Math.pow(L[0].chartX-j.chartX,2)+Math.pow(L[0].chartY-j.chartY,2)>=16),M($,!0)&&this.pinch(j)):V&&this.reset():j.touches.length===2&&this.pinch(j)}touchSelect(j){return!!(this.chart.zooming.singleTouch&&j.touches&&j.touches.length===1)}zoomOption(j){let V=this.chart,$=V.inverted,R=V.zooming.type||"",L,G;/touch/.test(j.type)&&(R=M(V.zooming.pinchType,R)),this.zoomX=L=/x/.test(R),this.zoomY=G=/y/.test(R),this.zoomHor=L&&!$||G&&$,this.zoomVert=G&&!$||L&&$,this.hasZoom=L||G}}return(s=X).compose=function(Z){z(x,"Core.Pointer")&&g(Z,"beforeRender",function(){this.pointer=new s(this,this.options)})},X}),c(t,"Core/Legend/LegendSymbol.js",[t["Core/Utilities.js"]],function(a){var h;let{extend:d,merge:s,pick:f}=a;return function(b){function x(v,g,P){var $,R;let _=this.legendItem=this.legendItem||{},{chart:S,options:k}=this,{baseline:A=0,symbolWidth:y,symbolHeight:I}=v,D=this.symbol||"circle",w=I/2,M=S.renderer,z=_.group,Y=A-Math.round(((($=v.fontMetrics)==null?void 0:$.b)||I)*(P?.4:.3)),X={},Z,j=k.marker,V=0;if(S.styledMode||(X["stroke-width"]=Math.min(k.lineWidth||0,24),k.dashStyle?X.dashstyle=k.dashStyle:k.linecap==="square"||(X["stroke-linecap"]="round")),_.line=M.path().addClass("highcharts-graph").attr(X).add(z),P&&(_.area=M.path().addClass("highcharts-area").add(z)),X["stroke-linecap"]&&(V=Math.min(_.line.strokeWidth(),y)/2),y){let L=[["M",V,Y],["L",y-V,Y]];_.line.attr({d:L}),(R=_.area)==null||R.attr({d:[...L,["L",y-V,A],["L",V,A]]})}if(j&&j.enabled!==!1&&y){let L=Math.min(f(j.radius,w),w);D.indexOf("url")===0&&(j=s(j,{width:I,height:I}),L=0),_.symbol=Z=M.symbol(D,y/2-L,Y-L,2*L,2*L,d({context:"legend"},j)).addClass("highcharts-point").add(z),Z.isMarker=!0}}b.areaMarker=function(v,g){x.call(this,v,g,!0)},b.lineMarker=x,b.rectangle=function(v,g){let P=g.legendItem||{},_=v.options,S=v.symbolHeight,k=_.squareSymbol,A=k?S:v.symbolWidth;P.symbol=this.chart.renderer.rect(k?(v.symbolWidth-S)/2:0,v.baseline-S+1,A,S,f(v.options.symbolRadius,S/2)).addClass("highcharts-point").attr({zIndex:3}).add(P.group)}}(h||(h={})),h}),c(t,"Core/Series/SeriesDefaults.js",[],function(){return{lineWidth:2,allowPointSelect:!1,crisp:!0,showCheckbox:!1,animation:{duration:1e3},enableMouseTracking:!0,events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:150},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{animation:{},align:"center",borderWidth:0,defer:!0,formatter:function(){let{numberFormatter:a}=this.series.chart;return typeof this.y!="number"?"":a(this.y,-1)},padding:5,style:{fontSize:"0.7em",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:150},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:150},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"}}),c(t,"Core/Series/SeriesRegistry.js",[t["Core/Globals.js"],t["Core/Defaults.js"],t["Core/Series/Point.js"],t["Core/Utilities.js"]],function(a,h,d,s){var f;let{defaultOptions:b}=h,{extend:x,extendClass:v,merge:g}=s;return function(P){function _(S,k){let A=b.plotOptions||{},y=k.defaultOptions,I=k.prototype;return I.type=S,I.pointClass||(I.pointClass=d),!P.seriesTypes[S]&&(y&&(A[S]=y),P.seriesTypes[S]=k,!0)}P.seriesTypes=a.seriesTypes,P.registerSeriesType=_,P.seriesType=function(S,k,A,y,I){let D=b.plotOptions||{};if(k=k||"",D[S]=g(D[k],A),delete P.seriesTypes[S],_(S,v(P.seriesTypes[k]||function(){},y)),P.seriesTypes[S].prototype.type=S,I){class w extends d{}x(w.prototype,I),P.seriesTypes[S].prototype.pointClass=w}return P.seriesTypes[S]}}(f||(f={})),f}),c(t,"Core/Series/Series.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Defaults.js"],t["Core/Foundation.js"],t["Core/Globals.js"],t["Core/Legend/LegendSymbol.js"],t["Core/Series/Point.js"],t["Core/Series/SeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Renderer/SVG/SVGElement.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b,x,v,g,P){let{animObject:_,setAnimation:S}=a,{defaultOptions:k}=h,{registerEventOptions:A}=d,{svg:y,win:I}=s,{seriesTypes:D}=v,{arrayMax:w,arrayMin:M,clamp:z,correctFloat:Y,crisp:X,defined:Z,destroyObjectProperties:j,diffObjects:V,erase:$,error:R,extend:L,find:G,fireEvent:U,getClosestDistance:F,getNestedProperty:H,insertItem:W,isArray:ne,isNumber:ue,isString:ie,merge:oe,objectEach:Te,pick:ge,removeEvent:we,splat:K,syncTimeout:Q}=P;class ae{constructor(){this.zoneAxis="y"}init(J,re){let ce;U(this,"init",{options:re});let pe=this,xe=J.series;this.eventsToUnbind=[],pe.chart=J,pe.options=pe.setOptions(re);let Me=pe.options,_e=Me.visible!==!1;pe.linkedSeries=[],pe.bindAxes(),L(pe,{name:Me.name,state:"",visible:_e,selected:Me.selected===!0}),A(this,Me);let Ce=Me.events;(Ce&&Ce.click||Me.point&&Me.point.events&&Me.point.events.click||Me.allowPointSelect)&&(J.runTrackerClick=!0),pe.getColor(),pe.getSymbol(),pe.parallelArrays.forEach(function(Le){pe[Le+"Data"]||(pe[Le+"Data"]=[])}),pe.isCartesian&&(J.hasCartesianSeries=!0),xe.length&&(ce=xe[xe.length-1]),pe._i=ge(ce&&ce._i,-1)+1,pe.opacity=pe.options.opacity,J.orderItems("series",W(this,xe)),Me.dataSorting&&Me.dataSorting.enabled?pe.setDataSortingOptions():pe.points||pe.data||pe.setData(Me.data,!1),U(this,"afterInit")}is(J){return D[J]&&this instanceof D[J]}bindAxes(){let J,re=this,ce=re.options,pe=re.chart;U(this,"bindAxes",null,function(){(re.axisTypes||[]).forEach(function(xe){(pe[xe]||[]).forEach(function(Me){J=Me.options,(ge(ce[xe],0)===Me.index||ce[xe]!==void 0&&ce[xe]===J.id)&&(W(re,Me.series),re[xe]=Me,Me.isDirty=!0)}),re[xe]||re.optionalAxis===xe||R(18,!0,pe)})}),U(this,"afterBindAxes")}updateParallelArrays(J,re,ce){let pe=J.series,xe=ue(re)?function(Me){let _e=Me==="y"&&pe.toYData?pe.toYData(J):J[Me];pe[Me+"Data"][re]=_e}:function(Me){Array.prototype[re].apply(pe[Me+"Data"],ce)};pe.parallelArrays.forEach(xe)}hasData(){return this.visible&&this.dataMax!==void 0&&this.dataMin!==void 0||this.visible&&this.yData&&this.yData.length>0}hasMarkerChanged(J,re){let ce=J.marker,pe=re.marker||{};return ce&&(pe.enabled&&!ce.enabled||pe.symbol!==ce.symbol||pe.height!==ce.height||pe.width!==ce.width)}autoIncrement(J){let re=this.options,ce=re.pointIntervalUnit,pe=re.relativeXValue,xe=this.chart.time,Me=this.xIncrement,_e,Ce;return Me=ge(Me,re.pointStart,0),this.pointInterval=Ce=ge(this.pointInterval,re.pointInterval,1),pe&&ue(J)&&(Ce*=J),ce&&(_e=new xe.Date(Me),ce==="day"?xe.set("Date",_e,xe.get("Date",_e)+Ce):ce==="month"?xe.set("Month",_e,xe.get("Month",_e)+Ce):ce==="year"&&xe.set("FullYear",_e,xe.get("FullYear",_e)+Ce),Ce=_e.getTime()-Me),pe&&ue(J)?Me+Ce:(this.xIncrement=Me+Ce,Me)}setDataSortingOptions(){let J=this.options;L(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),Z(J.pointRange)||(J.pointRange=1)}setOptions(J){var Re,Fe;let re,ce=this.chart,pe=ce.options.plotOptions,xe=ce.userOptions||{},Me=oe(J),_e=ce.styledMode,Ce={plotOptions:pe,userOptions:Me};U(this,"setOptions",Ce);let Le=Ce.plotOptions[this.type],Ue=xe.plotOptions||{},Xe=Ue.series||{},Pe=k.plotOptions[this.type]||{},Ee=Ue[this.type]||{};this.userOptions=Ce.userOptions;let Ie=oe(Le,pe.series,Ee,Me);this.tooltipOptions=oe(k.tooltip,(Re=k.plotOptions.series)==null?void 0:Re.tooltip,Pe==null?void 0:Pe.tooltip,ce.userOptions.tooltip,(Fe=Ue.series)==null?void 0:Fe.tooltip,Ee.tooltip,Me.tooltip),this.stickyTracking=ge(Me.stickyTracking,Ee.stickyTracking,Xe.stickyTracking,!!this.tooltipOptions.shared&&!this.noSharedTooltip||Ie.stickyTracking),Le.marker===null&&delete Ie.marker,this.zoneAxis=Ie.zoneAxis||"y";let Oe=this.zones=(Ie.zones||[]).map(Ke=>({...Ke}));return(Ie.negativeColor||Ie.negativeFillColor)&&!Ie.zones&&(re={value:Ie[this.zoneAxis+"Threshold"]||Ie.threshold||0,className:"highcharts-negative"},_e||(re.color=Ie.negativeColor,re.fillColor=Ie.negativeFillColor),Oe.push(re)),Oe.length&&Z(Oe[Oe.length-1].value)&&Oe.push(_e?{}:{color:this.color,fillColor:this.fillColor}),U(this,"afterSetOptions",{options:Ie}),Ie}getName(){return ge(this.options.name,"Series "+(this.index+1))}getCyclic(J,re,ce){let pe,xe,Me=this.chart,_e=`${J}Index`,Ce=`${J}Counter`,Le=(ce==null?void 0:ce.length)||Me.options.chart.colorCount;!re&&(Z(xe=ge(J==="color"?this.options.colorIndex:void 0,this[_e]))?pe=xe:(Me.series.length||(Me[Ce]=0),pe=Me[Ce]%Le,Me[Ce]+=1),ce&&(re=ce[pe])),pe!==void 0&&(this[_e]=pe),this[J]=re}getColor(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.color="#cccccc":this.getCyclic("color",this.options.color||k.plotOptions[this.type].color,this.chart.options.colors)}getPointsCollection(){return(this.hasGroupedData?this.points:this.data)||[]}getSymbol(){let J=this.options.marker;this.getCyclic("symbol",J.symbol,this.chart.options.symbols)}findPointIndex(J,re){let ce,pe,xe,Me=J.id,_e=J.x,Ce=this.points,Le=this.options.dataSorting;if(Me){let Ue=this.chart.get(Me);Ue instanceof b&&(ce=Ue)}else if(this.linkedParent||this.enabledDataSorting||this.options.relativeXValue){let Ue=Xe=>!Xe.touched&&Xe.index===J.index;if(Le&&Le.matchByName?Ue=Xe=>!Xe.touched&&Xe.name===J.name:this.options.relativeXValue&&(Ue=Xe=>!Xe.touched&&Xe.options.x===J.x),!(ce=G(Ce,Ue)))return}return ce&&(xe=ce&&ce.index)!==void 0&&(pe=!0),xe===void 0&&ue(_e)&&(xe=this.xData.indexOf(_e,re)),xe!==-1&&xe!==void 0&&this.cropped&&(xe=xe>=this.cropStart?xe-this.cropStart:xe),!pe&&ue(xe)&&Ce[xe]&&Ce[xe].touched&&(xe=void 0),xe}updateData(J,re){let ce=this.options,pe=ce.dataSorting,xe=this.points,Me=[],_e=this.requireSorting,Ce=J.length===xe.length,Le,Ue,Xe,Pe,Ee=!0;if(this.xIncrement=null,J.forEach(function(Ie,Oe){let Re,Fe=Z(Ie)&&this.pointClass.prototype.optionsToObject.call({series:this},Ie)||{},Ke=Fe.x;Fe.id||ue(Ke)?((Re=this.findPointIndex(Fe,Pe))===-1||Re===void 0?Me.push(Ie):xe[Re]&&Ie!==ce.data[Re]?(xe[Re].update(Ie,!1,null,!1),xe[Re].touched=!0,_e&&(Pe=Re+1)):xe[Re]&&(xe[Re].touched=!0),(!Ce||Oe!==Re||pe&&pe.enabled||this.hasDerivedData)&&(Le=!0)):Me.push(Ie)},this),Le)for(Ue=xe.length;Ue--;)(Xe=xe[Ue])&&!Xe.touched&&Xe.remove&&Xe.remove(!1,re);else!Ce||pe&&pe.enabled?Ee=!1:(J.forEach(function(Ie,Oe){Ie===xe[Oe].y||xe[Oe].destroyed||xe[Oe].update(Ie,!1,null,!1)}),Me.length=0);return xe.forEach(function(Ie){Ie&&(Ie.touched=!1)}),!!Ee&&(Me.forEach(function(Ie){this.addPoint(Ie,!1,null,null,!1)},this),this.xIncrement===null&&this.xData&&this.xData.length&&(this.xIncrement=w(this.xData),this.autoIncrement()),!0)}setData(J,re=!0,ce,pe){var pt;let xe=this,Me=xe.points,_e=Me&&Me.length||0,Ce=xe.options,Le=xe.chart,Ue=Ce.dataSorting,Xe=xe.xAxis,Pe=Ce.turboThreshold,Ee=this.xData,Ie=this.yData,Oe=xe.pointArrayMap,Re=Oe&&Oe.length,Fe=Ce.keys,Ke,rt,at,ut=0,mt=1,Tt;Le.options.chart.allowMutatingData||(Ce.data&&delete xe.options.data,xe.userOptions.data&&delete xe.userOptions.data,Tt=oe(!0,J));let Rt=(J=Tt||J||[]).length;if(Ue&&Ue.enabled&&(J=this.sortData(J)),Le.options.chart.allowMutatingData&&pe!==!1&&Rt&&_e&&!xe.cropped&&!xe.hasGroupedData&&xe.visible&&!xe.boosted&&(at=this.updateData(J,ce)),!at){xe.xIncrement=null,xe.colorCounter=0,this.parallelArrays.forEach(function(Et){xe[Et+"Data"].length=0});let Ct=Pe&&Rt>Pe;if(Ct){let Et=xe.getFirstValidPoint(J),ri=xe.getFirstValidPoint(J,Rt-1,-1),ci=Vt=>!!(ne(Vt)&&(Fe||ue(Vt[0])));if(ue(Et)&&ue(ri))for(Ke=0;Ke<Rt;Ke++)Ee[Ke]=this.autoIncrement(),Ie[Ke]=J[Ke];else if(ci(Et)&&ci(ri))if(Re)if(Et.length===Re)for(Ke=0;Ke<Rt;Ke++)Ee[Ke]=this.autoIncrement(),Ie[Ke]=J[Ke];else for(Ke=0;Ke<Rt;Ke++)rt=J[Ke],Ee[Ke]=rt[0],Ie[Ke]=rt.slice(1,Re+1);else if(Fe&&(ut=Fe.indexOf("x"),mt=Fe.indexOf("y"),ut=ut>=0?ut:0,mt=mt>=0?mt:1),Et.length===1&&(mt=0),ut===mt)for(Ke=0;Ke<Rt;Ke++)Ee[Ke]=this.autoIncrement(),Ie[Ke]=J[Ke][mt];else for(Ke=0;Ke<Rt;Ke++)rt=J[Ke],Ee[Ke]=rt[ut],Ie[Ke]=rt[mt];else Ct=!1}if(!Ct)for(Ke=0;Ke<Rt;Ke++)rt={series:xe},xe.pointClass.prototype.applyOptions.apply(rt,[J[Ke]]),xe.updateParallelArrays(rt,Ke);for(Ie&&ie(Ie[0])&&R(14,!0,Le),xe.data=[],xe.options.data=xe.userOptions.data=J,Ke=_e;Ke--;)(pt=Me[Ke])==null||pt.destroy();Xe&&(Xe.minRange=Xe.userMinRange),xe.isDirty=Le.isDirtyBox=!0,xe.isDirtyData=!!Me,ce=!1}Ce.legendType==="point"&&(this.processData(),this.generatePoints()),re&&Le.redraw(ce)}sortData(J){let re=this,ce=re.options.dataSorting.sortKey||"y",pe=function(xe,Me){return Z(Me)&&xe.pointClass.prototype.optionsToObject.call({series:xe},Me)||{}};return J.forEach(function(xe,Me){J[Me]=pe(re,xe),J[Me].index=Me},this),J.concat().sort((xe,Me)=>{let _e=H(ce,xe),Ce=H(ce,Me);return Ce<_e?-1:Ce>_e?1:0}).forEach(function(xe,Me){xe.x=Me},this),re.linkedSeries&&re.linkedSeries.forEach(function(xe){let Me=xe.options,_e=Me.data;Me.dataSorting&&Me.dataSorting.enabled||!_e||(_e.forEach(function(Ce,Le){_e[Le]=pe(xe,Ce),J[Le]&&(_e[Le].x=J[Le].x,_e[Le].index=Le)}),xe.setData(_e,!1))}),J}getProcessedData(J){let re=this,ce=re.xAxis,pe=re.options.cropThreshold,xe=ce==null?void 0:ce.logarithmic,Me=re.isCartesian,_e,Ce,Le=0,Ue,Xe,Pe,Ee=re.xData,Ie=re.yData,Oe=!1,Re=Ee.length;ce&&(Xe=(Ue=ce.getExtremes()).min,Pe=Ue.max,Oe=!!(ce.categories&&!ce.names.length)),Me&&re.sorted&&!J&&(!pe||Re>pe||re.forceCrop)&&(Ee[Re-1]<Xe||Ee[0]>Pe?(Ee=[],Ie=[]):re.yData&&(Ee[0]<Xe||Ee[Re-1]>Pe)&&(Ee=(_e=this.cropData(re.xData,re.yData,Xe,Pe)).xData,Ie=_e.yData,Le=_e.start,Ce=!0));let Fe=F([xe?Ee.map(xe.log2lin):Ee],()=>re.requireSorting&&!Oe&&R(15,!1,re.chart));return{xData:Ee,yData:Ie,cropped:Ce,cropStart:Le,closestPointRange:Fe}}processData(J){let re=this.xAxis;if(this.isCartesian&&!this.isDirty&&!re.isDirty&&!this.yAxis.isDirty&&!J)return!1;let ce=this.getProcessedData();this.cropped=ce.cropped,this.cropStart=ce.cropStart,this.processedXData=ce.xData,this.processedYData=ce.yData,this.closestPointRange=this.basePointRange=ce.closestPointRange,U(this,"afterProcessData")}cropData(J,re,ce,pe){let xe=J.length,Me,_e,Ce=0,Le=xe;for(Me=0;Me<xe;Me++)if(J[Me]>=ce){Ce=Math.max(0,Me-1);break}for(_e=Me;_e<xe;_e++)if(J[_e]>pe){Le=_e+1;break}return{xData:J.slice(Ce,Le),yData:re.slice(Ce,Le),start:Ce,end:Le}}generatePoints(){let J=this.options,re=this.processedData||J.data,ce=this.processedXData,pe=this.processedYData,xe=this.pointClass,Me=ce.length,_e=this.cropStart||0,Ce=this.hasGroupedData,Le=J.keys,Ue=[],Xe=J.dataGrouping&&J.dataGrouping.groupAll?_e:0,Pe,Ee,Ie,Oe,Re=this.data;if(!Re&&!Ce){let Fe=[];Fe.length=re.length,Re=this.data=Fe}for(Le&&Ce&&(this.options.keys=!1),Oe=0;Oe<Me;Oe++)Ee=_e+Oe,Ce?((Ie=new xe(this,[ce[Oe]].concat(K(pe[Oe])))).dataGroup=this.groupMap[Xe+Oe],Ie.dataGroup.options&&(Ie.options=Ie.dataGroup.options,L(Ie,Ie.dataGroup.options),delete Ie.dataLabels)):(Ie=Re[Ee])||re[Ee]===void 0||(Re[Ee]=Ie=new xe(this,re[Ee],ce[Oe])),Ie&&(Ie.index=Ce?Xe+Oe:Ee,Ue[Oe]=Ie);if(this.options.keys=Le,Re&&(Me!==(Pe=Re.length)||Ce))for(Oe=0;Oe<Pe;Oe++)Oe!==_e||Ce||(Oe+=Me),Re[Oe]&&(Re[Oe].destroyElements(),Re[Oe].plotX=void 0);this.data=Re,this.points=Ue,U(this,"afterGeneratePoints")}getXExtremes(J){return{min:M(J),max:w(J)}}getExtremes(J,re){let ce=this.xAxis,pe=this.yAxis,xe=[],Me=this.requireSorting&&!this.is("column")?1:0,_e=!!pe&&pe.positiveValuesOnly,Ce=re||this.getExtremesFromAll||this.options.getExtremesFromAll,{processedXData:Le,processedYData:Ue}=this,Xe,Pe,Ee,Ie,Oe,Re,Fe,Ke=0,rt=0,at=0;if(this.cropped&&Ce){let Rt=this.getProcessedData(!0);Le=Rt.xData,Ue=Rt.yData}let ut=(J=J||this.stackedYData||Ue||[]).length,mt=Le||this.xData;for(ce&&(Ke=(Xe=ce.getExtremes()).min,rt=Xe.max),Re=0;Re<ut;Re++)if(Ie=mt[Re],Pe=(ue(Oe=J[Re])||ne(Oe))&&((ue(Oe)?Oe>0:Oe.length)||!_e),Ee=re||this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||!ce||(mt[Re+Me]||Ie)>=Ke&&(mt[Re-Me]||Ie)<=rt,Pe&&Ee)if(Fe=Oe.length)for(;Fe--;)ue(Oe[Fe])&&(xe[at++]=Oe[Fe]);else xe[at++]=Oe;let Tt={activeYData:xe,dataMin:M(xe),dataMax:w(xe)};return U(this,"afterGetExtremes",{dataExtremes:Tt}),Tt}applyExtremes(){let J=this.getExtremes();return this.dataMin=J.dataMin,this.dataMax=J.dataMax,J}getFirstValidPoint(J,re=0,ce=1){let pe=J.length,xe=re;for(;xe>=0&&xe<pe;){if(Z(J[xe]))return J[xe];xe+=ce}}translate(){var rt;this.processedXData||this.processData(),this.generatePoints();let J=this.options,re=J.stacking,ce=this.xAxis,pe=ce.categories,xe=this.enabledDataSorting,Me=this.yAxis,_e=this.points,Ce=_e.length,Le=this.pointPlacementToXValue(),Ue=!!Le,Xe=J.threshold,Pe=J.startFromThreshold?Xe:0,Ee,Ie,Oe,Re,Fe=Number.MAX_VALUE;function Ke(at){return z(at,-1e9,1e9)}for(Ee=0;Ee<Ce;Ee++){let at,ut=_e[Ee],mt=ut.x,Tt,Rt,pt=ut.y,Ct=ut.low,Et=re&&((rt=Me.stacking)==null?void 0:rt.stacks[(this.negStacks&&pt<(Pe?0:Xe)?"-":"")+this.stackKey]);Ie=ce.translate(mt,!1,!1,!1,!0,Le),ut.plotX=ue(Ie)?Y(Ke(Ie)):void 0,re&&this.visible&&Et&&Et[mt]&&(Re=this.getStackIndicator(Re,mt,this.index),!ut.isNull&&Re.key&&(Rt=(Tt=Et[mt]).points[Re.key]),Tt&&ne(Rt)&&(Ct=Rt[0],pt=Rt[1],Ct===Pe&&Re.key===Et[mt].base&&(Ct=ge(ue(Xe)?Xe:Me.min)),Me.positiveValuesOnly&&Z(Ct)&&Ct<=0&&(Ct=void 0),ut.total=ut.stackTotal=ge(Tt.total),ut.percentage=Z(ut.y)&&Tt.total?ut.y/Tt.total*100:void 0,ut.stackY=pt,this.irregularWidths||Tt.setOffset(this.pointXOffset||0,this.barW||0,void 0,void 0,void 0,this.xAxis))),ut.yBottom=Z(Ct)?Ke(Me.translate(Ct,!1,!0,!1,!0)):void 0,this.dataModify&&(pt=this.dataModify.modifyValue(pt,Ee)),ue(pt)&&ut.plotX!==void 0&&(at=ue(at=Me.translate(pt,!1,!0,!1,!0))?Ke(at):void 0),ut.plotY=at,ut.isInside=this.isPointInside(ut),ut.clientX=Ue?Y(ce.translate(mt,!1,!1,!1,!0,Le)):Ie,ut.negative=(ut.y||0)<(Xe||0),ut.category=ge(pe&&pe[ut.x],ut.x),ut.isNull||ut.visible===!1||(Oe!==void 0&&(Fe=Math.min(Fe,Math.abs(Ie-Oe))),Oe=Ie),ut.zone=this.zones.length?ut.getZone():void 0,!ut.graphic&&this.group&&xe&&(ut.isNew=!0)}this.closestPointRangePx=Fe,U(this,"afterTranslate")}getValidPoints(J,re,ce){let pe=this.chart;return(J||this.points||[]).filter(function(xe){let{plotX:Me,plotY:_e}=xe;return!!((ce||!xe.isNull&&ue(_e))&&(!re||pe.isInsidePlot(Me,_e,{inverted:pe.inverted})))&&xe.visible!==!1})}getClipBox(){let{chart:J,xAxis:re,yAxis:ce}=this,{x:pe,y:xe,width:Me,height:_e}=oe(J.clipBox);return re&&re.len!==J.plotSizeX&&(Me=re.len),ce&&ce.len!==J.plotSizeY&&(_e=ce.len),J.inverted&&!this.invertible&&([Me,_e]=[_e,Me]),{x:pe,y:xe,width:Me,height:_e}}getSharedClipKey(){return this.sharedClipKey=(this.options.xAxis||0)+","+(this.options.yAxis||0),this.sharedClipKey}setClip(){let{chart:J,group:re,markerGroup:ce}=this,pe=J.sharedClips,xe=J.renderer,Me=this.getClipBox(),_e=this.getSharedClipKey(),Ce=pe[_e];Ce?Ce.animate(Me):pe[_e]=Ce=xe.clipRect(Me),re&&re.clip(this.options.clip===!1?void 0:Ce),ce&&ce.clip()}animate(J){let{chart:re,group:ce,markerGroup:pe}=this,xe=re.inverted,Me=_(this.options.animation),_e=[this.getSharedClipKey(),Me.duration,Me.easing,Me.defer].join(","),Ce=re.sharedClips[_e],Le=re.sharedClips[_e+"m"];if(J&&ce){let Ue=this.getClipBox();if(Ce)Ce.attr("height",Ue.height);else{Ue.width=0,xe&&(Ue.x=re.plotHeight),Ce=re.renderer.clipRect(Ue),re.sharedClips[_e]=Ce;let Xe={x:-99,y:-99,width:xe?re.plotWidth+199:99,height:xe?99:re.plotHeight+199};Le=re.renderer.clipRect(Xe),re.sharedClips[_e+"m"]=Le}ce.clip(Ce),pe==null||pe.clip(Le)}else if(Ce&&!Ce.hasClass("highcharts-animating")){let Ue=this.getClipBox(),Xe=Me.step;(pe!=null&&pe.element.childNodes.length||re.series.length>1)&&(Me.step=function(Pe,Ee){Xe&&Xe.apply(Ee,arguments),Ee.prop==="width"&&(Le!=null&&Le.element)&&Le.attr(xe?"height":"width",Pe+99)}),Ce.addClass("highcharts-animating").animate(Ue,Me)}}afterAnimate(){this.setClip(),Te(this.chart.sharedClips,(J,re,ce)=>{J&&!this.chart.container.querySelector(`[clip-path="url(#${J.id})"]`)&&(J.destroy(),delete ce[re])}),this.finishedAnimating=!0,U(this,"afterAnimate")}drawPoints(J=this.points){let re,ce,pe,xe,Me,_e,Ce,Le=this.chart,Ue=Le.styledMode,{colorAxis:Xe,options:Pe}=this,Ee=Pe.marker,Ie=this[this.specialGroup||"markerGroup"],Oe=this.xAxis,Re=ge(Ee.enabled,!Oe||!!Oe.isRadial||null,this.closestPointRangePx>=Ee.enabledThreshold*Ee.radius);if(Ee.enabled!==!1||this._hasPointMarkers)for(re=0;re<J.length;re++)if(xe=(pe=(ce=J[re]).graphic)?"animate":"attr",Me=ce.marker||{},_e=!!ce.marker,(Re&&Me.enabled===void 0||Me.enabled)&&!ce.isNull&&ce.visible!==!1){let Fe=ge(Me.symbol,this.symbol,"rect");Ce=this.markerAttribs(ce,ce.selected&&"select"),this.enabledDataSorting&&(ce.startXPos=Oe.reversed?-(Ce.width||0):Oe.width);let Ke=ce.isInside!==!1;if(!pe&&Ke&&((Ce.width||0)>0||ce.hasImage)&&(ce.graphic=pe=Le.renderer.symbol(Fe,Ce.x,Ce.y,Ce.width,Ce.height,_e?Me:Ee).add(Ie),this.enabledDataSorting&&Le.hasRendered&&(pe.attr({x:ce.startXPos}),xe="animate")),pe&&xe==="animate"&&pe[Ke?"show":"hide"](Ke).animate(Ce),pe){let rt=this.pointAttribs(ce,Ue||!ce.selected?void 0:"select");Ue?Xe&&pe.css({fill:rt.fill}):pe[xe](rt)}pe&&pe.addClass(ce.getClassName(),!0)}else pe&&(ce.graphic=pe.destroy())}markerAttribs(J,re){let ce=this.options,pe=ce.marker,xe=J.marker||{},Me=xe.symbol||pe.symbol,_e={},Ce,Le,Ue=ge(xe.radius,pe&&pe.radius);re&&(Ce=pe.states[re],Ue=ge((Le=xe.states&&xe.states[re])&&Le.radius,Ce&&Ce.radius,Ue&&Ue+(Ce&&Ce.radiusPlus||0))),J.hasImage=Me&&Me.indexOf("url")===0,J.hasImage&&(Ue=0);let Xe=J.pos();return ue(Ue)&&Xe&&(ce.crisp&&(Xe[0]=X(Xe[0],J.hasImage?0:Me==="rect"?(pe==null?void 0:pe.lineWidth)||0:1)),_e.x=Xe[0]-Ue,_e.y=Xe[1]-Ue),Ue&&(_e.width=_e.height=2*Ue),_e}pointAttribs(J,re){let ce=this.options.marker,pe=J&&J.options,xe=pe&&pe.marker||{},Me=pe&&pe.color,_e=J&&J.color,Ce=J&&J.zone&&J.zone.color,Le,Ue,Xe=this.color,Pe,Ee,Ie=ge(xe.lineWidth,ce.lineWidth),Oe=1;return Xe=Me||Ce||_e||Xe,Pe=xe.fillColor||ce.fillColor||Xe,Ee=xe.lineColor||ce.lineColor||Xe,re=re||"normal",Le=ce.states[re]||{},Ie=ge((Ue=xe.states&&xe.states[re]||{}).lineWidth,Le.lineWidth,Ie+ge(Ue.lineWidthPlus,Le.lineWidthPlus,0)),Pe=Ue.fillColor||Le.fillColor||Pe,{stroke:Ee=Ue.lineColor||Le.lineColor||Ee,"stroke-width":Ie,fill:Pe,opacity:Oe=ge(Ue.opacity,Le.opacity,Oe)}}destroy(J){let re,ce,pe,xe=this,Me=xe.chart,_e=/AppleWebKit\/533/.test(I.navigator.userAgent),Ce=xe.data||[];for(U(xe,"destroy",{keepEventsForUpdate:J}),this.removeEvents(J),(xe.axisTypes||[]).forEach(function(Le){(pe=xe[Le])&&pe.series&&($(pe.series,xe),pe.isDirty=pe.forceRedraw=!0)}),xe.legendItem&&xe.chart.legend.destroyItem(xe),re=Ce.length;re--;)(ce=Ce[re])&&ce.destroy&&ce.destroy();for(let Le of xe.zones)j(Le,void 0,!0);P.clearTimeout(xe.animationTimeout),Te(xe,function(Le,Ue){Le instanceof g&&!Le.survive&&Le[_e&&Ue==="group"?"hide":"destroy"]()}),Me.hoverSeries===xe&&(Me.hoverSeries=void 0),$(Me.series,xe),Me.orderItems("series"),Te(xe,function(Le,Ue){J&&Ue==="hcEvents"||delete xe[Ue]})}applyZones(){let{area:J,chart:re,graph:ce,zones:pe,points:xe,xAxis:Me,yAxis:_e,zoneAxis:Ce}=this,{inverted:Le,renderer:Ue}=re,Xe=this[`${Ce}Axis`],{isXAxis:Pe,len:Ee=0}=Xe||{},Ie=((ce==null?void 0:ce.strokeWidth())||0)/2+1,Oe=(Re,Fe=0,Ke=0)=>{Le&&(Ke=Ee-Ke);let{translated:rt=0,lineClip:at}=Re,ut=Ke-rt;at==null||at.push(["L",Fe,Math.abs(ut)<Ie?Ke-Ie*(ut<=0?-1:1):rt])};if(pe.length&&(ce||J)&&Xe&&ue(Xe.min)){let Re=Xe.getExtremes().max,Fe=at=>{at.forEach((ut,mt)=>{(ut[0]==="M"||ut[0]==="L")&&(at[mt]=[ut[0],Pe?Ee-ut[1]:ut[1],Pe?ut[2]:Ee-ut[2]])})};if(pe.forEach(at=>{at.lineClip=[],at.translated=z(Xe.toPixels(ge(at.value,Re),!0)||0,0,Ee)}),ce&&!this.showLine&&ce.hide(),J&&J.hide(),Ce==="y"&&xe.length<Me.len)for(let at of xe){let{plotX:ut,plotY:mt,zone:Tt}=at,Rt=Tt&&pe[pe.indexOf(Tt)-1];Tt&&Oe(Tt,ut,mt),Rt&&Oe(Rt,ut,mt)}let Ke=[],rt=Xe.toPixels(Xe.getExtremes().min,!0);pe.forEach(at=>{var Ji,Vi;let ut=at.lineClip||[],mt=Math.round(at.translated||0);Me.reversed&&ut.reverse();let{clip:Tt,simpleClip:Rt}=at,pt=0,Ct=0,Et=Me.len,ri=_e.len;Pe?(pt=mt,Et=rt):(Ct=mt,ri=rt);let ci=[["M",pt,Ct],["L",Et,Ct],["L",Et,ri],["L",pt,ri],["Z"]],Vt=[ci[0],...ut,ci[1],ci[2],...Ke,ci[3],ci[4]];Ke=ut.reverse(),rt=mt,Le&&(Fe(Vt),J&&Fe(ci)),Tt?(Tt.animate({d:Vt}),Rt==null||Rt.animate({d:ci})):(Tt=at.clip=Ue.path(Vt),J&&(Rt=at.simpleClip=Ue.path(ci))),ce&&((Ji=at.graph)==null||Ji.clip(Tt)),J&&((Vi=at.area)==null||Vi.clip(Rt))})}else this.visible&&(ce&&ce.show(),J&&J.show())}plotGroup(J,re,ce,pe,xe){let Me=this[J],_e=!Me,Ce={visibility:ce,zIndex:pe||.1};return Z(this.opacity)&&!this.chart.styledMode&&this.state!=="inactive"&&(Ce.opacity=this.opacity),Me||(this[J]=Me=this.chart.renderer.g().add(xe)),Me.addClass("highcharts-"+re+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(Z(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(Me.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),Me.attr(Ce)[_e?"attr":"animate"](this.getPlotBox(re)),Me}getPlotBox(J){let re=this.xAxis,ce=this.yAxis,pe=this.chart,xe=pe.inverted&&!pe.polar&&re&&this.invertible&&J==="series";return pe.inverted&&(re=ce,ce=this.xAxis),{translateX:re?re.left:pe.plotLeft,translateY:ce?ce.top:pe.plotTop,rotation:xe?90:0,rotationOriginX:xe?(re.len-ce.len)/2:0,rotationOriginY:xe?(re.len+ce.len)/2:0,scaleX:xe?-1:1,scaleY:1}}removeEvents(J){let{eventsToUnbind:re}=this;J||we(this),re.length&&(re.forEach(ce=>{ce()}),re.length=0)}render(){var Ue,Xe,Pe,Ee,Ie;let J=this,{chart:re,options:ce,hasRendered:pe}=J,xe=_(ce.animation),Me=J.visible?"inherit":"hidden",_e=ce.zIndex,Ce=re.seriesGroup,Le=J.finishedAnimating?0:xe.duration;U(this,"render"),J.plotGroup("group","series",Me,_e,Ce),J.markerGroup=J.plotGroup("markerGroup","markers",Me,_e,Ce),ce.clip!==!1&&J.setClip(),Le&&((Ue=J.animate)==null||Ue.call(J,!0)),J.drawGraph&&(J.drawGraph(),J.applyZones()),J.visible&&J.drawPoints(),(Xe=J.drawDataLabels)==null||Xe.call(J),(Pe=J.redrawPoints)==null||Pe.call(J),ce.enableMouseTracking&&((Ee=J.drawTracker)==null||Ee.call(J)),Le&&((Ie=J.animate)==null||Ie.call(J)),pe||(Le&&xe.defer&&(Le+=xe.defer),J.animationTimeout=Q(()=>{J.afterAnimate()},Le||0)),J.isDirty=!1,J.hasRendered=!0,U(J,"afterRender")}redraw(){let J=this.isDirty||this.isDirtyData;this.translate(),this.render(),J&&delete this.kdTree}reserveSpace(){return this.visible||!this.chart.options.chart.ignoreHiddenSeries}searchPoint(J,re){let{xAxis:ce,yAxis:pe}=this,xe=this.chart.inverted;return this.searchKDTree({clientX:xe?ce.len-J.chartY+ce.pos:J.chartX-ce.pos,plotY:xe?pe.len-J.chartX+pe.pos:J.chartY-pe.pos},re,J)}buildKDTree(J){this.buildingKdTree=!0;let re=this,ce=re.options.findNearestPointBy.indexOf("y")>-1?2:1;delete re.kdTree,Q(function(){re.kdTree=function pe(xe,Me,_e){let Ce,Le,Ue=xe==null?void 0:xe.length;if(Ue)return Ce=re.kdAxisArray[Me%_e],xe.sort((Xe,Pe)=>(Xe[Ce]||0)-(Pe[Ce]||0)),{point:xe[Le=Math.floor(Ue/2)],left:pe(xe.slice(0,Le),Me+1,_e),right:pe(xe.slice(Le+1),Me+1,_e)}}(re.getValidPoints(void 0,!re.directTouch),ce,ce),re.buildingKdTree=!1},re.options.kdNow||(J==null?void 0:J.type)==="touchstart"?0:1)}searchKDTree(J,re,ce){let pe=this,[xe,Me]=this.kdAxisArray,_e=re?"distX":"dist",Ce=(pe.options.findNearestPointBy||"").indexOf("y")>-1?2:1,Le=!!pe.isBubble;if(this.kdTree||this.buildingKdTree||this.buildKDTree(ce),this.kdTree)return function Ue(Xe,Pe,Ee,Ie){var Tt;let Oe=Pe.point,Re=pe.kdAxisArray[Ee%Ie],Fe,Ke,rt=Oe;(function(Rt,pt){var ar;let Ct=Rt[xe],Et=pt[xe],ri=Z(Ct)&&Z(Et)?Ct-Et:null,ci=Rt[Me],Vt=pt[Me],Ji=Z(ci)&&Z(Vt)?ci-Vt:0,Vi=Le&&((ar=pt.marker)==null?void 0:ar.radius)||0;pt.dist=Math.sqrt((ri&&ri*ri||0)+Ji*Ji)-Vi,pt.distX=Z(ri)?Math.abs(ri)-Vi:Number.MAX_VALUE})(Xe,Oe);let at=(Xe[Re]||0)-(Oe[Re]||0)+(Le&&((Tt=Oe.marker)==null?void 0:Tt.radius)||0),ut=at<0?"left":"right",mt=at<0?"right":"left";return Pe[ut]&&(rt=(Fe=Ue(Xe,Pe[ut],Ee+1,Ie))[_e]<rt[_e]?Fe:Oe),Pe[mt]&&Math.sqrt(at*at)<rt[_e]&&(rt=(Ke=Ue(Xe,Pe[mt],Ee+1,Ie))[_e]<rt[_e]?Ke:rt),rt}(J,this.kdTree,Ce,Ce)}pointPlacementToXValue(){let{options:J,xAxis:re}=this,ce=J.pointPlacement;return ce==="between"&&(ce=re.reversed?-.5:.5),ue(ce)?ce*(J.pointRange||re.pointRange):0}isPointInside(J){let{chart:re,xAxis:ce,yAxis:pe}=this,{plotX:xe=-1,plotY:Me=-1}=J;return Me>=0&&Me<=(pe?pe.len:re.plotHeight)&&xe>=0&&xe<=(ce?ce.len:re.plotWidth)}drawTracker(){var Pe;let J=this,re=J.options,ce=re.trackByArea,pe=[].concat((ce?J.areaPath:J.graphPath)||[]),xe=J.chart,Me=xe.pointer,_e=xe.renderer,Ce=((Pe=xe.options.tooltip)==null?void 0:Pe.snap)||0,Le=()=>{re.enableMouseTracking&&xe.hoverSeries!==J&&J.onMouseOver()},Ue="rgba(192,192,192,"+(y?1e-4:.002)+")",Xe=J.tracker;Xe?Xe.attr({d:pe}):J.graph&&(J.tracker=Xe=_e.path(pe).attr({visibility:J.visible?"inherit":"hidden",zIndex:2}).addClass(ce?"highcharts-tracker-area":"highcharts-tracker-line").add(J.group),xe.styledMode||Xe.attr({"stroke-linecap":"round","stroke-linejoin":"round",stroke:Ue,fill:ce?Ue:"none","stroke-width":J.graph.strokeWidth()+(ce?0:2*Ce)}),[J.tracker,J.markerGroup,J.dataLabelsGroup].forEach(Ee=>{Ee&&(Ee.addClass("highcharts-tracker").on("mouseover",Le).on("mouseout",Ie=>{Me==null||Me.onTrackerMouseOut(Ie)}),re.cursor&&!xe.styledMode&&Ee.css({cursor:re.cursor}),Ee.on("touchstart",Le))})),U(this,"afterDrawTracker")}addPoint(J,re,ce,pe,xe){let Me,_e,Ce=this.options,Le=this.data,Ue=this.chart,Xe=this.xAxis,Pe=Xe&&Xe.hasNames&&Xe.names,Ee=Ce.data,Ie=this.xData;re=ge(re,!0);let Oe={series:this};this.pointClass.prototype.applyOptions.apply(Oe,[J]);let Re=Oe.x;if(_e=Ie.length,this.requireSorting&&Re<Ie[_e-1])for(Me=!0;_e&&Ie[_e-1]>Re;)_e--;this.updateParallelArrays(Oe,"splice",[_e,0,0]),this.updateParallelArrays(Oe,_e),Pe&&Oe.name&&(Pe[Re]=Oe.name),Ee.splice(_e,0,J),(Me||this.processedData)&&(this.data.splice(_e,0,null),this.processData()),Ce.legendType==="point"&&this.generatePoints(),ce&&(Le[0]&&Le[0].remove?Le[0].remove(!1):(Le.shift(),this.updateParallelArrays(Oe,"shift"),Ee.shift())),xe!==!1&&U(this,"addPoint",{point:Oe}),this.isDirty=!0,this.isDirtyData=!0,re&&Ue.redraw(pe)}removePoint(J,re,ce){let pe=this,xe=pe.data,Me=xe[J],_e=pe.points,Ce=pe.chart,Le=function(){_e&&_e.length===xe.length&&_e.splice(J,1),xe.splice(J,1),pe.options.data.splice(J,1),pe.updateParallelArrays(Me||{series:pe},"splice",[J,1]),Me&&Me.destroy(),pe.isDirty=!0,pe.isDirtyData=!0,re&&Ce.redraw()};S(ce,Ce),re=ge(re,!0),Me?Me.firePointEvent("remove",null,Le):Le()}remove(J,re,ce,pe){let xe=this,Me=xe.chart;function _e(){xe.destroy(pe),Me.isDirtyLegend=Me.isDirtyBox=!0,Me.linkSeries(pe),ge(J,!0)&&Me.redraw(re)}ce!==!1?U(xe,"remove",null,_e):_e()}update(J,re){var Fe,Ke,rt;U(this,"update",{options:J=V(J,this.userOptions)});let ce=this,pe=ce.chart,xe=ce.userOptions,Me=ce.initialType||ce.type,_e=pe.options.plotOptions,Ce=D[Me].prototype,Le=ce.finishedAnimating&&{animation:!1},Ue={},Xe,Pe,Ee=["colorIndex","eventOptions","navigatorSeries","symbolIndex","baseSeries"],Ie=J.type||xe.type||pe.options.chart.type,Oe=!(this.hasDerivedData||Ie&&Ie!==this.type||J.pointStart!==void 0||J.pointInterval!==void 0||J.relativeXValue!==void 0||J.joinBy||J.mapData||["dataGrouping","pointStart","pointInterval","pointIntervalUnit","keys"].some(at=>ce.hasOptionChanged(at)));Ie=Ie||Me,Oe&&(Ee.push("data","isDirtyData","isDirtyCanvas","points","processedData","processedXData","processedYData","xIncrement","cropped","_hasPointMarkers","hasDataLabels","nodes","layout","level","mapMap","mapData","minY","maxY","minX","maxX","transformGroups"),J.visible!==!1&&Ee.push("area","graph"),ce.parallelArrays.forEach(function(at){Ee.push(at+"Data")}),J.data&&(J.dataSorting&&L(ce.options.dataSorting,J.dataSorting),this.setData(J.data,!1))),J=oe(xe,{index:xe.index===void 0?ce.index:xe.index,pointStart:((Fe=_e==null?void 0:_e.series)==null?void 0:Fe.pointStart)??xe.pointStart??((Ke=ce.xData)==null?void 0:Ke[0])},!Oe&&{data:ce.options.data},J,Le),Oe&&J.data&&(J.data=ce.options.data),(Ee=["group","markerGroup","dataLabelsGroup","transformGroup"].concat(Ee)).forEach(function(at){Ee[at]=ce[at],delete ce[at]});let Re=!1;if(D[Ie]){if(Re=Ie!==ce.type,ce.remove(!1,!1,!1,!0),Re)if(pe.propFromSeries(),Object.setPrototypeOf)Object.setPrototypeOf(ce,D[Ie].prototype);else{let at=Object.hasOwnProperty.call(ce,"hcEvents")&&ce.hcEvents;for(Pe in Ce)ce[Pe]=void 0;L(ce,D[Ie].prototype),at?ce.hcEvents=at:delete ce.hcEvents}}else R(17,!0,pe,{missingModuleFor:Ie});if(Ee.forEach(function(at){ce[at]=Ee[at]}),ce.init(pe,J),Oe&&this.points)for(let at of((Xe=ce.options).visible===!1?(Ue.graphic=1,Ue.dataLabel=1):(this.hasMarkerChanged(Xe,xe)&&(Ue.graphic=1),(rt=ce.hasDataLabels)!=null&&rt.call(ce)||(Ue.dataLabel=1)),this.points))at&&at.series&&(at.resolveColor(),Object.keys(Ue).length&&at.destroyElements(Ue),Xe.showInLegend===!1&&at.legendItem&&pe.legend.destroyItem(at));ce.initialType=Me,pe.linkSeries(),pe.setSortedData(),Re&&ce.linkedSeries.length&&(ce.isDirtyData=!0),U(this,"afterUpdate"),ge(re,!0)&&pe.redraw(!!Oe&&void 0)}setName(J){this.name=this.options.name=this.userOptions.name=J,this.chart.isDirtyLegend=!0}hasOptionChanged(J){var _e,Ce;let re=this.chart,ce=this.options[J],pe=re.options.plotOptions,xe=this.userOptions[J],Me=ge((_e=pe==null?void 0:pe[this.type])==null?void 0:_e[J],(Ce=pe==null?void 0:pe.series)==null?void 0:Ce[J]);return xe&&!Z(Me)?ce!==xe:ce!==ge(Me,ce)}onMouseOver(){let J=this.chart,re=J.hoverSeries,ce=J.pointer;ce==null||ce.setHoverChartIndex(),re&&re!==this&&re.onMouseOut(),this.options.events.mouseOver&&U(this,"mouseOver"),this.setState("hover"),J.hoverSeries=this}onMouseOut(){let J=this.options,re=this.chart,ce=re.tooltip,pe=re.hoverPoint;re.hoverSeries=null,pe&&pe.onMouseOut(),this&&J.events.mouseOut&&U(this,"mouseOut"),ce&&!this.stickyTracking&&(!ce.shared||this.noSharedTooltip)&&ce.hide(),re.series.forEach(function(xe){xe.setState("",!0)})}setState(J,re){let ce=this,pe=ce.options,xe=ce.graph,Me=pe.inactiveOtherPoints,_e=pe.states,Ce=ge(_e[J||"normal"]&&_e[J||"normal"].animation,ce.chart.options.chart.animation),Le=pe.lineWidth,Ue=pe.opacity;if(J=J||"",ce.state!==J&&([ce.group,ce.markerGroup,ce.dataLabelsGroup].forEach(function(Xe){Xe&&(ce.state&&Xe.removeClass("highcharts-series-"+ce.state),J&&Xe.addClass("highcharts-series-"+J))}),ce.state=J,!ce.chart.styledMode)){if(_e[J]&&_e[J].enabled===!1)return;if(J&&(Le=_e[J].lineWidth||Le+(_e[J].lineWidthPlus||0),Ue=ge(_e[J].opacity,Ue)),xe&&!xe.dashstyle&&ue(Le))for(let Xe of[xe,...this.zones.map(Pe=>Pe.graph)])Xe==null||Xe.animate({"stroke-width":Le},Ce);Me||[ce.group,ce.markerGroup,ce.dataLabelsGroup,ce.labelBySeries].forEach(function(Xe){Xe&&Xe.animate({opacity:Ue},Ce)})}re&&Me&&ce.points&&ce.setAllPointsToState(J||void 0)}setAllPointsToState(J){this.points.forEach(function(re){re.setState&&re.setState(J)})}setVisible(J,re){var Ce;let ce=this,pe=ce.chart,xe=pe.options.chart.ignoreHiddenSeries,Me=ce.visible;ce.visible=J=ce.options.visible=ce.userOptions.visible=J===void 0?!Me:J;let _e=J?"show":"hide";["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach(Le=>{var Ue;(Ue=ce[Le])==null||Ue[_e]()}),(pe.hoverSeries===ce||((Ce=pe.hoverPoint)==null?void 0:Ce.series)===ce)&&ce.onMouseOut(),ce.legendItem&&pe.legend.colorizeItem(ce,J),ce.isDirty=!0,ce.options.stacking&&pe.series.forEach(Le=>{Le.options.stacking&&Le.visible&&(Le.isDirty=!0)}),ce.linkedSeries.forEach(Le=>{Le.setVisible(J,!1)}),xe&&(pe.isDirtyBox=!0),U(ce,_e),re!==!1&&pe.redraw()}show(){this.setVisible(!0)}hide(){this.setVisible(!1)}select(J){this.selected=J=this.options.selected=J===void 0?!this.selected:J,this.checkbox&&(this.checkbox.checked=J),U(this,J?"select":"unselect")}shouldShowTooltip(J,re,ce={}){return ce.series=this,ce.visiblePlotOnly=!0,this.chart.isInsidePlot(J,re,ce)}drawLegendSymbol(J,re){var ce;(ce=f[this.options.legendSymbol||"rectangle"])==null||ce.call(this,J,re)}}return ae.defaultOptions=x,ae.types=v.seriesTypes,ae.registerType=v.registerSeriesType,L(ae.prototype,{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,directTouch:!1,invertible:!0,isCartesian:!0,kdAxisArray:["clientX","plotY"],parallelArrays:["x","y"],pointClass:b,requireSorting:!0,sorted:!0}),v.series=ae,ae}),c(t,"Core/Legend/Legend.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Foundation.js"],t["Core/Globals.js"],t["Core/Series/Series.js"],t["Core/Series/Point.js"],t["Core/Renderer/RendererUtilities.js"],t["Core/Templating.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b,x,v){var g;let{animObject:P,setAnimation:_}=a,{registerEventOptions:S}=h,{composed:k,marginNames:A}=d,{distribute:y}=b,{format:I}=x,{addEvent:D,createElement:w,css:M,defined:z,discardElement:Y,find:X,fireEvent:Z,isNumber:j,merge:V,pick:$,pushUnique:R,relativeLength:L,stableSort:G,syncTimeout:U}=v;class F{constructor(W,ne){this.allItems=[],this.initialItemY=0,this.itemHeight=0,this.itemMarginBottom=0,this.itemMarginTop=0,this.itemX=0,this.itemY=0,this.lastItemY=0,this.lastLineHeight=0,this.legendHeight=0,this.legendWidth=0,this.maxItemWidth=0,this.maxLegendWidth=0,this.offsetWidth=0,this.padding=0,this.pages=[],this.symbolHeight=0,this.symbolWidth=0,this.titleHeight=0,this.totalItemWidth=0,this.widthOption=0,this.chart=W,this.setOptions(ne),ne.enabled&&(this.render(),S(this,ne),D(this.chart,"endResize",function(){this.legend.positionCheckboxes()})),D(this.chart,"render",()=>{this.options.enabled&&this.proximate&&(this.proximatePositions(),this.positionItems())})}setOptions(W){let ne=$(W.padding,8);this.options=W,this.chart.styledMode||(this.itemStyle=W.itemStyle,this.itemHiddenStyle=V(this.itemStyle,W.itemHiddenStyle)),this.itemMarginTop=W.itemMarginTop,this.itemMarginBottom=W.itemMarginBottom,this.padding=ne,this.initialItemY=ne-5,this.symbolWidth=$(W.symbolWidth,16),this.pages=[],this.proximate=W.layout==="proximate"&&!this.chart.inverted,this.baseline=void 0}update(W,ne){let ue=this.chart;this.setOptions(V(!0,this.options,W)),"events"in this.options&&S(this,this.options),this.destroy(),ue.isDirtyLegend=ue.isDirtyBox=!0,$(ne,!0)&&ue.redraw(),Z(this,"afterUpdate",{redraw:ne})}colorizeItem(W,ne){let{area:ue,group:ie,label:oe,line:Te,symbol:ge}=W.legendItem||{};if(ie==null||ie[ne?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){let{itemHiddenStyle:we={}}=this,K=we.color,{fillColor:Q,fillOpacity:ae,lineColor:ye,marker:J}=W.options,re=ce=>(!ne&&(ce.fill&&(ce.fill=K),ce.stroke&&(ce.stroke=K)),ce);oe==null||oe.css(V(ne?this.itemStyle:we)),Te==null||Te.attr(re({stroke:ye||W.color})),ge&&ge.attr(re(J&&ge.isMarker?W.pointAttribs():{fill:W.color})),ue==null||ue.attr(re({fill:Q||W.color,"fill-opacity":Q?1:ae??.75}))}Z(this,"afterColorizeItem",{item:W,visible:ne})}positionItems(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()}positionItem(W){let{group:ne,x:ue=0,y:ie=0}=W.legendItem||{},oe=this.options,Te=oe.symbolPadding,ge=!oe.rtl,we=W.checkbox;if(ne&&ne.element){let K={translateX:ge?ue:this.legendWidth-ue-2*Te-4,translateY:ie};ne[z(ne.translateY)?"animate":"attr"](K,void 0,()=>{Z(this,"afterPositionItem",{item:W})})}we&&(we.x=ue,we.y=ie)}destroyItem(W){let ne=W.checkbox,ue=W.legendItem||{};for(let ie of["group","label","line","symbol"])ue[ie]&&(ue[ie]=ue[ie].destroy());ne&&Y(ne),W.legendItem=void 0}destroy(){for(let W of this.getAllItems())this.destroyItem(W);for(let W of["clipRect","up","down","pager","nav","box","title","group"])this[W]&&(this[W]=this[W].destroy());this.display=null}positionCheckboxes(){let W,ne=this.group&&this.group.alignAttr,ue=this.clipHeight||this.legendHeight,ie=this.titleHeight;ne&&(W=ne.translateY,this.allItems.forEach(function(oe){let Te,ge=oe.checkbox;ge&&(Te=W+ie+ge.y+(this.scrollOffset||0)+3,M(ge,{left:ne.translateX+oe.checkboxOffset+ge.x-20+"px",top:Te+"px",display:this.proximate||Te>W-6&&Te<W+ue-6?"":"none"}))},this))}renderTitle(){let W=this.options,ne=this.padding,ue=W.title,ie,oe=0;ue.text&&(this.title||(this.title=this.chart.renderer.label(ue.text,ne-3,ne-4,void 0,void 0,void 0,W.useHTML,void 0,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(ue.style),this.title.add(this.group)),ue.width||this.title.css({width:this.maxLegendWidth+"px"}),oe=(ie=this.title.getBBox()).height,this.offsetWidth=ie.width,this.contentGroup.attr({translateY:oe})),this.titleHeight=oe}setText(W){let ne=this.options;W.legendItem.label.attr({text:ne.labelFormat?I(ne.labelFormat,W,this.chart):ne.labelFormatter.call(W)})}renderItem(W){let ne=W.legendItem=W.legendItem||{},ue=this.chart,ie=ue.renderer,oe=this.options,Te=oe.layout==="horizontal",ge=this.symbolWidth,we=oe.symbolPadding||0,K=this.itemStyle,Q=this.itemHiddenStyle,ae=Te?$(oe.itemDistance,20):0,ye=!oe.rtl,J=!W.series,re=!J&&W.series.drawLegendSymbol?W.series:W,ce=re.options,pe=!!this.createCheckboxForItem&&ce&&ce.showCheckbox,xe=oe.useHTML,Me=W.options.className,_e=ne.label,Ce=ge+we+ae+(pe?20:0);!_e&&(ne.group=ie.g("legend-item").addClass("highcharts-"+re.type+"-series highcharts-color-"+W.colorIndex+(Me?" "+Me:"")+(J?" highcharts-series-"+W.index:"")).attr({zIndex:1}).add(this.scrollGroup),ne.label=_e=ie.text("",ye?ge+we:-we,this.baseline||0,xe),ue.styledMode||_e.css(V(W.visible?K:Q)),_e.attr({align:ye?"left":"right",zIndex:2}).add(ne.group),!this.baseline&&(this.fontMetrics=ie.fontMetrics(_e),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,_e.attr("y",this.baseline),this.symbolHeight=$(oe.symbolHeight,this.fontMetrics.f),oe.squareSymbol&&(this.symbolWidth=$(oe.symbolWidth,Math.max(this.symbolHeight,16)),Ce=this.symbolWidth+we+ae+(pe?20:0),ye&&_e.attr("x",this.symbolWidth+we))),re.drawLegendSymbol(this,W),this.setItemEvents&&this.setItemEvents(W,_e,xe)),pe&&!W.checkbox&&this.createCheckboxForItem&&this.createCheckboxForItem(W),this.colorizeItem(W,W.visible),(ue.styledMode||!K.width)&&_e.css({width:(oe.itemWidth||this.widthOption||ue.spacingBox.width)-Ce+"px"}),this.setText(W);let Le=_e.getBBox(),Ue=this.fontMetrics&&this.fontMetrics.h||0;W.itemWidth=W.checkboxOffset=oe.itemWidth||ne.labelWidth||Le.width+Ce,this.maxItemWidth=Math.max(this.maxItemWidth,W.itemWidth),this.totalItemWidth+=W.itemWidth,this.itemHeight=W.itemHeight=Math.round(ne.labelHeight||(Le.height>1.5*Ue?Le.height:Ue))}layoutItem(W){let ne=this.options,ue=this.padding,ie=ne.layout==="horizontal",oe=W.itemHeight,Te=this.itemMarginBottom,ge=this.itemMarginTop,we=ie?$(ne.itemDistance,20):0,K=this.maxLegendWidth,Q=ne.alignColumns&&this.totalItemWidth>K?this.maxItemWidth:W.itemWidth,ae=W.legendItem||{};ie&&this.itemX-ue+Q>K&&(this.itemX=ue,this.lastLineHeight&&(this.itemY+=ge+this.lastLineHeight+Te),this.lastLineHeight=0),this.lastItemY=ge+this.itemY+Te,this.lastLineHeight=Math.max(oe,this.lastLineHeight),ae.x=this.itemX,ae.y=this.itemY,ie?this.itemX+=Q:(this.itemY+=ge+oe+Te,this.lastLineHeight=oe),this.offsetWidth=this.widthOption||Math.max((ie?this.itemX-ue-(W.checkbox?0:we):Q)+ue,this.offsetWidth)}getAllItems(){let W=[];return this.chart.series.forEach(function(ne){let ue=ne&&ne.options;ne&&$(ue.showInLegend,!z(ue.linkedTo)&&void 0,!0)&&(W=W.concat((ne.legendItem||{}).labels||(ue.legendType==="point"?ne.data:ne)))}),Z(this,"afterGetAllItems",{allItems:W}),W}getAlignment(){let W=this.options;return this.proximate?W.align.charAt(0)+"tv":W.floating?"":W.align.charAt(0)+W.verticalAlign.charAt(0)+W.layout.charAt(0)}adjustMargins(W,ne){let ue=this.chart,ie=this.options,oe=this.getAlignment();oe&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach(function(Te,ge){Te.test(oe)&&!z(W[ge])&&(ue[A[ge]]=Math.max(ue[A[ge]],ue.legend[(ge+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][ge]*ie[ge%2?"x":"y"]+$(ie.margin,12)+ne[ge]+(ue.titleOffset[ge]||0)))})}proximatePositions(){let W,ne=this.chart,ue=[],ie=this.options.align==="left";for(let oe of(this.allItems.forEach(function(Te){let ge,we,K=ie,Q,ae;Te.yAxis&&(Te.xAxis.options.reversed&&(K=!K),Te.points&&(ge=X(K?Te.points:Te.points.slice(0).reverse(),function(ye){return j(ye.plotY)})),we=this.itemMarginTop+Te.legendItem.label.getBBox().height+this.itemMarginBottom,ae=Te.yAxis.top-ne.plotTop,Q=Te.visible?(ge?ge.plotY:Te.yAxis.height)+(ae-.3*we):ae+Te.yAxis.height,ue.push({target:Q,size:we,item:Te}))},this),y(ue,ne.plotHeight)))W=oe.item.legendItem||{},j(oe.pos)&&(W.y=ne.plotTop-ne.spacing[0]+oe.pos)}render(){let W=this.chart,ne=W.renderer,ue=this.options,ie=this.padding,oe=this.getAllItems(),Te,ge,we,K=this.group,Q,ae=this.box;this.itemX=ie,this.itemY=this.initialItemY,this.offsetWidth=0,this.lastItemY=0,this.widthOption=L(ue.width,W.spacingBox.width-ie),Q=W.spacingBox.width-2*ie-ue.x,["rm","lm"].indexOf(this.getAlignment().substring(0,2))>-1&&(Q/=2),this.maxLegendWidth=this.widthOption||Q,K||(this.group=K=ne.g("legend").addClass(ue.className||"").attr({zIndex:7}).add(),this.contentGroup=ne.g().attr({zIndex:1}).add(K),this.scrollGroup=ne.g().add(this.contentGroup)),this.renderTitle(),G(oe,(ye,J)=>(ye.options&&ye.options.legendIndex||0)-(J.options&&J.options.legendIndex||0)),ue.reversed&&oe.reverse(),this.allItems=oe,this.display=Te=!!oe.length,this.lastLineHeight=0,this.maxItemWidth=0,this.totalItemWidth=0,this.itemHeight=0,oe.forEach(this.renderItem,this),oe.forEach(this.layoutItem,this),ge=(this.widthOption||this.offsetWidth)+ie,we=this.lastItemY+this.lastLineHeight+this.titleHeight,we=this.handleOverflow(we)+ie,ae||(this.box=ae=ne.rect().addClass("highcharts-legend-box").attr({r:ue.borderRadius}).add(K)),W.styledMode||ae.attr({stroke:ue.borderColor,"stroke-width":ue.borderWidth||0,fill:ue.backgroundColor||"none"}).shadow(ue.shadow),ge>0&&we>0&&ae[ae.placed?"animate":"attr"](ae.crisp.call({},{x:0,y:0,width:ge,height:we},ae.strokeWidth())),K[Te?"show":"hide"](),W.styledMode&&K.getStyle("display")==="none"&&(ge=we=0),this.legendWidth=ge,this.legendHeight=we,Te&&this.align(),this.proximate||this.positionItems(),Z(this,"afterRender")}align(W=this.chart.spacingBox){let ne=this.chart,ue=this.options,ie=W.y;/(lth|ct|rth)/.test(this.getAlignment())&&ne.titleOffset[0]>0?ie+=ne.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&ne.titleOffset[2]>0&&(ie-=ne.titleOffset[2]),ie!==W.y&&(W=V(W,{y:ie})),ne.hasRendered||(this.group.placed=!1),this.group.align(V(ue,{width:this.legendWidth,height:this.legendHeight,verticalAlign:this.proximate?"top":ue.verticalAlign}),!0,W)}handleOverflow(W){let ne=this,ue=this.chart,ie=ue.renderer,oe=this.options,Te=oe.y,ge=oe.verticalAlign==="top",we=this.padding,K=oe.maxHeight,Q=oe.navigation,ae=$(Q.animation,!0),ye=Q.arrowSize||12,J=this.pages,re=this.allItems,ce=function(Xe){typeof Xe=="number"?Ue.attr({height:Xe}):Ue&&(ne.clipRect=Ue.destroy(),ne.contentGroup.clip()),ne.contentGroup.div&&(ne.contentGroup.div.style.clip=Xe?"rect("+we+"px,9999px,"+(we+Xe)+"px,0)":"auto")},pe=function(Xe){return ne[Xe]=ie.circle(0,0,1.3*ye).translate(ye/2,ye/2).add(Le),ue.styledMode||ne[Xe].attr("fill","rgba(0,0,0,0.0001)"),ne[Xe]},xe,Me,_e,Ce=ue.spacingBox.height+(ge?-Te:Te)-we,Le=this.nav,Ue=this.clipRect;return oe.layout!=="horizontal"||oe.verticalAlign==="middle"||oe.floating||(Ce/=2),K&&(Ce=Math.min(Ce,K)),J.length=0,W&&Ce>0&&W>Ce&&Q.enabled!==!1?(this.clipHeight=xe=Math.max(Ce-20-this.titleHeight-we,0),this.currentPage=$(this.currentPage,1),this.fullHeight=W,re.forEach((Xe,Pe)=>{let Ee=(_e=Xe.legendItem||{}).y||0,Ie=Math.round(_e.label.getBBox().height),Oe=J.length;(!Oe||Ee-J[Oe-1]>xe&&(Me||Ee)!==J[Oe-1])&&(J.push(Me||Ee),Oe++),_e.pageIx=Oe-1,Me&&((re[Pe-1].legendItem||{}).pageIx=Oe-1),Pe===re.length-1&&Ee+Ie-J[Oe-1]>xe&&Ee>J[Oe-1]&&(J.push(Ee),_e.pageIx=Oe),Ee!==Me&&(Me=Ee)}),Ue||(Ue=ne.clipRect=ie.clipRect(0,we-2,9999,0),ne.contentGroup.clip(Ue)),ce(xe),Le||(this.nav=Le=ie.g().attr({zIndex:1}).add(this.group),this.up=ie.symbol("triangle",0,0,ye,ye).add(Le),pe("upTracker").on("click",function(){ne.scroll(-1,ae)}),this.pager=ie.text("",15,10).addClass("highcharts-legend-navigation"),!ue.styledMode&&Q.style&&this.pager.css(Q.style),this.pager.add(Le),this.down=ie.symbol("triangle-down",0,0,ye,ye).add(Le),pe("downTracker").on("click",function(){ne.scroll(1,ae)})),ne.scroll(0),W=Ce):Le&&(ce(),this.nav=Le.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),W}scroll(W,ne){let ue=this.chart,ie=this.pages,oe=ie.length,Te=this.clipHeight,ge=this.options.navigation,we=this.pager,K=this.padding,Q=this.currentPage+W;Q>oe&&(Q=oe),Q>0&&(ne!==void 0&&_(ne,ue),this.nav.attr({translateX:K,translateY:Te+this.padding+7+this.titleHeight,visibility:"inherit"}),[this.up,this.upTracker].forEach(function(ae){ae.attr({class:Q===1?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),we.attr({text:Q+"/"+oe}),[this.down,this.downTracker].forEach(function(ae){ae.attr({x:18+this.pager.getBBox().width,class:Q===oe?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})},this),ue.styledMode||(this.up.attr({fill:Q===1?ge.inactiveColor:ge.activeColor}),this.upTracker.css({cursor:Q===1?"default":"pointer"}),this.down.attr({fill:Q===oe?ge.inactiveColor:ge.activeColor}),this.downTracker.css({cursor:Q===oe?"default":"pointer"})),this.scrollOffset=-ie[Q-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=Q,this.positionCheckboxes(),U(()=>{Z(this,"afterScroll",{currentPage:Q})},P($(ne,ue.renderer.globalAnimation,!0)).duration))}setItemEvents(W,ne,ue){let ie=this,oe=W.legendItem||{},Te=ie.chart.renderer.boxWrapper,ge=W instanceof f,we=W instanceof s,K="highcharts-legend-"+(ge?"point":"series")+"-active",Q=ie.chart.styledMode,ae=ue?[ne,oe.symbol]:[oe.group],ye=J=>{ie.allItems.forEach(re=>{W!==re&&[re].concat(re.linkedSeries||[]).forEach(ce=>{ce.setState(J,!ge)})})};for(let J of ae)J&&J.on("mouseover",function(){W.visible&&ye("inactive"),W.setState("hover"),W.visible&&Te.addClass(K),Q||ne.css(ie.options.itemHoverStyle)}).on("mouseout",function(){ie.chart.styledMode||ne.css(V(W.visible?ie.itemStyle:ie.itemHiddenStyle)),ye(""),Te.removeClass(K),W.setState()}).on("click",function(re){let ce=function(){W.setVisible&&W.setVisible(),ye(W.visible?"inactive":"")};Te.removeClass(K),Z(ie,"itemClick",{browserEvent:re,legendItem:W},ce),ge?W.firePointEvent("legendItemClick",{browserEvent:re}):we&&Z(W,"legendItemClick",{browserEvent:re})})}createCheckboxForItem(W){W.checkbox=w("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:W.selected,defaultChecked:W.selected},this.options.itemCheckboxStyle,this.chart.container),D(W.checkbox,"click",function(ne){let ue=ne.target;Z(W.series||W,"checkboxClick",{checked:ue.checked,item:W},function(){W.select()})})}}return(g=F).compose=function(H){R(k,"Core.Legend")&&D(H,"beforeMargins",function(){this.legend=new g(this,this.options.legend)})},F}),c(t,"Core/Chart/Chart.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Axis/Axis.js"],t["Core/Defaults.js"],t["Core/Templating.js"],t["Core/Foundation.js"],t["Core/Globals.js"],t["Core/Renderer/RendererRegistry.js"],t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Renderer/SVG/SVGRenderer.js"],t["Core/Time.js"],t["Core/Utilities.js"],t["Core/Renderer/HTML/AST.js"],t["Core/Axis/Tick.js"]],function(a,h,d,s,f,b,x,v,g,P,_,S,k,A){let{animate:y,animObject:I,setAnimation:D}=a,{defaultOptions:w,defaultTime:M}=d,{numberFormat:z}=s,{registerEventOptions:Y}=f,{charts:X,doc:Z,marginNames:j,svg:V,win:$}=b,{seriesTypes:R}=g,{addEvent:L,attr:G,createElement:U,css:F,defined:H,diffObjects:W,discardElement:ne,erase:ue,error:ie,extend:oe,find:Te,fireEvent:ge,getStyle:we,isArray:K,isNumber:Q,isObject:ae,isString:ye,merge:J,objectEach:re,pick:ce,pInt:pe,relativeLength:xe,removeEvent:Me,splat:_e,syncTimeout:Ce,uniqueKey:Le}=S;class Ue{static chart(Pe,Ee,Ie){return new Ue(Pe,Ee,Ie)}constructor(Pe,Ee,Ie){this.sharedClips={};let Oe=[...arguments];(ye(Pe)||Pe.nodeName)&&(this.renderTo=Oe.shift()),this.init(Oe[0],Oe[1])}setZoomOptions(){let Pe=this.options.chart,Ee=Pe.zooming;this.zooming={...Ee,type:ce(Pe.zoomType,Ee.type),key:ce(Pe.zoomKey,Ee.key),pinchType:ce(Pe.pinchType,Ee.pinchType),singleTouch:ce(Pe.zoomBySingleTouch,Ee.singleTouch,!1),resetButton:J(Ee.resetButton,Pe.resetZoomButton)}}init(Pe,Ee){ge(this,"init",{args:arguments},function(){let Ie=J(w,Pe),Oe=Ie.chart;this.userOptions=oe({},Pe),this.margin=[],this.spacing=[],this.labelCollectors=[],this.callback=Ee,this.isResizing=0,this.options=Ie,this.axes=[],this.series=[],this.time=Pe.time&&Object.keys(Pe.time).length?new _(Pe.time):b.time,this.numberFormatter=Oe.numberFormatter||z,this.styledMode=Oe.styledMode,this.hasCartesianSeries=Oe.showAxes,this.index=X.length,X.push(this),b.chartCount++,Y(this,Oe),this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,this.setZoomOptions(),ge(this,"afterInit"),this.firstRender()})}initSeries(Pe){let Ee=this.options.chart,Ie=Pe.type||Ee.type,Oe=R[Ie];Oe||ie(17,!0,this,{missingModuleFor:Ie});let Re=new Oe;return typeof Re.init=="function"&&Re.init(this,Pe),Re}setSortedData(){this.getSeriesOrderByLinks().forEach(function(Pe){Pe.points||Pe.data||!Pe.enabledDataSorting||Pe.setData(Pe.options.data,!1)})}getSeriesOrderByLinks(){return this.series.concat().sort(function(Pe,Ee){return Pe.linkedSeries.length||Ee.linkedSeries.length?Ee.linkedSeries.length-Pe.linkedSeries.length:0})}orderItems(Pe,Ee=0){let Ie=this[Pe],Oe=this.options[Pe]=_e(this.options[Pe]).slice(),Re=this.userOptions[Pe]=this.userOptions[Pe]?_e(this.userOptions[Pe]).slice():[];if(this.hasRendered&&(Oe.splice(Ee),Re.splice(Ee)),Ie)for(let Fe=Ee,Ke=Ie.length;Fe<Ke;++Fe){let rt=Ie[Fe];rt&&(rt.index=Fe,rt instanceof v&&(rt.name=rt.getName()),rt.options.isInternal||(Oe[Fe]=rt.options,Re[Fe]=rt.userOptions))}}isInsidePlot(Pe,Ee,Ie={}){var Et;let{inverted:Oe,plotBox:Re,plotLeft:Fe,plotTop:Ke,scrollablePlotBox:rt}=this,{scrollLeft:at=0,scrollTop:ut=0}=Ie.visiblePlotOnly&&((Et=this.scrollablePlotArea)==null?void 0:Et.scrollingContainer)||{},mt=Ie.series,Tt=Ie.visiblePlotOnly&&rt||Re,Rt=Ie.inverted?Ee:Pe,pt=Ie.inverted?Pe:Ee,Ct={x:Rt,y:pt,isInsidePlot:!0,options:Ie};if(!Ie.ignoreX){let ri=mt&&(Oe&&!this.polar?mt.yAxis:mt.xAxis)||{pos:Fe,len:1/0},ci=Ie.paneCoordinates?ri.pos+Rt:Fe+Rt;ci>=Math.max(at+Fe,ri.pos)&&ci<=Math.min(at+Fe+Tt.width,ri.pos+ri.len)||(Ct.isInsidePlot=!1)}if(!Ie.ignoreY&&Ct.isInsidePlot){let ri=!Oe&&Ie.axis&&!Ie.axis.isXAxis&&Ie.axis||mt&&(Oe?mt.xAxis:mt.yAxis)||{pos:Ke,len:1/0},ci=Ie.paneCoordinates?ri.pos+pt:Ke+pt;ci>=Math.max(ut+Ke,ri.pos)&&ci<=Math.min(ut+Ke+Tt.height,ri.pos+ri.len)||(Ct.isInsidePlot=!1)}return ge(this,"afterIsInsidePlot",Ct),Ct.isInsidePlot}redraw(Pe){ge(this,"beforeRedraw");let Ee=this.hasCartesianSeries?this.axes:this.colorAxis||[],Ie=this.series,Oe=this.pointer,Re=this.legend,Fe=this.userOptions.legend,Ke=this.renderer,rt=Ke.isHidden(),at=[],ut,mt,Tt,Rt=this.isDirtyBox,pt=this.isDirtyLegend,Ct;for(Ke.rootFontSize=Ke.boxWrapper.getStyle("font-size"),this.setResponsive&&this.setResponsive(!1),D(!!this.hasRendered&&Pe,this),rt&&this.temporaryDisplay(),this.layOutTitles(!1),Tt=Ie.length;Tt--;)if(((Ct=Ie[Tt]).options.stacking||Ct.options.centerInCategory)&&(mt=!0,Ct.isDirty)){ut=!0;break}if(ut)for(Tt=Ie.length;Tt--;)(Ct=Ie[Tt]).options.stacking&&(Ct.isDirty=!0);Ie.forEach(function(Et){Et.isDirty&&(Et.options.legendType==="point"?(typeof Et.updateTotals=="function"&&Et.updateTotals(),pt=!0):Fe&&(Fe.labelFormatter||Fe.labelFormat)&&(pt=!0)),Et.isDirtyData&&ge(Et,"updatedData")}),pt&&Re&&Re.options.enabled&&(Re.render(),this.isDirtyLegend=!1),mt&&this.getStacks(),Ee.forEach(function(Et){Et.updateNames(),Et.setScale()}),this.getMargins(),Ee.forEach(function(Et){Et.isDirty&&(Rt=!0)}),Ee.forEach(function(Et){let ri=Et.min+","+Et.max;Et.extKey!==ri&&(Et.extKey=ri,at.push(function(){ge(Et,"afterSetExtremes",oe(Et.eventArgs,Et.getExtremes())),delete Et.eventArgs})),(Rt||mt)&&Et.redraw()}),Rt&&this.drawChartBox(),ge(this,"predraw"),Ie.forEach(function(Et){(Rt||Et.isDirty)&&Et.visible&&Et.redraw(),Et.isDirtyData=!1}),Oe&&Oe.reset(!0),Ke.draw(),ge(this,"redraw"),ge(this,"render"),rt&&this.temporaryDisplay(!0),at.forEach(function(Et){Et.call()})}get(Pe){let Ee=this.series;function Ie(Re){return Re.id===Pe||Re.options&&Re.options.id===Pe}let Oe=Te(this.axes,Ie)||Te(this.series,Ie);for(let Re=0;!Oe&&Re<Ee.length;Re++)Oe=Te(Ee[Re].points||[],Ie);return Oe}getAxes(){let Pe=this.userOptions;for(let Ee of(ge(this,"getAxes"),["xAxis","yAxis"]))for(let Ie of Pe[Ee]=_e(Pe[Ee]||{}))new h(this,Ie,Ee);ge(this,"afterGetAxes")}getSelectedPoints(){return this.series.reduce((Pe,Ee)=>(Ee.getPointsCollection().forEach(Ie=>{ce(Ie.selectedStaging,Ie.selected)&&Pe.push(Ie)}),Pe),[])}getSelectedSeries(){return this.series.filter(function(Pe){return Pe.selected})}setTitle(Pe,Ee,Ie){this.applyDescription("title",Pe),this.applyDescription("subtitle",Ee),this.applyDescription("caption",void 0),this.layOutTitles(Ie)}applyDescription(Pe,Ee){let Ie=this,Oe=this.options[Pe]=J(this.options[Pe],Ee),Re=this[Pe];Re&&Ee&&(this[Pe]=Re=Re.destroy()),Oe&&!Re&&((Re=this.renderer.text(Oe.text,0,0,Oe.useHTML).attr({align:Oe.align,class:"highcharts-"+Pe,zIndex:Oe.zIndex||4}).add()).update=function(Fe,Ke){Ie.applyDescription(Pe,Fe),Ie.layOutTitles(Ke)},this.styledMode||Re.css(oe(Pe==="title"?{fontSize:this.options.isStock?"1em":"1.2em"}:{},Oe.style)),this[Pe]=Re)}layOutTitles(Pe=!0){let Ee=[0,0,0],Ie=this.renderer,Oe=this.spacingBox;["title","subtitle","caption"].forEach(function(Fe){let Ke=this[Fe],rt=this.options[Fe],at=rt.verticalAlign||"top",ut=Fe==="title"?at==="top"?-3:0:at==="top"?Ee[0]+2:0;if(Ke){Ke.css({width:(rt.width||Oe.width+(rt.widthAdjust||0))+"px"});let mt=Ie.fontMetrics(Ke).b,Tt=Math.round(Ke.getBBox(rt.useHTML).height);Ke.align(oe({y:at==="bottom"?mt:ut+mt,height:Tt},rt),!1,"spacingBox"),rt.floating||(at==="top"?Ee[0]=Math.ceil(Ee[0]+Tt):at==="bottom"&&(Ee[2]=Math.ceil(Ee[2]+Tt)))}},this),Ee[0]&&(this.options.title.verticalAlign||"top")==="top"&&(Ee[0]+=this.options.title.margin),Ee[2]&&this.options.caption.verticalAlign==="bottom"&&(Ee[2]+=this.options.caption.margin);let Re=!this.titleOffset||this.titleOffset.join(",")!==Ee.join(",");this.titleOffset=Ee,ge(this,"afterLayOutTitles"),!this.isDirtyBox&&Re&&(this.isDirtyBox=this.isDirtyLegend=Re,this.hasRendered&&Pe&&this.isDirtyBox&&this.redraw())}getContainerBox(){let Pe=[].map.call(this.renderTo.children,Ie=>{if(Ie!==this.container){let Oe=Ie.style.display;return Ie.style.display="none",[Ie,Oe]}}),Ee={width:we(this.renderTo,"width",!0)||0,height:we(this.renderTo,"height",!0)||0};return Pe.filter(Boolean).forEach(([Ie,Oe])=>{Ie.style.display=Oe}),Ee}getChartSize(){var Fe;let Pe=this.options.chart,Ee=Pe.width,Ie=Pe.height,Oe=this.getContainerBox(),Re=Oe.height>1&&!(!((Fe=this.renderTo.parentElement)!=null&&Fe.style.height)&&this.renderTo.style.height==="100%");this.chartWidth=Math.max(0,Ee||Oe.width||600),this.chartHeight=Math.max(0,xe(Ie,this.chartWidth)||(Re?Oe.height:400)),this.containerBox=Oe}temporaryDisplay(Pe){let Ee=this.renderTo,Ie;if(Pe)for(;Ee&&Ee.style;)Ee.hcOrigStyle&&(F(Ee,Ee.hcOrigStyle),delete Ee.hcOrigStyle),Ee.hcOrigDetached&&(Z.body.removeChild(Ee),Ee.hcOrigDetached=!1),Ee=Ee.parentNode;else for(;Ee&&Ee.style&&(Z.body.contains(Ee)||Ee.parentNode||(Ee.hcOrigDetached=!0,Z.body.appendChild(Ee)),(we(Ee,"display",!1)==="none"||Ee.hcOricDetached)&&(Ee.hcOrigStyle={display:Ee.style.display,height:Ee.style.height,overflow:Ee.style.overflow},Ie={display:"block",overflow:"hidden"},Ee!==this.renderTo&&(Ie.height=0),F(Ee,Ie),Ee.offsetWidth||Ee.style.setProperty("display","block","important")),(Ee=Ee.parentNode)!==Z.body););}setClassName(Pe){this.container.className="highcharts-container "+(Pe||"")}getContainer(){var Tt;let Pe=this.options,Ee=Pe.chart,Ie="data-highcharts-chart",Oe=Le(),Re,Fe=this.renderTo;Fe||(this.renderTo=Fe=Ee.renderTo),ye(Fe)&&(this.renderTo=Fe=Z.getElementById(Fe)),Fe||ie(13,!0,this);let Ke=pe(G(Fe,Ie));Q(Ke)&&X[Ke]&&X[Ke].hasRendered&&X[Ke].destroy(),G(Fe,Ie,this.index),Fe.innerHTML=k.emptyHTML,Ee.skipClone||Fe.offsetWidth||this.temporaryDisplay(),this.getChartSize();let rt=this.chartHeight,at=this.chartWidth;F(Fe,{overflow:"hidden"}),this.styledMode||(Re=oe({position:"relative",overflow:"hidden",width:at+"px",height:rt+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none",padding:"0px"},Ee.style||{}));let ut=U("div",{id:Oe},Re,Fe);this.container=ut,this.getChartSize(),at===this.chartWidth||(at=this.chartWidth,this.styledMode||F(ut,{width:ce((Tt=Ee.style)==null?void 0:Tt.width,at+"px")})),this.containerBox=this.getContainerBox(),this._cursor=ut.style.cursor;let mt=Ee.renderer||!V?x.getRendererType(Ee.renderer):P;if(this.renderer=new mt(ut,at,rt,void 0,Ee.forExport,Pe.exporting&&Pe.exporting.allowHTML,this.styledMode),D(void 0,this),this.setClassName(Ee.className),this.styledMode)for(let Rt in Pe.defs)this.renderer.definition(Pe.defs[Rt]);else this.renderer.setStyle(Ee.style);this.renderer.chartIndex=this.index,ge(this,"afterGetContainer")}getMargins(Pe){let{spacing:Ee,margin:Ie,titleOffset:Oe}=this;this.resetMargins(),Oe[0]&&!H(Ie[0])&&(this.plotTop=Math.max(this.plotTop,Oe[0]+Ee[0])),Oe[2]&&!H(Ie[2])&&(this.marginBottom=Math.max(this.marginBottom,Oe[2]+Ee[2])),this.legend&&this.legend.display&&this.legend.adjustMargins(Ie,Ee),ge(this,"getMargins"),Pe||this.getAxisMargins()}getAxisMargins(){let Pe=this,Ee=Pe.axisOffset=[0,0,0,0],Ie=Pe.colorAxis,Oe=Pe.margin,Re=function(Fe){Fe.forEach(function(Ke){Ke.visible&&Ke.getOffset()})};Pe.hasCartesianSeries?Re(Pe.axes):Ie&&Ie.length&&Re(Ie),j.forEach(function(Fe,Ke){H(Oe[Ke])||(Pe[Fe]+=Ee[Ke])}),Pe.setChartSize()}getOptions(){return W(this.userOptions,w)}reflow(Pe){var Re;let Ee=this,Ie=Ee.containerBox,Oe=Ee.getContainerBox();(Re=Ee.pointer)==null||delete Re.chartPosition,!Ee.isPrinting&&!Ee.isResizing&&Ie&&Oe.width&&((Oe.width!==Ie.width||Oe.height!==Ie.height)&&(S.clearTimeout(Ee.reflowTimeout),Ee.reflowTimeout=Ce(function(){Ee.container&&Ee.setSize(void 0,void 0,!1)},Pe?100:0)),Ee.containerBox=Oe)}setReflow(){let Pe=this,Ee=Ie=>{var Oe;(Oe=Pe.options)!=null&&Oe.chart.reflow&&Pe.hasLoaded&&Pe.reflow(Ie)};if(typeof ResizeObserver=="function")new ResizeObserver(Ee).observe(Pe.renderTo);else{let Ie=L($,"resize",Ee);L(this,"destroy",Ie)}}setSize(Pe,Ee,Ie){let Oe=this,Re=Oe.renderer;Oe.isResizing+=1,D(Ie,Oe);let Fe=Re.globalAnimation;Oe.oldChartHeight=Oe.chartHeight,Oe.oldChartWidth=Oe.chartWidth,Pe!==void 0&&(Oe.options.chart.width=Pe),Ee!==void 0&&(Oe.options.chart.height=Ee),Oe.getChartSize();let{chartWidth:Ke,chartHeight:rt,scrollablePixelsX:at=0,scrollablePixelsY:ut=0}=Oe;(Oe.isDirtyBox||Ke!==Oe.oldChartWidth||rt!==Oe.oldChartHeight)&&(Oe.styledMode||(Fe?y:F)(Oe.container,{width:`${Ke+at}px`,height:`${rt+ut}px`},Fe),Oe.setChartSize(!0),Re.setSize(Ke,rt,Fe),Oe.axes.forEach(function(mt){mt.isDirty=!0,mt.setScale()}),Oe.isDirtyLegend=!0,Oe.isDirtyBox=!0,Oe.layOutTitles(),Oe.getMargins(),Oe.redraw(Fe),Oe.oldChartHeight=void 0,ge(Oe,"resize"),setTimeout(()=>{Oe&&ge(Oe,"endResize")},I(Fe).duration)),Oe.isResizing-=1}setChartSize(Pe){let Ee,Ie,Oe,Re,{chartHeight:Fe,chartWidth:Ke,inverted:rt,spacing:at,renderer:ut}=this,mt=this.clipOffset,Tt=Math[rt?"floor":"round"];this.plotLeft=Ee=Math.round(this.plotLeft),this.plotTop=Ie=Math.round(this.plotTop),this.plotWidth=Oe=Math.max(0,Math.round(Ke-Ee-this.marginRight)),this.plotHeight=Re=Math.max(0,Math.round(Fe-Ie-this.marginBottom)),this.plotSizeX=rt?Re:Oe,this.plotSizeY=rt?Oe:Re,this.spacingBox=ut.spacingBox={x:at[3],y:at[0],width:Ke-at[3]-at[1],height:Fe-at[0]-at[2]},this.plotBox=ut.plotBox={x:Ee,y:Ie,width:Oe,height:Re},mt&&(this.clipBox={x:Tt(mt[3]),y:Tt(mt[0]),width:Tt(this.plotSizeX-mt[1]-mt[3]),height:Tt(this.plotSizeY-mt[0]-mt[2])}),Pe||(this.axes.forEach(function(Rt){Rt.setAxisSize(),Rt.setAxisTranslation()}),ut.alignElements()),ge(this,"afterSetChartSize",{skipAxes:Pe})}resetMargins(){ge(this,"resetMargins");let Pe=this,Ee=Pe.options.chart,Ie=Ee.plotBorderWidth||0,Oe=Ie/2;["margin","spacing"].forEach(function(Re){let Fe=Ee[Re],Ke=ae(Fe)?Fe:[Fe,Fe,Fe,Fe];["Top","Right","Bottom","Left"].forEach(function(rt,at){Pe[Re][at]=ce(Ee[Re+rt],Ke[at])})}),j.forEach(function(Re,Fe){Pe[Re]=ce(Pe.margin[Fe],Pe.spacing[Fe])}),Pe.axisOffset=[0,0,0,0],Pe.clipOffset=[Oe,Oe,Oe,Oe],Pe.plotBorderWidth=Ie}drawChartBox(){let Pe=this.options.chart,Ee=this.renderer,Ie=this.chartWidth,Oe=this.chartHeight,Re=this.styledMode,Fe=this.plotBGImage,Ke=Pe.backgroundColor,rt=Pe.plotBackgroundColor,at=Pe.plotBackgroundImage,ut=this.plotLeft,mt=this.plotTop,Tt=this.plotWidth,Rt=this.plotHeight,pt=this.plotBox,Ct=this.clipRect,Et=this.clipBox,ri=this.chartBackground,ci=this.plotBackground,Vt=this.plotBorder,Ji,Vi,ar,Tr="animate";ri||(this.chartBackground=ri=Ee.rect().addClass("highcharts-background").add(),Tr="attr"),Re?Ji=Vi=ri.strokeWidth():(Vi=(Ji=Pe.borderWidth||0)+(Pe.shadow?8:0),ar={fill:Ke||"none"},(Ji||ri["stroke-width"])&&(ar.stroke=Pe.borderColor,ar["stroke-width"]=Ji),ri.attr(ar).shadow(Pe.shadow)),ri[Tr]({x:Vi/2,y:Vi/2,width:Ie-Vi-Ji%2,height:Oe-Vi-Ji%2,r:Pe.borderRadius}),Tr="animate",ci||(Tr="attr",this.plotBackground=ci=Ee.rect().addClass("highcharts-plot-background").add()),ci[Tr](pt),!Re&&(ci.attr({fill:rt||"none"}).shadow(Pe.plotShadow),at&&(Fe?(at!==Fe.attr("href")&&Fe.attr("href",at),Fe.animate(pt)):this.plotBGImage=Ee.image(at,ut,mt,Tt,Rt).add())),Ct?Ct.animate({width:Et.width,height:Et.height}):this.clipRect=Ee.clipRect(Et),Tr="animate",Vt||(Tr="attr",this.plotBorder=Vt=Ee.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),Re||Vt.attr({stroke:Pe.plotBorderColor,"stroke-width":Pe.plotBorderWidth||0,fill:"none"}),Vt[Tr](Vt.crisp({x:ut,y:mt,width:Tt,height:Rt},-Vt.strokeWidth())),this.isDirtyBox=!1,ge(this,"afterDrawChartBox")}propFromSeries(){let Pe,Ee,Ie,Oe=this,Re=Oe.options.chart,Fe=Oe.options.series;["inverted","angular","polar"].forEach(function(Ke){for(Ee=R[Re.type],Ie=Re[Ke]||Ee&&Ee.prototype[Ke],Pe=Fe&&Fe.length;!Ie&&Pe--;)(Ee=R[Fe[Pe].type])&&Ee.prototype[Ke]&&(Ie=!0);Oe[Ke]=Ie})}linkSeries(Pe){let Ee=this,Ie=Ee.series;Ie.forEach(function(Oe){Oe.linkedSeries.length=0}),Ie.forEach(function(Oe){let{linkedTo:Re}=Oe.options;if(ye(Re)){let Fe;(Fe=Re===":previous"?Ee.series[Oe.index-1]:Ee.get(Re))&&Fe.linkedParent!==Oe&&(Fe.linkedSeries.push(Oe),Oe.linkedParent=Fe,Fe.enabledDataSorting&&Oe.setDataSortingOptions(),Oe.visible=ce(Oe.options.visible,Fe.options.visible,Oe.visible))}}),ge(this,"afterLinkSeries",{isUpdating:Pe})}renderSeries(){this.series.forEach(function(Pe){Pe.translate(),Pe.render()})}render(){var ut;let Pe=this.axes,Ee=this.colorAxis,Ie=this.renderer,Oe=this.options.chart.axisLayoutRuns||2,Re=mt=>{mt.forEach(Tt=>{Tt.visible&&Tt.render()})},Fe=0,Ke=!0,rt,at=0;for(let mt of(this.setTitle(),ge(this,"beforeMargins"),(ut=this.getStacks)==null||ut.call(this),this.getMargins(!0),this.setChartSize(),Pe)){let{options:Tt}=mt,{labels:Rt}=Tt;if(this.hasCartesianSeries&&mt.horiz&&mt.visible&&Rt.enabled&&mt.series.length&&mt.coll!=="colorAxis"&&!this.polar){Fe=Tt.tickLength,mt.createGroups();let pt=new A(mt,0,"",!0),Ct=pt.createLabel("x",Rt);if(pt.destroy(),Ct&&ce(Rt.reserveSpace,!Q(Tt.crossing))&&(Fe=Ct.getBBox().height+Rt.distance+Math.max(Tt.offset||0,0)),Fe){Ct==null||Ct.destroy();break}}}for(this.plotHeight=Math.max(this.plotHeight-Fe,0);(Ke||rt||Oe>1)&&at<Oe;){let mt=this.plotWidth,Tt=this.plotHeight;for(let Rt of Pe)at===0?Rt.setScale():(Rt.horiz&&Ke||!Rt.horiz&&rt)&&Rt.setTickInterval(!0);at===0?this.getAxisMargins():this.getMargins(),Ke=mt/this.plotWidth>(at?1:1.1),rt=Tt/this.plotHeight>(at?1:1.05),at++}this.drawChartBox(),this.hasCartesianSeries?Re(Pe):Ee&&Ee.length&&Re(Ee),this.seriesGroup||(this.seriesGroup=Ie.g("series-group").attr({zIndex:3}).shadow(this.options.chart.seriesGroupShadow).add()),this.renderSeries(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0}addCredits(Pe){let Ee=this,Ie=J(!0,this.options.credits,Pe);Ie.enabled&&!this.credits&&(this.credits=this.renderer.text(Ie.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){Ie.href&&($.location.href=Ie.href)}).attr({align:Ie.position.align,zIndex:8}),Ee.styledMode||this.credits.css(Ie.style),this.credits.add().align(Ie.position),this.credits.update=function(Oe){Ee.credits=Ee.credits.destroy(),Ee.addCredits(Oe)})}destroy(){let Pe,Ee=this,Ie=Ee.axes,Oe=Ee.series,Re=Ee.container,Fe=Re&&Re.parentNode;for(ge(Ee,"destroy"),Ee.renderer.forExport?ue(X,Ee):X[Ee.index]=void 0,b.chartCount--,Ee.renderTo.removeAttribute("data-highcharts-chart"),Me(Ee),Pe=Ie.length;Pe--;)Ie[Pe]=Ie[Pe].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),Pe=Oe.length;Pe--;)Oe[Pe]=Oe[Pe].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach(function(Ke){let rt=Ee[Ke];rt&&rt.destroy&&(Ee[Ke]=rt.destroy())}),Re&&(Re.innerHTML=k.emptyHTML,Me(Re),Fe&&ne(Re)),re(Ee,function(Ke,rt){delete Ee[rt]})}firstRender(){var Oe;let Pe=this,Ee=Pe.options;Pe.getContainer(),Pe.resetMargins(),Pe.setChartSize(),Pe.propFromSeries(),Pe.getAxes();let Ie=K(Ee.series)?Ee.series:[];Ee.series=[],Ie.forEach(function(Re){Pe.initSeries(Re)}),Pe.linkSeries(),Pe.setSortedData(),ge(Pe,"beforeRender"),Pe.render(),(Oe=Pe.pointer)==null||Oe.getChartPosition(),Pe.renderer.imgCount||Pe.hasLoaded||Pe.onload(),Pe.temporaryDisplay(!0)}onload(){this.callbacks.concat([this.callback]).forEach(function(Pe){Pe&&this.index!==void 0&&Pe.apply(this,[this])},this),ge(this,"load"),ge(this,"render"),H(this.index)&&this.setReflow(),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0}warnIfA11yModuleNotLoaded(){let{options:Pe,title:Ee}=this;!Pe||this.accessibility||(this.renderer.boxWrapper.attr({role:"img","aria-label":(Ee&&Ee.element.textContent||"").replace(/</g,"&lt;")}),Pe.accessibility&&Pe.accessibility.enabled===!1||ie('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))}addSeries(Pe,Ee,Ie){let Oe,Re=this;return Pe&&(Ee=ce(Ee,!0),ge(Re,"addSeries",{options:Pe},function(){Oe=Re.initSeries(Pe),Re.isDirtyLegend=!0,Re.linkSeries(),Oe.enabledDataSorting&&Oe.setData(Pe.data,!1),ge(Re,"afterAddSeries",{series:Oe}),Ee&&Re.redraw(Ie)})),Oe}addAxis(Pe,Ee,Ie,Oe){return this.createAxis(Ee?"xAxis":"yAxis",{axis:Pe,redraw:Ie,animation:Oe})}addColorAxis(Pe,Ee,Ie){return this.createAxis("colorAxis",{axis:Pe,redraw:Ee,animation:Ie})}createAxis(Pe,Ee){let Ie=new h(this,Ee.axis,Pe);return ce(Ee.redraw,!0)&&this.redraw(Ee.animation),Ie}showLoading(Pe){let Ee=this,Ie=Ee.options,Oe=Ie.loading,Re=function(){Fe&&F(Fe,{left:Ee.plotLeft+"px",top:Ee.plotTop+"px",width:Ee.plotWidth+"px",height:Ee.plotHeight+"px"})},Fe=Ee.loadingDiv,Ke=Ee.loadingSpan;Fe||(Ee.loadingDiv=Fe=U("div",{className:"highcharts-loading highcharts-loading-hidden"},null,Ee.container)),Ke||(Ee.loadingSpan=Ke=U("span",{className:"highcharts-loading-inner"},null,Fe),L(Ee,"redraw",Re)),Fe.className="highcharts-loading",k.setElementHTML(Ke,ce(Pe,Ie.lang.loading,"")),Ee.styledMode||(F(Fe,oe(Oe.style,{zIndex:10})),F(Ke,Oe.labelStyle),Ee.loadingShown||(F(Fe,{opacity:0,display:""}),y(Fe,{opacity:Oe.style.opacity||.5},{duration:Oe.showDuration||0}))),Ee.loadingShown=!0,Re()}hideLoading(){let Pe=this.options,Ee=this.loadingDiv;Ee&&(Ee.className="highcharts-loading highcharts-loading-hidden",this.styledMode||y(Ee,{opacity:0},{duration:Pe.loading.hideDuration||100,complete:function(){F(Ee,{display:"none"})}})),this.loadingShown=!1}update(Pe,Ee,Ie,Oe){let Re,Fe,Ke,rt=this,at={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},ut=Pe.isResponsiveOptions,mt=[];ge(rt,"update",{options:Pe}),ut||rt.setResponsive(!1,!0),Pe=W(Pe,rt.options),rt.userOptions=J(rt.userOptions,Pe);let Tt=Pe.chart;Tt&&(J(!0,rt.options.chart,Tt),this.setZoomOptions(),"className"in Tt&&rt.setClassName(Tt.className),("inverted"in Tt||"polar"in Tt||"type"in Tt)&&(rt.propFromSeries(),Re=!0),"alignTicks"in Tt&&(Re=!0),"events"in Tt&&Y(this,Tt),re(Tt,function(Ct,Et){rt.propsRequireUpdateSeries.indexOf("chart."+Et)!==-1&&(Fe=!0),rt.propsRequireDirtyBox.indexOf(Et)!==-1&&(rt.isDirtyBox=!0),rt.propsRequireReflow.indexOf(Et)===-1||(rt.isDirtyBox=!0,ut||(Ke=!0))}),!rt.styledMode&&Tt.style&&rt.renderer.setStyle(rt.options.chart.style||{})),!rt.styledMode&&Pe.colors&&(this.options.colors=Pe.colors),Pe.time&&(this.time===M&&(this.time=new _(Pe.time)),J(!0,rt.options.time,Pe.time)),re(Pe,function(Ct,Et){rt[Et]&&typeof rt[Et].update=="function"?rt[Et].update(Ct,!1):typeof rt[at[Et]]=="function"?rt[at[Et]](Ct):Et!=="colors"&&rt.collectionsWithUpdate.indexOf(Et)===-1&&J(!0,rt.options[Et],Pe[Et]),Et!=="chart"&&rt.propsRequireUpdateSeries.indexOf(Et)!==-1&&(Fe=!0)}),this.collectionsWithUpdate.forEach(function(Ct){Pe[Ct]&&(_e(Pe[Ct]).forEach(function(Et,ri){let ci,Vt=H(Et.id);Vt&&(ci=rt.get(Et.id)),!ci&&rt[Ct]&&(ci=rt[Ct][ce(Et.index,ri)])&&(Vt&&H(ci.options.id)||ci.options.isInternal)&&(ci=void 0),ci&&ci.coll===Ct&&(ci.update(Et,!1),Ie&&(ci.touched=!0)),!ci&&Ie&&rt.collectionsWithInit[Ct]&&(rt.collectionsWithInit[Ct][0].apply(rt,[Et].concat(rt.collectionsWithInit[Ct][1]||[]).concat([!1])).touched=!0)}),Ie&&rt[Ct].forEach(function(Et){Et.touched||Et.options.isInternal?delete Et.touched:mt.push(Et)}))}),mt.forEach(function(Ct){Ct.chart&&Ct.remove&&Ct.remove(!1)}),Re&&rt.axes.forEach(function(Ct){Ct.update({},!1)}),Fe&&rt.getSeriesOrderByLinks().forEach(function(Ct){Ct.chart&&Ct.update({},!1)},this);let Rt=Tt&&Tt.width,pt=Tt&&(ye(Tt.height)?xe(Tt.height,Rt||rt.chartWidth):Tt.height);Ke||Q(Rt)&&Rt!==rt.chartWidth||Q(pt)&&pt!==rt.chartHeight?rt.setSize(Rt,pt,Oe):ce(Ee,!0)&&rt.redraw(Oe),ge(rt,"afterUpdate",{options:Pe,redraw:Ee,animation:Oe})}setSubtitle(Pe,Ee){this.applyDescription("subtitle",Pe),this.layOutTitles(Ee)}setCaption(Pe,Ee){this.applyDescription("caption",Pe),this.layOutTitles(Ee)}showResetZoom(){let Pe=this,Ee=w.lang,Ie=Pe.zooming.resetButton,Oe=Ie.theme,Re=Ie.relativeTo==="chart"||Ie.relativeTo==="spacingBox"?null:"plotBox";function Fe(){Pe.zoomOut()}ge(this,"beforeShowResetZoom",null,function(){Pe.resetZoomButton=Pe.renderer.button(Ee.resetZoom,null,null,Fe,Oe).attr({align:Ie.position.align,title:Ee.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(Ie.position,!1,Re)}),ge(this,"afterShowResetZoom")}zoomOut(){ge(this,"selection",{resetSelection:!0},()=>this.transform({reset:!0,trigger:"zoom"}))}pan(Pe,Ee){let Ie=this,Oe=typeof Ee=="object"?Ee:{enabled:Ee,type:"x"},Re=Oe.type,Fe=Re&&Ie[{x:"xAxis",xy:"axes",y:"yAxis"}[Re]].filter(rt=>rt.options.panningEnabled&&!rt.options.isInternal),Ke=Ie.options.chart;Ke!=null&&Ke.panning&&(Ke.panning=Oe),ge(this,"pan",{originalEvent:Pe},()=>{Ie.transform({axes:Fe,event:Pe,to:{x:Pe.chartX-(Ie.mouseDownX||0),y:Pe.chartY-(Ie.mouseDownY||0)},trigger:"pan"}),F(Ie.container,{cursor:"move"})})}transform(Pe){var Rt;let{axes:Ee=this.axes,event:Ie,from:Oe={},reset:Re,selection:Fe,to:Ke={},trigger:rt}=Pe,{inverted:at}=this,ut=!1,mt,Tt;for(let pt of((Rt=this.hoverPoints)==null||Rt.forEach(Ct=>Ct.setState()),Ee)){let{horiz:Ct,len:Et,minPointOffset:ri=0,options:ci,reversed:Vt}=pt,Ji=Ct?"width":"height",Vi=Ct?"x":"y",ar=ce(Ke[Ji],pt.len),Tr=ce(Oe[Ji],pt.len),Xi=10>Math.abs(ar)?1:ar/Tr,ht=(Oe[Vi]||0)+Tr/2-pt.pos,xt=ht-((Ke[Vi]??pt.pos)+ar/2-pt.pos)/Xi,At=Vt&&!at||!Vt&&at?-1:1;if(!Re&&(ht<0||ht>pt.len))continue;let Nt=pt.toValue(xt,!0)+(Fe||pt.isOrdinal?0:ri*At),Wt=pt.toValue(xt+Et/Xi,!0)-(Fe||pt.isOrdinal?0:ri*At||0),mi=pt.allExtremes;if(Nt>Wt&&([Nt,Wt]=[Wt,Nt]),Xi===1&&!Re&&pt.coll==="yAxis"&&!mi){for(let Lt of pt.series){let It=Lt.getExtremes(Lt.getProcessedData(!0).yData,!0);mi??(mi={dataMin:Number.MAX_VALUE,dataMax:-Number.MAX_VALUE}),Q(It.dataMin)&&Q(It.dataMax)&&(mi.dataMin=Math.min(It.dataMin,mi.dataMin),mi.dataMax=Math.max(It.dataMax,mi.dataMax))}pt.allExtremes=mi}let{dataMin:Di,dataMax:hi,min:$e,max:fe}=oe(pt.getExtremes(),mi||{}),ke=Di??ci.min,Ne=hi??ci.max,qe=Wt-Nt,it=pt.categories?0:Math.min(qe,Ne-ke),lt=ke-it*(H(ci.min)?0:ci.minPadding),st=Ne+it*(H(ci.max)?0:ci.maxPadding),tt=pt.allowZoomOutside||Xi===1||rt!=="zoom"&&Xi>1,ft=Math.min(ci.min??lt,lt,tt?$e:lt),St=Math.max(ci.max??st,st,tt?fe:st);(!pt.isOrdinal||pt.options.overscroll||Xi!==1||Re)&&(Nt<ft&&(Nt=ft,Xi>=1&&(Wt=Nt+qe)),Wt>St&&(Wt=St,Xi>=1&&(Nt=Wt-qe)),(Re||pt.series.length&&(Nt!==$e||Wt!==fe)&&Nt>=ft&&Wt<=St)&&(Fe?Fe[pt.coll].push({axis:pt,min:Nt,max:Wt}):(pt.isPanning=rt!=="zoom",pt.isPanning&&(Tt=!0),pt.setExtremes(Re?void 0:Nt,Re?void 0:Wt,!1,!1,{move:xt,trigger:rt,scale:Xi}),!Re&&(Nt>ft||Wt<St)&&rt!=="mousewheel"&&(mt=!0)),ut=!0),Ie&&(this[Ct?"mouseDownX":"mouseDownY"]=Ie[Ct?"chartX":"chartY"]))}return ut&&(Fe?ge(this,"selection",Fe,()=>{delete Pe.selection,Pe.trigger="zoom",this.transform(Pe)}):(!mt||Tt||this.resetZoomButton?!mt&&this.resetZoomButton&&(this.resetZoomButton=this.resetZoomButton.destroy()):this.showResetZoom(),this.redraw(rt==="zoom"&&(this.options.chart.animation??this.pointCount<100)))),ut}}return oe(Ue.prototype,{callbacks:[],collectionsWithInit:{xAxis:[Ue.prototype.addAxis,[!0]],yAxis:[Ue.prototype.addAxis,[!1]],series:[Ue.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"]}),Ue}),c(t,"Extensions/ScrollablePlotArea.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Globals.js"],t["Core/Renderer/RendererRegistry.js"],t["Core/Utilities.js"]],function(a,h,d,s){let{stop:f}=a,{composed:b}=h,{addEvent:x,createElement:v,css:g,defined:P,merge:_,pushUnique:S}=s;function k(){let I=this.scrollablePlotArea;(this.scrollablePixelsX||this.scrollablePixelsY)&&!I&&(this.scrollablePlotArea=I=new y(this)),I==null||I.applyFixed()}function A(){this.chart.scrollablePlotArea&&(this.chart.scrollablePlotArea.isDirty=!0)}class y{static compose(D,w,M){S(b,this.compose)&&(x(D,"afterInit",A),x(w,"afterSetChartSize",z=>this.afterSetSize(z.target,z)),x(w,"render",k),x(M,"show",A))}static afterSetSize(D,w){let M,z,Y,{minWidth:X,minHeight:Z}=D.options.chart.scrollablePlotArea||{},{clipBox:j,plotBox:V,inverted:$,renderer:R}=D;if(!R.forExport&&(X?(D.scrollablePixelsX=M=Math.max(0,X-D.chartWidth),M&&(D.scrollablePlotBox=_(D.plotBox),V.width=D.plotWidth+=M,j[$?"height":"width"]+=M,Y=!0)):Z&&(D.scrollablePixelsY=z=Math.max(0,Z-D.chartHeight),P(z)&&(D.scrollablePlotBox=_(D.plotBox),V.height=D.plotHeight+=z,j[$?"width":"height"]+=z,Y=!1)),P(Y)&&!w.skipAxes))for(let L of D.axes)L.horiz===Y&&(L.setAxisSize(),L.setAxisTranslation())}constructor(D){var G;let w,M=D.options.chart,z=d.getRendererType(),Y=M.scrollablePlotArea||{},X=this.moveFixedElements.bind(this),Z={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};D.scrollablePixelsX&&(Z.overflowX="auto"),D.scrollablePixelsY&&(Z.overflowY="auto"),this.chart=D;let j=this.parentDiv=v("div",{className:"highcharts-scrolling-parent"},{position:"relative"},D.renderTo),V=this.scrollingContainer=v("div",{className:"highcharts-scrolling"},Z,j),$=this.innerContainer=v("div",{className:"highcharts-inner-container"},void 0,V),R=this.fixedDiv=v("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(((G=M.style)==null?void 0:G.zIndex)||0)+2,top:0},void 0,!0),L=this.fixedRenderer=new z(R,D.chartWidth,D.chartHeight,M.style);this.mask=L.path().attr({fill:M.backgroundColor||"#fff","fill-opacity":Y.opacity??.85,zIndex:-1}).addClass("highcharts-scrollable-mask").add(),V.parentNode.insertBefore(R,V),g(D.renderTo,{overflow:"visible"}),x(D,"afterShowResetZoom",X),x(D,"afterApplyDrilldown",X),x(D,"afterLayOutTitles",X),x(V,"scroll",()=>{let{pointer:U,hoverPoint:F}=D;U&&(delete U.chartPosition,F&&(w=F),U.runPointActions(void 0,w,!0))}),$.appendChild(D.container)}applyFixed(){var Q;let{chart:D,fixedRenderer:w,isDirty:M,scrollingContainer:z}=this,{axisOffset:Y,chartWidth:X,chartHeight:Z,container:j,plotHeight:V,plotLeft:$,plotTop:R,plotWidth:L,scrollablePixelsX:G=0,scrollablePixelsY:U=0}=D,{scrollPositionX:F=0,scrollPositionY:H=0}=D.options.chart.scrollablePlotArea||{},W=X+G,ne=Z+U;w.setSize(X,Z),(M??!0)&&(this.isDirty=!1,this.moveFixedElements()),f(D.container),g(j,{width:`${W}px`,height:`${ne}px`}),D.renderer.boxWrapper.attr({width:W,height:ne,viewBox:[0,0,W,ne].join(" ")}),(Q=D.chartBackground)==null||Q.attr({width:W,height:ne}),g(z,{width:`${X}px`,height:`${Z}px`}),P(M)||(z.scrollLeft=G*F,z.scrollTop=U*H);let ue=R-Y[0]-1,ie=$-Y[3]-1,oe=R+V+Y[2]+1,Te=$+L+Y[1]+1,ge=$+L-G,we=R+V-U,K=[["M",0,0]];G?K=[["M",0,ue],["L",$-1,ue],["L",$-1,oe],["L",0,oe],["Z"],["M",ge,ue],["L",X,ue],["L",X,oe],["L",ge,oe],["Z"]]:U&&(K=[["M",ie,0],["L",ie,R-1],["L",Te,R-1],["L",Te,0],["Z"],["M",ie,we],["L",ie,Z],["L",Te,Z],["L",Te,we],["Z"]]),D.redrawTrigger!=="adjustHeight"&&this.mask.attr({d:K})}moveFixedElements(){let D,{container:w,inverted:M,scrollablePixelsX:z,scrollablePixelsY:Y}=this.chart,X=this.fixedRenderer,Z=y.fixedSelectors;for(let j of(z&&!M?D=".highcharts-yaxis":z&&M||Y&&!M?D=".highcharts-xaxis":Y&&M&&(D=".highcharts-yaxis"),D&&Z.push(`${D}:not(.highcharts-radial-axis)`,`${D}-labels:not(.highcharts-radial-axis-labels)`),Z))[].forEach.call(w.querySelectorAll(j),V=>{(V.namespaceURI===X.SVG_NS?X.box:X.box.parentNode).appendChild(V),V.style.pointerEvents="auto"})}}return y.fixedSelectors=[".highcharts-breadcrumbs-group",".highcharts-contextbutton",".highcharts-caption",".highcharts-credits",".highcharts-drillup-button",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-range-selector-group",".highcharts-reset-zoom",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"],y}),c(t,"Core/Axis/Stacking/StackItem.js",[t["Core/Templating.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d){let{format:s}=a,{series:f}=h,{destroyObjectProperties:b,fireEvent:x,isNumber:v,pick:g}=d;return class{constructor(P,_,S,k,A){let y=P.chart.inverted,I=P.reversed;this.axis=P;let D=this.isNegative=!!S!=!!I;this.options=_=_||{},this.x=k,this.total=null,this.cumulative=null,this.points={},this.hasValidPoints=!1,this.stack=A,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:_.align||(y?D?"left":"right":"center"),verticalAlign:_.verticalAlign||(y?"middle":D?"bottom":"top"),y:_.y,x:_.x},this.textAlign=_.textAlign||(y?D?"right":"left":"center")}destroy(){b(this,this.axis)}render(P){let _=this.axis.chart,S=this.options,k=S.format,A=k?s(k,this,_):S.formatter.call(this);if(this.label)this.label.attr({text:A,visibility:"hidden"});else{this.label=_.renderer.label(A,null,void 0,S.shape,void 0,void 0,S.useHTML,!1,"stack-labels");let y={r:S.borderRadius||0,text:A,padding:g(S.padding,5),visibility:"hidden"};_.styledMode||(y.fill=S.backgroundColor,y.stroke=S.borderColor,y["stroke-width"]=S.borderWidth,this.label.css(S.style||{})),this.label.attr(y),this.label.added||this.label.add(P)}this.label.labelrank=_.plotSizeY,x(this,"afterRender")}setOffset(P,_,S,k,A,y){let{alignOptions:I,axis:D,label:w,options:M,textAlign:z}=this,Y=D.chart,X=this.getStackBox({xOffset:P,width:_,boxBottom:S,boxTop:k,defaultX:A,xAxis:y}),{verticalAlign:Z}=I;if(w&&X){let j=w.getBBox(void 0,0),V=w.padding,$=g(M.overflow,"justify")==="justify",R;I.x=M.x||0,I.y=M.y||0;let{x:L,y:G}=this.adjustStackPosition({labelBox:j,verticalAlign:Z,textAlign:z});X.x-=L,X.y-=G,w.align(I,!1,X),(R=Y.isInsidePlot(w.alignAttr.x+I.x+L,w.alignAttr.y+I.y+G))||($=!1),$&&f.prototype.justifyDataLabel.call(D,w,I,w.alignAttr,j,X),w.attr({x:w.alignAttr.x,y:w.alignAttr.y,rotation:M.rotation,rotationOriginX:j.width*{left:0,center:.5,right:1}[M.textAlign||"center"],rotationOriginY:j.height/2}),g(!$&&M.crop,!0)&&(R=v(w.x)&&v(w.y)&&Y.isInsidePlot(w.x-V+(w.width||0),w.y)&&Y.isInsidePlot(w.x+V,w.y)),w[R?"show":"hide"]()}x(this,"afterSetOffset",{xOffset:P,width:_})}adjustStackPosition({labelBox:P,verticalAlign:_,textAlign:S}){let k={bottom:0,middle:1,top:2,right:1,center:0,left:-1},A=k[_],y=k[S];return{x:P.width/2+P.width/2*y,y:P.height/2*A}}getStackBox(P){let _=this.axis,S=_.chart,{boxTop:k,defaultX:A,xOffset:y,width:I,boxBottom:D}=P,w=_.stacking.usePercentage?100:g(k,this.total,0),M=_.toPixels(w),z=P.xAxis||S.xAxis[0],Y=g(A,z.translate(this.x))+y,X=Math.abs(M-_.toPixels(D||v(_.min)&&_.logarithmic&&_.logarithmic.lin2log(_.min)||0)),Z=S.inverted,j=this.isNegative;return Z?{x:(j?M:M-X)-S.plotLeft,y:z.height-Y-I+z.top-S.plotTop,width:X,height:I}:{x:Y+z.transB-S.plotLeft,y:(j?M-X:M)-S.plotTop,width:I,height:X}}}}),c(t,"Core/Axis/Stacking/StackingAxis.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Axis/Axis.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Axis/Stacking/StackItem.js"],t["Core/Utilities.js"]],function(a,h,d,s,f){var b;let{getDeferredAnimation:x}=a,{series:{prototype:v}}=d,{addEvent:g,correctFloat:P,defined:_,destroyObjectProperties:S,fireEvent:k,isArray:A,isNumber:y,objectEach:I,pick:D}=f;function w(){let R=this.inverted;this.axes.forEach(L=>{L.stacking&&L.stacking.stacks&&L.hasVisibleSeries&&(L.stacking.oldStacks=L.stacking.stacks)}),this.series.forEach(L=>{let G=L.xAxis&&L.xAxis.options||{};L.options.stacking&&L.reserveSpace()&&(L.stackKey=[L.type,D(L.options.stack,""),R?G.top:G.left,R?G.height:G.width].join(","))})}function M(){var L;let R=this.stacking;if(R){let G=R.stacks;I(G,(U,F)=>{S(U),delete G[F]}),(L=R.stackTotalGroup)==null||L.destroy()}}function z(){this.stacking||(this.stacking=new $(this))}function Y(R,L,G,U){return!_(R)||R.x!==L||U&&R.stackKey!==U?R={x:L,index:0,key:U,stackKey:U}:R.index++,R.key=[G,L,R.index].join(","),R}function X(){let R,L=this,G=L.yAxis,U=L.stackKey||"",F=G.stacking.stacks,H=L.processedXData,W=L.options.stacking,ne=L[W+"Stacker"];ne&&[U,"-"+U].forEach(ue=>{var we;let ie=H.length,oe,Te,ge;for(;ie--;)oe=H[ie],R=L.getStackIndicator(R,oe,L.index,ue),Te=(we=F[ue])==null?void 0:we[oe],(ge=Te==null?void 0:Te.points[R.key||""])&&ne.call(L,ge,Te,ie)})}function Z(R,L,G){let U=L.total?100/L.total:0;R[0]=P(R[0]*U),R[1]=P(R[1]*U),this.stackedYData[G]=R[1]}function j(R){(this.is("column")||this.is("columnrange"))&&(this.options.centerInCategory&&!this.options.stacking&&this.chart.series.length>1?v.setStackedPoints.call(this,R,"group"):R.stacking.resetStacks())}function V(R,L){var Le,Ue;let G,U,F,H,W,ne,ue,ie,oe,Te=L||this.options.stacking;if(!Te||!this.reserveSpace()||({group:"xAxis"}[Te]||"yAxis")!==R.coll)return;let ge=this.processedXData,we=this.processedYData,K=[],Q=we.length,ae=this.options,ye=ae.threshold||0,J=ae.startFromThreshold?ye:0,re=ae.stack,ce=L?`${this.type},${Te}`:this.stackKey||"",pe="-"+ce,xe=this.negStacks,Me=R.stacking,_e=Me.stacks,Ce=Me.oldStacks;for(Me.stacksTouched+=1,ue=0;ue<Q;ue++){ie=ge[ue],oe=we[ue],ne=(G=this.getStackIndicator(G,ie,this.index)).key||"",_e[W=(U=xe&&oe<(J?0:ye))?pe:ce]||(_e[W]={}),_e[W][ie]||((Le=Ce[W])!=null&&Le[ie]?(_e[W][ie]=Ce[W][ie],_e[W][ie].total=null):_e[W][ie]=new s(R,R.options.stackLabels,!!U,ie,re)),F=_e[W][ie],oe!==null?(F.points[ne]=F.points[this.index]=[D(F.cumulative,J)],_(F.cumulative)||(F.base=ne),F.touched=Me.stacksTouched,G.index>0&&this.singleStacks===!1&&(F.points[ne][0]=F.points[this.index+","+ie+",0"][0])):(delete F.points[ne],delete F.points[this.index]);let Xe=F.total||0;Te==="percent"?(H=U?ce:pe,Xe=xe&&((Ue=_e[H])!=null&&Ue[ie])?(H=_e[H][ie]).total=Math.max(H.total||0,Xe)+Math.abs(oe)||0:P(Xe+(Math.abs(oe)||0))):Te==="group"?(A(oe)&&(oe=oe[0]),oe!==null&&Xe++):Xe=P(Xe+(oe||0)),Te==="group"?F.cumulative=(Xe||1)-1:F.cumulative=P(D(F.cumulative,J)+(oe||0)),F.total=Xe,oe!==null&&(F.points[ne].push(F.cumulative),K[ue]=F.cumulative,F.hasValidPoints=!0)}Te==="percent"&&(Me.usePercentage=!0),Te!=="group"&&(this.stackedYData=K),Me.oldStacks={}}class ${constructor(L){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=L}buildStacks(){let L,G,U=this.axis,F=U.series,H=U.coll==="xAxis",W=U.options.reversedStacks,ne=F.length;for(this.resetStacks(),this.usePercentage=!1,G=ne;G--;)L=F[W?G:ne-G-1],H&&L.setGroupedPoints(U),L.setStackedPoints(U);if(!H)for(G=0;G<ne;G++)F[G].modifyStacks();k(U,"afterBuildStacks")}cleanStacks(){this.oldStacks&&(this.stacks=this.oldStacks,I(this.stacks,L=>{I(L,G=>{G.cumulative=G.total})}))}resetStacks(){I(this.stacks,L=>{I(L,(G,U)=>{y(G.touched)&&G.touched<this.stacksTouched?(G.destroy(),delete L[U]):(G.total=null,G.cumulative=null)})})}renderStackTotals(){var ne;let L=this.axis,G=L.chart,U=G.renderer,F=this.stacks,H=x(G,((ne=L.options.stackLabels)==null?void 0:ne.animation)||!1),W=this.stackTotalGroup=this.stackTotalGroup||U.g("stack-labels").attr({zIndex:6,opacity:0}).add();W.translate(G.plotLeft,G.plotTop),I(F,ue=>{I(ue,ie=>{ie.render(W)})}),W.animate({opacity:1},H)}}return(b||(b={})).compose=function(R,L,G){let U=L.prototype,F=G.prototype;U.getStacks||(g(R,"init",z),g(R,"destroy",M),U.getStacks=w,F.getStackIndicator=Y,F.modifyStacks=X,F.percentStacker=Z,F.setGroupedPoints=j,F.setStackedPoints=V)},b}),c(t,"Series/Line/LineSeries.js",[t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d){let{defined:s,merge:f,isObject:b}=d;class x extends a{drawGraph(){let g=this.options,P=(this.gappedPath||this.getGraphPath).call(this),_=this.chart.styledMode;[this,...this.zones].forEach((S,k)=>{let A,y=S.graph,I=y?"animate":"attr",D=S.dashStyle||g.dashStyle;y?(y.endX=this.preventGraphAnimation?null:P.xMap,y.animate({d:P})):P.length&&(S.graph=y=this.chart.renderer.path(P).addClass("highcharts-graph"+(k?` highcharts-zone-graph-${k-1} `:" ")+(k&&S.className||"")).attr({zIndex:1}).add(this.group)),y&&!_&&(A={stroke:!k&&g.lineColor||S.color||this.color||"#cccccc","stroke-width":g.lineWidth||0,fill:this.fillGraph&&this.color||"none"},D?A.dashstyle=D:g.linecap!=="square"&&(A["stroke-linecap"]=A["stroke-linejoin"]="round"),y[I](A).shadow(k<2&&g.shadow&&f({filterUnits:"userSpaceOnUse"},b(g.shadow)?g.shadow:{}))),y&&(y.startX=P.xMap,y.isArea=P.isArea)})}getGraphPath(g,P,_){let S=this,k=S.options,A=[],y=[],I,D=k.step,w=(g=g||S.points).reversed;return w&&g.reverse(),(D={right:1,center:2}[D]||D&&3)&&w&&(D=4-D),(g=this.getValidPoints(g,!1,!(k.connectNulls&&!P&&!_))).forEach(function(M,z){let Y,X=M.plotX,Z=M.plotY,j=g[z-1],V=M.isNull||typeof Z!="number";(M.leftCliff||j&&j.rightCliff)&&!_&&(I=!0),V&&!s(P)&&z>0?I=!k.connectNulls:V&&!P?I=!0:(z===0||I?Y=[["M",M.plotX,M.plotY]]:S.getPointSpline?Y=[S.getPointSpline(g,M,z)]:D?(Y=D===1?[["L",j.plotX,Z]]:D===2?[["L",(j.plotX+X)/2,j.plotY],["L",(j.plotX+X)/2,Z]]:[["L",X,j.plotY]]).push(["L",X,Z]):Y=[["L",X,Z]],y.push(M.x),D&&(y.push(M.x),D===2&&y.push(M.x)),A.push.apply(A,Y),I=!1)}),A.xMap=y,S.graphPath=A,A}}return x.defaultOptions=f(a.defaultOptions,{legendSymbol:"lineMarker"}),h.registerSeriesType("line",x),x}),c(t,"Series/Area/AreaSeriesDefaults.js",[],function(){return{threshold:0,legendSymbol:"areaMarker"}}),c(t,"Series/Area/AreaSeries.js",[t["Series/Area/AreaSeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d){let{seriesTypes:{line:s}}=h,{extend:f,merge:b,objectEach:x,pick:v}=d;class g extends s{drawGraph(){this.areaPath=[],super.drawGraph.apply(this);let{areaPath:_,options:S}=this;[this,...this.zones].forEach((k,A)=>{let y={},I=k.fillColor||S.fillColor,D=k.area,w=D?"animate":"attr";D?(D.endX=this.preventGraphAnimation?null:_.xMap,D.animate({d:_})):(y.zIndex=0,(D=k.area=this.chart.renderer.path(_).addClass("highcharts-area"+(A?` highcharts-zone-area-${A-1} `:" ")+(A&&k.className||"")).add(this.group)).isArea=!0),this.chart.styledMode||(y.fill=I||k.color||this.color,y["fill-opacity"]=I?1:S.fillOpacity??.75,D.css({pointerEvents:this.stickyTracking?"none":"auto"})),D[w](y),D.startX=_.xMap,D.shiftUnit=S.step?2:1})}getGraphPath(_){let S,k,A,y=s.prototype.getGraphPath,I=this.options,D=I.stacking,w=this.yAxis,M=[],z=[],Y=this.index,X=w.stacking.stacks[this.stackKey],Z=I.threshold,j=Math.round(w.getThreshold(I.threshold)),V=v(I.connectNulls,D==="percent"),$=function(H,W,ne){let ue=_[H],ie=D&&X[ue.x].points[Y],oe=ue[ne+"Null"]||0,Te=ue[ne+"Cliff"]||0,ge,we,K=!0;Te||oe?(ge=(oe?ie[0]:ie[1])+Te,we=ie[0]+Te,K=!!oe):!D&&_[W]&&_[W].isNull&&(ge=we=Z),ge!==void 0&&(z.push({plotX:S,plotY:ge===null?j:w.getThreshold(ge),isNull:K,isCliff:!0}),M.push({plotX:S,plotY:we===null?j:w.getThreshold(we),doCurve:!1}))};_=_||this.points,D&&(_=this.getStackPoints(_));for(let H=0,W=_.length;H<W;++H)D||(_[H].leftCliff=_[H].rightCliff=_[H].leftNull=_[H].rightNull=void 0),k=_[H].isNull,S=v(_[H].rectPlotX,_[H].plotX),A=D?v(_[H].yBottom,j):j,k&&!V||(V||$(H,H-1,"left"),k&&!D&&V||(z.push(_[H]),M.push({x:H,plotX:S,plotY:A})),V||$(H,H+1,"right"));let R=y.call(this,z,!0,!0);M.reversed=!0;let L=y.call(this,M,!0,!0),G=L[0];G&&G[0]==="M"&&(L[0]=["L",G[1],G[2]]);let U=R.concat(L);U.length&&U.push(["Z"]);let F=y.call(this,z,!1,V);return this.chart.series.length>1&&D&&z.some(H=>H.isCliff)&&(U.hasStackedCliffs=F.hasStackedCliffs=!0),U.xMap=R.xMap,this.areaPath=U,F}getStackPoints(_){let S=this,k=[],A=[],y=this.xAxis,I=this.yAxis,D=I.stacking.stacks[this.stackKey],w={},M=I.series,z=M.length,Y=I.options.reversedStacks?1:-1,X=M.indexOf(S);if(_=_||this.points,this.options.stacking){for(let j=0;j<_.length;j++)_[j].leftNull=_[j].rightNull=void 0,w[_[j].x]=_[j];x(D,function(j,V){j.total!==null&&A.push(V)}),A.sort(function(j,V){return j-V});let Z=M.map(j=>j.visible);A.forEach(function(j,V){let $=0,R,L;if(w[j]&&!w[j].isNull)k.push(w[j]),[-1,1].forEach(function(G){let U=G===1?"rightNull":"leftNull",F=D[A[V+G]],H=0;if(F){let W=X;for(;W>=0&&W<z;){let ne=M[W].index;!(R=F.points[ne])&&(ne===S.index?w[j][U]=!0:Z[W]&&(L=D[j].points[ne])&&(H-=L[1]-L[0])),W+=Y}}w[j][G===1?"rightCliff":"leftCliff"]=H});else{let G=X;for(;G>=0&&G<z;){let U=M[G].index;if(R=D[j].points[U]){$=R[1];break}G+=Y}$=v($,0),$=I.translate($,0,1,0,1),k.push({isNull:!0,plotX:y.translate(j,0,0,0,1),x:j,plotY:$,yBottom:$})}})}return k}}return g.defaultOptions=b(s.defaultOptions,a),f(g.prototype,{singleStacks:!1}),h.registerSeriesType("area",g),g}),c(t,"Series/Spline/SplineSeries.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h){let{line:d}=a.seriesTypes,{merge:s,pick:f}=h;class b extends d{getPointSpline(v,g,P){let _,S,k,A,y=g.plotX||0,I=g.plotY||0,D=v[P-1],w=v[P+1];function M(Y){return Y&&!Y.isNull&&Y.doCurve!==!1&&!g.isCliff}if(M(D)&&M(w)){let Y=D.plotX||0,X=D.plotY||0,Z=w.plotX||0,j=w.plotY||0,V=0;_=(1.5*y+Y)/2.5,S=(1.5*I+X)/2.5,k=(1.5*y+Z)/2.5,A=(1.5*I+j)/2.5,k!==_&&(V=(A-S)*(k-y)/(k-_)+I-A),S+=V,A+=V,S>X&&S>I?(S=Math.max(X,I),A=2*I-S):S<X&&S<I&&(S=Math.min(X,I),A=2*I-S),A>j&&A>I?(A=Math.max(j,I),S=2*I-A):A<j&&A<I&&(A=Math.min(j,I),S=2*I-A),g.rightContX=k,g.rightContY=A,g.controlPoints={low:[_,S],high:[k,A]}}let z=["C",f(D.rightContX,D.plotX,0),f(D.rightContY,D.plotY,0),f(_,y,0),f(S,I,0),y,I];return D.rightContX=D.rightContY=void 0,z}}return b.defaultOptions=s(d.defaultOptions),a.registerSeriesType("spline",b),b}),c(t,"Series/AreaSpline/AreaSplineSeries.js",[t["Series/Spline/SplineSeries.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d){let{area:s,area:{prototype:f}}=h.seriesTypes,{extend:b,merge:x}=d;class v extends a{}return v.defaultOptions=x(a.defaultOptions,s.defaultOptions),b(v.prototype,{getGraphPath:f.getGraphPath,getStackPoints:f.getStackPoints,drawGraph:f.drawGraph}),h.registerSeriesType("areaspline",v),v}),c(t,"Series/Column/ColumnSeriesDefaults.js",[],function(){return{borderRadius:3,centerInCategory:!1,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:void 0,verticalAlign:void 0,y:void 0},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"}}),c(t,"Series/Column/ColumnSeries.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Color/Color.js"],t["Series/Column/ColumnSeriesDefaults.js"],t["Core/Globals.js"],t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b,x){let{animObject:v}=a,{parse:g}=h,{noop:P}=s,{clamp:_,crisp:S,defined:k,extend:A,fireEvent:y,isArray:I,isNumber:D,merge:w,pick:M,objectEach:z}=x;class Y extends f{animate(Z){let j,V,$=this,R=this.yAxis,L=R.pos,G=R.reversed,U=$.options,{clipOffset:F,inverted:H}=this.chart,W={},ne=H?"translateX":"translateY";Z&&F?(W.scaleY=.001,V=_(R.toPixels(U.threshold),L,L+R.len),H?(V+=G?-Math.floor(F[0]):Math.ceil(F[2]),W.translateX=V-R.len):(V+=G?Math.ceil(F[0]):-Math.floor(F[2]),W.translateY=V),$.clipBox&&$.setClip(),$.group.attr(W)):(j=Number($.group.attr(ne)),$.group.animate({scaleY:1},A(v($.options.animation),{step:function(ue,ie){$.group&&(W[ne]=j+ie.pos*(L-j),$.group.attr(W))}})))}init(Z,j){super.init.apply(this,arguments);let V=this;(Z=V.chart).hasRendered&&Z.series.forEach(function($){$.type===V.type&&($.isDirty=!0)})}getColumnMetrics(){var oe,Te;let Z=this,j=Z.options,V=Z.xAxis,$=Z.yAxis,R=V.options.reversedStacks,L=V.reversed&&!R||!V.reversed&&R,G={},U,F=0;j.grouping===!1?F=1:Z.chart.series.forEach(function(ge){let we,K=ge.yAxis,Q=ge.options;ge.type===Z.type&&ge.reserveSpace()&&$.len===K.len&&$.pos===K.pos&&(Q.stacking&&Q.stacking!=="group"?(G[U=ge.stackKey]===void 0&&(G[U]=F++),we=G[U]):Q.grouping!==!1&&(we=F++),ge.columnIndex=we)});let H=Math.min(Math.abs(V.transA)*(!((oe=V.brokenAxis)!=null&&oe.hasBreaks)&&((Te=V.ordinal)==null?void 0:Te.slope)||j.pointRange||V.closestPointRange||V.tickInterval||1),V.len),W=H*j.groupPadding,ne=(H-2*W)/(F||1),ue=Math.min(j.maxPointWidth||V.len,M(j.pointWidth,ne*(1-2*j.pointPadding))),ie=(Z.columnIndex||0)+(L?1:0);return Z.columnMetrics={width:ue,offset:(ne-ue)/2+(W+ie*ne-H/2)*(L?-1:1),paddedWidth:ne,columnCount:F},Z.columnMetrics}crispCol(Z,j,V,$){let R=this.borderWidth,L=this.chart.inverted;return $=S(j+$,R,L)-(j=S(j,R,L)),this.options.crisp&&(V=S(Z+V,R)-(Z=S(Z,R))),{x:Z,y:j,width:V,height:$}}adjustForMissingColumns(Z,j,V,$){var R;if(!V.isNull&&$.columnCount>1){let L=this.xAxis.series.filter(H=>H.visible).map(H=>H.index),G=0,U=0;z((R=this.xAxis.stacking)==null?void 0:R.stacks,H=>{if(typeof V.x=="number"){let W=H[V.x.toString()];if(W&&I(W.points[this.index])){let ne=Object.keys(W.points).filter(ue=>!ue.match(",")&&W.points[ue]&&W.points[ue].length>1).map(parseFloat).filter(ue=>L.indexOf(ue)!==-1).sort((ue,ie)=>ie-ue);G=ne.indexOf(this.index),U=ne.length}}}),G=this.xAxis.reversed?U-1-G:G;let F=(U-1)*$.paddedWidth+j;Z=(V.plotX||0)+F/2-j-G*$.paddedWidth}return Z}translate(){let Z=this,j=Z.chart,V=Z.options,$=Z.dense=Z.closestPointRange*Z.xAxis.transA<2,R=Z.borderWidth=M(V.borderWidth,$?0:1),L=Z.xAxis,G=Z.yAxis,U=V.threshold,F=M(V.minPointLength,5),H=Z.getColumnMetrics(),W=H.width,ne=Z.pointXOffset=H.offset,ue=Z.dataMin,ie=Z.dataMax,oe=Z.translatedThreshold=G.getThreshold(U),Te=Z.barW=Math.max(W,1+2*R);V.pointPadding&&(Te=Math.ceil(Te)),f.prototype.translate.apply(Z),Z.points.forEach(function(ge){let we=M(ge.yBottom,oe),K=999+Math.abs(we),Q=ge.plotX||0,ae=_(ge.plotY,-K,G.len+K),ye,J=Math.min(ae,we),re=Math.max(ae,we)-J,ce=W,pe=Q+ne,xe=Te;F&&Math.abs(re)<F&&(re=F,ye=!G.reversed&&!ge.negative||G.reversed&&ge.negative,D(U)&&D(ie)&&ge.y===U&&ie<=U&&(G.min||0)<U&&(ue!==ie||(G.max||0)<=U)&&(ye=!ye,ge.negative=!ge.negative),J=Math.abs(J-oe)>F?we-F:oe-(ye?F:0)),k(ge.options.pointWidth)&&(pe-=Math.round(((ce=xe=Math.ceil(ge.options.pointWidth))-W)/2)),V.centerInCategory&&!V.stacking&&(pe=Z.adjustForMissingColumns(pe,ce,ge,H)),ge.barX=pe,ge.pointWidth=ce,ge.tooltipPos=j.inverted?[_(G.len+G.pos-j.plotLeft-ae,G.pos-j.plotLeft,G.len+G.pos-j.plotLeft),L.len+L.pos-j.plotTop-pe-xe/2,re]:[L.left-j.plotLeft+pe+xe/2,_(ae+G.pos-j.plotTop,G.pos-j.plotTop,G.len+G.pos-j.plotTop),re],ge.shapeType=Z.pointClass.prototype.shapeType||"roundedRect",ge.shapeArgs=Z.crispCol(pe,ge.isNull?oe:J,xe,ge.isNull?0:re)}),y(this,"afterColumnTranslate")}drawGraph(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")}pointAttribs(Z,j){let V=this.options,$=this.pointAttrToOptions||{},R=$.stroke||"borderColor",L=$["stroke-width"]||"borderWidth",G,U,F,H=Z&&Z.color||this.color,W=Z&&Z[R]||V[R]||H,ne=Z&&Z.options.dashStyle||V.dashStyle,ue=Z&&Z[L]||V[L]||this[L]||0,ie=M(Z&&Z.opacity,V.opacity,1);Z&&this.zones.length&&(U=Z.getZone(),H=Z.options.color||U&&(U.color||Z.nonZonedColor)||this.color,U&&(W=U.borderColor||W,ne=U.dashStyle||ne,ue=U.borderWidth||ue)),j&&Z&&(F=(G=w(V.states[j],Z.options.states&&Z.options.states[j]||{})).brightness,H=G.color||F!==void 0&&g(H).brighten(G.brightness).get()||H,W=G[R]||W,ue=G[L]||ue,ne=G.dashStyle||ne,ie=M(G.opacity,ie));let oe={fill:H,stroke:W,"stroke-width":ue,opacity:ie};return ne&&(oe.dashstyle=ne),oe}drawPoints(Z=this.points){let j,V=this,$=this.chart,R=V.options,L=$.renderer,G=R.animationLimit||250;Z.forEach(function(U){let F=U.plotY,H=U.graphic,W=!!H,ne=H&&$.pointCount<G?"animate":"attr";D(F)&&U.y!==null?(j=U.shapeArgs,H&&U.hasNewShapeType()&&(H=H.destroy()),V.enabledDataSorting&&(U.startXPos=V.xAxis.reversed?-(j&&j.width||0):V.xAxis.width),!H&&(U.graphic=H=L[U.shapeType](j).add(U.group||V.group),H&&V.enabledDataSorting&&$.hasRendered&&$.pointCount<G&&(H.attr({x:U.startXPos}),W=!0,ne="animate")),H&&W&&H[ne](w(j)),$.styledMode||H[ne](V.pointAttribs(U,U.selected&&"select")).shadow(U.allowShadow!==!1&&R.shadow),H&&(H.addClass(U.getClassName(),!0),H.attr({visibility:U.visible?"inherit":"hidden"}))):H&&(U.graphic=H.destroy())})}drawTracker(Z=this.points){let j,V=this,$=V.chart,R=$.pointer,L=function(G){let U=R==null?void 0:R.getPointFromEvent(G);R&&U&&V.options.enableMouseTracking&&(R.isDirectTouch=!0,U.onMouseOver(G))};Z.forEach(function(G){j=I(G.dataLabels)?G.dataLabels:G.dataLabel?[G.dataLabel]:[],G.graphic&&(G.graphic.element.point=G),j.forEach(function(U){(U.div||U.element).point=G})}),V._hasTracking||(V.trackerGroups.forEach(function(G){V[G]&&(V[G].addClass("highcharts-tracker").on("mouseover",L).on("mouseout",function(U){R==null||R.onTrackerMouseOut(U)}).on("touchstart",L),!$.styledMode&&V.options.cursor&&V[G].css({cursor:V.options.cursor}))}),V._hasTracking=!0),y(this,"afterDrawTracker")}remove(){let Z=this,j=Z.chart;j.hasRendered&&j.series.forEach(function(V){V.type===Z.type&&(V.isDirty=!0)}),f.prototype.remove.apply(Z,arguments)}}return Y.defaultOptions=w(f.defaultOptions,d),A(Y.prototype,{directTouch:!0,getSymbol:P,negStacks:!0,trackerGroups:["group","dataLabelsGroup"]}),b.registerSeriesType("column",Y),Y}),c(t,"Core/Series/DataLabel.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Templating.js"],t["Core/Utilities.js"]],function(a,h,d){var s;let{getDeferredAnimation:f}=a,{format:b}=h,{defined:x,extend:v,fireEvent:g,isArray:P,isString:_,merge:S,objectEach:k,pick:A,pInt:y,splat:I}=d;return function(D){function w(){return V(this).some(R=>R==null?void 0:R.enabled)}function M(R,L,G,U,F){var ae;let{chart:H,enabledDataSorting:W}=this,ne=this.isCartesian&&H.inverted,ue=R.plotX,ie=R.plotY,oe=G.rotation||0,Te=x(ue)&&x(ie)&&H.isInsidePlot(ue,Math.round(ie),{inverted:ne,paneCoordinates:!0,series:this}),ge=oe===0&&A(G.overflow,W?"none":"justify")==="justify",we=this.visible&&R.visible!==!1&&x(ue)&&(R.series.forceDL||W&&!ge||Te||A(G.inside,!!this.options.stacking)&&U&&H.isInsidePlot(ue,ne?U.x+1:U.y+U.height-1,{inverted:ne,paneCoordinates:!0,series:this})),K=R.pos();if(we&&K){var Q;let ye=L.getBBox(),J=L.getBBox(void 0,0),re={right:1,center:.5}[G.align||0]||0,ce={bottom:1,middle:.5}[G.verticalAlign||0]||0;if(U=v({x:K[0],y:Math.round(K[1]),width:0,height:0},U||{}),G.alignTo==="plotEdges"&&this.isCartesian&&(U[ne?"x":"y"]=0,U[ne?"width":"height"]=((ae=this.yAxis)==null?void 0:ae.len)||0),v(G,{width:ye.width,height:ye.height}),Q=U,W&&this.xAxis&&!ge&&this.setDataLabelStartPos(R,L,F,Te,Q),L.align(S(G,{width:J.width,height:J.height}),!1,U,!1),L.alignAttr.x+=re*(J.width-ye.width),L.alignAttr.y+=ce*(J.height-ye.height),L[L.placed?"animate":"attr"]({x:L.alignAttr.x+(ye.width-J.width)/2,y:L.alignAttr.y+(ye.height-J.height)/2,rotationOriginX:(L.width||0)/2,rotationOriginY:(L.height||0)/2}),ge&&U.height>=0)this.justifyDataLabel(L,G,L.alignAttr,ye,U,F);else if(A(G.crop,!0)){let{x:pe,y:xe}=L.alignAttr;we=H.isInsidePlot(pe,xe,{paneCoordinates:!0,series:this})&&H.isInsidePlot(pe+ye.width-1,xe+ye.height-1,{paneCoordinates:!0,series:this})}G.shape&&!oe&&L[F?"attr":"animate"]({anchorX:K[0],anchorY:K[1]})}F&&W&&(L.placed=!1),we||W&&!ge?(L.show(),L.placed=!0):(L.hide(),L.placed=!1)}function z(){return this.plotGroup("dataLabelsGroup","data-labels",this.hasRendered?"inherit":"hidden",this.options.dataLabels.zIndex||6)}function Y(R){let L=this.hasRendered||0,G=this.initDataLabelsGroup().attr({opacity:+L});return!L&&G&&(this.visible&&G.show(),this.options.animation?G.animate({opacity:1},R):G.attr({opacity:1})),G}function X(R){var we;let L;R=R||this.points;let G=this,U=G.chart,F=G.options,H=U.renderer,{backgroundColor:W,plotBackgroundColor:ne}=U.options.chart,ue=H.getContrast(_(ne)&&ne||_(W)&&W||"#000000"),ie=V(G),{animation:oe,defer:Te}=ie[0],ge=Te?f(U,oe,G):{defer:0,duration:0};g(this,"drawDataLabels"),(we=G.hasDataLabels)!=null&&we.call(G)&&(L=this.initDataLabels(ge),R.forEach(K=>{var ye,J;let Q=K.dataLabels||[];I(j(ie,K.dlOptions||((ye=K.options)==null?void 0:ye.dataLabels))).forEach((re,ce)=>{let pe=re.enabled&&(K.visible||K.dataLabelOnHidden)&&(!K.isNull||K.dataLabelOnNull)&&function(Fe,Ke){let rt=Ke.filter;if(rt){let at=rt.operator,ut=Fe[rt.property],mt=rt.value;return at===">"&&ut>mt||at==="<"&&ut<mt||at===">="&&ut>=mt||at==="<="&&ut<=mt||at==="=="&&ut==mt||at==="==="&&ut===mt||at==="!="&&ut!=mt||at==="!=="&&ut!==mt}return!0}(K,re),{backgroundColor:xe,borderColor:Me,distance:_e,style:Ce={}}=re,Le,Ue,Xe,Pe,Ee={},Ie=Q[ce],Oe=!Ie,Re;pe&&(Ue=A(re[K.formatPrefix+"Format"],re.format),Le=K.getLabelConfig(),Xe=x(Ue)?b(Ue,Le,U):(re[K.formatPrefix+"Formatter"]||re.formatter).call(Le,re),Pe=re.rotation,!U.styledMode&&(Ce.color=A(re.color,Ce.color,_(G.color)?G.color:void 0,"#000000"),Ce.color==="contrast"?(xe!=="none"&&(Re=xe),K.contrastColor=H.getContrast(Re!=="auto"&&Re||K.color||G.color),Ce.color=Re||!x(_e)&&re.inside||0>y(_e||0)||F.stacking?K.contrastColor:ue):delete K.contrastColor,F.cursor&&(Ce.cursor=F.cursor)),Ee={r:re.borderRadius||0,rotation:Pe,padding:re.padding,zIndex:1},U.styledMode||(Ee.fill=xe==="auto"?K.color:xe,Ee.stroke=Me==="auto"?K.color:Me,Ee["stroke-width"]=re.borderWidth),k(Ee,(Fe,Ke)=>{Fe===void 0&&delete Ee[Ke]})),!Ie||pe&&x(Xe)&&!!Ie.div==!!re.useHTML&&(Ie.rotation&&re.rotation||Ie.rotation===re.rotation)||(Ie=void 0,Oe=!0),pe&&x(Xe)&&(Ie?Ee.text=Xe:(Ie=H.label(Xe,0,0,re.shape,void 0,void 0,re.useHTML,void 0,"data-label")).addClass(" highcharts-data-label-color-"+K.colorIndex+" "+(re.className||"")+(re.useHTML?" highcharts-tracker":"")),Ie&&(Ie.options=re,Ie.attr(Ee),U.styledMode?Ce.width&&Ie.css({width:Ce.width,textOverflow:Ce.textOverflow}):Ie.css(Ce).shadow(re.shadow),g(Ie,"beforeAddingDataLabel",{labelOptions:re,point:K}),Ie.added||Ie.add(L),G.alignDataLabel(K,Ie,re,void 0,Oe),Ie.isActive=!0,Q[ce]&&Q[ce]!==Ie&&Q[ce].destroy(),Q[ce]=Ie))});let ae=Q.length;for(;ae--;)Q[ae]&&Q[ae].isActive?Q[ae].isActive=!1:((J=Q[ae])==null||J.destroy(),Q.splice(ae,1));K.dataLabel=Q[0],K.dataLabels=Q})),g(this,"afterDrawDataLabels")}function Z(R,L,G,U,F,H){let W=this.chart,ne=L.align,ue=L.verticalAlign,ie=R.box?0:R.padding||0,oe=W.inverted?this.yAxis:this.xAxis,Te=oe?oe.left-W.plotLeft:0,ge=W.inverted?this.xAxis:this.yAxis,we=ge?ge.top-W.plotTop:0,{x:K=0,y:Q=0}=L,ae,ye;return(ae=(G.x||0)+ie+Te)<0&&(ne==="right"&&K>=0?(L.align="left",L.inside=!0):K-=ae,ye=!0),(ae=(G.x||0)+U.width-ie+Te)>W.plotWidth&&(ne==="left"&&K<=0?(L.align="right",L.inside=!0):K+=W.plotWidth-ae,ye=!0),(ae=G.y+ie+we)<0&&(ue==="bottom"&&Q>=0?(L.verticalAlign="top",L.inside=!0):Q-=ae,ye=!0),(ae=(G.y||0)+U.height-ie+we)>W.plotHeight&&(ue==="top"&&Q<=0?(L.verticalAlign="bottom",L.inside=!0):Q+=W.plotHeight-ae,ye=!0),ye&&(L.x=K,L.y=Q,R.placed=!H,R.align(L,void 0,F)),ye}function j(R,L){let G=[],U;if(P(R)&&!P(L))G=R.map(function(F){return S(F,L)});else if(P(L)&&!P(R))G=L.map(function(F){return S(R,F)});else if(P(R)||P(L)){if(P(R)&&P(L))for(U=Math.max(R.length,L.length);U--;)G[U]=S(R[U],L[U])}else G=S(R,L);return G}function V(R){var G,U;let L=R.chart.options.plotOptions;return I(j(j((G=L==null?void 0:L.series)==null?void 0:G.dataLabels,(U=L==null?void 0:L[R.type])==null?void 0:U.dataLabels),R.options.dataLabels))}function $(R,L,G,U,F){let H=this.chart,W=H.inverted,ne=this.xAxis,ue=ne.reversed,ie=((W?L.height:L.width)||0)/2,oe=R.pointWidth,Te=oe?oe/2:0;L.startXPos=W?F.x:ue?-ie-Te:ne.width-ie+Te,L.startYPos=W?ue?this.yAxis.height-ie+Te:-ie-Te:F.y,U?L.visibility==="hidden"&&(L.show(),L.attr({opacity:0}).animate({opacity:1})):L.attr({opacity:1}).animate({opacity:0},void 0,L.hide),H.hasRendered&&(G&&L.attr({x:L.startXPos,y:L.startYPos}),L.placed=!0)}D.compose=function(R){let L=R.prototype;L.initDataLabels||(L.initDataLabels=Y,L.initDataLabelsGroup=z,L.alignDataLabel=M,L.drawDataLabels=X,L.justifyDataLabel=Z,L.setDataLabelStartPos=$,L.hasDataLabels=w)}}(s||(s={})),s}),c(t,"Series/Column/ColumnDataLabel.js",[t["Core/Series/DataLabel.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d,s){var f;let{composed:b}=h,{series:x}=d,{merge:v,pick:g,pushUnique:P}=s;return function(_){function S(k,A,y,I,D){let w=this.chart.inverted,M=k.series,z=(M.xAxis?M.xAxis.len:this.chart.plotSizeX)||0,Y=(M.yAxis?M.yAxis.len:this.chart.plotSizeY)||0,X=k.dlBox||k.shapeArgs,Z=g(k.below,k.plotY>g(this.translatedThreshold,Y)),j=g(y.inside,!!this.options.stacking);if(X){if(I=v(X),!(y.overflow==="allow"&&y.crop===!1)){I.y<0&&(I.height+=I.y,I.y=0);let V=I.y+I.height-Y;V>0&&V<I.height-1&&(I.height-=V)}w&&(I={x:Y-I.y-I.height,y:z-I.x-I.width,width:I.height,height:I.width}),j||(w?(I.x+=Z?0:I.width,I.width=0):(I.y+=Z?I.height:0,I.height=0))}y.align=g(y.align,!w||j?"center":Z?"right":"left"),y.verticalAlign=g(y.verticalAlign,w||j?"middle":Z?"top":"bottom"),x.prototype.alignDataLabel.call(this,k,A,y,I,D),y.inside&&k.contrastColor&&A.css({color:k.contrastColor})}_.compose=function(k){a.compose(x),P(b,"ColumnDataLabel")&&(k.prototype.alignDataLabel=S)}}(f||(f={})),f}),c(t,"Series/Bar/BarSeries.js",[t["Series/Column/ColumnSeries.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d){let{extend:s,merge:f}=d;class b extends a{}return b.defaultOptions=f(a.defaultOptions,{}),s(b.prototype,{inverted:!0}),h.registerSeriesType("bar",b),b}),c(t,"Series/Scatter/ScatterSeriesDefaults.js",[],function(){return{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">●</span> <span style="font-size: 0.8em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}}),c(t,"Series/Scatter/ScatterSeries.js",[t["Series/Scatter/ScatterSeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d){let{column:s,line:f}=h.seriesTypes,{addEvent:b,extend:x,merge:v}=d;class g extends f{applyJitter(){let _=this,S=this.options.jitter,k=this.points.length;S&&this.points.forEach(function(A,y){["x","y"].forEach(function(I,D){if(S[I]&&!A.isNull){let w=`plot${I.toUpperCase()}`,M=_[`${I}Axis`],z=S[I]*M.transA;if(M&&!M.logarithmic){let Y=Math.max(0,(A[w]||0)-z),X=Math.min(M.len,(A[w]||0)+z);A[w]=Y+(X-Y)*function(Z){let j=1e4*Math.sin(Z);return j-Math.floor(j)}(y+D*k),I==="x"&&(A.clientX=A.plotX)}}})})}drawGraph(){this.options.lineWidth?super.drawGraph():this.graph&&(this.graph=this.graph.destroy())}}return g.defaultOptions=v(f.defaultOptions,a),x(g.prototype,{drawTracker:s.prototype.drawTracker,sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"]}),b(g,"afterTranslate",function(){this.applyJitter()}),h.registerSeriesType("scatter",g),g}),c(t,"Series/CenteredUtilities.js",[t["Core/Globals.js"],t["Core/Series/Series.js"],t["Core/Utilities.js"]],function(a,h,d){var s,f;let{deg2rad:b}=a,{fireEvent:x,isNumber:v,pick:g,relativeLength:P}=d;return(f=s||(s={})).getCenter=function(){let _=this.options,S=this.chart,k=2*(_.slicedOffset||0),A=S.plotWidth-2*k,y=S.plotHeight-2*k,I=_.center,D=Math.min(A,y),w=_.thickness,M,z=_.size,Y=_.innerSize||0,X,Z;typeof z=="string"&&(z=parseFloat(z)),typeof Y=="string"&&(Y=parseFloat(Y));let j=[g(I[0],"50%"),g(I[1],"50%"),g(z&&z<0?void 0:_.size,"100%"),g(Y&&Y<0?void 0:_.innerSize||0,"0%")];for(!S.angular||this instanceof h||(j[3]=0),X=0;X<4;++X)Z=j[X],M=X<2||X===2&&/%$/.test(Z),j[X]=P(Z,[A,y,D,j[2]][X])+(M?k:0);return j[3]>j[2]&&(j[3]=j[2]),v(w)&&2*w<j[2]&&w>0&&(j[3]=j[2]-2*w),x(this,"afterGetCenter",{positions:j}),j},f.getStartAndEndRadians=function(_,S){let k=v(_)?_:0,A=v(S)&&S>k&&S-k<360?S:k+360;return{start:b*(k+-90),end:b*(A+-90)}},s}),c(t,"Series/Pie/PiePoint.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Series/Point.js"],t["Core/Utilities.js"]],function(a,h,d){let{setAnimation:s}=a,{addEvent:f,defined:b,extend:x,isNumber:v,pick:g,relativeLength:P}=d;class _ extends h{getConnectorPath(k){let A=k.dataLabelPosition,y=k.options||{},I=y.connectorShape,D=this.connectorShapes[I]||I;return A&&D.call(this,{...A.computed,alignment:A.alignment},A.connectorPosition,y)||[]}getTranslate(){return this.sliced&&this.slicedTranslation||{translateX:0,translateY:0}}haloPath(k){let A=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(A.x,A.y,A.r+k,A.r+k,{innerR:A.r-1,start:A.start,end:A.end,borderRadius:A.borderRadius})}constructor(k,A,y){super(k,A,y),this.half=0,this.name??(this.name="Slice");let I=D=>{this.slice(D.type==="select")};f(this,"select",I),f(this,"unselect",I)}isValid(){return v(this.y)&&this.y>=0}setVisible(k,A=!0){k!==this.visible&&this.update({visible:k??!this.visible},A,void 0,!1)}slice(k,A,y){let I=this.series;s(y,I.chart),A=g(A,!0),this.sliced=this.options.sliced=k=b(k)?k:!this.sliced,I.options.data[I.data.indexOf(this)]=this.options,this.graphic&&this.graphic.animate(this.getTranslate())}}return x(_.prototype,{connectorShapes:{fixedOffset:function(S,k,A){let y=k.breakAt,I=k.touchingSliceAt,D=A.softConnector?["C",S.x+(S.alignment==="left"?-5:5),S.y,2*y.x-I.x,2*y.y-I.y,y.x,y.y]:["L",y.x,y.y];return[["M",S.x,S.y],D,["L",I.x,I.y]]},straight:function(S,k){let A=k.touchingSliceAt;return[["M",S.x,S.y],["L",A.x,A.y]]},crookedLine:function(S,k,A){let{breakAt:y,touchingSliceAt:I}=k,{series:D}=this,[w,M,z]=D.center,Y=z/2,{plotLeft:X,plotWidth:Z}=D.chart,j=S.alignment==="left",{x:V,y:$}=S,R=y.x;if(A.crookDistance){let G=P(A.crookDistance,1);R=j?w+Y+(Z+X-w-Y)*(1-G):X+(w-Y)*G}else R=w+(M-$)*Math.tan((this.angle||0)-Math.PI/2);let L=[["M",V,$]];return(j?R<=V&&R>=y.x:R>=V&&R<=y.x)&&L.push(["L",R,$]),L.push(["L",y.x,y.y],["L",I.x,I.y]),L}}}),_}),c(t,"Series/Pie/PieSeriesDefaults.js",[],function(){return{borderRadius:3,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{connectorPadding:5,connectorShape:"crookedLine",crookDistance:void 0,distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}}}),c(t,"Series/Pie/PieSeries.js",[t["Series/CenteredUtilities.js"],t["Series/Column/ColumnSeries.js"],t["Core/Globals.js"],t["Series/Pie/PiePoint.js"],t["Series/Pie/PieSeriesDefaults.js"],t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Renderer/SVG/Symbols.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b,x,v,g){let{getStartAndEndRadians:P}=a,{noop:_}=d,{clamp:S,extend:k,fireEvent:A,merge:y,pick:I}=g;class D extends b{animate(M){let z=this,Y=z.points,X=z.startAngleRad;M||Y.forEach(function(Z){let j=Z.graphic,V=Z.shapeArgs;j&&V&&(j.attr({r:I(Z.startR,z.center&&z.center[3]/2),start:X,end:X}),j.animate({r:V.r,start:V.start,end:V.end},z.options.animation))})}drawEmpty(){let M,z,Y=this.startAngleRad,X=this.endAngleRad,Z=this.options;this.total===0&&this.center?(M=this.center[0],z=this.center[1],this.graph||(this.graph=this.chart.renderer.arc(M,z,this.center[1]/2,0,Y,X).addClass("highcharts-empty-series").add(this.group)),this.graph.attr({d:v.arc(M,z,this.center[2]/2,0,{start:Y,end:X,innerR:this.center[3]/2})}),this.chart.styledMode||this.graph.attr({"stroke-width":Z.borderWidth,fill:Z.fillColor||"none",stroke:Z.color||"#cccccc"})):this.graph&&(this.graph=this.graph.destroy())}drawPoints(){let M=this.chart.renderer;this.points.forEach(function(z){z.graphic&&z.hasNewShapeType()&&(z.graphic=z.graphic.destroy()),z.graphic||(z.graphic=M[z.shapeType](z.shapeArgs).add(z.series.group),z.delayedRendering=!0)})}generatePoints(){super.generatePoints(),this.updateTotals()}getX(M,z,Y,X){let Z=this.center,j=this.radii?this.radii[Y.index]||0:Z[2]/2,V=X.dataLabelPosition,$=(V==null?void 0:V.distance)||0,R=Math.asin(S((M-Z[1])/(j+$),-1,1));return Z[0]+Math.cos(R)*(j+$)*(z?-1:1)+($>0?(z?-1:1)*(X.padding||0):0)}hasData(){return!!this.processedXData.length}redrawPoints(){let M,z,Y,X,Z=this,j=Z.chart;this.drawEmpty(),Z.group&&!j.styledMode&&Z.group.shadow(Z.options.shadow),Z.points.forEach(function(V){let $={};z=V.graphic,!V.isNull&&z?(X=V.shapeArgs,M=V.getTranslate(),j.styledMode||(Y=Z.pointAttribs(V,V.selected&&"select")),V.delayedRendering?(z.setRadialReference(Z.center).attr(X).attr(M),j.styledMode||z.attr(Y).attr({"stroke-linejoin":"round"}),V.delayedRendering=!1):(z.setRadialReference(Z.center),j.styledMode||y(!0,$,Y),y(!0,$,X,M),z.animate($)),z.attr({visibility:V.visible?"inherit":"hidden"}),z.addClass(V.getClassName(),!0)):z&&(V.graphic=z.destroy())})}sortByAngle(M,z){M.sort(function(Y,X){return Y.angle!==void 0&&(X.angle-Y.angle)*z})}translate(M){A(this,"translate"),this.generatePoints();let z=this.options,Y=z.slicedOffset,X=P(z.startAngle,z.endAngle),Z=this.startAngleRad=X.start,j=(this.endAngleRad=X.end)-Z,V=this.points,$=z.ignoreHiddenPoint,R=V.length,L,G,U,F,H,W,ne,ue=0;for(M||(this.center=M=this.getCenter()),W=0;W<R;W++){ne=V[W],L=Z+ue*j,ne.isValid()&&(!$||ne.visible)&&(ue+=ne.percentage/100),G=Z+ue*j;let ie={x:M[0],y:M[1],r:M[2]/2,innerR:M[3]/2,start:Math.round(1e3*L)/1e3,end:Math.round(1e3*G)/1e3};ne.shapeType="arc",ne.shapeArgs=ie,(U=(G+L)/2)>1.5*Math.PI?U-=2*Math.PI:U<-Math.PI/2&&(U+=2*Math.PI),ne.slicedTranslation={translateX:Math.round(Math.cos(U)*Y),translateY:Math.round(Math.sin(U)*Y)},F=Math.cos(U)*M[2]/2,H=Math.sin(U)*M[2]/2,ne.tooltipPos=[M[0]+.7*F,M[1]+.7*H],ne.half=U<-Math.PI/2||U>Math.PI/2?1:0,ne.angle=U}A(this,"afterTranslate")}updateTotals(){let M=this.points,z=M.length,Y=this.options.ignoreHiddenPoint,X,Z,j=0;for(X=0;X<z;X++)(Z=M[X]).isValid()&&(!Y||Z.visible)&&(j+=Z.y);for(X=0,this.total=j;X<z;X++)(Z=M[X]).percentage=j>0&&(Z.visible||!Y)?Z.y/j*100:0,Z.total=j}}return D.defaultOptions=y(b.defaultOptions,f),k(D.prototype,{axisTypes:[],directTouch:!0,drawGraph:void 0,drawTracker:h.prototype.drawTracker,getCenter:a.getCenter,getSymbol:_,invertible:!1,isCartesian:!1,noSharedTooltip:!0,pointAttribs:h.prototype.pointAttribs,pointClass:s,requireSorting:!1,searchPoint:_,trackerGroups:["group","dataLabelsGroup"]}),x.registerSeriesType("pie",D),D}),c(t,"Series/Pie/PieDataLabel.js",[t["Core/Series/DataLabel.js"],t["Core/Globals.js"],t["Core/Renderer/RendererUtilities.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d,s,f){var b;let{composed:x,noop:v}=h,{distribute:g}=d,{series:P}=s,{arrayMax:_,clamp:S,defined:k,pick:A,pushUnique:y,relativeLength:I}=f;return function(D){let w={radialDistributionY:function(Z,j){var V;return(((V=j.dataLabelPosition)==null?void 0:V.top)||0)+Z.distributeBox.pos},radialDistributionX:function(Z,j,V,$,R){let L=R.dataLabelPosition;return Z.getX(V<((L==null?void 0:L.top)||0)+2||V>((L==null?void 0:L.bottom)||0)-2?$:V,j.half,j,R)},justify:function(Z,j,V,$){var R;return $[0]+(Z.half?-1:1)*(V+(((R=j.dataLabelPosition)==null?void 0:R.distance)||0))},alignToPlotEdges:function(Z,j,V,$){let R=Z.getBBox().width;return j?R+$:V-R-$},alignToConnectors:function(Z,j,V,$){let R=0,L;return Z.forEach(function(G){(L=G.dataLabel.getBBox().width)>R&&(R=L)}),j?R+$:V-R-$}};function M(Z,j){let{center:V,options:$}=this,R=V[2]/2,L=Z.angle||0,G=Math.cos(L),U=Math.sin(L),F=V[0]+G*R,H=V[1]+U*R,W=Math.min(($.slicedOffset||0)+($.borderWidth||0),j/5);return{natural:{x:F+G*j,y:H+U*j},computed:{},alignment:j<0?"center":Z.half?"right":"left",connectorPosition:{breakAt:{x:F+G*W,y:H+U*W},touchingSliceAt:{x:F,y:H}},distance:j}}function z(){var we;let Z=this,j=Z.points,V=Z.chart,$=V.plotWidth,R=V.plotHeight,L=V.plotLeft,G=Math.round(V.chartWidth/3),U=Z.center,F=U[2]/2,H=U[1],W=[[],[]],ne=[0,0,0,0],ue=Z.dataLabelPositioners,ie,oe,Te,ge=0;Z.visible&&((we=Z.hasDataLabels)!=null&&we.call(Z))&&(j.forEach(K=>{(K.dataLabels||[]).forEach(Q=>{Q.shortened&&(Q.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),Q.shortened=!1)})}),P.prototype.drawDataLabels.apply(Z),j.forEach(K=>{(K.dataLabels||[]).forEach((Q,ae)=>{var ce;let ye=U[2]/2,J=Q.options,re=I((J==null?void 0:J.distance)||0,ye);ae===0&&W[K.half].push(K),!k((ce=J==null?void 0:J.style)==null?void 0:ce.width)&&Q.getBBox().width>G&&(Q.css({width:Math.round(.7*G)+"px"}),Q.shortened=!0),Q.dataLabelPosition=this.getDataLabelPosition(K,re),ge=Math.max(ge,re)})}),W.forEach((K,Q)=>{let ae=K.length,ye=[],J,re,ce=0,pe;ae&&(Z.sortByAngle(K,Q-.5),ge>0&&(J=Math.max(0,H-F-ge),re=Math.min(H+F+ge,V.plotHeight),K.forEach(xe=>{(xe.dataLabels||[]).forEach(Me=>{var Ce;let _e=Me.dataLabelPosition;_e&&_e.distance>0&&(_e.top=Math.max(0,H-F-_e.distance),_e.bottom=Math.min(H+F+_e.distance,V.plotHeight),ce=Me.getBBox().height||21,Me.lineHeight=V.renderer.fontMetrics(Me.text||Me).h+2*Me.padding,xe.distributeBox={target:(((Ce=Me.dataLabelPosition)==null?void 0:Ce.natural.y)||0)-_e.top+Me.lineHeight/2,size:ce,rank:xe.y},ye.push(xe.distributeBox))})}),g(ye,pe=re+ce-J,pe/5)),K.forEach(xe=>{(xe.dataLabels||[]).forEach(Me=>{let _e=Me.options||{},Ce=xe.distributeBox,Le=Me.dataLabelPosition,Ue=(Le==null?void 0:Le.natural.y)||0,Xe=_e.connectorPadding||0,Pe=Me.lineHeight||21,Ee=(Pe-Me.getBBox().height)/2,Ie=0,Oe=Ue,Re="inherit";if(Le){if(k(Ce)&&Le.distance>0&&(Ce.pos===void 0?Re="hidden":(Te=Ce.size,Oe=ue.radialDistributionY(xe,Me))),_e.justify)Ie=ue.justify(xe,Me,F,U);else switch(_e.alignTo){case"connectors":Ie=ue.alignToConnectors(K,Q,$,L);break;case"plotEdges":Ie=ue.alignToPlotEdges(Me,Q,$,L);break;default:Ie=ue.radialDistributionX(Z,xe,Oe-Ee,Ue,Me)}if(Le.attribs={visibility:Re,align:Le.alignment},Le.posAttribs={x:Ie+(_e.x||0)+({left:Xe,right:-Xe}[Le.alignment]||0),y:Oe+(_e.y||0)-Pe/2},Le.computed.x=Ie,Le.computed.y=Oe-Ee,A(_e.crop,!0)){let Fe;Ie-(oe=Me.getBBox().width)<Xe&&Q===1?(Fe=Math.round(oe-Ie+Xe),ne[3]=Math.max(Fe,ne[3])):Ie+oe>$-Xe&&Q===0&&(Fe=Math.round(Ie+oe-$+Xe),ne[1]=Math.max(Fe,ne[1])),Oe-Te/2<0?ne[0]=Math.max(Math.round(-Oe+Te/2),ne[0]):Oe+Te/2>R&&(ne[2]=Math.max(Math.round(Oe+Te/2-R),ne[2])),Le.sideOverflow=Fe}}})}))}),(_(ne)===0||this.verifyDataLabelOverflow(ne))&&(this.placeDataLabels(),this.points.forEach(K=>{(K.dataLabels||[]).forEach(Q=>{var re;let{connectorColor:ae,connectorWidth:ye=1}=Q.options||{},J=Q.dataLabelPosition;if(ye){let ce;ie=Q.connector,J&&J.distance>0?(ce=!ie,ie||(Q.connector=ie=V.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+K.colorIndex+(K.className?" "+K.className:"")).add(Z.dataLabelsGroup)),V.styledMode||ie.attr({"stroke-width":ye,stroke:ae||K.color||"#666666"}),ie[ce?"attr":"animate"]({d:K.getConnectorPath(Q)}),ie.attr({visibility:(re=J.attribs)==null?void 0:re.visibility})):ie&&(Q.connector=ie.destroy())}})})))}function Y(){this.points.forEach(Z=>{(Z.dataLabels||[]).forEach(j=>{var $;let V=j.dataLabelPosition;V?(V.sideOverflow&&(j.css({width:Math.max(j.getBBox().width-V.sideOverflow,0)+"px",textOverflow:((($=j.options)==null?void 0:$.style)||{}).textOverflow||"ellipsis"}),j.shortened=!0),j.attr(V.attribs),j[j.moved?"animate":"attr"](V.posAttribs),j.moved=!0):j&&j.attr({y:-9999})}),delete Z.distributeBox},this)}function X(Z){let j=this.center,V=this.options,$=V.center,R=V.minSize||80,L=R,G=V.size!==null;return!G&&($[0]!==null?L=Math.max(j[2]-Math.max(Z[1],Z[3]),R):(L=Math.max(j[2]-Z[1]-Z[3],R),j[0]+=(Z[3]-Z[1])/2),$[1]!==null?L=S(L,R,j[2]-Math.max(Z[0],Z[2])):(L=S(L,R,j[2]-Z[0]-Z[2]),j[1]+=(Z[0]-Z[2])/2),L<j[2]?(j[2]=L,j[3]=Math.min(V.thickness?Math.max(0,L-2*V.thickness):Math.max(0,I(V.innerSize||0,L)),L),this.translate(j),this.drawDataLabels&&this.drawDataLabels()):G=!0),G}D.compose=function(Z){if(a.compose(P),y(x,"PieDataLabel")){let j=Z.prototype;j.dataLabelPositioners=w,j.alignDataLabel=v,j.drawDataLabels=z,j.getDataLabelPosition=M,j.placeDataLabels=Y,j.verifyDataLabelOverflow=X}}}(b||(b={})),b}),c(t,"Core/Geometry/GeometryUtilities.js",[],function(){var a,h;return(h=a||(a={})).getCenterOfPoints=function(d){let s=d.reduce((f,b)=>(f.x+=b.x,f.y+=b.y,f),{x:0,y:0});return{x:s.x/d.length,y:s.y/d.length}},h.getDistanceBetweenPoints=function(d,s){return Math.sqrt(Math.pow(s.x-d.x,2)+Math.pow(s.y-d.y,2))},h.getAngleBetweenPoints=function(d,s){return Math.atan2(s.x-d.x,s.y-d.y)},h.pointInPolygon=function({x:d,y:s},f){let b=f.length,x,v,g=!1;for(x=0,v=b-1;x<b;v=x++){let[P,_]=f[x],[S,k]=f[v];_>s!=k>s&&d<(S-P)*(s-_)/(k-_)+P&&(g=!g)}return g},a}),c(t,"Extensions/OverlappingDataLabels.js",[t["Core/Geometry/GeometryUtilities.js"],t["Core/Utilities.js"]],function(a,h){let{pointInPolygon:d}=a,{addEvent:s,fireEvent:f,objectEach:b,pick:x}=h;function v(_){let S=_.length,k=(Y,X)=>!(X.x>=Y.x+Y.width||X.x+X.width<=Y.x||X.y>=Y.y+Y.height||X.y+X.height<=Y.y),A=(Y,X)=>{for(let Z of Y)if(d({x:Z[0],y:Z[1]},X))return!0;return!1},y,I,D,w,M,z=!1;for(let Y=0;Y<S;Y++)(y=_[Y])&&(y.oldOpacity=y.opacity,y.newOpacity=1,y.absoluteBox=function(X){var Z,j;if(X&&(!X.alignAttr||X.placed)){let V=X.box?0:X.padding||0,$=X.alignAttr||{x:X.attr("x"),y:X.attr("y")},R=X.getBBox();return X.width=R.width,X.height=R.height,{x:$.x+(((Z=X.parentGroup)==null?void 0:Z.translateX)||0)+V,y:$.y+(((j=X.parentGroup)==null?void 0:j.translateY)||0)+V,width:(X.width||0)-2*V,height:(X.height||0)-2*V,polygon:R==null?void 0:R.polygon}}}(y));_.sort((Y,X)=>(X.labelrank||0)-(Y.labelrank||0));for(let Y=0;Y<S;++Y){w=(I=_[Y])&&I.absoluteBox;let X=w==null?void 0:w.polygon;for(let Z=Y+1;Z<S;++Z){M=(D=_[Z])&&D.absoluteBox;let j=!1;if(w&&M&&I!==D&&I.newOpacity!==0&&D.newOpacity!==0&&I.visibility!=="hidden"&&D.visibility!=="hidden"){let V=M.polygon;if(X&&V&&X!==V?A(X,V)&&(j=!0):k(w,M)&&(j=!0),j){let $=I.labelrank<D.labelrank?I:D,R=$.text;$.newOpacity=0,R!=null&&R.element.querySelector("textPath")&&R.hide()}}}}for(let Y of _)g(Y,this)&&(z=!0);z&&f(this,"afterHideAllOverlappingLabels")}function g(_,S){let k,A,y=!1;return _&&(A=_.newOpacity,_.oldOpacity!==A&&(_.hasClass("highcharts-data-label")?(_[A?"removeClass":"addClass"]("highcharts-data-label-hidden"),k=function(){S.styledMode||_.css({pointerEvents:A?"auto":"none"})},y=!0,_[_.isOld?"animate":"attr"]({opacity:A},void 0,k),f(S,"afterHideOverlappingLabel")):_.attr({opacity:A})),_.isOld=!0),y}function P(){var k;let _=this,S=[];for(let A of _.labelCollectors||[])S=S.concat(A());for(let A of _.yAxis||[])A.stacking&&A.options.stackLabels&&!A.options.stackLabels.allowOverlap&&b(A.stacking.stacks,y=>{b(y,I=>{I.label&&S.push(I.label)})});for(let A of _.series||[])if(A.visible&&((k=A.hasDataLabels)!=null&&k.call(A))){let y=I=>{for(let D of I)D.visible&&(D.dataLabels||[]).forEach(w=>{var z;let M=w.options||{};w.labelrank=x(M.labelrank,D.labelrank,(z=D.shapeArgs)==null?void 0:z.height),M.allowOverlap??Number(M.distance)>0?(w.oldOpacity=w.opacity,w.newOpacity=1,g(w,_)):S.push(w)})};y(A.nodes||[]),y(A.points)}this.hideOverlappingLabels(S)}return{compose:function(_){let S=_.prototype;S.hideOverlappingLabels||(S.hideOverlappingLabels=v,s(_,"render",P))}}}),c(t,"Extensions/BorderRadius.js",[t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h,d){let{defaultOptions:s}=a,{noop:f}=h,{addEvent:b,extend:x,isObject:v,merge:g,relativeLength:P}=d,_={radius:0,scope:"stack",where:void 0},S=f,k=f;function A(M,z,Y,X,Z={}){let j=S(M,z,Y,X,Z),{innerR:V=0,r:$=Y,start:R=0,end:L=0}=Z;if(Z.open||!Z.borderRadius)return j;let G=L-R,U=Math.sin(G/2),F=Math.max(Math.min(P(Z.borderRadius||0,$-V),($-V)/2,$*U/(1+U)),0),H=Math.min(F,G/Math.PI*2*V),W=j.length-1;for(;W--;)(function(ne,ue,ie){let oe,Te,ge,we=ne[ue],K=ne[ue+1];if(K[0]==="Z"&&(K=ne[0]),(we[0]==="M"||we[0]==="L")&&K[0]==="A"?(oe=we,Te=K,ge=!0):we[0]==="A"&&(K[0]==="M"||K[0]==="L")&&(oe=K,Te=we),oe&&Te&&Te.params){let Q=Te[1],ae=Te[5],ye=Te.params,{start:J,end:re,cx:ce,cy:pe}=ye,xe=ae?Q-ie:Q+ie,Me=xe?Math.asin(ie/xe):0,_e=ae?Me:-Me,Ce=Math.cos(Me)*xe;ge?(ye.start=J+_e,oe[1]=ce+Ce*Math.cos(J),oe[2]=pe+Ce*Math.sin(J),ne.splice(ue+1,0,["A",ie,ie,0,0,1,ce+Q*Math.cos(ye.start),pe+Q*Math.sin(ye.start)])):(ye.end=re-_e,Te[6]=ce+Q*Math.cos(ye.end),Te[7]=pe+Q*Math.sin(ye.end),ne.splice(ue+1,0,["A",ie,ie,0,0,1,ce+Ce*Math.cos(re),pe+Ce*Math.sin(re)])),Te[4]=Math.abs(ye.end-ye.start)<Math.PI?0:1}})(j,W,W>1?H:F);return j}function y(){var M,z;if(this.options.borderRadius&&!(this.chart.is3d&&this.chart.is3d())){let{options:Y,yAxis:X}=this,Z=Y.stacking==="percent",j=(z=(M=s.plotOptions)==null?void 0:M[this.type])==null?void 0:z.borderRadius,V=I(Y.borderRadius,v(j)?j:{}),$=X.options.reversed;for(let R of this.points){let{shapeArgs:L}=R;if(R.shapeType==="roundedRect"&&L){let{width:G=0,height:U=0,y:F=0}=L,H=F,W=U;if(V.scope==="stack"&&R.stackTotal){let oe=X.translate(Z?100:R.stackTotal,!1,!0,!1,!0),Te=X.translate(Y.threshold||0,!1,!0,!1,!0),ge=this.crispCol(0,Math.min(oe,Te),0,Math.abs(oe-Te));H=ge.y,W=ge.height}let ne=(R.negative?-1:1)*($?-1:1)==-1,ue=V.where;!ue&&this.is("waterfall")&&Math.abs((R.yBottom||0)-(this.translatedThreshold||0))>this.borderWidth&&(ue="all"),ue||(ue="end");let ie=Math.min(P(V.radius,G),G/2,ue==="all"?U/2:1/0)||0;ue==="end"&&(ne&&(H-=ie),W+=ie),x(L,{brBoxHeight:W,brBoxY:H,r:ie})}}}}function I(M,z){return v(M)||(M={radius:M||0}),g(_,z,M)}function D(){let M=I(this.options.borderRadius);for(let z of this.points){let Y=z.shapeArgs;Y&&(Y.borderRadius=P(M.radius,(Y.r||0)-(Y.innerR||0)))}}function w(M,z,Y,X,Z={}){let j=k(M,z,Y,X,Z),{r:V=0,brBoxHeight:$=X,brBoxY:R=z}=Z,L=z-R,G=R+$-(z+X),U=L-V>-.1?0:V,F=G-V>-.1?0:V,H=Math.max(U&&L,0),W=Math.max(F&&G,0),ne=[M+U,z],ue=[M+Y-U,z],ie=[M+Y,z+U],oe=[M+Y,z+X-F],Te=[M+Y-F,z+X],ge=[M+F,z+X],we=[M,z+X-F],K=[M,z+U],Q=(ae,ye)=>Math.sqrt(Math.pow(ae,2)-Math.pow(ye,2));if(H){let ae=Q(U,U-H);ne[0]-=ae,ue[0]+=ae,ie[1]=K[1]=z+U-H}if(X<U-H){let ae=Q(U,U-H-X);ie[0]=oe[0]=M+Y-U+ae,Te[0]=Math.min(ie[0],Te[0]),ge[0]=Math.max(oe[0],ge[0]),we[0]=K[0]=M+U-ae,ie[1]=K[1]=z+X}if(W){let ae=Q(F,F-W);Te[0]+=ae,ge[0]-=ae,oe[1]=we[1]=z+X-F+W}if(X<F-W){let ae=Q(F,F-W-X);ie[0]=oe[0]=M+Y-F+ae,ue[0]=Math.min(ie[0],ue[0]),ne[0]=Math.max(oe[0],ne[0]),we[0]=K[0]=M+F-ae,oe[1]=we[1]=z}return j.length=0,j.push(["M",...ne],["L",...ue],["A",U,U,0,0,1,...ie],["L",...oe],["A",F,F,0,0,1,...Te],["L",...ge],["A",F,F,0,0,1,...we],["L",...K],["A",U,U,0,0,1,...ne],["Z"]),j}return{compose:function(M,z,Y){let X=M.types.pie;if(!z.symbolCustomAttribs.includes("borderRadius")){let Z=Y.prototype.symbols;b(M,"afterColumnTranslate",y,{order:9}),b(X,"afterTranslate",D),z.symbolCustomAttribs.push("borderRadius","brBoxHeight","brBoxY"),S=Z.arc,k=Z.roundedRect,Z.arc=A,Z.roundedRect=w}},optionsToObject:I}}),c(t,"Core/Responsive.js",[t["Core/Utilities.js"]],function(a){var h;let{diffObjects:d,extend:s,find:f,merge:b,pick:x,uniqueKey:v}=a;return function(g){function P(S,k){let A=S.condition;(A.callback||function(){return this.chartWidth<=x(A.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=x(A.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=x(A.minWidth,0)&&this.chartHeight>=x(A.minHeight,0)}).call(this)&&k.push(S._id)}function _(S,k){let A=this.options.responsive,y=this.currentResponsive,I=[],D;!k&&A&&A.rules&&A.rules.forEach(z=>{z._id===void 0&&(z._id=v()),this.matchResponsiveRule(z,I)},this);let w=b(...I.map(z=>f((A||{}).rules||[],Y=>Y._id===z)).map(z=>z&&z.chartOptions));w.isResponsiveOptions=!0,I=I.toString()||void 0;let M=y&&y.ruleIds;I===M||(y&&(this.currentResponsive=void 0,this.updatingResponsive=!0,this.update(y.undoOptions,S,!0),this.updatingResponsive=!1),I?((D=d(w,this.options,!0,this.collectionsWithUpdate)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:I,mergedOptions:w,undoOptions:D},this.updatingResponsive||this.update(w,S,!0)):this.currentResponsive=void 0)}g.compose=function(S){let k=S.prototype;return k.matchResponsiveRule||s(k,{matchResponsiveRule:P,setResponsive:_}),S}}(h||(h={})),h}),c(t,"masters/highcharts.src.js",[t["Core/Globals.js"],t["Core/Utilities.js"],t["Core/Defaults.js"],t["Core/Animation/Fx.js"],t["Core/Animation/AnimationUtilities.js"],t["Core/Renderer/HTML/AST.js"],t["Core/Templating.js"],t["Core/Renderer/RendererRegistry.js"],t["Core/Renderer/RendererUtilities.js"],t["Core/Renderer/SVG/SVGElement.js"],t["Core/Renderer/SVG/SVGRenderer.js"],t["Core/Renderer/HTML/HTMLElement.js"],t["Core/Axis/Axis.js"],t["Core/Axis/DateTimeAxis.js"],t["Core/Axis/LogarithmicAxis.js"],t["Core/Axis/PlotLineOrBand/PlotLineOrBand.js"],t["Core/Axis/Tick.js"],t["Core/Tooltip.js"],t["Core/Series/Point.js"],t["Core/Pointer.js"],t["Core/Legend/Legend.js"],t["Core/Legend/LegendSymbol.js"],t["Core/Chart/Chart.js"],t["Extensions/ScrollablePlotArea.js"],t["Core/Axis/Stacking/StackingAxis.js"],t["Core/Axis/Stacking/StackItem.js"],t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Series/Column/ColumnDataLabel.js"],t["Series/Pie/PieDataLabel.js"],t["Core/Series/DataLabel.js"],t["Extensions/OverlappingDataLabels.js"],t["Extensions/BorderRadius.js"],t["Core/Responsive.js"],t["Core/Color/Color.js"],t["Core/Time.js"]],function(a,h,d,s,f,b,x,v,g,P,_,S,k,A,y,I,D,w,M,z,Y,X,Z,j,V,$,R,L,G,U,F,H,W,ne,ue,ie){return a.AST=b,a.Axis=k,a.Chart=Z,a.Color=ue,a.DataLabel=F,a.Fx=s,a.HTMLElement=S,a.Legend=Y,a.LegendSymbol=X,a.OverlappingDataLabels=a.OverlappingDataLabels||H,a.PlotLineOrBand=I,a.Point=M,a.Pointer=z,a.RendererRegistry=v,a.Series=R,a.SeriesRegistry=L,a.StackItem=$,a.SVGElement=P,a.SVGRenderer=_,a.Templating=x,a.Tick=D,a.Time=ie,a.Tooltip=w,a.animate=f.animate,a.animObject=f.animObject,a.chart=Z.chart,a.color=ue.parse,a.dateFormat=x.dateFormat,a.defaultOptions=d.defaultOptions,a.distribute=g.distribute,a.format=x.format,a.getDeferredAnimation=f.getDeferredAnimation,a.getOptions=d.getOptions,a.numberFormat=x.numberFormat,a.seriesType=L.seriesType,a.setAnimation=f.setAnimation,a.setOptions=d.setOptions,a.stop=f.stop,a.time=d.defaultTime,a.timers=s.timers,W.compose(a.Series,a.SVGElement,a.SVGRenderer),G.compose(a.Series.types.column),F.compose(a.Series),A.compose(a.Axis),S.compose(a.SVGRenderer),Y.compose(a.Chart),y.compose(a.Axis),H.compose(a.Chart),U.compose(a.Series.types.pie),I.compose(a.Chart,a.Axis),z.compose(a.Chart),ne.compose(a.Chart),j.compose(a.Axis,a.Chart,a.Series),V.compose(a.Axis,a.Chart,a.Series),w.compose(a.Pointer),h.extend(a,h),a}),t["masters/highcharts.src.js"]._modules=t,t["masters/highcharts.src.js"]})})(Ew);var O3=Ew.exports;const kc=jh(O3);var Cw={exports:{}};(function(n){(function(e){n.exports?(e.default=e,n.exports=e):e(typeof Highcharts<"u"?Highcharts:void 0)})(function(e){var t=e?e._modules:{};function c(a,h,d,s){a.hasOwnProperty(h)||(a[h]=s.apply(null,d),typeof CustomEvent=="function"&&e.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:h,module:a[h]}})))}c(t,"Accessibility/Utils/HTMLUtilities.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h){let{doc:d,win:s}=a,{css:f}=h,b=s.EventTarget&&new s.EventTarget||"none";function x(g){if(typeof s.MouseEvent=="function")return new s.MouseEvent(g.type,g);if(d.createEvent){let P=d.createEvent("MouseEvent");if(P.initMouseEvent)return P.initMouseEvent(g.type,g.bubbles,g.cancelable,g.view||s,g.detail,g.screenX,g.screenY,g.clientX,g.clientY,g.ctrlKey,g.altKey,g.shiftKey,g.metaKey,g.button,g.relatedTarget),P}return v(g.type)}function v(g,P,_){let S=P||{x:0,y:0};if(typeof s.MouseEvent=="function")return new s.MouseEvent(g,{bubbles:!0,cancelable:!0,composed:!0,button:0,buttons:1,relatedTarget:_||b,view:s,detail:g==="click"?1:0,screenX:S.x,screenY:S.y,clientX:S.x,clientY:S.y});if(d.createEvent){let k=d.createEvent("MouseEvent");if(k.initMouseEvent)return k.initMouseEvent(g,!0,!0,s,g==="click"?1:0,S.x,S.y,S.x,S.y,!1,!1,!1,!1,0,null),k}return{type:g}}return{addClass:function(g,P){g.classList?g.classList.add(P):0>g.className.indexOf(P)&&(g.className+=" "+P)},cloneMouseEvent:x,cloneTouchEvent:function(g){let P=S=>{let k=[];for(let A=0;A<S.length;++A){let y=S.item(A);y&&k.push(y)}return k};if(typeof s.TouchEvent=="function"){let S=new s.TouchEvent(g.type,{touches:P(g.touches),targetTouches:P(g.targetTouches),changedTouches:P(g.changedTouches),ctrlKey:g.ctrlKey,shiftKey:g.shiftKey,altKey:g.altKey,metaKey:g.metaKey,bubbles:g.bubbles,cancelable:g.cancelable,composed:g.composed,detail:g.detail,view:g.view});return g.defaultPrevented&&S.preventDefault(),S}let _=x(g);return _.touches=g.touches,_.changedTouches=g.changedTouches,_.targetTouches=g.targetTouches,_},escapeStringForHTML:function(g){return g.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},getElement:function(g){return d.getElementById(g)},getFakeMouseEvent:v,getHeadingTagNameForElement:function(g){let P=A=>"h"+Math.min(6,parseInt(A.slice(1),10)+1),_=A=>/^H[1-6]$/i.test(A),S=A=>{let y=A;for(;y=y.previousSibling;){let I=y.tagName||"";if(_(I))return I}return""},k=A=>{let y=S(A);if(y)return P(y);let I=A.parentElement;if(!I)return"p";let D=I.tagName;return _(D)?P(D):k(I)};return k(g)},removeChildNodes:function(g){for(;g.lastChild;)g.removeChild(g.lastChild)},removeClass:function(g,P){g.classList?g.classList.remove(P):g.className=g.className.replace(RegExp(P,"g"),"")},removeElement:function(g){g&&g.parentNode&&g.parentNode.removeChild(g)},reverseChildNodes:function(g){let P=g.childNodes.length;for(;P--;)g.appendChild(g.childNodes[P])},simulatedEventTarget:b,stripHTMLTagsFromString:function(g,P=!1){return typeof g=="string"?P?g.replace(/<\/?[^>]+(>|$)/g,""):g.replace(/<\/?(?!\s)[^>]+(>|$)/g,""):g},visuallyHideElement:function(g){f(g,{position:"absolute",width:"1px",height:"1px",overflow:"hidden",whiteSpace:"nowrap",clip:"rect(1px, 1px, 1px, 1px)",marginTop:"-3px","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=1)",filter:"alpha(opacity=1)",opacity:.01})}}}),c(t,"Accessibility/A11yI18n.js",[t["Core/Templating.js"],t["Core/Utilities.js"]],function(a,h){var d;let{format:s}=a,{getNestedProperty:f,pick:b}=h;return function(x){function v(P,_,S){let k=(w,M)=>{let z=w.slice(M||0),Y=z.indexOf("{"),X=z.indexOf("}");if(Y>-1&&X>Y)return{statement:z.substring(Y+1,X),begin:M+Y+1,end:M+X}},A=[],y,I,D=0;do y=k(P,D),(I=P.substring(D,y&&y.begin-1)).length&&A.push({value:I,type:"constant"}),y&&A.push({value:y.statement,type:"statement"}),D=y?y.end+1:D+1;while(y);return A.forEach(w=>{w.type==="statement"&&(w.value=function(M,z){let Y,X,Z=M.indexOf("#each("),j=M.indexOf("#plural("),V=M.indexOf("["),$=M.indexOf("]");if(Z>-1){let L=M.slice(Z).indexOf(")")+Z,G=M.substring(0,Z),U=M.substring(L+1),F=M.substring(Z+6,L).split(","),H=Number(F[1]),W;if(X="",Y=f(F[0],z)){W=(H=isNaN(H)?Y.length:H)<0?Y.length+H:Math.min(H,Y.length);for(let ne=0;ne<W;++ne)X+=G+Y[ne]+U}return X.length?X:""}if(j>-1){var R;let L=M.slice(j).indexOf(")")+j,G=M.substring(j+8,L).split(",");switch(Number(f(G[0],z))){case 0:X=b(G[4],G[1]);break;case 1:X=b(G[2],G[1]);break;case 2:X=b(G[3],G[1]);break;default:X=G[1]}return X?(R=X).trim&&R.trim()||R.replace(/^\s+|\s+$/g,""):""}if(V>-1){let L,G=M.substring(0,V),U=Number(M.substring(V+1,$));return Y=f(G,z),!isNaN(U)&&Y&&(U<0?(L=Y[Y.length+U])===void 0&&(L=Y[0]):(L=Y[U])===void 0&&(L=Y[Y.length-1])),L!==void 0?L:""}return"{"+M+"}"}(w.value,_))}),s(A.reduce((w,M)=>w+M.value,""),_,S)}function g(P,_){let S=P.split("."),k=this.options.lang,A=0;for(;A<S.length;++A)k=k&&k[S[A]];return typeof k=="string"?v(k,_,this):""}x.compose=function(P){let _=P.prototype;_.langFormat||(_.langFormat=g)},x.i18nFormat=v}(d||(d={})),d}),c(t,"Accessibility/Utils/ChartUtilities.js",[t["Core/Globals.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Core/Utilities.js"]],function(a,h,d){let{doc:s}=a,{stripHTMLTagsFromString:f}=h,{defined:b,find:x,fireEvent:v}=d;function g(_){if(_.points&&_.points.length){let S=x(_.points,k=>!!k.graphic);return S&&S.graphic&&S.graphic.element}}function P(_){let S=g(_);return S&&S.parentNode||_.graph&&_.graph.element||_.group&&_.group.element}return{fireEventOnWrappedOrUnwrappedElement:function _(S,k){let A=k.type,y=S.hcEvents;s.createEvent&&(S.dispatchEvent||S.fireEvent)?S.dispatchEvent?S.dispatchEvent(k):S.fireEvent(A,k):y&&y[A]?v(S,A,k):S.element&&_(S.element,k)},getChartTitle:function(_){return f(_.options.title.text||_.langFormat("accessibility.defaultChartTitle",{chart:_}),_.renderer.forExport)},getAxisDescription:function(_){var S,k;return _&&(((S=_.options.accessibility)==null?void 0:S.description)||((k=_.axisTitle)==null?void 0:k.textStr)||_.options.id||_.categories&&"categories"||_.dateTime&&"Time"||"values")},getAxisRangeDescription:function(_){let S=_.options||{};return S.accessibility&&S.accessibility.rangeDescription!==void 0?S.accessibility.rangeDescription:_.categories?function(k){let A=k.chart;return k.dataMax&&k.dataMin?A.langFormat("accessibility.axis.rangeCategories",{chart:A,axis:k,numCategories:k.dataMax-k.dataMin+1}):""}(_):_.dateTime&&(_.min===0||_.dataMin===0)?function(k){let A=k.chart,y={},I=k.dataMin||k.min||0,D=k.dataMax||k.max||0,w="Seconds";y.Seconds=(D-I)/1e3,y.Minutes=y.Seconds/60,y.Hours=y.Minutes/60,y.Days=y.Hours/24,["Minutes","Hours","Days"].forEach(function(z){y[z]>2&&(w=z)});let M=y[w].toFixed(w!=="Seconds"&&w!=="Minutes"?1:0);return A.langFormat("accessibility.axis.timeRange"+w,{chart:A,axis:k,range:M.replace(".0","")})}(_):function(k){let A=k.chart,y=A.options,I=y&&y.accessibility&&y.accessibility.screenReaderSection.axisRangeDateFormat||"",D={min:k.dataMin||k.min||0,max:k.dataMax||k.max||0},w=function(M){return k.dateTime?A.time.dateFormat(I,D[M]):D[M].toString()};return A.langFormat("accessibility.axis.rangeFromTo",{chart:A,axis:k,rangeFrom:w("min"),rangeTo:w("max")})}(_)},getPointFromXY:function(_,S,k){let A=_.length,y;for(;A--;)if(y=x(_[A].points||[],function(I){return I.x===S&&I.y===k}))return y},getSeriesFirstPointElement:g,getSeriesFromName:function(_,S){return S?(_.series||[]).filter(function(k){return k.name===S}):_.series},getSeriesA11yElement:P,unhideChartElementFromAT:function _(S,k){k.setAttribute("aria-hidden",!1),k!==S.renderTo&&k.parentNode&&k.parentNode!==s.body&&(Array.prototype.forEach.call(k.parentNode.childNodes,function(A){A.hasAttribute("aria-hidden")||A.setAttribute("aria-hidden",!0)}),_(S,k.parentNode))},hideSeriesFromAT:function(_){let S=P(_);S&&S.setAttribute("aria-hidden",!0)},scrollAxisToPoint:function(_){let S=_.series.xAxis,k=_.series.yAxis,A=S&&S.scrollbar?S:k,y=A&&A.scrollbar;if(y&&b(y.to)&&b(y.from)){let I=y.to-y.from,D=function(w,M){if(!b(w.dataMin)||!b(w.dataMax))return 0;let z=w.toPixels(w.dataMin),Y=w.toPixels(w.dataMax),X=w.coll==="xAxis"?"x":"y";return(w.toPixels(M[X]||0)-z)/(Y-z)}(A,_);y.updatePosition(D-I/2,D+I/2),v(y,"changed",{from:y.from,to:y.to,trigger:"scrollbar",DOMEvent:null})}}}}),c(t,"Accessibility/Utils/DOMElementProvider.js",[t["Core/Globals.js"],t["Accessibility/Utils/HTMLUtilities.js"]],function(a,h){let{doc:d}=a,{removeElement:s}=h;return class{constructor(){this.elements=[]}createElement(){let f=d.createElement.apply(d,arguments);return this.elements.push(f),f}removeElement(f){s(f),this.elements.splice(this.elements.indexOf(f),1)}destroyCreatedElements(){this.elements.forEach(function(f){s(f)}),this.elements=[]}}}),c(t,"Accessibility/Utils/EventProvider.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h){let{addEvent:d}=h;return class{constructor(){this.eventRemovers=[]}addEvent(){let s=d.apply(a,arguments);return this.eventRemovers.push({element:arguments[0],remover:s}),s}removeEvent(s){let f=this.eventRemovers.map(b=>b.remover).indexOf(s);this.eventRemovers[f].remover(),this.eventRemovers.splice(f,1)}removeAddedEvents(){this.eventRemovers.map(s=>s.remover).forEach(s=>s()),this.eventRemovers=[]}}}),c(t,"Accessibility/AccessibilityComponent.js",[t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/DOMElementProvider.js"],t["Accessibility/Utils/EventProvider.js"],t["Accessibility/Utils/HTMLUtilities.js"]],function(a,h,d,s){let{fireEventOnWrappedOrUnwrappedElement:f}=a,{getFakeMouseEvent:b}=s;return class{destroy(){}getKeyboardNavigation(){return[]}init(){}onChartRender(){}onChartUpdate(){}initBase(x,v){this.chart=x,this.eventProvider=new d,this.domElementProvider=new h,this.proxyProvider=v,this.keyCodes={left:37,right:39,up:38,down:40,enter:13,space:32,esc:27,tab:9,pageUp:33,pageDown:34,end:35,home:36}}addEvent(x,v,g,P){return this.eventProvider.addEvent(x,v,g,P)}createElement(x,v){return this.domElementProvider.createElement(x,v)}fakeClickEvent(x){f(x,b("click"))}destroyBase(){this.domElementProvider.destroyCreatedElements(),this.eventProvider.removeAddedEvents()}}}),c(t,"Accessibility/KeyboardNavigationHandler.js",[t["Core/Utilities.js"]],function(a){let{find:h}=a;return class{constructor(d,s){this.chart=d,this.keyCodeMap=s.keyCodeMap||[],this.validate=s.validate,this.init=s.init,this.terminate=s.terminate,this.response={success:1,prev:2,next:3,noHandler:4,fail:5}}run(d){let s=d.which||d.keyCode,f=this.response.noHandler,b=h(this.keyCodeMap,function(x){return x[0].indexOf(s)>-1});return b?f=b[1].call(this,s,d):s===9&&(f=this.response[d.shiftKey?"prev":"next"]),f}}}),c(t,"Accessibility/Components/ContainerComponent.js",[t["Accessibility/AccessibilityComponent.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Core/Globals.js"],t["Accessibility/Utils/HTMLUtilities.js"]],function(a,h,d,s,f){let{unhideChartElementFromAT:b,getChartTitle:x}=d,{doc:v}=s,{stripHTMLTagsFromString:g}=f;return class extends a{onChartUpdate(){this.handleSVGTitleElement(),this.setSVGContainerLabel(),this.setGraphicContainerAttrs(),this.setRenderToAttrs(),this.makeCreditsAccessible()}handleSVGTitleElement(){let P=this.chart,_="highcharts-title-"+P.index,S=g(P.langFormat("accessibility.svgContainerTitle",{chartTitle:x(P)}));if(S.length){let k=this.svgTitleElement=this.svgTitleElement||v.createElementNS("http://www.w3.org/2000/svg","title");k.textContent=S,k.id=_,P.renderTo.insertBefore(k,P.renderTo.firstChild)}}setSVGContainerLabel(){let P=this.chart,_=P.langFormat("accessibility.svgContainerLabel",{chartTitle:x(P)});P.renderer.box&&_.length&&P.renderer.box.setAttribute("aria-label",_)}setGraphicContainerAttrs(){let P=this.chart,_=P.langFormat("accessibility.graphicContainerLabel",{chartTitle:x(P)});_.length&&P.container.setAttribute("aria-label",_)}setRenderToAttrs(){let P=this.chart,_=P.options.accessibility.landmarkVerbosity!=="disabled",S=P.langFormat("accessibility.chartContainerLabel",{title:x(P),chart:P});S&&(P.renderTo.setAttribute("role",_?"region":"group"),P.renderTo.setAttribute("aria-label",S))}makeCreditsAccessible(){let P=this.chart,_=P.credits;_&&(_.textStr&&_.element.setAttribute("aria-label",P.langFormat("accessibility.credits",{creditsStr:g(_.textStr,P.renderer.forExport)})),b(P,_.element))}getKeyboardNavigation(){let P=this.chart;return new h(P,{keyCodeMap:[],validate:function(){return!0},init:function(){let _=P.accessibility;_&&_.keyboardNavigation.tabindexContainer.focus()}})}destroy(){this.chart.renderTo.setAttribute("aria-hidden",!0)}}}),c(t,"Accessibility/FocusBorder.js",[t["Core/Utilities.js"]],function(a){var h;let{addEvent:d,pick:s}=a;return function(f){let b=["x","y","transform","width","height","r","d","stroke-width"];function x(){let _=this.focusElement,S=this.options.accessibility.keyboardNavigation.focusBorder;_&&(_.removeFocusBorder(),S.enabled&&_.addFocusBorder(S.margin,{stroke:S.style.color,strokeWidth:S.style.lineWidth,r:S.style.borderRadius}))}function v(_,S){let k=this.options.accessibility.keyboardNavigation.focusBorder,A=S||_.element;A&&A.focus&&(A.hcEvents&&A.hcEvents.focusin||d(A,"focusin",function(){}),A.focus(),k.hideBrowserFocusOutline&&(A.style.outline="none")),this.focusElement&&this.focusElement.removeFocusBorder(),this.focusElement=_,this.renderFocusBorder()}function g(_,S){this.focusBorder&&this.removeFocusBorder();let k=this.getBBox(),A=s(_,3),y=this.parentGroup,I=this.scaleX||y&&y.scaleX,D=this.scaleY||y&&y.scaleY,w=(I?!D:D)?Math.abs(I||D||1):(Math.abs(I||1)+Math.abs(D||1))/2;k.x+=this.translateX?this.translateX:0,k.y+=this.translateY?this.translateY:0;let M=k.x-A,z=k.y-A,Y=k.width+2*A,X=k.height+2*A,Z=!!this.text;if(this.element.nodeName==="text"||Z){let j,V,$=!!this.rotation,R=Z?{x:$?1:0,y:0}:(j=0,V=0,this.attr("text-anchor")==="middle"?j=V=.5:this.rotation?j=.25:V=.75,{x:j,y:V}),L=+this.attr("x"),G=+this.attr("y");if(isNaN(L)||(M=L-k.width*R.x-A),isNaN(G)||(z=G-k.height*R.y-A),Z&&$){let U=Y;Y=X,X=U,isNaN(L)||(M=L-k.height*R.x-A),isNaN(G)||(z=G-k.width*R.y-A)}}this.focusBorder=this.renderer.rect(M,z,Y,X,parseInt((S&&S.r||0).toString(),10)/w).addClass("highcharts-focus-border").attr({zIndex:99}).add(y),this.renderer.styledMode||this.focusBorder.attr({stroke:S&&S.stroke,"stroke-width":(S&&S.strokeWidth||0)/w}),function(j,...V){j.focusBorderUpdateHooks||(j.focusBorderUpdateHooks={},b.forEach($=>{let R=$+"Setter",L=j[R]||j._defaultSetter;j.focusBorderUpdateHooks[R]=L,j[R]=function(){let G=L.apply(j,arguments);return j.addFocusBorder.apply(j,V),G}}))}(this,_,S),function(j){if(j.focusBorderDestroyHook)return;let V=j.destroy;j.destroy=function(){return j.focusBorder&&j.focusBorder.destroy&&j.focusBorder.destroy(),V.apply(j,arguments)},j.focusBorderDestroyHook=V}(this)}function P(){var _;_=this,_.focusBorderUpdateHooks&&(Object.keys(_.focusBorderUpdateHooks).forEach(S=>{let k=_.focusBorderUpdateHooks[S];k===_._defaultSetter?delete _[S]:_[S]=k}),delete _.focusBorderUpdateHooks),this.focusBorderDestroyHook&&(this.destroy=this.focusBorderDestroyHook,delete this.focusBorderDestroyHook),this.focusBorder&&(this.focusBorder.destroy(),delete this.focusBorder)}f.compose=function(_,S){let k=_.prototype,A=S.prototype;k.renderFocusBorder||(k.renderFocusBorder=x,k.setFocusToElement=v),A.addFocusBorder||(A.addFocusBorder=g,A.removeFocusBorder=P)}}(h||(h={})),h}),c(t,"Accessibility/Utils/Announcer.js",[t["Core/Renderer/HTML/AST.js"],t["Accessibility/Utils/DOMElementProvider.js"],t["Core/Globals.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Core/Utilities.js"]],function(a,h,d,s,f){let{doc:b}=d,{addClass:x,visuallyHideElement:v}=s,{attr:g}=f;return class{constructor(P,_){this.chart=P,this.domElementProvider=new h,this.announceRegion=this.addAnnounceRegion(_)}destroy(){this.domElementProvider.destroyCreatedElements()}announce(P){a.setElementHTML(this.announceRegion,P),this.clearAnnouncementRegionTimer&&clearTimeout(this.clearAnnouncementRegionTimer),this.clearAnnouncementRegionTimer=setTimeout(()=>{this.announceRegion.innerHTML=a.emptyHTML,delete this.clearAnnouncementRegionTimer},3e3)}addAnnounceRegion(P){let _=this.chart.announcerContainer||this.createAnnouncerContainer(),S=this.domElementProvider.createElement("div");return g(S,{"aria-hidden":!1,"aria-live":P,"aria-atomic":!0}),this.chart.styledMode?x(S,"highcharts-visually-hidden"):v(S),_.appendChild(S),S}createAnnouncerContainer(){let P=this.chart,_=b.createElement("div");return g(_,{"aria-hidden":!1,class:"highcharts-announcer-container"}),_.style.position="relative",P.renderTo.insertBefore(_,P.renderTo.firstChild),P.announcerContainer=_,_}}}),c(t,"Accessibility/Components/AnnotationsA11y.js",[t["Accessibility/Utils/HTMLUtilities.js"]],function(a){let{escapeStringForHTML:h,stripHTMLTagsFromString:d}=a;function s(v){return(v.annotations||[]).reduce((g,P)=>(P.options&&P.options.visible!==!1&&(g=g.concat(P.labels)),g),[])}function f(v){return v.options&&v.options.accessibility&&v.options.accessibility.description||v.graphic&&v.graphic.text&&v.graphic.text.textStr||""}function b(v){let g=v.options&&v.options.accessibility&&v.options.accessibility.description;if(g)return g;let P=v.chart,_=f(v),S=v.points,k=w=>w.graphic&&w.graphic.element&&w.graphic.element.getAttribute("aria-label")||"",A=S.filter(w=>!!w.graphic).map(w=>{let M=w.accessibility&&w.accessibility.valueDescription||k(w),z=w&&w.series.name||"";return(z?z+", ":"")+"data point "+M}).filter(w=>!!w),y=A.length,I=y>1?"MultiplePoints":y?"SinglePoint":"NoPoints",D={annotationText:_,annotation:v,numPoints:y,annotationPoint:A[0],additionalAnnotationPoints:A.slice(1)};return P.langFormat("accessibility.screenReaderSection.annotations.description"+I,D)}function x(v){return s(v).map(g=>{let P=h(d(b(g),v.renderer.forExport));return P?`<li>${P}</li>`:""})}return{getAnnotationsInfoHTML:function(v){let g=v.annotations;return g&&g.length?`<ul style="list-style-type: none">${x(v).join(" ")}</ul>`:""},getAnnotationLabelDescription:b,getAnnotationListItems:x,getPointAnnotationTexts:function(v){let g=s(v.series.chart).filter(P=>P.points.indexOf(v)>-1);return g.length?g.map(P=>`${f(P)}`):[]}}}),c(t,"Accessibility/Components/InfoRegionsComponent.js",[t["Accessibility/A11yI18n.js"],t["Accessibility/AccessibilityComponent.js"],t["Accessibility/Utils/Announcer.js"],t["Accessibility/Components/AnnotationsA11y.js"],t["Core/Renderer/HTML/AST.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Core/Templating.js"],t["Core/Globals.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b,x,v,g,P){let{getAnnotationsInfoHTML:_}=s,{getAxisDescription:S,getAxisRangeDescription:k,getChartTitle:A,unhideChartElementFromAT:y}=b,{format:I}=x,{doc:D}=v,{addClass:w,getElement:M,getHeadingTagNameForElement:z,stripHTMLTagsFromString:Y,visuallyHideElement:X}=g,{attr:Z,pick:j,replaceNested:V}=P;function $(R){return V(R,[/<([\w\-.:!]+)\b[^<>]*>\s*<\/\1>/g,""])}return class extends h{constructor(){super(...arguments),this.screenReaderSections={}}init(){let R=this.chart,L=this;this.initRegionsDefinitions(),this.addEvent(R,"aftergetTableAST",function(G){L.onDataTableCreated(G)}),this.addEvent(R,"afterViewData",function(G){G.wasHidden&&(L.dataTableDiv=G.element,setTimeout(function(){L.focusDataTable()},300))}),this.addEvent(R,"afterHideData",function(){L.viewDataTableButton&&L.viewDataTableButton.setAttribute("aria-expanded","false")}),R.exporting&&this.addEvent(R,"afterPrint",function(){L.updateAllScreenReaderSections()}),this.announcer=new d(R,"assertive")}initRegionsDefinitions(){let R=this,L=this.chart.options.accessibility;this.screenReaderSections={before:{element:null,buildContent:function(G){let U=L.screenReaderSection.beforeChartFormatter;return U?U(G):R.defaultBeforeChartFormatter(G)},insertIntoDOM:function(G,U){U.renderTo.insertBefore(G,U.renderTo.firstChild)},afterInserted:function(){R.sonifyButtonId!==void 0&&R.initSonifyButton(R.sonifyButtonId),R.dataTableButtonId!==void 0&&R.initDataTableButton(R.dataTableButtonId)}},after:{element:null,buildContent:function(G){let U=L.screenReaderSection.afterChartFormatter;return U?U(G):R.defaultAfterChartFormatter()},insertIntoDOM:function(G,U){U.renderTo.insertBefore(G,U.container.nextSibling)},afterInserted:function(){R.chart.accessibility&&L.keyboardNavigation.enabled&&R.chart.accessibility.keyboardNavigation.updateExitAnchor()}}}}onChartRender(){this.linkedDescriptionElement=this.getLinkedDescriptionElement(),this.setLinkedDescriptionAttrs(),this.updateAllScreenReaderSections()}updateAllScreenReaderSections(){let R=this;Object.keys(this.screenReaderSections).forEach(function(L){R.updateScreenReaderSection(L)})}getLinkedDescriptionElement(){let R=this.chart.options.accessibility.linkedDescription;if(!R)return;if(typeof R!="string")return R;let L=I(R,this.chart),G=D.querySelectorAll(L);if(G.length===1)return G[0]}setLinkedDescriptionAttrs(){let R=this.linkedDescriptionElement;R&&(R.setAttribute("aria-hidden","true"),w(R,"highcharts-linked-description"))}updateScreenReaderSection(R){let L=this.chart,G=this.screenReaderSections[R],U=G.buildContent(L),F=G.element=G.element||this.createElement("div"),H=F.firstChild||this.createElement("div");U?(this.setScreenReaderSectionAttribs(F,R),f.setElementHTML(H,U),F.appendChild(H),G.insertIntoDOM(F,L),L.styledMode?w(H,"highcharts-visually-hidden"):X(H),y(L,H),G.afterInserted&&G.afterInserted()):(F.parentNode&&F.parentNode.removeChild(F),G.element=null)}setScreenReaderSectionAttribs(R,L){let G=this.chart,U=G.langFormat("accessibility.screenReaderSection."+L+"RegionLabel",{chart:G,chartTitle:A(G)});Z(R,{id:`highcharts-screen-reader-region-${L}-${G.index}`,"aria-label":U||void 0}),R.style.position="relative",U&&R.setAttribute("role",G.options.accessibility.landmarkVerbosity==="all"?"region":"group")}defaultBeforeChartFormatter(){let R=this.chart,L=R.options.accessibility.screenReaderSection.beforeChartFormat;if(!L)return"";let G=this.getAxesDescription(),U=R.sonify&&R.options.sonification&&R.options.sonification.enabled,F="highcharts-a11y-sonify-data-btn-"+R.index,H="hc-linkto-highcharts-data-table-"+R.index,W=_(R),ne=R.langFormat("accessibility.screenReaderSection.annotations.heading",{chart:R}),ue={headingTagName:z(R.renderTo),chartTitle:A(R),typeDescription:this.getTypeDescriptionText(),chartSubtitle:this.getSubtitleText(),chartLongdesc:this.getLongdescText(),xAxisDescription:G.xAxis,yAxisDescription:G.yAxis,playAsSoundButton:U?this.getSonifyButtonText(F):"",viewTableButton:R.getCSV?this.getDataTableButtonText(H):"",annotationsTitle:W?ne:"",annotationsList:W},ie=a.i18nFormat(L,ue,R);return this.dataTableButtonId=H,this.sonifyButtonId=F,$(ie)}defaultAfterChartFormatter(){let R=this.chart,L=R.options.accessibility.screenReaderSection.afterChartFormat;if(!L)return"";let G={endOfChartMarker:this.getEndOfChartMarkerText()};return $(a.i18nFormat(L,G,R))}getLinkedDescription(){let R=this.linkedDescriptionElement;return Y(R&&R.innerHTML||"",this.chart.renderer.forExport)}getLongdescText(){let R=this.chart.options,L=R.caption,G=L&&L.text,U=this.getLinkedDescription();return R.accessibility.description||U||G||""}getTypeDescriptionText(){let R=this.chart;return R.types?R.options.accessibility.typeDescription||function(L,G){let U=G[0],F=L.series&&L.series[0]||{},H=L.mapView&&L.mapView.geoMap&&L.mapView.geoMap.title,W={numSeries:L.series.length,numPoints:F.points&&F.points.length,chart:L,mapTitle:H};return U?U==="map"||U==="tiledwebmap"?W.mapTitle?L.langFormat("accessibility.chartTypes.mapTypeDescription",W):L.langFormat("accessibility.chartTypes.unknownMap",W):L.types.length>1?L.langFormat("accessibility.chartTypes.combinationChart",W):function(ne,ue,ie){let oe=ue[0],Te=ne.langFormat("accessibility.seriesTypeDescriptions."+oe,ie),ge=ne.series&&ne.series.length<2?"Single":"Multiple";return(ne.langFormat("accessibility.chartTypes."+oe+ge,ie)||ne.langFormat("accessibility.chartTypes.default"+ge,ie))+(Te?" "+Te:"")}(L,G,W):L.langFormat("accessibility.chartTypes.emptyChart",W)}(R,R.types):""}getDataTableButtonText(R){let L=this.chart;return'<button id="'+R+'">'+L.langFormat("accessibility.table.viewAsDataTableButtonText",{chart:L,chartTitle:A(L)})+"</button>"}getSonifyButtonText(R){let L=this.chart;return L.options.sonification&&L.options.sonification.enabled===!1?"":'<button id="'+R+'">'+L.langFormat("accessibility.sonification.playAsSoundButtonText",{chart:L,chartTitle:A(L)})+"</button>"}getSubtitleText(){let R=this.chart.options.subtitle;return Y(R&&R.text||"",this.chart.renderer.forExport)}getEndOfChartMarkerText(){let R=M(`highcharts-end-of-chart-marker-${this.chart.index}`);if(R)return R.outerHTML;let L=this.chart,G=L.langFormat("accessibility.screenReaderSection.endOfChartMarker",{chart:L});return'<div id="highcharts-end-of-chart-marker-'+L.index+'">'+G+"</div>"}onDataTableCreated(R){let L=this.chart;if(L.options.accessibility.enabled){this.viewDataTableButton&&this.viewDataTableButton.setAttribute("aria-expanded","true");let G=R.tree.attributes||{};G.tabindex=-1,G.summary=L.langFormat("accessibility.table.tableSummary",{chart:L}),R.tree.attributes=G}}focusDataTable(){let R=this.dataTableDiv,L=R&&R.getElementsByTagName("table")[0];L&&L.focus&&L.focus()}initSonifyButton(R){let L=this.sonifyButton=M(R),G=this.chart,U=F=>{L&&(L.setAttribute("aria-hidden","true"),L.setAttribute("aria-label","")),F.preventDefault(),F.stopPropagation();let H=G.langFormat("accessibility.sonification.playAsSoundClickAnnouncement",{chart:G});this.announcer.announce(H),setTimeout(()=>{L&&(L.removeAttribute("aria-hidden"),L.removeAttribute("aria-label")),G.sonify&&G.sonify()},1e3)};L&&G&&(L.setAttribute("tabindex",-1),L.onclick=function(F){(G.options.accessibility&&G.options.accessibility.screenReaderSection.onPlayAsSoundClick||U).call(this,F,G)})}initDataTableButton(R){let L=this.viewDataTableButton=M(R),G=this.chart,U=R.replace("hc-linkto-","");L&&(Z(L,{tabindex:-1,"aria-expanded":!!M(U)}),L.onclick=G.options.accessibility.screenReaderSection.onViewDataTableClick||function(){G.viewData()})}getAxesDescription(){let R=this.chart,L=function(ne,ue){let ie=R[ne];return ie.length>1||ie[0]&&j(ie[0].options.accessibility&&ie[0].options.accessibility.enabled,ue)},G=!!R.types&&0>R.types.indexOf("map")&&0>R.types.indexOf("treemap")&&0>R.types.indexOf("tilemap"),U=!!R.hasCartesianSeries,F=L("xAxis",!R.angular&&U&&G),H=L("yAxis",U&&G),W={};return F&&(W.xAxis=this.getAxisDescriptionText("xAxis")),H&&(W.yAxis=this.getAxisDescriptionText("yAxis")),W}getAxisDescriptionText(R){let L=this.chart,G=L[R];return L.langFormat("accessibility.axis."+R+"Description"+(G.length>1?"Plural":"Singular"),{chart:L,names:G.map(function(U){return S(U)}),ranges:G.map(function(U){return k(U)}),numAxes:G.length})}destroy(){this.announcer&&this.announcer.destroy()}}}),c(t,"Accessibility/Components/MenuComponent.js",[t["Core/Utilities.js"],t["Accessibility/AccessibilityComponent.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/HTMLUtilities.js"]],function(a,h,d,s,f){let{attr:b}=a,{getChartTitle:x,unhideChartElementFromAT:v}=s,{getFakeMouseEvent:g}=f;function P(S){return S.exportSVGElements&&S.exportSVGElements[0]}class _ extends h{init(){let k=this.chart,A=this;this.addEvent(k,"exportMenuShown",function(){A.onMenuShown()}),this.addEvent(k,"exportMenuHidden",function(){A.onMenuHidden()}),this.createProxyGroup()}onMenuHidden(){let k=this.chart.exportContextMenu;k&&k.setAttribute("aria-hidden","true"),this.setExportButtonExpandedState("false")}onMenuShown(){let k=this.chart,A=k.exportContextMenu;A&&(this.addAccessibleContextMenuAttribs(),v(k,A)),this.setExportButtonExpandedState("true")}setExportButtonExpandedState(k){this.exportButtonProxy&&this.exportButtonProxy.innerElement.setAttribute("aria-expanded",k)}onChartRender(){let k=this.chart,A=k.focusElement,y=k.accessibility;this.proxyProvider.clearGroup("chartMenu"),this.proxyMenuButton(),this.exportButtonProxy&&A&&A===k.exportingGroup&&(A.focusBorder?k.setFocusToElement(A,this.exportButtonProxy.innerElement):y&&y.keyboardNavigation.tabindexContainer.focus())}proxyMenuButton(){let k=this.chart,A=this.proxyProvider,y=P(k);(function(I){let D=I.options.exporting,w=P(I);return!!(D&&D.enabled!==!1&&D.accessibility&&D.accessibility.enabled&&w&&w.element)})(k)&&y&&(this.exportButtonProxy=A.addProxyElement("chartMenu",{click:y},"button",{"aria-label":k.langFormat("accessibility.exporting.menuButtonLabel",{chart:k,chartTitle:x(k)}),"aria-expanded":!1,title:k.options.lang.contextButtonTitle||null}))}createProxyGroup(){this.chart&&this.proxyProvider&&this.proxyProvider.addGroup("chartMenu")}addAccessibleContextMenuAttribs(){let k=this.chart,A=k.exportDivElements;if(A&&A.length){A.forEach(I=>{I&&(I.tagName!=="LI"||I.children&&I.children.length?I.setAttribute("aria-hidden","true"):I.setAttribute("tabindex",-1))});let y=A[0]&&A[0].parentNode;y&&b(y,{"aria-hidden":void 0,"aria-label":k.langFormat("accessibility.exporting.chartMenuLabel",{chart:k}),role:"list"})}}getKeyboardNavigation(){let k=this.keyCodes,A=this.chart,y=this;return new d(A,{keyCodeMap:[[[k.left,k.up],function(){return y.onKbdPrevious(this)}],[[k.right,k.down],function(){return y.onKbdNext(this)}],[[k.enter,k.space],function(){return y.onKbdClick(this)}]],validate:function(){return!!A.exporting&&A.options.exporting.enabled!==!1&&A.options.exporting.accessibility.enabled!==!1},init:function(){let I=y.exportButtonProxy,D=y.chart.exportingGroup;I&&D&&A.setFocusToElement(D,I.innerElement)},terminate:function(){A.hideExportMenu()}})}onKbdPrevious(k){let A=this.chart,y=A.options.accessibility,I=k.response,D=A.highlightedExportItemIx||0;for(;D--;)if(A.highlightExportItem(D))return I.success;return y.keyboardNavigation.wrapAround?(A.highlightLastExportItem(),I.success):I.prev}onKbdNext(k){let A=this.chart,y=A.options.accessibility,I=k.response;for(let D=(A.highlightedExportItemIx||0)+1;D<A.exportDivElements.length;++D)if(A.highlightExportItem(D))return I.success;return y.keyboardNavigation.wrapAround?(A.highlightExportItem(0),I.success):I.next}onKbdClick(k){let A=this.chart,y=A.exportDivElements[A.highlightedExportItemIx],I=P(A).element;return A.openMenu?this.fakeClickEvent(y):(this.fakeClickEvent(I),A.highlightExportItem(0)),k.response.success}}return function(S){function k(){let D=P(this);if(D){let w=D.element;w.onclick&&w.onclick(g("click"))}}function A(){let D=this.exportDivElements;D&&this.exportContextMenu&&this.openMenu&&(D.forEach(w=>{w&&w.className==="highcharts-menu-item"&&w.onmouseout&&w.onmouseout(g("mouseout"))}),this.highlightedExportItemIx=0,this.exportContextMenu.hideMenu(),this.container.focus())}function y(D){let w=this.exportDivElements&&this.exportDivElements[D],M=this.exportDivElements&&this.exportDivElements[this.highlightedExportItemIx];if(w&&w.tagName==="LI"&&!(w.children&&w.children.length)){let z=!!(this.renderTo.getElementsByTagName("g")[0]||{}).focus;return w.focus&&z&&w.focus(),M&&M.onmouseout&&M.onmouseout(g("mouseout")),w.onmouseover&&w.onmouseover(g("mouseover")),this.highlightedExportItemIx=D,!0}return!1}function I(){if(this.exportDivElements){let D=this.exportDivElements.length;for(;D--;)if(this.highlightExportItem(D))return!0}return!1}S.compose=function(D){let w=D.prototype;w.hideExportMenu||(w.hideExportMenu=A,w.highlightExportItem=y,w.highlightLastExportItem=I,w.showExportMenu=k)}}(_),_}),c(t,"Accessibility/KeyboardNavigation.js",[t["Core/Globals.js"],t["Accessibility/Components/MenuComponent.js"],t["Core/Utilities.js"],t["Accessibility/Utils/EventProvider.js"],t["Accessibility/Utils/HTMLUtilities.js"]],function(a,h,d,s,f){let{doc:b,win:x}=a,{addEvent:v,defined:g,fireEvent:P}=d,{getElement:_,simulatedEventTarget:S}=f;class k{constructor(y,I){this.currentModuleIx=NaN,this.modules=[],this.init(y,I)}init(y,I){let D=this.eventProvider=new s;this.chart=y,this.components=I,this.modules=[],this.currentModuleIx=0,this.update(),D.addEvent(this.tabindexContainer,"keydown",w=>this.onKeydown(w)),D.addEvent(this.tabindexContainer,"focus",w=>this.onFocus(w)),["mouseup","touchend"].forEach(w=>D.addEvent(b,w,M=>this.onMouseUp(M))),["mousedown","touchstart"].forEach(w=>D.addEvent(y.renderTo,w,()=>{this.isClickingChart=!0}))}update(y){let I=this.chart.options.accessibility,D=I&&I.keyboardNavigation,w=this.components;this.updateContainerTabindex(),D&&D.enabled&&y&&y.length?(this.modules=y.reduce(function(M,z){let Y=w[z].getKeyboardNavigation();return M.concat(Y)},[]),this.updateExitAnchor()):(this.modules=[],this.currentModuleIx=0,this.removeExitAnchor())}updateExitAnchor(){let y=_(`highcharts-end-of-chart-marker-${this.chart.index}`);this.removeExitAnchor(),y?(this.makeElementAnExitAnchor(y),this.exitAnchor=y):this.createExitAnchor()}move(y){let I=this.modules&&this.modules[this.currentModuleIx];I&&I.terminate&&I.terminate(y),this.chart.focusElement&&this.chart.focusElement.removeFocusBorder(),this.currentModuleIx+=y;let D=this.modules&&this.modules[this.currentModuleIx];if(D){if(D.validate&&!D.validate())return this.move(y);if(D.init)return D.init(y),!0}return this.currentModuleIx=0,this.exiting=!0,y>0?this.exitAnchor&&this.exitAnchor.focus():this.tabindexContainer.focus(),!1}onFocus(y){let I=this.chart,D=y.relatedTarget&&I.container.contains(y.relatedTarget),w=I.options.accessibility,M=w&&w.keyboardNavigation;if(M&&M.enabled&&!this.exiting&&!this.tabbingInBackwards&&!this.isClickingChart&&!D){let z=this.getFirstValidModuleIx();z!==null&&(this.currentModuleIx=z,this.modules[z].init(1))}this.keyboardReset=!1,this.exiting=!1}onMouseUp(y){if(delete this.isClickingChart,!this.keyboardReset&&y.relatedTarget!==S){let I=this.chart;if(!y.target||!I.container.contains(y.target)){let D=this.modules&&this.modules[this.currentModuleIx||0];D&&D.terminate&&D.terminate(),this.currentModuleIx=0}I.focusElement&&(I.focusElement.removeFocusBorder(),delete I.focusElement),this.keyboardReset=!0}}onKeydown(y){let I,D=y||x.event,w=this.modules&&this.modules.length&&this.modules[this.currentModuleIx],M=D.target;if((!M||M.nodeName!=="INPUT"||M.classList.contains("highcharts-a11y-proxy-element"))&&(this.keyboardReset=!1,this.exiting=!1,w)){let z=w.run(D);z===w.response.success?I=!0:z===w.response.prev?I=this.move(-1):z===w.response.next&&(I=this.move(1)),I&&(D.preventDefault(),D.stopPropagation())}}updateContainerTabindex(){let y,I=this.chart.options.accessibility,D=I&&I.keyboardNavigation,w=!(D&&D.enabled===!1),M=this.chart,z=M.container;M.renderTo.hasAttribute("tabindex")?(z.removeAttribute("tabindex"),y=M.renderTo):y=z,this.tabindexContainer=y;let Y=y.getAttribute("tabindex");w&&!Y?y.setAttribute("tabindex","0"):w||M.container.removeAttribute("tabindex")}createExitAnchor(){let y=this.chart,I=this.exitAnchor=b.createElement("div");y.renderTo.appendChild(I),this.makeElementAnExitAnchor(I)}makeElementAnExitAnchor(y){let I=this.tabindexContainer.getAttribute("tabindex")||0;y.setAttribute("class","highcharts-exit-anchor"),y.setAttribute("tabindex",I),y.setAttribute("aria-hidden",!1),this.addExitAnchorEventsToEl(y)}removeExitAnchor(){if(this.exitAnchor){let y=this.eventProvider.eventRemovers.find(I=>I.element===this.exitAnchor);y&&g(y.remover)&&this.eventProvider.removeEvent(y.remover),this.exitAnchor.parentNode&&this.exitAnchor.parentNode.removeChild(this.exitAnchor),delete this.exitAnchor}}addExitAnchorEventsToEl(y){let I=this.chart,D=this;this.eventProvider.addEvent(y,"focus",function(w){let M=w||x.event,z=!(M.relatedTarget&&I.container.contains(M.relatedTarget)||D.exiting);if(I.focusElement&&delete I.focusElement,z){if(D.tabbingInBackwards=!0,D.tabindexContainer.focus(),delete D.tabbingInBackwards,M.preventDefault(),D.modules&&D.modules.length){D.currentModuleIx=D.modules.length-1;let Y=D.modules[D.currentModuleIx];Y&&Y.validate&&!Y.validate()?D.move(-1):Y&&Y.init(-1)}}else D.exiting=!1})}getFirstValidModuleIx(){let y=this.modules.length;for(let I=0;I<y;++I){let D=this.modules[I];if(!D.validate||D.validate())return I}return null}destroy(){this.removeExitAnchor(),this.eventProvider.removeAddedEvents(),this.chart.container.removeAttribute("tabindex")}}return function(A){function y(){let D=this;P(this,"dismissPopupContent",{},function(){D.tooltip&&D.tooltip.hide(0),D.hideExportMenu()})}function I(D){(D.which||D.keyCode)===27&&a.charts&&a.charts.forEach(w=>{w&&w.dismissPopupContent&&w.dismissPopupContent()})}A.compose=function(D){h.compose(D);let w=D.prototype;return w.dismissPopupContent||(w.dismissPopupContent=y,v(b,"keydown",I)),D}}(k),k}),c(t,"Accessibility/Components/LegendComponent.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Globals.js"],t["Core/Legend/Legend.js"],t["Core/Utilities.js"],t["Accessibility/AccessibilityComponent.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/HTMLUtilities.js"]],function(a,h,d,s,f,b,x,v){let{animObject:g}=a,{doc:P}=h,{addEvent:_,fireEvent:S,isNumber:k,pick:A,syncTimeout:y}=s,{getChartTitle:I}=x,{stripHTMLTagsFromString:D,addClass:w,removeClass:M}=v;function z(Z){let j=Z.legend&&Z.legend.allItems,V=Z.options.legend.accessibility||{},$=Z.colorAxis&&Z.colorAxis.some(R=>!R.dataClasses||!R.dataClasses.length);return!!(j&&j.length&&!$&&V.enabled!==!1)}function Y(Z,j){let V=j.legendItem||{};for(let $ of(j.setState(Z?"hover":"",!0),["group","label","symbol"])){let R=V[$],L=R&&R.element||R;L&&S(L,Z?"mouseover":"mouseout")}}class X extends f{constructor(){super(...arguments),this.highlightedLegendItemIx=NaN,this.proxyGroup=null}init(){let j=this;this.recreateProxies(),this.addEvent(d,"afterScroll",function(){this.chart===j.chart&&(j.proxyProvider.updateGroupProxyElementPositions("legend"),j.updateLegendItemProxyVisibility(),j.highlightedLegendItemIx>-1&&this.chart.highlightLegendItem(j.highlightedLegendItemIx))}),this.addEvent(d,"afterPositionItem",function(V){this.chart===j.chart&&this.chart.renderer&&j.updateProxyPositionForItem(V.item)}),this.addEvent(d,"afterRender",function(){this.chart===j.chart&&this.chart.renderer&&j.recreateProxies()&&y(()=>j.proxyProvider.updateGroupProxyElementPositions("legend"),g(A(this.chart.renderer.globalAnimation,!0)).duration)})}updateLegendItemProxyVisibility(){let j,V=this.chart,$=V.legend,R=$.allItems||[],L=$.currentPage||1,G=$.clipHeight||0;R.forEach(U=>{if(U.a11yProxyElement){let F=$.pages&&$.pages.length,H=U.a11yProxyElement.element,W=!1;if(j=U.legendItem||{},F){let ne=j.pageIx||0;W=(j.y||0)+(j.label?Math.round(j.label.getBBox().height):0)-$.pages[ne]>G||ne!==L-1}W?V.styledMode?w(H,"highcharts-a11y-invisible"):H.style.visibility="hidden":(M(H,"highcharts-a11y-invisible"),H.style.visibility="")}})}onChartRender(){z(this.chart)||this.removeProxies()}highlightAdjacentLegendPage(j){let V=this.chart,$=V.legend,R=($.currentPage||1)+j,L=$.pages||[];if(R>0&&R<=L.length){let G=0;for(let U of $.allItems)((U.legendItem||{}).pageIx||0)+1===R&&V.highlightLegendItem(G)&&(this.highlightedLegendItemIx=G),++G}}updateProxyPositionForItem(j){j.a11yProxyElement&&j.a11yProxyElement.refreshPosition()}recreateProxies(){let j=P.activeElement,V=this.proxyGroup,$=j&&V&&V.contains(j);return this.removeProxies(),!!z(this.chart)&&(this.addLegendProxyGroup(),this.proxyLegendItems(),this.updateLegendItemProxyVisibility(),this.updateLegendTitle(),$&&this.chart.highlightLegendItem(this.highlightedLegendItemIx),!0)}removeProxies(){this.proxyProvider.removeGroup("legend")}updateLegendTitle(){let j=this.chart,V=D((j.legend&&j.legend.options.title&&j.legend.options.title.text||"").replace(/<br ?\/?>/g," "),j.renderer.forExport),$=j.langFormat("accessibility.legend.legendLabel"+(V?"":"NoTitle"),{chart:j,legendTitle:V,chartTitle:I(j)});this.proxyProvider.updateGroupAttrs("legend",{"aria-label":$})}addLegendProxyGroup(){let j=this.chart.options.accessibility.landmarkVerbosity==="all"?"region":null;this.proxyGroup=this.proxyProvider.addGroup("legend","ul",{"aria-label":"_placeholder_",role:j})}proxyLegendItems(){let j,V=this;((this.chart.legend||{}).allItems||[]).forEach($=>{(j=$.legendItem||{}).label&&j.label.element&&V.proxyLegendItem($)})}proxyLegendItem(j){let V=j.legendItem||{};if(!V.label||!V.group)return;let $=this.chart.langFormat("accessibility.legend.legendItem",{chart:this.chart,itemName:D(j.name,this.chart.renderer.forExport),item:j}),R={tabindex:-1,"aria-pressed":j.visible,"aria-label":$},L=V.group.div?V.label:V.group;j.a11yProxyElement=this.proxyProvider.addProxyElement("legend",{click:V.label,visual:L.element},"button",R)}getKeyboardNavigation(){let j=this.keyCodes,V=this,$=this.chart;return new b($,{keyCodeMap:[[[j.left,j.right,j.up,j.down],function(R){return V.onKbdArrowKey(this,R)}],[[j.enter,j.space],function(){return V.onKbdClick(this)}],[[j.pageDown,j.pageUp],function(R){let L=R===j.pageDown?1:-1;return V.highlightAdjacentLegendPage(L),this.response.success}]],validate:function(){return V.shouldHaveLegendNavigation()},init:function(){$.highlightLegendItem(0),V.highlightedLegendItemIx=0},terminate:function(){V.highlightedLegendItemIx=-1,$.legend.allItems.forEach(R=>Y(!1,R))}})}onKbdArrowKey(j,V){let{keyCodes:{left:$,up:R},highlightedLegendItemIx:L,chart:G}=this,U=G.legend.allItems.length,F=G.options.accessibility.keyboardNavigation.wrapAround,H=V===$||V===R?-1:1;return G.highlightLegendItem(L+H)?this.highlightedLegendItemIx+=H:F&&U>1&&(this.highlightedLegendItemIx=H>0?0:U-1,G.highlightLegendItem(this.highlightedLegendItemIx)),j.response.success}onKbdClick(j){let V=this.chart.legend.allItems[this.highlightedLegendItemIx];return V&&V.a11yProxyElement&&V.a11yProxyElement.click(),j.response.success}shouldHaveLegendNavigation(){if(!z(this.chart))return!1;let j=this.chart,V=(j.options.legend||{}).accessibility||{};return!!(j.legend.display&&V.keyboardNavigation&&V.keyboardNavigation.enabled)}destroy(){this.removeProxies()}}return function(Z){function j($){let R=this.legend.allItems,L=this.accessibility&&this.accessibility.components.legend.highlightedLegendItemIx,G=R[$],U=(G==null?void 0:G.legendItem)||{};if(G){k(L)&&R[L]&&Y(!1,R[L]),function(W,ne){let ue=(W.allItems[ne].legendItem||{}).pageIx,ie=W.currentPage;ue!==void 0&&ue+1!==ie&&W.scroll(1+ue-ie)}(this.legend,$);let F=U.label,H=G.a11yProxyElement&&G.a11yProxyElement.innerElement;return F&&F.element&&H&&this.setFocusToElement(F,H),Y(!0,G),!0}return!1}function V($){let R=this.chart.options.accessibility,L=$.item;R.enabled&&L&&L.a11yProxyElement&&L.a11yProxyElement.innerElement.setAttribute("aria-pressed",$.visible?"true":"false")}Z.compose=function($,R){let L=$.prototype;L.highlightLegendItem||(L.highlightLegendItem=j,_(R,"afterColorizeItem",V))}}(X),X}),c(t,"Stock/Navigator/ChartNavigatorComposition.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h){let d,{isTouchDevice:s}=a,{addEvent:f,merge:b,pick:x}=h,v=[];function g(){this.navigator&&this.navigator.setBaseSeries(null,!1)}function P(){var Y;let I,D,w,M=this.legend,z=this.navigator;if(z){I=M&&M.options,D=z.xAxis,w=z.yAxis;let{scrollbarHeight:X,scrollButtonSize:Z}=z;this.inverted?(z.left=z.opposite?this.chartWidth-X-z.height:this.spacing[3]+X,z.top=this.plotTop+Z):(z.left=x(D.left,this.plotLeft+Z),z.top=z.navigatorOptions.top||this.chartHeight-z.height-X-(((Y=this.scrollbar)==null?void 0:Y.options.margin)||0)-this.spacing[2]-(this.rangeSelector&&this.extraBottomMargin?this.rangeSelector.getHeight():0)-(I&&I.verticalAlign==="bottom"&&I.layout!=="proximate"&&I.enabled&&!I.floating?M.legendHeight+x(I.margin,10):0)-(this.titleOffset?this.titleOffset[2]:0)),D&&w&&(this.inverted?D.options.left=w.options.left=z.left:D.options.top=w.options.top=z.top,D.setAxisSize(),w.setAxisSize())}}function _(I){!this.navigator&&!this.scroller&&(this.options.navigator.enabled||this.options.scrollbar.enabled)&&(this.scroller=this.navigator=new d(this),x(I.redraw,!0)&&this.redraw(I.animation))}function S(){let I=this.options;(I.navigator.enabled||I.scrollbar.enabled)&&(this.scroller=this.navigator=new d(this))}function k(){let I=this.options,D=I.navigator,w=I.rangeSelector;if((D&&D.enabled||w&&w.enabled)&&(!s&&this.zooming.type==="x"||s&&this.zooming.pinchType==="x"))return!1}function A(I){let D=I.navigator;if(D&&I.xAxis[0]){let w=I.xAxis[0].getExtremes();D.render(w.min,w.max)}}function y(I){let D=I.options.navigator||{},w=I.options.scrollbar||{};!this.navigator&&!this.scroller&&(D.enabled||w.enabled)&&(b(!0,this.options.navigator,D),b(!0,this.options.scrollbar,w),delete I.options.navigator,delete I.options.scrollbar)}return{compose:function(I,D){if(h.pushUnique(v,I)){let w=I.prototype;d=D,w.callbacks.push(A),f(I,"afterAddSeries",g),f(I,"afterSetChartSize",P),f(I,"afterUpdate",_),f(I,"beforeRender",S),f(I,"beforeShowResetZoom",k),f(I,"update",y)}}}}),c(t,"Core/Axis/NavigatorAxisComposition.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h){let{isTouchDevice:d}=a,{addEvent:s,correctFloat:f,defined:b,isNumber:x,pick:v}=h;function g(){this.navigatorAxis||(this.navigatorAxis=new _(this))}function P(S){let k,A=this.chart,y=A.options,I=y.navigator,D=this.navigatorAxis,w=A.zooming.pinchType,M=y.rangeSelector,z=A.zooming.type;if(this.isXAxis&&(I!=null&&I.enabled||M!=null&&M.enabled)){if(z==="y"&&S.trigger==="zoom")k=!1;else if((S.trigger==="zoom"&&z==="xy"||d&&w==="xy")&&this.options.range){let Y=D.previousZoom;b(S.min)?D.previousZoom=[this.min,this.max]:Y&&(S.min=Y[0],S.max=Y[1],D.previousZoom=void 0)}}k!==void 0&&S.preventDefault()}class _{static compose(k){k.keepProps.includes("navigatorAxis")||(k.keepProps.push("navigatorAxis"),s(k,"init",g),s(k,"setExtremes",P))}constructor(k){this.axis=k}destroy(){this.axis=void 0}toFixedRange(k,A,y,I){let D=this.axis,w=(D.pointRange||0)/2,M=v(y,D.translate(k,!0,!D.horiz)),z=v(I,D.translate(A,!0,!D.horiz));return b(y)||(M=f(M+w)),b(I)||(z=f(z-w)),x(M)&&x(z)||(M=z=void 0),{min:M,max:z}}}return _}),c(t,"Stock/Navigator/NavigatorDefaults.js",[t["Core/Color/Color.js"],t["Core/Series/SeriesRegistry.js"]],function(a,h){let{parse:d}=a,{seriesTypes:s}=h;return{height:40,margin:25,maskInside:!0,handles:{width:7,borderRadius:0,height:15,symbols:["navigator-handle","navigator-handle"],enabled:!0,lineWidth:1,backgroundColor:"#f2f2f2",borderColor:"#999999"},maskFill:d("#667aff").setOpacity(.3).get(),outlineColor:"#999999",outlineWidth:1,series:{type:s.areaspline===void 0?"line":"areaspline",fillOpacity:.05,lineWidth:1,compare:null,sonification:{enabled:!1},dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,firstAnchor:"firstPoint",anchor:"middle",lastAnchor:"lastPoint",units:[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2,3,4]],["week",[1,2,3]],["month",[1,3,6]],["year",null]]},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",className:"highcharts-navigator-series",lineColor:null,marker:{enabled:!1},threshold:null},xAxis:{className:"highcharts-navigator-xaxis",tickLength:0,lineWidth:0,gridLineColor:"#e6e6e6",id:"navigator-x-axis",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#000000",fontSize:"0.7em",opacity:.6,textOutline:"2px contrast"},x:3,y:-4},crosshair:!1},yAxis:{className:"highcharts-navigator-yaxis",gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:.1,id:"navigator-y-axis",maxPadding:.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickLength:0,tickWidth:0}}}),c(t,"Stock/Navigator/NavigatorSymbols.js",[t["Core/Renderer/SVG/Symbols.js"],t["Core/Utilities.js"]],function(a,h){let{relativeLength:d}=h;return{"navigator-handle":function(s,f,b,x,v={}){let g=v.width?v.width/2:b,P=d(v.borderRadius||0,Math.min(2*g,x));return[["M",-1.5,(x=v.height||x)/2-3.5],["L",-1.5,x/2+4.5],["M",.5,x/2-3.5],["L",.5,x/2+4.5],...a.rect(-g-1,.5,2*g+1,x,{r:P})]}}}),c(t,"Stock/Utilities/StockUtilities.js",[t["Core/Utilities.js"]],function(a){let{defined:h}=a;return{setFixedRange:function(d){let s=this.xAxis[0];h(s.dataMax)&&h(s.dataMin)&&d?this.fixedRange=Math.min(d,s.dataMax-s.dataMin):this.fixedRange=d}}}),c(t,"Stock/Navigator/NavigatorComposition.js",[t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Axis/NavigatorAxisComposition.js"],t["Stock/Navigator/NavigatorDefaults.js"],t["Stock/Navigator/NavigatorSymbols.js"],t["Core/Renderer/RendererRegistry.js"],t["Stock/Utilities/StockUtilities.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b,x,v){let{setOptions:g}=a,{composed:P}=h,{getRendererType:_}=b,{setFixedRange:S}=x,{addEvent:k,extend:A,pushUnique:y}=v;function I(){this.chart.navigator&&!this.options.isInternal&&this.chart.navigator.setBaseSeries(null,!1)}return{compose:function(D,w,M){d.compose(w),y(P,"Navigator")&&(D.prototype.setFixedRange=S,A(_().prototype.symbols,f),k(M,"afterUpdate",I),g({navigator:s}))}}}),c(t,"Core/Axis/ScrollbarAxis.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h){var d;let{composed:s}=a,{addEvent:f,defined:b,pick:x,pushUnique:v}=h;return function(g){let P;function _(y){let I=x(y.options&&y.options.min,y.min),D=x(y.options&&y.options.max,y.max);return{axisMin:I,axisMax:D,scrollMin:b(y.dataMin)?Math.min(I,y.min,y.dataMin,x(y.threshold,1/0)):I,scrollMax:b(y.dataMax)?Math.max(D,y.max,y.dataMax,x(y.threshold,-1/0)):D}}function S(){let y=this.scrollbar,I=y&&!y.options.opposite,D=this.horiz?2:I?3:1;y&&(this.chart.scrollbarsOffsets=[0,0],this.chart.axisOffset[D]+=y.size+(y.options.margin||0))}function k(){let y=this;y.options&&y.options.scrollbar&&y.options.scrollbar.enabled&&(y.options.scrollbar.vertical=!y.horiz,y.options.startOnTick=y.options.endOnTick=!1,y.scrollbar=new P(y.chart.renderer,y.options.scrollbar,y.chart),f(y.scrollbar,"changed",function(I){let D,w,{axisMin:M,axisMax:z,scrollMin:Y,scrollMax:X}=_(y),Z=X-Y;if(b(M)&&b(z))if(y.horiz&&!y.reversed||!y.horiz&&y.reversed?(D=Y+Z*this.to,w=Y+Z*this.from):(D=Y+Z*(1-this.from),w=Y+Z*(1-this.to)),this.shouldUpdateExtremes(I.DOMType)){let j=I.DOMType!=="mousemove"&&I.DOMType!=="touchmove"&&void 0;y.setExtremes(w,D,!0,j,I)}else this.setRange(this.from,this.to)}))}function A(){let y,I,D,{scrollMin:w,scrollMax:M}=_(this),z=this.scrollbar,Y=this.axisTitleMargin+(this.titleOffset||0),X=this.chart.scrollbarsOffsets,Z=this.options.margin||0;if(z&&X){if(this.horiz)this.opposite||(X[1]+=Y),z.position(this.left,this.top+this.height+2+X[1]-(this.opposite?Z:0),this.width,this.height),this.opposite||(X[1]+=Z),y=1;else{let j;this.opposite&&(X[0]+=Y),j=z.options.opposite?this.left+this.width+2+X[0]-(this.opposite?0:Z):this.opposite?0:Z,z.position(j,this.top,this.width,this.height),this.opposite&&(X[0]+=Z),y=0}if(X[y]+=z.size+(z.options.margin||0),isNaN(w)||isNaN(M)||!b(this.min)||!b(this.max)||this.dataMin===this.dataMax)z.setRange(0,1);else if(this.min===this.max){let j=this.pointRange/(this.dataMax+1);I=j*this.min,D=j*(this.max+1),z.setRange(I,D)}else I=(this.min-w)/(M-w),D=(this.max-w)/(M-w),this.horiz&&!this.reversed||!this.horiz&&this.reversed?z.setRange(I,D):z.setRange(1-D,1-I)}}g.compose=function(y,I){v(s,"Axis.Scrollbar")&&(P=I,f(y,"afterGetOffset",S),f(y,"afterInit",k),f(y,"afterRender",A))}}(d||(d={})),d}),c(t,"Stock/Scrollbar/ScrollbarDefaults.js",[],function(){return{height:10,barBorderRadius:5,buttonBorderRadius:0,buttonsEnabled:!1,liveRedraw:void 0,margin:void 0,minWidth:6,opposite:!0,step:.2,zIndex:3,barBackgroundColor:"#cccccc",barBorderWidth:0,barBorderColor:"#cccccc",buttonArrowColor:"#333333",buttonBackgroundColor:"#e6e6e6",buttonBorderColor:"#cccccc",buttonBorderWidth:1,rifleColor:"none",trackBackgroundColor:"rgba(255, 255, 255, 0.001)",trackBorderColor:"#cccccc",trackBorderRadius:5,trackBorderWidth:1}}),c(t,"Stock/Scrollbar/Scrollbar.js",[t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Axis/ScrollbarAxis.js"],t["Stock/Scrollbar/ScrollbarDefaults.js"],t["Core/Utilities.js"]],function(a,h,d,s,f){let{defaultOptions:b}=a,{addEvent:x,correctFloat:v,crisp:g,defined:P,destroyObjectProperties:_,fireEvent:S,merge:k,pick:A,removeEvent:y}=f;class I{static compose(w){d.compose(w,I)}static swapXY(w,M){return M&&w.forEach(z=>{let Y,X=z.length;for(let Z=0;Z<X;Z+=2)typeof(Y=z[Z+1])=="number"&&(z[Z+1]=z[Z+2],z[Z+2]=Y)}),w}constructor(w,M,z){this._events=[],this.chartX=0,this.chartY=0,this.from=0,this.scrollbarButtons=[],this.scrollbarLeft=0,this.scrollbarStrokeWidth=1,this.scrollbarTop=0,this.size=0,this.to=0,this.trackBorderWidth=1,this.x=0,this.y=0,this.init(w,M,z)}addEvents(){let w=this.options.inverted?[1,0]:[0,1],M=this.scrollbarButtons,z=this.scrollbarGroup.element,Y=this.track.element,X=this.mouseDownHandler.bind(this),Z=this.mouseMoveHandler.bind(this),j=this.mouseUpHandler.bind(this),V=[[M[w[0]].element,"click",this.buttonToMinClick.bind(this)],[M[w[1]].element,"click",this.buttonToMaxClick.bind(this)],[Y,"click",this.trackClick.bind(this)],[z,"mousedown",X],[z.ownerDocument,"mousemove",Z],[z.ownerDocument,"mouseup",j],[z,"touchstart",X],[z.ownerDocument,"touchmove",Z],[z.ownerDocument,"touchend",j]];V.forEach(function($){x.apply(null,$)}),this._events=V}buttonToMaxClick(w){let M=(this.to-this.from)*A(this.options.step,.2);this.updatePosition(this.from+M,this.to+M),S(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMEvent:w})}buttonToMinClick(w){let M=v(this.to-this.from)*A(this.options.step,.2);this.updatePosition(v(this.from-M),v(this.to-M)),S(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMEvent:w})}cursorToScrollbarPosition(w){let M=this.options,z=M.minWidth>this.calculatedWidth?M.minWidth:0;return{chartX:(w.chartX-this.x-this.xOffset)/(this.barWidth-z),chartY:(w.chartY-this.y-this.yOffset)/(this.barWidth-z)}}destroy(){let w=this,M=w.chart.scroller;w.removeEvents(),["track","scrollbarRifles","scrollbar","scrollbarGroup","group"].forEach(function(z){w[z]&&w[z].destroy&&(w[z]=w[z].destroy())}),M&&w===M.scrollbar&&(M.scrollbar=null,_(M.scrollbarButtons))}drawScrollbarButton(w){let M=this.renderer,z=this.scrollbarButtons,Y=this.options,X=this.size,Z=M.g().add(this.group);if(z.push(Z),Y.buttonsEnabled){let j=M.rect().addClass("highcharts-scrollbar-button").add(Z);this.chart.styledMode||j.attr({stroke:Y.buttonBorderColor,"stroke-width":Y.buttonBorderWidth,fill:Y.buttonBackgroundColor}),j.attr(j.crisp({x:-.5,y:-.5,width:X,height:X,r:Y.buttonBorderRadius},j.strokeWidth()));let V=M.path(I.swapXY([["M",X/2+(w?-1:1),X/2-3],["L",X/2+(w?-1:1),X/2+3],["L",X/2+(w?2:-2),X/2]],Y.vertical)).addClass("highcharts-scrollbar-arrow").add(z[w]);this.chart.styledMode||V.attr({fill:Y.buttonArrowColor})}}init(w,M,z){this.scrollbarButtons=[],this.renderer=w,this.userOptions=M,this.options=k(s,b.scrollbar,M),this.options.margin=A(this.options.margin,10),this.chart=z,this.size=A(this.options.size,this.options.height),M.enabled&&(this.render(),this.addEvents())}mouseDownHandler(w){var Y;let M=((Y=this.chart.pointer)==null?void 0:Y.normalize(w))||w,z=this.cursorToScrollbarPosition(M);this.chartX=z.chartX,this.chartY=z.chartY,this.initPositions=[this.from,this.to],this.grabbedCenter=!0}mouseMoveHandler(w){var Z;let M,z=((Z=this.chart.pointer)==null?void 0:Z.normalize(w))||w,Y=this.options.vertical?"chartY":"chartX",X=this.initPositions||[];this.grabbedCenter&&(!w.touches||w.touches[0][Y]!==0)&&(M=this.cursorToScrollbarPosition(z)[Y]-this[Y],this.hasDragged=!0,this.updatePosition(X[0]+M,X[1]+M),this.hasDragged&&S(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMType:w.type,DOMEvent:w}))}mouseUpHandler(w){this.hasDragged&&S(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMType:w.type,DOMEvent:w}),this.grabbedCenter=this.hasDragged=this.chartX=this.chartY=null}position(w,M,z,Y){let{buttonsEnabled:X,margin:Z=0,vertical:j}=this.options,V=this.rendered?"animate":"attr",$=Y,R=0;this.group.show(),this.x=w,this.y=M+this.trackBorderWidth,this.width=z,this.height=Y,this.xOffset=$,this.yOffset=R,j?(this.width=this.yOffset=z=R=this.size,this.xOffset=$=0,this.yOffset=R=X?this.size:0,this.barWidth=Y-(X?2*z:0),this.x=w+=Z):(this.height=Y=this.size,this.xOffset=$=X?this.size:0,this.barWidth=z-(X?2*Y:0),this.y=this.y+Z),this.group[V]({translateX:w,translateY:this.y}),this.track[V]({width:z,height:Y}),this.scrollbarButtons[1][V]({translateX:j?0:z-$,translateY:j?Y-R:0})}removeEvents(){this._events.forEach(function(w){y.apply(null,w)}),this._events.length=0}render(){let w=this.renderer,M=this.options,z=this.size,Y=this.chart.styledMode,X=w.g("scrollbar").attr({zIndex:M.zIndex}).hide().add();this.group=X,this.track=w.rect().addClass("highcharts-scrollbar-track").attr({r:M.trackBorderRadius||0,height:z,width:z}).add(X),Y||this.track.attr({fill:M.trackBackgroundColor,stroke:M.trackBorderColor,"stroke-width":M.trackBorderWidth});let Z=this.trackBorderWidth=this.track.strokeWidth();this.track.attr({x:-g(0,Z),y:-g(0,Z)}),this.scrollbarGroup=w.g().add(X),this.scrollbar=w.rect().addClass("highcharts-scrollbar-thumb").attr({height:z-Z,width:z-Z,r:M.barBorderRadius||0}).add(this.scrollbarGroup),this.scrollbarRifles=w.path(I.swapXY([["M",-3,z/4],["L",-3,2*z/3],["M",0,z/4],["L",0,2*z/3],["M",3,z/4],["L",3,2*z/3]],M.vertical)).addClass("highcharts-scrollbar-rifles").add(this.scrollbarGroup),Y||(this.scrollbar.attr({fill:M.barBackgroundColor,stroke:M.barBorderColor,"stroke-width":M.barBorderWidth}),this.scrollbarRifles.attr({stroke:M.rifleColor,"stroke-width":1})),this.scrollbarStrokeWidth=this.scrollbar.strokeWidth(),this.scrollbarGroup.translate(-g(0,this.scrollbarStrokeWidth),-g(0,this.scrollbarStrokeWidth)),this.drawScrollbarButton(0),this.drawScrollbarButton(1)}setRange(w,M){let z,Y,X=this.options,Z=X.vertical,j=X.minWidth,V=this.barWidth,$=!this.rendered||this.hasDragged||this.chart.navigator&&this.chart.navigator.hasDragged?"attr":"animate";if(!P(V))return;let R=V*Math.min(M,1);z=Math.ceil(V*(w=Math.max(w,0))),this.calculatedWidth=Y=v(R-z),Y<j&&(z=(V-j+Y)*w,Y=j);let L=Math.floor(z+this.xOffset+this.yOffset),G=Y/2-.5;this.from=w,this.to=M,Z?(this.scrollbarGroup[$]({translateY:L}),this.scrollbar[$]({height:Y}),this.scrollbarRifles[$]({translateY:G}),this.scrollbarTop=L,this.scrollbarLeft=0):(this.scrollbarGroup[$]({translateX:L}),this.scrollbar[$]({width:Y}),this.scrollbarRifles[$]({translateX:G}),this.scrollbarLeft=L,this.scrollbarTop=0),Y<=12?this.scrollbarRifles.hide():this.scrollbarRifles.show(),X.showFull===!1&&(w<=0&&M>=1?this.group.hide():this.group.show()),this.rendered=!0}shouldUpdateExtremes(w){return A(this.options.liveRedraw,h.svg&&!h.isTouchDevice&&!this.chart.boosted)||w==="mouseup"||w==="touchend"||!P(w)}trackClick(w){var Z;let M=((Z=this.chart.pointer)==null?void 0:Z.normalize(w))||w,z=this.to-this.from,Y=this.y+this.scrollbarTop,X=this.x+this.scrollbarLeft;this.options.vertical&&M.chartY>Y||!this.options.vertical&&M.chartX>X?this.updatePosition(this.from+z,this.to+z):this.updatePosition(this.from-z,this.to-z),S(this,"changed",{from:this.from,to:this.to,trigger:"scrollbar",DOMEvent:w})}update(w){this.destroy(),this.init(this.chart.renderer,k(!0,this.options,w),this.chart)}updatePosition(w,M){M>1&&(w=v(1-v(M-w)),M=1),w<0&&(M=v(M-w),w=0),this.from=w,this.to=M}}return I.defaultOptions=s,b.scrollbar=k(!0,I.defaultOptions,b.scrollbar),I}),c(t,"Stock/Navigator/Navigator.js",[t["Core/Axis/Axis.js"],t["Stock/Navigator/ChartNavigatorComposition.js"],t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Axis/NavigatorAxisComposition.js"],t["Stock/Navigator/NavigatorComposition.js"],t["Stock/Scrollbar/Scrollbar.js"],t["Core/Renderer/SVG/SVGRenderer.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b,x,v,g){let{defaultOptions:P}=d,{isTouchDevice:_}=s,{prototype:{symbols:S}}=v,{addEvent:k,clamp:A,correctFloat:y,defined:I,destroyObjectProperties:D,erase:w,extend:M,find:z,fireEvent:Y,isArray:X,isNumber:Z,merge:j,pick:V,removeEvent:$,splat:R}=g;function L(U,...F){let H=[].filter.call(F,Z);if(H.length)return Math[U].apply(0,H)}class G{static compose(F,H,W){h.compose(F,G),b.compose(F,H,W)}constructor(F){this.isDirty=!1,this.scrollbarHeight=0,this.init(F)}drawHandle(F,H,W,ne){let ue=this.navigatorOptions.handles.height;this.handles[H][ne](W?{translateX:Math.round(this.left+this.height/2),translateY:Math.round(this.top+parseInt(F,10)+.5-ue)}:{translateX:Math.round(this.left+parseInt(F,10)),translateY:Math.round(this.top+this.height/2-ue/2-1)})}drawOutline(F,H,W,ne){let ue=this.navigatorOptions.maskInside,ie=this.outline.strokeWidth(),oe=ie/2,Te=ie%2/2,ge=this.scrollButtonSize,we=this.size,K=this.top,Q=this.height,ae=K-oe,ye=K+Q,J=this.left,re,ce;W?(re=K+H+Te,H=K+F+Te,ce=[["M",J+Q,K-ge-Te],["L",J+Q,re],["L",J,re],["M",J,H],["L",J+Q,H],["L",J+Q,K+we+ge]],ue&&ce.push(["M",J+Q,re-oe],["L",J+Q,H+oe])):(J-=ge,F+=J+ge-Te,H+=J+ge-Te,ce=[["M",J,ae],["L",F,ae],["L",F,ye],["M",H,ye],["L",H,ae],["L",J+we+2*ge,ae]],ue&&ce.push(["M",F-oe,ae],["L",H+oe,ae])),this.outline[ne]({d:ce})}drawMasks(F,H,W,ne){let ue,ie,oe,Te,ge=this.left,we=this.top,K=this.height;W?(oe=[ge,ge,ge],Te=[we,we+F,we+H],ie=[K,K,K],ue=[F,H-F,this.size-H]):(oe=[ge,ge+F,ge+H],Te=[we,we,we],ie=[F,H-F,this.size-H],ue=[K,K,K]),this.shades.forEach((Q,ae)=>{Q[ne]({x:oe[ae],y:Te[ae],width:ie[ae],height:ue[ae]})})}renderElements(){var ge;let F=this,H=F.navigatorOptions,W=H.maskInside,ne=F.chart,ue=ne.inverted,ie=ne.renderer,oe={cursor:ue?"ns-resize":"ew-resize"},Te=F.navigatorGroup??(F.navigatorGroup=ie.g("navigator").attr({zIndex:8,visibility:"hidden"}).add());if([!W,W,!W].forEach((we,K)=>{let Q=F.shades[K]??(F.shades[K]=ie.rect().addClass("highcharts-navigator-mask"+(K===1?"-inside":"-outside")).add(Te));ne.styledMode||(Q.attr({fill:we?H.maskFill:"rgba(0,0,0,0)"}),K===1&&Q.css(oe))}),F.outline||(F.outline=ie.path().addClass("highcharts-navigator-outline").add(Te)),ne.styledMode||F.outline.attr({"stroke-width":H.outlineWidth,stroke:H.outlineColor}),(ge=H.handles)==null?void 0:ge.enabled){let we=H.handles,{height:K,width:Q}=we;[0,1].forEach(ae=>{var J;let ye=we.symbols[ae];if(F.handles[ae]&&F.handles[ae].symbolUrl===ye){if(!F.handles[ae].isImg&&F.handles[ae].symbolName!==ye){let re=S[ye].call(S,-Q/2-1,0,Q,K);F.handles[ae].attr({d:re}),F.handles[ae].symbolName=ye}}else(J=F.handles[ae])==null||J.destroy(),F.handles[ae]=ie.symbol(ye,-Q/2-1,0,Q,K,we),F.handles[ae].attr({zIndex:7-ae}).addClass("highcharts-navigator-handle highcharts-navigator-handle-"+["left","right"][ae]).add(Te),F.addMouseEvents();ne.inverted&&F.handles[ae].attr({rotation:90,rotationOriginX:Math.floor(-Q/2),rotationOriginY:(K+Q)/2}),ne.styledMode||F.handles[ae].attr({fill:we.backgroundColor,stroke:we.borderColor,"stroke-width":we.lineWidth,width:we.width,height:we.height,x:-Q/2-1,y:0}).css(oe)})}}update(F,H=!1){var ue;let W=this.chart,ne=W.options.chart.inverted!==((ue=W.scrollbar)==null?void 0:ue.options.vertical);if(j(!0,W.options.navigator,F),this.navigatorOptions=W.options.navigator||{},this.setOpposite(),I(F.enabled)||ne)return this.destroy(),this.navigatorEnabled=F.enabled||this.navigatorEnabled,this.init(W);if(this.navigatorEnabled&&(this.isDirty=!0,F.adaptToUpdatedData===!1&&this.baseSeries.forEach(ie=>{$(ie,"updatedData",this.updatedDataHandler)},this),F.adaptToUpdatedData&&this.baseSeries.forEach(ie=>{ie.eventsToUnbind.push(k(ie,"updatedData",this.updatedDataHandler))},this),(F.series||F.baseSeries)&&this.setBaseSeries(void 0,!1),F.height||F.xAxis||F.yAxis)){this.height=F.height??this.height;let ie=this.getXAxisOffsets();this.xAxis.update({...F.xAxis,offsets:ie,[W.inverted?"width":"height"]:this.height,[W.inverted?"height":"width"]:void 0},!1),this.yAxis.update({...F.yAxis,[W.inverted?"width":"height"]:this.height},!1)}H&&W.redraw()}render(F,H,W,ne){let ue=this.chart,ie=this.xAxis,oe=ie.pointRange||0,Te=ie.navigatorAxis.fake?ue.xAxis[0]:ie,ge=this.navigatorEnabled,we=this.rendered,K=ue.inverted,Q=ue.xAxis[0].minRange,ae=ue.xAxis[0].options.maxRange,ye=this.scrollButtonSize,J,re,ce,pe=this.scrollbarHeight,xe,Me;if(this.hasDragged&&!I(W))return;if(this.isDirty&&this.renderElements(),F=y(F-oe/2),H=y(H+oe/2),!Z(F)||!Z(H)){if(!we)return;W=0,ne=V(ie.width,Te.width)}this.left=V(ie.left,ue.plotLeft+ye+(K?ue.plotWidth:0));let _e=this.size=xe=V(ie.len,(K?ue.plotHeight:ue.plotWidth)-2*ye);J=K?pe:xe+2*ye,W=V(W,ie.toPixels(F,!0)),ne=V(ne,ie.toPixels(H,!0)),Z(W)&&Math.abs(W)!==1/0||(W=0,ne=J);let Ce=ie.toValue(W,!0),Le=ie.toValue(ne,!0),Ue=Math.abs(y(Le-Ce));Ue<Q?this.grabbedLeft?W=ie.toPixels(Le-Q-oe,!0):this.grabbedRight&&(ne=ie.toPixels(Ce+Q+oe,!0)):I(ae)&&y(Ue-oe)>ae&&(this.grabbedLeft?W=ie.toPixels(Le-ae-oe,!0):this.grabbedRight&&(ne=ie.toPixels(Ce+ae+oe,!0))),this.zoomedMax=A(Math.max(W,ne),0,_e),this.zoomedMin=A(this.fixedWidth?this.zoomedMax-this.fixedWidth:Math.min(W,ne),0,_e),this.range=this.zoomedMax-this.zoomedMin,_e=Math.round(this.zoomedMax);let Xe=Math.round(this.zoomedMin);ge&&(this.navigatorGroup.attr({visibility:"inherit"}),Me=we&&!this.hasDragged?"animate":"attr",this.drawMasks(Xe,_e,K,Me),this.drawOutline(Xe,_e,K,Me),this.navigatorOptions.handles.enabled&&(this.drawHandle(Xe,0,K,Me),this.drawHandle(_e,1,K,Me))),this.scrollbar&&(K?(ce=this.top-ye,re=this.left-pe+(ge||!Te.opposite?0:(Te.titleOffset||0)+Te.axisTitleMargin),pe=xe+2*ye):(ce=this.top+(ge?this.height:-pe),re=this.left-ye),this.scrollbar.position(re,ce,J,pe),this.scrollbar.setRange(this.zoomedMin/(xe||1),this.zoomedMax/(xe||1))),this.rendered=!0,this.isDirty=!1,Y(this,"afterRender")}addMouseEvents(){let F=this,H=F.chart,W=H.container,ne=[],ue,ie;F.mouseMoveHandler=ue=function(oe){F.onMouseMove(oe)},F.mouseUpHandler=ie=function(oe){F.onMouseUp(oe)},(ne=F.getPartsEvents("mousedown")).push(k(H.renderTo,"mousemove",ue),k(W.ownerDocument,"mouseup",ie),k(H.renderTo,"touchmove",ue),k(W.ownerDocument,"touchend",ie)),ne.concat(F.getPartsEvents("touchstart")),F.eventsToUnbind=ne,F.series&&F.series[0]&&ne.push(k(F.series[0].xAxis,"foundExtremes",function(){H.navigator.modifyNavigatorAxisExtremes()}))}getPartsEvents(F){let H=this,W=[];return["shades","handles"].forEach(function(ne){H[ne].forEach(function(ue,ie){W.push(k(ue.element,F,function(oe){H[ne+"Mousedown"](oe,ie)}))})}),W}shadesMousedown(F,H){var ye;F=((ye=this.chart.pointer)==null?void 0:ye.normalize(F))||F;let W=this.chart,ne=this.xAxis,ue=this.zoomedMin,ie=this.size,oe=this.range,Te=this.left,ge=F.chartX,we,K,Q,ae;W.inverted&&(ge=F.chartY,Te=this.top),H===1?(this.grabbedCenter=ge,this.fixedWidth=oe,this.dragOffset=ge-ue):(ae=ge-Te-oe/2,H===0?ae=Math.max(0,ae):H===2&&ae+oe>=ie&&(ae=ie-oe,this.reversedExtremes?(ae-=oe,K=this.getUnionExtremes().dataMin):we=this.getUnionExtremes().dataMax),ae!==ue&&(this.fixedWidth=oe,I((Q=ne.navigatorAxis.toFixedRange(ae,ae+oe,K,we)).min)&&Y(this,"setRange",{min:Math.min(Q.min,Q.max),max:Math.max(Q.min,Q.max),redraw:!0,eventArguments:{trigger:"navigator"}})))}handlesMousedown(F,H){var ie;F=((ie=this.chart.pointer)==null?void 0:ie.normalize(F))||F;let W=this.chart,ne=W.xAxis[0],ue=this.reversedExtremes;H===0?(this.grabbedLeft=!0,this.otherHandlePos=this.zoomedMax,this.fixedExtreme=ue?ne.min:ne.max):(this.grabbedRight=!0,this.otherHandlePos=this.zoomedMin,this.fixedExtreme=ue?ne.max:ne.min),W.setFixedRange(void 0)}onMouseMove(F){var we;let H=this,W=H.chart,ne=H.navigatorSize,ue=H.range,ie=H.dragOffset,oe=W.inverted,Te=H.left,ge;(!F.touches||F.touches[0].pageX!==0)&&(ge=(F=((we=W.pointer)==null?void 0:we.normalize(F))||F).chartX,oe&&(Te=H.top,ge=F.chartY),H.grabbedLeft?(H.hasDragged=!0,H.render(0,0,ge-Te,H.otherHandlePos)):H.grabbedRight?(H.hasDragged=!0,H.render(0,0,H.otherHandlePos,ge-Te)):H.grabbedCenter&&(H.hasDragged=!0,ge<ie?ge=ie:ge>ne+ie-ue&&(ge=ne+ie-ue),H.render(0,0,ge-ie,ge-ie+ue)),H.hasDragged&&H.scrollbar&&V(H.scrollbar.options.liveRedraw,!_&&!this.chart.boosted)&&(F.DOMType=F.type,setTimeout(function(){H.onMouseUp(F)},0)))}onMouseUp(F){let H,W,ne,ue,ie,oe,Te=this.chart,ge=this.xAxis,we=this.scrollbar,K=F.DOMEvent||F,Q=Te.inverted,ae=this.rendered&&!this.hasDragged?"animate":"attr";(this.hasDragged&&(!we||!we.hasDragged)||F.trigger==="scrollbar")&&(ne=this.getUnionExtremes(),this.zoomedMin===this.otherHandlePos?ue=this.fixedExtreme:this.zoomedMax===this.otherHandlePos&&(ie=this.fixedExtreme),this.zoomedMax===this.size&&(ie=this.reversedExtremes?ne.dataMin:ne.dataMax),this.zoomedMin===0&&(ue=this.reversedExtremes?ne.dataMax:ne.dataMin),I((oe=ge.navigatorAxis.toFixedRange(this.zoomedMin,this.zoomedMax,ue,ie)).min)&&Y(this,"setRange",{min:Math.min(oe.min,oe.max),max:Math.max(oe.min,oe.max),redraw:!0,animation:!this.hasDragged&&null,eventArguments:{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:K}})),F.DOMType!=="mousemove"&&F.DOMType!=="touchmove"&&(this.grabbedLeft=this.grabbedRight=this.grabbedCenter=this.fixedWidth=this.fixedExtreme=this.otherHandlePos=this.hasDragged=this.dragOffset=null),this.navigatorEnabled&&Z(this.zoomedMin)&&Z(this.zoomedMax)&&(W=Math.round(this.zoomedMin),H=Math.round(this.zoomedMax),this.shades&&this.drawMasks(W,H,Q,ae),this.outline&&this.drawOutline(W,H,Q,ae),this.navigatorOptions.handles.enabled&&Object.keys(this.handles).length===this.handles.length&&(this.drawHandle(W,0,Q,ae),this.drawHandle(H,1,Q,ae)))}removeEvents(){this.eventsToUnbind&&(this.eventsToUnbind.forEach(function(F){F()}),this.eventsToUnbind=void 0),this.removeBaseSeriesEvents()}removeBaseSeriesEvents(){let F=this.baseSeries||[];this.navigatorEnabled&&F[0]&&(this.navigatorOptions.adaptToUpdatedData!==!1&&F.forEach(function(H){$(H,"updatedData",this.updatedDataHandler)},this),F[0].xAxis&&$(F[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes))}getXAxisOffsets(){return this.chart.inverted?[this.scrollButtonSize,0,-this.scrollButtonSize,0]:[0,-this.scrollButtonSize,0,this.scrollButtonSize]}init(F){var J;let H=F.options,W=H.navigator||{},ne=W.enabled,ue=H.scrollbar||{},ie=ue.enabled,oe=ne&&W.height||0,Te=ie&&ue.height||0,ge=ue.buttonsEnabled&&Te||0;this.handles=[],this.shades=[],this.chart=F,this.setBaseSeries(),this.height=oe,this.scrollbarHeight=Te,this.scrollButtonSize=ge,this.scrollbarEnabled=ie,this.navigatorEnabled=ne,this.navigatorOptions=W,this.scrollbarOptions=ue,this.setOpposite();let we=this,K=we.baseSeries,Q=F.xAxis.length,ae=F.yAxis.length,ye=K&&K[0]&&K[0].xAxis||F.xAxis[0]||{options:{}};if(F.isDirtyBox=!0,we.navigatorEnabled){let re=this.getXAxisOffsets();we.xAxis=new a(F,j({breaks:ye.options.breaks,ordinal:ye.options.ordinal,overscroll:ye.options.overscroll},W.xAxis,{type:"datetime",yAxis:(J=W.yAxis)==null?void 0:J.id,index:Q,isInternal:!0,offset:0,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:ye.options.ordinal?0:ye.options.minPadding,maxPadding:ye.options.ordinal?0:ye.options.maxPadding,zoomEnabled:!1},F.inverted?{offsets:re,width:oe}:{offsets:re,height:oe}),"xAxis"),we.yAxis=new a(F,j(W.yAxis,{alignTicks:!1,offset:0,index:ae,isInternal:!0,reversed:V(W.yAxis&&W.yAxis.reversed,F.yAxis[0]&&F.yAxis[0].reversed,!1),zoomEnabled:!1},F.inverted?{width:oe}:{height:oe}),"yAxis"),K||W.series.data?we.updateNavigatorSeries(!1):F.series.length===0&&(we.unbindRedraw=k(F,"beforeRedraw",function(){F.series.length>0&&!we.series&&(we.setBaseSeries(),we.unbindRedraw())})),we.reversedExtremes=F.inverted&&!we.xAxis.reversed||!F.inverted&&we.xAxis.reversed,we.renderElements(),we.addMouseEvents()}else we.xAxis={chart:F,navigatorAxis:{fake:!0},translate:function(re,ce){let pe=F.xAxis[0],xe=pe.getExtremes(),Me=pe.len-2*ge,_e=L("min",pe.options.min,xe.dataMin),Ce=L("max",pe.options.max,xe.dataMax)-_e;return ce?re*Ce/Me+_e:Me*(re-_e)/Ce},toPixels:function(re){return this.translate(re)},toValue:function(re){return this.translate(re,!0)}},we.xAxis.navigatorAxis.axis=we.xAxis,we.xAxis.navigatorAxis.toFixedRange=f.prototype.toFixedRange.bind(we.xAxis.navigatorAxis);if(F.options.scrollbar.enabled){let re=j(F.options.scrollbar,{vertical:F.inverted});!Z(re.margin)&&we.navigatorEnabled&&(re.margin=F.inverted?-3:3),F.scrollbar=we.scrollbar=new x(F.renderer,re,F),k(we.scrollbar,"changed",function(ce){let pe=we.size,xe=pe*this.to,Me=pe*this.from;we.hasDragged=we.scrollbar.hasDragged,we.render(0,0,Me,xe),this.shouldUpdateExtremes(ce.DOMType)&&setTimeout(function(){we.onMouseUp(ce)})})}we.addBaseSeriesEvents(),we.addChartEvents()}setOpposite(){let F=this.navigatorOptions,H=this.navigatorEnabled,W=this.chart;this.opposite=V(F.opposite,!!(!H&&W.inverted))}getUnionExtremes(F){let H,W=this.chart.xAxis[0],ne=this.xAxis,ue=ne.options,ie=W.options;return F&&W.dataMin===null||(H={dataMin:V(ue&&ue.min,L("min",ie.min,W.dataMin,ne.dataMin,ne.min)),dataMax:V(ue&&ue.max,L("max",ie.max,W.dataMax,ne.dataMax,ne.max))}),H}setBaseSeries(F,H){let W=this.chart,ne=this.baseSeries=[];F=F||W.options&&W.options.navigator.baseSeries||(W.series.length?z(W.series,ue=>!ue.options.isInternal).index:0),(W.series||[]).forEach((ue,ie)=>{!ue.options.isInternal&&(ue.options.showInNavigator||(ie===F||ue.options.id===F)&&ue.options.showInNavigator!==!1)&&ne.push(ue)}),this.xAxis&&!this.xAxis.navigatorAxis.fake&&this.updateNavigatorSeries(!0,H)}updateNavigatorSeries(F,H){var Q,ae;let W=this,ne=W.chart,ue=W.baseSeries,ie={enableMouseTracking:!1,index:null,linkedTo:null,group:"nav",padXAxis:!1,xAxis:(Q=this.navigatorOptions.xAxis)==null?void 0:Q.id,yAxis:(ae=this.navigatorOptions.yAxis)==null?void 0:ae.id,showInLegend:!1,stacking:void 0,isInternal:!0,states:{inactive:{opacity:1}}},oe=W.series=(W.series||[]).filter(ye=>{let J=ye.baseSeries;return!(0>ue.indexOf(J))||(J&&($(J,"updatedData",W.updatedDataHandler),delete J.navigatorSeries),ye.chart&&ye.destroy(),!1)}),Te,ge,we=W.navigatorOptions.series,K;ue&&ue.length&&ue.forEach(ye=>{let J=ye.navigatorSeries,re=M({color:ye.color,visible:ye.visible},X(we)?P.navigator.series:we);if(J&&W.navigatorOptions.adaptToUpdatedData===!1)return;ie.name="Navigator "+ue.length,K=(Te=ye.options||{}).navigatorOptions||{},re.dataLabels=R(re.dataLabels),(ge=j(Te,ie,re,K)).pointRange=V(re.pointRange,K.pointRange,P.plotOptions[ge.type||"line"].pointRange);let ce=K.data||re.data;W.hasNavigatorData=W.hasNavigatorData||!!ce,ge.data=ce||Te.data&&Te.data.slice(0),J&&J.options?J.update(ge,H):(ye.navigatorSeries=ne.initSeries(ge),ne.setSortedData(),ye.navigatorSeries.baseSeries=ye,oe.push(ye.navigatorSeries))}),(we.data&&!(ue&&ue.length)||X(we))&&(W.hasNavigatorData=!1,(we=R(we)).forEach((ye,J)=>{ie.name="Navigator "+(oe.length+1),(ge=j(P.navigator.series,{color:ne.series[J]&&!ne.series[J].options.isInternal&&ne.series[J].color||ne.options.colors[J]||ne.options.colors[0]},ie,ye)).data=ye.data,ge.data&&(W.hasNavigatorData=!0,oe.push(ne.initSeries(ge)))})),F&&this.addBaseSeriesEvents()}addBaseSeriesEvents(){let F=this,H=F.baseSeries||[];H[0]&&H[0].xAxis&&H[0].eventsToUnbind.push(k(H[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes)),H.forEach(W=>{W.eventsToUnbind.push(k(W,"show",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!0,!1)})),W.eventsToUnbind.push(k(W,"hide",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!1,!1)})),this.navigatorOptions.adaptToUpdatedData!==!1&&W.xAxis&&W.eventsToUnbind.push(k(W,"updatedData",this.updatedDataHandler)),W.eventsToUnbind.push(k(W,"remove",function(){w(H,W),this.navigatorSeries&&(w(F.series,this.navigatorSeries),I(this.navigatorSeries.options)&&this.navigatorSeries.remove(!1),delete this.navigatorSeries)}))})}getBaseSeriesMin(F){return this.baseSeries.reduce(function(H,W){return Math.min(H,W.xData&&W.xData.length?W.xData[0]:H)},F)}modifyNavigatorAxisExtremes(){let F=this.xAxis;if(F.getExtremes!==void 0){let H=this.getUnionExtremes(!0);H&&(H.dataMin!==F.min||H.dataMax!==F.max)&&(F.min=H.dataMin,F.max=H.dataMax)}}modifyBaseAxisExtremes(){var J;let F,H,W=this.chart.navigator,ne=this.getExtremes(),ue=ne.min,ie=ne.max,oe=ne.dataMin,Te=ne.dataMax,ge=ie-ue,we=W.stickToMin,K=W.stickToMax,Q=V((J=this.ordinal)==null?void 0:J.convertOverscroll(this.options.overscroll),0),ae=W.series&&W.series[0],ye=!!this.setExtremes;!(this.eventArgs&&this.eventArgs.trigger==="rangeSelectorButton")&&(we&&(F=(H=oe)+ge),K&&(F=Te+Q,we||(H=Math.max(oe,F-ge,W.getBaseSeriesMin(ae&&ae.xData?ae.xData[0]:-Number.MAX_VALUE)))),ye&&(we||K)&&Z(H)&&(this.min=this.userMin=H,this.max=this.userMax=F)),W.stickToMin=W.stickToMax=null}updatedDataHandler(){let F=this.chart.navigator,H=this.navigatorSeries,W=F.reversedExtremes?Math.round(F.zoomedMin)===0:Math.round(F.zoomedMax)>=Math.round(F.size);F.stickToMax=V(this.chart.options.navigator&&this.chart.options.navigator.stickToMax,W),F.stickToMin=F.shouldStickToMin(this,F),H&&!F.hasNavigatorData&&(H.options.pointStart=this.xData[0],H.setData(this.options.data,!1,null,!1))}shouldStickToMin(F,H){let W=H.getBaseSeriesMin(F.xData[0]),ne=F.xAxis,ue=ne.max,ie=ne.min,oe=ne.options.range;return!!(Z(ue)&&Z(ie))&&(oe&&ue-W>0?ue-W<oe:ie<=W)}addChartEvents(){this.eventsToUnbind||(this.eventsToUnbind=[]),this.eventsToUnbind.push(k(this.chart,"redraw",function(){let F=this.navigator,H=F&&(F.baseSeries&&F.baseSeries[0]&&F.baseSeries[0].xAxis||this.xAxis[0]);H&&F.render(H.min,H.max)}),k(this.chart,"getMargins",function(){let F=this.navigator,H=F.opposite?"plotTop":"marginBottom";this.inverted&&(H=F.opposite?"marginRight":"plotLeft"),this[H]=(this[H]||0)+(F.navigatorEnabled||!this.inverted?F.height+F.scrollbarHeight:0)+F.navigatorOptions.margin}),k(G,"setRange",function(F){this.chart.xAxis[0].setExtremes(F.min,F.max,F.redraw,F.animation,F.eventArguments)}))}destroy(){this.removeEvents(),this.xAxis&&(w(this.chart.xAxis,this.xAxis),w(this.chart.axes,this.xAxis)),this.yAxis&&(w(this.chart.yAxis,this.yAxis),w(this.chart.axes,this.yAxis)),(this.series||[]).forEach(F=>{F.destroy&&F.destroy()}),["series","xAxis","yAxis","shades","outline","scrollbarTrack","scrollbarRifles","scrollbarGroup","scrollbar","navigatorGroup","rendered"].forEach(F=>{this[F]&&this[F].destroy&&this[F].destroy(),this[F]=null}),[this.handles].forEach(F=>{D(F)}),this.navigatorEnabled=!1}}return G}),c(t,"Accessibility/Components/NavigatorComponent.js",[t["Accessibility/AccessibilityComponent.js"],t["Accessibility/Utils/Announcer.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Stock/Navigator/Navigator.js"],t["Core/Animation/AnimationUtilities.js"],t["Core/Templating.js"],t["Core/Utilities.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Accessibility/Utils/ChartUtilities.js"]],function(a,h,d,s,f,b,x,v,g){let{animObject:P}=f,{format:_}=b,{clamp:S,pick:k,syncTimeout:A}=x,{getFakeMouseEvent:y}=v,{getAxisRangeDescription:I,fireEventOnWrappedOrUnwrappedElement:D}=g;return class extends a{init(){let w=this.chart,M=this;this.announcer=new h(w,"polite"),this.addEvent(s,"afterRender",function(){this.chart===M.chart&&this.chart.renderer&&A(()=>{M.proxyProvider.updateGroupProxyElementPositions("navigator"),M.updateHandleValues()},P(k(this.chart.renderer.globalAnimation,!0)).duration)})}onChartUpdate(){var Y,X,Z;let w=this.chart,M=w.options,z=M.navigator;if(z.enabled&&((Y=z.accessibility)!=null&&Y.enabled)){let j=M.accessibility.landmarkVerbosity,V=(X=M.lang.accessibility)==null?void 0:X.navigator.groupLabel;this.proxyProvider.removeGroup("navigator"),this.proxyProvider.addGroup("navigator","div",{role:j==="all"?"region":"group","aria-label":_(V,{chart:w},w)});let $=(Z=M.lang.accessibility)==null?void 0:Z.navigator.handleLabel;[0,1].forEach(R=>{let L=this.getHandleByIx(R);if(L){let G=this.proxyProvider.addProxyElement("navigator",{click:L},"input",{type:"range","aria-label":_($,{handleIx:R,chart:w},w)});this[R?"maxHandleProxy":"minHandleProxy"]=G.innerElement,G.innerElement.style.pointerEvents="none",G.innerElement.oninput=()=>this.updateNavigator()}}),this.updateHandleValues()}else this.proxyProvider.removeGroup("navigator")}getNavigatorHandleNavigation(w){let M=this,z=this.chart,Y=w?this.maxHandleProxy:this.minHandleProxy,X=this.keyCodes;return new d(z,{keyCodeMap:[[[X.left,X.right,X.up,X.down],function(Z){if(Y){let j=Z===X.left||Z===X.up?-1:1;Y.value=""+S(parseFloat(Y.value)+j,0,100),M.updateNavigator(()=>{let V=M.getHandleByIx(w);V&&z.setFocusToElement(V,Y)})}return this.response.success}]],init:()=>{z.setFocusToElement(this.getHandleByIx(w),Y)},validate:()=>{var Z;return!!(this.getHandleByIx(w)&&Y&&((Z=z.options.navigator.accessibility)!=null&&Z.enabled))}})}getKeyboardNavigation(){return[this.getNavigatorHandleNavigation(0),this.getNavigatorHandleNavigation(1)]}destroy(){this.updateNavigatorThrottleTimer&&clearTimeout(this.updateNavigatorThrottleTimer),this.proxyProvider.removeGroup("navigator"),this.announcer&&this.announcer.destroy()}updateHandleValues(){let w=this.chart.navigator;if(w&&this.minHandleProxy&&this.maxHandleProxy){let M=w.size;this.minHandleProxy.value=""+Math.round(w.zoomedMin/M*100),this.maxHandleProxy.value=""+Math.round(w.zoomedMax/M*100)}}getHandleByIx(w){let M=this.chart.navigator;return M&&M.handles&&M.handles[w]}updateNavigator(w){this.updateNavigatorThrottleTimer&&clearTimeout(this.updateNavigatorThrottleTimer),this.updateNavigatorThrottleTimer=setTimeout((M=>{var Z;let z=this.chart,{navigator:Y,pointer:X}=z;if(Y&&X&&this.minHandleProxy&&this.maxHandleProxy){let j=X.getChartPosition(),V=parseFloat(this.minHandleProxy.value)/100*Y.size,$=parseFloat(this.maxHandleProxy.value)/100*Y.size;[[0,"mousedown",Y.zoomedMin],[0,"mousemove",V],[0,"mouseup",V],[1,"mousedown",Y.zoomedMax],[1,"mousemove",$],[1,"mouseup",$]].forEach(([G,U,F])=>{var W;let H=(W=this.getHandleByIx(G))==null?void 0:W.element;H&&D(H,y(U,{x:j.left+Y.left+F,y:j.top+Y.top},H))}),M&&M();let R=(Z=z.options.lang.accessibility)==null?void 0:Z.navigator.changeAnnouncement,L=I(z.xAxis[0]);this.announcer.announce(_(R,{axisRangeDescription:L,chart:z},z))}}).bind(this,w),20)}}}),c(t,"Accessibility/Components/SeriesComponent/SeriesDescriber.js",[t["Accessibility/Components/AnnotationsA11y.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Core/Templating.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Core/Utilities.js"]],function(a,h,d,s,f){let{getPointAnnotationTexts:b}=a,{getAxisDescription:x,getSeriesFirstPointElement:v,getSeriesA11yElement:g,unhideChartElementFromAT:P}=h,{format:_,numberFormat:S}=d,{reverseChildNodes:k,stripHTMLTagsFromString:A}=s,{find:y,isNumber:I,isString:D,pick:w,defined:M}=f;function z(V){let $=V.chart.options.accessibility.series.pointDescriptionEnabledThreshold;return!!($!==!1&&V.points&&V.points.length>=+$)}function Y(V,$){let R=V.series,L=R.chart,G=L.options.accessibility.point||{},U=R.options.accessibility&&R.options.accessibility.point||{},F=R.tooltipOptions||{},H=L.options.lang;return I($)?S($,U.valueDecimals||G.valueDecimals||F.valueDecimals||-1,H.decimalPoint,H.accessibility.thousandsSep||H.thousandsSep):$}function X(V,$){let R=V[$];return V.chart.langFormat("accessibility.series."+$+"Description",{name:x(R),series:V})}function Z(V){let $=V.series,R=$.chart.series.length>1||$.options.name,L=function(H){let W=H.series,ne=W.chart,ue=W.options.accessibility,ie=ue&&ue.point&&ue.point.valueDescriptionFormat||ne.options.accessibility.point.valueDescriptionFormat,oe=w(W.xAxis&&W.xAxis.options.accessibility&&W.xAxis.options.accessibility.enabled,!ne.angular&&W.type!=="flowmap"),Te=oe?function(ge){let we=function(ye){let J=ye.series,re=J.chart,ce=J.options.accessibility&&J.options.accessibility.point||{},pe=re.options.accessibility.point||{},xe=J.xAxis&&J.xAxis.dateTime;if(xe){let Me=xe.getXDateFormat(ye.x||0,re.options.tooltip.dateTimeLabelFormats),_e=ce.dateFormatter&&ce.dateFormatter(ye)||pe.dateFormatter&&pe.dateFormatter(ye)||ce.dateFormat||pe.dateFormat||Me;return re.time.dateFormat(_e,ye.x||0,void 0)}}(ge),K=(ge.series.xAxis||{}).categories&&M(ge.category)&&(""+ge.category).replace("<br/>"," "),Q=M(ge.id)&&0>(""+ge.id).indexOf("highcharts-"),ae="x, "+ge.x;return ge.name||we||K||(Q?ge.id:ae)}(H):"";return _(ie,{point:H,index:M(H.index)?H.index+1:"",xDescription:Te,value:function(ge){let we=ge.series,K=we.chart.options.accessibility.point||{},Q=we.chart.options.accessibility&&we.chart.options.accessibility.point||{},ae=we.tooltipOptions||{},ye=Q.valuePrefix||K.valuePrefix||ae.valuePrefix||"",J=Q.valueSuffix||K.valueSuffix||ae.valueSuffix||"",re=ge.value!==void 0?"value":"y",ce=Y(ge,ge[re]);return ge.isNull?we.chart.langFormat("accessibility.series.nullPointValue",{point:ge}):we.pointArrayMap?function(pe,xe,Me){let _e=xe||"",Ce=Me||"",Le=function(Ue){let Xe=Y(pe,w(pe[Ue],pe.options[Ue]));return Xe!==void 0?Ue+": "+_e+Xe+Ce:Xe};return pe.series.pointArrayMap.reduce(function(Ue,Xe){let Pe=Le(Xe);return Pe?Ue+(Ue.length?", ":"")+Pe:Ue},"")}(ge,ye,J):ye+ce+J}(H),separator:oe?", ":""},ne)}(V),G=V.options&&V.options.accessibility&&V.options.accessibility.description,U=R?" "+$.name+".":"",F=function(H){let W=H.series.chart,ne=b(H);return ne.length?W.langFormat("accessibility.series.pointAnnotationsDescription",{point:H,annotations:ne}):""}(V);return V.accessibility=V.accessibility||{},V.accessibility.valueDescription=L,L+(G?" "+G:"")+U+(F?" "+F:"")}function j(V){let $=V.chart,R=$.types||[],L=function(oe){let Te=(oe.options.accessibility||{}).description;return Te&&oe.chart.langFormat("accessibility.series.description",{description:Te,series:oe})||""}(V),G=function(oe){return $[oe]&&$[oe].length>1&&V[oe]},U=V.index+1,F=X(V,"xAxis"),H=X(V,"yAxis"),W={seriesNumber:U,series:V,chart:$},ne=R.length>1?"Combination":"",ue=$.langFormat("accessibility.series.summary."+V.type+ne,W)||$.langFormat("accessibility.series.summary.default"+ne,W),ie=(G("yAxis")?" "+H+".":"")+(G("xAxis")?" "+F+".":"");return _(w(V.options.accessibility&&V.options.accessibility.descriptionFormat,$.options.accessibility.series.descriptionFormat,""),{seriesDescription:ue,authorDescription:L?" "+L:"",axisDescription:ie,series:V,chart:$,seriesNumber:U},void 0)}return{defaultPointDescriptionFormatter:Z,defaultSeriesDescriptionFormatter:j,describeSeries:function(V){let $=V.chart,R=v(V),L=g(V),G=$.is3d&&$.is3d();L&&(L.lastChild!==R||G||k(L),function(U){let F=function(ne){let ue=ne.options.accessibility||{};return!z(ne)&&!ue.exposeAsGroupOnly}(U),H=function(ne){let ue=ne.chart.options.accessibility.keyboardNavigation.seriesNavigation;return!!(ne.points&&(ne.points.length<+ue.pointNavigationEnabledThreshold||ue.pointNavigationEnabledThreshold===!1))}(U),W=U.chart.options.accessibility.point.describeNull;(F||H)&&U.points.forEach(ne=>{let ue=ne.graphic&&ne.graphic.element||function(oe){let Te=oe.series,ge=Te&&Te.chart,we=Te&&Te.is("sunburst"),K=oe.isNull,Q=ge&&ge.options.accessibility.point.describeNull;return K&&!we&&Q}(ne)&&function(oe){let Te=oe.series,ge=function(ye){let J=ye.index;return ye.series&&ye.series.data&&M(J)&&y(ye.series.data,function(re){return!!(re&&re.index!==void 0&&re.index>J&&re.graphic&&re.graphic.element)})||null}(oe),we=ge&&ge.graphic,K=we?we.parentGroup:Te.graph||Te.group,Q=ge?{x:w(oe.plotX,ge.plotX,0),y:w(oe.plotY,ge.plotY,0)}:{x:w(oe.plotX,0),y:w(oe.plotY,0)},ae=function(ye,J){let re=ye.series.chart.renderer.rect(J.x,J.y,1,1);return re.attr({class:"highcharts-a11y-mock-point",fill:"none",opacity:0,"fill-opacity":0,"stroke-opacity":0}),re}(oe,Q);if(K&&K.element)return oe.graphic=ae,oe.hasMockGraphic=!0,ae.add(K),K.element.insertBefore(ae.element,we?we.element:null),ae.element}(ne),ie=ne.options&&ne.options.accessibility&&ne.options.accessibility.enabled===!1;if(ue){if(ne.isNull&&!W){ue.setAttribute("aria-hidden",!0);return}ue.setAttribute("tabindex","-1"),U.chart.styledMode||(ue.style.outline="none"),F&&!ie?function(oe,Te){var ae,ye,J;let ge=oe.series,we=((ae=ge.options.accessibility)==null?void 0:ae.point)||{},K=ge.chart.options.accessibility.point||{},Q=A(D(we.descriptionFormat)&&_(we.descriptionFormat,oe,ge.chart)||((ye=we.descriptionFormatter)==null?void 0:ye.call(we,oe))||D(K.descriptionFormat)&&_(K.descriptionFormat,oe,ge.chart)||((J=K.descriptionFormatter)==null?void 0:J.call(K,oe))||Z(oe),ge.chart.renderer.forExport);Te.setAttribute("role","img"),Te.setAttribute("aria-label",Q)}(ne,ue):ue.setAttribute("aria-hidden",!0)}})}(V),P($,L),function(U){let F=U.chart,H=F.options.chart,W=H.options3d&&H.options3d.enabled,ne=F.series.length>1,ue=F.options.accessibility.series.describeSingleSeries,ie=(U.options.accessibility||{}).exposeAsGroupOnly;return!(W&&ne)&&(ne||ue||ie||z(U))}(V)?function(U,F){let H=U.options.accessibility||{},W=U.chart.options.accessibility,ne=W.landmarkVerbosity;H.exposeAsGroupOnly?F.setAttribute("role","img"):ne==="all"?F.setAttribute("role","region"):F.setAttribute("role","group"),F.setAttribute("tabindex","-1"),U.chart.styledMode||(F.style.outline="none"),F.setAttribute("aria-label",A(W.series.descriptionFormatter&&W.series.descriptionFormatter(U)||j(U),U.chart.renderer.forExport))}(V,L):L.removeAttribute("aria-label"))}}}),c(t,"Accessibility/Components/SeriesComponent/NewDataAnnouncer.js",[t["Core/Globals.js"],t["Core/Utilities.js"],t["Accessibility/Utils/Announcer.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/EventProvider.js"],t["Accessibility/Components/SeriesComponent/SeriesDescriber.js"]],function(a,h,d,s,f,b){let{composed:x}=a,{addEvent:v,defined:g,pushUnique:P}=h,{getChartTitle:_}=s,{defaultPointDescriptionFormatter:S,defaultSeriesDescriptionFormatter:k}=b;function A(I){return!!I.options.accessibility.announceNewData.enabled}class y{constructor(D){this.dirty={allSeries:{}},this.lastAnnouncementTime=0,this.chart=D}init(){let D=this.chart,w=D.options.accessibility.announceNewData.interruptUser?"assertive":"polite";this.lastAnnouncementTime=0,this.dirty={allSeries:{}},this.eventProvider=new f,this.announcer=new d(D,w),this.addEventListeners()}destroy(){this.eventProvider.removeAddedEvents(),this.announcer.destroy()}addEventListeners(){let D=this,w=this.chart,M=this.eventProvider;M.addEvent(w,"afterApplyDrilldown",function(){D.lastAnnouncementTime=0}),M.addEvent(w,"afterAddSeries",function(z){D.onSeriesAdded(z.series)}),M.addEvent(w,"redraw",function(){D.announceDirtyData()})}onSeriesAdded(D){A(this.chart)&&(this.dirty.hasDirty=!0,this.dirty.allSeries[D.name+D.index]=D,this.dirty.newSeries=g(this.dirty.newSeries)?void 0:D)}announceDirtyData(){let D=this.chart,w=this;if(D.options.accessibility.announceNewData&&this.dirty.hasDirty){let M=this.dirty.newPoint;M&&(M=function(z){let Y=z.series.data.filter(X=>z.x===X.x&&z.y===X.y);return Y.length===1?Y[0]:z}(M)),this.queueAnnouncement(Object.keys(this.dirty.allSeries).map(z=>w.dirty.allSeries[z]),this.dirty.newSeries,M),this.dirty={allSeries:{}}}}queueAnnouncement(D,w,M){let z=this.chart.options.accessibility.announceNewData;if(z.enabled){let Y=+new Date,X=Y-this.lastAnnouncementTime,Z=Math.max(0,z.minAnnounceInterval-X),j=function($,R){let L=($||[]).concat(R||[]).reduce((G,U)=>(G[U.name+U.index]=U,G),{});return Object.keys(L).map(G=>L[G])}(this.queuedAnnouncement&&this.queuedAnnouncement.series,D),V=this.buildAnnouncementMessage(j,w,M);V&&(this.queuedAnnouncement&&clearTimeout(this.queuedAnnouncementTimer),this.queuedAnnouncement={time:Y,message:V,series:j},this.queuedAnnouncementTimer=setTimeout(()=>{this&&this.announcer&&(this.lastAnnouncementTime=+new Date,this.announcer.announce(this.queuedAnnouncement.message),delete this.queuedAnnouncement,delete this.queuedAnnouncementTimer)},Z))}}buildAnnouncementMessage(D,w,M){let z=this.chart,Y=z.options.accessibility.announceNewData;if(Y.announcementFormatter){let V=Y.announcementFormatter(D,w,M);if(V!==!1)return V.length?V:null}let X=a.charts&&a.charts.length>1?"Multiple":"Single",Z=w?"newSeriesAnnounce"+X:M?"newPointAnnounce"+X:"newDataAnnounce",j=_(z);return z.langFormat("accessibility.announceNewData."+Z,{chartTitle:j,seriesDesc:w?k(w):null,pointDesc:M?S(M):null,point:M,series:w})}}return function(I){function D(M){var X;let z=this.chart,Y=(X=z.accessibility)==null?void 0:X.components.series.newDataAnnouncer;Y&&Y.chart===z&&A(z)&&(Y.dirty.newPoint=g(Y.dirty.newPoint)?void 0:M.point)}function w(){var Y;let M=this.chart,z=(Y=M.accessibility)==null?void 0:Y.components.series.newDataAnnouncer;z&&z.chart===M&&A(M)&&(z.dirty.hasDirty=!0,z.dirty.allSeries[this.name+this.index]=this)}I.compose=function(M){P(x,"A11y.NDA")&&(v(M,"addPoint",D),v(M,"updatedData",w))}}(y),y}),c(t,"Accessibility/ProxyElement.js",[t["Core/Globals.js"],t["Core/Utilities.js"],t["Accessibility/Utils/EventProvider.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/HTMLUtilities.js"]],function(a,h,d,s,f){let{doc:b}=a,{attr:x,css:v,merge:g}=h,{fireEventOnWrappedOrUnwrappedElement:P}=s,{cloneMouseEvent:_,cloneTouchEvent:S,getFakeMouseEvent:k,removeElement:A}=f;return class{constructor(y,I,D="button",w,M){this.chart=y,this.target=I,this.eventProvider=new d;let z=this.innerElement=b.createElement(D),Y=this.element=w?b.createElement(w):z;y.styledMode||this.hideElementVisually(z),w&&(w!=="li"||y.styledMode||(Y.style.listStyle="none"),Y.appendChild(z),this.element=Y),this.updateTarget(I,M)}click(){let y=this.getTargetPosition();y.x+=y.width/2,y.y+=y.height/2;let I=k("click",y);P(this.target.click,I)}updateTarget(y,I){this.target=y,this.updateCSSClassName();let D=I||{};Object.keys(D).forEach(M=>{D[M]===null&&delete D[M]});let w=this.getTargetAttr(y.click,"aria-label");x(this.innerElement,g(w?{"aria-label":w}:{},D)),this.eventProvider.removeAddedEvents(),this.addProxyEventsToElement(this.innerElement,y.click),this.refreshPosition()}refreshPosition(){let y=this.getTargetPosition();v(this.innerElement,{width:(y.width||1)+"px",height:(y.height||1)+"px",left:(Math.round(y.x)||0)+"px",top:(Math.round(y.y)||0)+"px"})}remove(){this.eventProvider.removeAddedEvents(),A(this.element)}updateCSSClassName(){let y=z=>z.indexOf("highcharts-no-tooltip")>-1,I=this.chart.legend,D=I.group&&I.group.div,w=y(D&&D.className||""),M=y(this.getTargetAttr(this.target.click,"class")||"");this.innerElement.className=w||M?"highcharts-a11y-proxy-element highcharts-no-tooltip":"highcharts-a11y-proxy-element"}addProxyEventsToElement(y,I){["click","touchstart","touchend","touchcancel","touchmove","mouseover","mouseenter","mouseleave","mouseout"].forEach(D=>{let w=D.indexOf("touch")===0;this.eventProvider.addEvent(y,D,M=>{let z=w?S(M):_(M);I&&P(I,z),M.stopPropagation(),w||M.preventDefault()},{passive:!1})})}hideElementVisually(y){v(y,{borderWidth:0,backgroundColor:"transparent",cursor:"pointer",outline:"none",opacity:.001,filter:"alpha(opacity=1)",zIndex:999,overflow:"hidden",padding:0,margin:0,display:"block",position:"absolute","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=1)"})}getTargetPosition(){let y=this.target.click,I=y.element?y.element:y,D=this.target.visual||I,w=this.chart.renderTo,M=this.chart.pointer;if(w&&(D!=null&&D.getBoundingClientRect)&&M){let z=D.getBoundingClientRect(),Y=M.getChartPosition();return{x:(z.left-Y.left)/Y.scaleX,y:(z.top-Y.top)/Y.scaleY,width:z.right/Y.scaleX-z.left/Y.scaleX,height:z.bottom/Y.scaleY-z.top/Y.scaleY}}return{x:0,y:0,width:1,height:1}}getTargetAttr(y,I){return y.element?y.element.getAttribute(I):y.getAttribute(I)}}}),c(t,"Accessibility/ProxyProvider.js",[t["Core/Globals.js"],t["Core/Utilities.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/DOMElementProvider.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Accessibility/ProxyElement.js"]],function(a,h,d,s,f,b){let{doc:x}=a,{attr:v,css:g}=h,{unhideChartElementFromAT:P}=d,{removeChildNodes:_}=f;return class{constructor(S){this.chart=S,this.domElementProvider=new s,this.groups={},this.groupOrder=[],this.beforeChartProxyPosContainer=this.createProxyPosContainer("before"),this.afterChartProxyPosContainer=this.createProxyPosContainer("after"),this.update()}addProxyElement(S,k,A="button",y){let I=this.groups[S];if(!I)throw Error("ProxyProvider.addProxyElement: Invalid group key "+S);let D=I.type==="ul"||I.type==="ol"?"li":void 0,w=new b(this.chart,k,A,D,y);return I.proxyContainerElement.appendChild(w.element),I.proxyElements.push(w),w}addGroup(S,k="div",A){let y,I=this.groups[S];if(I)return I.groupElement;let D=this.domElementProvider.createElement(k);return A&&A.role&&k!=="div"?(y=this.domElementProvider.createElement("div")).appendChild(D):y=D,y.className="highcharts-a11y-proxy-group highcharts-a11y-proxy-group-"+S.replace(/\W/g,"-"),this.groups[S]={proxyContainerElement:D,groupElement:y,type:k,proxyElements:[]},v(y,A||{}),k==="ul"&&D.setAttribute("role","list"),this.afterChartProxyPosContainer.appendChild(y),this.updateGroupOrder(this.groupOrder),y}updateGroupAttrs(S,k){let A=this.groups[S];if(!A)throw Error("ProxyProvider.updateGroupAttrs: Invalid group key "+S);v(A.groupElement,k)}updateGroupOrder(S){if(this.groupOrder=S.slice(),this.isDOMOrderGroupOrder())return;let k=S.indexOf("series"),A=k>-1?S.slice(0,k):S,y=k>-1?S.slice(k+1):[],I=x.activeElement;["before","after"].forEach(D=>{let w=this[D==="before"?"beforeChartProxyPosContainer":"afterChartProxyPosContainer"];_(w),(D==="before"?A:y).forEach(M=>{let z=this.groups[M];z&&w.appendChild(z.groupElement)})}),(this.beforeChartProxyPosContainer.contains(I)||this.afterChartProxyPosContainer.contains(I))&&I&&I.focus&&I.focus()}clearGroup(S){let k=this.groups[S];if(!k)throw Error("ProxyProvider.clearGroup: Invalid group key "+S);_(k.proxyContainerElement)}removeGroup(S){let k=this.groups[S];k&&(this.domElementProvider.removeElement(k.groupElement),k.groupElement!==k.proxyContainerElement&&this.domElementProvider.removeElement(k.proxyContainerElement),delete this.groups[S])}update(){this.updatePosContainerPositions(),this.updateGroupOrder(this.groupOrder),this.updateProxyElementPositions()}updateProxyElementPositions(){Object.keys(this.groups).forEach(this.updateGroupProxyElementPositions.bind(this))}updateGroupProxyElementPositions(S){let k=this.groups[S];k&&k.proxyElements.forEach(A=>A.refreshPosition())}destroy(){this.domElementProvider.destroyCreatedElements()}createProxyPosContainer(S){let k=this.domElementProvider.createElement("div");return k.setAttribute("aria-hidden","false"),k.className="highcharts-a11y-proxy-container"+(S?"-"+S:""),g(k,{top:"0",left:"0"}),this.chart.styledMode||(k.style.whiteSpace="nowrap",k.style.position="absolute"),k}getCurrentGroupOrderInDOM(){let S=I=>{let D=Object.keys(this.groups),w=D.length;for(;w--;){let M=D[w],z=this.groups[M];if(z&&I===z.groupElement)return M}},k=I=>{let D=[],w=I.children;for(let M=0;M<w.length;++M){let z=S(w[M]);z&&D.push(z)}return D},A=k(this.beforeChartProxyPosContainer),y=k(this.afterChartProxyPosContainer);return A.push("series"),A.concat(y)}isDOMOrderGroupOrder(){let S=this.getCurrentGroupOrderInDOM(),k=this.groupOrder.filter(y=>y==="series"||!!this.groups[y]),A=S.length;if(A!==k.length)return!1;for(;A--;)if(S[A]!==k[A])return!1;return!0}updatePosContainerPositions(){let S=this.chart;if(S.renderer.forExport)return;let k=S.renderer.box;S.container.insertBefore(this.afterChartProxyPosContainer,k.nextSibling),S.container.insertBefore(this.beforeChartProxyPosContainer,k),P(this.chart,this.afterChartProxyPosContainer),P(this.chart,this.beforeChartProxyPosContainer)}}}),c(t,"Accessibility/Components/RangeSelectorComponent.js",[t["Accessibility/AccessibilityComponent.js"],t["Accessibility/Utils/Announcer.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Core/Utilities.js"]],function(a,h,d,s,f){let{unhideChartElementFromAT:b,getAxisRangeDescription:x}=d,{addEvent:v,attr:g}=f;class P extends a{init(){let S=this.chart;this.announcer=new h(S,"polite")}onChartUpdate(){let S=this.chart,k=this,A=S.rangeSelector;A&&(this.updateSelectorVisibility(),this.setDropdownAttrs(),A.buttons&&A.buttons.length&&A.buttons.forEach(y=>{k.setRangeButtonAttrs(y)}),A.maxInput&&A.minInput&&["minInput","maxInput"].forEach(function(y,I){let D=A[y];D&&(b(S,D),k.setRangeInputAttrs(D,"accessibility.rangeSelector."+(I?"max":"min")+"InputLabel"))}))}updateSelectorVisibility(){let S=this.chart,k=S.rangeSelector,A=k&&k.dropdown,y=k&&k.buttons||[],I=D=>D.setAttribute("aria-hidden",!0);k&&k.hasVisibleDropdown&&A?(b(S,A),y.forEach(D=>I(D.element))):(A&&I(A),y.forEach(D=>b(S,D.element)))}setDropdownAttrs(){let S=this.chart,k=S.rangeSelector&&S.rangeSelector.dropdown;if(k){let A=S.langFormat("accessibility.rangeSelector.dropdownLabel",{rangeTitle:S.options.lang.rangeSelectorZoom});k.setAttribute("aria-label",A),k.setAttribute("tabindex",-1)}}setRangeButtonAttrs(S){g(S.element,{tabindex:-1,role:"button"})}setRangeInputAttrs(S,k){let A=this.chart;g(S,{tabindex:-1,"aria-label":A.langFormat(k,{chart:A})})}onButtonNavKbdArrowKey(S,k){let A=S.response,y=this.keyCodes,I=this.chart,D=I.options.accessibility.keyboardNavigation.wrapAround,w=k===y.left||k===y.up?-1:1;return I.highlightRangeSelectorButton(I.highlightedRangeSelectorItemIx+w)?A.success:D?(S.init(w),A.success):A[w>0?"next":"prev"]}onButtonNavKbdClick(S){let k=S.response,A=this.chart;return A.oldRangeSelectorItemState!==3&&this.fakeClickEvent(A.rangeSelector.buttons[A.highlightedRangeSelectorItemIx].element),k.success}onAfterBtnClick(){let S=this.chart,k=x(S.xAxis[0]),A=S.langFormat("accessibility.rangeSelector.clickButtonAnnouncement",{chart:S,axisRangeDescription:k});A&&this.announcer.announce(A)}onInputKbdMove(S){let k=this.chart,A=k.rangeSelector,y=k.highlightedInputRangeIx=(k.highlightedInputRangeIx||0)+S;if(y>1||y<0){if(k.accessibility)return k.accessibility.keyboardNavigation.exiting=!0,k.accessibility.keyboardNavigation.tabindexContainer.focus(),k.accessibility.keyboardNavigation.move(S)}else if(A){let I=A[y?"maxDateBox":"minDateBox"],D=A[y?"maxInput":"minInput"];I&&D&&k.setFocusToElement(I,D)}return!0}onInputNavInit(S){let k=this,A=this.chart,y=S>0?0:1,I=A.rangeSelector,D=I&&I[y?"maxDateBox":"minDateBox"],w=I&&I.minInput,M=I&&I.maxInput;if(A.highlightedInputRangeIx=y,D&&w&&M){A.setFocusToElement(D,y?M:w),this.removeInputKeydownHandler&&this.removeInputKeydownHandler();let z=Z=>{(Z.which||Z.keyCode)===this.keyCodes.tab&&k.onInputKbdMove(Z.shiftKey?-1:1)&&(Z.preventDefault(),Z.stopPropagation())},Y=v(w,"keydown",z),X=v(M,"keydown",z);this.removeInputKeydownHandler=()=>{Y(),X()}}}onInputNavTerminate(){let S=this.chart.rangeSelector||{};S.maxInput&&S.hideInput("max"),S.minInput&&S.hideInput("min"),this.removeInputKeydownHandler&&(this.removeInputKeydownHandler(),delete this.removeInputKeydownHandler)}initDropdownNav(){let S=this.chart,k=S.rangeSelector,A=k&&k.dropdown;k&&A&&(S.setFocusToElement(k.buttonGroup,A),this.removeDropdownKeydownHandler&&this.removeDropdownKeydownHandler(),this.removeDropdownKeydownHandler=v(A,"keydown",y=>{let I=(y.which||y.keyCode)===this.keyCodes.tab,D=S.accessibility;I&&(y.preventDefault(),y.stopPropagation(),D&&(D.keyboardNavigation.tabindexContainer.focus(),D.keyboardNavigation.move(y.shiftKey?-1:1)))}))}getRangeSelectorButtonNavigation(){let S=this.chart,k=this.keyCodes,A=this;return new s(S,{keyCodeMap:[[[k.left,k.right,k.up,k.down],function(y){return A.onButtonNavKbdArrowKey(this,y)}],[[k.enter,k.space],function(){return A.onButtonNavKbdClick(this)}]],validate:function(){return!!(S.rangeSelector&&S.rangeSelector.buttons&&S.rangeSelector.buttons.length)},init:function(y){let I=S.rangeSelector;if(I&&I.hasVisibleDropdown)A.initDropdownNav();else if(I){let D=I.buttons.length-1;S.highlightRangeSelectorButton(y>0?0:D)}},terminate:function(){A.removeDropdownKeydownHandler&&(A.removeDropdownKeydownHandler(),delete A.removeDropdownKeydownHandler)}})}getRangeSelectorInputNavigation(){let S=this.chart,k=this;return new s(S,{keyCodeMap:[],validate:function(){return!!(S.rangeSelector&&S.rangeSelector.inputGroup&&S.rangeSelector.inputGroup.element.style.visibility!=="hidden"&&S.options.rangeSelector.inputEnabled!==!1&&S.rangeSelector.minInput&&S.rangeSelector.maxInput)},init:function(A){k.onInputNavInit(A)},terminate:function(){k.onInputNavTerminate()}})}getKeyboardNavigation(){return[this.getRangeSelectorButtonNavigation(),this.getRangeSelectorInputNavigation()]}destroy(){this.removeDropdownKeydownHandler&&this.removeDropdownKeydownHandler(),this.removeInputKeydownHandler&&this.removeInputKeydownHandler(),this.announcer&&this.announcer.destroy()}}return function(_){function S(A){let y=this.rangeSelector&&this.rangeSelector.buttons||[],I=this.highlightedRangeSelectorItemIx,D=this.rangeSelector&&this.rangeSelector.selected;return I!==void 0&&y[I]&&I!==D&&y[I].setState(this.oldRangeSelectorItemState||0),this.highlightedRangeSelectorItemIx=A,!!y[A]&&(this.setFocusToElement(y[A].box,y[A].element),A!==D&&(this.oldRangeSelectorItemState=y[A].state,y[A].setState(1)),!0)}function k(){let A=this.chart.accessibility;if(A&&A.components.rangeSelector)return A.components.rangeSelector.onAfterBtnClick()}_.compose=function(A,y){let I=A.prototype;I.highlightRangeSelectorButton||(I.highlightRangeSelectorButton=S,v(y,"afterBtnClick",k))}}(P),P}),c(t,"Accessibility/Components/SeriesComponent/ForcedMarkers.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h){var d;let{composed:s}=a,{addEvent:f,merge:b,pushUnique:x}=h;return function(v){function g(I){b(!0,I,{marker:{enabled:!0,states:{normal:{opacity:0}}}})}function P(I){return I.marker.states&&I.marker.states.normal&&I.marker.states.normal.opacity}function _(I){return!!(I._hasPointMarkers&&I.points&&I.points.length)}function S(){this.chart.styledMode&&(this.markerGroup&&this.markerGroup[this.a11yMarkersForced?"addClass":"removeClass"]("highcharts-a11y-markers-hidden"),_(this)&&this.points.forEach(I=>{I.graphic&&(I.graphic[I.hasForcedA11yMarker?"addClass":"removeClass"]("highcharts-a11y-marker-hidden"),I.graphic[I.hasForcedA11yMarker===!1?"addClass":"removeClass"]("highcharts-a11y-marker-visible"))}))}function k(I){this.resetA11yMarkerOptions=b(I.options.marker||{},this.userOptions.marker||{})}function A(){let I=this.options;(function(D){let w=D.chart.options.accessibility.enabled,M=(D.options.accessibility&&D.options.accessibility.enabled)!==!1;return w&&M&&function(z){let Y=z.chart.options.accessibility;return z.points.length<Y.series.pointDescriptionEnabledThreshold||Y.series.pointDescriptionEnabledThreshold===!1}(D)})(this)?(I.marker&&I.marker.enabled===!1&&(this.a11yMarkersForced=!0,g(this.options)),_(this)&&function(D){let w=D.points.length;for(;w--;){let M=D.points[w],z=M.options,Y=M.hasForcedA11yMarker;if(delete M.hasForcedA11yMarker,z.marker){let X=Y&&P(z)===0;z.marker.enabled&&!X?(b(!0,z.marker,{states:{normal:{opacity:P(z)||1}}}),M.hasForcedA11yMarker=!1):z.marker.enabled===!1&&(g(z),M.hasForcedA11yMarker=!0)}}}(this)):this.a11yMarkersForced&&(delete this.a11yMarkersForced,function(D){let w=D.resetA11yMarkerOptions;if(w){let M=w.states&&w.states.normal&&w.states.normal.opacity;D.userOptions&&D.userOptions.marker&&(D.userOptions.marker.enabled=!0),D.update({marker:{enabled:w.enabled,states:{normal:{opacity:M}}}})}}(this),delete this.resetA11yMarkerOptions)}function y(){this.boosted&&this.a11yMarkersForced&&(b(!0,this.options,{marker:{enabled:!1}}),delete this.a11yMarkersForced)}v.compose=function(I){x(s,"A11y.FM")&&(f(I,"afterSetOptions",k),f(I,"render",A),f(I,"afterRender",S),f(I,"renderCanvas",y))}}(d||(d={})),d}),c(t,"Accessibility/Components/SeriesComponent/SeriesKeyboardNavigation.js",[t["Core/Series/Point.js"],t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Globals.js"],t["Core/Utilities.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Accessibility/Utils/EventProvider.js"],t["Accessibility/Utils/ChartUtilities.js"]],function(a,h,d,s,f,b,x,v){let{seriesTypes:g}=d,{doc:P}=s,{defined:_,fireEvent:S}=f,{getPointFromXY:k,getSeriesFromName:A,scrollAxisToPoint:y}=v;function I(Z){let j=Z.index,V=Z.series.points,$=V.length;if(V[j]===Z)return j;for(;$--;)if(V[$]===Z)return $}function D(Z){let j=Z.chart.options.accessibility.keyboardNavigation.seriesNavigation,V=Z.options.accessibility||{},$=V.keyboardNavigation;return $&&$.enabled===!1||V.enabled===!1||Z.options.enableMouseTracking===!1||!Z.visible||j.pointNavigationEnabledThreshold&&+j.pointNavigationEnabledThreshold<=Z.points.length}function w(Z){let j=Z.series.chart.options.accessibility,V=Z.options.accessibility&&Z.options.accessibility.enabled===!1;return Z.isNull&&j.keyboardNavigation.seriesNavigation.skipNullPoints||Z.visible===!1||Z.isInside===!1||V||D(Z.series)}function M(Z){let j=Z.series||[],V=j.length;for(let $=0;$<V;++$)if(!D(j[$])){let R=function(L){let G=L.points||[],U=G.length;for(let F=0;F<U;++F)if(!w(G[F]))return G[F];return null}(j[$]);if(R)return R}return null}function z(Z){let j=Z.series.length,V=!1;for(;j--&&(Z.highlightedPoint=Z.series[j].points[Z.series[j].points.length-1],!(V=Z.series[j].highlightNextValidPoint())););return V}function Y(Z){delete Z.highlightedPoint;let j=M(Z);return!!j&&j.highlight()}class X{constructor(j,V){this.keyCodes=V,this.chart=j}init(){let j=this,V=this.chart,$=this.eventProvider=new x;$.addEvent(h,"destroy",function(){return j.onSeriesDestroy(this)}),$.addEvent(V,"afterApplyDrilldown",function(){(function(R){let L=M(R);L&&L.highlight(!1)})(this)}),$.addEvent(V,"drilldown",function(R){let L=R.point,G=L.series;j.lastDrilledDownPoint={x:L.x,y:L.y,seriesName:G?G.name:""}}),$.addEvent(V,"drillupall",function(){setTimeout(function(){j.onDrillupAll()},10)}),$.addEvent(a,"afterSetState",function(){let R=this.graphic&&this.graphic.element,L=P.activeElement,G=L&&L.getAttribute("class"),U=G&&G.indexOf("highcharts-a11y-proxy-element")>-1;V.highlightedPoint===this&&L!==R&&!U&&R&&R.focus&&R.focus()})}onDrillupAll(){let j,V=this.lastDrilledDownPoint,$=this.chart,R=V&&A($,V.seriesName);V&&R&&_(V.x)&&_(V.y)&&(j=k(R,V.x,V.y)),j=j||M($),$.container&&$.container.focus(),j&&j.highlight&&j.highlight(!1)}getKeyboardNavigationHandler(){let j=this,V=this.keyCodes,$=this.chart,R=$.inverted;return new b($,{keyCodeMap:[[R?[V.up,V.down]:[V.left,V.right],function(L){return j.onKbdSideways(this,L)}],[R?[V.left,V.right]:[V.up,V.down],function(L){return j.onKbdVertical(this,L)}],[[V.enter,V.space],function(L,G){var F;let U=$.highlightedPoint;if(U){let{plotLeft:H,plotTop:W}=this.chart,{plotX:ne=0,plotY:ue=0}=U;G={...G,chartX:H+ne,chartY:W+ue,point:U,target:((F=U.graphic)==null?void 0:F.element)||G.target},S(U.series,"click",G),U.firePointEvent("click",G)}return this.response.success}],[[V.home],function(){return Y($),this.response.success}],[[V.end],function(){return z($),this.response.success}],[[V.pageDown,V.pageUp],function(L){return $.highlightAdjacentSeries(L===V.pageDown),this.response.success}]],init:function(){return j.onHandlerInit(this)},validate:function(){return!!M($)},terminate:function(){return j.onHandlerTerminate()}})}onKbdSideways(j,V){let $=this.keyCodes,R=V===$.right||V===$.down;return this.attemptHighlightAdjacentPoint(j,R)}onHandlerInit(j){let V=this.chart;return V.options.accessibility.keyboardNavigation.seriesNavigation.rememberPointFocus&&V.highlightedPoint?V.highlightedPoint.highlight():Y(V),j.response.success}onKbdVertical(j,V){let $=this.chart,R=this.keyCodes,L=V===R.down||V===R.right,G=$.options.accessibility.keyboardNavigation.seriesNavigation;if(G.mode&&G.mode==="serialize")return this.attemptHighlightAdjacentPoint(j,L);let U=$.highlightedPoint&&$.highlightedPoint.series.keyboardMoveVertical?"highlightAdjacentPointVertical":"highlightAdjacentSeries";return $[U](L),j.response.success}onHandlerTerminate(){let j=this.chart,V=j.options.accessibility.keyboardNavigation;j.tooltip&&j.tooltip.hide(0);let $=j.highlightedPoint&&j.highlightedPoint.series;$&&$.onMouseOut&&$.onMouseOut(),j.highlightedPoint&&j.highlightedPoint.onMouseOut&&j.highlightedPoint.onMouseOut(),V.seriesNavigation.rememberPointFocus||delete j.highlightedPoint}attemptHighlightAdjacentPoint(j,V){let $=this.chart,R=$.options.accessibility.keyboardNavigation.wrapAround;return $.highlightAdjacentPoint(V)||R&&(V?Y($):z($))?j.response.success:j.response[V?"next":"prev"]}onSeriesDestroy(j){let V=this.chart;V.highlightedPoint&&V.highlightedPoint.series===j&&(delete V.highlightedPoint,V.focusElement&&V.focusElement.removeFocusBorder())}destroy(){this.eventProvider.removeAddedEvents()}}return function(Z){function j(G){let U,F,H=this.series,W=this.highlightedPoint,ne=W&&I(W)||0,ue=W&&W.series.points||[],ie=this.series&&this.series[this.series.length-1],oe=ie&&ie.points&&ie.points[ie.points.length-1];if(!H[0]||!H[0].points)return!1;if(W){if(U=H[W.series.index+(G?1:-1)],(F=ue[ne+(G?1:-1)])||!U||(F=U.points[G?0:U.points.length-1]),!F)return!1}else F=G?H[0].points[0]:oe;return w(F)?(D(U=F.series)?this.highlightedPoint=G?U.points[U.points.length-1]:U.points[0]:this.highlightedPoint=F,this.highlightAdjacentPoint(G)):F.highlight()}function V(G){let U=this.highlightedPoint,F=1/0,H;return!!(_(U.plotX)&&_(U.plotY))&&(this.series.forEach(W=>{D(W)||W.points.forEach(ne=>{if(!_(ne.plotY)||!_(ne.plotX)||ne===U)return;let ue=ne.plotY-U.plotY,ie=Math.abs(ne.plotX-U.plotX),oe=Math.abs(ue)*Math.abs(ue)+ie*ie*4;W.yAxis&&W.yAxis.reversed&&(ue*=-1),!(ue<=0&&G||ue>=0&&!G||oe<5||w(ne))&&oe<F&&(F=oe,H=ne)})}),!!H&&H.highlight())}function $(G){let U,F,H,W=this.highlightedPoint,ne=this.series&&this.series[this.series.length-1],ue=ne&&ne.points&&ne.points[ne.points.length-1];return this.highlightedPoint?!!((U=this.series[W.series.index+(G?-1:1)])&&(F=function(ie,oe,Te,ge){let we=1/0,K,Q,ae,ye=oe.points.length,J=re=>!(_(re.plotX)&&_(re.plotY));if(!J(ie)){for(;ye--;)!J(K=oe.points[ye])&&(ae=(ie.plotX-K.plotX)*(ie.plotX-K.plotX)*4+(ie.plotY-K.plotY)*(ie.plotY-K.plotY)*1)<we&&(we=ae,Q=ye);return _(Q)?oe.points[Q]:void 0}}(W,U)))&&(D(U)?(F.highlight(),(H=this.highlightAdjacentSeries(G))?H:(W.highlight(),!1)):(F.highlight(),F.series.highlightNextValidPoint())):(U=G?this.series&&this.series[0]:ne,!!(F=G?U&&U.points&&U.points[0]:ue)&&F.highlight())}function R(G=!0){var W,ne;let U=this.series.chart,F=(ne=(W=U.tooltip)==null?void 0:W.label)==null?void 0:ne.element;!this.isNull&&G?this.onMouseOver():U.tooltip&&U.tooltip.hide(0),y(this),this.graphic&&(U.setFocusToElement(this.graphic),!G&&U.focusElement&&U.focusElement.removeFocusBorder()),U.highlightedPoint=this;let H=F==null?void 0:F.getBoundingClientRect().top;if(F&&H&&H<0){let ue=window.scrollY;window.scrollTo({behavior:"smooth",top:ue+H})}return this}function L(){let G=this.chart.highlightedPoint,U=(G&&G.series)===this?I(G):0,F=this.points,H=F.length;if(F&&H){for(let W=U;W<H;++W)if(!w(F[W]))return F[W].highlight();for(let W=U;W>=0;--W)if(!w(F[W]))return F[W].highlight()}return!1}Z.compose=function(G,U,F){let H=G.prototype,W=U.prototype,ne=F.prototype;H.highlightAdjacentPoint||(H.highlightAdjacentPoint=j,H.highlightAdjacentPointVertical=V,H.highlightAdjacentSeries=$,W.highlight=R,ne.keyboardMoveVertical=!0,["column","gantt","pie"].forEach(ue=>{g[ue]&&(g[ue].prototype.keyboardMoveVertical=!1)}),ne.highlightNextValidPoint=L)}}(X),X}),c(t,"Accessibility/Components/SeriesComponent/SeriesComponent.js",[t["Accessibility/AccessibilityComponent.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Components/SeriesComponent/ForcedMarkers.js"],t["Accessibility/Components/SeriesComponent/NewDataAnnouncer.js"],t["Accessibility/Components/SeriesComponent/SeriesDescriber.js"],t["Accessibility/Components/SeriesComponent/SeriesKeyboardNavigation.js"]],function(a,h,d,s,f,b){let{hideSeriesFromAT:x}=h,{describeSeries:v}=f;return class extends a{static compose(g,P,_){s.compose(_),d.compose(_),b.compose(g,P,_)}init(){this.newDataAnnouncer=new s(this.chart),this.newDataAnnouncer.init(),this.keyboardNavigation=new b(this.chart,this.keyCodes),this.keyboardNavigation.init(),this.hideTooltipFromATWhenShown(),this.hideSeriesLabelsFromATWhenShown()}hideTooltipFromATWhenShown(){let g=this;this.chart.tooltip&&this.addEvent(this.chart.tooltip.constructor,"refresh",function(){this.chart===g.chart&&this.label&&this.label.element&&this.label.element.setAttribute("aria-hidden",!0)})}hideSeriesLabelsFromATWhenShown(){this.addEvent(this.chart,"afterDrawSeriesLabels",function(){this.series.forEach(function(g){g.labelBySeries&&g.labelBySeries.attr("aria-hidden",!0)})})}onChartRender(){this.chart.series.forEach(function(g){(g.options.accessibility&&g.options.accessibility.enabled)!==!1&&g.visible&&g.getPointsCollection().length!==0?v(g):x(g)})}getKeyboardNavigation(){return this.keyboardNavigation.getKeyboardNavigationHandler()}destroy(){this.newDataAnnouncer.destroy(),this.keyboardNavigation.destroy()}}}),c(t,"Accessibility/Components/ZoomComponent.js",[t["Accessibility/AccessibilityComponent.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Core/Utilities.js"]],function(a,h,d,s,f){let{unhideChartElementFromAT:b}=h,{getFakeMouseEvent:x}=d,{attr:v,pick:g}=f;return class extends a{constructor(){super(...arguments),this.focusedMapNavButtonIx=-1}init(){let P=this,_=this.chart;this.proxyProvider.addGroup("zoom","div"),["afterShowResetZoom","afterApplyDrilldown","drillupall"].forEach(S=>{P.addEvent(_,S,function(){P.updateProxyOverlays()})})}onChartUpdate(){let P=this.chart,_=this;P.mapNavigation&&P.mapNavigation.navButtons.forEach((S,k)=>{b(P,S.element),_.setMapNavButtonAttrs(S.element,"accessibility.zoom.mapZoom"+(k?"Out":"In"))})}setMapNavButtonAttrs(P,_){let S=this.chart;v(P,{tabindex:-1,role:"button","aria-label":S.langFormat(_,{chart:S})})}onChartRender(){this.updateProxyOverlays()}updateProxyOverlays(){let P=this.chart;if(this.proxyProvider.clearGroup("zoom"),P.resetZoomButton&&this.createZoomProxyButton(P.resetZoomButton,"resetZoomProxyButton",P.langFormat("accessibility.zoom.resetZoomButton",{chart:P})),P.drillUpButton&&P.breadcrumbs&&P.breadcrumbs.list){let _=P.breadcrumbs.list[P.breadcrumbs.list.length-1];this.createZoomProxyButton(P.drillUpButton,"drillUpProxyButton",P.langFormat("accessibility.drillUpButton",{chart:P,buttonText:P.breadcrumbs.getButtonText(_)}))}}createZoomProxyButton(P,_,S){this[_]=this.proxyProvider.addProxyElement("zoom",{click:P},"button",{"aria-label":S,tabindex:-1})}getMapZoomNavigation(){let P=this.keyCodes,_=this.chart,S=this;return new s(_,{keyCodeMap:[[[P.up,P.down,P.left,P.right],function(k){return S.onMapKbdArrow(this,k)}],[[P.tab],function(k,A){return S.onMapKbdTab(this,A)}],[[P.space,P.enter],function(){return S.onMapKbdClick(this)}]],validate:function(){return!!(_.mapView&&_.mapNavigation&&_.mapNavigation.navButtons.length)},init:function(k){return S.onMapNavInit(k)}})}onMapKbdArrow(P,_){let S=this.chart,k=this.keyCodes,A=S.container,y=_===k.up||_===k.down,I=_===k.left||_===k.up?1:-1,D=(y?S.plotHeight:S.plotWidth)/10*I,w=10*Math.random(),M={x:A.offsetLeft+S.plotLeft+S.plotWidth/2+w,y:A.offsetTop+S.plotTop+S.plotHeight/2+w},z=y?{x:M.x,y:M.y+D}:{x:M.x+D,y:M.y};return[x("mousedown",M),x("mousemove",z),x("mouseup",z)].forEach(Y=>A.dispatchEvent(Y)),P.response.success}onMapKbdTab(P,_){let S=this.chart,k=P.response,A=_.shiftKey,y=A&&!this.focusedMapNavButtonIx||!A&&this.focusedMapNavButtonIx;if(S.mapNavigation.navButtons[this.focusedMapNavButtonIx].setState(0),y)return S.mapView&&S.mapView.zoomBy(),k[A?"prev":"next"];this.focusedMapNavButtonIx+=A?-1:1;let I=S.mapNavigation.navButtons[this.focusedMapNavButtonIx];return S.setFocusToElement(I.box,I.element),I.setState(2),k.success}onMapKbdClick(P){let _=this.chart.mapNavigation.navButtons[this.focusedMapNavButtonIx].element;return this.fakeClickEvent(_),P.response.success}onMapNavInit(P){let _=this.chart,S=_.mapNavigation.navButtons[0],k=_.mapNavigation.navButtons[1],A=P>0?S:k;_.setFocusToElement(A.box,A.element),A.setState(2),this.focusedMapNavButtonIx=P>0?0:1}simpleButtonNavigation(P,_,S){let k=this.keyCodes,A=this,y=this.chart;return new s(y,{keyCodeMap:[[[k.tab,k.up,k.down,k.left,k.right],function(I,D){let w=I===k.tab&&D.shiftKey||I===k.left||I===k.up;return this.response[w?"prev":"next"]}],[[k.space,k.enter],function(){return g(S(this,y),this.response.success)}]],validate:function(){return y[P]&&y[P].box&&A[_].innerElement},init:function(){y.setFocusToElement(y[P].box,A[_].innerElement)}})}getKeyboardNavigation(){return[this.simpleButtonNavigation("resetZoomButton","resetZoomProxyButton",function(P,_){_.zoomOut()}),this.simpleButtonNavigation("drillUpButton","drillUpProxyButton",function(P,_){return _.drillUp(),P.response.prev}),this.getMapZoomNavigation()]}}}),c(t,"Accessibility/HighContrastMode.js",[t["Core/Globals.js"]],function(a){let{doc:h,isMS:d,win:s}=a;return{isHighContrastModeActive:function(){let f=/(Edg)/.test(s.navigator.userAgent);if(s.matchMedia&&f)return s.matchMedia("(-ms-high-contrast: active)").matches;if(d&&s.getComputedStyle){let b=h.createElement("div");b.style.backgroundImage="url(data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)",h.body.appendChild(b);let x=(b.currentStyle||s.getComputedStyle(b)).backgroundImage;return h.body.removeChild(b),x==="none"}return s.matchMedia&&s.matchMedia("(forced-colors: active)").matches},setHighContrastTheme:function(f){var v;f.highContrastModeActive=!0;let b=f.options.accessibility.highContrastTheme;f.update(b,!1);let x=((v=b.colors)==null?void 0:v.length)>1;f.series.forEach(function(g){let P=b.plotOptions[g.type]||{},_=x&&g.colorIndex!==void 0?b.colors[g.colorIndex]:P.color||"window",S={color:P.color||"windowText",colors:x?b.colors:[P.color||"windowText"],borderColor:P.borderColor||"window",fillColor:_};g.update(S,!1),g.points&&g.points.forEach(function(k){k.options&&k.options.color&&k.update({color:P.color||"windowText",borderColor:P.borderColor||"window"},!1)})}),f.redraw()}}}),c(t,"Accessibility/HighContrastTheme.js",[],function(){return{chart:{backgroundColor:"window"},title:{style:{color:"windowText"}},subtitle:{style:{color:"windowText"}},colorAxis:{minColor:"windowText",maxColor:"windowText",stops:[],dataClasses:[]},colors:["windowText"],xAxis:{gridLineColor:"windowText",labels:{style:{color:"windowText"}},lineColor:"windowText",minorGridLineColor:"windowText",tickColor:"windowText",title:{style:{color:"windowText"}}},yAxis:{gridLineColor:"windowText",labels:{style:{color:"windowText"}},lineColor:"windowText",minorGridLineColor:"windowText",tickColor:"windowText",title:{style:{color:"windowText"}}},tooltip:{backgroundColor:"window",borderColor:"windowText",style:{color:"windowText"}},plotOptions:{series:{lineColor:"windowText",fillColor:"window",borderColor:"windowText",edgeColor:"windowText",borderWidth:1,dataLabels:{connectorColor:"windowText",color:"windowText",style:{color:"windowText",textOutline:"none"}},marker:{lineColor:"windowText",fillColor:"windowText"}},pie:{color:"window",colors:["window"],borderColor:"windowText",borderWidth:1},boxplot:{fillColor:"window"},candlestick:{lineColor:"windowText",fillColor:"window"},errorbar:{fillColor:"window"}},legend:{backgroundColor:"window",itemStyle:{color:"windowText"},itemHoverStyle:{color:"windowText"},itemHiddenStyle:{color:"#555"},title:{style:{color:"windowText"}}},credits:{style:{color:"windowText"}},drilldown:{activeAxisLabelStyle:{color:"windowText"},activeDataLabelStyle:{color:"windowText"}},navigation:{buttonOptions:{symbolStroke:"windowText",theme:{fill:"window"}}},rangeSelector:{buttonTheme:{fill:"window",stroke:"windowText",style:{color:"windowText"},states:{hover:{fill:"window",stroke:"windowText",style:{color:"windowText"}},select:{fill:"#444",stroke:"windowText",style:{color:"windowText"}}}},inputBoxBorderColor:"windowText",inputStyle:{backgroundColor:"window",color:"windowText"},labelStyle:{color:"windowText"}},navigator:{handles:{backgroundColor:"window",borderColor:"windowText"},outlineColor:"windowText",maskFill:"transparent",series:{color:"windowText",lineColor:"windowText"},xAxis:{gridLineColor:"windowText"}},scrollbar:{barBackgroundColor:"#444",barBorderColor:"windowText",buttonArrowColor:"windowText",buttonBackgroundColor:"window",buttonBorderColor:"windowText",rifleColor:"windowText",trackBackgroundColor:"window",trackBorderColor:"windowText"}}}),c(t,"Accessibility/Options/A11yDefaults.js",[],function(){return{accessibility:{enabled:!0,screenReaderSection:{beforeChartFormat:"<{headingTagName}>{chartTitle}</{headingTagName}><div>{typeDescription}</div><div>{chartSubtitle}</div><div>{chartLongdesc}</div><div>{playAsSoundButton}</div><div>{viewTableButton}</div><div>{xAxisDescription}</div><div>{yAxisDescription}</div><div>{annotationsTitle}{annotationsList}</div>",afterChartFormat:"{endOfChartMarker}",axisRangeDateFormat:"%Y-%m-%d %H:%M:%S"},series:{descriptionFormat:"{seriesDescription}{authorDescription}{axisDescription}",describeSingleSeries:!1,pointDescriptionEnabledThreshold:200},point:{valueDescriptionFormat:"{xDescription}{separator}{value}.",describeNull:!0},landmarkVerbosity:"all",linkedDescription:'*[data-highcharts-chart="{index}"] + .highcharts-description',highContrastMode:"auto",keyboardNavigation:{enabled:!0,focusBorder:{enabled:!0,hideBrowserFocusOutline:!0,style:{color:"#334eff",lineWidth:2,borderRadius:3},margin:2},order:["series","zoom","rangeSelector","navigator","legend","chartMenu"],wrapAround:!0,seriesNavigation:{skipNullPoints:!0,pointNavigationEnabledThreshold:!1,rememberPointFocus:!1}},announceNewData:{enabled:!1,minAnnounceInterval:5e3,interruptUser:!1}},legend:{accessibility:{enabled:!0,keyboardNavigation:{enabled:!0}}},exporting:{accessibility:{enabled:!0}},navigator:{accessibility:{enabled:!0}}}}),c(t,"Accessibility/Options/LangDefaults.js",[],function(){return{accessibility:{defaultChartTitle:"Chart",chartContainerLabel:"{title}. Highcharts interactive chart.",svgContainerLabel:"Interactive chart",drillUpButton:"{buttonText}",credits:"Chart credits: {creditsStr}",thousandsSep:",",svgContainerTitle:"",graphicContainerLabel:"",screenReaderSection:{beforeRegionLabel:"",afterRegionLabel:"",annotations:{heading:"Chart annotations summary",descriptionSinglePoint:"{annotationText}. Related to {annotationPoint}",descriptionMultiplePoints:"{annotationText}. Related to {annotationPoint}{#each additionalAnnotationPoints}, also related to {this}{/each}",descriptionNoPoints:"{annotationText}"},endOfChartMarker:"End of interactive chart."},sonification:{playAsSoundButtonText:"Play as sound, {chartTitle}",playAsSoundClickAnnouncement:"Play"},legend:{legendLabelNoTitle:"Toggle series visibility, {chartTitle}",legendLabel:"Chart legend: {legendTitle}",legendItem:"Show {itemName}"},zoom:{mapZoomIn:"Zoom chart",mapZoomOut:"Zoom out chart",resetZoomButton:"Reset zoom"},rangeSelector:{dropdownLabel:"{rangeTitle}",minInputLabel:"Select start date.",maxInputLabel:"Select end date.",clickButtonAnnouncement:"Viewing {axisRangeDescription}"},navigator:{handleLabel:"{#eq handleIx 0}Start, percent{else}End, percent{/eq}",groupLabel:"Axis zoom",changeAnnouncement:"{axisRangeDescription}"},table:{viewAsDataTableButtonText:"View as data table, {chartTitle}",tableSummary:"Table representation of chart."},announceNewData:{newDataAnnounce:"Updated data for chart {chartTitle}",newSeriesAnnounceSingle:"New data series: {seriesDesc}",newPointAnnounceSingle:"New data point: {pointDesc}",newSeriesAnnounceMultiple:"New data series in chart {chartTitle}: {seriesDesc}",newPointAnnounceMultiple:"New data point in chart {chartTitle}: {pointDesc}"},seriesTypeDescriptions:{boxplot:"Box plot charts are typically used to display groups of statistical data. Each data point in the chart can have up to 5 values: minimum, lower quartile, median, upper quartile, and maximum.",arearange:"Arearange charts are line charts displaying a range between a lower and higher value for each point.",areasplinerange:"These charts are line charts displaying a range between a lower and higher value for each point.",bubble:"Bubble charts are scatter charts where each data point also has a size value.",columnrange:"Columnrange charts are column charts displaying a range between a lower and higher value for each point.",errorbar:"Errorbar series are used to display the variability of the data.",funnel:"Funnel charts are used to display reduction of data in stages.",pyramid:"Pyramid charts consist of a single pyramid with item heights corresponding to each point value.",waterfall:"A waterfall chart is a column chart where each column contributes towards a total end value."},chartTypes:{emptyChart:"Empty chart",mapTypeDescription:"Map of {mapTitle} with {numSeries} data series.",unknownMap:"Map of unspecified region with {numSeries} data series.",combinationChart:"Combination chart with {numSeries} data series.",defaultSingle:"Chart with {numPoints} data {#eq numPoints 1}point{else}points{/eq}.",defaultMultiple:"Chart with {numSeries} data series.",splineSingle:"Line chart with {numPoints} data {#eq numPoints 1}point{else}points{/eq}.",splineMultiple:"Line chart with {numSeries} lines.",lineSingle:"Line chart with {numPoints} data {#eq numPoints 1}point{else}points{/eq}.",lineMultiple:"Line chart with {numSeries} lines.",columnSingle:"Bar chart with {numPoints} {#eq numPoints 1}bar{else}bars{/eq}.",columnMultiple:"Bar chart with {numSeries} data series.",barSingle:"Bar chart with {numPoints} {#eq numPoints 1}bar{else}bars{/eq}.",barMultiple:"Bar chart with {numSeries} data series.",pieSingle:"Pie chart with {numPoints} {#eq numPoints 1}slice{else}slices{/eq}.",pieMultiple:"Pie chart with {numSeries} pies.",scatterSingle:"Scatter chart with {numPoints} {#eq numPoints 1}point{else}points{/eq}.",scatterMultiple:"Scatter chart with {numSeries} data series.",boxplotSingle:"Boxplot with {numPoints} {#eq numPoints 1}box{else}boxes{/eq}.",boxplotMultiple:"Boxplot with {numSeries} data series.",bubbleSingle:"Bubble chart with {numPoints} {#eq numPoints 1}bubbles{else}bubble{/eq}.",bubbleMultiple:"Bubble chart with {numSeries} data series."},axis:{xAxisDescriptionSingular:"The chart has 1 X axis displaying {names[0]}. {ranges[0]}",xAxisDescriptionPlural:"The chart has {numAxes} X axes displaying {#each names}{#unless @first},{/unless}{#if @last} and{/if} {this}{/each}.",yAxisDescriptionSingular:"The chart has 1 Y axis displaying {names[0]}. {ranges[0]}",yAxisDescriptionPlural:"The chart has {numAxes} Y axes displaying {#each names}{#unless @first},{/unless}{#if @last} and{/if} {this}{/each}.",timeRangeDays:"Data range: {range} days.",timeRangeHours:"Data range: {range} hours.",timeRangeMinutes:"Data range: {range} minutes.",timeRangeSeconds:"Data range: {range} seconds.",rangeFromTo:"Data ranges from {rangeFrom} to {rangeTo}.",rangeCategories:"Data range: {numCategories} categories."},exporting:{chartMenuLabel:"Chart menu",menuButtonLabel:"View chart menu, {chartTitle}"},series:{summary:{default:"{series.name}, series {seriesNumber} of {chart.series.length} with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",defaultCombination:"{series.name}, series {seriesNumber} of {chart.series.length} with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",line:"{series.name}, line {seriesNumber} of {chart.series.length} with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",lineCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Line with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",spline:"{series.name}, line {seriesNumber} of {chart.series.length} with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",splineCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Line with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",column:"{series.name}, bar series {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}bar{else}bars{/eq}.",columnCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Bar series with {series.points.length} {#eq series.points.length 1}bar{else}bars{/eq}.",bar:"{series.name}, bar series {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}bar{else}bars{/eq}.",barCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Bar series with {series.points.length} {#eq series.points.length 1}bar{else}bars{/eq}.",pie:"{series.name}, pie {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}slice{else}slices{/eq}.",pieCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Pie with {series.points.length} {#eq series.points.length 1}slice{else}slices{/eq}.",scatter:"{series.name}, scatter plot {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}point{else}points{/eq}.",scatterCombination:"{series.name}, series {seriesNumber} of {chart.series.length}, scatter plot with {series.points.length} {#eq series.points.length 1}point{else}points{/eq}.",boxplot:"{series.name}, boxplot {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}box{else}boxes{/eq}.",boxplotCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Boxplot with {series.points.length} {#eq series.points.length 1}box{else}boxes{/eq}.",bubble:"{series.name}, bubble series {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}bubble{else}bubbles{/eq}.",bubbleCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Bubble series with {series.points.length} {#eq series.points.length 1}bubble{else}bubbles{/eq}.",map:"{series.name}, map {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}area{else}areas{/eq}.",mapCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Map with {series.points.length} {#eq series.points.length 1}area{else}areas{/eq}.",mapline:"{series.name}, line {seriesNumber} of {chart.series.length} with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",maplineCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Line with {series.points.length} data {#eq series.points.length 1}point{else}points{/eq}.",mapbubble:"{series.name}, bubble series {seriesNumber} of {chart.series.length} with {series.points.length} {#eq series.points.length 1}bubble{else}bubbles{/eq}.",mapbubbleCombination:"{series.name}, series {seriesNumber} of {chart.series.length}. Bubble series with {series.points.length} {#eq series.points.length 1}bubble{else}bubbles{/eq}."},description:"{description}",xAxisDescription:"X axis, {name}",yAxisDescription:"Y axis, {name}",nullPointValue:"No value",pointAnnotationsDescription:"{#each annotations}Annotation: {this}{/each}"}}}}),c(t,"Accessibility/Options/DeprecatedOptions.js",[t["Core/Utilities.js"]],function(a){let{error:h,pick:d}=a;function s(b,x,v){let g=b,P,_=0;for(;_<x.length-1;++_)g=g[P=x[_]]=d(g[P],{});g[x[x.length-1]]=v}function f(b,x,v,g){function P(k,A){return A.reduce(function(y,I){return y[I]},k)}let _=P(b.options,x),S=P(b.options,v);Object.keys(g).forEach(function(k){let A=_[k];A!==void 0&&(s(S,g[k],A),h(32,!1,b,{[x.join(".")+"."+k]:v.join(".")+"."+g[k].join(".")}))})}return function(b){(function(x){let v=x.options.chart,g=x.options.accessibility||{};["description","typeDescription"].forEach(function(P){v[P]&&(g[P]=v[P],h(32,!1,x,{[`chart.${P}`]:`use accessibility.${P}`}))})})(b),function(x){x.axes.forEach(function(v){let g=v.options;g&&g.description&&(g.accessibility=g.accessibility||{},g.accessibility.description=g.description,h(32,!1,x,{"axis.description":"use axis.accessibility.description"}))})}(b),b.series&&function(x){let v={description:["accessibility","description"],exposeElementToA11y:["accessibility","exposeAsGroupOnly"],pointDescriptionFormatter:["accessibility","point","descriptionFormatter"],skipKeyboardNavigation:["accessibility","keyboardNavigation","enabled"],"accessibility.pointDescriptionFormatter":["accessibility","point","descriptionFormatter"]};x.series.forEach(function(g){Object.keys(v).forEach(function(P){let _=g.options[P];P==="accessibility.pointDescriptionFormatter"&&(_=g.options.accessibility&&g.options.accessibility.pointDescriptionFormatter),_!==void 0&&(s(g.options,v[P],P==="skipKeyboardNavigation"?!_:_),h(32,!1,x,{[`series.${P}`]:"series."+v[P].join(".")}))})})}(b),f(b,["accessibility"],["accessibility"],{pointDateFormat:["point","dateFormat"],pointDateFormatter:["point","dateFormatter"],pointDescriptionFormatter:["point","descriptionFormatter"],pointDescriptionThreshold:["series","pointDescriptionEnabledThreshold"],pointNavigationThreshold:["keyboardNavigation","seriesNavigation","pointNavigationEnabledThreshold"],pointValueDecimals:["point","valueDecimals"],pointValuePrefix:["point","valuePrefix"],pointValueSuffix:["point","valueSuffix"],screenReaderSectionFormatter:["screenReaderSection","beforeChartFormatter"],describeSingleSeries:["series","describeSingleSeries"],seriesDescriptionFormatter:["series","descriptionFormatter"],onTableAnchorClick:["screenReaderSection","onViewDataTableClick"],axisRangeDateFormat:["screenReaderSection","axisRangeDateFormat"]}),f(b,["accessibility","keyboardNavigation"],["accessibility","keyboardNavigation","seriesNavigation"],{skipNullPoints:["skipNullPoints"],mode:["mode"]}),f(b,["lang","accessibility"],["lang","accessibility"],{legendItem:["legend","legendItem"],legendLabel:["legend","legendLabel"],mapZoomIn:["zoom","mapZoomIn"],mapZoomOut:["zoom","mapZoomOut"],resetZoomButton:["zoom","resetZoomButton"],screenReaderRegionLabel:["screenReaderSection","beforeRegionLabel"],rangeSelectorButton:["rangeSelector","buttonText"],rangeSelectorMaxInput:["rangeSelector","maxInputLabel"],rangeSelectorMinInput:["rangeSelector","minInputLabel"],svgContainerEnd:["screenReaderSection","endOfChartMarker"],viewAsDataTable:["table","viewAsDataTableButtonText"],tableSummary:["table","tableSummary"]})}}),c(t,"Accessibility/Accessibility.js",[t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Utilities.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Accessibility/A11yI18n.js"],t["Accessibility/Components/ContainerComponent.js"],t["Accessibility/FocusBorder.js"],t["Accessibility/Components/InfoRegionsComponent.js"],t["Accessibility/KeyboardNavigation.js"],t["Accessibility/Components/LegendComponent.js"],t["Accessibility/Components/MenuComponent.js"],t["Accessibility/Components/NavigatorComponent.js"],t["Accessibility/Components/SeriesComponent/NewDataAnnouncer.js"],t["Accessibility/ProxyProvider.js"],t["Accessibility/Components/RangeSelectorComponent.js"],t["Accessibility/Components/SeriesComponent/SeriesComponent.js"],t["Accessibility/Components/ZoomComponent.js"],t["Accessibility/HighContrastMode.js"],t["Accessibility/HighContrastTheme.js"],t["Accessibility/Options/A11yDefaults.js"],t["Accessibility/Options/LangDefaults.js"],t["Accessibility/Options/DeprecatedOptions.js"]],function(a,h,d,s,f,b,x,v,g,P,_,S,k,A,y,I,D,w,M,z,Y,X){let{defaultOptions:Z}=a,{doc:j}=h,{addEvent:V,extend:$,fireEvent:R,merge:L}=d,{removeElement:G}=s;class U{constructor(H){this.init(H)}init(H){if(this.chart=H,!j.addEventListener){this.zombie=!0,this.components={},H.renderTo.setAttribute("aria-hidden",!0);return}X(H),this.proxyProvider=new A(this.chart),this.initComponents(),this.keyboardNavigation=new g(H,this.components)}initComponents(){let H=this.chart,W=this.proxyProvider,ne=H.options.accessibility;this.components={container:new b,infoRegions:new v,legend:new P,chartMenu:new _,rangeSelector:new y,series:new I,zoom:new D,navigator:new S},ne.customComponents&&$(this.components,ne.customComponents);let ue=this.components;this.getComponentOrder().forEach(function(ie){ue[ie].initBase(H,W),ue[ie].init()})}getComponentOrder(){return this.components?this.components.series?["series"].concat(Object.keys(this.components).filter(H=>H!=="series")):Object.keys(this.components):[]}update(){let H=this.components,W=this.chart,ne=W.options.accessibility;R(W,"beforeA11yUpdate"),W.types=this.getChartTypes();let ue=ne.keyboardNavigation.order;this.proxyProvider.updateGroupOrder(ue),this.getComponentOrder().forEach(function(ie){H[ie].onChartUpdate(),R(W,"afterA11yComponentUpdate",{name:ie,component:H[ie]})}),this.keyboardNavigation.update(ue),!W.highContrastModeActive&&ne.highContrastMode!==!1&&(w.isHighContrastModeActive()||ne.highContrastMode===!0)&&w.setHighContrastTheme(W),R(W,"afterA11yUpdate",{accessibility:this})}destroy(){let H=this.chart||{},W=this.components;Object.keys(W).forEach(function(ne){W[ne].destroy(),W[ne].destroyBase()}),this.proxyProvider&&this.proxyProvider.destroy(),H.announcerContainer&&G(H.announcerContainer),this.keyboardNavigation&&this.keyboardNavigation.destroy(),H.renderTo&&H.renderTo.setAttribute("aria-hidden",!0),H.focusElement&&H.focusElement.removeFocusBorder()}getChartTypes(){let H={};return this.chart.series.forEach(function(W){H[W.type]=1}),Object.keys(H)}}return function(F){function H(){this.accessibility&&this.accessibility.destroy()}function W(){this.a11yDirty&&this.renderTo&&(delete this.a11yDirty,this.updateA11yEnabled());let oe=this.accessibility;oe&&!oe.zombie&&(oe.proxyProvider.updateProxyElementPositions(),oe.getComponentOrder().forEach(function(Te){oe.components[Te].onChartRender()}))}function ne(oe){let Te=oe.options.accessibility;Te&&(Te.customComponents&&(this.options.accessibility.customComponents=Te.customComponents,delete Te.customComponents),L(!0,this.options.accessibility,Te),this.accessibility&&this.accessibility.destroy&&(this.accessibility.destroy(),delete this.accessibility)),this.a11yDirty=!0}function ue(){let oe=this.accessibility,Te=this.options.accessibility,ge=this.renderer.boxWrapper.element,we=this.title;if(Te&&Te.enabled)oe&&!oe.zombie?oe.update():(this.accessibility=oe=new F(this),oe&&!oe.zombie&&oe.update(),ge.getAttribute("role")==="img"&&ge.removeAttribute("role"));else if(oe)oe.destroy&&oe.destroy(),delete this.accessibility;else{this.renderTo.setAttribute("role","img"),this.renderTo.setAttribute("aria-hidden",!1),this.renderTo.setAttribute("aria-label",(we&&we.element.textContent||"").replace(/</g,"&lt;")),ge.setAttribute("aria-hidden",!0);let K=document.getElementsByClassName("highcharts-description")[0];K&&(K.setAttribute("aria-hidden",!1),K.classList.remove("highcharts-linked-description"))}}function ie(){this.series.chart.accessibility&&(this.series.chart.a11yDirty=!0)}F.i18nFormat=f.i18nFormat,F.compose=function(oe,Te,ge,we,K,Q){g.compose(oe),k.compose(we),P.compose(oe,Te),_.compose(oe),I.compose(oe,ge,we),f.compose(oe),x.compose(oe,K),Q&&y.compose(oe,Q);let ae=oe.prototype;ae.updateA11yEnabled||(ae.updateA11yEnabled=ue,V(oe,"destroy",H),V(oe,"render",W),V(oe,"update",ne),["addSeries","init"].forEach(ye=>{V(oe,ye,function(){this.a11yDirty=!0})}),["afterApplyDrilldown","drillupall"].forEach(ye=>{V(oe,ye,function(){let J=this.accessibility;J&&!J.zombie&&J.update()})}),V(ge,"update",ie),["update","updatedData","remove"].forEach(ye=>{V(we,ye,function(){this.chart.accessibility&&(this.chart.a11yDirty=!0)})}))}}(U),L(!0,Z,z,{accessibility:{highContrastTheme:M},lang:Y}),U}),c(t,"masters/modules/accessibility.src.js",[t["Core/Globals.js"],t["Accessibility/Accessibility.js"],t["Accessibility/AccessibilityComponent.js"],t["Accessibility/Utils/ChartUtilities.js"],t["Accessibility/Utils/HTMLUtilities.js"],t["Accessibility/KeyboardNavigationHandler.js"],t["Accessibility/Components/SeriesComponent/SeriesDescriber.js"]],function(a,h,d,s,f,b,x){return a.i18nFormat=h.i18nFormat,a.A11yChartUtilities=s,a.A11yHTMLUtilities=f,a.AccessibilityComponent=d,a.KeyboardNavigationHandler=b,a.SeriesAccessibilityDescriber=x,h.compose(a.Chart,a.Legend,a.Point,a.Series,a.SVGElement,a.RangeSelector),a})})})(Cw);var z3=Cw.exports;const N3=jh(z3);var Sw={exports:{}};(function(n){(function(e){n.exports?(e.default=e,n.exports=e):e(typeof Highcharts<"u"?Highcharts:void 0)})(function(e){var t=e?e._modules:{};function c(a,h,d,s){a.hasOwnProperty(h)||(a[h]=s.apply(null,d),typeof CustomEvent=="function"&&e.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:h,module:a[h]}})))}c(t,"Extensions/Pane/PaneComposition.js",[t["Core/Utilities.js"]],function(a){let{addEvent:h,correctFloat:d,defined:s,pick:f}=a;function b(_){let S,k=this;return _&&k.pane.forEach(A=>{x(_.chartX-k.plotLeft,_.chartY-k.plotTop,A.center)&&(S=A)}),S}function x(_,S,k,A,y){let I=!0,D=k[0],w=k[1],M=Math.sqrt(Math.pow(_-D,2)+Math.pow(S-w,2));if(s(A)&&s(y)){let z=Math.atan2(d(S-w,8),d(_-D,8));y!==A&&(I=A>y?z>=A&&z<=Math.PI||z<=y&&z>=-Math.PI:z>=A&&z<=d(y,8))}return M<=Math.ceil(k[2]/2)&&I}function v(_){this.polar&&(_.options.inverted&&([_.x,_.y]=[_.y,_.x]),_.isInsidePlot=this.pane.some(S=>x(_.x,_.y,S.center,S.axis&&S.axis.normalizedStartAngleRad,S.axis&&S.axis.normalizedEndAngleRad)))}function g(_){let S=this.chart;_.hoverPoint&&_.hoverPoint.plotX&&_.hoverPoint.plotY&&S.hoverPane&&!x(_.hoverPoint.plotX,_.hoverPoint.plotY,S.hoverPane.center)&&(_.hoverPoint=void 0)}function P(_){let S=this.chart;S.polar?(S.hoverPane=S.getHoverPane(_),_.filter=function(k){return k.visible&&!(!_.shared&&k.directTouch)&&f(k.options.enableMouseTracking,!0)&&(!S.hoverPane||k.xAxis.pane===S.hoverPane)}):S.hoverPane=void 0}return{compose:function(_,S){let k=_.prototype;k.getHoverPane||(k.collectionsWithUpdate.push("pane"),k.getHoverPane=b,h(_,"afterIsInsidePlot",v),h(S,"afterGetHoverData",g),h(S,"beforeGetHoverData",P))}}}),c(t,"Extensions/Pane/PaneDefaults.js",[],function(){return{pane:{center:["50%","50%"],size:"85%",innerSize:"0%",startAngle:0},background:{shape:"circle",borderRadius:0,borderWidth:1,borderColor:"#cccccc",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#ffffff"],[1,"#e6e6e6"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"}}}),c(t,"Extensions/Pane/Pane.js",[t["Series/CenteredUtilities.js"],t["Extensions/Pane/PaneComposition.js"],t["Extensions/Pane/PaneDefaults.js"],t["Core/Utilities.js"]],function(a,h,d,s){let{extend:f,merge:b,splat:x}=s;class v{constructor(P,_){this.coll="pane",this.init(P,_)}init(P,_){this.chart=_,this.background=[],_.pane.push(this),this.setOptions(P)}setOptions(P){this.options=P=b(d.pane,this.chart.angular?{background:{}}:void 0,P)}render(){let P=this.options,_=this.chart.renderer;this.group||(this.group=_.g("pane-group").attr({zIndex:P.zIndex||0}).add()),this.updateCenter();let S=this.options.background;if(S){let k=Math.max((S=x(S)).length,this.background.length||0);for(let A=0;A<k;A++)S[A]&&this.axis?this.renderBackground(b(d.background,S[A]),A):this.background[A]&&(this.background[A]=this.background[A].destroy(),this.background.splice(A,1))}}renderBackground(P,_){let S={class:"highcharts-pane "+(P.className||"")},k="animate";this.chart.styledMode||f(S,{fill:P.backgroundColor,stroke:P.borderColor,"stroke-width":P.borderWidth}),this.background[_]||(this.background[_]=this.chart.renderer.path().add(this.group),k="attr"),this.background[_][k]({d:this.axis.getPlotBandPath(P.from,P.to,P)}).attr(S)}updateCenter(P){this.center=(P||this.axis||{}).center=a.getCenter.call(this)}update(P,_){b(!0,this.options,P),this.setOptions(this.options),this.render(),this.chart.axes.forEach(function(S){S.pane===this&&(S.pane=null,S.update({},_))},this)}}return v.compose=h.compose,v}),c(t,"Series/AreaRange/AreaRangePoint.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h){let{area:{prototype:{pointClass:d,pointClass:{prototype:s}}}}=a.seriesTypes,{defined:f,isNumber:b}=h;return class extends d{setState(){let x=this.state,v=this.series,g=v.chart.polar;f(this.plotHigh)||(this.plotHigh=v.yAxis.toPixels(this.high,!0)),f(this.plotLow)||(this.plotLow=this.plotY=v.yAxis.toPixels(this.low,!0)),v.lowerStateMarkerGraphic=v.stateMarkerGraphic,v.stateMarkerGraphic=v.upperStateMarkerGraphic,this.graphic=this.graphics&&this.graphics[1],this.plotY=this.plotHigh,g&&b(this.plotHighX)&&(this.plotX=this.plotHighX),s.setState.apply(this,arguments),this.state=x,this.plotY=this.plotLow,this.graphic=this.graphics&&this.graphics[0],g&&b(this.plotLowX)&&(this.plotX=this.plotLowX),v.upperStateMarkerGraphic=v.stateMarkerGraphic,v.stateMarkerGraphic=v.lowerStateMarkerGraphic,v.lowerStateMarkerGraphic=void 0;let P=v.modifyMarkerSettings();s.setState.apply(this,arguments),v.restoreMarkerSettings(P)}haloPath(){let x=this.series.chart.polar,v=[];return this.plotY=this.plotLow,x&&b(this.plotLowX)&&(this.plotX=this.plotLowX),this.isInside&&(v=s.haloPath.apply(this,arguments)),this.plotY=this.plotHigh,x&&b(this.plotHighX)&&(this.plotX=this.plotHighX),this.isTopInside&&(v=v.concat(s.haloPath.apply(this,arguments))),v}isValid(){return b(this.low)&&b(this.high)}}}),c(t,"Series/AreaRange/AreaRangeSeries.js",[t["Series/AreaRange/AreaRangePoint.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d,s){let{noop:f}=h,{area:b,area:{prototype:x},column:{prototype:v}}=d.seriesTypes,{addEvent:g,defined:P,extend:_,isArray:S,isNumber:k,pick:A,merge:y}=s;class I extends b{toYData(w){return[w.low,w.high]}highToXY(w){let M=this.chart,z=this.xAxis.postTranslate(w.rectPlotX||0,this.yAxis.len-(w.plotHigh||0));w.plotHighX=z.x-M.plotLeft,w.plotHigh=z.y-M.plotTop,w.plotLowX=w.plotX}getGraphPath(w){let M=[],z=[],Y=x.getGraphPath,X=this.options,Z=this.chart.polar,j=Z&&X.connectEnds!==!1,V=X.connectNulls,$,R,L,G=X.step;for($=(w=w||this.points).length;$--;){R=w[$];let ne=Z?{plotX:R.rectPlotX,plotY:R.yBottom,doCurve:!1}:{plotX:R.plotX,plotY:R.plotY,doCurve:!1};R.isNull||j||V||w[$+1]&&!w[$+1].isNull||z.push(ne),L={polarPlotY:R.polarPlotY,rectPlotX:R.rectPlotX,yBottom:R.yBottom,plotX:A(R.plotHighX,R.plotX),plotY:R.plotHigh,isNull:R.isNull},z.push(L),M.push(L),R.isNull||j||V||w[$-1]&&!w[$-1].isNull||z.push(ne)}let U=Y.call(this,w);G&&(G===!0&&(G="left"),X.step={left:"right",center:"center",right:"left"}[G]);let F=Y.call(this,M),H=Y.call(this,z);X.step=G;let W=[].concat(U,F);return!this.chart.polar&&H[0]&&H[0][0]==="M"&&(H[0]=["L",H[0][1],H[0][2]]),this.graphPath=W,this.areaPath=U.concat(H),W.isArea=!0,W.xMap=U.xMap,this.areaPath.xMap=U.xMap,W}drawDataLabels(){var L,G;let w,M,z,Y,X,Z=this.points,j=Z.length,V=[],$=this.options.dataLabels,R=this.chart.inverted;if($){if(S($)?(Y=$[0]||{enabled:!1},X=$[1]||{enabled:!1}):((Y=_({},$)).x=$.xHigh,Y.y=$.yHigh,(X=_({},$)).x=$.xLow,X.y=$.yLow),Y.enabled||((L=this.hasDataLabels)==null?void 0:L.call(this))){for(w=j;w--;)if(M=Z[w]){let{plotHigh:U=0,plotLow:F=0}=M;z=Y.inside?U<F:U>F,M.y=M.high,M._plotY=M.plotY,M.plotY=U,V[w]=M.dataLabel,M.dataLabel=M.dataLabelUpper,M.below=z,R?Y.align||(Y.align=z?"right":"left"):Y.verticalAlign||(Y.verticalAlign=z?"top":"bottom")}for(this.options.dataLabels=Y,x.drawDataLabels&&x.drawDataLabels.apply(this,arguments),w=j;w--;)(M=Z[w])&&(M.dataLabelUpper=M.dataLabel,M.dataLabel=V[w],delete M.dataLabels,M.y=M.low,M.plotY=M._plotY)}if(X.enabled||(G=this.hasDataLabels)!=null&&G.call(this)){for(w=j;w--;)if(M=Z[w]){let{plotHigh:U=0,plotLow:F=0}=M;z=X.inside?U<F:U>F,M.below=!z,R?X.align||(X.align=z?"left":"right"):X.verticalAlign||(X.verticalAlign=z?"bottom":"top")}this.options.dataLabels=X,x.drawDataLabels&&x.drawDataLabels.apply(this,arguments)}if(Y.enabled)for(w=j;w--;)(M=Z[w])&&(M.dataLabels=[M.dataLabelUpper,M.dataLabel].filter(function(U){return!!U}));this.options.dataLabels=$}}alignDataLabel(){v.alignDataLabel.apply(this,arguments)}modifyMarkerSettings(){let w={marker:this.options.marker,symbol:this.symbol};if(this.options.lowMarker){let{options:{marker:M,lowMarker:z}}=this;this.options.marker=y(M,z),z.symbol&&(this.symbol=z.symbol)}return w}restoreMarkerSettings(w){this.options.marker=w.marker,this.symbol=w.symbol}drawPoints(){let w,M,z=this.points.length,Y=this.modifyMarkerSettings();for(x.drawPoints.apply(this,arguments),this.restoreMarkerSettings(Y),w=0;w<z;)(M=this.points[w]).graphics=M.graphics||[],M.origProps={plotY:M.plotY,plotX:M.plotX,isInside:M.isInside,negative:M.negative,zone:M.zone,y:M.y},(M.graphic||M.graphics[0])&&(M.graphics[0]=M.graphic),M.graphic=M.graphics[1],M.plotY=M.plotHigh,P(M.plotHighX)&&(M.plotX=M.plotHighX),M.y=A(M.high,M.origProps.y),M.negative=M.y<(this.options.threshold||0),this.zones.length&&(M.zone=M.getZone()),this.chart.polar||(M.isInside=M.isTopInside=M.plotY!==void 0&&M.plotY>=0&&M.plotY<=this.yAxis.len&&M.plotX>=0&&M.plotX<=this.xAxis.len),w++;for(x.drawPoints.apply(this,arguments),w=0;w<z;)(M=this.points[w]).graphics=M.graphics||[],(M.graphic||M.graphics[1])&&(M.graphics[1]=M.graphic),M.graphic=M.graphics[0],M.origProps&&(_(M,M.origProps),delete M.origProps),w++}hasMarkerChanged(w,M){let z=w.lowMarker,Y=M.lowMarker||{};return z&&(z.enabled===!1||Y.symbol!==z.symbol||Y.height!==z.height||Y.width!==z.width)||super.hasMarkerChanged(w,M)}}return I.defaultOptions=y(b.defaultOptions,{lineWidth:1,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">●</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0,dataLabels:{align:void 0,verticalAlign:void 0,xLow:0,xHigh:0,yLow:0,yHigh:0}}),g(I,"afterTranslate",function(){this.pointArrayMap.join(",")==="low,high"&&this.points.forEach(D=>{let w=D.high,M=D.plotY;D.isNull?D.plotY=void 0:(D.plotLow=M,D.plotHigh=k(w)?this.yAxis.translate(this.dataModify?this.dataModify.modifyValue(w):w,!1,!0,void 0,!0):void 0,this.dataModify&&(D.yBottom=D.plotHigh))})},{order:0}),g(I,"afterTranslate",function(){this.points.forEach(D=>{if(this.chart.polar)this.highToXY(D),D.plotLow=D.plotY,D.tooltipPos=[((D.plotHighX||0)+(D.plotLowX||0))/2,((D.plotHigh||0)+(D.plotLow||0))/2];else{let w=D.pos(!1,D.plotLow),M=D.pos(!1,D.plotHigh);w&&M&&(w[0]=(w[0]+M[0])/2,w[1]=(w[1]+M[1])/2),D.tooltipPos=w}})},{order:3}),_(I.prototype,{deferTranslatePolar:!0,pointArrayMap:["low","high"],pointClass:a,pointValKey:"low",setStackedPoints:f}),d.registerSeriesType("arearange",I),I}),c(t,"Series/AreaSplineRange/AreaSplineRangeSeries.js",[t["Series/AreaRange/AreaRangeSeries.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d){let{spline:{prototype:s}}=h.seriesTypes,{merge:f,extend:b}=d;class x extends a{}return x.defaultOptions=f(a.defaultOptions),b(x.prototype,{getPointSpline:s.getPointSpline}),h.registerSeriesType("areasplinerange",x),x}),c(t,"Series/BoxPlot/BoxPlotSeriesDefaults.js",[],function(){return{threshold:null,tooltip:{pointFormat:'<span style="color:{point.color}">●</span> <b>{series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},whiskerLength:"50%",fillColor:"#ffffff",lineWidth:1,medianWidth:2,whiskerWidth:2}}),c(t,"Series/BoxPlot/BoxPlotSeries.js",[t["Series/BoxPlot/BoxPlotSeriesDefaults.js"],t["Series/Column/ColumnSeries.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d,s,f){let{noop:b}=d,{crisp:x,extend:v,merge:g,pick:P}=f;class _ extends h{pointAttribs(){return{}}translate(){let k=this.yAxis,A=this.pointArrayMap;super.translate.apply(this),this.points.forEach(function(y){A.forEach(function(I){y[I]!==null&&(y[I+"Plot"]=k.translate(y[I],0,1,0,1))}),y.plotHigh=y.highPlot})}drawPoints(){let k,A,y,I,D,w,M,z,Y,X,Z,j,V,$=this.points,R=this.options,L=this.chart,G=L.renderer,U=this.doQuartiles!==!1,F=this.options.whiskerLength;for(let H of $){let W=(z=H.graphic)?"animate":"attr",ne=H.shapeArgs,ue={},ie={},oe={},Te={},ge=H.color||this.color;if(H.plotY!==void 0){let we;Y=ne.width,Z=(X=ne.x)+Y,j=Y/2,k=U?H.q1Plot:H.lowPlot,A=U?H.q3Plot:H.lowPlot,y=H.highPlot,I=H.lowPlot,z||(H.graphic=z=G.g("point").add(this.group),H.stem=G.path().addClass("highcharts-boxplot-stem").add(z),F&&(H.whiskers=G.path().addClass("highcharts-boxplot-whisker").add(z)),U&&(H.box=G.path(M).addClass("highcharts-boxplot-box").add(z)),H.medianShape=G.path(w).addClass("highcharts-boxplot-median").add(z)),L.styledMode||(ie.stroke=H.stemColor||R.stemColor||ge,ie["stroke-width"]=P(H.stemWidth,R.stemWidth,R.lineWidth),ie.dashstyle=H.stemDashStyle||R.stemDashStyle||R.dashStyle,H.stem.attr(ie),F&&(oe.stroke=H.whiskerColor||R.whiskerColor||ge,oe["stroke-width"]=P(H.whiskerWidth,R.whiskerWidth,R.lineWidth),oe.dashstyle=H.whiskerDashStyle||R.whiskerDashStyle||R.dashStyle,H.whiskers.attr(oe)),U&&(ue.fill=H.fillColor||R.fillColor||ge,ue.stroke=R.lineColor||ge,ue["stroke-width"]=R.lineWidth||0,ue.dashstyle=H.boxDashStyle||R.boxDashStyle||R.dashStyle,H.box.attr(ue)),Te.stroke=H.medianColor||R.medianColor||ge,Te["stroke-width"]=P(H.medianWidth,R.medianWidth,R.lineWidth),Te.dashstyle=H.medianDashStyle||R.medianDashStyle||R.dashStyle,H.medianShape.attr(Te));let K=x((H.plotX||0)+(this.pointXOffset||0)+(this.barW||0)/2,H.stem.strokeWidth());if(we=[["M",K,A],["L",K,y],["M",K,k],["L",K,I]],H.stem[W]({d:we}),U){let Q=H.box.strokeWidth();k=x(k,Q),A=x(A,Q),we=[["M",X=x(X,Q),A],["L",X,k],["L",Z=x(Z,Q),k],["L",Z,A],["L",X,A],["Z"]],H.box[W]({d:we})}if(F){let Q=H.whiskers.strokeWidth();y=x(H.highPlot,Q),I=x(H.lowPlot,Q),we=[["M",x(K-(V=typeof F=="string"&&/%$/.test(F)?j*parseFloat(F)/100:Number(F)/2)),y],["L",x(K+V),y],["M",x(K-V),I],["L",x(K+V),I]],H.whiskers[W]({d:we})}we=[["M",X,D=x(H.medianPlot,H.medianShape.strokeWidth())],["L",Z,D]],H.medianShape[W]({d:we})}}}toYData(k){return[k.low,k.q1,k.median,k.q3,k.high]}}return _.defaultOptions=g(h.defaultOptions,a),v(_.prototype,{pointArrayMap:["low","q1","median","q3","high"],pointValKey:"high",drawDataLabels:b,setStackedPoints:b}),s.registerSeriesType("boxplot",_),_}),c(t,"Series/Bubble/BubbleLegendDefaults.js",[],function(){return{borderColor:void 0,borderWidth:2,className:void 0,color:void 0,connectorClassName:void 0,connectorColor:void 0,connectorDistance:60,connectorWidth:1,enabled:!1,labels:{className:void 0,allowOverlap:!1,format:"",formatter:void 0,align:"right",style:{fontSize:"0.9em",color:"#000000"},x:0,y:0},maxSize:60,minSize:10,legendIndex:0,ranges:{value:void 0,borderColor:void 0,color:void 0,connectorColor:void 0},sizeBy:"area",sizeByAbsoluteValue:!1,zIndex:1,zThreshold:0}}),c(t,"Series/Bubble/BubbleLegendItem.js",[t["Core/Color/Color.js"],t["Core/Templating.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h,d,s){let{parse:f}=a,{noop:b}=d,{arrayMax:x,arrayMin:v,isNumber:g,merge:P,pick:_,stableSort:S}=s;return class{constructor(k,A){this.setState=b,this.init(k,A)}init(k,A){this.options=k,this.visible=!0,this.chart=A.chart,this.legend=A}addToLegend(k){k.splice(this.options.legendIndex,0,this)}drawLegendSymbol(k){let A,y=_(k.options.itemDistance,20),I=this.legendItem||{},D=this.options,w=D.ranges,M=D.connectorDistance;if(!w||!w.length||!g(w[0].value)){k.options.bubbleLegend.autoRanges=!0;return}S(w,function(Z,j){return j.value-Z.value}),this.ranges=w,this.setOptions(),this.render();let z=this.getMaxLabelSize(),Y=this.ranges[0].radius,X=2*Y;A=(A=M-Y+z.width)>0?A:0,this.maxLabel=z,this.movementX=D.labels.align==="left"?A:0,I.labelWidth=X+A+y,I.labelHeight=X+z.height/2}setOptions(){let k=this.ranges,A=this.options,y=this.chart.series[A.seriesIndex],I=this.legend.baseline,D={zIndex:A.zIndex,"stroke-width":A.borderWidth},w={zIndex:A.zIndex,"stroke-width":A.connectorWidth},M={align:this.legend.options.rtl||A.labels.align==="left"?"right":"left",zIndex:A.zIndex},z=y.options.marker.fillOpacity,Y=this.chart.styledMode;k.forEach(function(X,Z){Y||(D.stroke=_(X.borderColor,A.borderColor,y.color),D.fill=_(X.color,A.color,z!==1?f(y.color).setOpacity(z).get("rgba"):y.color),w.stroke=_(X.connectorColor,A.connectorColor,y.color)),k[Z].radius=this.getRangeRadius(X.value),k[Z]=P(k[Z],{center:k[0].radius-k[Z].radius+I}),Y||P(!0,k[Z],{bubbleAttribs:P(D),connectorAttribs:P(w),labelAttribs:M})},this)}getRangeRadius(k){let A=this.options,y=this.options.seriesIndex,I=this.chart.series[y],D=A.ranges[0].value,w=A.ranges[A.ranges.length-1].value,M=A.minSize,z=A.maxSize;return I.getRadius.call(this,w,D,M,z,k)}render(){let k=this.legendItem||{},A=this.chart.renderer,y=this.options.zThreshold;for(let I of(this.symbols||(this.symbols={connectors:[],bubbleItems:[],labels:[]}),k.symbol=A.g("bubble-legend"),k.label=A.g("bubble-legend-item").css(this.legend.itemStyle||{}),k.symbol.translateX=0,k.symbol.translateY=0,k.symbol.add(k.label),k.label.add(k.group),this.ranges))I.value>=y&&this.renderRange(I);this.hideOverlappingLabels()}renderRange(k){let A=this.ranges[0],y=this.legend,I=this.options,D=I.labels,w=this.chart,M=w.series[I.seriesIndex],z=w.renderer,Y=this.symbols,X=Y.labels,Z=k.center,j=Math.abs(k.radius),V=I.connectorDistance||0,$=D.align,R=y.options.rtl,L=I.borderWidth,G=I.connectorWidth,U=A.radius||0,F=Z-j-L/2+G/2,H=(F%1?1:.5)-(G%2?0:.5),W=z.styledMode,ne=R||$==="left"?-V:V;$==="center"&&(ne=0,I.connectorDistance=0,k.labelAttribs.align="center"),Y.bubbleItems.push(z.circle(U,Z+H,j).attr(W?{}:k.bubbleAttribs).addClass((W?"highcharts-color-"+M.colorIndex+" ":"")+"highcharts-bubble-legend-symbol "+(I.className||"")).add(this.legendItem.symbol)),Y.connectors.push(z.path(z.crispLine([["M",U,F],["L",U+ne,F]],I.connectorWidth)).attr(W?{}:k.connectorAttribs).addClass((W?"highcharts-color-"+this.options.seriesIndex+" ":"")+"highcharts-bubble-legend-connectors "+(I.connectorClassName||"")).add(this.legendItem.symbol));let ue=z.text(this.formatLabel(k)).attr(W?{}:k.labelAttribs).css(W?{}:D.style).addClass("highcharts-bubble-legend-labels "+(I.labels.className||"")).add(this.legendItem.symbol),ie={x:U+ne+I.labels.x,y:F+I.labels.y+.4*ue.getBBox().height};ue.attr(ie),X.push(ue),ue.placed=!0,ue.alignAttr=ie}getMaxLabelSize(){let k,A;return this.symbols.labels.forEach(function(y){A=y.getBBox(!0),k=k?A.width>k.width?A:k:A}),k||{}}formatLabel(k){let A=this.options,y=A.labels.formatter,I=A.labels.format,{numberFormatter:D}=this.chart;return I?h.format(I,k):y?y.call(k):D(k.value,1)}hideOverlappingLabels(){let k=this.chart,A=this.options.labels.allowOverlap,y=this.symbols;!A&&y&&(k.hideOverlappingLabels(y.labels),y.labels.forEach(function(I,D){I.newOpacity?I.newOpacity!==I.oldOpacity&&y.connectors[D].show():y.connectors[D].hide()}))}getRanges(){let k=this.legend.bubbleLegend,A=k.chart.series,y=k.options.ranges,I,D,w=Number.MAX_VALUE,M=-Number.MAX_VALUE;return A.forEach(function(z){z.isBubble&&!z.ignoreSeries&&(D=z.zData.filter(g)).length&&(w=_(z.options.zMin,Math.min(w,Math.max(v(D),z.options.displayNegative===!1?z.options.zThreshold:-Number.MAX_VALUE))),M=_(z.options.zMax,Math.max(M,x(D))))}),I=w===M?[{value:M}]:[{value:w},{value:(w+M)/2},{value:M,autoRanges:!0}],y.length&&y[0].radius&&I.reverse(),I.forEach(function(z,Y){y&&y[Y]&&(I[Y]=P(y[Y],z))}),I}predictBubbleSizes(){let k=this.chart,A=k.legend.options,y=A.floating,I=A.layout==="horizontal",D=I?k.legend.lastLineHeight:0,w=k.plotSizeX,M=k.plotSizeY,z=k.series[this.options.seriesIndex],Y=z.getPxExtremes(),X=Math.ceil(Y.minPxSize),Z=Math.ceil(Y.maxPxSize),j=Math.min(M,w),V,$=z.options.maxSize;return y||!/%$/.test($)?V=Z:(V=(j+D)*($=parseFloat($))/100/($/100+1),(I&&M-V>=w||!I&&w-V>=M)&&(V=Z)),[X,Math.ceil(V)]}updateRanges(k,A){let y=this.legend.options.bubbleLegend;y.minSize=k,y.maxSize=A,y.ranges=this.getRanges()}correctSizes(){let k=this.legend,A=this.chart.series[this.options.seriesIndex].getPxExtremes();Math.abs(Math.ceil(A.maxPxSize)-this.options.maxSize)>1&&(this.updateRanges(this.options.minSize,A.maxPxSize),k.render())}}}),c(t,"Series/Bubble/BubbleLegendComposition.js",[t["Series/Bubble/BubbleLegendDefaults.js"],t["Series/Bubble/BubbleLegendItem.js"],t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h,d,s,f){let{setOptions:b}=d,{composed:x}=s,{addEvent:v,objectEach:g,pushUnique:P,wrap:_}=f;function S(w,M,z){let Y,X,Z,j=this.legend,V=k(this)>=0;j&&j.options.enabled&&j.bubbleLegend&&j.options.bubbleLegend.autoRanges&&V?(Y=j.bubbleLegend.options,X=j.bubbleLegend.predictBubbleSizes(),j.bubbleLegend.updateRanges(X[0],X[1]),Y.placed||(j.group.placed=!1,j.allItems.forEach($=>{(Z=$.legendItem||{}).group&&(Z.group.translateY=void 0)})),j.render(),Y.placed||(this.getMargins(),this.axes.forEach(function($){$.visible&&$.render(),Y.placed||($.setScale(),$.updateNames(),g($.ticks,function(R){R.isNew=!0,R.isNewLabel=!0}))}),this.getMargins()),Y.placed=!0,w.call(this,M,z),j.bubbleLegend.correctSizes(),D(j,A(j))):(w.call(this,M,z),j&&j.options.enabled&&j.bubbleLegend&&(j.render(),D(j,A(j))))}function k(w){let M=w.series,z=0;for(;z<M.length;){if(M[z]&&M[z].isBubble&&M[z].visible&&M[z].zData.length)return z;z++}return-1}function A(w){let M=w.allItems,z=[],Y=M.length,X,Z,j,V=0,$=0;for(V=0;V<Y;V++)if(Z=M[V].legendItem||{},j=(M[V+1]||{}).legendItem||{},Z.labelHeight&&(M[V].itemHeight=Z.labelHeight),M[V]===M[Y-1]||Z.y!==j.y){for(z.push({height:0}),X=z[z.length-1];$<=V;$++)M[$].itemHeight>X.height&&(X.height=M[$].itemHeight);X.step=V}return z}function y(w){let M=this.bubbleLegend,z=this.options,Y=z.bubbleLegend,X=k(this.chart);M&&M.ranges&&M.ranges.length&&(Y.ranges.length&&(Y.autoRanges=!!Y.ranges[0].autoRanges),this.destroyItem(M)),X>=0&&z.enabled&&Y.enabled&&(Y.seriesIndex=X,this.bubbleLegend=new h(Y,this),this.bubbleLegend.addToLegend(w.allItems))}function I(w){let M;if(w.defaultPrevented)return!1;let z=w.legendItem,Y=this.chart,X=z.visible;this&&this.bubbleLegend&&(z.visible=!X,z.ignoreSeries=X,M=k(Y)>=0,this.bubbleLegend.visible!==M&&(this.update({bubbleLegend:{enabled:M}}),this.bubbleLegend.visible=M),z.visible=X)}function D(w,M){let z=w.allItems,Y=w.options.rtl,X,Z,j,V,$=0;z.forEach((R,L)=>{(V=R.legendItem||{}).group&&(X=V.group.translateX||0,Z=V.y||0,((j=R.movementX)||Y&&R.ranges)&&(j=Y?X-R.options.maxSize/2:X+j,V.group.attr({translateX:j})),L>M[$].step&&$++,V.group.attr({translateY:Math.round(Z+M[$].height/2)}),V.y=Z+M[$].height/2)})}return{compose:function(w,M){P(x,"Series.BubbleLegend")&&(b({legend:{bubbleLegend:a}}),_(w.prototype,"drawChartBox",S),v(M,"afterGetAllItems",y),v(M,"itemClick",I))}}}),c(t,"Series/Bubble/BubblePoint.js",[t["Core/Series/Point.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d){let{seriesTypes:{scatter:{prototype:{pointClass:s}}}}=h,{extend:f}=d;class b extends s{haloPath(v){let g=(v&&this.marker&&this.marker.radius||0)+v;if(this.series.chart.inverted){let P=this.pos()||[0,0],{xAxis:_,yAxis:S,chart:k}=this.series;return k.renderer.symbols.circle(_.len-P[1]-g,S.len-P[0]-g,2*g,2*g)}return a.prototype.haloPath.call(this,g)}}return f(b.prototype,{ttBelow:!1}),b}),c(t,"Series/Bubble/BubbleSeries.js",[t["Series/Bubble/BubbleLegendComposition.js"],t["Series/Bubble/BubblePoint.js"],t["Core/Color/Color.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b){let{parse:x}=d,{composed:v,noop:g}=s,{series:P,seriesTypes:{column:{prototype:_},scatter:S}}=f,{addEvent:k,arrayMax:A,arrayMin:y,clamp:I,extend:D,isNumber:w,merge:M,pick:z,pushUnique:Y}=b;function X(){let j=this.len,{coll:V,isXAxis:$,min:R}=this,L=$?"xData":"yData",G=(this.max||0)-(R||0),U=0,F=j,H=j/G,W;(V==="xAxis"||V==="yAxis")&&(this.series.forEach(ne=>{if(ne.bubblePadding&&ne.reserveSpace()){this.allowZoomOutside=!0,W=!0;let ue=ne[L];if($&&((ne.onPoint||ne).getRadii(0,0,ne),ne.onPoint&&(ne.radii=ne.onPoint.radii)),G>0){let ie=ue.length;for(;ie--;)if(w(ue[ie])&&this.dataMin<=ue[ie]&&ue[ie]<=this.max){let oe=ne.radii&&ne.radii[ie]||0;U=Math.min((ue[ie]-R)*H-oe,U),F=Math.max((ue[ie]-R)*H+oe,F)}}}}),W&&G>0&&!this.logarithmic&&(F-=j,H*=(j+Math.max(0,U)-Math.min(F,j))/j,[["min","userMin",U],["max","userMax",F]].forEach(ne=>{z(this.options[ne[0]],this[ne[1]])===void 0&&(this[ne[0]]+=ne[2]/H)})))}class Z extends S{static compose(V,$,R){a.compose($,R),Y(v,"Series.Bubble")&&k(V,"foundExtremes",X)}animate(V){!V&&this.points.length<this.options.animationLimit&&this.points.forEach(function($){let{graphic:R,plotX:L=0,plotY:G=0}=$;R&&R.width&&(this.hasRendered||R.attr({x:L,y:G,width:1,height:1}),R.animate(this.markerAttribs($),this.options.animation))},this)}getRadii(){let V=this.zData,$=this.yData,R=[],L,G,U,F=this.chart.bubbleZExtremes,{minPxSize:H,maxPxSize:W}=this.getPxExtremes();if(!F){let ne,ue=Number.MAX_VALUE,ie=-Number.MAX_VALUE;this.chart.series.forEach(oe=>{if(oe.bubblePadding&&oe.reserveSpace()){let Te=(oe.onPoint||oe).getZExtremes();Te&&(ue=Math.min(z(ue,Te.zMin),Te.zMin),ie=Math.max(z(ie,Te.zMax),Te.zMax),ne=!0)}}),ne?(F={zMin:ue,zMax:ie},this.chart.bubbleZExtremes=F):F={zMin:0,zMax:0}}for(G=0,L=V.length;G<L;G++)U=V[G],R.push(this.getRadius(F.zMin,F.zMax,H,W,U,$&&$[G]));this.radii=R}getRadius(V,$,R,L,G,U){let F=this.options,H=F.sizeBy!=="width",W=F.zThreshold,ne=$-V,ue=.5;if(U===null||G===null)return null;if(w(G)){if(F.sizeByAbsoluteValue&&(G=Math.abs(G-W),$=ne=Math.max($-W,Math.abs(V-W)),V=0),G<V)return R/2-1;ne>0&&(ue=(G-V)/ne)}return H&&ue>=0&&(ue=Math.sqrt(ue)),Math.ceil(R+ue*(L-R))/2}hasData(){return!!this.processedXData.length}markerAttribs(V,$){let R=super.markerAttribs(V,$),{height:L=0,width:G=0}=R;return this.chart.inverted?D(R,{x:(V.plotX||0)-G/2,y:(V.plotY||0)-L/2}):R}pointAttribs(V,$){let R=this.options.marker.fillOpacity,L=P.prototype.pointAttribs.call(this,V,$);return R!==1&&(L.fill=x(L.fill).setOpacity(R).get("rgba")),L}translate(){super.translate.call(this),this.getRadii(),this.translateBubble()}translateBubble(){let{data:V,options:$,radii:R}=this,{minPxSize:L}=this.getPxExtremes(),G=V.length;for(;G--;){let U=V[G],F=R?R[G]:0;this.zoneAxis==="z"&&(U.negative=(U.z||0)<($.zThreshold||0)),w(F)&&F>=L/2?(U.marker=D(U.marker,{radius:F,width:2*F,height:2*F}),U.dlBox={x:U.plotX-F,y:U.plotY-F,width:2*F,height:2*F}):(U.shapeArgs=U.plotY=U.dlBox=void 0,U.isInside=!1)}}getPxExtremes(){let V=Math.min(this.chart.plotWidth,this.chart.plotHeight),$=G=>{let U;return typeof G=="string"&&(U=/%$/.test(G),G=parseInt(G,10)),U?V*G/100:G},R=$(z(this.options.minSize,8)),L=Math.max($(z(this.options.maxSize,"20%")),R);return{minPxSize:R,maxPxSize:L}}getZExtremes(){let V=this.options,$=(this.zData||[]).filter(w);if($.length){let R=z(V.zMin,I(y($),V.displayNegative===!1?V.zThreshold||0:-Number.MAX_VALUE,Number.MAX_VALUE)),L=z(V.zMax,A($));if(w(R)&&w(L))return{zMin:R,zMax:L}}}}return Z.defaultOptions=M(S.defaultOptions,{dataLabels:{formatter:function(){let{numberFormatter:j}=this.series.chart,{z:V}=this.point;return w(V)?j(V,-1):""},inside:!0,verticalAlign:"middle"},animationLimit:250,marker:{lineColor:null,lineWidth:1,fillOpacity:.5,radius:null,states:{hover:{radiusPlus:0}},symbol:"circle"},minSize:8,maxSize:"20%",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0,zoneAxis:"z"}),D(Z.prototype,{alignDataLabel:_.alignDataLabel,applyZones:g,bubblePadding:!0,isBubble:!0,pointArrayMap:["y","z"],pointClass:h,parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],specialGroup:"group",zoneAxis:"z"}),k(Z,"updatedData",j=>{delete j.target.chart.bubbleZExtremes}),k(Z,"remove",j=>{delete j.target.chart.bubbleZExtremes}),f.registerSeriesType("bubble",Z),Z}),c(t,"Series/ColumnRange/ColumnRangePoint.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h){let{seriesTypes:{column:{prototype:{pointClass:{prototype:d}}},arearange:{prototype:{pointClass:s}}}}=a,{extend:f,isNumber:b}=h;class x extends s{isValid(){return b(this.low)}}return f(x.prototype,{setState:d.setState}),x}),c(t,"Series/ColumnRange/ColumnRangeSeries.js",[t["Series/ColumnRange/ColumnRangePoint.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d,s){let{noop:f}=h,{seriesTypes:{arearange:b,column:x,column:{prototype:v}}}=d,{addEvent:g,clamp:P,extend:_,isNumber:S,merge:k,pick:A}=s;class y extends b{setOptions(){return k(!0,arguments[0],{stacking:void 0}),b.prototype.setOptions.apply(this,arguments)}translate(){return v.translate.apply(this)}pointAttribs(){return v.pointAttribs.apply(this,arguments)}translate3dPoints(){return v.translate3dPoints.apply(this,arguments)}translate3dShapes(){return v.translate3dShapes.apply(this,arguments)}afterColumnTranslate(){let D,w,M,z,Y=this.yAxis,X=this.xAxis,Z=X.startAngleRad,j=this.chart,V=this.xAxis.isRadial,$=Math.max(j.chartWidth,j.chartHeight)+999;this.points.forEach(R=>{let L=R.shapeArgs||{},G=this.options.minPointLength,U=R.plotY,F=Y.translate(R.high,0,1,0,1);if(S(F)&&S(U))if(R.plotHigh=P(F,-$,$),R.plotLow=P(U,-$,$),z=R.plotHigh,Math.abs(D=A(R.rectPlotY,R.plotY)-R.plotHigh)<G?(w=G-D,D+=w,z-=w/2):D<0&&(D*=-1,z-=D),V&&this.polar)M=R.barX+Z,R.shapeType="arc",R.shapeArgs=this.polar.arc(z+D,z,M,M+R.pointWidth);else{L.height=D,L.y=z;let{x:H=0,width:W=0}=L;R.shapeArgs=k(R.shapeArgs,this.crispCol(H,z,W,D)),R.tooltipPos=j.inverted?[Y.len+Y.pos-j.plotLeft-z-D/2,X.len+X.pos-j.plotTop-H-W/2,D]:[X.left-j.plotLeft+H+W/2,Y.pos-j.plotTop+z+D/2,D]}})}}return y.defaultOptions=k(x.defaultOptions,b.defaultOptions,{borderRadius:{where:"all"},pointRange:null,legendSymbol:"rectangle",marker:null,states:{hover:{halo:!1}}}),g(y,"afterColumnTranslate",function(){y.prototype.afterColumnTranslate.apply(this)},{order:5}),_(y.prototype,{directTouch:!0,pointClass:a,trackerGroups:["group","dataLabelsGroup"],adjustForMissingColumns:v.adjustForMissingColumns,animate:v.animate,crispCol:v.crispCol,drawGraph:f,drawPoints:v.drawPoints,getSymbol:f,drawTracker:v.drawTracker,getColumnMetrics:v.getColumnMetrics}),d.registerSeriesType("columnrange",y),y}),c(t,"Series/ColumnPyramid/ColumnPyramidSeriesDefaults.js",[],function(){return{}}),c(t,"Series/ColumnPyramid/ColumnPyramidSeries.js",[t["Series/ColumnPyramid/ColumnPyramidSeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d){let{column:s}=h.seriesTypes,{clamp:f,merge:b,pick:x}=d;class v extends s{translate(){let P=this.chart,_=this.options,S=this.dense=this.closestPointRange*this.xAxis.transA<2,k=this.borderWidth=x(_.borderWidth,S?0:1),A=this.yAxis,y=_.threshold,I=x(_.minPointLength,5),D=this.getColumnMetrics(),w=D.width,M=this.pointXOffset=D.offset,z=this.translatedThreshold=A.getThreshold(y),Y=this.barW=Math.max(w,1+2*k);for(let X of(P.inverted&&(z-=.5),_.pointPadding&&(Y=Math.ceil(Y)),super.translate(),this.points)){let Z=x(X.yBottom,z),j=999+Math.abs(Z),V=f(X.plotY,-j,A.len+j),$=Y/2,R=Math.min(V,Z),L=Math.max(V,Z)-R,G=X.plotX+M,U,F,H,W,ne,ue,ie,oe,Te,ge,we;_.centerInCategory&&(G=this.adjustForMissingColumns(G,w,X,D)),X.barX=G,X.pointWidth=w,X.tooltipPos=P.inverted?[A.len+A.pos-P.plotLeft-V,this.xAxis.len-G-$,L]:[G+$,V+A.pos-P.plotTop,L],U=y+(X.total||X.y),_.stacking==="percent"&&(U=y+(X.y<0)?-100:100);let K=A.toPixels(U,!0);H=(F=P.plotHeight-K-(P.plotHeight-z))?$*(R-K)/F:0,W=F?$*(R+L-K)/F:0,ue=G-H+$,ie=G+H+$,oe=G+W+$,Te=G-W+$,ge=R-I,we=R+L,X.y<0&&(ge=R,we=R+L+I),P.inverted&&(ne=A.width-R,F=K-(A.width-z),H=$*(K-ne)/F,W=$*(K-(ne-L))/F,ie=(ue=G+$+H)-2*H,oe=G-W+$,Te=G+W+$,ge=R,we=R+L-I,X.y<0&&(we=R+L+I)),X.shapeType="path",X.shapeArgs={x:ue,y:ge,width:ie-ue,height:L,d:[["M",ue,ge],["L",ie,ge],["L",oe,we],["L",Te,we],["Z"]]}}}}return v.defaultOptions=b(s.defaultOptions,a),h.registerSeriesType("columnpyramid",v),v}),c(t,"Series/ErrorBar/ErrorBarSeriesDefaults.js",[],function(){return{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},whiskerWidth:null}}),c(t,"Series/ErrorBar/ErrorBarSeries.js",[t["Series/BoxPlot/BoxPlotSeries.js"],t["Series/Column/ColumnSeries.js"],t["Series/ErrorBar/ErrorBarSeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d,s,f){let{arearange:b}=s.seriesTypes,{addEvent:x,merge:v,extend:g}=f;class P extends a{getColumnMetrics(){return this.linkedParent&&this.linkedParent.columnMetrics||h.prototype.getColumnMetrics.call(this)}drawDataLabels(){let S=this.pointValKey;if(b)for(let k of(b.prototype.drawDataLabels.call(this),this.points))k.y=k[S]}toYData(S){return[S.low,S.high]}}return P.defaultOptions=v(a.defaultOptions,d),x(P,"afterTranslate",function(){for(let _ of this.points)_.plotLow=_.plotY},{order:0}),g(P.prototype,{pointArrayMap:["low","high"],pointValKey:"high",doQuartiles:!1}),s.registerSeriesType("errorbar",P),P}),c(t,"Series/Gauge/GaugePoint.js",[t["Core/Series/SeriesRegistry.js"]],function(a){let{series:{prototype:{pointClass:h}}}=a;return class extends h{setState(d){this.state=d}}}),c(t,"Series/Gauge/GaugeSeries.js",[t["Series/Gauge/GaugePoint.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d,s){let{noop:f}=h,{series:b,seriesTypes:{column:x}}=d,{clamp:v,isNumber:g,extend:P,merge:_,pick:S,pInt:k,defined:A}=s;class y extends b{translate(){let D=this.yAxis,w=this.options,M=D.center;this.generatePoints(),this.points.forEach(z=>{let Y=_(w.dial,z.dial),X=k(Y.radius)*M[2]/200,Z=k(Y.baseLength)*X/100,j=k(Y.rearLength)*X/100,V=Y.baseWidth,$=Y.topWidth,R=w.overshoot,L=D.startAngleRad+D.translate(z.y,void 0,void 0,void 0,!0);(g(R)||w.wrap===!1)&&(R=g(R)?R/180*Math.PI:0,L=v(L,D.startAngleRad-R,D.endAngleRad+R)),L=180*L/Math.PI,z.shapeType="path";let G=Y.path||[["M",-j,-V/2],["L",Z,-V/2],["L",X,-$/2],["L",X,$/2],["L",Z,V/2],["L",-j,V/2],["Z"]];z.shapeArgs={d:G,translateX:M[0],translateY:M[1],rotation:L},z.plotX=M[0],z.plotY=M[1],A(z.y)&&D.max-D.min&&(z.percentage=(z.y-D.min)/(D.max-D.min)*100)})}drawPoints(){let D=this,w=D.chart,M=D.yAxis.center,z=D.pivot,Y=D.options,X=Y.pivot,Z=w.renderer;D.points.forEach(j=>{let V=j.graphic,$=j.shapeArgs,R=$.d,L=_(Y.dial,j.dial);V?(V.animate($),$.d=R):j.graphic=Z[j.shapeType]($).addClass("highcharts-dial").add(D.group),w.styledMode||j.graphic[V?"animate":"attr"]({stroke:L.borderColor,"stroke-width":L.borderWidth,fill:L.backgroundColor})}),z?z.animate({translateX:M[0],translateY:M[1]}):X&&(D.pivot=Z.circle(0,0,X.radius).attr({zIndex:2}).addClass("highcharts-pivot").translate(M[0],M[1]).add(D.group),w.styledMode||D.pivot.attr({fill:X.backgroundColor,stroke:X.borderColor,"stroke-width":X.borderWidth}))}animate(D){let w=this;D||w.points.forEach(M=>{let z=M.graphic;z&&(z.attr({rotation:180*w.yAxis.startAngleRad/Math.PI}),z.animate({rotation:M.shapeArgs.rotation},w.options.animation))})}render(){this.group=this.plotGroup("group","series",this.visible?"inherit":"hidden",this.options.zIndex,this.chart.seriesGroup),b.prototype.render.call(this),this.group.clip(this.chart.clipRect)}setData(D,w){b.prototype.setData.call(this,D,!1),this.processData(),this.generatePoints(),S(w,!0)&&this.chart.redraw()}hasData(){return!!this.points.length}}return y.defaultOptions=_(b.defaultOptions,{dataLabels:{borderColor:"#cccccc",borderRadius:3,borderWidth:1,crop:!1,defer:!1,enabled:!0,verticalAlign:"top",y:15,zIndex:2},dial:{backgroundColor:"#000000",baseLength:"70%",baseWidth:3,borderColor:"#cccccc",borderWidth:0,radius:"80%",rearLength:"10%",topWidth:1},pivot:{radius:5,borderWidth:0,borderColor:"#cccccc",backgroundColor:"#000000"},tooltip:{headerFormat:""},showInLegend:!1}),P(y.prototype,{angular:!0,directTouch:!0,drawGraph:f,drawTracker:x.prototype.drawTracker,fixedBox:!0,forceDL:!0,noSharedTooltip:!0,pointClass:a,trackerGroups:["group","dataLabelsGroup"]}),d.registerSeriesType("gauge",y),y}),c(t,"Series/DragNodesComposition.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h){let{composed:d}=a,{addEvent:s,pushUnique:f}=h;function b(){let x,v,g,P=this;P.container&&(x=s(P.container,"mousedown",_=>{let S=P.hoverPoint;S&&S.series&&S.series.hasDraggableNodes&&S.series.options.draggable&&(S.series.onMouseDown(S,_),v=s(P.container,"mousemove",k=>S&&S.series&&S.series.onMouseMove(S,k)),g=s(P.container.ownerDocument,"mouseup",k=>(v(),g(),S&&S.series&&S.series.onMouseUp(S,k))))})),s(P,"destroy",function(){x()})}return{compose:function(x){f(d,"DragNodes")&&s(x,"load",b)},onMouseDown:function(x,v){var P;let g=((P=this.chart.pointer)==null?void 0:P.normalize(v))||v;x.fixedPosition={chartX:g.chartX,chartY:g.chartY,plotX:x.plotX,plotY:x.plotY},x.inDragMode=!0},onMouseMove:function(x,v){var g;if(x.fixedPosition&&x.inDragMode){let P,_,S=this.chart,k=((g=S.pointer)==null?void 0:g.normalize(v))||v,A=x.fixedPosition.chartX-k.chartX,y=x.fixedPosition.chartY-k.chartY,I=S.graphLayoutsLookup;(Math.abs(A)>5||Math.abs(y)>5)&&(P=x.fixedPosition.plotX-A,_=x.fixedPosition.plotY-y,S.isInsidePlot(P,_)&&(x.plotX=P,x.plotY=_,x.hasDragged=!0,this.redrawHalo(x),I.forEach(D=>{D.restartSimulation()})))}},onMouseUp:function(x){x.fixedPosition&&(x.hasDragged&&(this.layout.enableSimulation?this.layout.start():this.chart.redraw()),x.inDragMode=x.hasDragged=!1,this.options.fixedDraggable||delete x.fixedPosition)},redrawHalo:function(x){x&&this.halo&&this.halo.attr({d:x.haloPath(this.options.states.hover.halo.size)})}}}),c(t,"Series/GraphLayoutComposition.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h,d){let{setAnimation:s}=a,{composed:f}=h,{addEvent:b,pushUnique:x}=d;function v(){this.graphLayoutsLookup&&(this.graphLayoutsLookup.forEach(S=>{S.updateSimulation()}),this.redraw())}function g(){this.graphLayoutsLookup&&(this.graphLayoutsLookup.forEach(S=>{S.updateSimulation(!1)}),this.redraw())}function P(){this.graphLayoutsLookup&&this.graphLayoutsLookup.forEach(S=>{S.stop()})}function _(){let S,k=!1,A=y=>{y.maxIterations--&&isFinite(y.temperature)&&!y.isStable()&&!y.enableSimulation&&(y.beforeStep&&y.beforeStep(),y.step(),S=!1,k=!0)};if(this.graphLayoutsLookup){for(s(!1,this),this.graphLayoutsLookup.forEach(y=>y.start());!S;)S=!0,this.graphLayoutsLookup.forEach(A);k&&this.series.forEach(y=>{y&&y.layout&&y.render()})}}return{compose:function(S){x(f,"GraphLayout")&&(b(S,"afterPrint",v),b(S,"beforePrint",g),b(S,"predraw",P),b(S,"render",_))},integrations:{},layouts:{}}}),c(t,"Series/PackedBubble/PackedBubblePoint.js",[t["Core/Chart/Chart.js"],t["Core/Series/Point.js"],t["Core/Series/SeriesRegistry.js"]],function(a,h,d){let{seriesTypes:{bubble:{prototype:{pointClass:s}}}}=d;return class extends s{destroy(){var f;return(f=this.series)!=null&&f.layout&&this.series.layout.removeElementFromCollection(this,this.series.layout.nodes),h.prototype.destroy.apply(this,arguments)}firePointEvent(){let f=this.series.options;if(this.isParentNode&&f.parentNode){let b=f.allowPointSelect;f.allowPointSelect=f.parentNode.allowPointSelect,h.prototype.firePointEvent.apply(this,arguments),f.allowPointSelect=b}else h.prototype.firePointEvent.apply(this,arguments)}select(){let f=this.series.chart;this.isParentNode?(f.getSelectedPoints=f.getSelectedParentNodes,h.prototype.select.apply(this,arguments),f.getSelectedPoints=a.prototype.getSelectedPoints):h.prototype.select.apply(this,arguments)}}}),c(t,"Series/PackedBubble/PackedBubbleSeriesDefaults.js",[t["Core/Utilities.js"]],function(a){let{isNumber:h}=a;return{minSize:"10%",maxSize:"50%",sizeBy:"area",zoneAxis:"y",crisp:!1,tooltip:{pointFormat:"Value: {point.value}"},draggable:!0,useSimulation:!0,parentNode:{allowPointSelect:!1},dataLabels:{formatter:function(){let{numberFormatter:d}=this.series.chart,{value:s}=this.point;return h(s)?d(s,-1):""},parentNodeFormatter:function(){return this.name},parentNodeTextPath:{enabled:!0},padding:0,style:{transition:"opacity 2000ms"}},layoutAlgorithm:{initialPositions:"circle",initialPositionRadius:20,bubblePadding:5,parentNodeLimit:!1,seriesInteraction:!0,dragBetweenSeries:!1,parentNodeOptions:{maxIterations:400,gravitationalConstant:.03,maxSpeed:50,initialPositionRadius:100,seriesInteraction:!0,marker:{fillColor:null,fillOpacity:1,lineWidth:null,lineColor:null,symbol:"circle"}},enableSimulation:!0,type:"packedbubble",integration:"packedbubble",maxIterations:1e3,splitSeries:!1,maxSpeed:5,gravitationalConstant:.01,friction:-.981}}}),c(t,"Series/Networkgraph/VerletIntegration.js",[],function(){return{attractive:function(a,h,d){let s=a.getMass(),f=-d.x*h*this.diffTemperature,b=-d.y*h*this.diffTemperature;a.fromNode.fixedPosition||(a.fromNode.plotX-=f*s.fromNode/a.fromNode.degree,a.fromNode.plotY-=b*s.fromNode/a.fromNode.degree),a.toNode.fixedPosition||(a.toNode.plotX+=f*s.toNode/a.toNode.degree,a.toNode.plotY+=b*s.toNode/a.toNode.degree)},attractiveForceFunction:function(a,h){return(h-a)/a},barycenter:function(){let a=this.options.gravitationalConstant||0,h=(this.barycenter.xFactor-(this.box.left+this.box.width)/2)*a,d=(this.barycenter.yFactor-(this.box.top+this.box.height)/2)*a;this.nodes.forEach(function(s){s.fixedPosition||(s.plotX-=h/s.mass/s.degree,s.plotY-=d/s.mass/s.degree)})},getK:function(a){return Math.pow(a.box.width*a.box.height/a.nodes.length,.5)},integrate:function(a,h){let d=-a.options.friction,s=a.options.maxSpeed,f=h.prevX,b=h.prevY,x=(h.plotX+h.dispX-f)*d,v=(h.plotY+h.dispY-b)*d,g=Math.abs,P=g(x)/(x||1),_=g(v)/(v||1),S=P*Math.min(s,Math.abs(x)),k=_*Math.min(s,Math.abs(v));h.prevX=h.plotX+h.dispX,h.prevY=h.plotY+h.dispY,h.plotX+=S,h.plotY+=k,h.temperature=a.vectorLength({x:S,y:k})},repulsive:function(a,h,d){let s=h*this.diffTemperature/a.mass/a.degree;a.fixedPosition||(a.plotX+=d.x*s,a.plotY+=d.y*s)},repulsiveForceFunction:function(a,h){return(h-a)/a*(h>a?1:0)}}}),c(t,"Series/PackedBubble/PackedBubbleIntegration.js",[t["Core/Globals.js"],t["Series/Networkgraph/VerletIntegration.js"]],function(a,h){let{noop:d}=a;return{barycenter:function(){let s,f,b=this.options.gravitationalConstant,x=this.box,v=this.nodes;for(let g of v)this.options.splitSeries&&!g.isParentNode?(s=g.series.parentNode.plotX,f=g.series.parentNode.plotY):(s=x.width/2,f=x.height/2),g.fixedPosition||(g.plotX-=(g.plotX-s)*b/(g.mass*Math.sqrt(v.length)),g.plotY-=(g.plotY-f)*b/(g.mass*Math.sqrt(v.length)))},getK:d,integrate:h.integrate,repulsive:function(s,f,b,x){let v=f*this.diffTemperature/s.mass/s.degree,g=b.x*v,P=b.y*v;s.fixedPosition||(s.plotX+=g,s.plotY+=P),x.fixedPosition||(x.plotX-=g,x.plotY-=P)},repulsiveForceFunction:function(s,f,b,x){return Math.min(s,(b.marker.radius+x.marker.radius)/2)}}}),c(t,"Series/Networkgraph/EulerIntegration.js",[],function(){return{attractive:function(a,h,d,s){let f=a.getMass(),b=d.x/s*h,x=d.y/s*h;a.fromNode.fixedPosition||(a.fromNode.dispX-=b*f.fromNode/a.fromNode.degree,a.fromNode.dispY-=x*f.fromNode/a.fromNode.degree),a.toNode.fixedPosition||(a.toNode.dispX+=b*f.toNode/a.toNode.degree,a.toNode.dispY+=x*f.toNode/a.toNode.degree)},attractiveForceFunction:function(a,h){return a*a/h},barycenter:function(){let a=this.options.gravitationalConstant,h=this.barycenter.xFactor,d=this.barycenter.yFactor;this.nodes.forEach(function(s){if(!s.fixedPosition){let f=s.getDegree(),b=f*(1+f/2);s.dispX+=(h-s.plotX)*a*b/s.degree,s.dispY+=(d-s.plotY)*a*b/s.degree}})},getK:function(a){return Math.pow(a.box.width*a.box.height/a.nodes.length,.3)},integrate:function(a,h){h.dispX+=h.dispX*a.options.friction,h.dispY+=h.dispY*a.options.friction;let d=h.temperature=a.vectorLength({x:h.dispX,y:h.dispY});d!==0&&(h.plotX+=h.dispX/d*Math.min(Math.abs(h.dispX),a.temperature),h.plotY+=h.dispY/d*Math.min(Math.abs(h.dispY),a.temperature))},repulsive:function(a,h,d,s){a.dispX+=d.x/s*h/a.degree,a.dispY+=d.y/s*h/a.degree},repulsiveForceFunction:function(a,h){return h*h/a}}}),c(t,"Series/Networkgraph/QuadTreeNode.js",[],function(){class a{constructor(d){this.body=!1,this.isEmpty=!1,this.isInternal=!1,this.nodes=[],this.box=d,this.boxSize=Math.min(d.width,d.height)}divideBox(){let d=this.box.width/2,s=this.box.height/2;this.nodes[0]=new a({left:this.box.left,top:this.box.top,width:d,height:s}),this.nodes[1]=new a({left:this.box.left+d,top:this.box.top,width:d,height:s}),this.nodes[2]=new a({left:this.box.left+d,top:this.box.top+s,width:d,height:s}),this.nodes[3]=new a({left:this.box.left,top:this.box.top+s,width:d,height:s})}getBoxPosition(d){let s=d.plotX<this.box.left+this.box.width/2,f=d.plotY<this.box.top+this.box.height/2;return s?f?0:3:f?1:2}insert(d,s){let f;this.isInternal?this.nodes[this.getBoxPosition(d)].insert(d,s-1):(this.isEmpty=!1,this.body?s?(this.isInternal=!0,this.divideBox(),this.body!==!0&&(this.nodes[this.getBoxPosition(this.body)].insert(this.body,s-1),this.body=!0),this.nodes[this.getBoxPosition(d)].insert(d,s-1)):((f=new a({top:d.plotX||NaN,left:d.plotY||NaN,width:.1,height:.1})).body=d,f.isInternal=!1,this.nodes.push(f)):(this.isInternal=!1,this.body=d))}updateMassAndCenter(){let d=0,s=0,f=0;if(this.isInternal){for(let b of this.nodes)b.isEmpty||(d+=b.mass,s+=b.plotX*b.mass,f+=b.plotY*b.mass);s/=d,f/=d}else this.body&&(d=this.body.mass,s=this.body.plotX,f=this.body.plotY);this.mass=d,this.plotX=s,this.plotY=f}}return a}),c(t,"Series/Networkgraph/QuadTree.js",[t["Series/Networkgraph/QuadTreeNode.js"]],function(a){return class{constructor(h,d,s,f){this.box={left:h,top:d,width:s,height:f},this.maxDepth=25,this.root=new a(this.box),this.root.isInternal=!0,this.root.isRoot=!0,this.root.divideBox()}calculateMassAndCenter(){this.visitNodeRecursive(null,null,function(h){h.updateMassAndCenter()})}insertNodes(h){for(let d of h)this.root.insert(d,this.maxDepth)}visitNodeRecursive(h,d,s){let f;if(h||(h=this.root),h===this.root&&d&&(f=d(h)),f!==!1){for(let b of h.nodes){if(b.isInternal){if(d&&(f=d(b)),f===!1)continue;this.visitNodeRecursive(b,d,s)}else b.body&&d&&d(b.body);s&&s(b)}h===this.root&&s&&s(h)}}}}),c(t,"Series/Networkgraph/ReingoldFruchtermanLayout.js",[t["Series/Networkgraph/EulerIntegration.js"],t["Core/Globals.js"],t["Series/GraphLayoutComposition.js"],t["Series/Networkgraph/QuadTree.js"],t["Core/Utilities.js"],t["Series/Networkgraph/VerletIntegration.js"]],function(a,h,d,s,f,b){let{win:x}=h,{clamp:v,defined:g,isFunction:P,fireEvent:_,pick:S}=f;class k{constructor(){this.box={},this.currentStep=0,this.initialRendering=!0,this.links=[],this.nodes=[],this.series=[],this.simulation=!1}static compose(y){d.compose(y),d.integrations.euler=a,d.integrations.verlet=b,d.layouts["reingold-fruchterman"]=k}init(y){this.options=y,this.nodes=[],this.links=[],this.series=[],this.box={x:0,y:0,width:0,height:0},this.setInitialRendering(!0),this.integration=d.integrations[y.integration],this.enableSimulation=y.enableSimulation,this.attractiveForce=S(y.attractiveForce,this.integration.attractiveForceFunction),this.repulsiveForce=S(y.repulsiveForce,this.integration.repulsiveForceFunction),this.approximation=y.approximation}updateSimulation(y){this.enableSimulation=S(y,this.options.enableSimulation)}start(){let y=this.series,I=this.options;this.currentStep=0,this.forces=y[0]&&y[0].forces||[],this.chart=y[0]&&y[0].chart,this.initialRendering&&(this.initPositions(),y.forEach(function(D){D.finishedAnimating=!0,D.render()})),this.setK(),this.resetSimulation(I),this.enableSimulation&&this.step()}step(){let y=this.series;for(let I of(this.currentStep++,this.approximation==="barnes-hut"&&(this.createQuadTree(),this.quadTree.calculateMassAndCenter()),this.forces||[]))this[I+"Forces"](this.temperature);if(this.applyLimits(),this.temperature=this.coolDown(this.startTemperature,this.diffTemperature,this.currentStep),this.prevSystemTemperature=this.systemTemperature,this.systemTemperature=this.getSystemTemperature(),this.enableSimulation){for(let I of y)I.chart&&I.render();this.maxIterations--&&isFinite(this.temperature)&&!this.isStable()?(this.simulation&&x.cancelAnimationFrame(this.simulation),this.simulation=x.requestAnimationFrame(()=>this.step())):(this.simulation=!1,this.series.forEach(I=>{_(I,"afterSimulation")}))}}stop(){this.simulation&&x.cancelAnimationFrame(this.simulation)}setArea(y,I,D,w){this.box={left:y,top:I,width:D,height:w}}setK(){this.k=this.options.linkLength||this.integration.getK(this)}addElementsToCollection(y,I){for(let D of y)I.indexOf(D)===-1&&I.push(D)}removeElementFromCollection(y,I){let D=I.indexOf(y);D!==-1&&I.splice(D,1)}clear(){this.nodes.length=0,this.links.length=0,this.series.length=0,this.resetSimulation()}resetSimulation(){this.forcedStop=!1,this.systemTemperature=0,this.setMaxIterations(),this.setTemperature(),this.setDiffTemperature()}restartSimulation(){this.simulation?this.resetSimulation():(this.setInitialRendering(!1),this.enableSimulation?this.start():this.setMaxIterations(1),this.chart&&this.chart.redraw(),this.setInitialRendering(!0))}setMaxIterations(y){this.maxIterations=S(y,this.options.maxIterations)}setTemperature(){this.temperature=this.startTemperature=Math.sqrt(this.nodes.length)}setDiffTemperature(){this.diffTemperature=this.startTemperature/(this.options.maxIterations+1)}setInitialRendering(y){this.initialRendering=y}createQuadTree(){this.quadTree=new s(this.box.left,this.box.top,this.box.width,this.box.height),this.quadTree.insertNodes(this.nodes)}initPositions(){let y=this.options.initialPositions;if(P(y))for(let I of(y.call(this),this.nodes))g(I.prevX)||(I.prevX=I.plotX),g(I.prevY)||(I.prevY=I.plotY),I.dispX=0,I.dispY=0;else y==="circle"?this.setCircularPositions():this.setRandomPositions()}setCircularPositions(){let y,I=this.box,D=this.nodes,w=2*Math.PI/(D.length+1),M=D.filter(function(j){return j.linksTo.length===0}),z={},Y=this.options.initialPositionRadius,X=j=>{for(let V of j.linksFrom||[])z[V.toNode.id]||(z[V.toNode.id]=!0,Z.push(V.toNode),X(V.toNode))},Z=[];for(let j of M)Z.push(j),X(j);if(Z.length)for(let j of D)Z.indexOf(j)===-1&&Z.push(j);else Z=D;for(let j=0,V=Z.length;j<V;++j)(y=Z[j]).plotX=y.prevX=S(y.plotX,I.width/2+Y*Math.cos(j*w)),y.plotY=y.prevY=S(y.plotY,I.height/2+Y*Math.sin(j*w)),y.dispX=0,y.dispY=0}setRandomPositions(){let y,I=this.box,D=this.nodes,w=D.length+1,M=z=>{let Y=z*z/Math.PI;return Y-Math.floor(Y)};for(let z=0,Y=D.length;z<Y;++z)(y=D[z]).plotX=y.prevX=S(y.plotX,I.width*M(z)),y.plotY=y.prevY=S(y.plotY,I.height*M(w+z)),y.dispX=0,y.dispY=0}force(y,...I){this.integration[y].apply(this,I)}barycenterForces(){this.getBarycenter(),this.force("barycenter")}getBarycenter(){let y=0,I=0,D=0;for(let w of this.nodes)I+=w.plotX*w.mass,D+=w.plotY*w.mass,y+=w.mass;return this.barycenter={x:I,y:D,xFactor:I/y,yFactor:D/y},this.barycenter}barnesHutApproximation(y,I){let D,w,M=this.getDistXY(y,I),z=this.vectorLength(M);return y!==I&&z!==0&&(I.isInternal?I.boxSize/z<this.options.theta&&z!==0?(w=this.repulsiveForce(z,this.k),this.force("repulsive",y,w*I.mass,M,z),D=!1):D=!0:(w=this.repulsiveForce(z,this.k),this.force("repulsive",y,w*I.mass,M,z))),D}repulsiveForces(){if(this.approximation==="barnes-hut")for(let y of this.nodes)this.quadTree.visitNodeRecursive(null,I=>this.barnesHutApproximation(y,I));else{let y,I,D;for(let w of this.nodes)for(let M of this.nodes)w===M||w.fixedPosition||(D=this.getDistXY(w,M),(I=this.vectorLength(D))!==0&&(y=this.repulsiveForce(I,this.k),this.force("repulsive",w,y*M.mass,D,I)))}}attractiveForces(){let y,I,D;for(let w of this.links)w.fromNode&&w.toNode&&(y=this.getDistXY(w.fromNode,w.toNode),(I=this.vectorLength(y))!==0&&(D=this.attractiveForce(I,this.k),this.force("attractive",w,D,y,I)))}applyLimits(){for(let y of this.nodes)y.fixedPosition||(this.integration.integrate(this,y),this.applyLimitBox(y,this.box),y.dispX=0,y.dispY=0)}applyLimitBox(y,I){let D=y.radius;y.plotX=v(y.plotX,I.left+D,I.width-D),y.plotY=v(y.plotY,I.top+D,I.height-D)}coolDown(y,I,D){return y-I*D}isStable(){return 1e-5>Math.abs(this.systemTemperature-this.prevSystemTemperature)||this.temperature<=0}getSystemTemperature(){let y=0;for(let I of this.nodes)y+=I.temperature;return y}vectorLength(y){return Math.sqrt(y.x*y.x+y.y*y.y)}getDistR(y,I){let D=this.getDistXY(y,I);return this.vectorLength(D)}getDistXY(y,I){let D=y.plotX-I.plotX,w=y.plotY-I.plotY;return{x:D,y:w,absX:Math.abs(D),absY:Math.abs(w)}}}return k}),c(t,"Series/PackedBubble/PackedBubbleLayout.js",[t["Series/GraphLayoutComposition.js"],t["Series/PackedBubble/PackedBubbleIntegration.js"],t["Series/Networkgraph/ReingoldFruchtermanLayout.js"],t["Core/Utilities.js"]],function(a,h,d,s){let{addEvent:f,pick:b}=s;function x(){let P=this.series,_=[];return P.forEach(S=>{S.parentNode&&S.parentNode.selected&&_.push(S.parentNode)}),_}function v(){this.allDataPoints&&delete this.allDataPoints}class g extends d{constructor(){super(...arguments),this.index=NaN,this.nodes=[],this.series=[]}static compose(_){d.compose(_),a.integrations.packedbubble=h,a.layouts.packedbubble=g;let S=_.prototype;S.getSelectedParentNodes||(f(_,"beforeRedraw",v),S.getSelectedParentNodes=x)}beforeStep(){this.options.marker&&this.series.forEach(_=>{_&&_.calculateParentRadius()})}isStable(){let _=Math.abs(this.prevSystemTemperature-this.systemTemperature);return 1>Math.abs(10*this.systemTemperature/Math.sqrt(this.nodes.length))&&_<1e-5||this.temperature<=0}setCircularPositions(){let _=this.box,S=this.nodes,k=2*Math.PI/(S.length+1),A=this.options.initialPositionRadius,y,I,D=0;for(let w of S)this.options.splitSeries&&!w.isParentNode?(y=w.series.parentNode.plotX,I=w.series.parentNode.plotY):(y=_.width/2,I=_.height/2),w.plotX=w.prevX=b(w.plotX,y+A*Math.cos(w.index||D*k)),w.plotY=w.prevY=b(w.plotY,I+A*Math.sin(w.index||D*k)),w.dispX=0,w.dispY=0,D++}repulsiveForces(){let _,S,k,A=this,y=A.options.bubblePadding,I=A.nodes;I.forEach(D=>{D.degree=D.mass,D.neighbours=0,I.forEach(w=>{_=0,D!==w&&!D.fixedPosition&&(A.options.seriesInteraction||D.series===w.series)&&(k=A.getDistXY(D,w),(S=A.vectorLength(k)-(D.marker.radius+w.marker.radius+y))<0&&(D.degree+=.01,D.neighbours++,_=A.repulsiveForce(-S/Math.sqrt(D.neighbours),A.k,D,w)),A.force("repulsive",D,_*w.mass,k,w,S))})})}applyLimitBox(_,S){let k,A;this.options.splitSeries&&!_.isParentNode&&this.options.parentNodeLimit&&(k=this.getDistXY(_,_.series.parentNode),(A=_.series.parentNodeRadius-_.marker.radius-this.vectorLength(k))<0&&A>-2*_.marker.radius&&(_.plotX-=.01*k.x,_.plotY-=.01*k.y)),super.applyLimitBox(_,S)}}return a.layouts.packedbubble=g,g}),c(t,"Series/SimulationSeriesUtilities.js",[t["Core/Utilities.js"],t["Core/Animation/AnimationUtilities.js"]],function(a,h){let{merge:d,syncTimeout:s}=a,{animObject:f}=h;return{initDataLabels:function(){let b=this.options.dataLabels;if(!this.dataLabelsGroup){let x=this.initDataLabelsGroup();return!this.chart.styledMode&&(b!=null&&b.style)&&x.css(b.style),x.attr({opacity:0}),this.visible&&x.show(),x}return this.dataLabelsGroup.attr(d({opacity:1},this.getPlotBox("data-labels"))),this.dataLabelsGroup},initDataLabelsDefer:function(){var x;let b=this.options.dataLabels;b!=null&&b.defer&&((x=this.options.layoutAlgorithm)!=null&&x.enableSimulation)?s(()=>{this.deferDataLabels=!1},b?f(b.animation).defer:0):this.deferDataLabels=!1}}}),c(t,"Extensions/TextPath.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h){let{deg2rad:d}=a,{addEvent:s,merge:f,uniqueKey:b,defined:x,extend:v}=h;function g(S,k){k=f(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},k);let A=this.renderer.url,y=this.text||this,I=y.textPath,{attributes:D,enabled:w}=k;if(S=S||I&&I.path,I&&I.undo(),S&&w){let M=s(y,"afterModifyTree",z=>{if(S&&w){let Y=S.attr("id");Y||S.attr("id",Y=b());let X={x:0,y:0};x(D.dx)&&(X.dx=D.dx,delete D.dx),x(D.dy)&&(X.dy=D.dy,delete D.dy),y.attr(X),this.attr({transform:""}),this.box&&(this.box=this.box.destroy());let Z=z.nodes.slice(0);z.nodes.length=0,z.nodes[0]={tagName:"textPath",attributes:v(D,{"text-anchor":D.textAnchor,href:`${A}#${Y}`}),children:Z}}});y.textPath={path:S,undo:M}}else y.attr({dx:0,dy:0}),delete y.textPath;return this.added&&(y.textCache="",this.renderer.buildText(y)),this}function P(S){var y;let k=S.bBox,A=(y=this.element)==null?void 0:y.querySelector("textPath");if(A){let I=[],{b:D,h:w}=this.renderer.fontMetrics(this.element),M=w-D,z=RegExp('(<tspan>|<tspan(?!\\sclass="highcharts-br")[^>]*>|<\\/tspan>)',"g"),Y=A.innerHTML.replace(z,"").split(/<tspan class="highcharts-br"[^>]*>/),X=Y.length,Z=(j,V)=>{let{x:$,y:R}=V,L=(A.getRotationOfChar(j)-90)*d,G=Math.cos(L),U=Math.sin(L);return[[$-M*G,R-M*U],[$+D*G,R+D*U]]};for(let j=0,V=0;V<X;V++){let $=Y[V].length;for(let R=0;R<$;R+=5)try{let L=j+R+V,[G,U]=Z(L,A.getStartPositionOfChar(L));R===0?(I.push(U),I.push(G)):(V===0&&I.unshift(U),V===X-1&&I.push(G))}catch{break}j+=$-1;try{let R=j+V,L=A.getEndPositionOfChar(R),[G,U]=Z(R,L);I.unshift(U),I.unshift(G)}catch{break}}I.length&&I.push(I[0].slice()),k.polygon=I}return k}function _(S){var I;let k=S.labelOptions,A=S.point,y=k[A.formatPrefix+"TextPath"]||k.textPath;y&&!k.useHTML&&(this.setTextPath(((I=A.getDataLabelPath)==null?void 0:I.call(A,this))||A.graphic,y),A.dataLabelPath&&!y.enabled&&(A.dataLabelPath=A.dataLabelPath.destroy()))}return{compose:function(S){s(S,"afterGetBBox",P),s(S,"beforeAddingDataLabel",_);let k=S.prototype;k.setTextPath||(k.setTextPath=g)}}}),c(t,"Series/PackedBubble/PackedBubbleSeries.js",[t["Core/Color/Color.js"],t["Series/DragNodesComposition.js"],t["Series/GraphLayoutComposition.js"],t["Core/Globals.js"],t["Series/PackedBubble/PackedBubblePoint.js"],t["Series/PackedBubble/PackedBubbleSeriesDefaults.js"],t["Series/PackedBubble/PackedBubbleLayout.js"],t["Core/Series/SeriesRegistry.js"],t["Series/SimulationSeriesUtilities.js"],t["Core/Utilities.js"],t["Core/Renderer/SVG/SVGElement.js"],t["Extensions/TextPath.js"]],function(a,h,d,s,f,b,x,v,g,P,_,S){let{parse:k}=a,{noop:A}=s,{series:{prototype:y},seriesTypes:{bubble:I}}=v,{initDataLabels:D,initDataLabelsDefer:w}=g,{addEvent:M,clamp:z,defined:Y,extend:X,fireEvent:Z,isArray:j,isNumber:V,merge:$,pick:R}=P;S.compose(_);class L extends I{constructor(){super(...arguments),this.parentNodeMass=0,this.deferDataLabels=!0}static compose(U,F,H){I.compose(U,F,H),h.compose(F),x.compose(F)}accumulateAllPoints(){let U,F=this.chart,H=[];for(let W of F.series)if(W.is("packedbubble")&&W.reserveSpace()){U=W.yData||[];for(let ne=0;ne<U.length;ne++)H.push([null,null,U[ne],W.index,ne,{id:ne,marker:{radius:0}}])}return H}addLayout(){let U=this.options.layoutAlgorithm=this.options.layoutAlgorithm||{},F=U.type||"packedbubble",H=this.chart.options.chart,W=this.chart.graphLayoutsStorage,ne=this.chart.graphLayoutsLookup,ue;W||(this.chart.graphLayoutsStorage=W={},this.chart.graphLayoutsLookup=ne=[]),(ue=W[F])||(U.enableSimulation=Y(H.forExport)?!H.forExport:U.enableSimulation,W[F]=ue=new d.layouts[F],ue.init(U),ne.splice(ue.index,0,ue)),this.layout=ue,this.points.forEach(ie=>{ie.mass=2,ie.degree=1,ie.collisionNmb=1}),ue.setArea(0,0,this.chart.plotWidth,this.chart.plotHeight),ue.addElementsToCollection([this],ue.series),ue.addElementsToCollection(this.points,ue.nodes)}addSeriesLayout(){let U=this.options.layoutAlgorithm=this.options.layoutAlgorithm||{},F=U.type||"packedbubble",H=this.chart.graphLayoutsStorage,W=this.chart.graphLayoutsLookup,ne=$(U,U.parentNodeOptions,{enableSimulation:this.layout.options.enableSimulation}),ue=H[F+"-series"];ue||(H[F+"-series"]=ue=new d.layouts[F],ue.init(ne),W.splice(ue.index,0,ue)),this.parentNodeLayout=ue,this.createParentNodes()}calculateParentRadius(){let U=this.seriesBox();this.parentNodeRadius=z(Math.sqrt(2*this.parentNodeMass/Math.PI)+20,20,U?Math.max(Math.sqrt(Math.pow(U.width,2)+Math.pow(U.height,2))/2+20,20):Math.sqrt(2*this.parentNodeMass/Math.PI)+20),this.parentNode&&(this.parentNode.marker.radius=this.parentNode.radius=this.parentNodeRadius)}calculateZExtremes(){let U=this.chart.series,F=this.options.zMin,H=this.options.zMax,W=1/0,ne=-1/0;return F&&H?[F,H]:(U.forEach(ue=>{ue.yData.forEach(ie=>{Y(ie)&&(ie>ne&&(ne=ie),ie<W&&(W=ie))})}),[F=R(F,W),H=R(H,ne)])}checkOverlap(U,F){let H=U[0]-F[0],W=U[1]-F[1];return Math.sqrt(H*H+W*W)-Math.abs(U[2]+F[2])<-.001}createParentNodes(){let U=this.pointClass,F=this.chart,H=this.parentNodeLayout,W=this.layout.options,ne,ue=this.parentNode,ie={radius:this.parentNodeRadius,lineColor:this.color,fillColor:k(this.color).brighten(.4).get()};W.parentNodeOptions&&(ie=$(W.parentNodeOptions.marker||{},ie)),this.parentNodeMass=0,this.points.forEach(oe=>{this.parentNodeMass+=Math.PI*Math.pow(oe.marker.radius,2)}),this.calculateParentRadius(),H.nodes.forEach(oe=>{oe.seriesIndex===this.index&&(ne=!0)}),H.setArea(0,0,F.plotWidth,F.plotHeight),ne||(ue||(ue=new U(this,{mass:this.parentNodeRadius/2,marker:ie,dataLabels:{inside:!1},states:{normal:{marker:ie},hover:{marker:ie}},dataLabelOnNull:!0,degree:this.parentNodeRadius,isParentNode:!0,seriesIndex:this.index})),this.parentNode&&(ue.plotX=this.parentNode.plotX,ue.plotY=this.parentNode.plotY),this.parentNode=ue,H.addElementsToCollection([this],H.series),H.addElementsToCollection([ue],H.nodes))}deferLayout(){let U=this.options.layoutAlgorithm;this.visible&&(this.addLayout(),U.splitSeries&&this.addSeriesLayout())}destroy(){this.chart.graphLayoutsLookup&&this.chart.graphLayoutsLookup.forEach(U=>{U.removeElementFromCollection(this,U.series)},this),this.parentNode&&this.parentNodeLayout&&(this.parentNodeLayout.removeElementFromCollection(this.parentNode,this.parentNodeLayout.nodes),this.parentNode.dataLabel&&(this.parentNode.dataLabel=this.parentNode.dataLabel.destroy())),y.destroy.apply(this,arguments)}drawDataLabels(){!this.deferDataLabels&&(y.drawDataLabels.call(this,this.points),this.parentNode&&(this.parentNode.formatPrefix="parentNode",y.drawDataLabels.call(this,[this.parentNode])))}drawGraph(){var ne;if(!this.layout||!this.layout.options.splitSeries)return;let U=this.chart,F=this.layout.options.parentNodeOptions.marker,H={fill:F.fillColor||k(this.color).brighten(.4).get(),opacity:F.fillOpacity,stroke:F.lineColor||this.color,"stroke-width":R(F.lineWidth,this.options.lineWidth)},W={};this.parentNodesGroup=this.plotGroup("parentNodesGroup","parentNode",this.visible?"inherit":"hidden",.1,U.seriesGroup),(ne=this.group)==null||ne.attr({zIndex:2}),this.calculateParentRadius(),this.parentNode&&Y(this.parentNode.plotX)&&Y(this.parentNode.plotY)&&Y(this.parentNodeRadius)&&(W=$({x:this.parentNode.plotX-this.parentNodeRadius,y:this.parentNode.plotY-this.parentNodeRadius,width:2*this.parentNodeRadius,height:2*this.parentNodeRadius},H),this.parentNode.graphic||(this.graph=this.parentNode.graphic=U.renderer.symbol(H.symbol).add(this.parentNodesGroup)),this.parentNode.graphic.attr(W))}drawTracker(){let U,F=this.parentNode;super.drawTracker(),F&&(U=j(F.dataLabels)?F.dataLabels:F.dataLabel?[F.dataLabel]:[],F.graphic&&(F.graphic.element.point=F),U.forEach(H=>{(H.div||H.element).point=F}))}getPointRadius(){let U,F,H,W,ne=this.chart,ue=ne.plotWidth,ie=ne.plotHeight,oe=this.options,Te=oe.useSimulation,ge=Math.min(ue,ie),we={},K=[],Q=ne.allDataPoints||[],ae=Q.length;["minSize","maxSize"].forEach(J=>{let re=parseInt(oe[J],10),ce=/%$/.test(oe[J]);we[J]=ce?ge*re/100:re*Math.sqrt(ae)}),ne.minRadius=U=we.minSize/Math.sqrt(ae),ne.maxRadius=F=we.maxSize/Math.sqrt(ae);let ye=Te?this.calculateZExtremes():[U,F];Q.forEach((J,re)=>{H=Te?z(J[2],ye[0],ye[1]):J[2],(W=this.getRadius(ye[0],ye[1],U,F,H))===0&&(W=null),Q[re][2]=W,K.push(W)}),this.radii=K}init(){return y.init.apply(this,arguments),w.call(this),this.eventsToUnbind.push(M(this,"updatedData",function(){this.chart.series.forEach(U=>{U.type===this.type&&(U.isDirty=!0)},this)})),this}onMouseUp(U){if(U.fixedPosition&&!U.removed){let F,H=this.layout,W=this.parentNodeLayout;W&&H.options.dragBetweenSeries&&W.nodes.forEach(ne=>{U&&U.marker&&ne!==U.series.parentNode&&(F=H.getDistXY(U,ne),H.vectorLength(F)-ne.marker.radius-U.marker.radius<0&&(ne.series.addPoint($(U.options,{plotX:U.plotX,plotY:U.plotY}),!1),H.removeElementFromCollection(U,H.nodes),U.remove()))}),h.onMouseUp.apply(this,arguments)}}placeBubbles(U){let F=this.checkOverlap,H=this.positionBubble,W=[],ne=1,ue=0,ie=0,oe,Te=[],ge,we=U.sort((K,Q)=>Q[2]-K[2]);if(we.length){if(W.push([[0,0,we[0][2],we[0][3],we[0][4]]]),we.length>1)for(W.push([[0,0-we[1][2]-we[0][2],we[1][2],we[1][3],we[1][4]]]),ge=2;ge<we.length;ge++)we[ge][2]=we[ge][2]||1,F(oe=H(W[ne][ue],W[ne-1][ie],we[ge]),W[ne][0])?(W.push([]),ie=0,W[ne+1].push(H(W[ne][ue],W[ne][0],we[ge])),ne++,ue=0):ne>1&&W[ne-1][ie+1]&&F(oe,W[ne-1][ie+1])?(ie++,W[ne].push(H(W[ne][ue],W[ne-1][ie],we[ge])),ue++):(ue++,W[ne].push(oe));this.chart.stages=W,this.chart.rawPositions=[].concat.apply([],W),this.resizeRadius(),Te=this.chart.rawPositions}return Te}pointAttribs(U,F){let H=this.options,W=U&&U.isParentNode,ne=H.marker;W&&H.layoutAlgorithm&&H.layoutAlgorithm.parentNodeOptions&&(ne=H.layoutAlgorithm.parentNodeOptions.marker);let ue=ne.fillOpacity,ie=y.pointAttribs.call(this,U,F);return ue!==1&&(ie["fill-opacity"]=ue),ie}positionBubble(U,F,H){let W=Math.asin,ne=Math.acos,ue=Math.pow,ie=Math.abs,oe=(0,Math.sqrt)(ue(U[0]-F[0],2)+ue(U[1]-F[1],2)),Te=ne((ue(oe,2)+ue(H[2]+F[2],2)-ue(H[2]+U[2],2))/(2*(H[2]+F[2])*oe)),ge=W(ie(U[0]-F[0])/oe),we=(U[1]-F[1]<0?0:Math.PI)+Te+ge*((U[0]-F[0])*(U[1]-F[1])<0?1:-1),K=Math.cos(we),Q=Math.sin(we);return[F[0]+(F[2]+H[2])*Q,F[1]-(F[2]+H[2])*K,H[2],H[3],H[4]]}render(){let U=[];y.render.apply(this,arguments),!this.options.dataLabels.allowOverlap&&(this.data.forEach(F=>{j(F.dataLabels)&&F.dataLabels.forEach(H=>{U.push(H)})}),this.options.useSimulation&&this.chart.hideOverlappingLabels(U))}resizeRadius(){let U,F,H,W,ne,ue=this.chart,ie=ue.rawPositions,oe=Math.min,Te=Math.max,ge=ue.plotLeft,we=ue.plotTop,K=ue.plotHeight,Q=ue.plotWidth;for(let re of(U=H=Number.POSITIVE_INFINITY,F=W=Number.NEGATIVE_INFINITY,ie))ne=re[2],U=oe(U,re[0]-ne),F=Te(F,re[0]+ne),H=oe(H,re[1]-ne),W=Te(W,re[1]+ne);let ae=[F-U,W-H],ye=[(Q-ge)/ae[0],(K-we)/ae[1]],J=oe.apply([],ye);if(Math.abs(J-1)>1e-10){for(let re of ie)re[2]*=J;this.placeBubbles(ie)}else ue.diffY=K/2+we-H-(W-H)/2,ue.diffX=Q/2+ge-U-(F-U)/2}seriesBox(){let U,F=this.chart,H=this.data,W=Math.max,ne=Math.min,ue=[F.plotLeft,F.plotLeft+F.plotWidth,F.plotTop,F.plotTop+F.plotHeight];return H.forEach(ie=>{Y(ie.plotX)&&Y(ie.plotY)&&ie.marker.radius&&(U=ie.marker.radius,ue[0]=ne(ue[0],ie.plotX-U),ue[1]=W(ue[1],ie.plotX+U),ue[2]=ne(ue[2],ie.plotY-U),ue[3]=W(ue[3],ie.plotY+U))}),V(ue.width/ue.height)?ue:null}setVisible(){let U=this;y.setVisible.apply(U,arguments),U.parentNodeLayout&&U.graph?U.visible?(U.graph.show(),U.parentNode.dataLabel&&U.parentNode.dataLabel.show()):(U.graph.hide(),U.parentNodeLayout.removeElementFromCollection(U.parentNode,U.parentNodeLayout.nodes),U.parentNode.dataLabel&&U.parentNode.dataLabel.hide()):U.layout&&(U.visible?U.layout.addElementsToCollection(U.points,U.layout.nodes):U.points.forEach(F=>{U.layout.removeElementFromCollection(F,U.layout.nodes)}))}translate(){let U,F,H,W=this.chart,ne=this.data,ue=this.index,ie=this.options.useSimulation;for(let oe of(this.processedXData=this.xData,this.generatePoints(),Y(W.allDataPoints)||(W.allDataPoints=this.accumulateAllPoints(),this.getPointRadius()),ie?H=W.allDataPoints:(H=this.placeBubbles(W.allDataPoints),this.options.draggable=!1),H))oe[3]===ue&&(U=ne[oe[4]],F=R(oe[2],void 0),ie||(U.plotX=oe[0]-W.plotLeft+W.diffX,U.plotY=oe[1]-W.plotTop+W.diffY),V(F)&&(U.marker=X(U.marker,{radius:F,width:2*F,height:2*F}),U.radius=F));ie&&this.deferLayout(),Z(this,"afterTranslate")}}return L.defaultOptions=$(I.defaultOptions,b),X(L.prototype,{pointClass:f,axisTypes:[],directTouch:!0,forces:["barycenter","repulsive"],hasDraggableNodes:!0,invertible:!1,isCartesian:!1,noSharedTooltip:!0,pointArrayMap:["value"],pointValKey:"value",requireSorting:!1,trackerGroups:["group","dataLabelsGroup","parentNodesGroup"],initDataLabels:D,alignDataLabel:y.alignDataLabel,indexateNodes:A,onMouseDown:h.onMouseDown,onMouseMove:h.onMouseMove,redrawHalo:h.redrawHalo,searchPoint:A}),v.registerSeriesType("packedbubble",L),L}),c(t,"Series/Polygon/PolygonSeriesDefaults.js",[],function(){return{marker:{enabled:!1,states:{hover:{enabled:!1}}},stickyTracking:!1,tooltip:{followPointer:!0,pointFormat:""},trackByArea:!0,legendSymbol:"rectangle"}}),c(t,"Series/Polygon/PolygonSeries.js",[t["Core/Globals.js"],t["Series/Polygon/PolygonSeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(a,h,d,s){let{noop:f}=a,{area:b,line:x,scatter:v}=d.seriesTypes,{extend:g,merge:P}=s;class _ extends v{getGraphPath(){let k=x.prototype.getGraphPath.call(this),A=k.length+1;for(;A--;)(A===k.length||k[A][0]==="M")&&A>0&&k.splice(A,0,["Z"]);return this.areaPath=k,k}drawGraph(){this.options.fillColor=this.color,b.prototype.drawGraph.call(this)}}return _.defaultOptions=P(v.defaultOptions,h),g(_.prototype,{type:"polygon",drawTracker:x.prototype.drawTracker,setStackedPoints:f}),d.registerSeriesType("polygon",_),_}),c(t,"Core/Axis/RadialAxisDefaults.js",[],function(){return{circular:{gridLineWidth:1,labels:{align:void 0,x:0,y:void 0,style:{textOverflow:"none"}},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},radial:{gridLineInterpolation:"circle",gridLineWidth:1,labels:{align:"right",padding:5,x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},radialGauge:{endOnTick:!1,gridLineWidth:0,labels:{align:"center",distance:-25,x:0,y:void 0},lineWidth:1,minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",minorTickWidth:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickPosition:"inside",tickWidth:2,title:{rotation:0,text:""},zIndex:2}}}),c(t,"Core/Axis/RadialAxis.js",[t["Core/Axis/RadialAxisDefaults.js"],t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h,d,s){var f;let{defaultOptions:b}=h,{composed:x,noop:v}=d,{addEvent:g,correctFloat:P,defined:_,extend:S,fireEvent:k,isObject:A,merge:y,pick:I,pushUnique:D,relativeLength:w,wrap:M}=s;return function(z){function Y(){this.autoConnect=this.isCircular&&I(this.userMax,this.options.max)===void 0&&P(this.endAngleRad-this.startAngleRad)===P(2*Math.PI),!this.isCircular&&this.chart.inverted&&this.max++,this.autoConnect&&(this.max+=this.categories&&1||this.pointRange||this.closestPointRange||0)}function X(){return()=>{if(this.isRadial&&this.tickPositions&&this.options.labels&&this.options.labels.allowOverlap!==!0)return this.tickPositions.map(re=>this.ticks[re]&&this.ticks[re].label).filter(re=>!!re)}}function Z(){return v}function j(re,ce,pe){let xe=this.pane.center,Me=re.value,_e,Ce,Le;return this.isCircular?(_(Me)?re.point&&(re.point.shapeArgs||{}).start&&(Me=this.chart.inverted?this.translate(re.point.rectPlotY,!0):re.point.x):(Ce=re.chartX||0,Le=re.chartY||0,Me=this.translate(Math.atan2(Le-pe,Ce-ce)-this.startAngleRad,!0)),Ce=(_e=this.getPosition(Me)).x,Le=_e.y):(_(Me)||(Ce=re.chartX,Le=re.chartY),_(Ce)&&_(Le)&&(pe=xe[1]+this.chart.plotTop,Me=this.translate(Math.min(Math.sqrt(Math.pow(Ce-ce,2)+Math.pow(Le-pe,2)),xe[2]/2)-xe[3]/2,!0))),[Me,Ce||0,Le||0]}function V(re,ce,pe){let xe=this.pane.center,Me=this.chart,_e=this.left||0,Ce=this.top||0,Le,Ue=I(ce,xe[2]/2-this.offset),Xe;return pe===void 0&&(pe=this.horiz?0:this.center&&-this.center[3]/2),pe&&(Ue+=pe),this.isCircular||ce!==void 0?((Xe=this.chart.renderer.symbols.arc(_e+xe[0],Ce+xe[1],Ue,Ue,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0})).xBounds=[_e+xe[0]],Xe.yBounds=[Ce+xe[1]-Ue]):(Le=this.postTranslate(this.angleRad,Ue),Xe=[["M",this.center[0]+Me.plotLeft,this.center[1]+Me.plotTop],["L",Le.x,Le.y]]),Xe}function $(){this.constructor.prototype.getOffset.call(this),this.chart.axisOffset[this.side]=0}function R(re,ce,pe){let xe=this.chart,Me=Rt=>{if(typeof Rt=="string"){let pt=parseInt(Rt,10);return Ee.test(Rt)&&(pt=pt*Le/100),pt}return Rt},_e=this.center,Ce=this.startAngleRad,Le=_e[2]/2,Ue=Math.min(this.offset,0),Xe=this.left||0,Pe=this.top||0,Ee=/%$/,Ie=this.isCircular,Oe,Re,Fe,Ke,rt,at,ut=I(Me(pe.outerRadius),Le),mt=Me(pe.innerRadius),Tt=I(Me(pe.thickness),10);if(this.options.gridLineInterpolation==="polygon")at=this.getPlotLinePath({value:re}).concat(this.getPlotLinePath({value:ce,reverse:!0}));else{re=Math.max(re,this.min),ce=Math.min(ce,this.max);let Rt=this.translate(re),pt=this.translate(ce);Ie||(ut=Rt||0,mt=pt||0),pe.shape!=="circle"&&Ie?(Oe=Ce+(Rt||0),Re=Ce+(pt||0)):(Oe=-Math.PI/2,Re=1.5*Math.PI,rt=!0),ut-=Ue,Tt-=Ue,at=xe.renderer.symbols.arc(Xe+_e[0],Pe+_e[1],ut,ut,{start:Math.min(Oe,Re),end:Math.max(Oe,Re),innerR:I(mt,ut-Tt),open:rt,borderRadius:pe.borderRadius}),Ie&&(Fe=(Re+Oe)/2,Ke=Xe+_e[0]+_e[2]/2*Math.cos(Fe),at.xBounds=Fe>-Math.PI/2&&Fe<Math.PI/2?[Ke,xe.plotWidth]:[0,Ke],at.yBounds=[Pe+_e[1]+_e[2]/2*Math.sin(Fe)],at.yBounds[0]+=Fe>-Math.PI&&Fe<0||Fe>Math.PI?-10:10)}return at}function L(re){let ce=this.pane.center,pe=this.chart,xe=pe.inverted,Me=re.reverse,_e=this.pane.options.background?this.pane.options.background[0]||this.pane.options.background:{},Ce=_e.innerRadius||"0%",Le=_e.outerRadius||"100%",Ue=ce[0]+pe.plotLeft,Xe=ce[1]+pe.plotTop,Pe=this.height,Ee=re.isCrosshair,Ie=ce[3]/2,Oe=re.value,Re,Fe,Ke,rt,at,ut,mt,Tt,Rt,pt=this.getPosition(Oe),Ct=pt.x,Et=pt.y;if(Ee&&(Oe=(Tt=this.getCrosshairPosition(re,Ue,Xe))[0],Ct=Tt[1],Et=Tt[2]),this.isCircular)Fe=Math.sqrt(Math.pow(Ct-Ue,2)+Math.pow(Et-Xe,2)),Ke=typeof Ce=="string"?w(Ce,1):Ce/Fe,rt=typeof Le=="string"?w(Le,1):Le/Fe,ce&&Ie&&(Ke<(Re=Ie/Fe)&&(Ke=Re),rt<Re&&(rt=Re)),Rt=[["M",Ue+Ke*(Ct-Ue),Xe-Ke*(Xe-Et)],["L",Ct-(1-rt)*(Ct-Ue),Et+(1-rt)*(Xe-Et)]];else if((Oe=this.translate(Oe))&&(Oe<0||Oe>Pe)&&(Oe=0),this.options.gridLineInterpolation==="circle")Rt=this.getLinePath(0,Oe,Ie);else if(Rt=[],pe[xe?"yAxis":"xAxis"].forEach(ri=>{ri.pane===this.pane&&(at=ri)}),at){mt=at.tickPositions,at.autoConnect&&(mt=mt.concat([mt[0]])),Me&&(mt=mt.slice().reverse()),Oe&&(Oe+=Ie);for(let ri=0;ri<mt.length;ri++)ut=at.getPosition(mt[ri],Oe),Rt.push(ri?["L",ut.x,ut.y]:["M",ut.x,ut.y])}return Rt}function G(re,ce){let pe=this.translate(re);return this.postTranslate(this.isCircular?pe:this.angleRad,I(this.isCircular?ce:pe<0?0:pe,this.center[2]/2)-this.offset)}function U(){let re=this.center,ce=this.chart,pe=this.options.title;return{x:ce.plotLeft+re[0]+(pe.x||0),y:ce.plotTop+re[1]-{high:.5,middle:.25,low:0}[pe.align]*re[2]+(pe.y||0)}}function F(re){re.beforeSetTickPositions=Y,re.createLabelCollector=X,re.getCrosshairPosition=j,re.getLinePath=V,re.getOffset=$,re.getPlotBandPath=R,re.getPlotLinePath=L,re.getPosition=G,re.getTitlePosition=U,re.postTranslate=we,re.setAxisSize=Q,re.setAxisTranslation=ae,re.setOptions=ye}function H(){let re=this.chart,ce=this.options,pe=re.angular&&this.isXAxis,xe=this.pane,Me=xe&&xe.options;if(!pe&&xe&&(re.angular||re.polar)){let _e=2*Math.PI,Ce=(I(Me.startAngle,0)-90)*Math.PI/180,Le=(I(Me.endAngle,I(Me.startAngle,0)+360)-90)*Math.PI/180;this.angleRad=(ce.angle||0)*Math.PI/180,this.startAngleRad=Ce,this.endAngleRad=Le,this.offset=ce.offset||0;let Ue=(Ce%_e+_e)%_e,Xe=(Le%_e+_e)%_e;Ue>Math.PI&&(Ue-=_e),Xe>Math.PI&&(Xe-=_e),this.normalizedStartAngleRad=Ue,this.normalizedEndAngleRad=Xe}}function W(re){this.isRadial&&(re.align=void 0,re.preventDefault())}function ne(){if(this.chart&&this.chart.labelCollectors){let re=this.labelCollector?this.chart.labelCollectors.indexOf(this.labelCollector):-1;re>=0&&this.chart.labelCollectors.splice(re,1)}}function ue(re){let ce,pe=this.chart,xe=pe.angular,Me=pe.polar,_e=this.isXAxis,Ce=this.coll,Le=re.userOptions.pane||0,Ue=this.pane=pe.pane&&pe.pane[Le];if(Ce==="colorAxis"){this.isRadial=!1;return}xe?(xe&&_e?(this.isHidden=!0,this.createLabelCollector=Z,this.getOffset=v,this.redraw=K,this.render=K,this.setScale=v,this.setCategories=v,this.setTitle=v):F(this),ce=!_e):Me&&(F(this),ce=this.horiz),xe||Me?(this.isRadial=!0,this.labelCollector||(this.labelCollector=this.createLabelCollector()),this.labelCollector&&pe.labelCollectors.push(this.labelCollector)):this.isRadial=!1,Ue&&ce&&(Ue.axis=this),this.isCircular=ce}function ie(){this.isRadial&&this.beforeSetTickPositions()}function oe(re){let ce=this.label;if(!ce)return;let pe=this.axis,xe=ce.getBBox(),Me=pe.options.labels,_e=(pe.translate(this.pos)+pe.startAngleRad+Math.PI/2)/Math.PI*180%360,Ce=Math.round(_e),Le=_(Me.y)?0:-(.3*xe.height),Ue=Me.y,Xe,Pe=20,Ee=Me.align,Ie="end",Oe=Ce<0?Ce+360:Ce,Re=Oe,Fe=0,Ke=0;pe.isRadial&&(Xe=pe.getPosition(this.pos,pe.center[2]/2+w(I(Me.distance,-25),pe.center[2]/2,-pe.center[2]/2)),Me.rotation==="auto"?ce.attr({rotation:_e}):_(Ue)||(Ue=pe.chart.renderer.fontMetrics(ce).b-xe.height/2),_(Ee)||(pe.isCircular?(xe.width>pe.len*pe.tickInterval/(pe.max-pe.min)&&(Pe=0),Ee=_e>Pe&&_e<180-Pe?"left":_e>180+Pe&&_e<360-Pe?"right":"center"):Ee="center",ce.attr({align:Ee})),Ee==="auto"&&pe.tickPositions.length===2&&pe.isCircular&&(Oe>90&&Oe<180?Oe=180-Oe:Oe>270&&Oe<=360&&(Oe=540-Oe),Re>180&&Re<=360&&(Re=360-Re),(pe.pane.options.startAngle===Ce||pe.pane.options.startAngle===Ce+360||pe.pane.options.startAngle===Ce-360)&&(Ie="start"),Ee=Ce>=-90&&Ce<=90||Ce>=-360&&Ce<=-270||Ce>=270&&Ce<=360?Ie==="start"?"right":"left":Ie==="start"?"left":"right",Re>70&&Re<110&&(Ee="center"),Oe<15||Oe>=180&&Oe<195?Fe=.3*xe.height:Oe>=15&&Oe<=35?Fe=Ie==="start"?0:.75*xe.height:Oe>=195&&Oe<=215?Fe=Ie==="start"?.75*xe.height:0:Oe>35&&Oe<=90?Fe=Ie==="start"?-(.25*xe.height):xe.height:Oe>215&&Oe<=270&&(Fe=Ie==="start"?xe.height:-(.25*xe.height)),Re<15?Ke=Ie==="start"?-(.15*xe.height):.15*xe.height:Re>165&&Re<=180&&(Ke=Ie==="start"?.15*xe.height:-(.15*xe.height)),ce.attr({align:Ee}),ce.translate(Ke,Fe+Le)),re.pos.x=Xe.x+(Me.x||0),re.pos.y=Xe.y+(Ue||0))}function Te(re){this.axis.getPosition&&S(re.pos,this.axis.getPosition(this.pos))}function ge({options:re}){re.xAxis&&y(!0,z.radialDefaultOptions.circular,re.xAxis),re.yAxis&&y(!0,z.radialDefaultOptions.radialGauge,re.yAxis)}function we(re,ce){let pe=this.chart,xe=this.center;return re=this.startAngleRad+re,{x:pe.plotLeft+xe[0]+Math.cos(re)*ce,y:pe.plotTop+xe[1]+Math.sin(re)*ce}}function K(){this.isDirty=!1}function Q(){let re,ce;this.constructor.prototype.setAxisSize.call(this),this.isRadial&&(this.pane.updateCenter(this),re=this.center=this.pane.center.slice(),this.isCircular?this.sector=this.endAngleRad-this.startAngleRad:(ce=this.postTranslate(this.angleRad,re[3]/2),re[0]=ce.x-this.chart.plotLeft,re[1]=ce.y-this.chart.plotTop),this.len=this.width=this.height=(re[2]-re[3])*I(this.sector,1)/2)}function ae(){this.constructor.prototype.setAxisTranslation.call(this),this.center&&(this.isCircular?this.transA=(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.transA=(this.center[2]-this.center[3])/2/(this.max-this.min||1),this.isXAxis?this.minPixelPadding=this.transA*this.minPointOffset:this.minPixelPadding=0)}function ye(re){let{coll:ce}=this,{angular:pe,inverted:xe,polar:Me}=this.chart,_e={};pe?this.isXAxis||(_e=y(b.yAxis,z.radialDefaultOptions.radialGauge)):Me&&(_e=this.horiz?y(b.xAxis,z.radialDefaultOptions.circular):y(ce==="xAxis"?b.xAxis:b.yAxis,z.radialDefaultOptions.radial)),xe&&ce==="yAxis"&&(_e.stackLabels=A(b.yAxis,!0)?b.yAxis.stackLabels:{},_e.reversedStacks=!0);let Ce=this.options=y(_e,re);Ce.plotBands||(Ce.plotBands=[]),k(this,"afterSetOptions")}function J(re,ce,pe,xe,Me,_e,Ce){let Le,Ue=this.axis;return Ue.isRadial?["M",ce,pe,"L",(Le=Ue.getPosition(this.pos,Ue.center[2]/2+xe)).x,Le.y]:re.call(this,ce,pe,xe,Me,_e,Ce)}z.radialDefaultOptions=y(a),z.compose=function(re,ce){return D(x,"Axis.Radial")&&(g(re,"afterInit",H),g(re,"autoLabelAlign",W),g(re,"destroy",ne),g(re,"init",ue),g(re,"initialAxisTranslation",ie),g(ce,"afterGetLabelPosition",oe),g(ce,"afterGetPosition",Te),g(d,"setOptions",ge),M(ce.prototype,"getMarkPath",J)),re}}(f||(f={})),f}),c(t,"Series/PolarComposition.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Globals.js"],t["Core/Series/Series.js"],t["Extensions/Pane/Pane.js"],t["Core/Axis/RadialAxis.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b){let{animObject:x}=a,{composed:v}=h,{addEvent:g,defined:P,find:_,isNumber:S,merge:k,pick:A,pushUnique:y,relativeLength:I,splat:D,uniqueKey:w,wrap:M}=b;function z(){(this.pane||[]).forEach(ge=>{ge.render()})}function Y(ge){let we=ge.args[0].xAxis,K=ge.args[0].yAxis,Q=ge.args[0].chart;we&&K&&(K.gridLineInterpolation==="polygon"?(we.startOnTick=!0,we.endOnTick=!0):we.gridLineInterpolation==="polygon"&&Q.inverted&&(K.startOnTick=!0,K.endOnTick=!0))}function X(){this.pane||(this.pane=[]),this.options.pane=D(this.options.pane),this.options.pane.forEach(ge=>{new s(ge,this)},this)}function Z(ge){let we=ge.args.marker,K=this.chart.xAxis[0],Q=this.chart.yAxis[0],ae=this.chart.inverted,ye=ae?Q:K,J=ae?K:Q;if(this.chart.polar){ge.preventDefault();let re=(we.attr?we.attr("start"):we.start)-ye.startAngleRad,ce=we.attr?we.attr("r"):we.r,pe=(we.attr?we.attr("end"):we.end)-ye.startAngleRad,xe=we.attr?we.attr("innerR"):we.innerR;ge.result.x=re+ye.pos,ge.result.width=pe-re,ge.result.y=J.len+J.pos-ce,ge.result.height=ce-xe}}function j(ge){let we=this.chart;if(we.polar&&we.hoverPane&&we.hoverPane.axis){ge.preventDefault();let K=we.hoverPane.center,Q=we.mouseDownX||0,ae=we.mouseDownY||0,ye=ge.args.chartY,J=ge.args.chartX,re=2*Math.PI,ce=we.hoverPane.axis.startAngleRad,pe=we.hoverPane.axis.endAngleRad,xe=we.inverted?we.xAxis[0]:we.yAxis[0],Me={},_e="arc";if(Me.x=K[0]+we.plotLeft,Me.y=K[1]+we.plotTop,this.zoomHor){let Ce=ce>0?pe-ce:Math.abs(ce)+Math.abs(pe),Le=Math.atan2(ae-we.plotTop-K[1],Q-we.plotLeft-K[0])-ce,Ue=Math.atan2(ye-we.plotTop-K[1],J-we.plotLeft-K[0])-ce;Me.r=K[2]/2,Me.innerR=K[3]/2,Le<=0&&(Le+=re),Ue<=0&&(Ue+=re),Ue<Le&&(Ue=[Le,Le=Ue][0]),Ce<re&&ce+Ue>pe+(re-Ce)/2&&(Ue=Le,Le=ce<=0?ce:0);let Xe=Me.start=Math.max(Le+ce,ce),Pe=Me.end=Math.min(Ue+ce,pe);if(xe.options.gridLineInterpolation==="polygon"){let Ee=we.hoverPane.axis,Ie=Xe-Ee.startAngleRad+Ee.pos,Oe=xe.getPlotLinePath({value:xe.max}),Re=Ee.toValue(Ie),Fe=Ee.toValue(Ie+(Pe-Xe));if(Re<Ee.getExtremes().min){let{min:Ke,max:rt}=Ee.getExtremes();Re=rt-(Ke-Re)}if(Fe<Ee.getExtremes().min){let{min:Ke,max:rt}=Ee.getExtremes();Fe=rt-(Ke-Fe)}Fe<Re&&(Fe=[Re,Re=Fe][0]),(Oe=L(Oe,Re,Fe,Ee)).push(["L",K[0]+we.plotLeft,we.plotTop+K[1]]),Me.d=Oe,_e="path"}}if(this.zoomVert){let Ce=we.inverted?we.xAxis[0]:we.yAxis[0],Le=Math.sqrt(Math.pow(Q-we.plotLeft-K[0],2)+Math.pow(ae-we.plotTop-K[1],2)),Ue=Math.sqrt(Math.pow(J-we.plotLeft-K[0],2)+Math.pow(ye-we.plotTop-K[1],2));if(Ue<Le&&(Le=[Ue,Ue=Le][0]),Ue>K[2]/2&&(Ue=K[2]/2),Le<K[3]/2&&(Le=K[3]/2),this.zoomHor||(Me.start=ce,Me.end=pe),Me.r=Ue,Me.innerR=Le,Ce.options.gridLineInterpolation==="polygon"){let Xe=Ce.toValue(Ce.len+Ce.pos-Le),Pe=Ce.toValue(Ce.len+Ce.pos-Ue),Ee=Ce.getPlotLinePath({value:Pe}).concat(Ce.getPlotLinePath({value:Xe,reverse:!0}));Me.d=Ee,_e="path"}}if(this.zoomHor&&this.zoomVert&&xe.options.gridLineInterpolation==="polygon"){let Ce=we.hoverPane.axis,Le=Me.start||0,Ue=Me.end||0,Xe=Le-Ce.startAngleRad+Ce.pos,Pe=Ce.toValue(Xe),Ee=Ce.toValue(Xe+(Ue-Le));if(Me.d instanceof Array){let Ie=Me.d.slice(0,Me.d.length/2),Oe=Me.d.slice(Me.d.length/2,Me.d.length);Oe=[...Oe].reverse();let Re=we.hoverPane.axis;Ie=L(Ie,Pe,Ee,Re),(Oe=L(Oe,Pe,Ee,Re))&&(Oe[0][0]="L"),Oe=[...Oe].reverse(),Me.d=Ie.concat(Oe),_e="path"}}ge.attrs=Me,ge.shapeType=_e}}function V(){let ge=this.chart;ge.polar&&(this.polar=new Te(this),ge.inverted&&(this.isRadialSeries=!0,this.is("column")&&(this.isRadialBar=!0)))}function $(){if(this.chart.polar&&this.xAxis){let{xAxis:ge,yAxis:we}=this,K=this.chart;this.kdByAngle=K.tooltip&&K.tooltip.shared,this.kdByAngle||K.inverted?this.searchPoint=R:this.options.findNearestPointBy="xy";let Q=this.points,ae=Q.length;for(;ae--;)this.is("column")||this.is("columnrange")||this.polar.toXY(Q[ae]),K.hasParallelCoordinates||this.yAxis.reversed||(A(Q[ae].y,Number.MIN_VALUE)<we.min||Q[ae].x<ge.min||Q[ae].x>ge.max?(Q[ae].isNull=!0,Q[ae].plotY=NaN):Q[ae].isNull=Q[ae].isValid&&!Q[ae].isValid());this.hasClipCircleSetter||(this.hasClipCircleSetter=!!this.eventsToUnbind.push(g(this,"afterRender",function(){let ye;K.polar&&this.options.clip!==!1&&(ye=this.yAxis.pane.center,this.clipCircle?this.clipCircle.animate({x:ye[0],y:ye[1],r:ye[2]/2,innerR:ye[3]/2}):this.clipCircle=function(J,re,ce,pe,xe){let Me=w(),_e=J.createElement("clipPath").attr({id:Me}).add(J.defs),Ce=xe?J.arc(re,ce,pe,xe,0,2*Math.PI).add(_e):J.circle(re,ce,pe).add(_e);return Ce.id=Me,Ce.clipPath=_e,Ce}(K.renderer,ye[0],ye[1],ye[2]/2,ye[3]/2),this.group.clip(this.clipCircle),this.setClip=h.noop)})))}}function R(ge){let we=this.chart,K=this.xAxis,Q=this.yAxis,ae=K.pane&&K.pane.center,ye=ge.chartX-(ae&&ae[0]||0)-we.plotLeft,J=ge.chartY-(ae&&ae[1]||0)-we.plotTop,re=we.inverted?{clientX:ge.chartX-Q.pos,plotY:ge.chartY-K.pos}:{clientX:180+-180/Math.PI*Math.atan2(ye,J)};return this.searchKDTree(re)}function L(ge,we,K,Q){let ae=Q.tickInterval,ye=Q.tickPositions,J=_(ye,ce=>ce>=K),re=_([...ye].reverse(),ce=>ce<=we);return P(J)||(J=ye[ye.length-1]),P(re)||(re=ye[0],J+=ae,ge[0][0]="L",ge.unshift(ge[ge.length-3])),(ge=ge.slice(ye.indexOf(re),ye.indexOf(J)+1))[0][0]="M",ge}function G(ge,we){return _(this.pane||[],K=>K.options.id===we)||ge.call(this,we)}function U(ge,we,K,Q,ae,ye){let J,re,ce,pe=this.chart,xe=A(Q.inside,!!this.options.stacking);if(pe.polar){if(J=we.rectPlotX/Math.PI*180,pe.inverted)this.forceDL=pe.isInsidePlot(we.plotX,we.plotY),xe&&we.shapeArgs?(re=we.shapeArgs,ae=k(ae,{x:(ce=this.yAxis.postTranslate(((re.start||0)+(re.end||0))/2-this.xAxis.startAngleRad,we.barX+we.pointWidth/2)).x-pe.plotLeft,y:ce.y-pe.plotTop})):we.tooltipPos&&(ae=k(ae,{x:we.tooltipPos[0],y:we.tooltipPos[1]})),Q.align=A(Q.align,"center"),Q.verticalAlign=A(Q.verticalAlign,"middle");else{var Me;let _e,Ce;(Me=Q).align===null&&(_e=J>20&&J<160?"left":J>200&&J<340?"right":"center",Me.align=_e),Me.verticalAlign===null&&(Ce=J<45||J>315?"bottom":J>135&&J<225?"top":"middle",Me.verticalAlign=Ce),Q=Me}d.prototype.alignDataLabel.call(this,we,K,Q,ae,ye),this.isRadialBar&&we.shapeArgs&&we.shapeArgs.start===we.shapeArgs.end?K.hide():K.show()}else ge.call(this,we,K,Q,ae,ye)}function F(){let ge=this.options,we=ge.stacking,K=this.chart,Q=this.xAxis,ae=this.yAxis,ye=ae.reversed,J=ae.center,re=Q.startAngleRad,ce=Q.endAngleRad-re,pe=ge.threshold,xe=0,Me,_e,Ce,Le,Ue,Xe=0,Pe=0,Ee,Ie,Oe,Re,Fe,Ke,rt,at;if(Q.isRadial)for(Ce=(Me=this.points).length,Le=ae.translate(ae.min),Ue=ae.translate(ae.max),pe=ge.threshold||0,K.inverted&&S(pe)&&P(xe=ae.translate(pe))&&(xe<0?xe=0:xe>ce&&(xe=ce),this.translatedThreshold=xe+re);Ce--;){if(Ke=(_e=Me[Ce]).barX,Ie=_e.x,Oe=_e.y,_e.shapeType="arc",K.inverted){_e.plotY=ae.translate(Oe),we&&ae.stacking?(Fe=ae.stacking.stacks[(Oe<0?"-":"")+this.stackKey],this.visible&&Fe&&Fe[Ie]&&!_e.isNull&&(Re=Fe[Ie].points[this.getStackIndicator(void 0,Ie,this.index).key],Xe=ae.translate(Re[0]),Pe=ae.translate(Re[1]),P(Xe)&&(Xe=b.clamp(Xe,0,ce)))):(Xe=xe,Pe=_e.plotY),Xe>Pe&&(Pe=[Xe,Xe=Pe][0]),ye?Pe>Le?Pe=Le:Xe<Ue?Xe=Ue:(Xe>Le||Pe<Ue)&&(Xe=Pe=ce):Xe<Le?Xe=Le:Pe>Ue?Pe=Ue:(Pe<Le||Xe>Ue)&&(Xe=Pe=0),ae.min>ae.max&&(Xe=Pe=ye?ce:0),Xe+=re,Pe+=re,J&&(_e.barX=Ke+=J[3]/2),rt=Math.max(Ke,0),at=Math.max(Ke+_e.pointWidth,0);let ut=ge.borderRadius,mt=I((typeof ut=="object"?ut.radius:ut)||0,at-rt);_e.shapeArgs={x:J[0],y:J[1],r:at,innerR:rt,start:Xe,end:Pe,borderRadius:mt},_e.opacity=Xe===Pe?0:void 0,_e.plotY=(P(this.translatedThreshold)&&(Xe<this.translatedThreshold?Xe:Pe))-re}else Xe=Ke+re,_e.shapeArgs=this.polar.arc(_e.yBottom,_e.plotY,Xe,Xe+_e.pointWidth),_e.shapeArgs.borderRadius=0;this.polar.toXY(_e),K.inverted?(Ee=ae.postTranslate(_e.rectPlotY,Ke+_e.pointWidth/2),_e.tooltipPos=[Ee.x-K.plotLeft,Ee.y-K.plotTop]):_e.tooltipPos=[_e.plotX,_e.plotY],J&&(_e.ttBelow=_e.plotY>J[1])}}function H(ge,we){let K,Q,ae=this;if(this.chart.polar){we=we||this.points;for(let J=0;J<we.length;J++)if(!we[J].isNull){K=J;break}this.options.connectEnds!==!1&&K!==void 0&&(this.connectEnds=!0,we.splice(we.length,0,we[K]),Q=!0),we.forEach(J=>{J.polarPlotY===void 0&&ae.polar.toXY(J)})}let ye=ge.apply(this,[].slice.call(arguments,1));return Q&&we.pop(),ye}function W(ge,we){let K=this.chart,Q={xAxis:[],yAxis:[]};return K.polar?K.axes.forEach(ae=>{if(ae.coll==="colorAxis")return;let ye=ae.isXAxis,J=ae.center,re=we.chartX-J[0]-K.plotLeft,ce=we.chartY-J[1]-K.plotTop;Q[ye?"xAxis":"yAxis"].push({axis:ae,value:ae.translate(ye?Math.PI-Math.atan2(re,ce):Math.sqrt(Math.pow(re,2)+Math.pow(ce,2)),!0)})}):Q=ge.call(this,we),Q}function ne(ge,we){this.chart.polar||ge.call(this,we)}function ue(ge,we){let K=this,Q=this.chart,ae=this.group,ye=this.markerGroup,J=this.xAxis&&this.xAxis.center,re=Q.plotLeft,ce=Q.plotTop,pe=this.options.animation,xe,Me,_e,Ce,Le,Ue;Q.polar?K.isRadialBar?we||(K.startAngleRad=A(K.translatedThreshold,K.xAxis.startAngleRad),h.seriesTypes.pie.prototype.animate.call(K,we)):(pe=x(pe),K.is("column")?we||(Me=J[3]/2,K.points.forEach(Xe=>{_e=Xe.graphic,Le=(Ce=Xe.shapeArgs)&&Ce.r,Ue=Ce&&Ce.innerR,_e&&Ce&&(_e.attr({r:Me,innerR:Me}),_e.animate({r:Le,innerR:Ue},K.options.animation))})):we?(xe={translateX:J[0]+re,translateY:J[1]+ce,scaleX:.001,scaleY:.001},ae.attr(xe),ye&&ye.attr(xe)):(xe={translateX:re,translateY:ce,scaleX:1,scaleY:1},ae.animate(xe,pe),ye&&ye.animate(xe,pe))):ge.call(this,we)}function ie(ge,we,K,Q){let ae,ye;if(this.chart.polar)if(Q){let J=(ye=function ce(pe,xe,Me,_e){let Ce,Le,Ue,Xe,Pe,Ee,Ie=_e?1:0,Oe=(Ce=xe>=0&&xe<=pe.length-1?xe:xe<0?pe.length-1+xe:0)-1<0?pe.length-(1+Ie):Ce-1,Re=Ce+1>pe.length-1?Ie:Ce+1,Fe=pe[Oe],Ke=pe[Re],rt=Fe.plotX,at=Fe.plotY,ut=Ke.plotX,mt=Ke.plotY,Tt=pe[Ce].plotX,Rt=pe[Ce].plotY;Le=(1.5*Tt+rt)/2.5,Ue=(1.5*Rt+at)/2.5,Xe=(1.5*Tt+ut)/2.5,Pe=(1.5*Rt+mt)/2.5;let pt=Math.sqrt(Math.pow(Le-Tt,2)+Math.pow(Ue-Rt,2)),Ct=Math.sqrt(Math.pow(Xe-Tt,2)+Math.pow(Pe-Rt,2)),Et=Math.atan2(Ue-Rt,Le-Tt);Ee=Math.PI/2+(Et+Math.atan2(Pe-Rt,Xe-Tt))/2,Math.abs(Et-Ee)>Math.PI/2&&(Ee-=Math.PI),Le=Tt+Math.cos(Ee)*pt,Ue=Rt+Math.sin(Ee)*pt;let ri={rightContX:Xe=Tt+Math.cos(Math.PI+Ee)*Ct,rightContY:Pe=Rt+Math.sin(Math.PI+Ee)*Ct,leftContX:Le,leftContY:Ue,plotX:Tt,plotY:Rt};return Me&&(ri.prevPointCont=ce(pe,Oe,!1,_e)),ri}(we,Q,!0,this.connectEnds)).prevPointCont&&ye.prevPointCont.rightContX,re=ye.prevPointCont&&ye.prevPointCont.rightContY;ae=["C",S(J)?J:ye.plotX,S(re)?re:ye.plotY,S(ye.leftContX)?ye.leftContX:ye.plotX,S(ye.leftContY)?ye.leftContY:ye.plotY,ye.plotX,ye.plotY]}else ae=["M",K.plotX,K.plotY];else ae=ge.call(this,we,K,Q);return ae}function oe(ge,we,K=this.plotY){if(!this.destroyed){let{plotX:Q,series:ae}=this,{chart:ye}=ae;return ye.polar&&S(Q)&&S(K)?[Q+(we?ye.plotLeft:0),K+(we?ye.plotTop:0)]:ge.call(this,we,K)}}class Te{static compose(we,K,Q,ae,ye,J,re,ce,pe,xe){if(s.compose(K,Q),f.compose(we,ye),y(v,"Polar")){let Me=K.prototype,_e=J.prototype,Ce=Q.prototype,Le=ae.prototype;if(g(K,"afterDrawChartBox",z),g(K,"getAxes",X),g(K,"init",Y),M(Me,"get",G),M(Ce,"getCoordinates",W),M(Ce,"pinch",ne),g(Q,"getSelectionMarkerAttrs",j),g(Q,"getSelectionBox",Z),g(ae,"afterInit",V),g(ae,"afterTranslate",$,{order:2}),g(ae,"afterColumnTranslate",F,{order:4}),M(Le,"animate",ue),M(_e,"pos",oe),ce){let Ue=ce.prototype;M(Ue,"alignDataLabel",U),M(Ue,"animate",ue)}if(pe&&M(pe.prototype,"getGraphPath",H),xe){let Ue=xe.prototype;M(Ue,"getPointSpline",ie),re&&(re.prototype.getPointSpline=Ue.getPointSpline)}}}constructor(we){this.series=we}arc(we,K,Q,ae){let ye=this.series,J=ye.xAxis.center,re=ye.yAxis.len,ce=J[3]/2,pe=re-K+ce,xe=re-A(we,re)+ce;return ye.yAxis.reversed&&(pe<0&&(pe=ce),xe<0&&(xe=ce)),{x:J[0],y:J[1],r:pe,innerR:xe,start:Q,end:ae}}toXY(we){let K=this.series,Q=K.chart,ae=K.xAxis,ye=K.yAxis,J=we.plotX,re=Q.inverted,ce=we.y,pe=we.plotY,xe=re?J:ye.len-pe,Me;if(re&&K&&!K.isRadialBar&&(we.plotY=pe=S(ce)?ye.translate(ce):0),we.rectPlotX=J,we.rectPlotY=pe,ye.center&&(xe+=ye.center[3]/2),S(pe)){let _e=re?ye.postTranslate(pe,xe):ae.postTranslate(J,xe);we.plotX=we.polarPlotX=_e.x-Q.plotLeft,we.plotY=we.polarPlotY=_e.y-Q.plotTop}K.kdByAngle?((Me=(J/Math.PI*180+ae.pane.options.startAngle)%360)<0&&(Me+=360),we.clientX=Me):we.clientX=we.plotX}}return Te}),c(t,"Core/Axis/WaterfallAxis.js",[t["Core/Globals.js"],t["Core/Axis/Stacking/StackItem.js"],t["Core/Utilities.js"]],function(a,h,d){var s;let{composed:f}=a,{addEvent:b,objectEach:x,pushUnique:v}=d;return function(g){function P(){let y=this.waterfall.stacks;y&&(y.changed=!1,delete y.alreadyChanged)}function _(){let y=this.options.stackLabels;y&&y.enabled&&this.waterfall.stacks&&this.waterfall.renderStackTotals()}function S(){this.waterfall||(this.waterfall=new A(this))}function k(){let y=this.axes;for(let I of this.series)if(I.options.stacking){for(let D of y)D.isXAxis||(D.waterfall.stacks.changed=!0);break}}g.compose=function(y,I){v(f,"Axis.Waterfall")&&(b(y,"init",S),b(y,"afterBuildStacks",P),b(y,"afterRender",_),b(I,"beforeRedraw",k))};class A{constructor(I){this.axis=I,this.stacks={changed:!1}}renderStackTotals(){let I=this.axis,D=I.waterfall.stacks,w=I.stacking&&I.stacking.stackTotalGroup,M=new h(I,I.options.stackLabels||{},!1,0,void 0);this.dummyStackItem=M,w&&x(D,z=>{x(z,(Y,X)=>{M.total=Y.stackTotal,M.x=+X,Y.label&&(M.label=Y.label),h.prototype.render.call(M,w),Y.label=M.label,delete M.label})}),M.total=null}}g.Composition=A}(s||(s={})),s}),c(t,"Series/Waterfall/WaterfallPoint.js",[t["Series/Column/ColumnSeries.js"],t["Core/Series/Point.js"],t["Core/Utilities.js"]],function(a,h,d){let{isNumber:s}=d;class f extends a.prototype.pointClass{getClassName(){let x=h.prototype.getClassName.call(this);return this.isSum?x+=" highcharts-sum":this.isIntermediateSum&&(x+=" highcharts-intermediate-sum"),x}isValid(){return s(this.y)||this.isSum||!!this.isIntermediateSum}}return f}),c(t,"Series/Waterfall/WaterfallSeriesDefaults.js",[],function(){return{dataLabels:{inside:!0},lineWidth:1,lineColor:"#333333",dashStyle:"Dot",borderColor:"#333333",states:{hover:{lineWidthPlus:0}}}}),c(t,"Series/Waterfall/WaterfallSeries.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"],t["Core/Axis/WaterfallAxis.js"],t["Series/Waterfall/WaterfallPoint.js"],t["Series/Waterfall/WaterfallSeriesDefaults.js"]],function(a,h,d,s,f){let{column:b,line:x}=a.seriesTypes,{addEvent:v,arrayMax:g,arrayMin:P,correctFloat:_,crisp:S,extend:k,isNumber:A,merge:y,objectEach:I,pick:D}=h;function w(z,Y){return Object.hasOwnProperty.call(z,Y)}class M extends b{generatePoints(){b.prototype.generatePoints.apply(this);for(let Y=0,X=this.points.length;Y<X;Y++){let Z=this.points[Y],j=this.processedYData[Y];A(j)&&(Z.isIntermediateSum||Z.isSum)&&(Z.y=_(j))}}processData(Y){let X,Z,j,V,$,R,L=this.options,G=this.yData,U=L.data,F=G.length,H=L.threshold||0;j=Z=V=$=0;for(let W=0;W<F;W++)R=G[W],X=U&&U[W]?U[W]:{},R==="sum"||X.isSum?G[W]=_(j):R==="intermediateSum"||X.isIntermediateSum?(G[W]=_(Z),Z=0):(j+=R,Z+=R),V=Math.min(j,V),$=Math.max(j,$);super.processData.call(this,Y),L.stacking||(this.dataMin=V+H,this.dataMax=$)}toYData(Y){return Y.isSum?"sum":Y.isIntermediateSum?"intermediateSum":Y.y}updateParallelArrays(Y,X){super.updateParallelArrays.call(this,Y,X),(this.yData[0]==="sum"||this.yData[0]==="intermediateSum")&&(this.yData[0]=null)}pointAttribs(Y,X){let Z=this.options.upColor;Z&&!Y.options.color&&A(Y.y)&&(Y.color=Y.y>0?Z:void 0);let j=b.prototype.pointAttribs.call(this,Y,X);return delete j.dashstyle,j}getGraphPath(){return[["M",0,0]]}getCrispPath(){var G;let Y=this.data.filter(U=>A(U.y)),X=this.yAxis,Z=Y.length,j=((G=this.graph)==null?void 0:G.strokeWidth())||0,V=this.xAxis.reversed,$=this.yAxis.reversed,R=this.options.stacking,L=[];for(let U=1;U<Z;U++){if(!(this.options.connectNulls||A(this.data[Y[U].index-1].y)))continue;let F=Y[U].box,H=Y[U-1],W=H.y||0,ne=Y[U-1].box;if(!F||!ne)continue;let ue=X.waterfall.stacks[this.stackKey],ie=W>0?-ne.height:0;if(ue&&ne&&F){let oe,Te=ue[U-1];if(R){let ge=Te.connectorThreshold;oe=S(X.translate(ge,!1,!0,!1,!0)+($?ie:0),j)}else oe=S(ne.y+(H.minPointLengthOffset||0),j);L.push(["M",(ne.x||0)+(V?0:ne.width||0),oe],["L",(F.x||0)+(V&&F.width||0),oe])}if(ne&&L.length&&(!R&&W<0&&!$||W>0&&$)){let oe=L[L.length-2];oe&&typeof oe[2]=="number"&&(oe[2]+=ne.height||0);let Te=L[L.length-1];Te&&typeof Te[2]=="number"&&(Te[2]+=ne.height||0)}}return L}drawGraph(){x.prototype.drawGraph.call(this),this.graph&&this.graph.attr({d:this.getCrispPath()})}setStackedPoints(Y){var ae;let X=this.options,Z=(ae=Y.waterfall)==null?void 0:ae.stacks,j=X.threshold||0,V=this.stackKey,$=this.xData,R=$.length,L=j,G=L,U,F=0,H=0,W=0,ne,ue,ie,oe,Te,ge,we,K,Q=(ye,J,re,ce)=>{if(U){if(ne)for(;re<ne;re++)U.stackState[re]+=ce;else U.stackState[0]=ye,ne=U.stackState.length;U.stackState.push(U.stackState[ne-1]+J)}};if(Y.stacking&&Z&&this.reserveSpace()){K=Z.changed,(we=Z.alreadyChanged)&&0>we.indexOf(V)&&(K=!0),Z[V]||(Z[V]={});let ye=Z[V];if(ye)for(let J=0;J<R;J++)(!ye[ge=$[J]]||K)&&(ye[ge]={negTotal:0,posTotal:0,stackTotal:0,threshold:0,stateIndex:0,stackState:[],label:K&&ye[ge]?ye[ge].label:void 0}),U=ye[ge],(Te=this.yData[J])>=0?U.posTotal+=Te:U.negTotal+=Te,oe=X.data[J],ue=U.absolutePos=U.posTotal,ie=U.absoluteNeg=U.negTotal,U.stackTotal=ue+ie,ne=U.stackState.length,oe&&oe.isIntermediateSum?(Q(W,H,0,W),W=H,H=j,L^=G,G^=L,L^=G):oe&&oe.isSum?(Q(j,F,ne,0),L=j):(Q(L,Te,0,F),oe&&(F+=Te,H+=Te)),U.stateIndex++,U.threshold=L,L+=U.stackTotal;Z.changed=!1,Z.alreadyChanged||(Z.alreadyChanged=[]),Z.alreadyChanged.push(V)}}getExtremes(){let Y,X,Z,j=this.options.stacking;return j?(Y=this.yAxis.waterfall.stacks,X=this.stackedYNeg=[],Z=this.stackedYPos=[],j==="overlap"?I(Y[this.stackKey],function(V){X.push(P(V.stackState)),Z.push(g(V.stackState))}):I(Y[this.stackKey],function(V){X.push(V.negTotal+V.threshold),Z.push(V.posTotal+V.threshold)}),{dataMin:P(X),dataMax:g(Z)}):{dataMin:this.dataMin,dataMax:this.dataMax}}}return M.defaultOptions=y(b.defaultOptions,f),M.compose=d.compose,k(M.prototype,{pointValKey:"y",showLine:!0,pointClass:s}),v(M,"afterColumnTranslate",function(){let{options:z,points:Y,yAxis:X}=this,Z=D(z.minPointLength,5),j=Z/2,V=z.threshold||0,$=z.stacking,R=X.waterfall.stacks[this.stackKey],L=V,G=V,U,F,H,W;for(let ne=0;ne<Y.length;ne++){let ue=Y[ne],ie=this.processedYData[ne],oe=k({x:0,y:0,width:0,height:0},ue.shapeArgs||{});ue.box=oe;let Te=[0,ie],ge=ue.y||0;if($){if(R){let Q=R[ne];$==="overlap"?(F=Q.stackState[Q.stateIndex--],U=ge>=0?F:F-ge,w(Q,"absolutePos")&&delete Q.absolutePos,w(Q,"absoluteNeg")&&delete Q.absoluteNeg):(ge>=0?(F=Q.threshold+Q.posTotal,Q.posTotal-=ge,U=F):(F=Q.threshold+Q.negTotal,Q.negTotal-=ge,U=F-ge),!Q.posTotal&&A(Q.absolutePos)&&w(Q,"absolutePos")&&(Q.posTotal=Q.absolutePos,delete Q.absolutePos),!Q.negTotal&&A(Q.absoluteNeg)&&w(Q,"absoluteNeg")&&(Q.negTotal=Q.absoluteNeg,delete Q.absoluteNeg)),ue.isSum||(Q.connectorThreshold=Q.threshold+Q.stackTotal),X.reversed?(H=ge>=0?U-ge:U+ge,W=U):(H=U,W=U-ge),ue.below=H<=V,oe.y=X.translate(H,!1,!0,!1,!0),oe.height=Math.abs(oe.y-X.translate(W,!1,!0,!1,!0));let ae=X.waterfall.dummyStackItem;ae&&(ae.x=ne,ae.label=R[ne].label,ae.setOffset(this.pointXOffset||0,this.barW||0,this.stackedYNeg[ne],this.stackedYPos[ne],void 0,this.xAxis))}}else U=Math.max(G,G+ge)+Te[0],oe.y=X.translate(U,!1,!0,!1,!0),ue.isSum?(oe.y=X.translate(Te[1],!1,!0,!1,!0),oe.height=Math.min(X.translate(Te[0],!1,!0,!1,!0),X.len)-oe.y,ue.below=Te[1]<=V):ue.isIntermediateSum?(ge>=0?(H=Te[1]+L,W=L):(H=L,W=Te[1]+L),X.reversed&&(H^=W,W^=H,H^=W),oe.y=X.translate(H,!1,!0,!1,!0),oe.height=Math.abs(oe.y-Math.min(X.translate(W,!1,!0,!1,!0),X.len)),L+=Te[1],ue.below=H<=V):(oe.height=ie>0?X.translate(G,!1,!0,!1,!0)-oe.y:X.translate(G,!1,!0,!1,!0)-X.translate(G-ie,!1,!0,!1,!0),G+=ie,ue.below=G<V),oe.height<0&&(oe.y+=oe.height,oe.height*=-1);ue.plotY=oe.y,ue.yBottom=oe.y+oe.height,oe.height<=Z&&!ue.isNull?(oe.height=Z,oe.y-=j,ue.yBottom=oe.y+oe.height,ue.plotY=oe.y,ge<0?ue.minPointLengthOffset=-j:ue.minPointLengthOffset=j):(ue.isNull&&(oe.width=0),ue.minPointLengthOffset=0);let we=ue.plotY+(ue.negative?oe.height:0);ue.below&&(ue.plotY+=oe.height),ue.tooltipPos&&(this.chart.inverted?ue.tooltipPos[0]=X.len-we:ue.tooltipPos[1]=we),ue.isInside=this.isPointInside(ue);let K=S(ue.yBottom,this.borderWidth);oe.y=S(oe.y,this.borderWidth),oe.height=K-oe.y,y(!0,ue.shapeArgs,oe)}},{order:2}),a.registerSeriesType("waterfall",M),M}),c(t,"masters/highcharts-more.src.js",[t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Extensions/Pane/Pane.js"],t["Series/Bubble/BubbleSeries.js"],t["Series/PackedBubble/PackedBubbleSeries.js"],t["Series/PolarComposition.js"],t["Core/Axis/RadialAxis.js"],t["Series/Waterfall/WaterfallSeries.js"]],function(a,h,d,s,f,b,x,v){return a.RadialAxis=x,s.compose(a.Axis,a.Chart,a.Legend),f.compose(a.Axis,a.Chart,a.Legend),d.compose(a.Chart,a.Pointer),b.compose(a.Axis,a.Chart,a.Pointer,a.Series,a.Tick,a.Point,h.seriesTypes.areasplinerange,h.seriesTypes.column,h.seriesTypes.line,h.seriesTypes.spline),v.compose(a.Axis,a.Chart),a})})})(Sw);var j3=Sw.exports;const B3=jh(j3);var kw={exports:{}};(function(n){(function(e){n.exports?(e.default=e,n.exports=e):e(typeof Highcharts<"u"?Highcharts:void 0)})(function(e){var t=e?e._modules:{};function c(a,h,d,s){a.hasOwnProperty(h)||(a[h]=s.apply(null,d),typeof CustomEvent=="function"&&e.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:h,module:a[h]}})))}c(t,"Core/Chart/ChartNavigationComposition.js",[],function(){var a;return function(h){h.compose=function(s){return s.navigation||(s.navigation=new d(s)),s};class d{constructor(f){this.updates=[],this.chart=f}addUpdate(f){this.chart.navigation.updates.push(f)}update(f,b){this.updates.forEach(x=>{x.call(this.chart,f,b)})}}h.Additions=d}(a||(a={})),a}),c(t,"Extensions/Exporting/ExportingDefaults.js",[t["Core/Globals.js"]],function(a){let{isTouchDevice:h}=a;return{exporting:{allowTableSorting:!0,type:"image/png",url:"https://export.highcharts.com/",pdfFont:{normal:void 0,bold:void 0,bolditalic:void 0,italic:void 0},printMaxWidth:780,scale:2,buttons:{contextButton:{className:"highcharts-contextbutton",menuClassName:"highcharts-contextmenu",symbol:"menu",titleKey:"contextButtonTitle",menuItems:["viewFullscreen","printChart","separator","downloadPNG","downloadJPEG","downloadPDF","downloadSVG"]}},menuItemDefinitions:{viewFullscreen:{textKey:"viewFullscreen",onclick:function(){this.fullscreen&&this.fullscreen.toggle()}},printChart:{textKey:"printChart",onclick:function(){this.print()}},separator:{separator:!0},downloadPNG:{textKey:"downloadPNG",onclick:function(){this.exportChart()}},downloadJPEG:{textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"})}},downloadPDF:{textKey:"downloadPDF",onclick:function(){this.exportChart({type:"application/pdf"})}},downloadSVG:{textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"})}}}},lang:{viewFullscreen:"View in full screen",exitFullscreen:"Exit from full screen",printChart:"Print chart",downloadPNG:"Download PNG image",downloadJPEG:"Download JPEG image",downloadPDF:"Download PDF document",downloadSVG:"Download SVG vector image",contextButtonTitle:"Chart context menu"},navigation:{buttonOptions:{symbolSize:14,symbolX:14.5,symbolY:13.5,align:"right",buttonSpacing:3,height:28,verticalAlign:"top",width:28,symbolFill:"#666666",symbolStroke:"#666666",symbolStrokeWidth:3,theme:{fill:"#ffffff",padding:5,stroke:"none","stroke-linecap":"round"}},menuStyle:{border:"none",borderRadius:"3px",background:"#ffffff",padding:"0.5em"},menuItemStyle:{background:"none",borderRadius:"3px",color:"#333333",padding:"0.5em",fontSize:h?"0.9em":"0.8em",transition:"background 250ms, color 250ms"},menuItemHoverStyle:{background:"#f2f2f2"}}}}),c(t,"Extensions/Exporting/ExportingSymbols.js",[],function(){var a;return function(h){let d=[];function s(b,x,v,g){return[["M",b,x+2.5],["L",b+v,x+2.5],["M",b,x+g/2+.5],["L",b+v,x+g/2+.5],["M",b,x+g-1.5],["L",b+v,x+g-1.5]]}function f(b,x,v,g){let P=g/3-2;return[].concat(this.circle(v-P,x,P,P),this.circle(v-P,x+P+4,P,P),this.circle(v-P,x+2*(P+4),P,P))}h.compose=function(b){if(d.indexOf(b)===-1){d.push(b);let x=b.prototype.symbols;x.menu=s,x.menuball=f.bind(x)}}}(a||(a={})),a}),c(t,"Extensions/Exporting/Fullscreen.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h,d){let{composed:s}=h,{addEvent:f,fireEvent:b,pushUnique:x}=d;function v(){this.fullscreen=new g(this)}class g{static compose(_){x(s,"Fullscreen")&&f(_,"beforeRender",v)}constructor(_){this.chart=_,this.isOpen=!1;let S=_.renderTo;!this.browserProps&&(typeof S.requestFullscreen=="function"?this.browserProps={fullscreenChange:"fullscreenchange",requestFullscreen:"requestFullscreen",exitFullscreen:"exitFullscreen"}:S.mozRequestFullScreen?this.browserProps={fullscreenChange:"mozfullscreenchange",requestFullscreen:"mozRequestFullScreen",exitFullscreen:"mozCancelFullScreen"}:S.webkitRequestFullScreen?this.browserProps={fullscreenChange:"webkitfullscreenchange",requestFullscreen:"webkitRequestFullScreen",exitFullscreen:"webkitExitFullscreen"}:S.msRequestFullscreen&&(this.browserProps={fullscreenChange:"MSFullscreenChange",requestFullscreen:"msRequestFullscreen",exitFullscreen:"msExitFullscreen"}))}close(){let _=this,S=_.chart,k=S.options.chart;b(S,"fullscreenClose",null,function(){_.isOpen&&_.browserProps&&S.container.ownerDocument instanceof Document&&S.container.ownerDocument[_.browserProps.exitFullscreen](),_.unbindFullscreenEvent&&(_.unbindFullscreenEvent=_.unbindFullscreenEvent()),S.setSize(_.origWidth,_.origHeight,!1),_.origWidth=void 0,_.origHeight=void 0,k.width=_.origWidthOption,k.height=_.origHeightOption,_.origWidthOption=void 0,_.origHeightOption=void 0,_.isOpen=!1,_.setButtonText()})}open(){let _=this,S=_.chart,k=S.options.chart;b(S,"fullscreenOpen",null,function(){if(k&&(_.origWidthOption=k.width,_.origHeightOption=k.height),_.origWidth=S.chartWidth,_.origHeight=S.chartHeight,_.browserProps){let A=f(S.container.ownerDocument,_.browserProps.fullscreenChange,function(){_.isOpen?(_.isOpen=!1,_.close()):(S.setSize(null,null,!1),_.isOpen=!0,_.setButtonText())}),y=f(S,"destroy",A);_.unbindFullscreenEvent=()=>{A(),y()};let I=S.renderTo[_.browserProps.requestFullscreen]();I&&I.catch(function(){alert("Full screen is not supported inside a frame.")})}})}setButtonText(){let _=this.chart,S=_.exportDivElements,k=_.options.exporting,A=k&&k.buttons&&k.buttons.contextButton.menuItems,y=_.options.lang;if(k&&k.menuItemDefinitions&&y&&y.exitFullscreen&&y.viewFullscreen&&A&&S){let I=S[A.indexOf("viewFullscreen")];I&&a.setElementHTML(I,this.isOpen?y.exitFullscreen:k.menuItemDefinitions.viewFullscreen.text||y.viewFullscreen)}}toggle(){this.isOpen?this.close():this.open()}}return g}),c(t,"Core/HttpUtilities.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(a,h){let{win:d}=a,{discardElement:s,objectEach:f}=h,b={ajax:function(x){let v={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"},g=new XMLHttpRequest;function P(_,S){x.error&&x.error(_,S)}if(!x.url)return!1;g.open((x.type||"get").toUpperCase(),x.url,!0),x.headers&&x.headers["Content-Type"]||g.setRequestHeader("Content-Type",v[x.dataType||"json"]||v.text),f(x.headers,function(_,S){g.setRequestHeader(S,_)}),x.responseType&&(g.responseType=x.responseType),g.onreadystatechange=function(){let _;if(g.readyState===4){if(g.status===200){if(x.responseType!=="blob"&&(_=g.responseText,x.dataType==="json"))try{_=JSON.parse(_)}catch(S){if(S instanceof Error)return P(g,S)}return x.success&&x.success(_,g)}P(g,g.responseText)}},x.data&&typeof x.data!="string"&&(x.data=JSON.stringify(x.data)),g.send(x.data)},getJSON:function(x,v){b.ajax({url:x,success:v,dataType:"json",headers:{"Content-Type":"text/plain"}})},post:function(x,v,g){let P=new d.FormData;f(v,function(k,A){P.append(A,k)}),P.append("b64","true");let{filename:_,type:S}=v;return d.fetch(x,{method:"POST",body:P,...g}).then(k=>{k.ok&&k.text().then(A=>{let y=document.createElement("a");y.href=`data:${S};base64,${A}`,y.download=_,y.click(),s(y)})})}};return b}),c(t,"Extensions/Exporting/Exporting.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Chart/Chart.js"],t["Core/Chart/ChartNavigationComposition.js"],t["Core/Defaults.js"],t["Extensions/Exporting/ExportingDefaults.js"],t["Extensions/Exporting/ExportingSymbols.js"],t["Extensions/Exporting/Fullscreen.js"],t["Core/Globals.js"],t["Core/HttpUtilities.js"],t["Core/Utilities.js"]],function(a,h,d,s,f,b,x,v,g,P){var _;let{defaultOptions:S}=s,{doc:k,SVG_NS:A,win:y}=v,{addEvent:I,css:D,createElement:w,discardElement:M,extend:z,find:Y,fireEvent:X,isObject:Z,merge:j,objectEach:V,pick:$,removeEvent:R,uniqueKey:L}=P;return function(G){let U,F=[/-/,/^(clipPath|cssText|d|height|width)$/,/^font$/,/[lL]ogical(Width|Height)$/,/^parentRule$/,/^(cssRules|ownerRules)$/,/perspective/,/TapHighlightColor/,/^transition/,/^length$/,/^\d+$/],H=["fill","stroke","strokeLinecap","strokeLinejoin","strokeWidth","textAnchor","x","y"];G.inlineAllowlist=[];let W=["clipPath","defs","desc"];function ne(_e){let Ce,Le,Ue=this,Xe=Ue.renderer,Pe=j(Ue.options.navigation.buttonOptions,_e),Ee=Pe.onclick,Ie=Pe.menuItems,Oe=Pe.symbolSize||12;if(Ue.btnCount||(Ue.btnCount=0),Ue.exportDivElements||(Ue.exportDivElements=[],Ue.exportSVGElements=[]),Pe.enabled===!1||!Pe.theme)return;let Re=Ue.styledMode?{}:Pe.theme;Ee?Le=function(Ke){Ke&&Ke.stopPropagation(),Ee.call(Ue,Ke)}:Ie&&(Le=function(Ke){Ke&&Ke.stopPropagation(),Ue.contextMenu(Fe.menuClassName,Ie,Fe.translateX||0,Fe.translateY||0,Fe.width||0,Fe.height||0,Fe),Fe.setState(2)}),Pe.text&&Pe.symbol?Re.paddingLeft=$(Re.paddingLeft,30):Pe.text||z(Re,{width:Pe.width,height:Pe.height,padding:0});let Fe=Xe.button(Pe.text,0,0,Le,Re,void 0,void 0,void 0,void 0,Pe.useHTML).addClass(_e.className).attr({title:$(Ue.options.lang[Pe._titleKey||Pe.titleKey],"")});Fe.menuClassName=_e.menuClassName||"highcharts-menu-"+Ue.btnCount++,Pe.symbol&&(Ce=Xe.symbol(Pe.symbol,Math.round((Pe.symbolX||0)-Oe/2),Math.round((Pe.symbolY||0)-Oe/2),Oe,Oe,{width:Oe,height:Oe}).addClass("highcharts-button-symbol").attr({zIndex:1}).add(Fe),Ue.styledMode||Ce.attr({stroke:Pe.symbolStroke,fill:Pe.symbolFill,"stroke-width":Pe.symbolStrokeWidth||1})),Fe.add(Ue.exportingGroup).align(z(Pe,{width:Fe.width,x:$(Pe.x,Ue.buttonOffset)}),!0,"spacingBox"),Ue.buttonOffset+=((Fe.width||0)+Pe.buttonSpacing)*(Pe.align==="right"?-1:1),Ue.exportSVGElements.push(Fe,Ce)}function ue(){if(!this.printReverseInfo)return;let{childNodes:_e,origDisplay:Ce,resetParams:Le}=this.printReverseInfo;this.moveContainers(this.renderTo),[].forEach.call(_e,function(Ue,Xe){Ue.nodeType===1&&(Ue.style.display=Ce[Xe]||"")}),this.isPrinting=!1,Le&&this.setSize.apply(this,Le),delete this.printReverseInfo,U=void 0,X(this,"afterPrint")}function ie(){var Ue;let _e=k.body,Ce=this.options.exporting.printMaxWidth,Le={childNodes:_e.childNodes,origDisplay:[],resetParams:void 0};this.isPrinting=!0,(Ue=this.pointer)==null||Ue.reset(void 0,0),X(this,"beforePrint"),Ce&&this.chartWidth>Ce&&(Le.resetParams=[this.options.chart.width,void 0,!1],this.setSize(Ce,void 0,!1)),[].forEach.call(Le.childNodes,function(Xe,Pe){Xe.nodeType===1&&(Le.origDisplay[Pe]=Xe.style.display,Xe.style.display="none")}),this.moveContainers(_e),this.printReverseInfo=Le}function oe(_e){_e.renderExporting(),I(_e,"redraw",_e.renderExporting),I(_e,"destroy",_e.destroyExport)}function Te(_e,Ce,Le,Ue,Xe,Pe,Ee){var Tt,Rt;let Ie=this,Oe=Ie.options.navigation,Re=Ie.chartWidth,Fe=Ie.chartHeight,Ke="cache-"+_e,rt=Math.max(Xe,Pe),at,ut=Ie[Ke];ut||(Ie.exportContextMenu=Ie[Ke]=ut=w("div",{className:_e},{position:"absolute",zIndex:1e3,padding:rt+"px",pointerEvents:"auto",...Ie.renderer.style},((Tt=Ie.scrollablePlotArea)==null?void 0:Tt.fixedDiv)||Ie.container),at=w("ul",{className:"highcharts-menu"},Ie.styledMode?{}:{listStyle:"none",margin:0,padding:0},ut),Ie.styledMode||D(at,z({MozBoxShadow:"3px 3px 10px #888",WebkitBoxShadow:"3px 3px 10px #888",boxShadow:"3px 3px 10px #888"},Oe.menuStyle)),ut.hideMenu=function(){D(ut,{display:"none"}),Ee&&Ee.setState(0),Ie.openMenu=!1,D(Ie.renderTo,{overflow:"hidden"}),D(Ie.container,{overflow:"hidden"}),P.clearTimeout(ut.hideTimer),X(Ie,"exportMenuHidden")},Ie.exportEvents.push(I(ut,"mouseleave",function(){ut.hideTimer=y.setTimeout(ut.hideMenu,500)}),I(ut,"mouseenter",function(){P.clearTimeout(ut.hideTimer)}),I(k,"mouseup",function(pt){var Ct;(Ct=Ie.pointer)!=null&&Ct.inClass(pt.target,_e)||ut.hideMenu()}),I(ut,"click",function(){Ie.openMenu&&ut.hideMenu()})),Ce.forEach(function(pt){if(typeof pt=="string"&&(pt=Ie.options.exporting.menuItemDefinitions[pt]),Z(pt,!0)){let Ct;pt.separator?Ct=w("hr",void 0,void 0,at):(pt.textKey==="viewData"&&Ie.isDataTableVisible&&(pt.textKey="hideData"),Ct=w("li",{className:"highcharts-menu-item",onclick:function(Et){Et&&Et.stopPropagation(),ut.hideMenu(),typeof pt!="string"&&pt.onclick&&pt.onclick.apply(Ie,arguments)}},void 0,at),a.setElementHTML(Ct,pt.text||Ie.options.lang[pt.textKey]),Ie.styledMode||(Ct.onmouseover=function(){D(this,Oe.menuItemHoverStyle)},Ct.onmouseout=function(){D(this,Oe.menuItemStyle)},D(Ct,z({cursor:"pointer"},Oe.menuItemStyle||{})))),Ie.exportDivElements.push(Ct)}}),Ie.exportDivElements.push(at,ut),Ie.exportMenuWidth=ut.offsetWidth,Ie.exportMenuHeight=ut.offsetHeight);let mt={display:"block"};Le+(Ie.exportMenuWidth||0)>Re?mt.right=Re-Le-Xe-rt+"px":mt.left=Le-rt+"px",Ue+Pe+(Ie.exportMenuHeight||0)>Fe&&((Rt=Ee.alignOptions)==null?void 0:Rt.verticalAlign)!=="top"?mt.bottom=Fe-Ue-rt+"px":mt.top=Ue+Pe-rt+"px",D(ut,mt),D(Ie.renderTo,{overflow:""}),D(Ie.container,{overflow:""}),Ie.openMenu=!0,X(Ie,"exportMenuShown")}function ge(_e){let Ce,Le=_e?_e.target:this,Ue=Le.exportSVGElements,Xe=Le.exportDivElements,Pe=Le.exportEvents;Ue&&(Ue.forEach((Ee,Ie)=>{Ee&&(Ee.onclick=Ee.ontouchstart=null,Le[Ce="cache-"+Ee.menuClassName]&&delete Le[Ce],Ue[Ie]=Ee.destroy())}),Ue.length=0),Le.exportingGroup&&(Le.exportingGroup.destroy(),delete Le.exportingGroup),Xe&&(Xe.forEach(function(Ee,Ie){Ee&&(P.clearTimeout(Ee.hideTimer),R(Ee,"mouseleave"),Xe[Ie]=Ee.onmouseout=Ee.onmouseover=Ee.ontouchstart=Ee.onclick=null,M(Ee))}),Xe.length=0),Pe&&(Pe.forEach(function(Ee){Ee()}),Pe.length=0)}function we(_e,Ce){let Le=this.getSVGForExport(_e,Ce);_e=j(this.options.exporting,_e),g.post(_e.url,{filename:_e.filename?_e.filename.replace(/\//g,"-"):this.getFilename(),type:_e.type,width:_e.width,scale:_e.scale,svg:Le},_e.fetchOptions)}function K(){return this.styledMode&&this.inlineStyles(),this.container.innerHTML}function Q(){let _e=this.userOptions.title&&this.userOptions.title.text,Ce=this.options.exporting.filename;return Ce?Ce.replace(/\//g,"-"):(typeof _e=="string"&&(Ce=_e.toLowerCase().replace(/<\/?[^>]+(>|$)/g,"").replace(/[\s_]+/g,"-").replace(/[^a-z\d\-]/g,"").replace(/^[\-]+/g,"").replace(/[\-]+/g,"-").substr(0,24).replace(/[\-]+$/g,"")),(!Ce||Ce.length<5)&&(Ce="chart"),Ce)}function ae(_e){let Ce,Le,Ue=j(this.options,_e);Ue.plotOptions=j(this.userOptions.plotOptions,_e&&_e.plotOptions),Ue.time=j(this.userOptions.time,_e&&_e.time);let Xe=w("div",null,{position:"absolute",top:"-9999em",width:this.chartWidth+"px",height:this.chartHeight+"px"},k.body),Pe=this.renderTo.style.width,Ee=this.renderTo.style.height,Ie=Ue.exporting.sourceWidth||Ue.chart.width||/px$/.test(Pe)&&parseInt(Pe,10)||(Ue.isGantt?800:600),Oe=Ue.exporting.sourceHeight||Ue.chart.height||/px$/.test(Ee)&&parseInt(Ee,10)||400;z(Ue.chart,{animation:!1,renderTo:Xe,forExport:!0,renderer:"SVGRenderer",width:Ie,height:Oe}),Ue.exporting.enabled=!1,delete Ue.data,Ue.series=[],this.series.forEach(function(Ke){(Le=j(Ke.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:Ke.visible})).isInternal||Ue.series.push(Le)});let Re={};this.axes.forEach(function(Ke){Ke.userOptions.internalKey||(Ke.userOptions.internalKey=L()),Ke.options.isInternal||(Re[Ke.coll]||(Re[Ke.coll]=!0,Ue[Ke.coll]=[]),Ue[Ke.coll].push(j(Ke.userOptions,{visible:Ke.visible,type:Ke.type,uniqueNames:Ke.uniqueNames})))}),Ue.colorAxis=this.userOptions.colorAxis;let Fe=new this.constructor(Ue,this.callback);return _e&&["xAxis","yAxis","series"].forEach(function(Ke){let rt={};_e[Ke]&&(rt[Ke]=_e[Ke],Fe.update(rt))}),this.axes.forEach(function(Ke){let rt=Y(Fe.axes,function(Tt){return Tt.options.internalKey===Ke.userOptions.internalKey}),at=Ke.getExtremes(),ut=at.userMin,mt=at.userMax;rt&&(ut!==void 0&&ut!==rt.min||mt!==void 0&&mt!==rt.max)&&rt.setExtremes(ut,mt,!0,!1)}),Ce=Fe.getChartHTML(),X(this,"getSVG",{chartCopy:Fe}),Ce=this.sanitizeSVG(Ce,Ue),Ue=null,Fe.destroy(),M(Xe),Ce}function ye(_e,Ce){let Le=this.options.exporting;return this.getSVG(j({chart:{borderRadius:0}},Le.chartOptions,Ce,{exporting:{sourceWidth:_e&&_e.sourceWidth||Le.sourceWidth,sourceHeight:_e&&_e.sourceHeight||Le.sourceHeight}}))}function J(){let _e,Ce=G.inlineAllowlist,Le={},Ue=k.createElement("iframe");D(Ue,{width:"1px",height:"1px",visibility:"hidden"}),k.body.appendChild(Ue);let Xe=Ue.contentWindow&&Ue.contentWindow.document;Xe&&Xe.body.appendChild(Xe.createElementNS(A,"svg")),function Pe(Ee){let Ie,Oe,Re,Fe,Ke,rt,at={};if(Xe&&Ee.nodeType===1&&W.indexOf(Ee.nodeName)===-1){if(Ie=y.getComputedStyle(Ee,null),Oe=Ee.nodeName==="svg"?{}:y.getComputedStyle(Ee.parentNode,null),!Le[Ee.nodeName]){_e=Xe.getElementsByTagName("svg")[0],Re=Xe.createElementNS(Ee.namespaceURI,Ee.nodeName),_e.appendChild(Re);let ut=y.getComputedStyle(Re,null),mt={};for(let Tt in ut)Tt.length<1e3&&typeof ut[Tt]=="string"&&!/^\d+$/.test(Tt)&&(mt[Tt]=ut[Tt]);Le[Ee.nodeName]=mt,Ee.nodeName==="text"&&delete Le.text.fill,_e.removeChild(Re)}for(let ut in Ie)(v.isFirefox||v.isMS||v.isSafari||Object.hasOwnProperty.call(Ie,ut))&&function(mt,Tt){if(Fe=Ke=!1,Ce.length){for(rt=Ce.length;rt--&&!Ke;)Ke=Ce[rt].test(Tt);Fe=!Ke}for(Tt==="transform"&&mt==="none"&&(Fe=!0),rt=F.length;rt--&&!Fe;){if(Tt.length>1e3)throw Error("Input too long");Fe=F[rt].test(Tt)||typeof mt=="function"}!Fe&&(Oe[Tt]!==mt||Ee.nodeName==="svg")&&Le[Ee.nodeName][Tt]!==mt&&(H.indexOf(Tt)===-1?at[Tt]=mt:mt&&Ee.setAttribute(Tt.replace(/[A-Z]/g,function(Rt){return"-"+Rt.toLowerCase()}),mt))}(Ie[ut],ut);if(D(Ee,at),Ee.nodeName==="svg"&&Ee.setAttribute("stroke-width","1px"),Ee.nodeName==="text")return;[].forEach.call(Ee.children||Ee.childNodes,Pe)}}(this.container.querySelector("svg")),_e.parentNode.removeChild(_e),Ue.parentNode.removeChild(Ue)}function re(_e){let{scrollablePlotArea:Ce}=this;(Ce?[Ce.fixedDiv,Ce.scrollingContainer]:[this.container]).forEach(function(Le){_e.appendChild(Le)})}function ce(){let _e=this,Ce=(Le,Ue,Xe)=>{_e.isDirtyExporting=!0,j(!0,_e.options[Le],Ue),$(Xe,!0)&&_e.redraw()};_e.exporting={update:function(Le,Ue){Ce("exporting",Le,Ue)}},d.compose(_e).navigation.addUpdate((Le,Ue)=>{Ce("navigation",Le,Ue)})}function pe(){let _e=this;_e.isPrinting||(U=_e,v.isSafari||_e.beforePrint(),setTimeout(()=>{y.focus(),y.print(),v.isSafari||setTimeout(()=>{_e.afterPrint()},1e3)},1))}function xe(){let _e=this,Ce=_e.options.exporting,Le=Ce.buttons,Ue=_e.isDirtyExporting||!_e.exportSVGElements;_e.buttonOffset=0,_e.isDirtyExporting&&_e.destroyExport(),Ue&&Ce.enabled!==!1&&(_e.exportEvents=[],_e.exportingGroup=_e.exportingGroup||_e.renderer.g("exporting-group").attr({zIndex:3}).add(),V(Le,function(Xe){_e.addButton(Xe)}),_e.isDirtyExporting=!1)}function Me(_e,Ce){let Le=_e.indexOf("</svg>")+6,Ue=_e.substr(Le);return _e=_e.substr(0,Le),Ce&&Ce.exporting&&Ce.exporting.allowHTML&&Ue&&(Ue='<foreignObject x="0" y="0" width="'+Ce.chart.width+'" height="'+Ce.chart.height+'"><body xmlns="http://www.w3.org/1999/xhtml">'+Ue.replace(/(<(?:img|br).*?(?=\>))>/g,"$1 />")+"</body></foreignObject>",_e=_e.replace("</svg>",Ue+"</svg>")),_e=_e.replace(/zIndex="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery\d+="[^"]+"/g,"").replace(/url\(("|&quot;)(.*?)("|&quot;)\;?\)/g,"url($2)").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ (NS\d+\:)?href=/g," xlink:href=").replace(/\n+/g," ").replace(/(fill|stroke)="rgba\(([ \d]+,[ \d]+,[ \d]+),([ \d\.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g," ").replace(/&shy;/g,"­")}G.compose=function(_e,Ce){b.compose(Ce),x.compose(_e);let Le=_e.prototype;Le.exportChart||(Le.afterPrint=ue,Le.exportChart=we,Le.inlineStyles=J,Le.print=pe,Le.sanitizeSVG=Me,Le.getChartHTML=K,Le.getSVG=ae,Le.getSVGForExport=ye,Le.getFilename=Q,Le.moveContainers=re,Le.beforePrint=ie,Le.contextMenu=Te,Le.addButton=ne,Le.destroyExport=ge,Le.renderExporting=xe,Le.callbacks.push(oe),I(_e,"init",ce),v.isSafari&&y.matchMedia("print").addListener(function(Ue){U&&(Ue.matches?U.beforePrint():U.afterPrint())}),S.exporting=j(f.exporting,S.exporting),S.lang=j(f.lang,S.lang),S.navigation=j(f.navigation,S.navigation))}}(_||(_={})),_}),c(t,"masters/modules/exporting.src.js",[t["Core/Globals.js"],t["Extensions/Exporting/Exporting.js"],t["Core/HttpUtilities.js"]],function(a,h,d){return a.HttpUtilities=a.HttpUtilities||d,a.ajax=a.HttpUtilities.ajax,a.getJSON=a.HttpUtilities.getJSON,a.post=a.HttpUtilities.post,h.compose(a.Chart,a.Renderer),a})})})(kw);var F3=kw.exports;const U3=jh(F3);var Mw={exports:{}};(function(n,e){(function(t,c){n.exports=c(We)})(typeof self<"u"?self:lo,function(t){return function(c){function a(d){if(h[d])return h[d].exports;var s=h[d]={i:d,l:!1,exports:{}};return c[d].call(s.exports,s,s.exports,a),s.l=!0,s.exports}var h={};return a.m=c,a.c=h,a.d=function(d,s,f){a.o(d,s)||Object.defineProperty(d,s,{configurable:!1,enumerable:!0,get:f})},a.n=function(d){var s=d&&d.__esModule?function(){return d.default}:function(){return d};return a.d(s,"a",s),s},a.o=function(d,s){return Object.prototype.hasOwnProperty.call(d,s)},a.p="",a(a.s=0)}([function(c,a,h){function d(){return d=Object.assign?Object.assign.bind():function(y){for(var I=1;I<arguments.length;I++){var D=arguments[I];for(var w in D)Object.prototype.hasOwnProperty.call(D,w)&&(y[w]=D[w])}return y},d.apply(this,arguments)}function s(y){return v(y)||x(y)||b(y)||f()}function f(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b(y,I){{if(typeof y=="string")return g(y,I);var D=Object.prototype.toString.call(y).slice(8,-1);return D==="Object"&&y.constructor&&(D=y.constructor.name),D==="Map"||D==="Set"?Array.from(y):D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D)?g(y,I):void 0}}function x(y){if(typeof Symbol<"u"&&y[Symbol.iterator]!=null||y["@@iterator"]!=null)return Array.from(y)}function v(y){if(Array.isArray(y))return g(y)}function g(y,I){(I==null||I>y.length)&&(I=y.length);for(var D=0,w=new Array(I);D<I;D++)w[D]=y[D];return w}function P(y){"@babel/helpers - typeof";return(P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I})(y)}Object.defineProperty(a,"__esModule",{value:!0}),h.d(a,"HighchartsReact",function(){return A});var _=h(1),S=h.n(_),k=typeof window<"u"?_.useLayoutEffect:_.useEffect,A=Object(_.memo)(Object(_.forwardRef)(function(y,I){var D=Object(_.useRef)(),w=Object(_.useRef)(),M=Object(_.useRef)(y.constructorType),z=Object(_.useRef)(y.highcharts);return k(function(){function Y(){var Z=y.highcharts||(typeof window>"u"?"undefined":P(window))==="object"&&window.Highcharts,j=y.constructorType||"chart";Z?Z[j]?y.options?w.current=Z[j](D.current,y.options,y.callback):console.warn('The "options" property was not passed.'):console.warn('The "constructorType" property is incorrect or some required module is not imported.'):console.warn('The "highcharts" property was not passed.')}if(w.current){if(y.allowChartUpdate!==!1)if(y.constructorType!==M.current||y.highcharts!==z.current)M.current=y.constructorType,z.current=y.highcharts,Y();else if(!y.immutable&&w.current){var X;(X=w.current).update.apply(X,[y.options].concat(s(y.updateArgs||[!0,!0])))}else Y()}else Y()},[y.options,y.allowChartUpdate,y.updateArgs,y.containerProps,y.highcharts,y.constructorType]),k(function(){return function(){w.current&&(w.current.destroy(),w.current=null)}},[]),Object(_.useImperativeHandle)(I,function(){return{get chart(){return w.current},container:D}},[]),S.a.createElement("div",d({},y.containerProps,{ref:D}))}));a.default=A},function(c,a){c.exports=t}])})})(Mw);var $3=Mw.exports;const Aw=jh($3),G3="_chartContainer_1sr1q_1",V3="_chart_1sr1q_1",H3="_menu_1sr1q_10",Og={chartContainer:G3,chart:V3,menu:H3},W3="أسبوع",Y3={"Bi-Week":"كل اسبوعين",Week:W3},q3="Týden",X3={"Bi-Week":"Dvoutýden",Week:q3},Z3="Week",K3={'Couldn\'t find a monthly period for weekly period id "{{periodId}}"':`Couldn't find a monthly period for weekly period id "{{periodId}}"`,'Couldn\'t find a weekly period for weekly period id "{{periodId}}"':`Couldn't find a weekly period for weekly period id "{{periodId}}"`,'Couldn\'t handle unknown period id "{{periodId}}"':`Couldn't handle unknown period id "{{periodId}}"`,'Could not find a period type for period id "{{periodId}}"':'Could not find a period type for period id "{{periodId}}"','Could not determine a period type for period id "{{periodId}}"':'Could not determine a period type for period id "{{periodId}}"','Couldn\'t find a period type for weekly period id "{{periodId}}"':`Couldn't find a period type for weekly period id "{{periodId}}"`,"Bi-Week":"Bi-Week",Week:Z3,'Date string is invalid, received "{{dateString}}"':'Date string is invalid, received "{{dateString}}"',"Date string format does not match the specified format. Expected {{format}} but got {{detectedFormat}}.":"Date string format does not match the specified format. Expected {{format}} but got {{detectedFormat}}.",'Unrecognized date, received "{{date}}"':'Unrecognized date, received "{{date}}"',"Date is not given":"Date is not given","Invalid date in specified calendar":"Invalid date in specified calendar","Date {{dateString}} is less than the minimum allowed date {{minDateString}}.":"Date {{dateString}} is less than the minimum allowed date {{minDateString}}.","Date {{dateString}} is greater than the maximum allowed date {{maxDateString}}.":"Date {{dateString}} is greater than the maximum allowed date {{maxDateString}}."},Q3="Semana",J3={"Bi-Week":"Quincenal",Week:Q3},eI="Semana",tI={"Bi-Week":"Cada dos semanas",Week:eI},iI="Semaine",rI={"Bi-Week":"Bi-hebdomadaire",Week:iI},nI="Minggu",sI={"Bi-Week":"",Week:nI},oI="ອາທິດ",aI={"Bi-Week":"ສອງອາທິດຕໍ່ຄັ້ງ",Week:oI},lI="Uke",cI={"Bi-Week":"Toukentlig",Week:lI},hI="Week",uI={"Bi-Week":"",Week:hI},dI="هفته",pI={"Bi-Week":"",Week:dI},fI="اونۍ",mI={"Bi-Week":"",Week:fI},gI="Semana",yI={"Bi-Week":"Bimensal",Week:gI},xI="Semana",bI={"Bi-Week":"",Week:xI},vI="Неделя",_I={"Bi-Week":"",Week:vI},wI="සතිය",TI={"Bi-Week":"",Week:wI},EI="Тиждень",CI={"Bi-Week":"",Week:EI},SI="ہفتہ",kI={"Bi-Week":"",Week:SI},MI="Ҳафта",AI={"Bi-Week":"Жуфт-Ҳафта",Week:MI},PI="Hafta",II={"Bi-Week":"Juft-Hafta",Week:PI},DI="Tuần",LI={"Bi-Week":"Kỳ 2 tuần này",Week:DI},RI="周",OI={"Bi-Week":"两周",Week:RI},zI="周",NI={"Bi-Week":"",Week:zI},mn="default";jt.addResources("ar",mn,Y3);jt.addResources("cs",mn,X3);jt.addResources("en",mn,K3);jt.addResources("es",mn,J3);jt.addResources("es_419",mn,tI);jt.addResources("fr",mn,rI);jt.addResources("id",mn,sI);jt.addResources("lo",mn,aI);jt.addResources("nb",mn,cI);jt.addResources("nl",mn,uI);jt.addResources("prs",mn,pI);jt.addResources("ps",mn,mI);jt.addResources("pt",mn,yI);jt.addResources("pt_BR",mn,bI);jt.addResources("ru",mn,_I);jt.addResources("si",mn,TI);jt.addResources("uk",mn,CI);jt.addResources("ur",mn,kI);jt.addResources("uz_UZ_Cyrl",mn,AI);jt.addResources("uz_UZ_Latn",mn,II);jt.addResources("vi",mn,LI);jt.addResources("zh",mn,OI);jt.addResources("zh_CN",mn,NI);const Pw={ethiopian:"ethiopic",coptic:"coptic",gregorian:"gregory",islamic:"islamic",iso8601:"iso8601",nepali:"nepali",thai:"buddhist",persian:"persian"},jI={nepali:{"ne-NP":{monthNames:["बैशाख","जेठ","असार","साउन","भदौ","असोज","कार्तिक","मंसिर","पौष","माघ","फागुन","चैत"],dayNamesShort:["सोम","मंगल","बुध","बिही","शुक्र","शनि","आइत"],numbers:["०","१","२","३","४","५","६","७","८","९","१०","११","१२","१३","१४","१५","१६","१७","१८","१९","२०","२१","२२","२३","२४","२५","२६","२७","२८","२९","३०","३१","३२"]},"en-NP":{monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],dayNamesShort:["Som","Mangl","Budha","Bihi","Shukra","Shani","Aaita"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"]}}},qs={1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,32,31,32,31,30,30,30,29,30,29,31],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]};class BI extends pn.Calendar{constructor(){super("iso8601")}toString(){return"nepali"}year(e){var t;const{isoYear:c,isoMonth:a,isoDay:h}=e.getISOFields();return(t=Ng({year:c,month:a,day:h}))===null||t===void 0?void 0:t.year}eraYear(e){return this.year(e)}daysInMonth(e){const{year:t,month:c}=e;return qs[t][c]}month(e){var t;const{isoYear:c,isoMonth:a,isoDay:h}=e.getISOFields();return(t=Ng({year:c,month:a,day:h}))===null||t===void 0?void 0:t.month}monthCode(e){const{month:t}=e;return Iw(t)}day(e){const{isoYear:t,isoMonth:c,isoDay:a}=e.getISOFields(),{day:h}=Ng({year:t,month:c,day:a});return h}dateFromFields(e,t){const{year:c,day:a,month:h}=zg({year:e.year,month:e.month,day:e.day},t);return new pn.PlainDate(c,h,a,this)}yearMonthFromFields(e){const{year:t,day:c,month:a}=zg({year:e.year,month:e.month,day:e.day});return new pn.PlainYearMonth(t,a,this,c)}monthDayFromFields(e){const{year:t,day:c,month:a}=zg({year:e.year,month:e.month,day:e.day});return new pn.PlainMonthDay(c,a,this,t)}}const by=Object.keys(qs),zf=Number(by[0]),Nf=Number(by[by.length-1]),zg=function(n){let{overflow:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{year:t}=n;if(t<zf||t>Nf)throw new Error(`Conversions are only possible between ${zf} and ${Nf} in Nepali calendar`);const{month:c,day:a=1}=n;if(e==="reject"&&(c<1||c>12||a>qs[t][c]))throw new Error("Invalid date in Nepali calendar");let h=0,d=c;const s=t-(c>9||d===9&&a>=qs[t][0]?56:57);for(c!==9&&(h=a,d--);d!==9;)d<=0&&(d=12,t--),h+=qs[t][d],d--;c===9?(h+=a-qs[t][0],h<0&&(h+=pn.PlainDate.from({year:s,day:1,month:1}).daysInYear)):h+=qs[t][9]-qs[t][0];const f=pn.PlainDate.from({year:s,month:1,day:1}).add({days:h});return{year:f.year,month:f.month,monthCode:Iw(f.month),day:f.day}},Ng=n=>{const e=pn.PlainDate.from({year:n.year,month:n.month,day:n.day}),t=e.year,c=e.dayOfYear;let a=t+56;if(!qs[a])throw new Error(`Conversions are only possible between ${zf} and ${Nf} in Nepali calendar`);let h=9;const d=qs[a][0];let s=qs[a][h]-d+1;for(;c>s;){var f;h++,h>12&&(h=1,a++),s+=(f=qs[a])===null||f===void 0?void 0:f[h]}if(!qs[a])throw new Error(`Conversions are only possible between ${zf} and ${Nf} in Nepali calendar`);const b=qs[a][h]-(s-c);return{year:a,month:h,day:b}};function Iw(n){return`M${n.toString().padStart(2,"0")}`}const Cx={nepali:{calendar:new BI,locales:jI.nepali,defaultLocale:"en-NP"}},FI=/^(?:(\d{4})([-./])(\d{2})(\2)(\d{2})|(\d{2})([-./])(\d{2})(\7)(\d{4}))$/;function UI(n,e){const t=n.match(FI);if(!t)throw new Error(jt.t('Date string is invalid, received "{{dateString}}"',{dateString:n}));let c,a,h,d;t[1]?(c=t[1],a=t[3],h=t[5],d="YYYY-MM-DD"):(h=t[6],a=t[8],c=t[10],d="DD-MM-YYYY");const s=parseInt(c,10),f=parseInt(a,10),b=parseInt(h,10);return{year:s,month:f,day:b,format:d}}let gv;(function(n){n.INVALID_DATE_IN_CALENDAR="INVALID_DATE_IN_CALENDAR",n.WRONG_FORMAT="WRONG_FORMAT",n.LESS_THAN_MIN="LESS_THAN_MIN",n.MORE_THAN_MAX="INVALID_DATE_MORE_THAN_MAX"})(gv||(gv={}));const wl=n=>!!Cx[n],dl=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(n).padStart(e,"0")},To=(n,e,t)=>{var c;const a=(c=n.eraYear)!==null&&c!==void 0?c:n.year,h=dl(n.month);let d=n.day;e==="endOfMonth"?d=n.daysInMonth:e==="startOfMonth"&&(d=1);const s=dl(d);return t==="DD-MM-YYYY"?`${s}-${h}-${a}`:`${a}-${h}-${s}`},Dw=n=>{var e;if(!wl(n))return n;const c=(e=Cx[n])===null||e===void 0?void 0:e.calendar;if(!c)throw new Error(`No implemenation found for custom calendar ${n}`);return c},$I=["adlm","ahom","arab","arabext","armn","armnlow","bali","beng","bhks","brah","cakm","cham","cyrl","deva","ethi","finance","fullwide","geor","gong","gonm","grek","greklow","gujr","guru","hanidays","hanidec","hans","hansfin","hant","hantfin","hebr","hmng","hmnp","java","jpan","jpanfin","jpanyear","kali","khmr","knda","lana","lanatham","laoo","latn","lepc","limb","mathbold","mathdbl","mathmono","mathsanb","mathsans","mlym","modi","mong","mroo","mtei","mymr","mymrshan","mymrtlng","native","newa","nkoo","olck","orya","osma","rohg","roman","romanlow","saur","shrd","sind","sinh","sora","sund","takr","talu","taml","tamldec","telu","thai","tirh","tibt","traditio","vaii","wara","wcho"],GI=(n,e)=>{const t=Object.keys(n).find(c=>{var a,h;return((a=c.split("-"))===null||a===void 0||(h=a[0])===null||h===void 0?void 0:h.toLowerCase())===e});if(t)return n[t]},Sx=(n,e)=>{var t,c;const a=Cx[n];if(!a)return;const h=a.locales||{},d=(t=(c=e&&(h==null?void 0:h[e]))!==null&&c!==void 0?c:GI(h,e))!==null&&t!==void 0?t:h==null?void 0:h[a.defaultLocale];if(!d)throw new Error(`no localisation found for custom calendar ${n}. Requested locale: ${e}, Default locale ${a.defaultLocale}`);return d},VI=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{dateStyle:"full"};if(!e.calendar)throw new Error("no calendar provided to localise function");if(!n)throw new Error("a date must be provided to localiseDateLabel");const c=wl(e.calendar),a=n instanceof pn.ZonedDateTime?n==null?void 0:n.toPlainDate():n;return c?To(n):a.toLocaleString(e.locale,{calendar:e.calendar,dateStyle:t.dateStyle}).toString()},HI=(n,e)=>{var t;if(!e.calendar)throw new Error("no calendar provided to localise function");const c=wl(e.calendar),a=Sx(e.calendar,e.locale);return c?(a==null||(t=a.numbers)===null||t===void 0?void 0:t[n.day])||n.day:n.toPlainDate().toLocaleString(e.locale,{calendar:e.calendar,numberingSystem:$I.includes(e.numberingSystem)?e.numberingSystem:void 0,day:"numeric"})},WI=(n,e,t)=>{if(!e.calendar)throw new Error("no calendar provided to localise function");const c=wl(e.calendar),a=Sx(e.calendar,e.locale);return c?a==null?void 0:a.monthNames[n.month-1]:n.toLocaleString(e.locale,t)},YI=(n,e)=>{if(!e.calendar)throw new Error("no calendar provided to localise function");const t=wl(e.calendar),c=Sx(e.calendar,e.locale),a=c==null?void 0:c.dayNamesShort[n.dayOfWeek-1];return t&&a?a:n.toPlainDate().toLocaleString(e.locale,{weekday:e.weekDayFormat,calendar:e.calendar})},qI=(n,e,t)=>{if(!e.calendar)throw new Error("no calendar provided to localise function");return wl(e.calendar)?n.year:n.toPlainYearMonth().toLocaleString(e.locale,t)},gc={localiseYear:qI,localiseDateLabel:VI,localiseWeekLabel:HI,localiseMonth:WI,localiseWeekDayLabel:YI},Lw=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const[e,t,c]=n.replace(/_/g,"-").split("-");let a=e;c&&(a=`${a}-${c}`),t&&(a=`${a}-${t}`);try{const h=Intl.DateTimeFormat.supportedLocalesOf(a);return h&&h.length===1?a:void 0}catch{return}},XI=n=>{let{date:e,calendar:t}=n;const{year:c,month:a,day:h}=UI(e);return pn.PlainDate.from({year:c,month:a,day:h,calendar:t})},Ra=n=>{let{date:e,calendar:t}=n;if(typeof e=="string")return XI({date:e,calendar:t});if(e instanceof Date)return pn.PlainDate.from({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),calendar:t});if(e instanceof pn.PlainDate)return pn.PlainDate.from({year:e.year,month:e.month,day:e.day,calendar:t});throw new Error(jt.t('Unrecognized date, received "{{date}}"',{date:e}))},zn=["DAILY","WEEKLY","WEEKLYMON","WEEKLYTUE","WEEKLYWED","WEEKLYTHU","WEEKLYFRI","WEEKLYSAT","WEEKLYSUN","BIWEEKLY","MONTHLY","BIMONTHLY","QUARTERLY","QUARTERLYJAN","QUARTERLYFEB","QUARTERLYMAR","QUARTERLYAPR","QUARTERLYMAY","QUARTERLYJUN","QUARTERLYJUL","QUARTERLYAUG","QUARTERLYSEP","QUARTERLYOCT","QUARTERLYNOV","QUARTERLYDEC","SIXMONTHLY","SIXMONTHLYJAN","SIXMONTHLYFEB","SIXMONTHLYMAR","SIXMONTHLYAPR","SIXMONTHLYMAY","SIXMONTHLYJUN","SIXMONTHLYJUL","SIXMONTHLYAUG","SIXMONTHLYSEP","SIXMONTHLYOCT","SIXMONTHLYNOV","SIXMONTHLYDEC","YEARLY","FYJAN","FYFEB","FYMAR","FYAPR","FYMAY","FYJUN","FYJUL","FYAUG","FYSEP","FYOCT","FYNOV","FYDEC"],ZI=zn.filter(n=>n.match(/WEEKLY/)),Rw=zn.filter(n=>n.match(/MONTHLY|QUARTERLY|SIXMONTHLY/)),Bd=zn.filter(n=>n.match(/QUARTERLY/)),Fd=zn.filter(n=>n.match(/SIXMONTHLY/)),KI=["MONTHLY","BIMONTHLY","QUARTERLY","QUARTERLYJAN","SIXMONTHLY","SIXMONTHLYJAN"],QI=zn.filter(n=>n.match(/(QUARTERLY|SIXMONTHLY)[A-Z]/)),Ow=Rw.filter(n=>n!=="MONTHLY"),JI=zn.filter(n=>n.match(/^(YEARLY|FY[A-Z]{3})/)),eD=zn.filter(n=>n.match(/^FY[A-Z]{3}$/));[...KI,...zn.filter(n=>n.match(/JAN$/))];const tD=zn.filter(n=>n.match(/FEB$/)),iD=zn.filter(n=>n.match(/MAR$/)),rD=zn.filter(n=>n.match(/APR$/)),nD=zn.filter(n=>n.match(/MAY$/)),sD=zn.filter(n=>n.match(/JUN$/)),oD=zn.filter(n=>n.match(/JUL$/)),aD=zn.filter(n=>n.match(/AUG$/)),lD=zn.filter(n=>n.match(/SEP$/)),cD=zn.filter(n=>n.match(/OCT$/)),hD=zn.filter(n=>n.match(/NOV$/)),uD=zn.filter(n=>n.match(/DEC/)),{localiseDateLabel:dD}=gc,zw=n=>{let{date:e,calendar:t,locale:c}=n;const a=e.year,h=String(e.month).padStart(2,"0"),d=String(e.day).padStart(2,"0"),s=`${a}${h}${d}`,f=dD(e,{calendar:t,locale:c},{dateStyle:"long"});return{periodType:"DAILY",id:s,iso:s,displayName:f,name:To(e),startDate:To(e),endDate:To(e)}},pD=n=>{let{year:e,calendar:t,endsBefore:c,locale:a}=n;const h=c?Ra({calendar:t,date:c}):null,d=pn.PlainDate.from({year:e,month:1,day:1,calendar:t}),s=[];for(let f=0;f<d.daysInYear;f++){const b=d.add({days:f});if(h&&pn.PlainDate.compare(b,h)>-1)break;const x=zw({date:b,calendar:t,locale:a});s.push(x)}return s},Lh=n=>tD.includes(n)?"FEB":iD.includes(n)?"MAR":rD.includes(n)?"APR":nD.includes(n)?"MAY":sD.includes(n)?"JUN":oD.includes(n)?"JUL":aD.includes(n)?"AUG":lD.includes(n)?"SEP":cD.includes(n)?"OCT":hD.includes(n)?"NOV":uD.includes(n)?"DEC":"JAN",ia={JAN:{value:1,name:"January"},FEB:{value:2,name:"February"},MAR:{value:3,name:"March"},APR:{value:4,name:"April"},MAY:{value:5,name:"May"},JUN:{value:6,name:"June"},JUL:{value:7,name:"July"},AUG:{value:8,name:"August"},SEP:{value:9,name:"September"},OCT:{value:10,name:"October"},NOV:{value:11,name:"November"},DEC:{value:12,name:"December"}},fD=n=>{let{periodType:e,month:t,year:c,calendar:a,locale:h}=n;const d=bD({periodType:e,month:t.month,monthsInYear:t.monthsInYear}),s=gD(e),f=t.add({months:s}),b=mD({periodType:e,currentMonth:t,year:c,index:d});t.calendar==="ethiopic"&&console.warn("todo: confirm the special cases for the 13th month with Abyot, then update the start/end dates for Ethiopic calendar");const x=pn.PlainDate.from({year:f.year,month:f.month,day:1,calendar:f.calendar}).subtract({days:1}),v=yD({periodType:e,month:t,locale:h,calendar:a,nextMonth:f.subtract({months:1}),index:d});return{periodType:e,id:b,iso:b,name:v,displayName:v,startDate:To(t,"startOfMonth"),endDate:To(x,"endOfMonth")}},mD=n=>{let{periodType:e,currentMonth:t,year:c,index:a}=n;if(e==="BIMONTHLY")return`${c}${dl(a)}B`;if(e==="QUARTERLY")return`${c}Q${a}`;if(e==="SIXMONTHLY")return`${c}S${a}`;if(Bd.includes(e)){const h=ia[Lh(e)].name;return`${c}${h}Q${a}`}if(Fd.includes(e)){const h=ia[Lh(e)].name;return`${c}${h}S${a}`}return`${c}${dl(t.month)}`},gD=n=>{if(Fd.includes(n))return 6;if(Bd.includes(n))return 3;if(n==="MONTHLY")return 1;if(n==="BIMONTHLY")return 2;throw new Error(`unrecognised monthly period type ${n}`)},yD=n=>{const{periodType:e,month:t,nextMonth:c,calendar:a,locale:h}=n;if(wl(a))return xD(n);const d={month:"long",year:"numeric",calendar:a},s={month:"long",calendar:a};let f="";if(Ow.includes(e)){const b=t.year===c.year?s:d;f=`${t.toLocaleString(h,b)} - ${c.toLocaleString(h,d)}`}else f=`${t.toLocaleString(h,d)}`;return f=f.replace(/ERA\d+\s*/g,"").trim(),f},xD=n=>{let{periodType:e,month:t,nextMonth:c,calendar:a,locale:h}=n,d="";if(Ow.includes(e)){const s=t.year!==c.year;d=`${gc.localiseMonth(t,{locale:h,calendar:a},{})}${s?` ${t.year}`:""} - ${gc.localiseMonth(c,{locale:h,calendar:a},{})} ${c.year}`}else d=`${gc.localiseMonth(t,{locale:h,calendar:a},{})} ${c.year}`;return d},bD=n=>{let{periodType:e,month:t,monthsInYear:c}=n;if(e==="MONTHLY")return t;if(e==="BIMONTHLY"){if(t%2===0)throw new Error(`Even numbers can't be a month for BIMONTHLY period type, received "${t}"`);return Math.ceil(t/2)}if(Bd.includes(e))return _D(e,t,c);if(Fd.includes(e))return vD(e,t,c);throw new Error(`Unrecognized period type "${e}"`)},Nw=(n,e)=>[...Array(e-n+1).fill(null).map((c,a)=>a+n),1,2,3,4,5,6,7,8,9,10,11,12].slice(0,12),jw=(n,e)=>{const t=[];for(let c=0;c<12;c+=e)t.push(n.slice(c,c+e));return t},vD=(n,e,t)=>{const c=Lh(n),a=ia[c].value,h=Nw(a,t);return jw(h,6)[1].includes(e)?2:1},_D=(n,e,t)=>{const c=Lh(n),a=ia[c].value,h=Nw(a,t),d=jw(h,3);return d[1].includes(e)?2:d[2].includes(e)?3:d[3].includes(e)?4:1},kx=n=>{let{period:e,date:t,calendar:c}=n;const a=Ra({calendar:c,date:e.startDate}),h=Ra({calendar:c,date:e.endDate}),d=pn.PlainDate.compare(t,a)<1,s=pn.PlainDate.compare(a,t)===-1,f=pn.PlainDate.compare(t,h)<1;return d||s&&f},wD=n=>{let{year:e,calendar:t,periodType:c,endsBefore:a,locale:h}=n,d=pn.PlainDate.from({year:e,month:ED(c),day:t.toString()==="nepali"?14:1,calendar:t});const s=[];for(;d.year===e||CD(c,s.length);){const f=SD({periodType:c,currentMonth:d.month,year:e,calendar:t});if(!TD(t,d)){const v=fD({periodType:c,month:d,year:e,calendar:t,locale:h});if(a&&kx({period:v,date:a,calendar:t}))break;s.push(v)}const x=d.add({months:f});d=Ra({date:x,calendar:t})}return s},TD=(n,e)=>n==="ethiopic"&&e.month===13,ED=n=>{if(QI.includes(n)){const e=Lh(n);return ia[e].value}return 1},CD=(n,e)=>Fd.includes(n)?e<2:Bd.includes(n)?e<4:!1,SD=n=>{let{periodType:e}=n;if(Fd.includes(e))return 6;if(Bd.includes(e))return 3;if(e==="MONTHLY")return 1;if(e==="BIMONTHLY")return 2;throw new Error(`unrecognised monthly period type ${e}`)},tl={Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6,Sunday:7},kD=n=>{let{year:e,calendar:t,periodType:c,startingDay:a,endsBefore:h}=n;const d=MD(c,a);let s=AD({year:e,calendar:t,periodType:c,startingDay:d});const f=[];let b=1;const x=c==="BIWEEKLY"?13:6;do{const v=s.add({days:x});if(h&&kx({period:{startDate:To(s),endDate:To(v)},date:h,calendar:t}))break;const g=ID({periodType:c,startingDay:d,year:e,weekIndex:b});if(!(v.year===e+1&&v.day>=4)){const P=DD({periodType:c,date:s,nextWeek:v,weekIndex:b});f.push({periodType:c,id:g,iso:g,name:P,displayName:P,startDate:To(s),endDate:To(v)})}s=Ra({date:v,calendar:t}).add({days:1}),b++}while(s.year===e);return f},MD=(n,e)=>{switch(n){case"WEEKLYMON":return tl.Monday;case"WEEKLYTUE":return tl.Tuesday;case"WEEKLYWED":return tl.Wednesday;case"WEEKLYTHU":return tl.Thursday;case"WEEKLYFRI":return tl.Friday;case"WEEKLYSAT":return tl.Saturday;case"WEEKLYSUN":return tl.Sunday;case"WEEKLY":case"BIWEEKLY":default:return e||tl.Monday}},AD=n=>{const{year:e,calendar:t,startingDay:c}=n,a=pn.PlainDate.from({year:e,month:1,day:4,calendar:t}),h=a.dayOfWeek-c;return h>0?a.subtract({days:h}):h<0?a.subtract({days:h+7}):a},PD={1:"",2:"Tue",3:"Wed",4:"Thu",5:"Fri",6:"Sat",7:"Sun"},ID=n=>{let{startingDay:e,periodType:t,year:c,weekIndex:a}=n;const h=t==="BIWEEKLY"?"BiW":"W";return`${c}${PD[e]}${h}${a}`},DD=n=>{let{periodType:e,date:t,nextWeek:c,weekIndex:a}=n;const{year:h,month:d,day:s}=t,{year:f,month:b,day:x}=c;return`${e==="BIWEEKLY"?jt.t("Bi-Week"):jt.t("Week")} ${a} - ${h}-${dl(d)}-${dl(s)} - ${f}-${dl(b)}-${dl(x)}`},Bw=n=>{if(n==="YEARLY")return 1;const e=Lh(n),t=ia[e];return(t==null?void 0:t.value)||1},Fw={1:"",2:"Feb",3:"March",4:"April",5:"May",6:"Jun",7:"July",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},Uw=n=>{let{periodType:e,year:t,locale:c,calendar:a}=n;const h=Bw(e),d=LD({periodType:e,year:t,month:h}),s=h.toString().padStart(2,"0"),f=Ra({date:`${t}-${s}-01`,calendar:a}),b=Ra({date:`${t+1}-${s}-01`,calendar:a}).subtract({days:1}),x=OD(e,f,{locale:c,calendar:a});return{periodType:e,id:d,iso:d,name:x,displayName:x,startDate:To(f,"startOfMonth"),endDate:To(b,"endOfMonth")}},LD=n=>{let{periodType:e,year:t,month:c}=n;if(e==="YEARLY")return t.toString();if(RD(e)){const a=Fw[c];return`${t}${a}`}throw new Error(`can not build value for unrecognised yearly type "${e}"`)},RD=n=>eD.includes(n),OD=(n,e,t)=>{if(n==="YEARLY")return e.year.toString();if(wl(t.calendar))return zD(e,t);const c={month:"long",year:"numeric",calendar:t.calendar},a=gc.localiseMonth(e,t,c),h=gc.localiseMonth(e.add({months:e.monthsInYear-1}),t,c);let d=`${a} - ${h}`;return d=d.replace(/ERA\d+\s*/g,"").trim(),d},zD=(n,e)=>{const t=h=>`${gc.localiseMonth(h,e,{})} ${h.year}`,c=pn.PlainDate.from({year:n.year+1,month:n.month-1,day:1,calendar:e.calendar});return`${t(n)} - ${t(c)}`},ND=n=>{let{year:e,calendar:t,periodType:c,endsBefore:a,yearsCount:h,locale:d}=n;const s=Bw(c),f=pn.PlainDate.from({year:e,month:s,day:t.toString()==="nepali"?14:1,calendar:t}),b=pn.PlainDate.from({day:1,month:1,year:1970,calendar:"gregory"}).withCalendar(t),x=b.eraYear||b.year,v=[],g=h??e-x+1;for(let P=0;P<g;P++){const _=f.year-P,S=Uw({periodType:c,year:_,locale:d,calendar:t});a&&kx({period:S,date:a,calendar:t})||v.push(S)}return v},Qp=n=>{var e,t;let{periodType:c,year:a,endsBefore:h,calendar:d,locale:s="en",yearsCount:f=10,startingDay:b=1}=n,x;if(typeof a=="number")x=a;else if(!isNaN(a)&&!isNaN(parseInt(a)))x=parseInt(a);else throw new Error("year must be a number");const v=Dw((e=Pw[d])!==null&&e!==void 0?e:d),g=(t=Lw(s))!==null&&t!==void 0?t:"en",P=h?Ra({calendar:v,date:h}):void 0;if(ZI.includes(c))return kD({year:x,periodType:c,calendar:v,startingDay:b,endsBefore:P});if(JI.includes(c))return ND({year:x,periodType:c,locale:g,calendar:v,endsBefore:P,yearsCount:f});if(Rw.includes(c))return wD({year:x,periodType:c,locale:g,calendar:v,endsBefore:P});if(c==="DAILY")return pD({year:x,locale:g,calendar:v,endsBefore:P});throw new Error(`can not generate period for unrecognised period type "${c}"`)},jD=new RegExp("^([0-9]{4})W([0-9]+)$"),BD=new RegExp("^([0-9]{4})BiW([0-9]+)$"),FD=new RegExp("^([0-9]{4})([A-Z][a-z]{2})W([0-9]+)$"),UD=new RegExp("^([0-9]{4})([0-9]{2})$"),$D=new RegExp("^([0-9]{4})([0-9]{2})B$"),GD=new RegExp("^([0-9]{4})Q([0-9])$"),VD=new RegExp("^([0-9]{4})([A-Z][a-z]+)Q([0-9])$"),HD=new RegExp("^([0-9]{4})S([0-9])$"),WD=new RegExp("^([0-9]{4})([A-Z][a-z]+)S([0-9])$"),YD=new RegExp("^([0-9]{4})$"),qD=new RegExp("^([0-9]{4})([A-Z][a-z]{2,})$"),XD=Object.values(Fw).slice(1).join("|"),ZD=new RegExp(`^[0-9]{4}(${XD})?$`),KD=n=>ZD.test(n),yv=Object.values(ia).map(n=>{let{name:e}=n;return e}).join("|"),QD=["^[0-9]{6}$","^[0-9]{6}B$",`^[0-9]{4}(${yv})?Q[0-9]$`,`^[0-9]{4}(${yv})?S[0-9]$`].join("|"),JD=new RegExp(QD),eL=n=>JD.test(n),tL=n=>/^[0-9]{4}([A-Z][a-z]{2}|Bi)?W[0-9]+$/.test(n),iL=n=>/^[0-9]{8}$/.test(n),rL=n=>{if(UD.test(n))return"MONTHLY";if($D.test(n))return"BIMONTHLY";if(GD.test(n))return"QUARTERLY";const e=n.match(VD);if(e){const c=e[2],a=Object.entries(ia).find(d=>{let[,{name:s}]=d;return s===c});if(!a)throw new Error("@TODO");const[h]=a;return`QUARTERLY${h}`}if(HD.test(n))return"SIXMONTHLY";const t=n.match(WD);if(t){const c=t[2],a=Object.entries(ia).find(d=>{let[,{name:s}]=d;return s===c});if(!a)throw new Error("@TODO");const[h]=a;return`SIXMONTHLY${h}`}throw new Error(jt.t('Could not find a period type for period id "{{periodId}}"',{periodId:n}))},nL=n=>{if(jD.test(n))return"WEEKLY";if(BD.test(n))return"BIWEEKLY";const e=n.match(FD);if(e){const[,,t]=e,c=`WEEKLY${t.toUpperCase()}`;if(!zn.includes(c))throw new Error(jt.t('Could not determine a period type for period id "{{periodId}}"',{periodId:n}));return c}throw new Error(jt.t(`Couldn't find a period type for weekly period id "{{periodId}}"`,{periodId:n}))},sL=n=>{if(YD.test(n))return"YEARLY";const e=n.match(qD);if(e){const t=e[2].slice(0,3),c=Object.entries(ia).find(h=>{let[,{name:d}]=h;return d.startsWith(t)});if(!c)throw new Error("@TODO");const[a]=c;return`FY${a}`}throw new Error(jt.t('Could not find a period type for period id "{{periodId}}"',{periodId:n}))},Mx=n=>{var e,t;let{periodId:c,calendar:a,locale:h="en"}=n;const d=Dw((e=Pw[a])!==null&&e!==void 0?e:a),s=(t=Lw(h))!==null&&t!==void 0?t:"en";if(KD(c)){const f=parseInt(c.substring(0,4),10),b=sL(c);return Uw({year:f,periodType:b,calendar:d,locale:h})}if(eL(c)){const f=rL(c),b=parseInt(c.substring(0,4),10),v=Qp({periodType:f,year:b,calendar:d,locale:s}).find(_=>{let{id:S}=_;return S===c});if(v)return v;const P=Qp({year:b+1,periodType:f,calendar:d,locale:s}).slice(-1).find(_=>{let{id:S}=_;return S===c});if(!P)throw new Error(jt.t(`Couldn't find a monthly period for weekly period id "{{periodId}}"`,{periodId:c}));return P}if(tL(c)){const f=parseInt(c.substring(0,4),10),b=nL(c),v=Qp({year:f,periodType:b,calendar:d,locale:h}).find(P=>{let{id:_}=P;return _===c});if(v)return v;const[g]=Qp({year:f-1,periodType:b,calendar:d,locale:h}).slice(-1);if(g.id===c)return g;throw new Error(jt.t(`Couldn't find a weekly period for weekly period id "{{periodId}}"`,{periodId:c}))}if(iL(c)){const f=c.substring(0,4),b=c.substring(4,6),x=c.substring(6),v=Ra({date:`${f}-${b}-${x}`,calendar:d});return zw({date:v,locale:h,calendar:d})}throw new Error(jt.t(`Couldn't handle unknown period id "{{periodId}}"`,{periodId:c}))};N3(kc);U3(kc);B3(kc);const xv=(n,e)=>{kc.getOptions().colors;const t=n.filter(a=>a.dataElement==="median").map(a=>[a.period,a.value]),c=n.filter(a=>a.dataElement==="quantile_low").map(a=>[a.period,a.value,n.filter(h=>h.dataElement==="quantile_high"&&h.period===a.period)[0].value]);return{title:{text:jt.t("Prediction for {{predictionTargetName}} for {{orgUnitName}}",{predictionTargetName:e,orgUnitName:n[0].displayName})},tooltip:{shared:!0},xAxis:{type:"category",labels:{enabled:!0,formatter:function(){return Mx({periodId:this.value.toString(),calendar:"gregory"}).displayName},style:{fontSize:"0.9rem"}}},yAxis:{title:{text:"Number of cases"}},credits:{text:"CHAP"},chart:{height:490,marginBottom:125},plotOptions:{series:{lineWidth:5}},series:[{type:"line",data:t,name:jt.t("Quantile median"),color:"#004bbd",zIndex:2},{type:"arearange",name:jt.t("Range"),data:c,zIndex:1,lineWidth:0,color:"#004bbd",fillOpacity:.4}]}};function oL(n){return[...new Set(n.map(t=>t.orgUnit))].map(t=>n.filter(c=>c.orgUnit===t))}const aL=({data:n,predictionTargetName:e})=>{const t=oL(n.dataValues),[c,a]=We.useState(xv(t[0],e)),[h,d]=We.useState(0),s=f=>{d(f),a(xv(t[f],e))};return He.createElement(He.Fragment,null,He.createElement("div",{className:Og.chartContainer},He.createElement("div",null,He.createElement(i1,{dense:!0},t.map((f,b)=>He.createElement(My,{className:Og.menu,active:h==b,key:b,label:f[0].displayName,onClick:()=>s(b)})))),He.createElement("div",{className:Og.chart},He.createElement(Aw,{highcharts:kc,constructorType:"chart",options:c}))))};class bv extends Error{constructor(e,t,c){super(c),this.name="ApiError",this.url=t.url,this.status=t.status,this.statusText=t.statusText,this.body=t.body,this.request=e}}var Ho=function(n,e,t,c,a){if(c==="m")throw new TypeError("Private method is not writable");if(c==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!a:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return c==="a"?a.call(n,t):a?a.value=t:e.set(n,t),t},Rr=function(n,e,t,c){if(t==="a"&&!c)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!c:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?c:t==="a"?c.call(n):c?c.value:e.get(n)},Ca,Sa,Wo,ic,bh,Qu,rc;class lL extends Error{constructor(e){super(e),this.name="CancelError"}get isCancelled(){return!0}}class cL{constructor(e){Ca.set(this,void 0),Sa.set(this,void 0),Wo.set(this,void 0),ic.set(this,void 0),bh.set(this,void 0),Qu.set(this,void 0),rc.set(this,void 0),Ho(this,Ca,!1,"f"),Ho(this,Sa,!1,"f"),Ho(this,Wo,!1,"f"),Ho(this,ic,[],"f"),Ho(this,bh,new Promise((t,c)=>{Ho(this,Qu,t,"f"),Ho(this,rc,c,"f");const a=s=>{Rr(this,Ca,"f")||Rr(this,Sa,"f")||Rr(this,Wo,"f")||(Ho(this,Ca,!0,"f"),Rr(this,Qu,"f")&&Rr(this,Qu,"f").call(this,s))},h=s=>{Rr(this,Ca,"f")||Rr(this,Sa,"f")||Rr(this,Wo,"f")||(Ho(this,Sa,!0,"f"),Rr(this,rc,"f")&&Rr(this,rc,"f").call(this,s))},d=s=>{Rr(this,Ca,"f")||Rr(this,Sa,"f")||Rr(this,Wo,"f")||Rr(this,ic,"f").push(s)};return Object.defineProperty(d,"isResolved",{get:()=>Rr(this,Ca,"f")}),Object.defineProperty(d,"isRejected",{get:()=>Rr(this,Sa,"f")}),Object.defineProperty(d,"isCancelled",{get:()=>Rr(this,Wo,"f")}),e(a,h,d)}),"f")}get[(Ca=new WeakMap,Sa=new WeakMap,Wo=new WeakMap,ic=new WeakMap,bh=new WeakMap,Qu=new WeakMap,rc=new WeakMap,Symbol.toStringTag)](){return"Cancellable Promise"}then(e,t){return Rr(this,bh,"f").then(e,t)}catch(e){return Rr(this,bh,"f").catch(e)}finally(e){return Rr(this,bh,"f").finally(e)}cancel(){if(!(Rr(this,Ca,"f")||Rr(this,Sa,"f")||Rr(this,Wo,"f"))){if(Ho(this,Wo,!0,"f"),Rr(this,ic,"f").length)try{for(const e of Rr(this,ic,"f"))e()}catch(e){console.warn("Cancellation threw an error",e);return}Rr(this,ic,"f").length=0,Rr(this,rc,"f")&&Rr(this,rc,"f").call(this,new lL("Request aborted"))}}get isCancelled(){return Rr(this,Wo,"f")}}const Ri={BASE:"/v1",VERSION:"0.1.0",WITH_CREDENTIALS:!1,CREDENTIALS:"include",TOKEN:void 0,USERNAME:void 0,PASSWORD:void 0,HEADERS:void 0,ENCODE_PATH:void 0};var vv;(function(n){n.WEEK="week",n.MONTH="month",n.ANY="any",n.YEAR="year"})(vv||(vv={}));var _v;(function(n){(function(e){e.STRING="string",e.INTEGER="integer",e.FLOAT="float",e.BOOLEAN="boolean"})(n.type||(n.type={}))})(_v||(_v={}));const Ax=n=>n!=null,Ud=n=>typeof n=="string",jg=n=>Ud(n)&&n!=="",Px=n=>typeof n=="object"&&typeof n.type=="string"&&typeof n.stream=="function"&&typeof n.arrayBuffer=="function"&&typeof n.constructor=="function"&&typeof n.constructor.name=="string"&&/^(Blob|File)$/.test(n.constructor.name)&&/^(Blob|File)$/.test(n[Symbol.toStringTag]),$w=n=>n instanceof FormData,hL=n=>{try{return btoa(n)}catch{return Buffer.from(n).toString("base64")}},uL=n=>{const e=[],t=(a,h)=>{e.push(`${encodeURIComponent(a)}=${encodeURIComponent(String(h))}`)},c=(a,h)=>{Ax(h)&&(Array.isArray(h)?h.forEach(d=>{c(a,d)}):typeof h=="object"?Object.entries(h).forEach(([d,s])=>{c(`${a}[${d}]`,s)}):t(a,h))};return Object.entries(n).forEach(([a,h])=>{c(a,h)}),e.length>0?`?${e.join("&")}`:""},dL=(n,e)=>{const t=encodeURI,c=e.url.replace("{api-version}",n.VERSION).replace(/{(.*?)}/g,(h,d)=>{var s;return(s=e.path)!=null&&s.hasOwnProperty(d)?t(String(e.path[d])):h}),a=`${n.BASE}${c}`;return e.query?`${a}${uL(e.query)}`:a},pL=n=>{if(n.formData){const e=new FormData,t=(c,a)=>{Ud(a)||Px(a)?e.append(c,a):e.append(c,JSON.stringify(a))};return Object.entries(n.formData).filter(([c,a])=>Ax(a)).forEach(([c,a])=>{Array.isArray(a)?a.forEach(h=>t(c,h)):t(c,a)}),e}},Jp=async(n,e)=>e,fL=async(n,e)=>{const[t,c,a,h]=await Promise.all([Jp(e,n.TOKEN),Jp(e,n.USERNAME),Jp(e,n.PASSWORD),Jp(e,n.HEADERS)]),d=Object.entries({Accept:"application/json",...h,...e.headers}).filter(([s,f])=>Ax(f)).reduce((s,[f,b])=>({...s,[f]:String(b)}),{});if(jg(t)&&(d.Authorization=`Bearer ${t}`),jg(c)&&jg(a)){const s=hL(`${c}:${a}`);d.Authorization=`Basic ${s}`}return e.body!==void 0&&(e.mediaType?d["Content-Type"]=e.mediaType:Px(e.body)?d["Content-Type"]=e.body.type||"application/octet-stream":Ud(e.body)?d["Content-Type"]="text/plain":$w(e.body)||(d["Content-Type"]="application/json")),new Headers(d)},mL=n=>{var e;if(n.body!==void 0)return(e=n.mediaType)!=null&&e.includes("/json")?JSON.stringify(n.body):Ud(n.body)||Px(n.body)||$w(n.body)?n.body:JSON.stringify(n.body)},gL=async(n,e,t,c,a,h,d)=>{const s=new AbortController,f={headers:h,body:c??a,method:e.method,signal:s.signal};return n.WITH_CREDENTIALS&&(f.credentials=n.CREDENTIALS),d(()=>s.abort()),await fetch(t,f)},yL=(n,e)=>{if(e){const t=n.headers.get(e);if(Ud(t))return t}},xL=async n=>{if(n.status!==204)try{const e=n.headers.get("Content-Type");if(e)return["application/json","application/problem+json"].some(a=>e.toLowerCase().startsWith(a))?await n.json():await n.text()}catch(e){console.error(e)}},bL=(n,e)=>{const c={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...n.errors}[e.status];if(c)throw new bv(n,e,c);if(!e.ok){const a=e.status??"unknown",h=e.statusText??"unknown",d=(()=>{try{return JSON.stringify(e.body,null,2)}catch{return}})();throw new bv(n,e,`Generic Error: status: ${a}; status text: ${h}; body: ${d}`)}},qi=(n,e)=>new cL(async(t,c,a)=>{try{const h=dL(n,e),d=pL(e),s=mL(e),f=await fL(n,e);if(!a.isCancelled){const b=await gL(n,e,h,s,d,f,a),x=await xL(b),v=yL(b,e.responseHeader),g={url:h,ok:b.ok,status:b.status,statusText:b.statusText,body:v??x};bL(e,g),t(g.body)}}catch(h){c(h)}});class Rh{static makeDatasetAnalyticsMakeDatasetPost(e){return qi(Ri,{method:"POST",url:"/analytics/make-dataset",body:e,mediaType:"application/json",errors:{422:"Validation Error"}})}static getEvaluationEntriesAnalyticsEvaluationEntryGet(e,t){return qi(Ri,{method:"GET",url:"/analytics/evaluation-entry",query:{backtestId:e,quantiles:t},errors:{422:"Validation Error"}})}static createBacktestAnalyticsCreateBacktestPost(e){return qi(Ri,{method:"POST",url:"/analytics/create-backtest",body:e,mediaType:"application/json",errors:{422:"Validation Error"}})}static makePredictionAnalyticsMakePredictionPost(e){return qi(Ri,{method:"POST",url:"/analytics/make-prediction",body:e,mediaType:"application/json",errors:{422:"Validation Error"}})}static getPredictionEntriesAnalyticsPredictionEntryPredictionIdGet(e,t){return qi(Ri,{method:"GET",url:"/analytics/prediction-entry/{predictionId}",path:{predictionId:e},query:{quantiles:t},errors:{422:"Validation Error"}})}static getActualCasesAnalyticsActualCasesBacktestIdGet(e){return qi(Ri,{method:"GET",url:"/analytics/actualCases/{backtestId}",path:{backtestId:e},errors:{422:"Validation Error"}})}static getDataSourcesAnalyticsDataSourcesGet(){return qi(Ri,{method:"GET",url:"/analytics/data-sources"})}}class Ro{static getBacktestsCrudBacktestsGet(){return qi(Ri,{method:"GET",url:"/crud/backtests"})}static createBacktestCrudBacktestsPost(e){return qi(Ri,{method:"POST",url:"/crud/backtests",body:e,mediaType:"application/json",errors:{422:"Validation Error"}})}static getBacktestCrudBacktestsBacktestIdGet(e){return qi(Ri,{method:"GET",url:"/crud/backtests/{backtestId}",path:{backtestId:e},errors:{422:"Validation Error"}})}static deleteBacktestCrudBacktestsBacktestIdDelete(e){return qi(Ri,{method:"DELETE",url:"/crud/backtests/{backtestId}",path:{backtestId:e},errors:{422:"Validation Error"}})}static getPredictionsCrudPredictionsGet(){return qi(Ri,{method:"GET",url:"/crud/predictions"})}static createPredictionCrudPredictionsPost(e){return qi(Ri,{method:"POST",url:"/crud/predictions",body:e,mediaType:"application/json",errors:{422:"Validation Error"}})}static getPredictionCrudPredictionsPredictionIdGet(e){return qi(Ri,{method:"GET",url:"/crud/predictions/{predictionId}",path:{predictionId:e},errors:{422:"Validation Error"}})}static deletePredictionCrudPredictionsPredictionIdDelete(e){return qi(Ri,{method:"DELETE",url:"/crud/predictions/{predictionId}",path:{predictionId:e},errors:{422:"Validation Error"}})}static getDatasetsCrudDatasetsGet(){return qi(Ri,{method:"GET",url:"/crud/datasets"})}static createDatasetCrudDatasetsPost(e){return qi(Ri,{method:"POST",url:"/crud/datasets",body:e,mediaType:"application/json",errors:{422:"Validation Error"}})}static getDatasetCrudDatasetsDatasetIdGet(e){return qi(Ri,{method:"GET",url:"/crud/datasets/{datasetId}",path:{datasetId:e},errors:{422:"Validation Error"}})}static deleteDatasetCrudDatasetsDatasetIdDelete(e){return qi(Ri,{method:"DELETE",url:"/crud/datasets/{datasetId}",path:{datasetId:e},errors:{422:"Validation Error"}})}static createDatasetCsvCrudDatasetsCsvFilePost(e){return qi(Ri,{method:"POST",url:"/crud/datasets/csvFile",formData:e,mediaType:"multipart/form-data",errors:{422:"Validation Error"}})}static listModelsCrudModelsGet(){return qi(Ri,{method:"GET",url:"/crud/models"})}static listModelsFromModelTemplatesCrudModelsFromModelTemplatesGet(){return qi(Ri,{method:"GET",url:"/crud/models-from-model-templates"})}static listModelTemplatesCrudModelTemplatesGet(){return qi(Ri,{method:"GET",url:"/crud/modelTemplates"})}static debugEntryCrudDebugPost(){return qi(Ri,{method:"POST",url:"/crud/debug"})}static getDebugEntryCrudDebugDebugIdGet(e){return qi(Ri,{method:"GET",url:"/crud/debug/{debugId}",path:{debugId:e},errors:{422:"Validation Error"}})}static listFeatureTypesCrudFeatureSourcesGet(){return qi(Ri,{method:"GET",url:"/crud/feature-sources"})}}class vL{static faviconfaviconIcoGet(){return qi(Ri,{method:"GET",url:"favicon.ico"})}static predictPredictPost(e){return qi(Ri,{method:"POST",url:"/predict",body:e,mediaType:"application/json",errors:{422:"Validation Error"}})}static evaluateEvaluatePost(e,t,c=1){return qi(Ri,{method:"POST",url:"/evaluate",query:{n_splits:t,stride:c},body:e,mediaType:"application/json",errors:{422:"Validation Error"}})}static listModelsListModelsGet(){return qi(Ri,{method:"GET",url:"/list-models"})}static listModelTemplatesListModelTemplatesGet(){return qi(Ri,{method:"GET",url:"/list-model-templates"})}static listFeaturesListFeaturesGet(){return qi(Ri,{method:"GET",url:"/list-features"})}static getResultsGetResultsGet(){return qi(Ri,{method:"GET",url:"/get-results"})}static getEvaluationResultsGetEvaluationResultsGet(){return qi(Ri,{method:"GET",url:"/get-evaluation-results"})}static getExceptionGetExceptionGet(){return qi(Ri,{method:"GET",url:"/get-exception"})}static cancelCancelPost(){return qi(Ri,{method:"POST",url:"/cancel"})}static getStatusStatusGet(){return qi(Ri,{method:"GET",url:"/status"})}static healthHealthGet(){return qi(Ri,{method:"GET",url:"/health"})}static versionVersionGet(){return qi(Ri,{method:"GET",url:"/version"})}static isCompatibleIsCompatibleGet(e){return qi(Ri,{method:"GET",url:"/is-compatible",query:{modelling_app_version:e},errors:{422:"Validation Error"}})}static systemInfoSystemInfoGet(){return qi(Ri,{method:"GET",url:"/system-info"})}}class Ix{static listJobsJobsGet(){return qi(Ri,{method:"GET",url:"/jobs"})}static getJobStatusJobsJobIdGet(e){return qi(Ri,{method:"GET",url:"/jobs/{job_id}",path:{job_id:e},errors:{422:"Validation Error"}})}static deleteJobJobsJobIdDelete(e){return qi(Ri,{method:"DELETE",url:"/jobs/{job_id}",path:{job_id:e},errors:{422:"Validation Error"}})}static getLogsJobsJobIdLogsGet(e){return qi(Ri,{method:"GET",url:"/jobs/{job_id}/logs",path:{job_id:e},errors:{422:"Validation Error"}})}static getPredictionResultJobsJobIdPredictionResultGet(e){return qi(Ri,{method:"GET",url:"/jobs/{job_id}/prediction_result",path:{job_id:e},errors:{422:"Validation Error"}})}static getEvaluationResultJobsJobIdEvaluationResultGet(e){return qi(Ri,{method:"GET",url:"/jobs/{job_id}/evaluation_result",path:{job_id:e},errors:{422:"Validation Error"}})}static getDatabaseResultJobsJobIdDatabaseResultGet(e){return qi(Ri,{method:"GET",url:"/jobs/{job_id}/database_result",path:{job_id:e},errors:{422:"Validation Error"}})}}function Gw(n,e){const t=c=>{if(c.includes("W")){const[a,h]=c.split("W").map(Number),d=new Date(a,0,1),s=(h-1)*7;return new Date(d.setDate(d.getDate()+s))}else{const a=Number(c.slice(0,4)),h=Number(c.slice(4,6))-1;return new Date(a,h)}};return t(n).getTime()-t(e).getTime()}function _L(n,e){var g;const t=e.map(P=>P.pe).sort(Gw),c=t.map(P=>{var _;return((_=e.find(S=>S.pe===P))==null?void 0:_.value)??null}),a=(P,_)=>{if(!_)return new Map;const S=new Map;for(let k=0;k<P.length;k++)S.set(P[k],_[k]);return S},h=a(n.periods,n.averages.slice()),d=a(n.periods,n.ranges.slice()),s=a(n.periods,(g=n.midranges)==null?void 0:g.slice()),f=(P,_)=>P.map(S=>_.get(S)??null),b=f(t,h),x=f(t,d),v=f(t,s);return{periods:t,ranges:x,averages:b,realValues:c,midranges:v}}const wL=(n,e,t)=>{const c=Array.from(new Set(n.map(x=>x.quantile))).sort(),a=c[0],h=c[1],d=c[c.length-2],s=c[c.length-1],f=x=>x.quantile===a?"quantile_low":x.quantile===s?"quantile_high":x.quantile===.5?"median":x.quantile===h?"quantile_mid_low":x.quantile===d?"quantile_mid_high":"unknown",b=Array.from(new Set(n.map(x=>x.modelName||t)));return Array.from(new Set(n.map(x=>x.splitPeriod))).map(x=>({splitPoint:x,evaluation:Array.from(new Set(n.map(v=>v.orgUnit))).map(v=>({orgUnitName:v,orgUnitId:v,models:b.map(g=>{const P=TL(n.filter(S=>S.orgUnit===v&&S.splitPeriod===x&&((S==null?void 0:S.modelName)||t)===g),f),_=_L(P,e.filter(S=>S.ou===v));return{modelName:g,data:_}})}))}))};function TL(n,e){const t=Array.from(new Set(n.map(s=>s.period))).sort(Gw),c=[],a=[],h=[];return t.forEach(s=>{var P,_,S,k,A;const f=((P=n.find(y=>y.period===s&&e(y)==="quantile_low"))==null?void 0:P.value)||0,b=((_=n.find(y=>y.period===s&&e(y)==="quantile_high"))==null?void 0:_.value)||0,x=((S=n.find(y=>y.period===s&&e(y)==="median"))==null?void 0:S.value)||0,v=((k=n.find(y=>y.period===s&&e(y)==="quantile_mid_high"))==null?void 0:k.value)||0,g=((A=n.find(y=>y.period===s&&e(y)==="quantile_mid_low"))==null?void 0:A.value)||0;c.push([f,b]),a.push([x]),h.push([g,v])}),{periods:t,ranges:c,averages:a,midranges:h}}function EL(n){return Array.from(new Set(n.map(e=>e.splitPeriod)))}const CL=n=>{const{enabled:e,wrapperClassName:t,children:c,...a}=n;return e?He.createElement(Vf,{...a},({onMouseOver:h,onMouseOut:d,ref:s})=>He.createElement("span",{className:t,ref:f=>{f&&(f.onpointerenter=h,f.onpointerleave=d,s.current=f)}},c)):c},Vw=n=>{if(!n)return"NA";if(n.length==4)return n;if(n.length==6){const e=n.slice(0,4),t=n.slice(4,6);return`${["January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(t)-1]} ${e}`}if(n.length==5){const e=n.slice(0,4);return`Week ${n.slice(5,6)} ${e}`}};function SL(n){kc.charts.forEach(e=>{e&&e.xAxis[0].setExtremes(n.min,n.max)})}const kL=n=>[{name:"Real Cases",data:n.realValues,zIndex:4,lineWidth:2.5,type:"spline",color:"#f68000",marker:{enabled:!1,lineWidth:2}},{name:"Predicted Cases",type:"line",color:"#004bbd",data:n.averages.slice(),zIndex:3,opacity:1,lineWidth:2.5,marker:{enabled:!1}},{name:"Quantiles Outer",data:n.ranges.slice(),type:"arearange",lineWidth:0,color:"#c4dcf2",fillOpacity:1,zIndex:0,marker:{enabled:!1}},{name:"Quantiles Middle",data:n.midranges.slice(),type:"arearange",lineWidth:1,color:"#9bbdff",fillOpacity:1,zIndex:1,marker:{enabled:!1}}],ML=(n,e,t)=>({title:{text:""},subtitle:{text:e?"Model: "+e:"",align:"left"},chart:{zoomType:"x"},xAxis:{categories:n.periods,labels:{enabled:!0,formatter:function(){return Vw(this.value)},style:{fontSize:"0.9rem"}},events:t&&{afterSetExtremes:SL},title:{text:"Period"}},yAxis:{title:{text:null},min:0},tooltip:{crosshairs:!0,shared:!0,valueSuffix:" cases"},plotOptions:{series:{animation:{duration:0}}},series:kL(n)}),AL=({data:n,modelName:e,syncZoom:t})=>{const[c,a]=We.useState(!1);return We.useEffect(()=>{a(!0)},[n]),We.useEffect(()=>{c&&a(!1)},[c]),He.createElement(He.Fragment,null,!c&&He.createElement(Aw,{highcharts:kc,options:ML(n,e,t)}))},PL="_title_4ki8g_1",IL="_comparionBox_4ki8g_7",DL="_comparionBoxSideBySide_4ki8g_15",LL="_comparionBoxSideBySideItem_4ki8g_22",ef={title:PL,comparionBox:IL,comparionBoxSideBySide:DL,comparionBoxSideBySideItem:LL},wv=({orgUnitsData:n})=>He.createElement("div",{className:ef.comparionBox},He.createElement("div",{className:ef.title},n.orgUnitName),He.createElement("div",{className:ef.comparionBoxSideBySide},n.models.map((e,t)=>He.createElement("div",{key:t,className:ef.comparionBoxSideBySideItem},He.createElement(AL,{syncZoom:n.models.length>1,data:e.data,modelName:e.modelName}))))),dm=0,Tl=1,Wh=2,Hw=4;function Ww(n,e){return t=>n(e(t))}function RL(n,e){return e(n)}function Yw(n,e){return t=>n(e,t)}function Tv(n,e){return()=>n(e)}function pm(n,e){return e(n),n}function hn(...n){return n}function OL(n){n()}function Ev(n){return()=>n}function zL(...n){return()=>{n.map(OL)}}function Dx(n){return n!==void 0}function Yh(){}function Or(n,e){return n(Tl,e)}function cr(n,e){n(dm,e)}function Lx(n){n(Wh)}function _s(n){return n(Hw)}function Ii(n,e){return Or(n,Yw(e,dm))}function ra(n,e){const t=n(Tl,c=>{t(),e(c)});return t}function wr(){const n=[];return(e,t)=>{switch(e){case Wh:n.splice(0,n.length);return;case Tl:return n.push(t),()=>{const c=n.indexOf(t);c>-1&&n.splice(c,1)};case dm:n.slice().forEach(c=>{c(t)});return;default:throw new Error(`unrecognized action ${e}`)}}}function ai(n){let e=n;const t=wr();return(c,a)=>{switch(c){case Tl:a(e);break;case dm:e=a;break;case Hw:return e}return t(c,a)}}function NL(n){let e,t;const c=()=>e&&e();return function(a,h){switch(a){case Tl:return h?t===h?void 0:(c(),t=h,e=Or(n,h),e):(c(),Yh);case Wh:c(),t=null;return;default:throw new Error(`unrecognized action ${a}`)}}}function po(n){return pm(wr(),e=>Ii(n,e))}function Bs(n,e){return pm(ai(e),t=>Ii(n,t))}function jL(...n){return e=>n.reduceRight(RL,e)}function Ht(n,...e){const t=jL(...e);return(c,a)=>{switch(c){case Tl:return Or(n,t(a));case Wh:Lx(n);return}}}function qw(n,e){return n===e}function an(n=qw){let e;return t=>c=>{n(e,c)||(e=c,t(c))}}function Ki(n){return e=>t=>{n(t)&&e(t)}}function Ei(n){return e=>Ww(e,n)}function Xo(n){return e=>()=>e(n)}function Ko(n,e){return t=>c=>t(e=n(e,c))}function Oh(n){return e=>t=>{n>0?n--:e(t)}}function pl(n){let e=null,t;return c=>a=>{e=a,!t&&(t=setTimeout(()=>{t=void 0,c(e)},n))}}function Cv(n){let e,t;return c=>a=>{e=a,t&&clearTimeout(t),t=setTimeout(()=>{c(e)},n)}}function dr(...n){const e=new Array(n.length);let t=0,c=null;const a=Math.pow(2,n.length)-1;return n.forEach((h,d)=>{const s=Math.pow(2,d);Or(h,f=>{const b=t;t=t|s,e[d]=f,b!==a&&t===a&&c&&(c(),c=null)})}),h=>d=>{const s=()=>h([d].concat(e));t===a?s():c=s}}function Sv(...n){return function(e,t){switch(e){case Tl:return zL(...n.map(c=>Or(c,t)));case Wh:return;default:throw new Error(`unrecognized action ${e}`)}}}function ir(n,e=qw){return Ht(n,an(e))}function $n(...n){const e=wr(),t=new Array(n.length);let c=0;const a=Math.pow(2,n.length)-1;return n.forEach((h,d)=>{const s=Math.pow(2,d);Or(h,f=>{t[d]=f,c=c|s,c===a&&cr(e,t)})}),function(h,d){switch(h){case Tl:return c===a&&d(t),Or(e,d);case Wh:return Lx(e);default:throw new Error(`unrecognized action ${h}`)}}}function zr(n,e=[],{singleton:t}={singleton:!0}){return{id:BL(),constructor:n,dependencies:e,singleton:t}}const BL=()=>Symbol();function FL(n){const e=new Map,t=({id:c,constructor:a,dependencies:h,singleton:d})=>{if(d&&e.has(c))return e.get(c);const s=a(h.map(f=>t(f)));return d&&e.set(c,s),s};return t(n)}function UL(n,e){const t={},c={};let a=0;const h=n.length;for(;a<h;)c[n[a]]=1,a+=1;for(const d in e)c.hasOwnProperty(d)||(t[d]=e[d]);return t}const tf=typeof document<"u"?He.useLayoutEffect:He.useEffect;function Xw(n,e,t){const c=Object.keys(e.required||{}),a=Object.keys(e.optional||{}),h=Object.keys(e.methods||{}),d=Object.keys(e.events||{}),s=He.createContext({});function f(A,y){A.propsReady&&cr(A.propsReady,!1);for(const I of c){const D=A[e.required[I]];cr(D,y[I])}for(const I of a)if(I in y){const D=A[e.optional[I]];cr(D,y[I])}A.propsReady&&cr(A.propsReady,!0)}function b(A){return h.reduce((y,I)=>(y[I]=D=>{const w=A[e.methods[I]];cr(w,D)},y),{})}function x(A){return d.reduce((y,I)=>(y[I]=NL(A[e.events[I]]),y),{})}const v=He.forwardRef((A,y)=>{const{children:I,...D}=A,[w]=He.useState(()=>pm(FL(n),Y=>f(Y,D))),[M]=He.useState(Tv(x,w));tf(()=>{for(const Y of d)Y in D&&Or(M[Y],D[Y]);return()=>{Object.values(M).map(Lx)}},[D,M,w]),tf(()=>{f(w,D)}),He.useImperativeHandle(y,Ev(b(w)));const z=t;return ve.jsx(s.Provider,{value:w,children:t?ve.jsx(z,{...UL([...c,...a,...d],D),children:I}):I})}),g=A=>He.useCallback(Yw(cr,He.useContext(s)[A]),[A]),P=A=>{const I=He.useContext(s)[A],D=He.useCallback(w=>Or(I,w),[I]);return He.useSyncExternalStore(D,()=>_s(I),()=>_s(I))},_=A=>{const I=He.useContext(s)[A],[D,w]=He.useState(Tv(_s,I));return tf(()=>Or(I,M=>{M!==D&&w(Ev(M))}),[I,D]),D},S=He.version.startsWith("18")?P:_;return{Component:v,usePublisher:g,useEmitterValue:S,useEmitter:(A,y)=>{const D=He.useContext(s)[A];tf(()=>Or(D,y),[y,D])}}}const Zw=typeof document<"u"?He.useLayoutEffect:He.useEffect;var fo=(n=>(n[n.DEBUG=0]="DEBUG",n[n.INFO=1]="INFO",n[n.WARN=2]="WARN",n[n.ERROR=3]="ERROR",n))(fo||{});const $L={0:"debug",1:"log",2:"warn",3:"error"},GL=()=>typeof globalThis>"u"?window:globalThis,El=zr(()=>{const n=ai(3);return{log:ai((t,c,a=1)=>{var h;const d=(h=GL().VIRTUOSO_LOG_LEVEL)!=null?h:_s(n);a>=d&&console[$L[a]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",t,c)}),logLevel:n}},[],{singleton:!0});function Rx(n,e,t){const c=He.useRef(null);let a=h=>{};if(typeof ResizeObserver<"u"){const h=He.useMemo(()=>new ResizeObserver(d=>{const s=()=>{const f=d[0].target;f.offsetParent!==null&&n(f)};t?s():requestAnimationFrame(s)}),[n]);a=d=>{d&&e?(h.observe(d),c.current=d):(c.current&&h.unobserve(c.current),c.current=null)}}return{ref:c,callbackRef:a}}function Mc(n,e,t){return Rx(n,e,t).callbackRef}function VL(n,e,t,c,a,h,d,s,f){const b=He.useCallback(x=>{const v=HL(x.children,e,s?"offsetWidth":"offsetHeight",a);let g=x.parentElement;for(;!g.dataset.virtuosoScroller;)g=g.parentElement;const P=g.lastElementChild.dataset.viewportType==="window",_=d?s?d.scrollLeft:d.scrollTop:P?s?window.pageXOffset||document.documentElement.scrollLeft:window.pageYOffset||document.documentElement.scrollTop:s?g.scrollLeft:g.scrollTop,S=d?s?d.scrollWidth:d.scrollHeight:P?s?document.documentElement.scrollWidth:document.documentElement.scrollHeight:s?g.scrollWidth:g.scrollHeight,k=d?s?d.offsetWidth:d.offsetHeight:P?s?window.innerWidth:window.innerHeight:s?g.offsetWidth:g.offsetHeight;c({scrollTop:Math.max(_,0),scrollHeight:S,viewportHeight:k}),h==null||h(s?kv("column-gap",getComputedStyle(x).columnGap,a):kv("row-gap",getComputedStyle(x).rowGap,a)),v!==null&&n(v)},[n,e,a,h,d,c]);return Rx(b,t,f)}function HL(n,e,t,c){const a=n.length;if(a===0)return null;const h=[];for(let d=0;d<a;d++){const s=n.item(d);if(!s||s.dataset.index===void 0)continue;const f=parseInt(s.dataset.index),b=parseFloat(s.dataset.knownSize),x=e(s,t);if(x===0&&c("Zero-sized element, this should not happen",{child:s},fo.ERROR),x===b)continue;const v=h[h.length-1];h.length===0||v.size!==x||v.endIndex!==f-1?h.push({startIndex:f,endIndex:f,size:x}):h[h.length-1].endIndex++}return h}function kv(n,e,t){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&t(`${n} was not resolved to pixel value correctly`,e,fo.WARN),e==="normal"?0:parseInt(e??"0",10)}function _l(n,e){return Math.round(n.getBoundingClientRect()[e])}function Kw(n,e){return Math.abs(n-e)<1.01}function Qw(n,e,t,c=Yh,a,h){const d=He.useRef(null),s=He.useRef(null),f=He.useRef(null),b=He.useCallback(g=>{const P=g.target,_=P===window||P===document,S=h?_?window.pageXOffset||document.documentElement.scrollLeft:P.scrollLeft:_?window.pageYOffset||document.documentElement.scrollTop:P.scrollTop,k=h?_?document.documentElement.scrollWidth:P.scrollWidth:_?document.documentElement.scrollHeight:P.scrollHeight,A=h?_?window.innerWidth:P.offsetWidth:_?window.innerHeight:P.offsetHeight,y=()=>{n({scrollTop:Math.max(S,0),scrollHeight:k,viewportHeight:A})};g.suppressFlushSync?y():L2.flushSync(y),s.current!==null&&(S===s.current||S<=0||S===k-A)&&(s.current=null,e(!0),f.current&&(clearTimeout(f.current),f.current=null))},[n,e]);He.useEffect(()=>{const g=a||d.current;return c(a||d.current),b({target:g,suppressFlushSync:!0}),g.addEventListener("scroll",b,{passive:!0}),()=>{c(null),g.removeEventListener("scroll",b)}},[d,b,t,c,a]);function x(g){const P=d.current;if(!P||(h?"offsetWidth"in P&&P.offsetWidth===0:"offsetHeight"in P&&P.offsetHeight===0))return;const _=g.behavior==="smooth";let S,k,A;P===window?(k=Math.max(_l(document.documentElement,h?"width":"height"),h?document.documentElement.scrollWidth:document.documentElement.scrollHeight),S=h?window.innerWidth:window.innerHeight,A=h?document.documentElement.scrollLeft:document.documentElement.scrollTop):(k=P[h?"scrollWidth":"scrollHeight"],S=_l(P,h?"width":"height"),A=P[h?"scrollLeft":"scrollTop"]);const y=k-S;if(g.top=Math.ceil(Math.max(Math.min(y,g.top),0)),Kw(S,k)||g.top===A){n({scrollTop:A,scrollHeight:k,viewportHeight:S}),_&&e(!0);return}_?(s.current=g.top,f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{f.current=null,s.current=null,e(!0)},1e3)):s.current=null,h&&(g={left:g.top,behavior:g.behavior}),P.scrollTo(g)}function v(g){h&&(g={left:g.top,behavior:g.behavior}),d.current.scrollBy(g)}return{scrollerRef:d,scrollByCallback:v,scrollToCallback:x}}const Gs=zr(()=>{const n=wr(),e=wr(),t=ai(0),c=wr(),a=ai(0),h=wr(),d=wr(),s=ai(0),f=ai(0),b=ai(0),x=ai(0),v=wr(),g=wr(),P=ai(!1),_=ai(!1),S=ai(!1);return Ii(Ht(n,Ei(({scrollTop:k})=>k)),e),Ii(Ht(n,Ei(({scrollHeight:k})=>k)),d),Ii(e,a),{scrollContainerState:n,scrollTop:e,viewportHeight:h,headerHeight:s,fixedHeaderHeight:f,fixedFooterHeight:b,footerHeight:x,scrollHeight:d,smoothScrollTargetReached:c,horizontalDirection:_,skipAnimationFrameInResizeObserver:S,scrollTo:v,scrollBy:g,statefulScrollTop:a,deviation:t,scrollingInProgress:P}},[],{singleton:!0}),xd={lvl:0};function Jw(n,e,t,c=xd,a=xd){return{k:n,v:e,lvl:t,l:c,r:a}}function Wr(n){return n===xd}function kh(){return xd}function vy(n,e){if(Wr(n))return xd;const{k:t,l:c,r:a}=n;if(e===t){if(Wr(c))return a;if(Wr(a))return c;{const[h,d]=eT(c);return pf(Fn(n,{k:h,v:d,l:tT(c)}))}}else return e<t?pf(Fn(n,{l:vy(c,e)})):pf(Fn(n,{r:vy(a,e)}))}function bd(n,e){if(!Wr(n))return e===n.k?n.v:e<n.k?bd(n.l,e):bd(n.r,e)}function No(n,e,t="k"){if(Wr(n))return[-1/0,void 0];if(Number(n[t])===e)return[n.k,n.v];if(Number(n[t])<e){const c=No(n.r,e,t);return c[0]===-1/0?[n.k,n.v]:c}return No(n.l,e,t)}function co(n,e,t){return Wr(n)?Jw(e,t,1):e===n.k?Fn(n,{k:e,v:t}):e<n.k?Mv(Fn(n,{l:co(n.l,e,t)})):Mv(Fn(n,{r:co(n.r,e,t)}))}function _y(n,e,t){if(Wr(n))return[];const{k:c,v:a,l:h,r:d}=n;let s=[];return c>e&&(s=s.concat(_y(h,e,t))),c>=e&&c<=t&&s.push({k:c,v:a}),c<=t&&(s=s.concat(_y(d,e,t))),s}function hc(n){return Wr(n)?[]:[...hc(n.l),{k:n.k,v:n.v},...hc(n.r)]}function eT(n){return Wr(n.r)?[n.k,n.v]:eT(n.r)}function tT(n){return Wr(n.r)?n.l:pf(Fn(n,{r:tT(n.r)}))}function Fn(n,e){return Jw(e.k!==void 0?e.k:n.k,e.v!==void 0?e.v:n.v,e.lvl!==void 0?e.lvl:n.lvl,e.l!==void 0?e.l:n.l,e.r!==void 0?e.r:n.r)}function Bg(n){return Wr(n)||n.lvl>n.r.lvl}function Mv(n){return wy(rT(n))}function pf(n){const{l:e,r:t,lvl:c}=n;if(t.lvl>=c-1&&e.lvl>=c-1)return n;if(c>t.lvl+1){if(Bg(e))return rT(Fn(n,{lvl:c-1}));if(!Wr(e)&&!Wr(e.r))return Fn(e.r,{l:Fn(e,{r:e.r.l}),r:Fn(n,{l:e.r.r,lvl:c-1}),lvl:c});throw new Error("Unexpected empty nodes")}else{if(Bg(n))return wy(Fn(n,{lvl:c-1}));if(!Wr(t)&&!Wr(t.l)){const a=t.l,h=Bg(a)?t.lvl-1:t.lvl;return Fn(a,{l:Fn(n,{r:a.l,lvl:c-1}),r:wy(Fn(t,{l:a.r,lvl:h})),lvl:a.lvl+1})}else throw new Error("Unexpected empty nodes")}}function fm(n,e,t){if(Wr(n))return[];const c=No(n,e)[0];return WL(_y(n,c,t))}function iT(n,e){const t=n.length;if(t===0)return[];let{index:c,value:a}=e(n[0]);const h=[];for(let d=1;d<t;d++){const{index:s,value:f}=e(n[d]);h.push({start:c,end:s-1,value:a}),c=s,a=f}return h.push({start:c,end:1/0,value:a}),h}function WL(n){return iT(n,({k:e,v:t})=>({index:e,value:t}))}function wy(n){const{r:e,lvl:t}=n;return!Wr(e)&&!Wr(e.r)&&e.lvl===t&&e.r.lvl===t?Fn(e,{l:Fn(n,{r:e.l}),lvl:t+1}):n}function rT(n){const{l:e}=n;return!Wr(e)&&e.lvl===n.lvl?Fn(e,{r:Fn(n,{l:e.r})}):n}function jf(n,e,t,c=0){let a=n.length-1;for(;c<=a;){const h=Math.floor((c+a)/2),d=n[h],s=t(d,e);if(s===0)return h;if(s===-1){if(a-c<2)return h-1;a=h-1}else{if(a===c)return h;c=h+1}}throw new Error(`Failed binary finding record in array - ${n.join(",")}, searched for ${e}`)}function nT(n,e,t){return n[jf(n,e,t)]}function YL(n,e,t,c){const a=jf(n,e,c),h=jf(n,t,c,a);return n.slice(a,h+1)}const Ox=zr(()=>({recalcInProgress:ai(!1)}),[],{singleton:!0});function qL(n){const{size:e,startIndex:t,endIndex:c}=n;return a=>a.start===t&&(a.end===c||a.end===1/0)&&a.value===e}function Av(n,e){let t=0,c=0;for(;t<n;)t+=e[c+1]-e[c]-1,c++;return c-(t===n?0:1)}function XL(n,e){let t=Wr(n)?0:1/0;for(const c of e){const{size:a,startIndex:h,endIndex:d}=c;if(t=Math.min(t,h),Wr(n)){n=co(n,0,a);continue}const s=fm(n,h-1,d+1);if(s.some(qL(c)))continue;let f=!1,b=!1;for(const{start:x,end:v,value:g}of s)f?(d>=x||a===g)&&(n=vy(n,x)):(b=g!==a,f=!0),v>d&&d>=x&&g!==a&&(n=co(n,d+1,g));b&&(n=co(n,h,a))}return[n,t]}function ZL(){return{offsetTree:[],sizeTree:kh(),groupOffsetTree:kh(),lastIndex:0,lastOffset:0,lastSize:0,groupIndices:[]}}function zx({index:n},e){return e===n?0:e<n?-1:1}function KL({offset:n},e){return e===n?0:e<n?-1:1}function QL(n){return{index:n.index,value:n}}function JL(n,e,t,c=0){return c>0&&(e=Math.max(e,nT(n,c,zx).offset)),iT(YL(n,e,t,KL),QL)}function Ty(n,e,t,c){let a=n,h=0,d=0,s=0,f=0;if(e!==0){f=jf(a,e-1,zx),s=a[f].offset;const x=No(t,e-1);h=x[0],d=x[1],a.length&&a[f].size===No(t,e)[1]&&(f-=1),a=a.slice(0,f+1)}else a=[];for(const{start:b,value:x}of fm(t,e,1/0)){const v=b-h,g=v*d+s+v*c;a.push({offset:g,size:x,index:b}),h=b,s=g,d=x}return{offsetTree:a,lastIndex:h,lastOffset:s,lastSize:d}}function eR(n,[e,t,c,a]){e.length>0&&c("received item sizes",e,fo.DEBUG);const h=n.sizeTree;let d=h,s=0;if(t.length>0&&Wr(h)&&e.length===2){const g=e[0].size,P=e[1].size;d=t.reduce((_,S)=>co(co(_,S,g),S+1,P),d)}else[d,s]=XL(d,e);if(d===h)return n;const{offsetTree:f,lastIndex:b,lastSize:x,lastOffset:v}=Ty(n.offsetTree,s,d,a);return{sizeTree:d,offsetTree:f,lastIndex:b,lastOffset:v,lastSize:x,groupOffsetTree:t.reduce((g,P)=>co(g,P,vd(P,f,a)),kh()),groupIndices:t}}function vd(n,e,t){if(e.length===0)return 0;const{offset:c,index:a,size:h}=nT(e,n,zx),d=n-a,s=h*d+(d-1)*t+c;return s>0?s+t:s}function tR(n){return typeof n.groupIndex<"u"}function sT(n,e,t){if(tR(n))return e.groupIndices[n.groupIndex]+1;{const c=n.index==="LAST"?t:n.index;let a=oT(c,e);return a=Math.max(0,a,Math.min(t,a)),a}}function oT(n,e){if(!mm(e))return n;let t=0;for(;e.groupIndices[t]<=n+t;)t++;return n+t}function mm(n){return!Wr(n.groupOffsetTree)}function iR(n){return hc(n).map(({k:e,v:t},c,a)=>{const h=a[c+1],d=h?h.k-1:1/0;return{startIndex:e,endIndex:d,size:t}})}const rR={offsetHeight:"height",offsetWidth:"width"},la=zr(([{log:n},{recalcInProgress:e}])=>{const t=wr(),c=wr(),a=Bs(c,0),h=wr(),d=wr(),s=ai(0),f=ai([]),b=ai(void 0),x=ai(void 0),v=ai((w,M)=>_l(w,rR[M])),g=ai(void 0),P=ai(0),_=ZL(),S=Bs(Ht(t,dr(f,n,P),Ko(eR,_),an()),_),k=Bs(Ht(f,an(),Ko((w,M)=>({prev:w.current,current:M}),{prev:[],current:[]}),Ei(({prev:w})=>w)),[]);Ii(Ht(f,Ki(w=>w.length>0),dr(S,P),Ei(([w,M,z])=>{const Y=w.reduce((X,Z,j)=>co(X,Z,vd(Z,M.offsetTree,z)||j),kh());return{...M,groupIndices:w,groupOffsetTree:Y}})),S),Ii(Ht(c,dr(S),Ki(([w,{lastIndex:M}])=>w<M),Ei(([w,{lastIndex:M,lastSize:z}])=>[{startIndex:w,endIndex:M,size:z}])),t),Ii(b,x);const A=Bs(Ht(b,Ei(w=>w===void 0)),!0);Ii(Ht(x,Ki(w=>w!==void 0&&Wr(_s(S).sizeTree)),Ei(w=>[{startIndex:0,endIndex:0,size:w}])),t);const y=po(Ht(t,dr(S),Ko(({sizes:w},[M,z])=>({changed:z!==w,sizes:z}),{changed:!1,sizes:_}),Ei(w=>w.changed)));Or(Ht(s,Ko((w,M)=>({diff:w.prev-M,prev:M}),{diff:0,prev:0}),Ei(w=>w.diff)),w=>{const{groupIndices:M}=_s(S);if(w>0)cr(e,!0),cr(h,w+Av(w,M));else if(w<0){const z=_s(k);z.length>0&&(w-=Av(-w,z)),cr(d,w)}}),Or(Ht(s,dr(n)),([w,M])=>{w<0&&M("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:s},fo.ERROR)});const I=po(h);Ii(Ht(h,dr(S),Ei(([w,M])=>{const z=M.groupIndices.length>0,Y=[],X=M.lastSize;if(z){const Z=bd(M.sizeTree,0);let j=0,V=0;for(;j<w;){const L=M.groupIndices[V],G=M.groupIndices.length===V+1?1/0:M.groupIndices[V+1]-L-1;Y.push({startIndex:L,endIndex:L,size:Z}),Y.push({startIndex:L+1,endIndex:L+1+G-1,size:X}),V++,j+=G+1}const $=hc(M.sizeTree);return j!==w&&$.shift(),$.reduce((L,{k:G,v:U})=>{let F=L.ranges;return L.prevSize!==0&&(F=[...L.ranges,{startIndex:L.prevIndex,endIndex:G+w-1,size:L.prevSize}]),{ranges:F,prevIndex:G+w,prevSize:U}},{ranges:Y,prevIndex:w,prevSize:0}).ranges}return hc(M.sizeTree).reduce((Z,{k:j,v:V})=>({ranges:[...Z.ranges,{startIndex:Z.prevIndex,endIndex:j+w-1,size:Z.prevSize}],prevIndex:j+w,prevSize:V}),{ranges:[],prevIndex:0,prevSize:X}).ranges})),t);const D=po(Ht(d,dr(S,P),Ei(([w,{offsetTree:M},z])=>{const Y=-w;return vd(Y,M,z)})));return Ii(Ht(d,dr(S,P),Ei(([w,M,z])=>{if(M.groupIndices.length>0){if(Wr(M.sizeTree))return M;let X=kh();const Z=_s(k);let j=0,V=0,$=0;for(;j<-w;){$=Z[V];const L=Z[V+1]-$-1;V++,j+=L+1}if(X=hc(M.sizeTree).reduce((L,{k:G,v:U})=>co(L,Math.max(0,G+w),U),X),j!==-w){const L=bd(M.sizeTree,$);X=co(X,0,L);const G=No(M.sizeTree,-w+1)[1];X=co(X,1,G)}return{...M,sizeTree:X,...Ty(M.offsetTree,0,X,z)}}else{const X=hc(M.sizeTree).reduce((Z,{k:j,v:V})=>co(Z,Math.max(0,j+w),V),kh());return{...M,sizeTree:X,...Ty(M.offsetTree,0,X,z)}}})),S),{data:g,totalCount:c,sizeRanges:t,groupIndices:f,defaultItemSize:x,fixedItemSize:b,unshiftWith:h,shiftWith:d,shiftWithOffset:D,beforeUnshiftWith:I,firstItemIndex:s,gap:P,sizes:S,listRefresh:y,statefulTotalCount:a,trackItemSizes:A,itemSize:v}},hn(El,Ox),{singleton:!0}),nR=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function aT(n){const e=typeof n=="number"?{index:n}:n;return e.align||(e.align="start"),(!e.behavior||!nR)&&(e.behavior="auto"),e.offset||(e.offset=0),e}const $d=zr(([{sizes:n,totalCount:e,listRefresh:t,gap:c},{scrollingInProgress:a,viewportHeight:h,scrollTo:d,smoothScrollTargetReached:s,headerHeight:f,footerHeight:b,fixedHeaderHeight:x,fixedFooterHeight:v},{log:g}])=>{const P=wr(),_=wr(),S=ai(0);let k=null,A=null,y=null;function I(){k&&(k(),k=null),y&&(y(),y=null),A&&(clearTimeout(A),A=null),cr(a,!1)}return Ii(Ht(P,dr(n,h,e,S,f,b,g),dr(c,x,v),Ei(([[D,w,M,z,Y,X,Z,j],V,$,R])=>{const L=aT(D),{align:G,behavior:U,offset:F}=L,H=z-1,W=sT(L,w,H);let ne=vd(W,w.offsetTree,V)+X;G==="end"?(ne+=$+No(w.sizeTree,W)[1]-M+R,W===H&&(ne+=Z)):G==="center"?ne+=($+No(w.sizeTree,W)[1]-M+R)/2:ne-=Y,F&&(ne+=F);const ue=ie=>{I(),ie?(j("retrying to scroll to",{location:D},fo.DEBUG),cr(P,D)):(cr(_,!0),j("list did not change, scroll successful",{},fo.DEBUG))};if(I(),U==="smooth"){let ie=!1;y=Or(t,oe=>{ie=ie||oe}),k=ra(s,()=>{ue(ie)})}else k=ra(Ht(t,sR(150)),ue);return A=setTimeout(()=>{I()},1200),cr(a,!0),j("scrolling from index to",{index:W,top:ne,behavior:U},fo.DEBUG),{top:ne,behavior:U}})),d),{scrollToIndex:P,scrollTargetReached:_,topListHeight:S}},hn(la,Gs,El),{singleton:!0});function sR(n){return e=>{const t=setTimeout(()=>{e(!1)},n);return c=>{c&&(e(!0),clearTimeout(t))}}}const _d="up",od="down",oR="none",aR={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollTop:0,viewportHeight:0,scrollHeight:0}},lR=0,Gd=zr(([{scrollContainerState:n,scrollTop:e,viewportHeight:t,headerHeight:c,footerHeight:a,scrollBy:h}])=>{const d=ai(!1),s=ai(!0),f=wr(),b=wr(),x=ai(4),v=ai(lR),g=Bs(Ht(Sv(Ht(ir(e),Oh(1),Xo(!0)),Ht(ir(e),Oh(1),Xo(!1),Cv(100))),an()),!1),P=Bs(Ht(Sv(Ht(h,Xo(!0)),Ht(h,Xo(!1),Cv(200))),an()),!1);Ii(Ht($n(ir(e),ir(v)),Ei(([y,I])=>y<=I),an()),s),Ii(Ht(s,pl(50)),b);const _=po(Ht($n(n,ir(t),ir(c),ir(a),ir(x)),Ko((y,[{scrollTop:I,scrollHeight:D},w,M,z,Y])=>{const X=I+w-D>-Y,Z={viewportHeight:w,scrollTop:I,scrollHeight:D};if(X){let V,$;return I>y.state.scrollTop?(V="SCROLLED_DOWN",$=y.state.scrollTop-I):(V="SIZE_DECREASED",$=y.state.scrollTop-I||y.scrollTopDelta),{atBottom:!0,state:Z,atBottomBecause:V,scrollTopDelta:$}}let j;return Z.scrollHeight>y.state.scrollHeight?j="SIZE_INCREASED":w<y.state.viewportHeight?j="VIEWPORT_HEIGHT_DECREASING":I<y.state.scrollTop?j="SCROLLING_UPWARDS":j="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:j,state:Z}},aR),an((y,I)=>y&&y.atBottom===I.atBottom))),S=Bs(Ht(n,Ko((y,{scrollTop:I,scrollHeight:D,viewportHeight:w})=>{if(Kw(y.scrollHeight,D))return{scrollTop:I,scrollHeight:D,jump:0,changed:!1};{const M=D-(I+w)<1;return y.scrollTop!==I&&M?{scrollHeight:D,scrollTop:I,jump:y.scrollTop-I,changed:!0}:{scrollHeight:D,scrollTop:I,jump:0,changed:!0}}},{scrollHeight:0,jump:0,scrollTop:0,changed:!1}),Ki(y=>y.changed),Ei(y=>y.jump)),0);Ii(Ht(_,Ei(y=>y.atBottom)),d),Ii(Ht(d,pl(50)),f);const k=ai(od);Ii(Ht(n,Ei(({scrollTop:y})=>y),an(),Ko((y,I)=>_s(P)?{direction:y.direction,prevScrollTop:I}:{direction:I<y.prevScrollTop?_d:od,prevScrollTop:I},{direction:od,prevScrollTop:0}),Ei(y=>y.direction)),k),Ii(Ht(n,pl(50),Xo(oR)),k);const A=ai(0);return Ii(Ht(g,Ki(y=>!y),Xo(0)),A),Ii(Ht(e,pl(100),dr(g),Ki(([y,I])=>!!I),Ko(([y,I],[D])=>[I,D],[0,0]),Ei(([y,I])=>I-y)),A),{isScrolling:g,isAtTop:s,isAtBottom:d,atBottomState:_,atTopStateChange:b,atBottomStateChange:f,scrollDirection:k,atBottomThreshold:x,atTopThreshold:v,scrollVelocity:A,lastJumpDueToItemResize:S}},hn(Gs)),Cl=zr(([{log:n}])=>{const e=ai(!1),t=po(Ht(e,Ki(c=>c),an()));return Or(e,c=>{c&&_s(n)("props updated",{},fo.DEBUG)}),{propsReady:e,didMount:t}},hn(El),{singleton:!0});function Nx(n,e){n==0?e():requestAnimationFrame(()=>Nx(n-1,e))}function jx(n,e){const t=e-1;return typeof n=="number"?n:n.index==="LAST"?t:n.index}const Vd=zr(([{sizes:n,listRefresh:e,defaultItemSize:t},{scrollTop:c},{scrollToIndex:a,scrollTargetReached:h},{didMount:d}])=>{const s=ai(!0),f=ai(0),b=ai(!0);return Ii(Ht(d,dr(f),Ki(([x,v])=>!!v),Xo(!1)),s),Ii(Ht(d,dr(f),Ki(([x,v])=>!!v),Xo(!1)),b),Or(Ht($n(e,d),dr(s,n,t,b),Ki(([[,x],v,{sizeTree:g},P,_])=>x&&(!Wr(g)||Dx(P))&&!v&&!_),dr(f)),([,x])=>{ra(h,()=>{cr(b,!0)}),Nx(4,()=>{ra(c,()=>{cr(s,!0)}),cr(a,x)})}),{scrolledToInitialItem:s,initialTopMostItemIndex:f,initialItemFinalLocationReached:b}},hn(la,Gs,$d,Cl),{singleton:!0});function Pv(n){return n?n==="smooth"?"smooth":"auto":!1}const cR=(n,e)=>typeof n=="function"?Pv(n(e)):e&&Pv(n),hR=zr(([{totalCount:n,listRefresh:e},{isAtBottom:t,atBottomState:c},{scrollToIndex:a},{scrolledToInitialItem:h},{propsReady:d,didMount:s},{log:f},{scrollingInProgress:b}])=>{const x=ai(!1),v=wr();let g=null;function P(S){cr(a,{index:"LAST",align:"end",behavior:S})}Or(Ht($n(Ht(ir(n),Oh(1)),s),dr(ir(x),t,h,b),Ei(([[S,k],A,y,I,D])=>{let w=k&&I,M="auto";return w&&(M=cR(A,y||D),w=w&&!!M),{totalCount:S,shouldFollow:w,followOutputBehavior:M}}),Ki(({shouldFollow:S})=>S)),({totalCount:S,followOutputBehavior:k})=>{g&&(g(),g=null),g=ra(e,()=>{_s(f)("following output to ",{totalCount:S},fo.DEBUG),P(k),g=null})});function _(S){const k=ra(c,A=>{S&&!A.atBottom&&A.notAtBottomBecause==="SIZE_INCREASED"&&!g&&(_s(f)("scrolling to bottom due to increased size",{},fo.DEBUG),P("auto"))});setTimeout(k,100)}return Or(Ht($n(ir(x),n,d),Ki(([S,,k])=>S&&k),Ko(({value:S},[,k])=>({refreshed:S===k,value:k}),{refreshed:!1,value:0}),Ki(({refreshed:S})=>S),dr(x,n)),([,S])=>{_s(h)&&_(S!==!1)}),Or(v,()=>{_(_s(x)!==!1)}),Or($n(ir(x),c),([S,k])=>{S&&!k.atBottom&&k.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&P("auto")}),{followOutput:x,autoscrollToBottom:v}},hn(la,Gd,$d,Vd,Cl,El,Gs));function uR(n){return n.reduce((e,t)=>(e.groupIndices.push(e.totalCount),e.totalCount+=t+1,e),{totalCount:0,groupIndices:[]})}const lT=zr(([{totalCount:n,groupIndices:e,sizes:t},{scrollTop:c,headerHeight:a}])=>{const h=wr(),d=wr(),s=po(Ht(h,Ei(uR)));return Ii(Ht(s,Ei(f=>f.totalCount)),n),Ii(Ht(s,Ei(f=>f.groupIndices)),e),Ii(Ht($n(c,t,a),Ki(([f,b])=>mm(b)),Ei(([f,b,x])=>No(b.groupOffsetTree,Math.max(f-x,0),"v")[0]),an(),Ei(f=>[f])),d),{groupCounts:h,topItemsIndexes:d}},hn(la,Gs));function wd(n,e){return!!(n&&n[0]===e[0]&&n[1]===e[1])}function cT(n,e){return!!(n&&n.startIndex===e.startIndex&&n.endIndex===e.endIndex)}const Bf="top",Ff="bottom",Iv="none";function Dv(n,e,t){return typeof n=="number"?t===_d&&e===Bf||t===od&&e===Ff?n:0:t===_d?e===Bf?n.main:n.reverse:e===Ff?n.main:n.reverse}function Lv(n,e){return typeof n=="number"?n:n[e]||0}const Bx=zr(([{scrollTop:n,viewportHeight:e,deviation:t,headerHeight:c,fixedHeaderHeight:a}])=>{const h=wr(),d=ai(0),s=ai(0),f=ai(0),b=Bs(Ht($n(ir(n),ir(e),ir(c),ir(h,wd),ir(f),ir(d),ir(a),ir(t),ir(s)),Ei(([x,v,g,[P,_],S,k,A,y,I])=>{const D=x-y,w=k+A,M=Math.max(g-D,0);let z=Iv;const Y=Lv(I,Bf),X=Lv(I,Ff);return P-=y,P+=g+A,_+=g+A,_-=y,P>x+w-Y&&(z=_d),_<x-M+v+X&&(z=od),z!==Iv?[Math.max(D-g-Dv(S,Bf,z)-Y,0),D-M-A+v+Dv(S,Ff,z)+X]:null}),Ki(x=>x!=null),an(wd)),[0,0]);return{listBoundary:h,overscan:f,topListHeight:d,increaseViewportBy:s,visibleRange:b}},hn(Gs),{singleton:!0});function dR(n,e,t){if(mm(e)){const c=oT(n,e);return[{index:No(e.groupOffsetTree,c)[0],size:0,offset:0},{index:c,size:0,offset:0,data:t&&t[0]}]}return[{index:n,size:0,offset:0,data:t&&t[0]}]}const Fg={items:[],topItems:[],offsetTop:0,offsetBottom:0,top:0,bottom:0,topListHeight:0,totalCount:0,firstItemIndex:0};function Rv(n,e,t){if(n.length===0)return[];if(!mm(e))return n.map(b=>({...b,index:b.index+t,originalIndex:b.index}));const c=n[0].index,a=n[n.length-1].index,h=[],d=fm(e.groupOffsetTree,c,a);let s,f=0;for(const b of n){(!s||s.end<b.index)&&(s=d.shift(),f=e.groupIndices.indexOf(s.start));let x;b.index===s.start?x={type:"group",index:f}:x={index:b.index-(f+1)+t,groupIndex:f},h.push({...x,size:b.size,offset:b.offset,originalIndex:b.index,data:b.data})}return h}function ff(n,e,t,c,a,h){const{lastSize:d,lastOffset:s,lastIndex:f}=a;let b=0,x=0;if(n.length>0){b=n[0].offset;const S=n[n.length-1];x=S.offset+S.size}const v=t-f,g=s+v*d+(v-1)*c,P=b,_=g-x;return{items:Rv(n,a,h),topItems:Rv(e,a,h),topListHeight:e.reduce((S,k)=>k.size+S,0),offsetTop:b,offsetBottom:_,top:P,bottom:x,totalCount:t,firstItemIndex:h}}function hT(n,e,t,c,a,h){let d=0;if(t.groupIndices.length>0)for(const x of t.groupIndices){if(x-d>=n)break;d++}const s=n+d,f=jx(e,s),b=Array.from({length:s}).map((x,v)=>({index:v+f,size:0,offset:0,data:h[v+f]}));return ff(b,[],s,a,t,c)}const Ac=zr(([{sizes:n,totalCount:e,data:t,firstItemIndex:c,gap:a},h,{visibleRange:d,listBoundary:s,topListHeight:f},{scrolledToInitialItem:b,initialTopMostItemIndex:x},{topListHeight:v},g,{didMount:P},{recalcInProgress:_}])=>{const S=ai([]),k=ai(0),A=wr();Ii(h.topItemsIndexes,S);const y=Bs(Ht($n(P,_,ir(d,wd),ir(e),ir(n),ir(x),b,ir(S),ir(c),ir(a),t),Ki(([M,z,,Y,,,,,,,X])=>{const Z=X&&X.length!==Y;return M&&!z&&!Z}),Ei(([,,[M,z],Y,X,Z,j,V,$,R,L])=>{const G=X,{sizeTree:U,offsetTree:F}=G,H=_s(k);if(Y===0)return{...Fg,totalCount:Y};if(M===0&&z===0)return H===0?{...Fg,totalCount:Y}:hT(H,Z,X,$,R,L||[]);if(Wr(U))return H>0?null:ff(dR(jx(Z,Y),G,L),[],Y,R,G,$);const W=[];if(V.length>0){const Te=V[0],ge=V[V.length-1];let we=0;for(const K of fm(U,Te,ge)){const Q=K.value,ae=Math.max(K.start,Te),ye=Math.min(K.end,ge);for(let J=ae;J<=ye;J++)W.push({index:J,size:Q,offset:we,data:L&&L[J]}),we+=Q}}if(!j)return ff([],W,Y,R,G,$);const ne=V.length>0?V[V.length-1]+1:0,ue=JL(F,M,z,ne);if(ue.length===0)return null;const ie=Y-1,oe=pm([],Te=>{for(const ge of ue){const we=ge.value;let K=we.offset,Q=ge.start;const ae=we.size;if(we.offset<M){Q+=Math.floor((M-we.offset+R)/(ae+R));const J=Q-ge.start;K+=J*ae+J*R}Q<ne&&(K+=(ne-Q)*ae,Q=ne);const ye=Math.min(ge.end,ie);for(let J=Q;J<=ye&&!(K>=z);J++)Te.push({index:J,size:ae,offset:K,data:L&&L[J]}),K+=ae+R}});return ff(oe,W,Y,R,G,$)}),Ki(M=>M!==null),an()),Fg);Ii(Ht(t,Ki(Dx),Ei(M=>M==null?void 0:M.length)),e),Ii(Ht(y,Ei(M=>M.topListHeight)),v),Ii(v,f),Ii(Ht(y,Ei(M=>[M.top,M.bottom])),s),Ii(Ht(y,Ei(M=>M.items)),A);const I=po(Ht(y,Ki(({items:M})=>M.length>0),dr(e,t),Ki(([{items:M},z])=>M[M.length-1].originalIndex===z-1),Ei(([,M,z])=>[M-1,z]),an(wd),Ei(([M])=>M))),D=po(Ht(y,pl(200),Ki(({items:M,topItems:z})=>M.length>0&&M[0].originalIndex===z.length),Ei(({items:M})=>M[0].index),an())),w=po(Ht(y,Ki(({items:M})=>M.length>0),Ei(({items:M})=>{let z=0,Y=M.length-1;for(;M[z].type==="group"&&z<Y;)z++;for(;M[Y].type==="group"&&Y>z;)Y--;return{startIndex:M[z].index,endIndex:M[Y].index}}),an(cT)));return{listState:y,topItemsIndexes:S,endReached:I,startReached:D,rangeChanged:w,itemsRendered:A,initialItemCount:k,...g}},hn(la,lT,Bx,Vd,$d,Gd,Cl,Ox),{singleton:!0}),pR=zr(([{sizes:n,firstItemIndex:e,data:t,gap:c},{initialTopMostItemIndex:a},{initialItemCount:h,listState:d},{didMount:s}])=>(Ii(Ht(s,dr(h),Ki(([,f])=>f!==0),dr(a,n,e,c,t),Ei(([[,f],b,x,v,g,P=[]])=>hT(f,b,x,v,g,P))),d),{}),hn(la,Vd,Ac,Cl),{singleton:!0}),uT=zr(([{scrollVelocity:n}])=>{const e=ai(!1),t=wr(),c=ai(!1);return Ii(Ht(n,dr(c,e,t),Ki(([a,h])=>!!h),Ei(([a,h,d,s])=>{const{exit:f,enter:b}=h;if(d){if(f(a,s))return!1}else if(b(a,s))return!0;return d}),an()),e),Or(Ht($n(e,n,t),dr(c)),([[a,h,d],s])=>a&&s&&s.change&&s.change(h,d)),{isSeeking:e,scrollSeekConfiguration:c,scrollVelocity:n,scrollSeekRangeChanged:t}},hn(Gd),{singleton:!0}),fR=zr(([{topItemsIndexes:n}])=>{const e=ai(0);return Ii(Ht(e,Ki(t=>t>=0),Ei(t=>Array.from({length:t}).map((c,a)=>a))),n),{topItemCount:e}},hn(Ac)),dT=zr(([{footerHeight:n,headerHeight:e,fixedHeaderHeight:t,fixedFooterHeight:c},{listState:a}])=>{const h=wr(),d=Bs(Ht($n(n,c,e,t,a),Ei(([s,f,b,x,v])=>s+f+b+x+v.offsetBottom+v.bottom)),0);return Ii(ir(d),h),{totalListHeight:d,totalListHeightChanged:h}},hn(Gs,Ac),{singleton:!0});function pT(n){let e=!1,t;return()=>(e||(e=!0,t=n()),t)}const mR=pT(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),gR=zr(([{scrollBy:n,scrollTop:e,deviation:t,scrollingInProgress:c},{isScrolling:a,isAtBottom:h,scrollDirection:d,lastJumpDueToItemResize:s},{listState:f},{beforeUnshiftWith:b,shiftWithOffset:x,sizes:v,gap:g},{log:P},{recalcInProgress:_}])=>{const S=po(Ht(f,dr(s),Ko(([,A,y,I],[{items:D,totalCount:w,bottom:M,offsetBottom:z},Y])=>{const X=M+z;let Z=0;return y===w&&A.length>0&&D.length>0&&(D[0].originalIndex===0&&A[0].originalIndex===0||(Z=X-I,Z!==0&&(Z+=Y))),[Z,D,w,X]},[0,[],0,0]),Ki(([A])=>A!==0),dr(e,d,c,h,P,_),Ki(([,A,y,I,,,D])=>!D&&!I&&A!==0&&y===_d),Ei(([[A],,,,,y])=>(y("Upward scrolling compensation",{amount:A},fo.DEBUG),A))));function k(A){A>0?(cr(n,{top:-A,behavior:"auto"}),cr(t,0)):(cr(t,0),cr(n,{top:-A,behavior:"auto"}))}return Or(Ht(S,dr(t,a)),([A,y,I])=>{I&&mR()?cr(t,y-A):k(-A)}),Or(Ht($n(Bs(a,!1),t,_),Ki(([A,y,I])=>!A&&!I&&y!==0),Ei(([A,y])=>y),pl(1)),k),Ii(Ht(x,Ei(A=>({top:-A}))),n),Or(Ht(b,dr(v,g),Ei(([A,{lastSize:y,groupIndices:I,sizeTree:D},w])=>{function M(z){return z*(y+w)}if(I.length===0)return M(A);{let z=0;const Y=bd(D,0);let X=0,Z=0;for(;X<A;){X++,z+=Y;let j=I.length===Z+1?1/0:I[Z+1]-I[Z]-1;X+j>A&&(z-=Y,j=A-X+1),X+=j,z+=M(j),Z++}return z}})),A=>{cr(t,A),requestAnimationFrame(()=>{cr(n,{top:A}),requestAnimationFrame(()=>{cr(t,0),cr(_,!1)})})}),{deviation:t}},hn(Gs,Gd,Ac,la,El,Ox)),yR=zr(([{didMount:n},{scrollTo:e},{listState:t}])=>{const c=ai(0);return Or(Ht(n,dr(c),Ki(([,a])=>a!==0),Ei(([,a])=>({top:a}))),a=>{ra(Ht(t,Oh(1),Ki(h=>h.items.length>1)),()=>{requestAnimationFrame(()=>{cr(e,a)})})}),{initialScrollTop:c}},hn(Cl,Gs,Ac),{singleton:!0}),xR=zr(([{viewportHeight:n},{totalListHeight:e}])=>{const t=ai(!1),c=Bs(Ht($n(t,n,e),Ki(([a])=>a),Ei(([,a,h])=>Math.max(0,a-h)),pl(0),an()),0);return{alignToBottom:t,paddingTopAddition:c}},hn(Gs,dT),{singleton:!0}),Fx=zr(([{scrollTo:n,scrollContainerState:e}])=>{const t=wr(),c=wr(),a=wr(),h=ai(!1),d=ai(void 0);return Ii(Ht($n(t,c),Ei(([{viewportHeight:s,scrollTop:f,scrollHeight:b},{offsetTop:x}])=>({scrollTop:Math.max(0,f-x),scrollHeight:b,viewportHeight:s}))),e),Ii(Ht(n,dr(c),Ei(([s,{offsetTop:f}])=>({...s,top:s.top+f}))),a),{useWindowScroll:h,customScrollParent:d,windowScrollContainerState:t,windowViewportRect:c,windowScrollTo:a}},hn(Gs)),bR=({itemTop:n,itemBottom:e,viewportTop:t,viewportBottom:c,locationParams:{behavior:a,align:h,...d}})=>n<t?{...d,behavior:a,align:h??"start"}:e>c?{...d,behavior:a,align:h??"end"}:null,vR=zr(([{sizes:n,totalCount:e,gap:t},{scrollTop:c,viewportHeight:a,headerHeight:h,fixedHeaderHeight:d,fixedFooterHeight:s,scrollingInProgress:f},{scrollToIndex:b}])=>{const x=wr();return Ii(Ht(x,dr(n,a,e,h,d,s,c),dr(t),Ei(([[v,g,P,_,S,k,A,y],I])=>{const{done:D,behavior:w,align:M,calculateViewLocation:z=bR,...Y}=v,X=sT(v,g,_-1),Z=vd(X,g.offsetTree,I)+S+k,j=Z+No(g.sizeTree,X)[1],V=y+k,$=y+P-A,R=z({itemTop:Z,itemBottom:j,viewportTop:V,viewportBottom:$,locationParams:{behavior:w,align:M,...Y}});return R?D&&ra(Ht(f,Ki(L=>L===!1),Oh(_s(f)?1:2)),D):D&&D(),R}),Ki(v=>v!==null)),b),{scrollIntoView:x}},hn(la,Gs,$d,Ac,El),{singleton:!0}),_R=zr(([{sizes:n,sizeRanges:e},{scrollTop:t,headerHeight:c},{initialTopMostItemIndex:a},{didMount:h},{useWindowScroll:d,windowScrollContainerState:s,windowViewportRect:f}])=>{const b=wr(),x=ai(void 0),v=ai(null),g=ai(null);return Ii(s,v),Ii(f,g),Or(Ht(b,dr(n,t,d,v,g,c)),([P,_,S,k,A,y,I])=>{const D=iR(_.sizeTree);k&&A!==null&&y!==null&&(S=A.scrollTop-y.offsetTop),S-=I,P({ranges:D,scrollTop:S})}),Ii(Ht(x,Ki(Dx),Ei(wR)),a),Ii(Ht(h,dr(x),Ki(([,P])=>P!==void 0),an(),Ei(([,P])=>P.ranges)),e),{getState:b,restoreStateFrom:x}},hn(la,Gs,Vd,Cl,Fx));function wR(n){return{offset:n.scrollTop,index:0,align:"start"}}const TR=zr(([n,e,t,c,a,h,d,s,f,b])=>({...n,...e,...t,...c,...a,...h,...d,...s,...f,...b}),hn(Bx,pR,Cl,uT,dT,yR,xR,Fx,vR,El)),ER=zr(([{totalCount:n,sizeRanges:e,fixedItemSize:t,defaultItemSize:c,trackItemSizes:a,itemSize:h,data:d,firstItemIndex:s,groupIndices:f,statefulTotalCount:b,gap:x,sizes:v},{initialTopMostItemIndex:g,scrolledToInitialItem:P,initialItemFinalLocationReached:_},S,k,A,{listState:y,topItemsIndexes:I,...D},{scrollToIndex:w},M,{topItemCount:z},{groupCounts:Y},X])=>(Ii(D.rangeChanged,X.scrollSeekRangeChanged),Ii(Ht(X.windowViewportRect,Ei(Z=>Z.visibleHeight)),S.viewportHeight),{totalCount:n,data:d,firstItemIndex:s,sizeRanges:e,initialTopMostItemIndex:g,scrolledToInitialItem:P,initialItemFinalLocationReached:_,topItemsIndexes:I,topItemCount:z,groupCounts:Y,fixedItemHeight:t,defaultItemHeight:c,gap:x,...A,statefulTotalCount:b,listState:y,scrollToIndex:w,trackItemSizes:a,itemSize:h,groupIndices:f,...D,...X,...S,sizes:v,...k}),hn(la,Vd,Gs,_R,hR,Ac,$d,gR,fR,lT,TR)),Ug="-webkit-sticky",Ov="sticky",fT=pT(()=>{if(typeof document>"u")return Ov;const n=document.createElement("div");return n.style.position=Ug,n.style.position===Ug?Ug:Ov});function mT(n,e,t){const c=He.useRef(null),a=He.useCallback(f=>{if(f===null||!f.offsetParent)return;const b=f.getBoundingClientRect(),x=b.width;let v,g;if(e){const P=e.getBoundingClientRect(),_=b.top-P.top;v=P.height-Math.max(0,_),g=_+e.scrollTop}else v=window.innerHeight-Math.max(0,b.top),g=b.top+window.pageYOffset;c.current={offsetTop:g,visibleHeight:v,visibleWidth:x},n(c.current)},[n,e]),{callbackRef:h,ref:d}=Rx(a,!0,t),s=He.useCallback(()=>{a(d.current)},[a,d]);return He.useEffect(()=>{if(e){e.addEventListener("scroll",s);const f=new ResizeObserver(()=>{requestAnimationFrame(s)});return f.observe(e),()=>{e.removeEventListener("scroll",s),f.unobserve(e)}}else return window.addEventListener("scroll",s),window.addEventListener("resize",s),()=>{window.removeEventListener("scroll",s),window.removeEventListener("resize",s)}},[s,e]),h}const gT=He.createContext(void 0),yT=He.createContext(void 0);function xT(n){return n}const CR=zr(()=>{const n=ai(f=>`Item ${f}`),e=ai(null),t=ai(f=>`Group ${f}`),c=ai({}),a=ai(xT),h=ai("div"),d=ai(Yh),s=(f,b=null)=>Bs(Ht(c,Ei(x=>x[f]),an()),b);return{context:e,itemContent:n,groupContent:t,components:c,computeItemKey:a,HeaderFooterTag:h,scrollerRef:d,FooterComponent:s("Footer"),HeaderComponent:s("Header"),TopItemListComponent:s("TopItemList"),ListComponent:s("List","div"),ItemComponent:s("Item","div"),GroupComponent:s("Group","div"),ScrollerComponent:s("Scroller","div"),EmptyPlaceholder:s("EmptyPlaceholder"),ScrollSeekPlaceholder:s("ScrollSeekPlaceholder")}}),SR=zr(([n,e])=>({...n,...e}),hn(ER,CR)),kR=({height:n})=>ve.jsx("div",{style:{height:n}}),MR={position:fT(),zIndex:1,overflowAnchor:"none"},bT={overflowAnchor:"none"},AR={...bT,display:"inline-block",height:"100%"},zv=He.memo(function({showTopList:e=!1}){const t=nr("listState"),c=Eo("sizeRanges"),a=nr("useWindowScroll"),h=nr("customScrollParent"),d=Eo("windowScrollContainerState"),s=Eo("scrollContainerState"),f=h||a?d:s,b=nr("itemContent"),x=nr("context"),v=nr("groupContent"),g=nr("trackItemSizes"),P=nr("itemSize"),_=nr("log"),S=Eo("gap"),k=nr("horizontalDirection"),{callbackRef:A}=VL(c,P,g,e?Yh:f,_,S,h,k,nr("skipAnimationFrameInResizeObserver")),[y,I]=He.useState(0);Ux("deviation",L=>{y!==L&&I(L)});const D=nr("EmptyPlaceholder"),w=nr("ScrollSeekPlaceholder")||kR,M=nr("ListComponent"),z=nr("ItemComponent"),Y=nr("GroupComponent"),X=nr("computeItemKey"),Z=nr("isSeeking"),j=nr("groupIndices").length>0,V=nr("alignToBottom"),$=nr("initialItemFinalLocationReached"),R=e?{}:{boxSizing:"border-box",...k?{whiteSpace:"nowrap",display:"inline-block",height:"100%",paddingLeft:t.offsetTop,paddingRight:t.offsetBottom,marginLeft:y!==0?y:V?"auto":0}:{marginTop:y!==0?y:V?"auto":0,paddingTop:t.offsetTop,paddingBottom:t.offsetBottom},...$?{}:{visibility:"hidden"}};return!e&&t.totalCount===0&&D?ve.jsx(D,{...js(D,x)}):ve.jsx(M,{...js(M,x),ref:A,style:R,"data-testid":e?"virtuoso-top-item-list":"virtuoso-item-list",children:(e?t.topItems:t.items).map(L=>{const G=L.originalIndex,U=X(G+t.firstItemIndex,L.data,x);return Z?We.createElement(w,{...js(w,x),key:U,index:L.index,height:L.size,type:L.type||"item",...L.type==="group"?{}:{groupIndex:L.groupIndex}}):L.type==="group"?We.createElement(Y,{...js(Y,x),key:U,"data-index":G,"data-known-size":L.size,"data-item-index":L.index,style:MR},v(L.index,x)):We.createElement(z,{...js(z,x),...LR(z,L.data),key:U,"data-index":G,"data-known-size":L.size,"data-item-index":L.index,"data-item-group-index":L.groupIndex,style:k?AR:bT},j?b(L.index,L.groupIndex,L.data,x):b(L.index,L.data,x))})})}),PR={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},IR={outline:"none",overflowX:"auto",position:"relative"},gm=n=>({width:"100%",height:"100%",position:"absolute",top:0,...n?{display:"flex",flexDirection:"column"}:{}}),DR={width:"100%",position:fT(),top:0,zIndex:1};function js(n,e){if(typeof n!="string")return{context:e}}function LR(n,e){return{item:typeof n=="string"?void 0:e}}const RR=He.memo(function(){const e=nr("HeaderComponent"),t=Eo("headerHeight"),c=nr("HeaderFooterTag"),a=Mc(He.useMemo(()=>d=>t(_l(d,"height")),[t]),!0,nr("skipAnimationFrameInResizeObserver")),h=nr("context");return e?ve.jsx(c,{ref:a,children:ve.jsx(e,{...js(e,h)})}):null}),OR=He.memo(function(){const e=nr("FooterComponent"),t=Eo("footerHeight"),c=nr("HeaderFooterTag"),a=Mc(He.useMemo(()=>d=>t(_l(d,"height")),[t]),!0,nr("skipAnimationFrameInResizeObserver")),h=nr("context");return e?ve.jsx(c,{ref:a,children:ve.jsx(e,{...js(e,h)})}):null});function vT({usePublisher:n,useEmitter:e,useEmitterValue:t}){return He.memo(function({style:h,children:d,...s}){const f=n("scrollContainerState"),b=t("ScrollerComponent"),x=n("smoothScrollTargetReached"),v=t("scrollerRef"),g=t("context"),P=t("horizontalDirection")||!1,{scrollerRef:_,scrollByCallback:S,scrollToCallback:k}=Qw(f,x,b,v,void 0,P);e("scrollTo",k),e("scrollBy",S);const A=P?IR:PR;return ve.jsx(b,{ref:_,style:{...A,...h},"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,tabIndex:0,...s,...js(b,g),children:d})})}function _T({usePublisher:n,useEmitter:e,useEmitterValue:t}){return He.memo(function({style:h,children:d,...s}){const f=n("windowScrollContainerState"),b=t("ScrollerComponent"),x=n("smoothScrollTargetReached"),v=t("totalListHeight"),g=t("deviation"),P=t("customScrollParent"),_=t("context"),{scrollerRef:S,scrollByCallback:k,scrollToCallback:A}=Qw(f,x,b,Yh,P);return Zw(()=>(S.current=P||window,()=>{S.current=null}),[S,P]),e("windowScrollTo",A),e("scrollBy",k),ve.jsx(b,{style:{position:"relative",...h,...v!==0?{height:v+g}:{}},"data-virtuoso-scroller":!0,...s,...js(b,_),children:d})})}const zR=({children:n})=>{const e=He.useContext(gT),t=Eo("viewportHeight"),c=Eo("fixedItemHeight"),a=nr("alignToBottom"),h=nr("horizontalDirection"),d=He.useMemo(()=>Ww(t,f=>_l(f,h?"width":"height")),[t,h]),s=Mc(d,!0,nr("skipAnimationFrameInResizeObserver"));return He.useEffect(()=>{e&&(t(e.viewportHeight),c(e.itemHeight))},[e,t,c]),ve.jsx("div",{style:gm(a),ref:s,"data-viewport-type":"element",children:n})},NR=({children:n})=>{const e=He.useContext(gT),t=Eo("windowViewportRect"),c=Eo("fixedItemHeight"),a=nr("customScrollParent"),h=mT(t,a,nr("skipAnimationFrameInResizeObserver")),d=nr("alignToBottom");return He.useEffect(()=>{e&&(c(e.itemHeight),t({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:100}))},[e,t,c]),ve.jsx("div",{ref:h,style:gm(d),"data-viewport-type":"window",children:n})},jR=({children:n})=>{const e=nr("TopItemListComponent")||"div",t=nr("headerHeight"),c={...DR,marginTop:`${t}px`},a=nr("context");return ve.jsx(e,{style:c,...js(e,a),children:n})},BR=He.memo(function(e){const t=nr("useWindowScroll"),c=nr("topItemsIndexes").length>0,a=nr("customScrollParent"),h=a||t?$R:UR,d=a||t?NR:zR;return ve.jsxs(h,{...e,children:[c&&ve.jsx(jR,{children:ve.jsx(zv,{showTopList:!0})}),ve.jsxs(d,{children:[ve.jsx(RR,{}),ve.jsx(zv,{}),ve.jsx(OR,{})]})]})}),{Component:FR,usePublisher:Eo,useEmitterValue:nr,useEmitter:Ux}=Xw(SR,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},BR),UR=vT({usePublisher:Eo,useEmitterValue:nr,useEmitter:Ux}),$R=_T({usePublisher:Eo,useEmitterValue:nr,useEmitter:Ux}),GR=FR,Nv={items:[],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},VR={items:[{index:0}],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},{round:jv,ceil:Bv,floor:Uf,min:$g,max:ad}=Math;function HR(n){return{...VR,items:n}}function Fv(n,e,t){return Array.from({length:e-n+1}).map((c,a)=>{const h=t===null?null:t[a+n];return{index:a+n,data:h}})}function WR(n,e){return n&&n.column===e.column&&n.row===e.row}function rf(n,e){return n&&n.width===e.width&&n.height===e.height}const YR=zr(([{overscan:n,visibleRange:e,listBoundary:t,increaseViewportBy:c},{scrollTop:a,viewportHeight:h,scrollBy:d,scrollTo:s,smoothScrollTargetReached:f,scrollContainerState:b,footerHeight:x,headerHeight:v},g,P,{propsReady:_,didMount:S},{windowViewportRect:k,useWindowScroll:A,customScrollParent:y,windowScrollContainerState:I,windowScrollTo:D},w])=>{const M=ai(0),z=ai(0),Y=ai(Nv),X=ai({height:0,width:0}),Z=ai({height:0,width:0}),j=wr(),V=wr(),$=ai(0),R=ai(null),L=ai({row:0,column:0}),G=wr(),U=wr(),F=ai(!1),H=ai(0),W=ai(!0),ne=ai(!1),ue=ai(!1);Or(Ht(S,dr(H),Ki(([K,Q])=>!!Q)),()=>{cr(W,!1)}),Or(Ht($n(S,W,Z,X,H,ne),Ki(([K,Q,ae,ye,,J])=>K&&!Q&&ae.height!==0&&ye.height!==0&&!J)),([,,,,K])=>{cr(ne,!0),Nx(1,()=>{cr(j,K)}),ra(Ht(a),()=>{cr(t,[0,0]),cr(W,!0)})}),Ii(Ht(U,Ki(K=>K!=null&&K.scrollTop>0),Xo(0)),z),Or(Ht(S,dr(U),Ki(([,K])=>K!=null)),([,K])=>{K&&(cr(X,K.viewport),cr(Z,K==null?void 0:K.item),cr(L,K.gap),K.scrollTop>0&&(cr(F,!0),ra(Ht(a,Oh(1)),Q=>{cr(F,!1)}),cr(s,{top:K.scrollTop})))}),Ii(Ht(X,Ei(({height:K})=>K)),h),Ii(Ht($n(ir(X,rf),ir(Z,rf),ir(L,(K,Q)=>K&&K.column===Q.column&&K.row===Q.row),ir(a)),Ei(([K,Q,ae,ye])=>({viewport:K,item:Q,gap:ae,scrollTop:ye}))),G),Ii(Ht($n(ir(M),e,ir(L,WR),ir(Z,rf),ir(X,rf),ir(R),ir(z),ir(F),ir(W),ir(H)),Ki(([,,,,,,,K])=>!K),Ei(([K,[Q,ae],ye,J,re,ce,pe,,xe,Me])=>{const{row:_e,column:Ce}=ye,{height:Le,width:Ue}=J,{width:Xe}=re;if(pe===0&&(K===0||Xe===0))return Nv;if(Ue===0){const ut=jx(Me,K),mt=ut+Math.max(pe-1,0);return HR(Fv(ut,mt,ce))}const Pe=wT(Xe,Ue,Ce);let Ee,Ie;xe?Q===0&&ae===0&&pe>0?(Ee=0,Ie=pe-1):(Ee=Pe*Uf((Q+_e)/(Le+_e)),Ie=Pe*Bv((ae+_e)/(Le+_e))-1,Ie=$g(K-1,ad(Ie,Pe-1)),Ee=$g(Ie,ad(0,Ee))):(Ee=0,Ie=-1);const Oe=Fv(Ee,Ie,ce),{top:Re,bottom:Fe}=Uv(re,ye,J,Oe),Ke=Bv(K/Pe),at=Ke*Le+(Ke-1)*_e-Fe;return{items:Oe,offsetTop:Re,offsetBottom:at,top:Re,bottom:Fe,itemHeight:Le,itemWidth:Ue}})),Y),Ii(Ht(R,Ki(K=>K!==null),Ei(K=>K.length)),M),Ii(Ht($n(X,Z,Y,L),Ki(([K,Q,{items:ae}])=>ae.length>0&&Q.height!==0&&K.height!==0),Ei(([K,Q,{items:ae},ye])=>{const{top:J,bottom:re}=Uv(K,ye,Q,ae);return[J,re]}),an(wd)),t);const ie=ai(!1);Ii(Ht(a,dr(ie),Ei(([K,Q])=>Q||K!==0)),ie);const oe=po(Ht($n(Y,M),Ki(([{items:K}])=>K.length>0),dr(ie),Ki(([[K,Q],ae])=>{const J=K.items[K.items.length-1].index===Q-1;return(ae||K.bottom>0&&K.itemHeight>0&&K.offsetBottom===0&&K.items.length===Q)&&J}),Ei(([[,K]])=>K-1),an())),Te=po(Ht(ir(Y),Ki(({items:K})=>K.length>0&&K[0].index===0),Xo(0),an())),ge=po(Ht(ir(Y),dr(F),Ki(([{items:K},Q])=>K.length>0&&!Q),Ei(([{items:K}])=>({startIndex:K[0].index,endIndex:K[K.length-1].index})),an(cT),pl(0)));Ii(ge,P.scrollSeekRangeChanged),Ii(Ht(j,dr(X,Z,M,L),Ei(([K,Q,ae,ye,J])=>{const re=aT(K),{align:ce,behavior:pe,offset:xe}=re;let Me=re.index;Me==="LAST"&&(Me=ye-1),Me=ad(0,Me,$g(ye-1,Me));let _e=Ey(Q,J,ae,Me);return ce==="end"?_e=jv(_e-Q.height+ae.height):ce==="center"&&(_e=jv(_e-Q.height/2+ae.height/2)),xe&&(_e+=xe),{top:_e,behavior:pe}})),s);const we=Bs(Ht(Y,Ei(K=>K.offsetBottom+K.bottom)),0);return Ii(Ht(k,Ei(K=>({width:K.visibleWidth,height:K.visibleHeight}))),X),{data:R,totalCount:M,viewportDimensions:X,itemDimensions:Z,scrollTop:a,scrollHeight:V,overscan:n,increaseViewportBy:c,scrollBy:d,scrollTo:s,scrollToIndex:j,smoothScrollTargetReached:f,windowViewportRect:k,windowScrollTo:D,useWindowScroll:A,customScrollParent:y,windowScrollContainerState:I,deviation:$,scrollContainerState:b,footerHeight:x,headerHeight:v,initialItemCount:z,gap:L,restoreStateFrom:U,...P,initialTopMostItemIndex:H,horizontalDirection:ue,gridState:Y,totalListHeight:we,...g,startReached:Te,endReached:oe,rangeChanged:ge,stateChanged:G,propsReady:_,stateRestoreInProgress:F,...w}},hn(Bx,Gs,Gd,uT,Cl,Fx,El));function Uv(n,e,t,c){const{height:a}=t;if(a===void 0||c.length===0)return{top:0,bottom:0};const h=Ey(n,e,t,c[0].index),d=Ey(n,e,t,c[c.length-1].index)+a;return{top:h,bottom:d}}function Ey(n,e,t,c){const a=wT(n.width,t.width,e.column),h=Uf(c/a),d=h*t.height+ad(0,h-1)*e.row;return d>0?d+e.row:d}function wT(n,e,t){return ad(1,Uf((n+t)/(Uf(e)+t)))}const qR=zr(()=>{const n=ai(v=>`Item ${v}`),e=ai({}),t=ai(null),c=ai("virtuoso-grid-item"),a=ai("virtuoso-grid-list"),h=ai(xT),d=ai("div"),s=ai(Yh),f=(v,g=null)=>Bs(Ht(e,Ei(P=>P[v]),an()),g),b=ai(!1),x=ai(!1);return Ii(ir(x),b),{readyStateChanged:b,reportReadyState:x,context:t,itemContent:n,components:e,computeItemKey:h,itemClassName:c,listClassName:a,headerFooterTag:d,scrollerRef:s,FooterComponent:f("Footer"),HeaderComponent:f("Header"),ListComponent:f("List","div"),ItemComponent:f("Item","div"),ScrollerComponent:f("Scroller","div"),ScrollSeekPlaceholder:f("ScrollSeekPlaceholder","div")}}),XR=zr(([n,e])=>({...n,...e}),hn(YR,qR)),ZR=He.memo(function(){const e=dn("gridState"),t=dn("listClassName"),c=dn("itemClassName"),a=dn("itemContent"),h=dn("computeItemKey"),d=dn("isSeeking"),s=Co("scrollHeight"),f=dn("ItemComponent"),b=dn("ListComponent"),x=dn("ScrollSeekPlaceholder"),v=dn("context"),g=Co("itemDimensions"),P=Co("gap"),_=dn("log"),S=dn("stateRestoreInProgress"),k=Co("reportReadyState"),A=Mc(He.useMemo(()=>y=>{const I=y.parentElement.parentElement.scrollHeight;s(I);const D=y.firstChild;if(D){const{width:w,height:M}=D.getBoundingClientRect();g({width:w,height:M})}P({row:$v("row-gap",getComputedStyle(y).rowGap,_),column:$v("column-gap",getComputedStyle(y).columnGap,_)})},[s,g,P,_]),!0,!1);return Zw(()=>{e.itemHeight>0&&e.itemWidth>0&&k(!0)},[e]),S?null:ve.jsx(b,{ref:A,className:t,...js(b,v),style:{paddingTop:e.offsetTop,paddingBottom:e.offsetBottom},"data-testid":"virtuoso-item-list",children:e.items.map(y=>{const I=h(y.index,y.data,v);return d?ve.jsx(x,{...js(x,v),index:y.index,height:e.itemHeight,width:e.itemWidth},I):We.createElement(f,{...js(f,v),className:c,"data-index":y.index,key:I},a(y.index,y.data,v))})})}),KR=He.memo(function(){const e=dn("HeaderComponent"),t=Co("headerHeight"),c=dn("headerFooterTag"),a=Mc(He.useMemo(()=>d=>t(_l(d,"height")),[t]),!0,!1),h=dn("context");return e?ve.jsx(c,{ref:a,children:ve.jsx(e,{...js(e,h)})}):null}),QR=He.memo(function(){const e=dn("FooterComponent"),t=Co("footerHeight"),c=dn("headerFooterTag"),a=Mc(He.useMemo(()=>d=>t(_l(d,"height")),[t]),!0,!1),h=dn("context");return e?ve.jsx(c,{ref:a,children:ve.jsx(e,{...js(e,h)})}):null}),JR=({children:n})=>{const e=He.useContext(yT),t=Co("itemDimensions"),c=Co("viewportDimensions"),a=Mc(He.useMemo(()=>h=>{c(h.getBoundingClientRect())},[c]),!0,!1);return He.useEffect(()=>{e&&(c({height:e.viewportHeight,width:e.viewportWidth}),t({height:e.itemHeight,width:e.itemWidth}))},[e,c,t]),ve.jsx("div",{style:gm(!1),ref:a,children:n})},eO=({children:n})=>{const e=He.useContext(yT),t=Co("windowViewportRect"),c=Co("itemDimensions"),a=dn("customScrollParent"),h=mT(t,a,!1);return He.useEffect(()=>{e&&(c({height:e.itemHeight,width:e.itemWidth}),t({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:e.viewportWidth}))},[e,t,c]),ve.jsx("div",{ref:h,style:gm(!1),children:n})},tO=He.memo(function({...e}){const t=dn("useWindowScroll"),c=dn("customScrollParent"),a=c||t?rO:iO,h=c||t?eO:JR;return ve.jsx(a,{...e,children:ve.jsxs(h,{children:[ve.jsx(KR,{}),ve.jsx(ZR,{}),ve.jsx(QR,{})]})})}),{Component:hB,usePublisher:Co,useEmitterValue:dn,useEmitter:TT}=Xw(XR,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},tO),iO=vT({usePublisher:Co,useEmitterValue:dn,useEmitter:TT}),rO=_T({usePublisher:Co,useEmitterValue:dn,useEmitter:TT});function $v(n,e,t){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&t(`${n} was not resolved to pixel value correctly`,e,fo.WARN),e==="normal"?0:parseInt(e??"0",10)}const nO=({evaluationPerOrgUnits:n,useVirtuoso:e=!0,useVirtuosoWindowScroll:t=!1})=>{function c(){return a=>{const h=n[a];return h&&He.createElement("div",{key:h.orgUnitId},He.createElement(wv,{orgUnitsData:h}))}}return e?He.createElement("div",null,He.createElement(GR,{style:{height:"60vh"},useWindowScroll:t,totalCount:n.length,itemContent:c()})):He.createElement(He.Fragment,null,n.map((a,h)=>He.createElement(wv,{orgUnitsData:a})))},sO=({splitPeriods:n,setSelectedSplitPeriod:e,selectedSplitPeriod:t})=>n.includes(t)?He.createElement("div",null,He.createElement("div",null,He.createElement(Os,{selected:t,onChange:c=>e(c.selected)},n.map((c,a)=>He.createElement(yc,{key:a,label:Vw(c),value:c}))))):He.createElement(He.Fragment,null),oO="_orgUnitsSelction_1ir4t_1",aO="_wrapper_1ir4t_7",lO="_filterCheckbox_1ir4t_14",cO="_filter_1ir4t_14",hO="_plots_1ir4t_25",uO="_searchInput_1ir4t_29",dO="_filterTitle_1ir4t_34",nc={orgUnitsSelction:oO,wrapper:aO,filterCheckbox:lO,filter:cO,plots:hO,searchInput:uO,filterTitle:dO},pO=({evaluationName:n,modelName:e,evaluations:t,splitPeriods:c})=>{var S;const[a,h]=We.useState([]),[d,s]=We.useState(),[f,b]=We.useState([]),[x,v]=We.useState([]),[g,P]=We.useState(c[0]);We.useEffect(()=>{const k=t[0];b(k.evaluation.map(A=>A.orgUnitId)),v(k.evaluation.map(A=>({name:A.orgUnitName,id:A.orgUnitId}))),P(k.splitPoint),h(k.evaluation)},[t,c]),We.useEffect(()=>{const k=t.find(y=>y.splitPoint===g),A=f==null?void 0:f.map(y=>k.evaluation.find(I=>I.orgUnitId===y&&I.orgUnitName.toLocaleLowerCase().includes(d?d.toLocaleLowerCase():"")));h(A)},[g,f,d]);const _=k=>{const A=k.checked?[...f,k.value]:f.filter(y=>y!==k.value);b(A)};return He.createElement(He.Fragment,null,He.createElement("div",{className:nc.wrapper},He.createElement("div",{className:nc.filter},He.createElement("div",null,He.createElement("h2",null,"Evaluation: ",n)),He.createElement("div",null,He.createElement("div",{className:nc.filterTitle},"Split period:"),He.createElement(sO,{splitPeriods:c,setSelectedSplitPeriod:P,selectedSplitPeriod:g})),He.createElement("div",null,He.createElement("div",{className:nc.filterTitle},"Organization units:"),He.createElement("div",{className:nc.filterCheckbox},x.map((k,A)=>He.createElement(Gf,{checked:f.filter(y=>y==k.id).length>0,onChange:_,label:k.name,key:k.id,value:k.id}))))),He.createElement("div",{className:nc.plots},He.createElement("div",null,He.createElement("h3",null,"Model: ",e)),He.createElement("div",{className:nc.searchInput},He.createElement(Nh,{label:"Search for organization units:",placeholder:((S=x[0])==null?void 0:S.name)+"..",onChange:k=>s(k.value),value:d})),He.createElement(nO,{evaluationPerOrgUnits:a,useVirtuoso:!0}))))},fO="_table_11vie_1",mO="_quantile_low_11vie_22",gO="_quantile_high_11vie_26",yO={table:fO,quantile_low:mO,quantile_high:gO},Gv=n=>[...new Set(n.map(e=>e.period))],xO=n=>[...new Set(n.map(e=>e.orgUnit))],bO=n=>[...new Set(n.map(e=>e.dataElement))],vO=(n,e)=>{var t;return(t=e.find(c=>c.orgUnit===n))==null?void 0:t.displayName},_O=({data:n})=>{const e=n.dataValues;return He.createElement(He.Fragment,null,xO(e).map(t=>He.createElement("div",{key:t},He.createElement("h3",null,jt.t("Prediction for {{orgUnitName}}",{orgUnitName:vO(t,e)})),He.createElement("table",{className:yO.table},He.createElement("thead",null,He.createElement("tr",null,He.createElement("th",null,"Quantiles"),Gv(e).map(c=>He.createElement("th",{key:c},Mx({periodId:c,calendar:"gregory"}).displayName)))),He.createElement("tbody",null,bO(e).map(c=>He.createElement("tr",{key:c},He.createElement("td",null,c.replaceAll("_"," ")),Gv(e).map(a=>He.createElement("td",{key:a},e.filter(h=>h.dataElement===c&&h.orgUnit===t&&h.period===a)[0].value)))))))))};var wO={exports:{}};(function(n,e){(function(t,c){n.exports=c()})(lo,function(){var t,c,a;function h(s,f){if(!t)t=f;else if(!c)c=f;else{var b="var sharedChunk = {}; ("+t+")(sharedChunk); ("+c+")(sharedChunk);",x={};t(x),a=f(x),typeof window<"u"&&(a.workerUrl=window.URL.createObjectURL(new Blob([b],{type:"text/javascript"})))}}h(["exports"],function(s){var f=b;function b(o,i,l,p){this.cx=3*o,this.bx=3*(l-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(p-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=i,this.p2x=l,this.p2y=p}function x(o,i,l,p){const E=new f(o,i,l,p);return function(O){return E.solve(O)}}b.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,i){if(i===void 0&&(i=1e-6),o<0)return 0;if(o>1)return 1;for(var l=o,p=0;p<8;p++){var E=this.sampleCurveX(l)-o;if(Math.abs(E)<i)return l;var O=this.sampleCurveDerivativeX(l);if(Math.abs(O)<1e-6)break;l-=E/O}var B=0,te=1;for(l=o,p=0;p<20&&(E=this.sampleCurveX(l),!(Math.abs(E-o)<i));p++)o>E?B=l:te=l,l=.5*(te-B)+B;return l},solve:function(o,i){return this.sampleCurveY(this.solveCurveX(o,i))}};const v=x(.25,.1,.25,1);function g(o,i,l){return Math.min(l,Math.max(i,o))}function P(o,i,l){const p=l-i,E=((o-i)%p+p)%p+i;return E===i?l:E}function _(o,...i){for(const l of i)for(const p in l)o[p]=l[p];return o}let S=1;function k(o,i){o.forEach(l=>{i[l]&&(i[l]=i[l].bind(i))})}function A(o,i,l){const p={};for(const E in o)p[E]=i.call(l||this,o[E],E,o);return p}function y(o,i,l){const p={};for(const E in o)i.call(l||this,o[E],E,o)&&(p[E]=o[E]);return p}function I(o){return Array.isArray(o)?o.map(I):typeof o=="object"&&o?A(o,I):o}const D={};function w(o){D[o]||(typeof console<"u"&&console.warn(o),D[o]=!0)}function M(o,i,l){return(l.y-o.y)*(i.x-o.x)>(i.y-o.y)*(l.x-o.x)}function z(o){let i=0;for(let l,p,E=0,O=o.length,B=O-1;E<O;B=E++)l=o[E],p=o[B],i+=(p.x-l.x)*(l.y+p.y);return i}function Y(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function X(o){const i={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,p,E,O)=>{const B=E||O;return i[p]=!B||B.toLowerCase(),""}),i["max-age"]){const l=parseInt(i["max-age"],10);isNaN(l)?delete i["max-age"]:i["max-age"]=l}return i}let Z,j,V=null;function $(o){if(V==null){const i=o.navigator?o.navigator.userAgent:null;V=!!o.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return V}function R(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}const L={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(o){const i=requestAnimationFrame(o);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(o,i=0){const l=window.document.createElement("canvas"),p=l.getContext("2d");if(!p)throw new Error("failed to create canvas 2d context");return l.width=o.width,l.height=o.height,p.drawImage(o,0,0,o.width,o.height),p.getImageData(-i,-i,o.width+2*i,o.height+2*i)},resolveURL:o=>(Z||(Z=document.createElement("a")),Z.href=o,Z.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(j==null&&(j=matchMedia("(prefers-reduced-motion: reduce)")),j.matches)}};var G=U;function U(o,i){this.x=o,this.y=i}U.prototype={clone:function(){return new U(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,i){return this.clone()._rotateAround(o,i)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var i=o.x-this.x,l=o.y-this.y;return i*i+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,i){return Math.atan2(this.x*i-this.y*o,this.x*o+this.y*i)},_matMult:function(o){var i=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=i,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var i=Math.cos(o),l=Math.sin(o),p=l*this.x+i*this.y;return this.x=i*this.x-l*this.y,this.y=p,this},_rotateAround:function(o,i){var l=Math.cos(o),p=Math.sin(o),E=i.y+p*(this.x-i.x)+l*(this.y-i.y);return this.x=i.x+l*(this.x-i.x)-p*(this.y-i.y),this.y=E,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},U.convert=function(o){return o instanceof U?o:Array.isArray(o)?new U(o[0],o[1]):o};const F={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},H="mapbox-tiles";let W,ne=500,ue=50;function ie(){typeof caches>"u"||W||(W=caches.open(H))}let oe=1/0;const Te={supported:!1,testSupport:function(o){!K&&we&&(Q?ae(o):ge=o)}};let ge,we,K=!1,Q=!1;function ae(o){const i=o.createTexture();o.bindTexture(o.TEXTURE_2D,i);try{if(o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,we),o.isContextLost())return;Te.supported=!0}catch{}o.deleteTexture(i),K=!0}typeof document<"u"&&(we=document.createElement("img"),we.onload=function(){ge&&ae(ge),ge=null,Q=!0},we.onerror=function(){K=!0,ge=null},we.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ye={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ye);class J extends Error{constructor(i,l,p,E){super(`AJAXError: ${l} (${i}): ${p}`),this.status=i,this.statusText=l,this.url=p,this.body=E}}const re=Y()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function ce(o,i){const l=new AbortController,p=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,referrer:re(),signal:l.signal});let E=!1,O=!1;return o.type==="json"&&p.headers.set("Accept","application/json"),((B,te,se)=>{O||fetch(p).then(me=>me.ok?((Se,De,Be)=>{(o.type==="arrayBuffer"?Se.arrayBuffer():o.type==="json"?Se.json():Se.text()).then(Ve=>{O||(E=!0,i(null,Ve,Se.headers.get("Cache-Control"),Se.headers.get("Expires")))}).catch(Ve=>{O||i(new Error(Ve.message))})})(me):me.blob().then(Se=>i(new J(me.status,me.statusText,o.url,Se)))).catch(me=>{me.code!==20&&i(new Error(me.message))})})(),{cancel:()=>{O=!0,E||l.abort()}}}const pe=function(o,i){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){if(Y()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,i);if(!Y()){const p=o.url.substring(0,o.url.indexOf("://"));return(F.REGISTERED_PROTOCOLS[p]||ce)(o,i)}}if(!(/^file:/.test(l=o.url)||/^file:/.test(re())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return ce(o,i);if(Y()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,i,void 0,!0)}var l;return function(p,E){const O=new XMLHttpRequest;O.open(p.method||"GET",p.url,!0),p.type==="arrayBuffer"&&(O.responseType="arraybuffer");for(const B in p.headers)O.setRequestHeader(B,p.headers[B]);return p.type==="json"&&(O.responseType="text",O.setRequestHeader("Accept","application/json")),O.withCredentials=p.credentials==="include",O.onerror=()=>{E(new Error(O.statusText))},O.onload=()=>{if((O.status>=200&&O.status<300||O.status===0)&&O.response!==null){let B=O.response;if(p.type==="json")try{B=JSON.parse(O.response)}catch(te){return E(te)}E(null,B,O.getResponseHeader("Cache-Control"),O.getResponseHeader("Expires"))}else{const B=new Blob([O.response],{type:O.getResponseHeader("Content-Type")});E(new J(O.status,O.statusText,p.url,B))}},O.send(p.body),{cancel:()=>O.abort()}}(o,i)},xe=function(o,i){return pe(_(o,{type:"arrayBuffer"}),i)};function Me(o){const i=window.document.createElement("a");return i.href=o,i.protocol===window.document.location.protocol&&i.host===window.document.location.host}const _e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ce,Le;Ce=[],Le=0;const Ue=function(o,i){if(Te.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),Le>=F.MAX_PARALLEL_IMAGE_REQUESTS){const O={requestParameters:o,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return Ce.push(O),O}Le++;let l=!1;const p=()=>{if(!l)for(l=!0,Le--;Ce.length&&Le<F.MAX_PARALLEL_IMAGE_REQUESTS;){const O=Ce.shift(),{requestParameters:B,callback:te,cancelled:se}=O;se||(O.cancel=Ue(B,te).cancel)}},E=xe(o,(O,B,te,se)=>{p(),O?i(O):B&&function(me,Se){typeof createImageBitmap=="function"?function(De,Be){const Ve=new Blob([new Uint8Array(De)],{type:"image/png"});createImageBitmap(Ve).then(Ye=>{Be(null,Ye)}).catch(Ye=>{Be(new Error(`Could not load image because of ${Ye.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(me,Se):function(De,Be){const Ve=new Image;Ve.onload=()=>{Be(null,Ve),URL.revokeObjectURL(Ve.src),Ve.onload=null,window.requestAnimationFrame(()=>{Ve.src=_e})},Ve.onerror=()=>Be(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Ye=new Blob([new Uint8Array(De)],{type:"image/png"});Ve.src=De.byteLength?URL.createObjectURL(Ye):_e}(me,Se)}(B,(me,Se)=>{me!=null?i(me):Se!=null&&i(null,Se,{cacheControl:te,expires:se})})});return{cancel:()=>{E.cancel(),p()}}};function Xe(o,i,l){l[o]&&l[o].indexOf(i)!==-1||(l[o]=l[o]||[],l[o].push(i))}function Pe(o,i,l){if(l&&l[o]){const p=l[o].indexOf(i);p!==-1&&l[o].splice(p,1)}}class Ee{constructor(i,l={}){_(this,l),this.type=i}}class Ie extends Ee{constructor(i,l={}){super("error",_({error:i},l))}}class Oe{on(i,l){return this._listeners=this._listeners||{},Xe(i,l,this._listeners),this}off(i,l){return Pe(i,l,this._listeners),Pe(i,l,this._oneTimeListeners),this}once(i,l){return this._oneTimeListeners=this._oneTimeListeners||{},Xe(i,l,this._oneTimeListeners),this}fire(i,l){typeof i=="string"&&(i=new Ee(i,l||{}));const p=i.type;if(this.listens(p)){i.target=this;const E=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const te of E)te.call(this,i);const O=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const te of O)Pe(p,te,this._oneTimeListeners),te.call(this,i);const B=this._eventedParent;B&&(_(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),B.fire(i))}else i instanceof Ie&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,l){return this._eventedParent=i,this._eventedParentData=l,this}}var Re={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Fe{constructor(i,l,p,E){this.message=(i?`${i}: `:"")+p,E&&(this.identifier=E),l!=null&&l.__line__&&(this.line=l.__line__)}}function Ke(o){const i=o.value;return i?[new Fe(o.key,i,"constants have been deprecated as of v8")]:[]}function rt(o,...i){for(const l of i)for(const p in l)o[p]=l[p];return o}function at(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function ut(o){if(Array.isArray(o))return o.map(ut);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const i={};for(const l in o)i[l]=ut(o[l]);return i}return at(o)}class mt extends Error{constructor(i,l){super(l),this.message=l,this.key=i}}class Tt{constructor(i,l=[]){this.parent=i,this.bindings={};for(const[p,E]of l)this.bindings[p]=E}concat(i){return new Tt(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const Rt={kind:"null"},pt={kind:"number"},Ct={kind:"string"},Et={kind:"boolean"},ri={kind:"color"},ci={kind:"object"},Vt={kind:"value"},Ji={kind:"collator"},Vi={kind:"formatted"},ar={kind:"padding"},Tr={kind:"resolvedImage"};function Xi(o,i){return{kind:"array",itemType:o,N:i}}function ht(o){if(o.kind==="array"){const i=ht(o.itemType);return typeof o.N=="number"?`array<${i}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${i}>`}return o.kind}const xt=[Rt,pt,Ct,Et,ri,Vi,ci,Xi(Vt),ar,Tr];function At(o,i){if(i.kind==="error")return null;if(o.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!At(o.itemType,i.itemType))&&(typeof o.N!="number"||o.N===i.N))return null}else{if(o.kind===i.kind)return null;if(o.kind==="value"){for(const l of xt)if(!At(l,i))return null}}return`Expected ${ht(o)} but found ${ht(i)} instead.`}function Nt(o,i){return i.some(l=>l.kind===o.kind)}function Wt(o,i){return i.some(l=>l==="null"?o===null:l==="array"?Array.isArray(o):l==="object"?o&&!Array.isArray(o)&&typeof o=="object":l===typeof o)}var mi,Di={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function hi(o){return(o=Math.round(o))<0?0:o>255?255:o}function $e(o){return hi(o[o.length-1]==="%"?parseFloat(o)/100*255:parseInt(o))}function fe(o){return(i=o[o.length-1]==="%"?parseFloat(o)/100:parseFloat(o))<0?0:i>1?1:i;var i}function ke(o,i,l){return l<0?l+=1:l>1&&(l-=1),6*l<1?o+(i-o)*l*6:2*l<1?i:3*l<2?o+(i-o)*(2/3-l)*6:o}try{mi={}.parseCSSColor=function(o){var i,l=o.replace(/ /g,"").toLowerCase();if(l in Di)return Di[l].slice();if(l[0]==="#")return l.length===4?(i=parseInt(l.substr(1),16))>=0&&i<=4095?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null:l.length===7&&(i=parseInt(l.substr(1),16))>=0&&i<=16777215?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null;var p=l.indexOf("("),E=l.indexOf(")");if(p!==-1&&E+1===l.length){var O=l.substr(0,p),B=l.substr(p+1,E-(p+1)).split(","),te=1;switch(O){case"rgba":if(B.length!==4)return null;te=fe(B.pop());case"rgb":return B.length!==3?null:[$e(B[0]),$e(B[1]),$e(B[2]),te];case"hsla":if(B.length!==4)return null;te=fe(B.pop());case"hsl":if(B.length!==3)return null;var se=(parseFloat(B[0])%360+360)%360/360,me=fe(B[1]),Se=fe(B[2]),De=Se<=.5?Se*(me+1):Se+me-Se*me,Be=2*Se-De;return[hi(255*ke(Be,De,se+1/3)),hi(255*ke(Be,De,se)),hi(255*ke(Be,De,se-1/3)),te];default:return null}}return null}}catch{}class Ne{constructor(i,l,p,E=1){this.r=i,this.g=l,this.b=p,this.a=E}static parse(i){if(!i)return;if(i instanceof Ne)return i;if(typeof i!="string")return;const l=mi(i);return l?new Ne(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[i,l,p,E]=this.toArray();return`rgba(${Math.round(i)},${Math.round(l)},${Math.round(p)},${E})`}toArray(){const{r:i,g:l,b:p,a:E}=this;return E===0?[0,0,0,0]:[255*i/E,255*l/E,255*p/E,E]}}Ne.black=new Ne(0,0,0,1),Ne.white=new Ne(1,1,1,1),Ne.transparent=new Ne(0,0,0,0),Ne.red=new Ne(1,0,0,1);class qe{constructor(i,l,p){this.sensitivity=i?l?"variant":"case":l?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,l){return this.collator.compare(i,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class it{constructor(i,l,p,E,O){this.text=i,this.image=l,this.scale=p,this.fontStack=E,this.textColor=O}}class lt{constructor(i){this.sections=i}static fromString(i){return new lt([new it(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof lt?i:lt.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}}class st{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof st)return i;if(typeof i=="number")return new st([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(const l of i)if(typeof l!="number")return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new st(i)}}toString(){return JSON.stringify(this.values)}}class tt{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new tt({name:i,available:!1}):null}}function ft(o,i,l,p){return typeof o=="number"&&o>=0&&o<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof l=="number"&&l>=0&&l<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[o,i,l,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[o,i,l,p]:[o,i,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function St(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof Ne||o instanceof qe||o instanceof lt||o instanceof st||o instanceof tt)return!0;if(Array.isArray(o)){for(const i of o)if(!St(i))return!1;return!0}if(typeof o=="object"){for(const i in o)if(!St(o[i]))return!1;return!0}return!1}function Lt(o){if(o===null)return Rt;if(typeof o=="string")return Ct;if(typeof o=="boolean")return Et;if(typeof o=="number")return pt;if(o instanceof Ne)return ri;if(o instanceof qe)return Ji;if(o instanceof lt)return Vi;if(o instanceof st)return ar;if(o instanceof tt)return Tr;if(Array.isArray(o)){const i=o.length;let l;for(const p of o){const E=Lt(p);if(l){if(l===E)continue;l=Vt;break}l=E}return Xi(l||Vt,i)}return ci}function It(o){const i=typeof o;return o===null?"":i==="string"||i==="number"||i==="boolean"?String(o):o instanceof Ne||o instanceof lt||o instanceof st||o instanceof tt?o.toString():JSON.stringify(o)}class si{constructor(i,l){this.type=i,this.value=l}static parse(i,l){if(i.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!St(i[1]))return l.error("invalid value");const p=i[1];let E=Lt(p);const O=l.expectedType;return E.kind!=="array"||E.N!==0||!O||O.kind!=="array"||typeof O.N=="number"&&O.N!==0||(E=O),new si(E,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Zt{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const ui={string:Ct,number:pt,boolean:Et,object:ci};class gi{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");let p,E=1;const O=i[0];if(O==="array"){let te,se;if(i.length>2){const me=i[1];if(typeof me!="string"||!(me in ui)||me==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);te=ui[me],E++}else te=Vt;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return l.error('The length argument to "array" must be a positive integer literal',2);se=i[2],E++}p=Xi(te,se)}else{if(!ui[O])throw new Error(`Types doesn't contain name = ${O}`);p=ui[O]}const B=[];for(;E<i.length;E++){const te=l.parse(i[E],E,Vt);if(!te)return null;B.push(te)}return new gi(p,B)}evaluate(i){for(let l=0;l<this.args.length;l++){const p=this.args[l].evaluate(i);if(!At(this.type,Lt(p)))return p;if(l===this.args.length-1)throw new Zt(`Expected value to be of type ${ht(this.type)}, but found ${ht(Lt(p))} instead.`)}throw new Error}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const zi={"to-boolean":Et,"to-color":ri,"to-number":pt,"to-string":Ct};class yi{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const p=i[0];if(!zi[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&i.length!==2)return l.error("Expected one argument.");const E=zi[p],O=[];for(let B=1;B<i.length;B++){const te=l.parse(i[B],B,Vt);if(!te)return null;O.push(te)}return new yi(E,O)}evaluate(i){if(this.type.kind==="boolean")return!!this.args[0].evaluate(i);if(this.type.kind==="color"){let l,p;for(const E of this.args){if(l=E.evaluate(i),p=null,l instanceof Ne)return l;if(typeof l=="string"){const O=i.parseColor(l);if(O)return O}else if(Array.isArray(l)&&(p=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:ft(l[0],l[1],l[2],l[3]),!p))return new Ne(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Zt(p||`Could not parse color from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}if(this.type.kind==="padding"){let l;for(const p of this.args){l=p.evaluate(i);const E=st.parse(l);if(E)return E}throw new Zt(`Could not parse padding from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}if(this.type.kind==="number"){let l=null;for(const p of this.args){if(l=p.evaluate(i),l===null)return 0;const E=Number(l);if(!isNaN(E))return E}throw new Zt(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?lt.fromString(It(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?tt.fromString(It(this.args[0].evaluate(i))):It(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const Si=["Unknown","Point","LineString","Polygon"];class Ni{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Si[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let l=this._parseColorCache[i];return l||(l=this._parseColorCache[i]=Ne.parse(i)),l}}class Li{constructor(i,l,p,E){this.name=i,this.type=l,this._evaluate=p,this.args=E}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,l){const p=i[0],E=Li.definitions[p];if(!E)return l.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const O=Array.isArray(E)?E[0]:E.type,B=Array.isArray(E)?[[E[1],E[2]]]:E.overloads,te=B.filter(([me])=>!Array.isArray(me)||me.length===i.length-1);let se=null;for(const[me,Se]of te){se=new Lc(l.registry,l.path,null,l.scope);const De=[];let Be=!1;for(let Ve=1;Ve<i.length;Ve++){const Ye=i[Ve],ct=Array.isArray(me)?me[Ve-1]:me.type,ot=se.parse(Ye,1+De.length,ct);if(!ot){Be=!0;break}De.push(ot)}if(!Be)if(Array.isArray(me)&&me.length!==De.length)se.error(`Expected ${me.length} arguments, but found ${De.length} instead.`);else{for(let Ve=0;Ve<De.length;Ve++){const Ye=Array.isArray(me)?me[Ve]:me.type,ct=De[Ve];se.concat(Ve+1).checkSubtype(Ye,ct.type)}if(se.errors.length===0)return new Li(p,O,Se,De)}}if(te.length===1)l.errors.push(...se.errors);else{const me=(te.length?te:B).map(([De])=>{return Be=De,Array.isArray(Be)?`(${Be.map(ht).join(", ")})`:`(${ht(Be.type)}...)`;var Be}).join(" | "),Se=[];for(let De=1;De<i.length;De++){const Be=l.parse(i[De],1+Se.length);if(!Be)return null;Se.push(ht(Be.type))}l.error(`Expected arguments of type ${me}, but found (${Se.join(", ")}) instead.`)}return null}static register(i,l){Li.definitions=l;for(const p in l)i[p]=Li}}class rr{constructor(i,l,p){this.type=Ji,this.locale=p,this.caseSensitive=i,this.diacriticSensitive=l}static parse(i,l){if(i.length!==2)return l.error("Expected one argument.");const p=i[1];if(typeof p!="object"||Array.isArray(p))return l.error("Collator options argument must be an object.");const E=l.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Et);if(!E)return null;const O=l.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Et);if(!O)return null;let B=null;return p.locale&&(B=l.parse(p.locale,1,Ct),!B)?null:new rr(E,O,B)}evaluate(i){return new qe(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}const Ar=8192;function Jr(o,i){o[0]=Math.min(o[0],i[0]),o[1]=Math.min(o[1],i[1]),o[2]=Math.max(o[2],i[0]),o[3]=Math.max(o[3],i[1])}function _n(o,i){return!(o[0]<=i[0]||o[2]>=i[2]||o[1]<=i[1]||o[3]>=i[3])}function qh(o,i){const l=(180+o[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,E=Math.pow(2,i.z);return[Math.round(l*E*Ar),Math.round(p*E*Ar)]}function Sl(o,i,l){const p=o[0]-i[0],E=o[1]-i[1],O=o[0]-l[0],B=o[1]-l[1];return p*B-O*E==0&&p*O<=0&&E*B<=0}function Er(o,i){let l=!1;for(let B=0,te=i.length;B<te;B++){const se=i[B];for(let me=0,Se=se.length;me<Se-1;me++){if(Sl(o,se[me],se[me+1]))return!1;(E=se[me])[1]>(p=o)[1]!=(O=se[me+1])[1]>p[1]&&p[0]<(O[0]-E[0])*(p[1]-E[1])/(O[1]-E[1])+E[0]&&(l=!l)}}var p,E,O;return l}function ym(o,i){for(let l=0;l<i.length;l++)if(Er(o,i[l]))return!0;return!1}function Pc(o,i,l,p){const E=p[0]-l[0],O=p[1]-l[1],B=(o[0]-l[0])*O-E*(o[1]-l[1]),te=(i[0]-l[0])*O-E*(i[1]-l[1]);return B>0&&te<0||B<0&&te>0}function xm(o,i,l){for(const me of l)for(let Se=0;Se<me.length-1;++Se)if((te=[(B=me[Se+1])[0]-(O=me[Se])[0],B[1]-O[1]])[0]*(se=[(E=i)[0]-(p=o)[0],E[1]-p[1]])[1]-te[1]*se[0]!=0&&Pc(p,E,O,B)&&Pc(O,B,p,E))return!0;var p,E,O,B,te,se;return!1}function Xh(o,i){for(let l=0;l<o.length;++l)if(!Er(o[l],i))return!1;for(let l=0;l<o.length-1;++l)if(xm(o[l],o[l+1],i))return!1;return!0}function Hd(o,i){for(let l=0;l<i.length;l++)if(Xh(o,i[l]))return!0;return!1}function Zh(o,i,l){const p=[];for(let E=0;E<o.length;E++){const O=[];for(let B=0;B<o[E].length;B++){const te=qh(o[E][B],l);Jr(i,te),O.push(te)}p.push(O)}return p}function Kh(o,i,l){const p=[];for(let E=0;E<o.length;E++){const O=Zh(o[E],i,l);p.push(O)}return p}function Qh(o,i,l,p){if(o[0]<l[0]||o[0]>l[2]){const E=.5*p;let O=o[0]-l[0]>E?-p:l[0]-o[0]>E?p:0;O===0&&(O=o[0]-l[2]>E?-p:l[2]-o[0]>E?p:0),o[0]+=O}Jr(i,o)}function Wd(o,i,l,p){const E=Math.pow(2,p.z)*Ar,O=[p.x*Ar,p.y*Ar],B=[];for(const te of o)for(const se of te){const me=[se.x+O[0],se.y+O[1]];Qh(me,i,l,E),B.push(me)}return B}function Yd(o,i,l,p){const E=Math.pow(2,p.z)*Ar,O=[p.x*Ar,p.y*Ar],B=[];for(const se of o){const me=[];for(const Se of se){const De=[Se.x+O[0],Se.y+O[1]];Jr(i,De),me.push(De)}B.push(me)}if(i[2]-i[0]<=E/2){(te=i)[0]=te[1]=1/0,te[2]=te[3]=-1/0;for(const se of B)for(const me of se)Qh(me,i,l,E)}var te;return B}class ca{constructor(i,l){this.type=Et,this.geojson=i,this.geometries=l}static parse(i,l){if(i.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(St(i[1])){const p=i[1];if(p.type==="FeatureCollection")for(let E=0;E<p.features.length;++E){const O=p.features[E].geometry.type;if(O==="Polygon"||O==="MultiPolygon")return new ca(p,p.features[E].geometry)}else if(p.type==="Feature"){const E=p.geometry.type;if(E==="Polygon"||E==="MultiPolygon")return new ca(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new ca(p,p)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(l,p){const E=[1/0,1/0,-1/0,-1/0],O=[1/0,1/0,-1/0,-1/0],B=l.canonicalID();if(p.type==="Polygon"){const te=Zh(p.coordinates,O,B),se=Wd(l.geometry(),E,O,B);if(!_n(E,O))return!1;for(const me of se)if(!Er(me,te))return!1}if(p.type==="MultiPolygon"){const te=Kh(p.coordinates,O,B),se=Wd(l.geometry(),E,O,B);if(!_n(E,O))return!1;for(const me of se)if(!ym(me,te))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(l,p){const E=[1/0,1/0,-1/0,-1/0],O=[1/0,1/0,-1/0,-1/0],B=l.canonicalID();if(p.type==="Polygon"){const te=Zh(p.coordinates,O,B),se=Yd(l.geometry(),E,O,B);if(!_n(E,O))return!1;for(const me of se)if(!Xh(me,te))return!1}if(p.type==="MultiPolygon"){const te=Kh(p.coordinates,O,B),se=Yd(l.geometry(),E,O,B);if(!_n(E,O))return!1;for(const me of se)if(!Hd(me,te))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function Ic(o){if(o instanceof Li&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof ca)return!1;let i=!0;return o.eachChild(l=>{i&&!Ic(l)&&(i=!1)}),i}function ja(o){if(o instanceof Li&&o.name==="feature-state")return!1;let i=!0;return o.eachChild(l=>{i&&!ja(l)&&(i=!1)}),i}function kl(o,i){if(o instanceof Li&&i.indexOf(o.name)>=0)return!1;let l=!0;return o.eachChild(p=>{l&&!kl(p,i)&&(l=!1)}),l}class Dc{constructor(i,l){this.type=l.type,this.name=i,this.boundExpression=l}static parse(i,l){if(i.length!==2||typeof i[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const p=i[1];return l.scope.has(p)?new Dc(p,l.scope.get(p)):l.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class Lc{constructor(i,l=[],p,E=new Tt,O=[]){this.registry=i,this.path=l,this.key=l.map(B=>`[${B}]`).join(""),this.scope=E,this.errors=O,this.expectedType=p}parse(i,l,p,E,O={}){return l?this.concat(l,p,E)._parse(i,O):this._parse(i,O)}_parse(i,l){function p(E,O,B){return B==="assert"?new gi(O,[E]):B==="coerce"?new yi(O,[E]):E}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const E=i[0];if(typeof E!="string")return this.error(`Expression name must be a string, but found ${typeof E} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const O=this.registry[E];if(O){let B=O.parse(i,this);if(!B)return null;if(this.expectedType){const te=this.expectedType,se=B.type;if(te.kind!=="string"&&te.kind!=="number"&&te.kind!=="boolean"&&te.kind!=="object"&&te.kind!=="array"||se.kind!=="value")if(te.kind!=="color"&&te.kind!=="formatted"&&te.kind!=="resolvedImage"||se.kind!=="value"&&se.kind!=="string")if(te.kind!=="padding"||se.kind!=="value"&&se.kind!=="number"&&se.kind!=="array"){if(this.checkSubtype(te,se))return null}else B=p(B,te,l.typeAnnotation||"coerce");else B=p(B,te,l.typeAnnotation||"coerce");else B=p(B,te,l.typeAnnotation||"assert")}if(!(B instanceof si)&&B.type.kind!=="resolvedImage"&&Ml(B)){const te=new Ni;try{B=new si(B.type,B.evaluate(te))}catch(se){return this.error(se.message),null}}return B}return this.error(`Unknown expression "${E}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,l,p){const E=typeof i=="number"?this.path.concat(i):this.path,O=p?this.scope.concat(p):this.scope;return new Lc(this.registry,E,l||null,O,this.errors)}error(i,...l){const p=`${this.key}${l.map(E=>`[${E}]`).join("")}`;this.errors.push(new mt(p,i))}checkSubtype(i,l){const p=At(i,l);return p&&this.error(p),p}}function Ml(o){if(o instanceof Dc)return Ml(o.boundExpression);if(o instanceof Li&&o.name==="error"||o instanceof rr||o instanceof ca)return!1;const i=o instanceof yi||o instanceof gi;let l=!0;return o.eachChild(p=>{l=i?l&&Ml(p):l&&p instanceof si}),!!l&&Ic(o)&&kl(o,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Rc(o,i){const l=o.length-1;let p,E,O=0,B=l,te=0;for(;O<=B;)if(te=Math.floor((O+B)/2),p=o[te],E=o[te+1],p<=i){if(te===l||i<E)return te;O=te+1}else{if(!(p>i))throw new Zt("Input is not a number.");B=te-1}return 0}class Al{constructor(i,l,p){this.type=i,this.input=l,this.labels=[],this.outputs=[];for(const[E,O]of p)this.labels.push(E),this.outputs.push(O)}static parse(i,l){if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");const p=l.parse(i[1],1,pt);if(!p)return null;const E=[];let O=null;l.expectedType&&l.expectedType.kind!=="value"&&(O=l.expectedType);for(let B=1;B<i.length;B+=2){const te=B===1?-1/0:i[B],se=i[B+1],me=B,Se=B+1;if(typeof te!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',me);if(E.length&&E[E.length-1][0]>=te)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',me);const De=l.parse(se,Se,O);if(!De)return null;O=O||De.type,E.push([te,De])}return new Al(O,p,E)}evaluate(i){const l=this.labels,p=this.outputs;if(l.length===1)return p[0].evaluate(i);const E=this.input.evaluate(i);if(E<=l[0])return p[0].evaluate(i);const O=l.length;return E>=l[O-1]?p[O-1].evaluate(i):p[Rc(l,E)].evaluate(i)}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function Yr(o,i,l){return o*(1-l)+i*l}var Pl=Object.freeze({__proto__:null,number:Yr,color:function(o,i,l){return new Ne(Yr(o.r,i.r,l),Yr(o.g,i.g,l),Yr(o.b,i.b,l),Yr(o.a,i.a,l))},array:function(o,i,l){return o.map((p,E)=>Yr(p,i[E],l))},padding:function(o,i,l){const p=o.values,E=i.values;return new st([Yr(p[0],E[0],l),Yr(p[1],E[1],l),Yr(p[2],E[2],l),Yr(p[3],E[3],l)])}});const Jh=.95047,qd=1.08883,Xd=4/29,Oc=6/29,eu=3*Oc*Oc,bm=Math.PI/180,vm=180/Math.PI;function tu(o){return o>.008856451679035631?Math.pow(o,1/3):o/eu+Xd}function iu(o){return o>Oc?o*o*o:eu*(o-Xd)}function ru(o){return 255*(o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055)}function nu(o){return(o/=255)<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function Zd(o){const i=nu(o.r),l=nu(o.g),p=nu(o.b),E=tu((.4124564*i+.3575761*l+.1804375*p)/Jh),O=tu((.2126729*i+.7151522*l+.072175*p)/1);return{l:116*O-16,a:500*(E-O),b:200*(O-tu((.0193339*i+.119192*l+.9503041*p)/qd)),alpha:o.a}}function xr(o){let i=(o.l+16)/116,l=isNaN(o.a)?i:i+o.a/500,p=isNaN(o.b)?i:i-o.b/200;return i=1*iu(i),l=Jh*iu(l),p=qd*iu(p),new Ne(ru(3.2404542*l-1.5371385*i-.4985314*p),ru(-.969266*l+1.8760108*i+.041556*p),ru(.0556434*l-.2040259*i+1.0572252*p),o.alpha)}function _m(o,i,l){const p=i-o;return o+l*(p>180||p<-180?p-360*Math.round(p/360):p)}const Il={forward:Zd,reverse:xr,interpolate:function(o,i,l){return{l:Yr(o.l,i.l,l),a:Yr(o.a,i.a,l),b:Yr(o.b,i.b,l),alpha:Yr(o.alpha,i.alpha,l)}}},Dl={forward:function(o){const{l:i,a:l,b:p}=Zd(o),E=Math.atan2(p,l)*vm;return{h:E<0?E+360:E,c:Math.sqrt(l*l+p*p),l:i,alpha:o.a}},reverse:function(o){const i=o.h*bm,l=o.c;return xr({l:o.l,a:Math.cos(i)*l,b:Math.sin(i)*l,alpha:o.alpha})},interpolate:function(o,i,l){return{h:_m(o.h,i.h,l),c:Yr(o.c,i.c,l),l:Yr(o.l,i.l,l),alpha:Yr(o.alpha,i.alpha,l)}}};var Kd=Object.freeze({__proto__:null,lab:Il,hcl:Dl});class Es{constructor(i,l,p,E,O){this.type=i,this.operator=l,this.interpolation=p,this.input=E,this.labels=[],this.outputs=[];for(const[B,te]of O)this.labels.push(B),this.outputs.push(te)}static interpolationFactor(i,l,p,E){let O=0;if(i.name==="exponential")O=su(l,i.base,p,E);else if(i.name==="linear")O=su(l,1,p,E);else if(i.name==="cubic-bezier"){const B=i.controlPoints;O=new f(B[0],B[1],B[2],B[3]).solve(su(l,1,p,E))}return O}static parse(i,l){let[p,E,O,...B]=i;if(!Array.isArray(E)||E.length===0)return l.error("Expected an interpolation type expression.",1);if(E[0]==="linear")E={name:"linear"};else if(E[0]==="exponential"){const me=E[1];if(typeof me!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);E={name:"exponential",base:me}}else{if(E[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(E[0])}`,1,0);{const me=E.slice(1);if(me.length!==4||me.some(Se=>typeof Se!="number"||Se<0||Se>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);E={name:"cubic-bezier",controlPoints:me}}}if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(O=l.parse(O,2,pt),!O)return null;const te=[];let se=null;p==="interpolate-hcl"||p==="interpolate-lab"?se=ri:l.expectedType&&l.expectedType.kind!=="value"&&(se=l.expectedType);for(let me=0;me<B.length;me+=2){const Se=B[me],De=B[me+1],Be=me+3,Ve=me+4;if(typeof Se!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Be);if(te.length&&te[te.length-1][0]>=Se)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Be);const Ye=l.parse(De,Ve,se);if(!Ye)return null;se=se||Ye.type,te.push([Se,Ye])}return se.kind==="number"||se.kind==="color"||se.kind==="padding"||se.kind==="array"&&se.itemType.kind==="number"&&typeof se.N=="number"?new Es(se,p,E,O,te):l.error(`Type ${ht(se)} is not interpolatable.`)}evaluate(i){const l=this.labels,p=this.outputs;if(l.length===1)return p[0].evaluate(i);const E=this.input.evaluate(i);if(E<=l[0])return p[0].evaluate(i);const O=l.length;if(E>=l[O-1])return p[O-1].evaluate(i);const B=Rc(l,E),te=Es.interpolationFactor(this.interpolation,E,l[B],l[B+1]),se=p[B].evaluate(i),me=p[B+1].evaluate(i);return this.operator==="interpolate"?Pl[this.type.kind.toLowerCase()](se,me,te):this.operator==="interpolate-hcl"?Dl.reverse(Dl.interpolate(Dl.forward(se),Dl.forward(me),te)):Il.reverse(Il.interpolate(Il.forward(se),Il.forward(me),te))}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function su(o,i,l,p){const E=p-l,O=o-l;return E===0?0:i===1?O/E:(Math.pow(i,O)-1)/(Math.pow(i,E)-1)}class zc{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expectected at least one argument.");let p=null;const E=l.expectedType;E&&E.kind!=="value"&&(p=E);const O=[];for(const te of i.slice(1)){const se=l.parse(te,1+O.length,p,void 0,{typeAnnotation:"omit"});if(!se)return null;p=p||se.type,O.push(se)}if(!p)throw new Error("No output type");const B=E&&O.some(te=>At(E,te.type));return new zc(B?Vt:p,O)}evaluate(i){let l,p=null,E=0;for(const O of this.args)if(E++,p=O.evaluate(i),p&&p instanceof tt&&!p.available&&(l||(l=p.name),p=null,E===this.args.length&&(p=l)),p!==null)break;return p}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}class Nc{constructor(i,l){this.type=l.type,this.bindings=[].concat(i),this.result=l}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const l of this.bindings)i(l[1]);i(this.result)}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const p=[];for(let O=1;O<i.length-1;O+=2){const B=i[O];if(typeof B!="string")return l.error(`Expected string, but found ${typeof B} instead.`,O);if(/[^a-zA-Z0-9_]/.test(B))return l.error("Variable names must contain only alphanumeric characters or '_'.",O);const te=l.parse(i[O+1],O+1);if(!te)return null;p.push([B,te])}const E=l.parse(i[i.length-1],i.length-1,l.expectedType,p);return E?new Nc(p,E):null}outputDefined(){return this.result.outputDefined()}}class ou{constructor(i,l,p){this.type=i,this.index=l,this.input=p}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,pt),E=l.parse(i[2],2,Xi(l.expectedType||Vt));return p&&E?new ou(E.type.itemType,p,E):null}evaluate(i){const l=this.index.evaluate(i),p=this.input.evaluate(i);if(l<0)throw new Zt(`Array index out of bounds: ${l} < 0.`);if(l>=p.length)throw new Zt(`Array index out of bounds: ${l} > ${p.length-1}.`);if(l!==Math.floor(l))throw new Zt(`Array index must be an integer, but found ${l} instead.`);return p[l]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class au{constructor(i,l){this.type=Et,this.needle=i,this.haystack=l}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,Vt),E=l.parse(i[2],2,Vt);return p&&E?Nt(p.type,[Et,Ct,pt,Rt,Vt])?new au(p,E):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ht(p.type)} instead`):null}evaluate(i){const l=this.needle.evaluate(i),p=this.haystack.evaluate(i);if(!p)return!1;if(!Wt(l,["boolean","string","number","null"]))throw new Zt(`Expected first argument to be of type boolean, string, number or null, but found ${ht(Lt(l))} instead.`);if(!Wt(p,["string","array"]))throw new Zt(`Expected second argument to be of type array or string, but found ${ht(Lt(p))} instead.`);return p.indexOf(l)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class jc{constructor(i,l,p){this.type=pt,this.needle=i,this.haystack=l,this.fromIndex=p}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,Vt),E=l.parse(i[2],2,Vt);if(!p||!E)return null;if(!Nt(p.type,[Et,Ct,pt,Rt,Vt]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ht(p.type)} instead`);if(i.length===4){const O=l.parse(i[3],3,pt);return O?new jc(p,E,O):null}return new jc(p,E)}evaluate(i){const l=this.needle.evaluate(i),p=this.haystack.evaluate(i);if(!Wt(l,["boolean","string","number","null"]))throw new Zt(`Expected first argument to be of type boolean, string, number or null, but found ${ht(Lt(l))} instead.`);if(!Wt(p,["string","array"]))throw new Zt(`Expected second argument to be of type array or string, but found ${ht(Lt(p))} instead.`);if(this.fromIndex){const E=this.fromIndex.evaluate(i);return p.indexOf(l,E)}return p.indexOf(l)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class lu{constructor(i,l,p,E,O,B){this.inputType=i,this.type=l,this.input=p,this.cases=E,this.outputs=O,this.otherwise=B}static parse(i,l){if(i.length<5)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return l.error("Expected an even number of arguments.");let p,E;l.expectedType&&l.expectedType.kind!=="value"&&(E=l.expectedType);const O={},B=[];for(let me=2;me<i.length-1;me+=2){let Se=i[me];const De=i[me+1];Array.isArray(Se)||(Se=[Se]);const Be=l.concat(me);if(Se.length===0)return Be.error("Expected at least one branch label.");for(const Ye of Se){if(typeof Ye!="number"&&typeof Ye!="string")return Be.error("Branch labels must be numbers or strings.");if(typeof Ye=="number"&&Math.abs(Ye)>Number.MAX_SAFE_INTEGER)return Be.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Ye=="number"&&Math.floor(Ye)!==Ye)return Be.error("Numeric branch labels must be integer values.");if(p){if(Be.checkSubtype(p,Lt(Ye)))return null}else p=Lt(Ye);if(O[String(Ye)]!==void 0)return Be.error("Branch labels must be unique.");O[String(Ye)]=B.length}const Ve=l.parse(De,me,E);if(!Ve)return null;E=E||Ve.type,B.push(Ve)}const te=l.parse(i[1],1,Vt);if(!te)return null;const se=l.parse(i[i.length-1],i.length-1,E);return se?te.type.kind!=="value"&&l.concat(1).checkSubtype(p,te.type)?null:new lu(p,E,te,O,B,se):null}evaluate(i){const l=this.input.evaluate(i);return(Lt(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class cu{constructor(i,l,p){this.type=i,this.branches=l,this.otherwise=p}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return l.error("Expected an odd number of arguments.");let p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);const E=[];for(let B=1;B<i.length-1;B+=2){const te=l.parse(i[B],B,Et);if(!te)return null;const se=l.parse(i[B+1],B+1,p);if(!se)return null;E.push([te,se]),p=p||se.type}const O=l.parse(i[i.length-1],i.length-1,p);if(!O)return null;if(!p)throw new Error("Can't infer output type");return new cu(p,E,O)}evaluate(i){for(const[l,p]of this.branches)if(l.evaluate(i))return p.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[l,p]of this.branches)i(l),i(p);i(this.otherwise)}outputDefined(){return this.branches.every(([i,l])=>l.outputDefined())&&this.otherwise.outputDefined()}}class Bc{constructor(i,l,p,E){this.type=i,this.input=l,this.beginIndex=p,this.endIndex=E}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,Vt),E=l.parse(i[2],2,pt);if(!p||!E)return null;if(!Nt(p.type,[Xi(Vt),Ct,Vt]))return l.error(`Expected first argument to be of type array or string, but found ${ht(p.type)} instead`);if(i.length===4){const O=l.parse(i[3],3,pt);return O?new Bc(p.type,p,E,O):null}return new Bc(p.type,p,E)}evaluate(i){const l=this.input.evaluate(i),p=this.beginIndex.evaluate(i);if(!Wt(l,["string","array"]))throw new Zt(`Expected first argument to be of type array or string, but found ${ht(Lt(l))} instead.`);if(this.endIndex){const E=this.endIndex.evaluate(i);return l.slice(p,E)}return l.slice(p)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function Qd(o,i){return o==="=="||o==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function Jd(o,i,l,p){return p.compare(i,l)===0}function Ba(o,i,l){const p=o!=="=="&&o!=="!=";return class ET{constructor(O,B,te){this.type=Et,this.lhs=O,this.rhs=B,this.collator=te,this.hasUntypedArgument=O.type.kind==="value"||B.type.kind==="value"}static parse(O,B){if(O.length!==3&&O.length!==4)return B.error("Expected two or three arguments.");const te=O[0];let se=B.parse(O[1],1,Vt);if(!se)return null;if(!Qd(te,se.type))return B.concat(1).error(`"${te}" comparisons are not supported for type '${ht(se.type)}'.`);let me=B.parse(O[2],2,Vt);if(!me)return null;if(!Qd(te,me.type))return B.concat(2).error(`"${te}" comparisons are not supported for type '${ht(me.type)}'.`);if(se.type.kind!==me.type.kind&&se.type.kind!=="value"&&me.type.kind!=="value")return B.error(`Cannot compare types '${ht(se.type)}' and '${ht(me.type)}'.`);p&&(se.type.kind==="value"&&me.type.kind!=="value"?se=new gi(me.type,[se]):se.type.kind!=="value"&&me.type.kind==="value"&&(me=new gi(se.type,[me])));let Se=null;if(O.length===4){if(se.type.kind!=="string"&&me.type.kind!=="string"&&se.type.kind!=="value"&&me.type.kind!=="value")return B.error("Cannot use collator to compare non-string types.");if(Se=B.parse(O[3],3,Ji),!Se)return null}return new ET(se,me,Se)}evaluate(O){const B=this.lhs.evaluate(O),te=this.rhs.evaluate(O);if(p&&this.hasUntypedArgument){const se=Lt(B),me=Lt(te);if(se.kind!==me.kind||se.kind!=="string"&&se.kind!=="number")throw new Zt(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${se.kind}, ${me.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const se=Lt(B),me=Lt(te);if(se.kind!=="string"||me.kind!=="string")return i(O,B,te)}return this.collator?l(O,B,te,this.collator.evaluate(O)):i(O,B,te)}eachChild(O){O(this.lhs),O(this.rhs),this.collator&&O(this.collator)}outputDefined(){return!0}}}const wm=Ba("==",function(o,i,l){return i===l},Jd),Tm=Ba("!=",function(o,i,l){return i!==l},function(o,i,l,p){return!Jd(0,i,l,p)}),Em=Ba("<",function(o,i,l){return i<l},function(o,i,l,p){return p.compare(i,l)<0}),Cm=Ba(">",function(o,i,l){return i>l},function(o,i,l,p){return p.compare(i,l)>0}),Sm=Ba("<=",function(o,i,l){return i<=l},function(o,i,l,p){return p.compare(i,l)<=0}),km=Ba(">=",function(o,i,l){return i>=l},function(o,i,l,p){return p.compare(i,l)>=0});class hu{constructor(i,l,p,E,O){this.type=Ct,this.number=i,this.locale=l,this.currency=p,this.minFractionDigits=E,this.maxFractionDigits=O}static parse(i,l){if(i.length!==3)return l.error("Expected two arguments.");const p=l.parse(i[1],1,pt);if(!p)return null;const E=i[2];if(typeof E!="object"||Array.isArray(E))return l.error("NumberFormat options argument must be an object.");let O=null;if(E.locale&&(O=l.parse(E.locale,1,Ct),!O))return null;let B=null;if(E.currency&&(B=l.parse(E.currency,1,Ct),!B))return null;let te=null;if(E["min-fraction-digits"]&&(te=l.parse(E["min-fraction-digits"],1,pt),!te))return null;let se=null;return E["max-fraction-digits"]&&(se=l.parse(E["max-fraction-digits"],1,pt),!se)?null:new hu(p,O,B,te,se)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class Fc{constructor(i){this.type=Vi,this.sections=i}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const p=i[1];if(!Array.isArray(p)&&typeof p=="object")return l.error("First argument must be an image or text section.");const E=[];let O=!1;for(let B=1;B<=i.length-1;++B){const te=i[B];if(O&&typeof te=="object"&&!Array.isArray(te)){O=!1;let se=null;if(te["font-scale"]&&(se=l.parse(te["font-scale"],1,pt),!se))return null;let me=null;if(te["text-font"]&&(me=l.parse(te["text-font"],1,Xi(Ct)),!me))return null;let Se=null;if(te["text-color"]&&(Se=l.parse(te["text-color"],1,ri),!Se))return null;const De=E[E.length-1];De.scale=se,De.font=me,De.textColor=Se}else{const se=l.parse(i[B],1,Vt);if(!se)return null;const me=se.type.kind;if(me!=="string"&&me!=="value"&&me!=="null"&&me!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");O=!0,E.push({content:se,scale:null,font:null,textColor:null})}}return new Fc(E)}evaluate(i){return new lt(this.sections.map(l=>{const p=l.content.evaluate(i);return Lt(p)===Tr?new it("",p,null,null,null):new it(It(p),null,l.scale?l.scale.evaluate(i):null,l.font?l.font.evaluate(i).join(","):null,l.textColor?l.textColor.evaluate(i):null)}))}eachChild(i){for(const l of this.sections)i(l.content),l.scale&&i(l.scale),l.font&&i(l.font),l.textColor&&i(l.textColor)}outputDefined(){return!1}}class uu{constructor(i){this.type=Tr,this.input=i}static parse(i,l){if(i.length!==2)return l.error("Expected two arguments.");const p=l.parse(i[1],1,Ct);return p?new uu(p):l.error("No image name provided.")}evaluate(i){const l=this.input.evaluate(i),p=tt.fromString(l);return p&&i.availableImages&&(p.available=i.availableImages.indexOf(l)>-1),p}eachChild(i){i(this.input)}outputDefined(){return!1}}class du{constructor(i){this.type=pt,this.input=i}static parse(i,l){if(i.length!==2)return l.error(`Expected 1 argument, but found ${i.length-1} instead.`);const p=l.parse(i[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${ht(p.type)} instead.`):new du(p):null}evaluate(i){const l=this.input.evaluate(i);if(typeof l=="string"||Array.isArray(l))return l.length;throw new Zt(`Expected value to be of type string or array, but found ${ht(Lt(l))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}const Fa={"==":wm,"!=":Tm,">":Cm,"<":Em,">=":km,"<=":Sm,array:gi,at:ou,boolean:gi,case:cu,coalesce:zc,collator:rr,format:Fc,image:uu,in:au,"index-of":jc,interpolate:Es,"interpolate-hcl":Es,"interpolate-lab":Es,length:du,let:Nc,literal:si,match:lu,number:gi,"number-format":hu,object:gi,slice:Bc,step:Al,string:gi,"to-boolean":yi,"to-color":yi,"to-number":yi,"to-string":yi,var:Dc,within:ca};function ep(o,[i,l,p,E]){i=i.evaluate(o),l=l.evaluate(o),p=p.evaluate(o);const O=E?E.evaluate(o):1,B=ft(i,l,p,O);if(B)throw new Zt(B);return new Ne(i/255*O,l/255*O,p/255*O,O)}function tp(o,i){return o in i}function pu(o,i){const l=i[o];return l===void 0?null:l}function Bo(o){return{type:o}}function ip(o){return{result:"success",value:o}}function Ua(o){return{result:"error",value:o}}function $a(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function tn(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function fu(o){return!!o.expression&&o.expression.interpolated}function bi(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function Ga(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)}function qr(o){return o}function Nr(o,i){const l=i.type==="color",p=o.stops&&typeof o.stops[0][0]=="object",E=p||!(p||o.property!==void 0),O=o.type||(fu(i)?"exponential":"interval");if(l||i.type==="padding"){const me=l?Ne.parse:st.parse;(o=rt({},o)).stops&&(o.stops=o.stops.map(Se=>[Se[0],me(Se[1])])),o.default=me(o.default?o.default:i.default)}if(o.colorSpace&&o.colorSpace!=="rgb"&&!Kd[o.colorSpace])throw new Error(`Unknown color space: ${o.colorSpace}`);let B,te,se;if(O==="exponential")B=np;else if(O==="interval")B=Mm;else if(O==="categorical"){B=rp,te=Object.create(null);for(const me of o.stops)te[me[0]]=me[1];se=typeof o.stops[0][0]}else{if(O!=="identity")throw new Error(`Unknown function type "${O}"`);B=Am}if(p){const me={},Se=[];for(let Ve=0;Ve<o.stops.length;Ve++){const Ye=o.stops[Ve],ct=Ye[0].zoom;me[ct]===void 0&&(me[ct]={zoom:ct,type:o.type,property:o.property,default:o.default,stops:[]},Se.push(ct)),me[ct].stops.push([Ye[0].value,Ye[1]])}const De=[];for(const Ve of Se)De.push([me[Ve].zoom,Nr(me[Ve],i)]);const Be={name:"linear"};return{kind:"composite",interpolationType:Be,interpolationFactor:Es.interpolationFactor.bind(void 0,Be),zoomStops:De.map(Ve=>Ve[0]),evaluate:({zoom:Ve},Ye)=>np({stops:De,base:o.base},i,Ve).evaluate(Ve,Ye)}}if(E){const me=O==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:me,interpolationFactor:Es.interpolationFactor.bind(void 0,me),zoomStops:o.stops.map(Se=>Se[0]),evaluate:({zoom:Se})=>B(o,i,Se,te,se)}}return{kind:"source",evaluate(me,Se){const De=Se&&Se.properties?Se.properties[o.property]:void 0;return De===void 0?Fo(o.default,i.default):B(o,i,De,te,se)}}}function Fo(o,i,l){return o!==void 0?o:i!==void 0?i:l!==void 0?l:void 0}function rp(o,i,l,p,E){return Fo(typeof l===E?p[l]:void 0,o.default,i.default)}function Mm(o,i,l){if(bi(l)!=="number")return Fo(o.default,i.default);const p=o.stops.length;if(p===1||l<=o.stops[0][0])return o.stops[0][1];if(l>=o.stops[p-1][0])return o.stops[p-1][1];const E=Rc(o.stops.map(O=>O[0]),l);return o.stops[E][1]}function np(o,i,l){const p=o.base!==void 0?o.base:1;if(bi(l)!=="number")return Fo(o.default,i.default);const E=o.stops.length;if(E===1||l<=o.stops[0][0])return o.stops[0][1];if(l>=o.stops[E-1][0])return o.stops[E-1][1];const O=Rc(o.stops.map(Se=>Se[0]),l),B=function(Se,De,Be,Ve){const Ye=Ve-Be,ct=Se-Be;return Ye===0?0:De===1?ct/Ye:(Math.pow(De,ct)-1)/(Math.pow(De,Ye)-1)}(l,p,o.stops[O][0],o.stops[O+1][0]),te=o.stops[O][1],se=o.stops[O+1][1];let me=Pl[i.type]||qr;if(o.colorSpace&&o.colorSpace!=="rgb"){const Se=Kd[o.colorSpace];me=(De,Be)=>Se.reverse(Se.interpolate(Se.forward(De),Se.forward(Be),B))}return typeof te.evaluate=="function"?{evaluate(...Se){const De=te.evaluate.apply(void 0,Se),Be=se.evaluate.apply(void 0,Se);if(De!==void 0&&Be!==void 0)return me(De,Be,B)}}:me(te,se,B)}function Am(o,i,l){switch(i.type){case"color":l=Ne.parse(l);break;case"formatted":l=lt.fromString(l.toString());break;case"resolvedImage":l=tt.fromString(l.toString());break;case"padding":l=st.parse(l);break;default:bi(l)===i.type||i.type==="enum"&&i.values[l]||(l=void 0)}return Fo(l,o.default,i.default)}Li.register(Fa,{error:[{kind:"error"},[Ct],(o,[i])=>{throw new Zt(i.evaluate(o))}],typeof:[Ct,[Vt],(o,[i])=>ht(Lt(i.evaluate(o)))],"to-rgba":[Xi(pt,4),[ri],(o,[i])=>i.evaluate(o).toArray()],rgb:[ri,[pt,pt,pt],ep],rgba:[ri,[pt,pt,pt,pt],ep],has:{type:Et,overloads:[[[Ct],(o,[i])=>tp(i.evaluate(o),o.properties())],[[Ct,ci],(o,[i,l])=>tp(i.evaluate(o),l.evaluate(o))]]},get:{type:Vt,overloads:[[[Ct],(o,[i])=>pu(i.evaluate(o),o.properties())],[[Ct,ci],(o,[i,l])=>pu(i.evaluate(o),l.evaluate(o))]]},"feature-state":[Vt,[Ct],(o,[i])=>pu(i.evaluate(o),o.featureState||{})],properties:[ci,[],o=>o.properties()],"geometry-type":[Ct,[],o=>o.geometryType()],id:[Vt,[],o=>o.id()],zoom:[pt,[],o=>o.globals.zoom],"heatmap-density":[pt,[],o=>o.globals.heatmapDensity||0],"line-progress":[pt,[],o=>o.globals.lineProgress||0],accumulated:[Vt,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[pt,Bo(pt),(o,i)=>{let l=0;for(const p of i)l+=p.evaluate(o);return l}],"*":[pt,Bo(pt),(o,i)=>{let l=1;for(const p of i)l*=p.evaluate(o);return l}],"-":{type:pt,overloads:[[[pt,pt],(o,[i,l])=>i.evaluate(o)-l.evaluate(o)],[[pt],(o,[i])=>-i.evaluate(o)]]},"/":[pt,[pt,pt],(o,[i,l])=>i.evaluate(o)/l.evaluate(o)],"%":[pt,[pt,pt],(o,[i,l])=>i.evaluate(o)%l.evaluate(o)],ln2:[pt,[],()=>Math.LN2],pi:[pt,[],()=>Math.PI],e:[pt,[],()=>Math.E],"^":[pt,[pt,pt],(o,[i,l])=>Math.pow(i.evaluate(o),l.evaluate(o))],sqrt:[pt,[pt],(o,[i])=>Math.sqrt(i.evaluate(o))],log10:[pt,[pt],(o,[i])=>Math.log(i.evaluate(o))/Math.LN10],ln:[pt,[pt],(o,[i])=>Math.log(i.evaluate(o))],log2:[pt,[pt],(o,[i])=>Math.log(i.evaluate(o))/Math.LN2],sin:[pt,[pt],(o,[i])=>Math.sin(i.evaluate(o))],cos:[pt,[pt],(o,[i])=>Math.cos(i.evaluate(o))],tan:[pt,[pt],(o,[i])=>Math.tan(i.evaluate(o))],asin:[pt,[pt],(o,[i])=>Math.asin(i.evaluate(o))],acos:[pt,[pt],(o,[i])=>Math.acos(i.evaluate(o))],atan:[pt,[pt],(o,[i])=>Math.atan(i.evaluate(o))],min:[pt,Bo(pt),(o,i)=>Math.min(...i.map(l=>l.evaluate(o)))],max:[pt,Bo(pt),(o,i)=>Math.max(...i.map(l=>l.evaluate(o)))],abs:[pt,[pt],(o,[i])=>Math.abs(i.evaluate(o))],round:[pt,[pt],(o,[i])=>{const l=i.evaluate(o);return l<0?-Math.round(-l):Math.round(l)}],floor:[pt,[pt],(o,[i])=>Math.floor(i.evaluate(o))],ceil:[pt,[pt],(o,[i])=>Math.ceil(i.evaluate(o))],"filter-==":[Et,[Ct,Vt],(o,[i,l])=>o.properties()[i.value]===l.value],"filter-id-==":[Et,[Vt],(o,[i])=>o.id()===i.value],"filter-type-==":[Et,[Ct],(o,[i])=>o.geometryType()===i.value],"filter-<":[Et,[Ct,Vt],(o,[i,l])=>{const p=o.properties()[i.value],E=l.value;return typeof p==typeof E&&p<E}],"filter-id-<":[Et,[Vt],(o,[i])=>{const l=o.id(),p=i.value;return typeof l==typeof p&&l<p}],"filter->":[Et,[Ct,Vt],(o,[i,l])=>{const p=o.properties()[i.value],E=l.value;return typeof p==typeof E&&p>E}],"filter-id->":[Et,[Vt],(o,[i])=>{const l=o.id(),p=i.value;return typeof l==typeof p&&l>p}],"filter-<=":[Et,[Ct,Vt],(o,[i,l])=>{const p=o.properties()[i.value],E=l.value;return typeof p==typeof E&&p<=E}],"filter-id-<=":[Et,[Vt],(o,[i])=>{const l=o.id(),p=i.value;return typeof l==typeof p&&l<=p}],"filter->=":[Et,[Ct,Vt],(o,[i,l])=>{const p=o.properties()[i.value],E=l.value;return typeof p==typeof E&&p>=E}],"filter-id->=":[Et,[Vt],(o,[i])=>{const l=o.id(),p=i.value;return typeof l==typeof p&&l>=p}],"filter-has":[Et,[Vt],(o,[i])=>i.value in o.properties()],"filter-has-id":[Et,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[Et,[Xi(Ct)],(o,[i])=>i.value.indexOf(o.geometryType())>=0],"filter-id-in":[Et,[Xi(Vt)],(o,[i])=>i.value.indexOf(o.id())>=0],"filter-in-small":[Et,[Ct,Xi(Vt)],(o,[i,l])=>l.value.indexOf(o.properties()[i.value])>=0],"filter-in-large":[Et,[Ct,Xi(Vt)],(o,[i,l])=>function(p,E,O,B){for(;O<=B;){const te=O+B>>1;if(E[te]===p)return!0;E[te]>p?B=te-1:O=te+1}return!1}(o.properties()[i.value],l.value,0,l.value.length-1)],all:{type:Et,overloads:[[[Et,Et],(o,[i,l])=>i.evaluate(o)&&l.evaluate(o)],[Bo(Et),(o,i)=>{for(const l of i)if(!l.evaluate(o))return!1;return!0}]]},any:{type:Et,overloads:[[[Et,Et],(o,[i,l])=>i.evaluate(o)||l.evaluate(o)],[Bo(Et),(o,i)=>{for(const l of i)if(l.evaluate(o))return!0;return!1}]]},"!":[Et,[Et],(o,[i])=>!i.evaluate(o)],"is-supported-script":[Et,[Ct],(o,[i])=>{const l=o.globals&&o.globals.isSupportedScript;return!l||l(i.evaluate(o))}],upcase:[Ct,[Ct],(o,[i])=>i.evaluate(o).toUpperCase()],downcase:[Ct,[Ct],(o,[i])=>i.evaluate(o).toLowerCase()],concat:[Ct,Bo(Vt),(o,i)=>i.map(l=>It(l.evaluate(o))).join("")],"resolved-locale":[Ct,[Ji],(o,[i])=>i.evaluate(o).resolvedLocale()]});class mu{constructor(i,l){this.expression=i,this._warningHistory={},this._evaluator=new Ni,this._defaultValue=l?function(p){return p.type==="color"&&Ga(p.default)?new Ne(0,0,0,0):p.type==="color"?Ne.parse(p.default)||null:p.type==="padding"?st.parse(p.default)||null:p.default===void 0?null:p.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(i,l,p,E,O,B){return this._evaluator.globals=i,this._evaluator.feature=l,this._evaluator.featureState=p,this._evaluator.canonical=E,this._evaluator.availableImages=O||null,this._evaluator.formattedSection=B,this.expression.evaluate(this._evaluator)}evaluate(i,l,p,E,O,B){this._evaluator.globals=i,this._evaluator.feature=l||null,this._evaluator.featureState=p||null,this._evaluator.canonical=E,this._evaluator.availableImages=O||null,this._evaluator.formattedSection=B||null;try{const te=this.expression.evaluate(this._evaluator);if(te==null||typeof te=="number"&&te!=te)return this._defaultValue;if(this._enumValues&&!(te in this._enumValues))throw new Zt(`Expected value to be one of ${Object.keys(this._enumValues).map(se=>JSON.stringify(se)).join(", ")}, but found ${JSON.stringify(te)} instead.`);return te}catch(te){return this._warningHistory[te.message]||(this._warningHistory[te.message]=!0,typeof console<"u"&&console.warn(te.message)),this._defaultValue}}}function Ll(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in Fa}function Rl(o,i){const l=new Lc(Fa,[],i?function(E){const O={color:ri,string:Ct,number:pt,enum:Ct,boolean:Et,formatted:Vi,padding:ar,resolvedImage:Tr};return E.type==="array"?Xi(O[E.value]||Vt,E.length):O[E.type]}(i):void 0),p=l.parse(o,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?ip(new mu(p,i)):Ua(l.errors)}class Uc{constructor(i,l){this.kind=i,this._styleExpression=l,this.isStateDependent=i!=="constant"&&!ja(l.expression)}evaluateWithoutErrorHandling(i,l,p,E,O,B){return this._styleExpression.evaluateWithoutErrorHandling(i,l,p,E,O,B)}evaluate(i,l,p,E,O,B){return this._styleExpression.evaluate(i,l,p,E,O,B)}}class Ol{constructor(i,l,p,E){this.kind=i,this.zoomStops=p,this._styleExpression=l,this.isStateDependent=i!=="camera"&&!ja(l.expression),this.interpolationType=E}evaluateWithoutErrorHandling(i,l,p,E,O,B){return this._styleExpression.evaluateWithoutErrorHandling(i,l,p,E,O,B)}evaluate(i,l,p,E,O,B){return this._styleExpression.evaluate(i,l,p,E,O,B)}interpolationFactor(i,l,p){return this.interpolationType?Es.interpolationFactor(this.interpolationType,i,l,p):0}}function sp(o,i){const l=Rl(o,i);if(l.result==="error")return l;const p=l.value.expression,E=Ic(p);if(!E&&!$a(i))return Ua([new mt("","data expressions not supported")]);const O=kl(p,["zoom"]);if(!O&&!tn(i))return Ua([new mt("","zoom expressions not supported")]);const B=Gc(p);return B||O?B instanceof mt?Ua([B]):B instanceof Es&&!fu(i)?Ua([new mt("",'"interpolate" expressions cannot be used with this property')]):ip(B?new Ol(E?"camera":"composite",l.value,B.labels,B instanceof Es?B.interpolation:void 0):new Uc(E?"constant":"source",l.value)):Ua([new mt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class $c{constructor(i,l){this._parameters=i,this._specification=l,rt(this,Nr(this._parameters,this._specification))}static deserialize(i){return new $c(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Gc(o){let i=null;if(o instanceof Nc)i=Gc(o.result);else if(o instanceof zc){for(const l of o.args)if(i=Gc(l),i)break}else(o instanceof Al||o instanceof Es)&&o.input instanceof Li&&o.input.name==="zoom"&&(i=o);return i instanceof mt||o.eachChild(l=>{const p=Gc(l);p instanceof mt?i=p:!i&&p?i=new mt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&p&&i!==p&&(i=new mt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function Qs(o){const i=o.key,l=o.value,p=o.valueSpec||{},E=o.objectElementValidators||{},O=o.style,B=o.styleSpec;let te=[];const se=bi(l);if(se!=="object")return[new Fe(i,l,`object expected, ${se} found`)];for(const me in l){const Se=me.split(".")[0],De=p[Se]||p["*"];let Be;if(E[Se])Be=E[Se];else if(p[Se])Be=Hn;else if(E["*"])Be=E["*"];else{if(!p["*"]){te.push(new Fe(i,l[me],`unknown property "${me}"`));continue}Be=Hn}te=te.concat(Be({key:(i&&`${i}.`)+me,value:l[me],valueSpec:De,style:O,styleSpec:B,object:l,objectKey:me},l))}for(const me in p)E[me]||p[me].required&&p[me].default===void 0&&l[me]===void 0&&te.push(new Fe(i,l,`missing required property "${me}"`));return te}function op(o){const i=o.value,l=o.valueSpec,p=o.style,E=o.styleSpec,O=o.key,B=o.arrayElementValidator||Hn;if(bi(i)!=="array")return[new Fe(O,i,`array expected, ${bi(i)} found`)];if(l.length&&i.length!==l.length)return[new Fe(O,i,`array length ${l.length} expected, length ${i.length} found`)];if(l["min-length"]&&i.length<l["min-length"])return[new Fe(O,i,`array length at least ${l["min-length"]} expected, length ${i.length} found`)];let te={type:l.value,values:l.values};E.$version<7&&(te.function=l.function),bi(l.value)==="object"&&(te=l.value);let se=[];for(let me=0;me<i.length;me++)se=se.concat(B({array:i,arrayIndex:me,value:i[me],valueSpec:te,style:p,styleSpec:E,key:`${O}[${me}]`}));return se}function gu(o){const i=o.key,l=o.value,p=o.valueSpec;let E=bi(l);return E==="number"&&l!=l&&(E="NaN"),E!=="number"?[new Fe(i,l,`number expected, ${E} found`)]:"minimum"in p&&l<p.minimum?[new Fe(i,l,`${l} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&l>p.maximum?[new Fe(i,l,`${l} is greater than the maximum value ${p.maximum}`)]:[]}function ap(o){const i=o.valueSpec,l=at(o.value.type);let p,E,O,B={};const te=l!=="categorical"&&o.value.property===void 0,se=!te,me=bi(o.value.stops)==="array"&&bi(o.value.stops[0])==="array"&&bi(o.value.stops[0][0])==="object",Se=Qs({key:o.key,value:o.value,valueSpec:o.styleSpec.function,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(Ve){if(l==="identity")return[new Fe(Ve.key,Ve.value,'identity function may not have a "stops" property')];let Ye=[];const ct=Ve.value;return Ye=Ye.concat(op({key:Ve.key,value:ct,valueSpec:Ve.valueSpec,style:Ve.style,styleSpec:Ve.styleSpec,arrayElementValidator:De})),bi(ct)==="array"&&ct.length===0&&Ye.push(new Fe(Ve.key,ct,"array must have at least one stop")),Ye},default:function(Ve){return Hn({key:Ve.key,value:Ve.value,valueSpec:i,style:Ve.style,styleSpec:Ve.styleSpec})}}});return l==="identity"&&te&&Se.push(new Fe(o.key,o.value,'missing required property "property"')),l==="identity"||o.value.stops||Se.push(new Fe(o.key,o.value,'missing required property "stops"')),l==="exponential"&&o.valueSpec.expression&&!fu(o.valueSpec)&&Se.push(new Fe(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(se&&!$a(o.valueSpec)?Se.push(new Fe(o.key,o.value,"property functions not supported")):te&&!tn(o.valueSpec)&&Se.push(new Fe(o.key,o.value,"zoom functions not supported"))),l!=="categorical"&&!me||o.value.property!==void 0||Se.push(new Fe(o.key,o.value,'"property" property is required')),Se;function De(Ve){let Ye=[];const ct=Ve.value,ot=Ve.key;if(bi(ct)!=="array")return[new Fe(ot,ct,`array expected, ${bi(ct)} found`)];if(ct.length!==2)return[new Fe(ot,ct,`array length 2 expected, length ${ct.length} found`)];if(me){if(bi(ct[0])!=="object")return[new Fe(ot,ct,`object expected, ${bi(ct[0])} found`)];if(ct[0].zoom===void 0)return[new Fe(ot,ct,"object stop key must have zoom")];if(ct[0].value===void 0)return[new Fe(ot,ct,"object stop key must have value")];if(O&&O>at(ct[0].zoom))return[new Fe(ot,ct[0].zoom,"stop zoom values must appear in ascending order")];at(ct[0].zoom)!==O&&(O=at(ct[0].zoom),E=void 0,B={}),Ye=Ye.concat(Qs({key:`${ot}[0]`,value:ct[0],valueSpec:{zoom:{}},style:Ve.style,styleSpec:Ve.styleSpec,objectElementValidators:{zoom:gu,value:Be}}))}else Ye=Ye.concat(Be({key:`${ot}[0]`,value:ct[0],valueSpec:{},style:Ve.style,styleSpec:Ve.styleSpec},ct));return Ll(ut(ct[1]))?Ye.concat([new Fe(`${ot}[1]`,ct[1],"expressions are not allowed in function stops.")]):Ye.concat(Hn({key:`${ot}[1]`,value:ct[1],valueSpec:i,style:Ve.style,styleSpec:Ve.styleSpec}))}function Be(Ve,Ye){const ct=bi(Ve.value),ot=at(Ve.value),bt=Ve.value!==null?Ve.value:Ye;if(p){if(ct!==p)return[new Fe(Ve.key,bt,`${ct} stop domain type must match previous stop domain type ${p}`)]}else p=ct;if(ct!=="number"&&ct!=="string"&&ct!=="boolean")return[new Fe(Ve.key,bt,"stop domain value must be a number, string, or boolean")];if(ct!=="number"&&l!=="categorical"){let Pt=`number expected, ${ct} found`;return $a(i)&&l===void 0&&(Pt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Fe(Ve.key,bt,Pt)]}return l!=="categorical"||ct!=="number"||isFinite(ot)&&Math.floor(ot)===ot?l!=="categorical"&&ct==="number"&&E!==void 0&&ot<E?[new Fe(Ve.key,bt,"stop domain values must appear in ascending order")]:(E=ot,l==="categorical"&&ot in B?[new Fe(Ve.key,bt,"stop domain values must be unique")]:(B[ot]=!0,[])):[new Fe(Ve.key,bt,`integer expected, found ${ot}`)]}}function Va(o){const i=(o.expressionContext==="property"?sp:Rl)(ut(o.value),o.valueSpec);if(i.result==="error")return i.value.map(p=>new Fe(`${o.key}${p.key}`,o.value,p.message));const l=i.value.expression||i.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!l.outputDefined())return[new Fe(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!ja(l))return[new Fe(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!ja(l))return[new Fe(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!kl(l,["zoom","feature-state"]))return[new Fe(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!Ic(l))return[new Fe(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function zl(o){const i=o.key,l=o.value,p=o.valueSpec,E=[];return Array.isArray(p.values)?p.values.indexOf(at(l))===-1&&E.push(new Fe(i,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(p.values).indexOf(at(l))===-1&&E.push(new Fe(i,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),E}function Vc(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const i of o.slice(1))if(!Vc(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}const Hc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function yu(o){if(o==null)return{filter:()=>!0,needGeometry:!1};Vc(o)||(o=Wc(o));const i=Rl(o,Hc);if(i.result==="error")throw new Error(i.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,p,E)=>i.value.evaluate(l,p,{},E),needGeometry:xu(o)}}function lp(o,i){return o<i?-1:o>i?1:0}function xu(o){if(!Array.isArray(o))return!1;if(o[0]==="within")return!0;for(let i=1;i<o.length;i++)if(xu(o[i]))return!0;return!1}function Wc(o){if(!o)return!0;const i=o[0];return o.length<=1?i!=="any":i==="=="?Yc(o[1],o[2],"=="):i==="!="?ha(Yc(o[1],o[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Yc(o[1],o[2],i):i==="any"?(l=o.slice(1),["any"].concat(l.map(Wc))):i==="all"?["all"].concat(o.slice(1).map(Wc)):i==="none"?["all"].concat(o.slice(1).map(Wc).map(ha)):i==="in"?cp(o[1],o.slice(2)):i==="!in"?ha(cp(o[1],o.slice(2))):i==="has"?qc(o[1]):i==="!has"?ha(qc(o[1])):i!=="within"||o;var l}function Yc(o,i,l){switch(o){case"$type":return[`filter-type-${l}`,i];case"$id":return[`filter-id-${l}`,i];default:return[`filter-${l}`,o,i]}}function cp(o,i){if(i.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(l=>typeof l!=typeof i[0])?["filter-in-large",o,["literal",i.sort(lp)]]:["filter-in-small",o,["literal",i]]}}function qc(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function ha(o){return["!",o]}function Nl(o){return Vc(ut(o.value))?Va(rt({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Xc(o)}function Xc(o){const i=o.value,l=o.key;if(bi(i)!=="array")return[new Fe(l,i,`array expected, ${bi(i)} found`)];const p=o.styleSpec;let E,O=[];if(i.length<1)return[new Fe(l,i,"filter array must have at least 1 element")];switch(O=O.concat(zl({key:`${l}[0]`,value:i[0],valueSpec:p.filter_operator,style:o.style,styleSpec:o.styleSpec})),at(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&at(i[1])==="$type"&&O.push(new Fe(l,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&O.push(new Fe(l,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(E=bi(i[1]),E!=="string"&&O.push(new Fe(`${l}[1]`,i[1],`string expected, ${E} found`)));for(let B=2;B<i.length;B++)E=bi(i[B]),at(i[1])==="$type"?O=O.concat(zl({key:`${l}[${B}]`,value:i[B],valueSpec:p.geometry_type,style:o.style,styleSpec:o.styleSpec})):E!=="string"&&E!=="number"&&E!=="boolean"&&O.push(new Fe(`${l}[${B}]`,i[B],`string, number, or boolean expected, ${E} found`));break;case"any":case"all":case"none":for(let B=1;B<i.length;B++)O=O.concat(Xc({key:`${l}[${B}]`,value:i[B],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":E=bi(i[1]),i.length!==2?O.push(new Fe(l,i,`filter array for "${i[0]}" operator must have 2 elements`)):E!=="string"&&O.push(new Fe(`${l}[1]`,i[1],`string expected, ${E} found`));break;case"within":E=bi(i[1]),i.length!==2?O.push(new Fe(l,i,`filter array for "${i[0]}" operator must have 2 elements`)):E!=="object"&&O.push(new Fe(`${l}[1]`,i[1],`object expected, ${E} found`))}return O}function hp(o,i){const l=o.key,p=o.style,E=o.styleSpec,O=o.value,B=o.objectKey,te=E[`${i}_${o.layerType}`];if(!te)return[];const se=B.match(/^(.*)-transition$/);if(i==="paint"&&se&&te[se[1]]&&te[se[1]].transition)return Hn({key:l,value:O,valueSpec:E.transition,style:p,styleSpec:E});const me=o.valueSpec||te[B];if(!me)return[new Fe(l,O,`unknown property "${B}"`)];let Se;if(bi(O)==="string"&&$a(me)&&!me.tokens&&(Se=/^{([^}]+)}$/.exec(O)))return[new Fe(l,O,`"${B}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Se[1])} }\`.`)];const De=[];return o.layerType==="symbol"&&(B==="text-field"&&p&&!p.glyphs&&De.push(new Fe(l,O,'use of "text-field" requires a style "glyphs" property')),B==="text-font"&&Ga(ut(O))&&at(O.type)==="identity"&&De.push(new Fe(l,O,'"text-font" does not support identity functions'))),De.concat(Hn({key:o.key,value:O,valueSpec:me,style:p,styleSpec:E,expressionContext:"property",propertyType:i,propertyKey:B}))}function jl(o){return hp(o,"paint")}function up(o){return hp(o,"layout")}function dp(o){let i=[];const l=o.value,p=o.key,E=o.style,O=o.styleSpec;l.type||l.ref||i.push(new Fe(p,l,'either "type" or "ref" is required'));let B=at(l.type);const te=at(l.ref);if(l.id){const se=at(l.id);for(let me=0;me<o.arrayIndex;me++){const Se=E.layers[me];at(Se.id)===se&&i.push(new Fe(p,l.id,`duplicate layer id "${l.id}", previously used at line ${Se.id.__line__}`))}}if("ref"in l){let se;["type","source","source-layer","filter","layout"].forEach(me=>{me in l&&i.push(new Fe(p,l[me],`"${me}" is prohibited for ref layers`))}),E.layers.forEach(me=>{at(me.id)===te&&(se=me)}),se?se.ref?i.push(new Fe(p,l.ref,"ref cannot reference another ref layer")):B=at(se.type):i.push(new Fe(p,l.ref,`ref layer "${te}" not found`))}else if(B!=="background")if(l.source){const se=E.sources&&E.sources[l.source],me=se&&at(se.type);se?me==="vector"&&B==="raster"?i.push(new Fe(p,l.source,`layer "${l.id}" requires a raster source`)):me==="raster"&&B!=="raster"?i.push(new Fe(p,l.source,`layer "${l.id}" requires a vector source`)):me!=="vector"||l["source-layer"]?me==="raster-dem"&&B!=="hillshade"?i.push(new Fe(p,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):B!=="line"||!l.paint||!l.paint["line-gradient"]||me==="geojson"&&se.lineMetrics||i.push(new Fe(p,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new Fe(p,l,`layer "${l.id}" must specify a "source-layer"`)):i.push(new Fe(p,l.source,`source "${l.source}" not found`))}else i.push(new Fe(p,l,'missing required property "source"'));return i=i.concat(Qs({key:p,value:l,valueSpec:O.layer,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Hn({key:`${p}.type`,value:l.type,valueSpec:O.layer.type,style:o.style,styleSpec:o.styleSpec,object:l,objectKey:"type"}),filter:Nl,layout:se=>Qs({layer:l,key:se.key,value:se.value,style:se.style,styleSpec:se.styleSpec,objectElementValidators:{"*":me=>up(rt({layerType:B},me))}}),paint:se=>Qs({layer:l,key:se.key,value:se.value,style:se.style,styleSpec:se.styleSpec,objectElementValidators:{"*":me=>jl(rt({layerType:B},me))}})}})),i}function Ha(o){const i=o.value,l=o.key,p=bi(i);return p!=="string"?[new Fe(l,i,`string expected, ${p} found`)]:[]}const pp={promoteId:function({key:o,value:i}){if(bi(i)==="string")return Ha({key:o,value:i});{const l=[];for(const p in i)l.push(...Ha({key:`${o}.${p}`,value:i[p]}));return l}}};function fp(o){const i=o.value,l=o.key,p=o.styleSpec,E=o.style;if(!i.type)return[new Fe(l,i,'"type" is required')];const O=at(i.type);let B;switch(O){case"vector":case"raster":case"raster-dem":return B=Qs({key:l,value:i,valueSpec:p[`source_${O.replace("-","_")}`],style:o.style,styleSpec:p,objectElementValidators:pp}),B;case"geojson":if(B=Qs({key:l,value:i,valueSpec:p.source_geojson,style:E,styleSpec:p,objectElementValidators:pp}),i.cluster)for(const te in i.clusterProperties){const[se,me]=i.clusterProperties[te],Se=typeof se=="string"?[se,["accumulated"],["get",te]]:se;B.push(...Va({key:`${l}.${te}.map`,value:me,expressionContext:"cluster-map"})),B.push(...Va({key:`${l}.${te}.reduce`,value:Se,expressionContext:"cluster-reduce"}))}return B;case"video":return Qs({key:l,value:i,valueSpec:p.source_video,style:E,styleSpec:p});case"image":return Qs({key:l,value:i,valueSpec:p.source_image,style:E,styleSpec:p});case"canvas":return[new Fe(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return zl({key:`${l}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:E,styleSpec:p})}}function Bl(o){const i=o.value,l=o.styleSpec,p=l.light,E=o.style;let O=[];const B=bi(i);if(i===void 0)return O;if(B!=="object")return O=O.concat([new Fe("light",i,`object expected, ${B} found`)]),O;for(const te in i){const se=te.match(/^(.*)-transition$/);O=O.concat(se&&p[se[1]]&&p[se[1]].transition?Hn({key:te,value:i[te],valueSpec:l.transition,style:E,styleSpec:l}):p[te]?Hn({key:te,value:i[te],valueSpec:p[te],style:E,styleSpec:l}):[new Fe(te,i[te],`unknown property "${te}"`)])}return O}function Fl(o){const i=o.value,l=o.styleSpec,p=l.terrain,E=o.style;let O=[];const B=bi(i);if(i===void 0)return O;if(B!=="object")return O=O.concat([new Fe("terrain",i,`object expected, ${B} found`)]),O;for(const te in i)O=O.concat(p[te]?Hn({key:te,value:i[te],valueSpec:p[te],style:E,styleSpec:l}):[new Fe(te,i[te],`unknown property "${te}"`)]);return O}const Cs={"*":()=>[],array:op,boolean:function(o){const i=o.value,l=o.key,p=bi(i);return p!=="boolean"?[new Fe(l,i,`boolean expected, ${p} found`)]:[]},number:gu,color:function(o){const i=o.key,l=o.value,p=bi(l);return p!=="string"?[new Fe(i,l,`color expected, ${p} found`)]:mi(l)===null?[new Fe(i,l,`color expected, "${l}" found`)]:[]},constants:Ke,enum:zl,filter:Nl,function:ap,layer:dp,object:Qs,source:fp,light:Bl,terrain:Fl,string:Ha,formatted:function(o){return Ha(o).length===0?[]:Va(o)},resolvedImage:function(o){return Ha(o).length===0?[]:Va(o)},padding:function(o){const i=o.key,l=o.value;if(bi(l)==="array"){if(l.length<1||l.length>4)return[new Fe(i,l,`padding requires 1 to 4 values; ${l.length} values found`)];const p={type:"number"};let E=[];for(let O=0;O<l.length;O++)E=E.concat(Hn({key:`${i}[${O}]`,value:l[O],valueSpec:p}));return E}return gu({key:i,value:l,valueSpec:{}})}};function Hn(o){const i=o.value,l=o.valueSpec,p=o.styleSpec;return l.expression&&Ga(at(i))?ap(o):l.expression&&Ll(ut(i))?Va(o):l.type&&Cs[l.type]?Cs[l.type](o):Qs(rt({},o,{valueSpec:l.type?p[l.type]:l}))}function Pm(o){const i=o.value,l=o.key,p=Ha(o);return p.length||(i.indexOf("{fontstack}")===-1&&p.push(new Fe(l,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&p.push(new Fe(l,i,'"glyphs" url must include a "{range}" token'))),p}function Uo(o,i=Re){let l=[];return l=l.concat(Hn({key:"",value:o,valueSpec:i.$root,styleSpec:i,style:o,objectElementValidators:{glyphs:Pm,"*":()=>[]}})),o.constants&&(l=l.concat(Ke({key:"constants",value:o.constants,style:o,styleSpec:i}))),mp(l)}function mp(o){return[].concat(o).sort((i,l)=>i.line-l.line)}function ua(o){return function(...i){return mp(o.apply(this,i))}}Uo.source=ua(fp),Uo.light=ua(Bl),Uo.terrain=ua(Fl),Uo.layer=ua(dp),Uo.filter=ua(Nl),Uo.paintProperty=ua(jl),Uo.layoutProperty=ua(up);const da=Uo,Im=da.light,bu=da.paintProperty,Dm=da.layoutProperty;function gp(o,i){let l=!1;if(i&&i.length)for(const p of i)o.fire(new Ie(new Error(p.message))),l=!0;return l}class pa{constructor(i,l,p){const E=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const B=new Int32Array(this.arrayBuffer);i=B[0],this.d=(l=B[1])+2*(p=B[2]);for(let se=0;se<this.d*this.d;se++){const me=B[3+se],Se=B[3+se+1];E.push(me===Se?null:B.subarray(me,Se))}const te=B[3+E.length+1];this.keys=B.subarray(B[3+E.length],te),this.bboxes=B.subarray(te),this.insert=this._insertReadonly}else{this.d=l+2*p;for(let B=0;B<this.d*this.d;B++)E.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=i,this.padding=p,this.scale=l/i,this.uid=0;const O=p/l*i;this.min=-O,this.max=i+O}insert(i,l,p,E,O){this._forEachCell(l,p,E,O,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(E),this.bboxes.push(O)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,l,p,E,O,B){this.cells[O].push(B)}query(i,l,p,E,O){const B=this.min,te=this.max;if(i<=B&&l<=B&&te<=p&&te<=E&&!O)return Array.prototype.slice.call(this.keys);{const se=[];return this._forEachCell(i,l,p,E,this._queryCell,se,{},O),se}}_queryCell(i,l,p,E,O,B,te,se){const me=this.cells[O];if(me!==null){const Se=this.keys,De=this.bboxes;for(let Be=0;Be<me.length;Be++){const Ve=me[Be];if(te[Ve]===void 0){const Ye=4*Ve;(se?se(De[Ye+0],De[Ye+1],De[Ye+2],De[Ye+3]):i<=De[Ye+2]&&l<=De[Ye+3]&&p>=De[Ye+0]&&E>=De[Ye+1])?(te[Ve]=!0,B.push(Se[Ve])):te[Ve]=!1}}}}_forEachCell(i,l,p,E,O,B,te,se){const me=this._convertToCellCoord(i),Se=this._convertToCellCoord(l),De=this._convertToCellCoord(p),Be=this._convertToCellCoord(E);for(let Ve=me;Ve<=De;Ve++)for(let Ye=Se;Ye<=Be;Ye++){const ct=this.d*Ye+Ve;if((!se||se(this._convertFromCellCoord(Ve),this._convertFromCellCoord(Ye),this._convertFromCellCoord(Ve+1),this._convertFromCellCoord(Ye+1)))&&O.call(this,i,l,p,E,ct,B,te,se))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,l=3+this.cells.length+1+1;let p=0;for(let B=0;B<this.cells.length;B++)p+=this.cells[B].length;const E=new Int32Array(l+p+this.keys.length+this.bboxes.length);E[0]=this.extent,E[1]=this.n,E[2]=this.padding;let O=l;for(let B=0;B<i.length;B++){const te=i[B];E[3+B]=O,E.set(te,O),O+=te.length}return E[3+i.length]=O,E.set(this.keys,O),O+=this.keys.length,E[3+i.length+1]=O,E.set(this.bboxes,O),O+=this.bboxes.length,E.buffer}static serialize(i,l){const p=i.toArrayBuffer();return l&&l.push(p),{buffer:p}}static deserialize(i){return new pa(i.buffer)}}const $o={};function di(o,i,l={}){if($o[o])throw new Error(`${o} is already registered.`);Object.defineProperty(i,"_classRegistryKey",{value:o,writeable:!1}),$o[o]={klass:i,omit:l.omit||[],shallow:l.shallow||[]}}di("Object",Object),di("TransferableGridIndex",pa),di("Color",Ne),di("Error",Error),di("AJAXError",J),di("ResolvedImage",tt),di("StylePropertyFunction",$c),di("StyleExpression",mu,{omit:["_evaluator"]}),di("ZoomDependentExpression",Ol),di("ZoomConstantExpression",Uc),di("CompoundExpression",Li,{omit:["_evaluate"]});for(const o in Fa)Fa[o]._classRegistryKey||di(`Expression_${o}`,Fa[o]);function vu(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function Ul(o,i){if(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob)return o;if(vu(o)||R(o))return i&&i.push(o),o;if(ArrayBuffer.isView(o)){const l=o;return i&&i.push(l.buffer),l}if(o instanceof ImageData)return i&&i.push(o.data.buffer),o;if(Array.isArray(o)){const l=[];for(const p of o)l.push(Ul(p,i));return l}if(typeof o=="object"){const l=o.constructor,p=l._classRegistryKey;if(!p)throw new Error("can't serialize object of unregistered class");if(!$o[p])throw new Error(`${p} is not registered.`);const E=l.serialize?l.serialize(o,i):{};if(l.serialize){if(i&&E===i[i.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const O in o){if(!o.hasOwnProperty(O)||$o[p].omit.indexOf(O)>=0)continue;const B=o[O];E[O]=$o[p].shallow.indexOf(O)>=0?B:Ul(B,i)}o instanceof Error&&(E.message=o.message)}if(E.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(E.$name=p),E}throw new Error("can't serialize object of type "+typeof o)}function fa(o){if(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||vu(o)||R(o)||ArrayBuffer.isView(o)||o instanceof ImageData)return o;if(Array.isArray(o))return o.map(fa);if(typeof o=="object"){const i=o.$name||"Object";if(!$o[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:l}=$o[i];if(!l)throw new Error(`can't deserialize unregistered class ${i}`);if(l.deserialize)return l.deserialize(o);const p=Object.create(l.prototype);for(const E of Object.keys(o)){if(E==="$name")continue;const O=o[E];p[E]=$o[i].shallow.indexOf(E)>=0?O:fa(O)}return p}throw new Error("can't deserialize object of type "+typeof o)}class $l{constructor(){this.first=!0}update(i,l){const p=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=l),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=p,!0))}}const Qt={"Latin-1 Supplement":o=>o>=128&&o<=255,Arabic:o=>o>=1536&&o<=1791,"Arabic Supplement":o=>o>=1872&&o<=1919,"Arabic Extended-A":o=>o>=2208&&o<=2303,"Hangul Jamo":o=>o>=4352&&o<=4607,"Unified Canadian Aboriginal Syllabics":o=>o>=5120&&o<=5759,Khmer:o=>o>=6016&&o<=6143,"Unified Canadian Aboriginal Syllabics Extended":o=>o>=6320&&o<=6399,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"CJK Radicals Supplement":o=>o>=11904&&o<=12031,"Kangxi Radicals":o=>o>=12032&&o<=12255,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Bopomofo:o=>o>=12544&&o<=12591,"Hangul Compatibility Jamo":o=>o>=12592&&o<=12687,Kanbun:o=>o>=12688&&o<=12703,"Bopomofo Extended":o=>o>=12704&&o<=12735,"CJK Strokes":o=>o>=12736&&o<=12783,"Katakana Phonetic Extensions":o=>o>=12784&&o<=12799,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"CJK Unified Ideographs Extension A":o=>o>=13312&&o<=19903,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Yi Syllables":o=>o>=40960&&o<=42127,"Yi Radicals":o=>o>=42128&&o<=42191,"Hangul Jamo Extended-A":o=>o>=43360&&o<=43391,"Hangul Syllables":o=>o>=44032&&o<=55215,"Hangul Jamo Extended-B":o=>o>=55216&&o<=55295,"Private Use Area":o=>o>=57344&&o<=63743,"CJK Compatibility Ideographs":o=>o>=63744&&o<=64255,"Arabic Presentation Forms-A":o=>o>=64336&&o<=65023,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Arabic Presentation Forms-B":o=>o>=65136&&o<=65279,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function _u(o){for(const i of o)if(Gl(i.charCodeAt(0)))return!0;return!1}function yp(o){for(const i of o)if(!Lm(i.charCodeAt(0)))return!1;return!0}function Lm(o){return!(Qt.Arabic(o)||Qt["Arabic Supplement"](o)||Qt["Arabic Extended-A"](o)||Qt["Arabic Presentation Forms-A"](o)||Qt["Arabic Presentation Forms-B"](o))}function Gl(o){return!(o!==746&&o!==747&&(o<4352||!(Qt["Bopomofo Extended"](o)||Qt.Bopomofo(o)||Qt["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||Qt["CJK Compatibility Ideographs"](o)||Qt["CJK Compatibility"](o)||Qt["CJK Radicals Supplement"](o)||Qt["CJK Strokes"](o)||!(!Qt["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||Qt["CJK Unified Ideographs Extension A"](o)||Qt["CJK Unified Ideographs"](o)||Qt["Enclosed CJK Letters and Months"](o)||Qt["Hangul Compatibility Jamo"](o)||Qt["Hangul Jamo Extended-A"](o)||Qt["Hangul Jamo Extended-B"](o)||Qt["Hangul Jamo"](o)||Qt["Hangul Syllables"](o)||Qt.Hiragana(o)||Qt["Ideographic Description Characters"](o)||Qt.Kanbun(o)||Qt["Kangxi Radicals"](o)||Qt["Katakana Phonetic Extensions"](o)||Qt.Katakana(o)&&o!==12540||!(!Qt["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!Qt["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||Qt["Unified Canadian Aboriginal Syllabics"](o)||Qt["Unified Canadian Aboriginal Syllabics Extended"](o)||Qt["Vertical Forms"](o)||Qt["Yijing Hexagram Symbols"](o)||Qt["Yi Syllables"](o)||Qt["Yi Radicals"](o))))}function xp(o){return!(Gl(o)||function(i){return!!(Qt["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||Qt["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||Qt["Letterlike Symbols"](i)||Qt["Number Forms"](i)||Qt["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||Qt["Control Pictures"](i)&&i!==9251||Qt["Optical Character Recognition"](i)||Qt["Enclosed Alphanumerics"](i)||Qt["Geometric Shapes"](i)||Qt["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||Qt["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||Qt["CJK Symbols and Punctuation"](i)||Qt.Katakana(i)||Qt["Private Use Area"](i)||Qt["CJK Compatibility Forms"](i)||Qt["Small Form Variants"](i)||Qt["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(o))}function bp(o){return o>=1424&&o<=2303||Qt["Arabic Presentation Forms-A"](o)||Qt["Arabic Presentation Forms-B"](o)}function Rm(o,i){return!(!i&&bp(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||Qt.Khmer(o))}function Om(o){for(const i of o)if(bp(i.charCodeAt(0)))return!0;return!1}const Zc="deferred",wu="loading",Tu="loaded";let Eu=null,fs="unavailable",Go=null;const vp=function(o){o&&typeof o=="string"&&o.indexOf("NetworkError")>-1&&(fs="error"),Eu&&Eu(o)};function Cu(){Wa.fire(new Ee("pluginStateChange",{pluginStatus:fs,pluginURL:Go}))}const Wa=new Oe,Su=function(){return fs},Kc=function(){if(fs!==Zc||!Go)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");fs=wu,Cu(),Go&&xe({url:Go},o=>{o?vp(o):(fs=Tu,Cu())})},Vs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>fs===Tu||Vs.applyArabicShaping!=null,isLoading:()=>fs===wu,setState(o){if(!Y())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");fs=o.pluginStatus,Go=o.pluginURL},isParsed(){if(!Y())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Vs.applyArabicShaping!=null&&Vs.processBidirectionalText!=null&&Vs.processStyledBidirectionalText!=null},getPluginURL(){if(!Y())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Go}};class $r{constructor(i,l){this.zoom=i,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new $l,this.transition={})}isSupportedScript(i){return function(l,p){for(const E of l)if(!Rm(E.charCodeAt(0),p))return!1;return!0}(i,Vs.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,l=i-Math.floor(i),p=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*l}}}class Qc{constructor(i,l){this.property=i,this.value=l,this.expression=function(p,E){if(Ga(p))return new $c(p,E);if(Ll(p)){const O=sp(p,E);if(O.result==="error")throw new Error(O.value.map(B=>`${B.key}: ${B.message}`).join(", "));return O.value}{let O=p;return E.type==="color"&&typeof p=="string"?O=Ne.parse(p):E.type!=="padding"||typeof p!="number"&&!Array.isArray(p)||(O=st.parse(p)),{kind:"constant",evaluate:()=>O}}}(l===void 0?i.specification.default:l,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,l,p){return this.property.possiblyEvaluate(this,i,l,p)}}class Jc{constructor(i){this.property=i,this.value=new Qc(i,void 0)}transitioned(i,l){return new _p(this.property,this.value,l,_({},i.transition,this.transition),i.now)}untransitioned(){return new _p(this.property,this.value,null,{},0)}}class ku{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return I(this._values[i].value.value)}setValue(i,l){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Jc(this._values[i].property)),this._values[i].value=new Qc(this._values[i].property,l===null?void 0:I(l))}getTransition(i){return I(this._values[i].transition)}setTransition(i,l){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Jc(this._values[i].property)),this._values[i].transition=I(l)||void 0}serialize(){const i={};for(const l of Object.keys(this._values)){const p=this.getValue(l);p!==void 0&&(i[l]=p);const E=this.getTransition(l);E!==void 0&&(i[`${l}-transition`]=E)}return i}transitioned(i,l){const p=new wp(this._properties);for(const E of Object.keys(this._values))p._values[E]=this._values[E].transitioned(i,l._values[E]);return p}untransitioned(){const i=new wp(this._properties);for(const l of Object.keys(this._values))i._values[l]=this._values[l].untransitioned();return i}}class _p{constructor(i,l,p,E,O){this.property=i,this.value=l,this.begin=O+E.delay||0,this.end=this.begin+E.duration||0,i.specification.transition&&(E.delay||E.duration)&&(this.prior=p)}possiblyEvaluate(i,l,p){const E=i.now||0,O=this.value.possiblyEvaluate(i,l,p),B=this.prior;if(B){if(E>this.end)return this.prior=null,O;if(this.value.isDataDriven())return this.prior=null,O;if(E<this.begin)return B.possiblyEvaluate(i,l,p);{const te=(E-this.begin)/(this.end-this.begin);return this.property.interpolate(B.possiblyEvaluate(i,l,p),O,function(se){if(se<=0)return 0;if(se>=1)return 1;const me=se*se,Se=me*se;return 4*(se<.5?Se:3*(se-me)+Se-.75)}(te))}}return O}}class wp{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,l,p){const E=new eh(this._properties);for(const O of Object.keys(this._values))E._values[O]=this._values[O].possiblyEvaluate(i,l,p);return E}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class zm{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return I(this._values[i].value)}setValue(i,l){this._values[i]=new Qc(this._values[i].property,l===null?void 0:I(l))}serialize(){const i={};for(const l of Object.keys(this._values)){const p=this.getValue(l);p!==void 0&&(i[l]=p)}return i}possiblyEvaluate(i,l,p){const E=new eh(this._properties);for(const O of Object.keys(this._values))E._values[O]=this._values[O].possiblyEvaluate(i,l,p);return E}}class go{constructor(i,l,p){this.property=i,this.value=l,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,l,p,E){return this.property.evaluate(this.value,this.parameters,i,l,p,E)}}class eh{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class wi{constructor(i){this.specification=i}possiblyEvaluate(i,l){if(i.isDataDriven())throw new Error("Value should not be data driven");return i.expression.evaluate(l)}interpolate(i,l,p){const E=Pl[this.specification.type];return E?E(i,l,p):i}}class Mi{constructor(i,l){this.specification=i,this.overrides=l}possiblyEvaluate(i,l,p,E){return new go(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(l,null,{},p,E)}:i.expression,l)}interpolate(i,l,p){if(i.value.kind!=="constant"||l.value.kind!=="constant")return i;if(i.value.value===void 0||l.value.value===void 0)return new go(this,{kind:"constant",value:void 0},i.parameters);const E=Pl[this.specification.type];return E?new go(this,{kind:"constant",value:E(i.value.value,l.value.value,p)},i.parameters):i}evaluate(i,l,p,E,O,B){return i.kind==="constant"?i.value:i.evaluate(l,p,E,O,B)}}class Vl extends Mi{possiblyEvaluate(i,l,p,E){if(i.value===void 0)return new go(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){const O=i.expression.evaluate(l,null,{},p,E),B=i.property.specification.type==="resolvedImage"&&typeof O!="string"?O.name:O,te=this._calculate(B,B,B,l);return new go(this,{kind:"constant",value:te},l)}if(i.expression.kind==="camera"){const O=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new go(this,{kind:"constant",value:O},l)}return new go(this,i.expression,l)}evaluate(i,l,p,E,O,B){if(i.kind==="source"){const te=i.evaluate(l,p,E,O,B);return this._calculate(te,te,te,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},p,E),i.evaluate({zoom:Math.floor(l.zoom)},p,E),i.evaluate({zoom:Math.floor(l.zoom)+1},p,E),l):i.value}_calculate(i,l,p,E){return E.zoom>E.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:p,to:l}}interpolate(i){return i}}class Hl{constructor(i){this.specification=i}possiblyEvaluate(i,l,p,E){if(i.value!==void 0){if(i.expression.kind==="constant"){const O=i.expression.evaluate(l,null,{},p,E);return this._calculate(O,O,O,l)}return this._calculate(i.expression.evaluate(new $r(Math.floor(l.zoom-1),l)),i.expression.evaluate(new $r(Math.floor(l.zoom),l)),i.expression.evaluate(new $r(Math.floor(l.zoom+1),l)),l)}}_calculate(i,l,p,E){return E.zoom>E.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:p,to:l}}interpolate(i){return i}}class Mu{constructor(i){this.specification=i}possiblyEvaluate(i,l,p,E){return!!i.expression.evaluate(l,null,{},p,E)}interpolate(){return!1}}class wn{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in i){const p=i[l];p.specification.overridable&&this.overridableProperties.push(l);const E=this.defaultPropertyValues[l]=new Qc(p,void 0),O=this.defaultTransitionablePropertyValues[l]=new Jc(p);this.defaultTransitioningPropertyValues[l]=O.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=E.possiblyEvaluate({})}}}di("DataDrivenProperty",Mi),di("DataConstantProperty",wi),di("CrossFadedDataDrivenProperty",Vl),di("CrossFadedProperty",Hl),di("ColorRampProperty",Mu);const ma="-transition";class ms extends Oe{constructor(i,l){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1},i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new zm(l.layout)),l.paint)){this._transitionablePaint=new ku(l.paint);for(const p in i.paint)this.setPaintProperty(p,i.paint[p],{validate:!1});for(const p in i.layout)this.setLayoutProperty(p,i.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new eh(l.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,l,p={}){l!=null&&this._validate(Dm,`layers.${this.id}.layout.${i}`,i,l,p)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)}getPaintProperty(i){return i.endsWith(ma)?this._transitionablePaint.getTransition(i.slice(0,-ma.length)):this._transitionablePaint.getValue(i)}setPaintProperty(i,l,p={}){if(l!=null&&this._validate(bu,`layers.${this.id}.paint.${i}`,i,l,p))return!1;if(i.endsWith(ma))return this._transitionablePaint.setTransition(i.slice(0,-ma.length),l||void 0),!1;{const E=this._transitionablePaint._values[i],O=E.property.specification["property-type"]==="cross-faded-data-driven",B=E.value.isDataDriven(),te=E.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);const se=this._transitionablePaint._values[i].value;return se.isDataDriven()||B||O||this._handleOverridablePaintPropertyUpdate(i,te,se)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,l,p){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),y(i,(l,p)=>!(l===void 0||p==="layout"&&!Object.keys(l).length||p==="paint"&&!Object.keys(l).length))}_validate(i,l,p,E,O={}){return(!O||O.validate!==!1)&&gp(this,i.call(da,{key:l,layerType:this.type,objectKey:p,value:E,styleSpec:Re,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const l=this.paint.get(i);if(l instanceof go&&$a(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}}const Nm={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Wl{constructor(i,l){this._structArray=i,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class jr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,l){return i._trim(),l&&(i.isTransferred=!0,l.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const l=Object.create(this.prototype);return l.arrayBuffer=i.arrayBuffer,l.length=i.length,l.capacity=i.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function gn(o,i=1){let l=0,p=0;return{members:o.map(E=>{const O=Nm[E.type].BYTES_PER_ELEMENT,B=l=Tp(l,Math.max(i,O)),te=E.components||1;return p=Math.max(p,O),l+=O*te,{name:E.name,type:E.type,components:te,offset:B}}),size:Tp(l,Math.max(p,i)),alignment:i}}function Tp(o,i){return Math.ceil(o/i)*i}class Ya extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,l)}emplace(i,l,p){const E=2*i;return this.int16[E+0]=l,this.int16[E+1]=p,i}}Ya.prototype.bytesPerElement=4,di("StructArrayLayout2i4",Ya);class Yl extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,E){const O=this.length;return this.resize(O+1),this.emplace(O,i,l,p,E)}emplace(i,l,p,E,O){const B=4*i;return this.int16[B+0]=l,this.int16[B+1]=p,this.int16[B+2]=E,this.int16[B+3]=O,i}}Yl.prototype.bytesPerElement=8,di("StructArrayLayout4i8",Yl);class T extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,E,O,B){const te=this.length;return this.resize(te+1),this.emplace(te,i,l,p,E,O,B)}emplace(i,l,p,E,O,B,te){const se=6*i;return this.int16[se+0]=l,this.int16[se+1]=p,this.int16[se+2]=E,this.int16[se+3]=O,this.int16[se+4]=B,this.int16[se+5]=te,i}}T.prototype.bytesPerElement=12,di("StructArrayLayout2i4i12",T);class r extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,E,O,B){const te=this.length;return this.resize(te+1),this.emplace(te,i,l,p,E,O,B)}emplace(i,l,p,E,O,B,te){const se=4*i,me=8*i;return this.int16[se+0]=l,this.int16[se+1]=p,this.uint8[me+4]=E,this.uint8[me+5]=O,this.uint8[me+6]=B,this.uint8[me+7]=te,i}}r.prototype.bytesPerElement=8,di("StructArrayLayout2i4ub8",r);class u extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,l)}emplace(i,l,p){const E=2*i;return this.float32[E+0]=l,this.float32[E+1]=p,i}}u.prototype.bytesPerElement=8,di("StructArrayLayout2f8",u);class m extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,E,O,B,te,se,me,Se){const De=this.length;return this.resize(De+1),this.emplace(De,i,l,p,E,O,B,te,se,me,Se)}emplace(i,l,p,E,O,B,te,se,me,Se,De){const Be=10*i;return this.uint16[Be+0]=l,this.uint16[Be+1]=p,this.uint16[Be+2]=E,this.uint16[Be+3]=O,this.uint16[Be+4]=B,this.uint16[Be+5]=te,this.uint16[Be+6]=se,this.uint16[Be+7]=me,this.uint16[Be+8]=Se,this.uint16[Be+9]=De,i}}m.prototype.bytesPerElement=20,di("StructArrayLayout10ui20",m);class C extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,E,O,B,te,se,me,Se,De,Be){const Ve=this.length;return this.resize(Ve+1),this.emplace(Ve,i,l,p,E,O,B,te,se,me,Se,De,Be)}emplace(i,l,p,E,O,B,te,se,me,Se,De,Be,Ve){const Ye=12*i;return this.int16[Ye+0]=l,this.int16[Ye+1]=p,this.int16[Ye+2]=E,this.int16[Ye+3]=O,this.uint16[Ye+4]=B,this.uint16[Ye+5]=te,this.uint16[Ye+6]=se,this.uint16[Ye+7]=me,this.int16[Ye+8]=Se,this.int16[Ye+9]=De,this.int16[Ye+10]=Be,this.int16[Ye+11]=Ve,i}}C.prototype.bytesPerElement=24,di("StructArrayLayout4i4ui4i24",C);class N extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p){const E=this.length;return this.resize(E+1),this.emplace(E,i,l,p)}emplace(i,l,p,E){const O=3*i;return this.float32[O+0]=l,this.float32[O+1]=p,this.float32[O+2]=E,i}}N.prototype.bytesPerElement=12,di("StructArrayLayout3f12",N);class ee extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint32[1*i+0]=l,i}}ee.prototype.bytesPerElement=4,di("StructArrayLayout1ul4",ee);class le extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,E,O,B,te,se,me){const Se=this.length;return this.resize(Se+1),this.emplace(Se,i,l,p,E,O,B,te,se,me)}emplace(i,l,p,E,O,B,te,se,me,Se){const De=10*i,Be=5*i;return this.int16[De+0]=l,this.int16[De+1]=p,this.int16[De+2]=E,this.int16[De+3]=O,this.int16[De+4]=B,this.int16[De+5]=te,this.uint32[Be+3]=se,this.uint16[De+8]=me,this.uint16[De+9]=Se,i}}le.prototype.bytesPerElement=20,di("StructArrayLayout6i1ul2ui20",le);class de extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,E,O,B){const te=this.length;return this.resize(te+1),this.emplace(te,i,l,p,E,O,B)}emplace(i,l,p,E,O,B,te){const se=6*i;return this.int16[se+0]=l,this.int16[se+1]=p,this.int16[se+2]=E,this.int16[se+3]=O,this.int16[se+4]=B,this.int16[se+5]=te,i}}de.prototype.bytesPerElement=12,di("StructArrayLayout2i2i2i12",de);class be extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,E,O){const B=this.length;return this.resize(B+1),this.emplace(B,i,l,p,E,O)}emplace(i,l,p,E,O,B){const te=4*i,se=8*i;return this.float32[te+0]=l,this.float32[te+1]=p,this.float32[te+2]=E,this.int16[se+6]=O,this.int16[se+7]=B,i}}be.prototype.bytesPerElement=16,di("StructArrayLayout2f1f2i16",be);class Ae extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,E){const O=this.length;return this.resize(O+1),this.emplace(O,i,l,p,E)}emplace(i,l,p,E,O){const B=12*i,te=3*i;return this.uint8[B+0]=l,this.uint8[B+1]=p,this.float32[te+1]=E,this.float32[te+2]=O,i}}Ae.prototype.bytesPerElement=12,di("StructArrayLayout2ub2f12",Ae);class ze extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p){const E=this.length;return this.resize(E+1),this.emplace(E,i,l,p)}emplace(i,l,p,E){const O=3*i;return this.uint16[O+0]=l,this.uint16[O+1]=p,this.uint16[O+2]=E,i}}ze.prototype.bytesPerElement=6,di("StructArrayLayout3ui6",ze);class Ge extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,E,O,B,te,se,me,Se,De,Be,Ve,Ye,ct,ot,bt){const Pt=this.length;return this.resize(Pt+1),this.emplace(Pt,i,l,p,E,O,B,te,se,me,Se,De,Be,Ve,Ye,ct,ot,bt)}emplace(i,l,p,E,O,B,te,se,me,Se,De,Be,Ve,Ye,ct,ot,bt,Pt){const yt=24*i,Mt=12*i,Ft=48*i;return this.int16[yt+0]=l,this.int16[yt+1]=p,this.uint16[yt+2]=E,this.uint16[yt+3]=O,this.uint32[Mt+2]=B,this.uint32[Mt+3]=te,this.uint32[Mt+4]=se,this.uint16[yt+10]=me,this.uint16[yt+11]=Se,this.uint16[yt+12]=De,this.float32[Mt+7]=Be,this.float32[Mt+8]=Ve,this.uint8[Ft+36]=Ye,this.uint8[Ft+37]=ct,this.uint8[Ft+38]=ot,this.uint32[Mt+10]=bt,this.int16[yt+22]=Pt,i}}Ge.prototype.bytesPerElement=48,di("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ge);class et extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,E,O,B,te,se,me,Se,De,Be,Ve,Ye,ct,ot,bt,Pt,yt,Mt,Ft,Bt,fi,vi,Jt,Xt,Yt,ei){const Kt=this.length;return this.resize(Kt+1),this.emplace(Kt,i,l,p,E,O,B,te,se,me,Se,De,Be,Ve,Ye,ct,ot,bt,Pt,yt,Mt,Ft,Bt,fi,vi,Jt,Xt,Yt,ei)}emplace(i,l,p,E,O,B,te,se,me,Se,De,Be,Ve,Ye,ct,ot,bt,Pt,yt,Mt,Ft,Bt,fi,vi,Jt,Xt,Yt,ei,Kt){const $t=34*i,Ci=17*i;return this.int16[$t+0]=l,this.int16[$t+1]=p,this.int16[$t+2]=E,this.int16[$t+3]=O,this.int16[$t+4]=B,this.int16[$t+5]=te,this.int16[$t+6]=se,this.int16[$t+7]=me,this.uint16[$t+8]=Se,this.uint16[$t+9]=De,this.uint16[$t+10]=Be,this.uint16[$t+11]=Ve,this.uint16[$t+12]=Ye,this.uint16[$t+13]=ct,this.uint16[$t+14]=ot,this.uint16[$t+15]=bt,this.uint16[$t+16]=Pt,this.uint16[$t+17]=yt,this.uint16[$t+18]=Mt,this.uint16[$t+19]=Ft,this.uint16[$t+20]=Bt,this.uint16[$t+21]=fi,this.uint16[$t+22]=vi,this.uint32[Ci+12]=Jt,this.float32[Ci+13]=Xt,this.float32[Ci+14]=Yt,this.float32[Ci+15]=ei,this.float32[Ci+16]=Kt,i}}et.prototype.bytesPerElement=68,di("StructArrayLayout8i15ui1ul4f68",et);class Qe extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.float32[1*i+0]=l,i}}Qe.prototype.bytesPerElement=4,di("StructArrayLayout1f4",Qe);class Je extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p){const E=this.length;return this.resize(E+1),this.emplace(E,i,l,p)}emplace(i,l,p,E){const O=3*i;return this.int16[O+0]=l,this.int16[O+1]=p,this.int16[O+2]=E,i}}Je.prototype.bytesPerElement=6,di("StructArrayLayout3i6",Je);class dt extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p){const E=this.length;return this.resize(E+1),this.emplace(E,i,l,p)}emplace(i,l,p,E){const O=4*i;return this.uint32[2*i+0]=l,this.uint16[O+2]=p,this.uint16[O+3]=E,i}}dt.prototype.bytesPerElement=8,di("StructArrayLayout1ul2ui8",dt);class gt extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,l)}emplace(i,l,p){const E=2*i;return this.uint16[E+0]=l,this.uint16[E+1]=p,i}}gt.prototype.bytesPerElement=4,di("StructArrayLayout2ui4",gt);class vt extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint16[1*i+0]=l,i}}vt.prototype.bytesPerElement=2,di("StructArrayLayout1ui2",vt);class nt extends jr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,E){const O=this.length;return this.resize(O+1),this.emplace(O,i,l,p,E)}emplace(i,l,p,E,O){const B=4*i;return this.float32[B+0]=l,this.float32[B+1]=p,this.float32[B+2]=E,this.float32[B+3]=O,i}}nt.prototype.bytesPerElement=16,di("StructArrayLayout4f16",nt);class kt extends Wl{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new G(this.anchorPointX,this.anchorPointY)}}kt.prototype.size=20;class _t extends le{get(i){return new kt(this,i)}}di("CollisionBoxArray",_t);class Ot extends Wl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ot.prototype.size=48;class zt extends Ge{get(i){return new Ot(this,i)}}di("PlacedSymbolArray",zt);class Ut extends Wl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Ut.prototype.size=68;class Dt extends et{get(i){return new Ut(this,i)}}di("SymbolInstanceArray",Dt);class ni extends Qe{getoffsetX(i){return this.float32[1*i+0]}}di("GlyphOffsetArray",ni);class qt extends Je{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}di("SymbolLineVertexArray",qt);class oi extends Wl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}oi.prototype.size=8;class Hi extends dt{get(i){return new oi(this,i)}}di("FeatureIndexArray",Hi);class er extends Ya{}class ki extends Ya{}class Cr extends Ya{}class Sr extends T{}class lr extends r{}class hr extends u{}class pr extends m{}class Ss extends C{}class yo extends N{}class Js extends ee{}class eo extends de{}class ga extends Ae{}class Nn extends ze{}class to extends gt{}const ya=gn([{name:"a_pos",components:2,type:"Int16"}],4),{members:th}=ya;class fr{constructor(i=[]){this.segments=i}prepareSegment(i,l,p,E){let O=this.segments[this.segments.length-1];return i>fr.MAX_VERTEX_ARRAY_LENGTH&&w(`Max vertices per segment is ${fr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!O||O.vertexLength+i>fr.MAX_VERTEX_ARRAY_LENGTH||O.sortKey!==E)&&(O={vertexOffset:l.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},E!==void 0&&(O.sortKey=E),this.segments.push(O)),O}get(){return this.segments}destroy(){for(const i of this.segments)for(const l in i.vaos)i.vaos[l].destroy()}static simpleSegment(i,l,p,E){return new fr([{vertexOffset:i,primitiveOffset:l,vertexLength:p,primitiveLength:E,vaos:{},sortKey:0}])}}function Br(o,i){return 256*(o=g(Math.floor(o),0,255))+g(Math.floor(i),0,255)}fr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,di("SegmentVector",fr);const gr=gn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var yn={exports:{}},gs={exports:{}};gs.exports=function(o,i){var l,p,E,O,B,te,se,me;for(p=o.length-(l=3&o.length),E=i,B=3432918353,te=461845907,me=0;me<p;)se=255&o.charCodeAt(me)|(255&o.charCodeAt(++me))<<8|(255&o.charCodeAt(++me))<<16|(255&o.charCodeAt(++me))<<24,++me,E=27492+(65535&(O=5*(65535&(E=(E^=se=(65535&(se=(se=(65535&se)*B+(((se>>>16)*B&65535)<<16)&4294967295)<<15|se>>>17))*te+(((se>>>16)*te&65535)<<16)&4294967295)<<13|E>>>19))+((5*(E>>>16)&65535)<<16)&4294967295))+((58964+(O>>>16)&65535)<<16);switch(se=0,l){case 3:se^=(255&o.charCodeAt(me+2))<<16;case 2:se^=(255&o.charCodeAt(me+1))<<8;case 1:E^=se=(65535&(se=(se=(65535&(se^=255&o.charCodeAt(me)))*B+(((se>>>16)*B&65535)<<16)&4294967295)<<15|se>>>17))*te+(((se>>>16)*te&65535)<<16)&4294967295}return E^=o.length,E=2246822507*(65535&(E^=E>>>16))+((2246822507*(E>>>16)&65535)<<16)&4294967295,E=3266489909*(65535&(E^=E>>>13))+((3266489909*(E>>>16)&65535)<<16)&4294967295,(E^=E>>>16)>>>0};var Gr={exports:{}};Gr.exports=function(o,i){for(var l,p=o.length,E=i^p,O=0;p>=4;)l=1540483477*(65535&(l=255&o.charCodeAt(O)|(255&o.charCodeAt(++O))<<8|(255&o.charCodeAt(++O))<<16|(255&o.charCodeAt(++O))<<24))+((1540483477*(l>>>16)&65535)<<16),E=1540483477*(65535&E)+((1540483477*(E>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),p-=4,++O;switch(p){case 3:E^=(255&o.charCodeAt(O+2))<<16;case 2:E^=(255&o.charCodeAt(O+1))<<8;case 1:E=1540483477*(65535&(E^=255&o.charCodeAt(O)))+((1540483477*(E>>>16)&65535)<<16)}return E=1540483477*(65535&(E^=E>>>13))+((1540483477*(E>>>16)&65535)<<16),(E^=E>>>15)>>>0};var Hs=gs.exports,qa=Gr.exports;yn.exports=Hs,yn.exports.murmur3=Hs,yn.exports.murmur2=qa;class Xa{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,l,p,E){this.ids.push(ih(i)),this.positions.push(l,p,E)}getPositions(i){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const l=ih(i);let p=0,E=this.ids.length-1;for(;p<E;){const B=p+E>>1;this.ids[B]>=l?E=B:p=B+1}const O=[];for(;this.ids[p]===l;)O.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return O}static serialize(i,l){const p=new Float64Array(i.ids),E=new Uint32Array(i.positions);return Au(p,E,0,p.length-1),l&&l.push(p.buffer,E.buffer),{ids:p,positions:E}}static deserialize(i){const l=new Xa;return l.ids=i.ids,l.positions=i.positions,l.indexed=!0,l}}function ih(o){const i=+o;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:yn.exports(String(o))}function Au(o,i,l,p){for(;l<p;){const E=o[l+p>>1];let O=l-1,B=p+1;for(;;){do O++;while(o[O]<E);do B--;while(o[B]>E);if(O>=B)break;rh(o,O,B),rh(i,3*O,3*B),rh(i,3*O+1,3*B+1),rh(i,3*O+2,3*B+2)}B-l<p-B?(Au(o,i,l,B),l=B+1):(Au(o,i,B+1,p),p=B)}}function rh(o,i,l){const p=o[i];o[i]=o[l],o[l]=p}di("FeaturePositionMap",Xa);class io{constructor(i,l){this.gl=i.gl,this.location=l}}class nh extends io{constructor(i,l){super(i,l),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class ql extends io{constructor(i,l){super(i,l),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class sh extends io{constructor(i,l){super(i,l),this.current=Ne.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const OT=new Float32Array(16);function jm(o){return[Br(255*o.r,255*o.g),Br(255*o.b,255*o.a)]}class Pu{constructor(i,l,p){this.value=i,this.uniformNames=l.map(E=>`u_${E}`),this.type=p}setUniform(i,l,p){i.set(p.constantOr(this.value))}getBinding(i,l,p){return this.type==="color"?new sh(i,l):new nh(i,l)}}class oh{constructor(i,l){this.uniformNames=l.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=i.tlbr}setUniform(i,l,p,E){const O=E==="u_pattern_to"?this.patternTo:E==="u_pattern_from"?this.patternFrom:E==="u_pixel_ratio_to"?this.pixelRatioTo:E==="u_pixel_ratio_from"?this.pixelRatioFrom:null;O&&i.set(O)}getBinding(i,l,p){return p.substr(0,9)==="u_pattern"?new ql(i,l):new nh(i,l)}}class xa{constructor(i,l,p,E){this.expression=i,this.type=p,this.maxValue=0,this.paintVertexAttributes=l.map(O=>({name:`a_${O}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new E}populatePaintArray(i,l,p,E,O){const B=this.paintVertexArray.length,te=this.expression.evaluate(new $r(0),l,{},E,[],O);this.paintVertexArray.resize(i),this._setPaintValue(B,i,te)}updatePaintArray(i,l,p,E){const O=this.expression.evaluate({zoom:0},p,E);this._setPaintValue(i,l,O)}_setPaintValue(i,l,p){if(this.type==="color"){const E=jm(p);for(let O=i;O<l;O++)this.paintVertexArray.emplace(O,E[0],E[1])}else{for(let E=i;E<l;E++)this.paintVertexArray.emplace(E,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ko{constructor(i,l,p,E,O,B){this.expression=i,this.uniformNames=l.map(te=>`u_${te}_t`),this.type=p,this.useIntegerZoom=E,this.zoom=O,this.maxValue=0,this.paintVertexAttributes=l.map(te=>({name:`a_${te}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new B}populatePaintArray(i,l,p,E,O){const B=this.expression.evaluate(new $r(this.zoom),l,{},E,[],O),te=this.expression.evaluate(new $r(this.zoom+1),l,{},E,[],O),se=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(se,i,B,te)}updatePaintArray(i,l,p,E){const O=this.expression.evaluate({zoom:this.zoom},p,E),B=this.expression.evaluate({zoom:this.zoom+1},p,E);this._setPaintValue(i,l,O,B)}_setPaintValue(i,l,p,E){if(this.type==="color"){const O=jm(p),B=jm(E);for(let te=i;te<l;te++)this.paintVertexArray.emplace(te,O[0],O[1],B[0],B[1])}else{for(let O=i;O<l;O++)this.paintVertexArray.emplace(O,p,E);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(E))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,l){const p=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,E=g(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);i.set(E)}getBinding(i,l,p){return new nh(i,l)}}class Za{constructor(i,l,p,E,O,B){this.expression=i,this.type=l,this.useIntegerZoom=p,this.zoom=E,this.layerId=B,this.zoomInPaintVertexArray=new O,this.zoomOutPaintVertexArray=new O}populatePaintArray(i,l,p){const E=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(E,i,l.patterns&&l.patterns[this.layerId],p)}updatePaintArray(i,l,p,E,O){this._setPaintValues(i,l,p.patterns&&p.patterns[this.layerId],O)}_setPaintValues(i,l,p,E){if(!E||!p)return;const{min:O,mid:B,max:te}=p,se=E[O],me=E[B],Se=E[te];if(se&&me&&Se)for(let De=i;De<l;De++)this.zoomInPaintVertexArray.emplace(De,me.tl[0],me.tl[1],me.br[0],me.br[1],se.tl[0],se.tl[1],se.br[0],se.br[1],me.pixelRatio,se.pixelRatio),this.zoomOutPaintVertexArray.emplace(De,me.tl[0],me.tl[1],me.br[0],me.br[1],Se.tl[0],Se.tl[1],Se.br[0],Se.br[1],me.pixelRatio,Se.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,gr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,gr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class $x{constructor(i,l,p){this.binders={},this._buffers=[];const E=[];for(const O in i.paint._values){if(!p(O))continue;const B=i.paint.get(O);if(!(B instanceof go&&$a(B.property.specification)))continue;const te=zT(O,i.type),se=B.value,me=B.property.specification.type,Se=B.property.useIntegerZoom,De=B.property.specification["property-type"],Be=De==="cross-faded"||De==="cross-faded-data-driven";if(se.kind==="constant")this.binders[O]=Be?new oh(se.value,te):new Pu(se.value,te,me),E.push(`/u_${O}`);else if(se.kind==="source"||Be){const Ve=Gx(O,me,"source");this.binders[O]=Be?new Za(se,me,Se,l,Ve,i.id):new xa(se,te,me,Ve),E.push(`/a_${O}`)}else{const Ve=Gx(O,me,"composite");this.binders[O]=new ko(se,te,me,Se,l,Ve),E.push(`/z_${O}`)}}this.cacheKey=E.sort().join("")}getMaxValue(i){const l=this.binders[i];return l instanceof xa||l instanceof ko?l.maxValue:0}populatePaintArrays(i,l,p,E,O){for(const B in this.binders){const te=this.binders[B];(te instanceof xa||te instanceof ko||te instanceof Za)&&te.populatePaintArray(i,l,p,E,O)}}setConstantPatternPositions(i,l){for(const p in this.binders){const E=this.binders[p];E instanceof oh&&E.setConstantPatternPositions(i,l)}}updatePaintArrays(i,l,p,E,O){let B=!1;for(const te in i){const se=l.getPositions(te);for(const me of se){const Se=p.feature(me.index);for(const De in this.binders){const Be=this.binders[De];if((Be instanceof xa||Be instanceof ko||Be instanceof Za)&&Be.expression.isStateDependent===!0){const Ve=E.paint.get(De);Be.expression=Ve.value,Be.updatePaintArray(me.start,me.end,Se,i[te],O),B=!0}}}}return B}defines(){const i=[];for(const l in this.binders){const p=this.binders[l];(p instanceof Pu||p instanceof oh)&&i.push(...p.uniformNames.map(E=>`#define HAS_UNIFORM_${E}`))}return i}getBinderAttributes(){const i=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof xa||p instanceof ko)for(let E=0;E<p.paintVertexAttributes.length;E++)i.push(p.paintVertexAttributes[E].name);else if(p instanceof Za)for(let E=0;E<gr.members.length;E++)i.push(gr.members[E].name)}return i}getBinderUniforms(){const i=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof Pu||p instanceof oh||p instanceof ko)for(const E of p.uniformNames)i.push(E)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,l){const p=[];for(const E in this.binders){const O=this.binders[E];if(O instanceof Pu||O instanceof oh||O instanceof ko){for(const B of O.uniformNames)if(l[B]){const te=O.getBinding(i,l[B],B);p.push({name:B,property:E,binding:te})}}}return p}setUniforms(i,l,p,E){for(const{name:O,property:B,binding:te}of l)this.binders[B].setUniform(te,E,p.get(B),O)}updatePaintBuffers(i){this._buffers=[];for(const l in this.binders){const p=this.binders[l];if(i&&p instanceof Za){const E=i.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;E&&this._buffers.push(E)}else(p instanceof xa||p instanceof ko)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(i){for(const l in this.binders){const p=this.binders[l];(p instanceof xa||p instanceof ko||p instanceof Za)&&p.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const l=this.binders[i];(l instanceof xa||l instanceof ko||l instanceof Za)&&l.destroy()}}}class Xl{constructor(i,l,p=()=>!0){this.programConfigurations={};for(const E of i)this.programConfigurations[E.id]=new $x(E,l,p);this.needsUpload=!1,this._featureMap=new Xa,this._bufferOffset=0}populatePaintArrays(i,l,p,E,O,B){for(const te in this.programConfigurations)this.programConfigurations[te].populatePaintArrays(i,l,E,O,B);l.id!==void 0&&this._featureMap.add(l.id,p,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,l,p,E){for(const O of p)this.needsUpload=this.programConfigurations[O.id].updatePaintArrays(i,this._featureMap,l,O,E)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function zT(o,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${i}-`,"").replace(/-/g,"_")]}function Gx(o,i,l){const p={color:{source:u,composite:nt},number:{source:Qe,composite:u}},E=function(O){return{"line-pattern":{source:pr,composite:pr},"fill-pattern":{source:pr,composite:pr},"fill-extrusion-pattern":{source:pr,composite:pr}}[O]}(o);return E&&E[l]||p[i][l]}di("ConstantBinder",Pu),di("CrossFadedConstantBinder",oh),di("SourceExpressionBinder",xa),di("CrossFadedCompositeBinder",Za),di("CompositeExpressionBinder",ko),di("ProgramConfiguration",$x,{omit:["_buffers"]}),di("ProgramConfigurationSet",Xl);var Tn=8192;const Bm=Math.pow(2,14)-1,Vx=-Bm-1;function Zl(o){const i=Tn/o.extent,l=o.loadGeometry();for(let p=0;p<l.length;p++){const E=l[p];for(let O=0;O<E.length;O++){const B=E[O],te=Math.round(B.x*i),se=Math.round(B.y*i);B.x=g(te,Vx,Bm),B.y=g(se,Vx,Bm),(te<B.x||te>B.x+1||se<B.y||se>B.y+1)&&w("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function Kl(o,i){return{type:o.type,id:o.id,properties:o.properties,geometry:i?Zl(o):[]}}function Ep(o,i,l,p,E){o.emplaceBack(2*i+(p+1)/2,2*l+(E+1)/2)}class Fm{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new ki,this.indexArray=new Nn,this.segments=new fr,this.programConfigurations=new Xl(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,p){const E=this.layers[0],O=[];let B=null,te=!1;E.type==="circle"&&(B=E.layout.get("circle-sort-key"),te=!B.isConstant());for(const{feature:se,id:me,index:Se,sourceLayerIndex:De}of i){const Be=this.layers[0]._featureFilter.needGeometry,Ve=Kl(se,Be);if(!this.layers[0]._featureFilter.filter(new $r(this.zoom),Ve,p))continue;const Ye=te?B.evaluate(Ve,{},p):void 0,ct={id:me,properties:se.properties,type:se.type,sourceLayerIndex:De,index:Se,geometry:Be?Ve.geometry:Zl(se),patterns:{},sortKey:Ye};O.push(ct)}te&&O.sort((se,me)=>se.sortKey-me.sortKey);for(const se of O){const{geometry:me,index:Se,sourceLayerIndex:De}=se,Be=i[Se].feature;this.addFeature(se,me,Se,p),l.featureIndex.insert(Be,me,Se,De,this.index)}}update(i,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,th),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,l,p,E){for(const O of l)for(const B of O){const te=B.x,se=B.y;if(te<0||te>=Tn||se<0||se>=Tn)continue;const me=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),Se=me.vertexLength;Ep(this.layoutVertexArray,te,se,-1,-1),Ep(this.layoutVertexArray,te,se,1,-1),Ep(this.layoutVertexArray,te,se,1,1),Ep(this.layoutVertexArray,te,se,-1,1),this.indexArray.emplaceBack(Se,Se+1,Se+2),this.indexArray.emplaceBack(Se,Se+3,Se+2),me.vertexLength+=4,me.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,{},E)}}function Hx(o,i){for(let l=0;l<o.length;l++)if(ah(i,o[l]))return!0;for(let l=0;l<i.length;l++)if(ah(o,i[l]))return!0;return!!Um(o,i)}function NT(o,i,l){return!!ah(o,i)||!!$m(i,o,l)}function Wx(o,i){if(o.length===1)return qx(i,o[0]);for(let l=0;l<i.length;l++){const p=i[l];for(let E=0;E<p.length;E++)if(ah(o,p[E]))return!0}for(let l=0;l<o.length;l++)if(qx(i,o[l]))return!0;for(let l=0;l<i.length;l++)if(Um(o,i[l]))return!0;return!1}function jT(o,i,l){if(o.length>1){if(Um(o,i))return!0;for(let p=0;p<i.length;p++)if($m(i[p],o,l))return!0}for(let p=0;p<o.length;p++)if($m(o[p],i,l))return!0;return!1}function Um(o,i){if(o.length===0||i.length===0)return!1;for(let l=0;l<o.length-1;l++){const p=o[l],E=o[l+1];for(let O=0;O<i.length-1;O++)if(BT(p,E,i[O],i[O+1]))return!0}return!1}function BT(o,i,l,p){return M(o,l,p)!==M(i,l,p)&&M(o,i,l)!==M(o,i,p)}function $m(o,i,l){const p=l*l;if(i.length===1)return o.distSqr(i[0])<p;for(let E=1;E<i.length;E++)if(Yx(o,i[E-1],i[E])<p)return!0;return!1}function Yx(o,i,l){const p=i.distSqr(l);if(p===0)return o.distSqr(i);const E=((o.x-i.x)*(l.x-i.x)+(o.y-i.y)*(l.y-i.y))/p;return o.distSqr(E<0?i:E>1?l:l.sub(i)._mult(E)._add(i))}function qx(o,i){let l,p,E,O=!1;for(let B=0;B<o.length;B++){l=o[B];for(let te=0,se=l.length-1;te<l.length;se=te++)p=l[te],E=l[se],p.y>i.y!=E.y>i.y&&i.x<(E.x-p.x)*(i.y-p.y)/(E.y-p.y)+p.x&&(O=!O)}return O}function ah(o,i){let l=!1;for(let p=0,E=o.length-1;p<o.length;E=p++){const O=o[p],B=o[E];O.y>i.y!=B.y>i.y&&i.x<(B.x-O.x)*(i.y-O.y)/(B.y-O.y)+O.x&&(l=!l)}return l}function FT(o,i,l){const p=l[0],E=l[2];if(o.x<p.x&&i.x<p.x||o.x>E.x&&i.x>E.x||o.y<p.y&&i.y<p.y||o.y>E.y&&i.y>E.y)return!1;const O=M(o,i,l[0]);return O!==M(o,i,l[1])||O!==M(o,i,l[2])||O!==M(o,i,l[3])}function Iu(o,i,l){const p=i.paint.get(o).value;return p.kind==="constant"?p.value:l.programConfigurations.get(i.id).getMaxValue(o)}function Cp(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function Sp(o,i,l,p,E){if(!i[0]&&!i[1])return o;const O=G.convert(i)._mult(E);l==="viewport"&&O._rotate(-p);const B=[];for(let te=0;te<o.length;te++)B.push(o[te].sub(O));return B}di("CircleBucket",Fm,{omit:["layers"]});const UT=new wn({"circle-sort-key":new Mi(Re.layout_circle["circle-sort-key"])});var $T={paint:new wn({"circle-radius":new Mi(Re.paint_circle["circle-radius"]),"circle-color":new Mi(Re.paint_circle["circle-color"]),"circle-blur":new Mi(Re.paint_circle["circle-blur"]),"circle-opacity":new Mi(Re.paint_circle["circle-opacity"]),"circle-translate":new wi(Re.paint_circle["circle-translate"]),"circle-translate-anchor":new wi(Re.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wi(Re.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wi(Re.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Mi(Re.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Mi(Re.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Mi(Re.paint_circle["circle-stroke-opacity"])}),layout:UT},ys=1e-6,xs=typeof Float32Array<"u"?Float32Array:Array;function Xx(){var o=new xs(9);return xs!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function Gm(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Zx(o,i,l){var p=i[0],E=i[1],O=i[2],B=i[3],te=i[4],se=i[5],me=i[6],Se=i[7],De=i[8],Be=i[9],Ve=i[10],Ye=i[11],ct=i[12],ot=i[13],bt=i[14],Pt=i[15],yt=l[0],Mt=l[1],Ft=l[2],Bt=l[3];return o[0]=yt*p+Mt*te+Ft*De+Bt*ct,o[1]=yt*E+Mt*se+Ft*Be+Bt*ot,o[2]=yt*O+Mt*me+Ft*Ve+Bt*bt,o[3]=yt*B+Mt*Se+Ft*Ye+Bt*Pt,o[4]=(yt=l[4])*p+(Mt=l[5])*te+(Ft=l[6])*De+(Bt=l[7])*ct,o[5]=yt*E+Mt*se+Ft*Be+Bt*ot,o[6]=yt*O+Mt*me+Ft*Ve+Bt*bt,o[7]=yt*B+Mt*Se+Ft*Ye+Bt*Pt,o[8]=(yt=l[8])*p+(Mt=l[9])*te+(Ft=l[10])*De+(Bt=l[11])*ct,o[9]=yt*E+Mt*se+Ft*Be+Bt*ot,o[10]=yt*O+Mt*me+Ft*Ve+Bt*bt,o[11]=yt*B+Mt*Se+Ft*Ye+Bt*Pt,o[12]=(yt=l[12])*p+(Mt=l[13])*te+(Ft=l[14])*De+(Bt=l[15])*ct,o[13]=yt*E+Mt*se+Ft*Be+Bt*ot,o[14]=yt*O+Mt*me+Ft*Ve+Bt*bt,o[15]=yt*B+Mt*Se+Ft*Ye+Bt*Pt,o}Math.hypot||(Math.hypot=function(){for(var o=0,i=arguments.length;i--;)o+=arguments[i]*arguments[i];return Math.sqrt(o)});var Du,GT=Zx;function Kx(){var o=new xs(3);return xs!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function Qx(o,i,l){var p=new xs(3);return p[0]=o,p[1]=i,p[2]=l,p}function kp(o,i,l){var p=i[0],E=i[1],O=i[2],B=i[3];return o[0]=l[0]*p+l[4]*E+l[8]*O+l[12]*B,o[1]=l[1]*p+l[5]*E+l[9]*O+l[13]*B,o[2]=l[2]*p+l[6]*E+l[10]*O+l[14]*B,o[3]=l[3]*p+l[7]*E+l[11]*O+l[15]*B,o}function Jx(){var o=new xs(4);return xs!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function e0(o,i){const l=kp([],[o.x,o.y,0,1],i);return new G(l[0]/l[3],l[1]/l[3])}Kx(),Du=new xs(4),xs!=Float32Array&&(Du[0]=0,Du[1]=0,Du[2]=0,Du[3]=0),Kx(),Qx(1,0,0),Qx(0,1,0),Jx(),Jx(),Xx(),function(){var o;o=new xs(2),xs!=Float32Array&&(o[0]=0,o[1]=0)}();class t0 extends Fm{}di("HeatmapBucket",t0,{omit:["layers"]});var VT={paint:new wn({"heatmap-radius":new Mi(Re.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Mi(Re.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wi(Re.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mu(Re.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wi(Re.paint_heatmap["heatmap-opacity"])})};function Vm(o,{width:i,height:l},p,E){if(E){if(E instanceof Uint8ClampedArray)E=new Uint8Array(E.buffer);else if(E.length!==i*l*p)throw new RangeError(`mismatched image size. expected: ${E.length} but got: ${i*l*p}`)}else E=new Uint8Array(i*l*p);return o.width=i,o.height=l,o.data=E,o}function i0(o,{width:i,height:l},p){if(i===o.width&&l===o.height)return;const E=Vm({},{width:i,height:l},p);Hm(o,E,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,i),height:Math.min(o.height,l)},p),o.width=i,o.height=l,o.data=E.data}function Hm(o,i,l,p,E,O){if(E.width===0||E.height===0)return i;if(E.width>o.width||E.height>o.height||l.x>o.width-E.width||l.y>o.height-E.height)throw new RangeError("out of range source coordinates for image copy");if(E.width>i.width||E.height>i.height||p.x>i.width-E.width||p.y>i.height-E.height)throw new RangeError("out of range destination coordinates for image copy");const B=o.data,te=i.data;if(B===te)throw new Error("srcData equals dstData, so image is already copied");for(let se=0;se<E.height;se++){const me=((l.y+se)*o.width+l.x)*O,Se=((p.y+se)*i.width+p.x)*O;for(let De=0;De<E.width*O;De++)te[Se+De]=B[me+De]}return i}class Lu{constructor(i,l){Vm(this,i,1,l)}resize(i){i0(this,i,1)}clone(){return new Lu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,p,E,O){Hm(i,l,p,E,O,1)}}class ro{constructor(i,l){Vm(this,i,4,l)}resize(i){i0(this,i,4)}replace(i,l){l?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new ro({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,p,E,O){Hm(i,l,p,E,O,4)}}function r0(o){const i={},l=o.resolution||256,p=o.clips?o.clips.length:1,E=o.image||new ro({width:l,height:p});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);const O=(B,te,se)=>{i[o.evaluationKey]=se;const me=o.expression.evaluate(i);E.data[B+te+0]=Math.floor(255*me.r/me.a),E.data[B+te+1]=Math.floor(255*me.g/me.a),E.data[B+te+2]=Math.floor(255*me.b/me.a),E.data[B+te+3]=Math.floor(255*me.a)};if(o.clips)for(let B=0,te=0;B<p;++B,te+=4*l)for(let se=0,me=0;se<l;se++,me+=4){const Se=se/(l-1),{start:De,end:Be}=o.clips[B];O(te,me,De*(1-Se)+Be*Se)}else for(let B=0,te=0;B<l;B++,te+=4)O(0,te,B/(l-1));return E}di("AlphaImage",Lu),di("RGBAImage",ro);var HT={paint:new wn({"hillshade-illumination-direction":new wi(Re.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wi(Re.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wi(Re.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wi(Re.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wi(Re.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wi(Re.paint_hillshade["hillshade-accent-color"])})};const WT=gn([{name:"a_pos",components:2,type:"Int16"}],4),{members:YT}=WT;var Mp={exports:{}};function Ap(o,i,l){l=l||2;var p,E,O,B,te,se,me,Se=i&&i.length,De=Se?i[0]*l:o.length,Be=n0(o,0,De,l,!0),Ve=[];if(!Be||Be.next===Be.prev)return Ve;if(Se&&(Be=function(ct,ot,bt,Pt){var yt,Mt,Ft,Bt=[];for(yt=0,Mt=ot.length;yt<Mt;yt++)(Ft=n0(ct,ot[yt]*Pt,yt<Mt-1?ot[yt+1]*Pt:ct.length,Pt,!1))===Ft.next&&(Ft.steiner=!0),Bt.push(tE(Ft));for(Bt.sort(QT),yt=0;yt<Bt.length;yt++)bt=JT(Bt[yt],bt);return bt}(o,i,Be,l)),o.length>80*l){p=O=o[0],E=B=o[1];for(var Ye=l;Ye<De;Ye+=l)(te=o[Ye])<p&&(p=te),(se=o[Ye+1])<E&&(E=se),te>O&&(O=te),se>B&&(B=se);me=(me=Math.max(O-p,B-E))!==0?32767/me:0}return Ru(Be,Ve,l,p,E,me,0),Ve}function n0(o,i,l,p,E){var O,B;if(E===qm(o,i,l,p)>0)for(O=i;O<l;O+=p)B=a0(O,o[O],o[O+1],B);else for(O=l-p;O>=i;O-=p)B=a0(O,o[O],o[O+1],B);return B&&Pp(B,B.next)&&(zu(B),B=B.next),B}function Ql(o,i){if(!o)return o;i||(i=o);var l,p=o;do if(l=!1,p.steiner||!Pp(p,p.next)&&un(p.prev,p,p.next)!==0)p=p.next;else{if(zu(p),(p=i=p.prev)===p.next)break;l=!0}while(l||p!==i);return i}function Ru(o,i,l,p,E,O,B){if(o){!B&&O&&function(Se,De,Be,Ve){var Ye=Se;do Ye.z===0&&(Ye.z=Wm(Ye.x,Ye.y,De,Be,Ve)),Ye.prevZ=Ye.prev,Ye.nextZ=Ye.next,Ye=Ye.next;while(Ye!==Se);Ye.prevZ.nextZ=null,Ye.prevZ=null,function(ct){var ot,bt,Pt,yt,Mt,Ft,Bt,fi,vi=1;do{for(bt=ct,ct=null,Mt=null,Ft=0;bt;){for(Ft++,Pt=bt,Bt=0,ot=0;ot<vi&&(Bt++,Pt=Pt.nextZ);ot++);for(fi=vi;Bt>0||fi>0&&Pt;)Bt!==0&&(fi===0||!Pt||bt.z<=Pt.z)?(yt=bt,bt=bt.nextZ,Bt--):(yt=Pt,Pt=Pt.nextZ,fi--),Mt?Mt.nextZ=yt:ct=yt,yt.prevZ=Mt,Mt=yt;bt=Pt}Mt.nextZ=null,vi*=2}while(Ft>1)}(Ye)}(o,p,E,O);for(var te,se,me=o;o.prev!==o.next;)if(te=o.prev,se=o.next,O?XT(o,p,E,O):qT(o))i.push(te.i/l|0),i.push(o.i/l|0),i.push(se.i/l|0),zu(o),o=se.next,me=se.next;else if((o=se)===me){B?B===1?Ru(o=ZT(Ql(o),i,l),i,l,p,E,O,2):B===2&&KT(o,i,l,p,E,O):Ru(Ql(o),i,l,p,E,O,1);break}}}function qT(o){var i=o.prev,l=o,p=o.next;if(un(i,l,p)>=0)return!1;for(var E=i.x,O=l.x,B=p.x,te=i.y,se=l.y,me=p.y,Se=E<O?E<B?E:B:O<B?O:B,De=te<se?te<me?te:me:se<me?se:me,Be=E>O?E>B?E:B:O>B?O:B,Ve=te>se?te>me?te:me:se>me?se:me,Ye=p.next;Ye!==i;){if(Ye.x>=Se&&Ye.x<=Be&&Ye.y>=De&&Ye.y<=Ve&&lh(E,te,O,se,B,me,Ye.x,Ye.y)&&un(Ye.prev,Ye,Ye.next)>=0)return!1;Ye=Ye.next}return!0}function XT(o,i,l,p){var E=o.prev,O=o,B=o.next;if(un(E,O,B)>=0)return!1;for(var te=E.x,se=O.x,me=B.x,Se=E.y,De=O.y,Be=B.y,Ve=te<se?te<me?te:me:se<me?se:me,Ye=Se<De?Se<Be?Se:Be:De<Be?De:Be,ct=te>se?te>me?te:me:se>me?se:me,ot=Se>De?Se>Be?Se:Be:De>Be?De:Be,bt=Wm(Ve,Ye,i,l,p),Pt=Wm(ct,ot,i,l,p),yt=o.prevZ,Mt=o.nextZ;yt&&yt.z>=bt&&Mt&&Mt.z<=Pt;){if(yt.x>=Ve&&yt.x<=ct&&yt.y>=Ye&&yt.y<=ot&&yt!==E&&yt!==B&&lh(te,Se,se,De,me,Be,yt.x,yt.y)&&un(yt.prev,yt,yt.next)>=0||(yt=yt.prevZ,Mt.x>=Ve&&Mt.x<=ct&&Mt.y>=Ye&&Mt.y<=ot&&Mt!==E&&Mt!==B&&lh(te,Se,se,De,me,Be,Mt.x,Mt.y)&&un(Mt.prev,Mt,Mt.next)>=0))return!1;Mt=Mt.nextZ}for(;yt&&yt.z>=bt;){if(yt.x>=Ve&&yt.x<=ct&&yt.y>=Ye&&yt.y<=ot&&yt!==E&&yt!==B&&lh(te,Se,se,De,me,Be,yt.x,yt.y)&&un(yt.prev,yt,yt.next)>=0)return!1;yt=yt.prevZ}for(;Mt&&Mt.z<=Pt;){if(Mt.x>=Ve&&Mt.x<=ct&&Mt.y>=Ye&&Mt.y<=ot&&Mt!==E&&Mt!==B&&lh(te,Se,se,De,me,Be,Mt.x,Mt.y)&&un(Mt.prev,Mt,Mt.next)>=0)return!1;Mt=Mt.nextZ}return!0}function ZT(o,i,l){var p=o;do{var E=p.prev,O=p.next.next;!Pp(E,O)&&s0(E,p,p.next,O)&&Ou(E,O)&&Ou(O,E)&&(i.push(E.i/l|0),i.push(p.i/l|0),i.push(O.i/l|0),zu(p),zu(p.next),p=o=O),p=p.next}while(p!==o);return Ql(p)}function KT(o,i,l,p,E,O){var B=o;do{for(var te=B.next.next;te!==B.prev;){if(B.i!==te.i&&iE(B,te)){var se=o0(B,te);return B=Ql(B,B.next),se=Ql(se,se.next),Ru(B,i,l,p,E,O,0),void Ru(se,i,l,p,E,O,0)}te=te.next}B=B.next}while(B!==o)}function QT(o,i){return o.x-i.x}function JT(o,i){var l=function(E,O){var B,te=O,se=E.x,me=E.y,Se=-1/0;do{if(me<=te.y&&me>=te.next.y&&te.next.y!==te.y){var De=te.x+(me-te.y)*(te.next.x-te.x)/(te.next.y-te.y);if(De<=se&&De>Se&&(Se=De,B=te.x<te.next.x?te:te.next,De===se))return B}te=te.next}while(te!==O);if(!B)return null;var Be,Ve=B,Ye=B.x,ct=B.y,ot=1/0;te=B;do se>=te.x&&te.x>=Ye&&se!==te.x&&lh(me<ct?se:Se,me,Ye,ct,me<ct?Se:se,me,te.x,te.y)&&(Be=Math.abs(me-te.y)/(se-te.x),Ou(te,E)&&(Be<ot||Be===ot&&(te.x>B.x||te.x===B.x&&eE(B,te)))&&(B=te,ot=Be)),te=te.next;while(te!==Ve);return B}(o,i);if(!l)return i;var p=o0(l,o);return Ql(p,p.next),Ql(l,l.next)}function eE(o,i){return un(o.prev,o,i.prev)<0&&un(i.next,o,o.next)<0}function Wm(o,i,l,p,E){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-l)*E|0)|o<<8))|o<<4))|o<<2))|o<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-p)*E|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function tE(o){var i=o,l=o;do(i.x<l.x||i.x===l.x&&i.y<l.y)&&(l=i),i=i.next;while(i!==o);return l}function lh(o,i,l,p,E,O,B,te){return(E-B)*(i-te)>=(o-B)*(O-te)&&(o-B)*(p-te)>=(l-B)*(i-te)&&(l-B)*(O-te)>=(E-B)*(p-te)}function iE(o,i){return o.next.i!==i.i&&o.prev.i!==i.i&&!function(l,p){var E=l;do{if(E.i!==l.i&&E.next.i!==l.i&&E.i!==p.i&&E.next.i!==p.i&&s0(E,E.next,l,p))return!0;E=E.next}while(E!==l);return!1}(o,i)&&(Ou(o,i)&&Ou(i,o)&&function(l,p){var E=l,O=!1,B=(l.x+p.x)/2,te=(l.y+p.y)/2;do E.y>te!=E.next.y>te&&E.next.y!==E.y&&B<(E.next.x-E.x)*(te-E.y)/(E.next.y-E.y)+E.x&&(O=!O),E=E.next;while(E!==l);return O}(o,i)&&(un(o.prev,o,i.prev)||un(o,i.prev,i))||Pp(o,i)&&un(o.prev,o,o.next)>0&&un(i.prev,i,i.next)>0)}function un(o,i,l){return(i.y-o.y)*(l.x-i.x)-(i.x-o.x)*(l.y-i.y)}function Pp(o,i){return o.x===i.x&&o.y===i.y}function s0(o,i,l,p){var E=Dp(un(o,i,l)),O=Dp(un(o,i,p)),B=Dp(un(l,p,o)),te=Dp(un(l,p,i));return E!==O&&B!==te||!(E!==0||!Ip(o,l,i))||!(O!==0||!Ip(o,p,i))||!(B!==0||!Ip(l,o,p))||!(te!==0||!Ip(l,i,p))}function Ip(o,i,l){return i.x<=Math.max(o.x,l.x)&&i.x>=Math.min(o.x,l.x)&&i.y<=Math.max(o.y,l.y)&&i.y>=Math.min(o.y,l.y)}function Dp(o){return o>0?1:o<0?-1:0}function Ou(o,i){return un(o.prev,o,o.next)<0?un(o,i,o.next)>=0&&un(o,o.prev,i)>=0:un(o,i,o.prev)<0||un(o,o.next,i)<0}function o0(o,i){var l=new Ym(o.i,o.x,o.y),p=new Ym(i.i,i.x,i.y),E=o.next,O=i.prev;return o.next=i,i.prev=o,l.next=E,E.prev=l,p.next=l,l.prev=p,O.next=p,p.prev=O,p}function a0(o,i,l,p){var E=new Ym(o,i,l);return p?(E.next=p.next,E.prev=p,p.next.prev=E,p.next=E):(E.prev=E,E.next=E),E}function zu(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function Ym(o,i,l){this.i=o,this.x=i,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function qm(o,i,l,p){for(var E=0,O=i,B=l-p;O<l;O+=p)E+=(o[B]-o[O])*(o[O+1]+o[B+1]),B=O;return E}function rE(o,i,l,p,E){l0(o,i,l,p||o.length-1,E)}function l0(o,i,l,p,E){for(;p>l;){if(p-l>600){var O=p-l+1,B=i-l+1,te=Math.log(O),se=.5*Math.exp(2*te/3),me=.5*Math.sqrt(te*se*(O-se)/O)*(B-O/2<0?-1:1);l0(o,i,Math.max(l,Math.floor(i-B*se/O+me)),Math.min(p,Math.floor(i+(O-B)*se/O+me)),E)}var Se=o[i],De=l,Be=p;for(Nu(o,l,i),E(o[p],Se)>0&&Nu(o,l,p);De<Be;){for(Nu(o,De,Be),De++,Be--;E(o[De],Se)<0;)De++;for(;E(o[Be],Se)>0;)Be--}E(o[l],Se)===0?Nu(o,l,Be):Nu(o,++Be,p),Be<=i&&(l=Be+1),i<=Be&&(p=Be-1)}}function Nu(o,i,l){var p=o[i];o[i]=o[l],o[l]=p}function Xm(o,i){const l=o.length;if(l<=1)return[o];const p=[];let E,O;for(let B=0;B<l;B++){const te=z(o[B]);te!==0&&(o[B].area=Math.abs(te),O===void 0&&(O=te<0),O===te<0?(E&&p.push(E),E=[o[B]]):E.push(o[B]))}if(E&&p.push(E),i>1)for(let B=0;B<p.length;B++)p[B].length<=i||(rE(p[B],i,1,p[B].length-1,nE),p[B]=p[B].slice(0,i));return p}function nE(o,i){return i.area-o.area}function Zm(o,i,l){const p=l.patternDependencies;let E=!1;for(const O of i){const B=O.paint.get(`${o}-pattern`);B.isConstant()||(E=!0);const te=B.constantOr(null);te&&(E=!0,p[te.to]=!0,p[te.from]=!0)}return E}function Km(o,i,l,p,E){const O=E.patternDependencies;for(const B of i){const te=B.paint.get(`${o}-pattern`).value;if(te.kind!=="constant"){let se=te.evaluate({zoom:p-1},l,{},E.availableImages),me=te.evaluate({zoom:p},l,{},E.availableImages),Se=te.evaluate({zoom:p+1},l,{},E.availableImages);se=se&&se.name?se.name:se,me=me&&me.name?me.name:me,Se=Se&&Se.name?Se.name:Se,O[se]=!0,O[me]=!0,O[Se]=!0,l.patterns[B.id]={min:se,mid:me,max:Se}}}return l}Mp.exports=Ap,Mp.exports.default=Ap,Ap.deviation=function(o,i,l,p){var E=i&&i.length,O=Math.abs(qm(o,0,E?i[0]*l:o.length,l));if(E)for(var B=0,te=i.length;B<te;B++)O-=Math.abs(qm(o,i[B]*l,B<te-1?i[B+1]*l:o.length,l));var se=0;for(B=0;B<p.length;B+=3){var me=p[B]*l,Se=p[B+1]*l,De=p[B+2]*l;se+=Math.abs((o[me]-o[De])*(o[Se+1]-o[me+1])-(o[me]-o[Se])*(o[De+1]-o[me+1]))}return O===0&&se===0?0:Math.abs((se-O)/O)},Ap.flatten=function(o){for(var i=o[0][0].length,l={vertices:[],holes:[],dimensions:i},p=0,E=0;E<o.length;E++){for(var O=0;O<o[E].length;O++)for(var B=0;B<i;B++)l.vertices.push(o[E][O][B]);E>0&&l.holes.push(p+=o[E-1].length)}return l};class Qm{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Cr,this.indexArray=new Nn,this.indexArray2=new to,this.programConfigurations=new Xl(i.layers,i.zoom),this.segments=new fr,this.segments2=new fr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,p){this.hasPattern=Zm("fill",this.layers,l);const E=this.layers[0].layout.get("fill-sort-key"),O=!E.isConstant(),B=[];for(const{feature:te,id:se,index:me,sourceLayerIndex:Se}of i){const De=this.layers[0]._featureFilter.needGeometry,Be=Kl(te,De);if(!this.layers[0]._featureFilter.filter(new $r(this.zoom),Be,p))continue;const Ve=O?E.evaluate(Be,{},p,l.availableImages):void 0,Ye={id:se,properties:te.properties,type:te.type,sourceLayerIndex:Se,index:me,geometry:De?Be.geometry:Zl(te),patterns:{},sortKey:Ve};B.push(Ye)}O&&B.sort((te,se)=>te.sortKey-se.sortKey);for(const te of B){const{geometry:se,index:me,sourceLayerIndex:Se}=te;if(this.hasPattern){const De=Km("fill",this.layers,te,this.zoom,l);this.patternFeatures.push(De)}else this.addFeature(te,se,me,p,{});l.featureIndex.insert(i[me].feature,se,me,Se,this.index)}}update(i,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,p)}addFeatures(i,l,p){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,l,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,YT),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,l,p,E,O){for(const B of Xm(l,500)){let te=0;for(const Ve of B)te+=Ve.length;const se=this.segments.prepareSegment(te,this.layoutVertexArray,this.indexArray),me=se.vertexLength,Se=[],De=[];for(const Ve of B){if(Ve.length===0)continue;Ve!==B[0]&&De.push(Se.length/2);const Ye=this.segments2.prepareSegment(Ve.length,this.layoutVertexArray,this.indexArray2),ct=Ye.vertexLength;this.layoutVertexArray.emplaceBack(Ve[0].x,Ve[0].y),this.indexArray2.emplaceBack(ct+Ve.length-1,ct),Se.push(Ve[0].x),Se.push(Ve[0].y);for(let ot=1;ot<Ve.length;ot++)this.layoutVertexArray.emplaceBack(Ve[ot].x,Ve[ot].y),this.indexArray2.emplaceBack(ct+ot-1,ct+ot),Se.push(Ve[ot].x),Se.push(Ve[ot].y);Ye.vertexLength+=Ve.length,Ye.primitiveLength+=Ve.length}const Be=Mp.exports(Se,De);for(let Ve=0;Ve<Be.length;Ve+=3)this.indexArray.emplaceBack(me+Be[Ve],me+Be[Ve+1],me+Be[Ve+2]);se.vertexLength+=te,se.primitiveLength+=Be.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,O,E)}}di("FillBucket",Qm,{omit:["layers","patternFeatures"]});const sE=new wn({"fill-sort-key":new Mi(Re.layout_fill["fill-sort-key"])});var oE={paint:new wn({"fill-antialias":new wi(Re.paint_fill["fill-antialias"]),"fill-opacity":new Mi(Re.paint_fill["fill-opacity"]),"fill-color":new Mi(Re.paint_fill["fill-color"]),"fill-outline-color":new Mi(Re.paint_fill["fill-outline-color"]),"fill-translate":new wi(Re.paint_fill["fill-translate"]),"fill-translate-anchor":new wi(Re.paint_fill["fill-translate-anchor"]),"fill-pattern":new Vl(Re.paint_fill["fill-pattern"])}),layout:sE};const aE=gn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),lE=gn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:cE}=aE;var Ka={},hE=G,c0=ch;function ch(o,i,l,p,E){this.properties={},this.extent=l,this.type=0,this._pbf=o,this._geometry=-1,this._keys=p,this._values=E,o.readFields(uE,this,i)}function uE(o,i,l){o==1?i.id=l.readVarint():o==2?function(p,E){for(var O=p.readVarint()+p.pos;p.pos<O;){var B=E._keys[p.readVarint()],te=E._values[p.readVarint()];E.properties[B]=te}}(l,i):o==3?i.type=l.readVarint():o==4&&(i._geometry=l.pos)}function dE(o){for(var i,l,p=0,E=0,O=o.length,B=O-1;E<O;B=E++)p+=((l=o[B]).x-(i=o[E]).x)*(i.y+l.y);return p}ch.types=["Unknown","Point","LineString","Polygon"],ch.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var i,l=o.readVarint()+o.pos,p=1,E=0,O=0,B=0,te=[];o.pos<l;){if(E<=0){var se=o.readVarint();p=7&se,E=se>>3}if(E--,p===1||p===2)O+=o.readSVarint(),B+=o.readSVarint(),p===1&&(i&&te.push(i),i=[]),i.push(new hE(O,B));else{if(p!==7)throw new Error("unknown command "+p);i&&i.push(i[0].clone())}}return i&&te.push(i),te},ch.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var i=o.readVarint()+o.pos,l=1,p=0,E=0,O=0,B=1/0,te=-1/0,se=1/0,me=-1/0;o.pos<i;){if(p<=0){var Se=o.readVarint();l=7&Se,p=Se>>3}if(p--,l===1||l===2)(E+=o.readSVarint())<B&&(B=E),E>te&&(te=E),(O+=o.readSVarint())<se&&(se=O),O>me&&(me=O);else if(l!==7)throw new Error("unknown command "+l)}return[B,se,te,me]},ch.prototype.toGeoJSON=function(o,i,l){var p,E,O=this.extent*Math.pow(2,l),B=this.extent*o,te=this.extent*i,se=this.loadGeometry(),me=ch.types[this.type];function Se(Ve){for(var Ye=0;Ye<Ve.length;Ye++){var ct=Ve[Ye];Ve[Ye]=[360*(ct.x+B)/O-180,360/Math.PI*Math.atan(Math.exp((180-360*(ct.y+te)/O)*Math.PI/180))-90]}}switch(this.type){case 1:var De=[];for(p=0;p<se.length;p++)De[p]=se[p][0];Se(se=De);break;case 2:for(p=0;p<se.length;p++)Se(se[p]);break;case 3:for(se=function(Ve){var Ye=Ve.length;if(Ye<=1)return[Ve];for(var ct,ot,bt=[],Pt=0;Pt<Ye;Pt++){var yt=dE(Ve[Pt]);yt!==0&&(ot===void 0&&(ot=yt<0),ot===yt<0?(ct&&bt.push(ct),ct=[Ve[Pt]]):ct.push(Ve[Pt]))}return ct&&bt.push(ct),bt}(se),p=0;p<se.length;p++)for(E=0;E<se[p].length;E++)Se(se[p][E])}se.length===1?se=se[0]:me="Multi"+me;var Be={type:"Feature",geometry:{type:me,coordinates:se},properties:this.properties};return"id"in this&&(Be.id=this.id),Be};var pE=c0,h0=u0;function u0(o,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(fE,this,i),this.length=this._features.length}function fE(o,i,l){o===15?i.version=l.readVarint():o===1?i.name=l.readString():o===5?i.extent=l.readVarint():o===2?i._features.push(l.pos):o===3?i._keys.push(l.readString()):o===4&&i._values.push(function(p){for(var E=null,O=p.readVarint()+p.pos;p.pos<O;){var B=p.readVarint()>>3;E=B===1?p.readString():B===2?p.readFloat():B===3?p.readDouble():B===4?p.readVarint64():B===5?p.readVarint():B===6?p.readSVarint():B===7?p.readBoolean():null}return E}(l))}u0.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var i=this._pbf.readVarint()+this._pbf.pos;return new pE(this._pbf,i,this.extent,this._keys,this._values)};var mE=h0;function gE(o,i,l){if(o===3){var p=new mE(l,l.readVarint()+l.pos);p.length&&(i[p.name]=p)}}Ka.VectorTile=function(o,i){this.layers=o.readFields(gE,{},i)},Ka.VectorTileFeature=c0,Ka.VectorTileLayer=h0;const yE=Ka.VectorTileFeature.types,Jm=Math.pow(2,13);function ju(o,i,l,p,E,O,B,te){o.emplaceBack(i,l,2*Math.floor(p*Jm)+B,E*Jm*2,O*Jm*2,Math.round(te))}class eg{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new Sr,this.centroidVertexArray=new er,this.indexArray=new Nn,this.programConfigurations=new Xl(i.layers,i.zoom),this.segments=new fr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,p){this.features=[],this.hasPattern=Zm("fill-extrusion",this.layers,l);for(const{feature:E,id:O,index:B,sourceLayerIndex:te}of i){const se=this.layers[0]._featureFilter.needGeometry,me=Kl(E,se);if(!this.layers[0]._featureFilter.filter(new $r(this.zoom),me,p))continue;const Se={id:O,sourceLayerIndex:te,index:B,geometry:se?me.geometry:Zl(E),properties:E.properties,type:E.type,patterns:{}};this.hasPattern?this.features.push(Km("fill-extrusion",this.layers,Se,this.zoom,l)):this.addFeature(Se,Se.geometry,B,p,{}),l.featureIndex.insert(E,Se.geometry,B,te,this.index,!0)}}addFeatures(i,l,p){for(const E of this.features){const{geometry:O}=E;this.addFeature(E,O,E.index,l,p)}}update(i,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,cE),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,lE.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,l,p,E,O){const B={x:0,y:0,vertexCount:0};for(const te of Xm(l,500)){let se=0;for(const Ye of te)se+=Ye.length;let me=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Ye of te){if(Ye.length===0||bE(Ye))continue;let ct=0;for(let ot=0;ot<Ye.length;ot++){const bt=Ye[ot];if(ot>=1){const Pt=Ye[ot-1];if(!xE(bt,Pt)){me.vertexLength+4>fr.MAX_VERTEX_ARRAY_LENGTH&&(me=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const yt=bt.sub(Pt)._perp()._unit(),Mt=Pt.dist(bt);ct+Mt>32768&&(ct=0),ju(this.layoutVertexArray,bt.x,bt.y,yt.x,yt.y,0,0,ct),ju(this.layoutVertexArray,bt.x,bt.y,yt.x,yt.y,0,1,ct),B.x+=2*bt.x,B.y+=2*bt.y,B.vertexCount+=2,ct+=Mt,ju(this.layoutVertexArray,Pt.x,Pt.y,yt.x,yt.y,0,0,ct),ju(this.layoutVertexArray,Pt.x,Pt.y,yt.x,yt.y,0,1,ct),B.x+=2*Pt.x,B.y+=2*Pt.y,B.vertexCount+=2;const Ft=me.vertexLength;this.indexArray.emplaceBack(Ft,Ft+2,Ft+1),this.indexArray.emplaceBack(Ft+1,Ft+2,Ft+3),me.vertexLength+=4,me.primitiveLength+=2}}}}if(me.vertexLength+se>fr.MAX_VERTEX_ARRAY_LENGTH&&(me=this.segments.prepareSegment(se,this.layoutVertexArray,this.indexArray)),yE[i.type]!=="Polygon")continue;const Se=[],De=[],Be=me.vertexLength;for(const Ye of te)if(Ye.length!==0){Ye!==te[0]&&De.push(Se.length/2);for(let ct=0;ct<Ye.length;ct++){const ot=Ye[ct];ju(this.layoutVertexArray,ot.x,ot.y,0,0,1,1,0),B.x+=ot.x,B.y+=ot.y,B.vertexCount+=1,Se.push(ot.x),Se.push(ot.y)}}const Ve=Mp.exports(Se,De);for(let Ye=0;Ye<Ve.length;Ye+=3)this.indexArray.emplaceBack(Be+Ve[Ye],Be+Ve[Ye+2],Be+Ve[Ye+1]);me.primitiveLength+=Ve.length/3,me.vertexLength+=se}for(let te=0;te<B.vertexCount;te++)this.centroidVertexArray.emplaceBack(Math.floor(B.x/B.vertexCount),Math.floor(B.y/B.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,O,E)}}function xE(o,i){return o.x===i.x&&(o.x<0||o.x>Tn)||o.y===i.y&&(o.y<0||o.y>Tn)}function bE(o){return o.every(i=>i.x<0)||o.every(i=>i.x>Tn)||o.every(i=>i.y<0)||o.every(i=>i.y>Tn)}di("FillExtrusionBucket",eg,{omit:["layers","features"]});var vE={paint:new wn({"fill-extrusion-opacity":new wi(Re["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Mi(Re["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wi(Re["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wi(Re["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Vl(Re["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Mi(Re["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Mi(Re["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new wi(Re["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Bu(o,i){return o.x*i.x+o.y*i.y}function d0(o,i){if(o.length===1){let l=0;const p=i[l++];let E;for(;!E||p.equals(E);)if(E=i[l++],!E)return 1/0;for(;l<i.length;l++){const O=i[l],B=o[0],te=E.sub(p),se=O.sub(p),me=B.sub(p),Se=Bu(te,te),De=Bu(te,se),Be=Bu(se,se),Ve=Bu(me,te),Ye=Bu(me,se),ct=Se*Be-De*De,ot=(Be*Ve-De*Ye)/ct,bt=(Se*Ye-De*Ve)/ct,Pt=p.z*(1-ot-bt)+E.z*ot+O.z*bt;if(isFinite(Pt))return Pt}return 1/0}{let l=1/0;for(const p of i)l=Math.min(l,p.z);return l}}const _E=gn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:wE}=_E,TE=gn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:EE}=TE,CE=Ka.VectorTileFeature.types,SE=Math.cos(Math.PI/180*37.5),p0=Math.pow(2,14)/.5;class tg{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new lr,this.layoutVertexArray2=new hr,this.indexArray=new Nn,this.programConfigurations=new Xl(i.layers,i.zoom),this.segments=new fr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,p){this.hasPattern=Zm("line",this.layers,l);const E=this.layers[0].layout.get("line-sort-key"),O=!E.isConstant(),B=[];for(const{feature:te,id:se,index:me,sourceLayerIndex:Se}of i){const De=this.layers[0]._featureFilter.needGeometry,Be=Kl(te,De);if(!this.layers[0]._featureFilter.filter(new $r(this.zoom),Be,p))continue;const Ve=O?E.evaluate(Be,{},p):void 0,Ye={id:se,properties:te.properties,type:te.type,sourceLayerIndex:Se,index:me,geometry:De?Be.geometry:Zl(te),patterns:{},sortKey:Ve};B.push(Ye)}O&&B.sort((te,se)=>te.sortKey-se.sortKey);for(const te of B){const{geometry:se,index:me,sourceLayerIndex:Se}=te;if(this.hasPattern){const De=Km("line",this.layers,te,this.zoom,l);this.patternFeatures.push(De)}else this.addFeature(te,se,me,p,{});l.featureIndex.insert(i[me].feature,se,me,Se,this.index)}}update(i,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,p)}addFeatures(i,l,p){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,l,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,EE)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,wE),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,l,p,E,O){const B=this.layers[0].layout,te=B.get("line-join").evaluate(i,{}),se=B.get("line-cap"),me=B.get("line-miter-limit"),Se=B.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const De of l)this.addLine(De,i,te,se,me,Se);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,O,E)}addLine(i,l,p,E,O,B){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let bt=0;bt<i.length-1;bt++)this.totalDistance+=i[bt].dist(i[bt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const te=CE[l.type]==="Polygon";let se=i.length;for(;se>=2&&i[se-1].equals(i[se-2]);)se--;let me=0;for(;me<se-1&&i[me].equals(i[me+1]);)me++;if(se<(te?3:2))return;p==="bevel"&&(O=1.05);const Se=this.overscaling<=16?122880/(512*this.overscaling):0,De=this.segments.prepareSegment(10*se,this.layoutVertexArray,this.indexArray);let Be,Ve,Ye,ct,ot;this.e1=this.e2=-1,te&&(Be=i[se-2],ot=i[me].sub(Be)._unit()._perp());for(let bt=me;bt<se;bt++){if(Ye=bt===se-1?te?i[me+1]:void 0:i[bt+1],Ye&&i[bt].equals(Ye))continue;ot&&(ct=ot),Be&&(Ve=Be),Be=i[bt],ot=Ye?Ye.sub(Be)._unit()._perp():ct,ct=ct||ot;let Pt=ct.add(ot);Pt.x===0&&Pt.y===0||Pt._unit();const yt=ct.x*ot.x+ct.y*ot.y,Mt=Pt.x*ot.x+Pt.y*ot.y,Ft=Mt!==0?1/Mt:1/0,Bt=2*Math.sqrt(2-2*Mt),fi=Mt<SE&&Ve&&Ye,vi=ct.x*ot.y-ct.y*ot.x>0;if(fi&&bt>me){const Yt=Be.dist(Ve);if(Yt>2*Se){const ei=Be.sub(Be.sub(Ve)._mult(Se/Yt)._round());this.updateDistance(Ve,ei),this.addCurrentVertex(ei,ct,0,0,De),Ve=ei}}const Jt=Ve&&Ye;let Xt=Jt?p:te?"butt":E;if(Jt&&Xt==="round"&&(Ft<B?Xt="miter":Ft<=2&&(Xt="fakeround")),Xt==="miter"&&Ft>O&&(Xt="bevel"),Xt==="bevel"&&(Ft>2&&(Xt="flipbevel"),Ft<O&&(Xt="miter")),Ve&&this.updateDistance(Ve,Be),Xt==="miter")Pt._mult(Ft),this.addCurrentVertex(Be,Pt,0,0,De);else if(Xt==="flipbevel"){if(Ft>100)Pt=ot.mult(-1);else{const Yt=Ft*ct.add(ot).mag()/ct.sub(ot).mag();Pt._perp()._mult(Yt*(vi?-1:1))}this.addCurrentVertex(Be,Pt,0,0,De),this.addCurrentVertex(Be,Pt.mult(-1),0,0,De)}else if(Xt==="bevel"||Xt==="fakeround"){const Yt=-Math.sqrt(Ft*Ft-1),ei=vi?Yt:0,Kt=vi?0:Yt;if(Ve&&this.addCurrentVertex(Be,ct,ei,Kt,De),Xt==="fakeround"){const $t=Math.round(180*Bt/Math.PI/20);for(let Ci=1;Ci<$t;Ci++){let Ti=Ci/$t;if(Ti!==.5){const Fr=Ti-.5;Ti+=Ti*Fr*(Ti-1)*((1.0904+yt*(yt*(3.55645-1.43519*yt)-3.2452))*Fr*Fr+(.848013+yt*(.215638*yt-1.06021)))}const tr=ot.sub(ct)._mult(Ti)._add(ct)._unit()._mult(vi?-1:1);this.addHalfVertex(Be,tr.x,tr.y,!1,vi,0,De)}}Ye&&this.addCurrentVertex(Be,ot,-ei,-Kt,De)}else if(Xt==="butt")this.addCurrentVertex(Be,Pt,0,0,De);else if(Xt==="square"){const Yt=Ve?1:-1;this.addCurrentVertex(Be,Pt,Yt,Yt,De)}else Xt==="round"&&(Ve&&(this.addCurrentVertex(Be,ct,0,0,De),this.addCurrentVertex(Be,ct,1,1,De,!0)),Ye&&(this.addCurrentVertex(Be,ot,-1,-1,De,!0),this.addCurrentVertex(Be,ot,0,0,De)));if(fi&&bt<se-1){const Yt=Be.dist(Ye);if(Yt>2*Se){const ei=Be.add(Ye.sub(Be)._mult(Se/Yt)._round());this.updateDistance(Be,ei),this.addCurrentVertex(ei,ot,0,0,De),Be=ei}}}}addCurrentVertex(i,l,p,E,O,B=!1){const te=l.y*E-l.x,se=-l.y-l.x*E;this.addHalfVertex(i,l.x+l.y*p,l.y-l.x*p,B,!1,p,O),this.addHalfVertex(i,te,se,B,!0,-E,O),this.distance>p0/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(i,l,p,E,O,B))}addHalfVertex({x:i,y:l},p,E,O,B,te,se){const me=.5*(this.lineClips?this.scaledDistance*(p0-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(O?1:0),(l<<1)+(B?1:0),Math.round(63*p)+128,Math.round(63*E)+128,1+(te===0?0:te<0?-1:1)|(63&me)<<2,me>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Se=se.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Se),se.primitiveLength++),B?this.e2=Se:this.e1=Se}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,l){this.distance+=i.dist(l),this.updateScaledDistance()}}di("LineBucket",tg,{omit:["layers","patternFeatures"]});const kE=new wn({"line-cap":new wi(Re.layout_line["line-cap"]),"line-join":new Mi(Re.layout_line["line-join"]),"line-miter-limit":new wi(Re.layout_line["line-miter-limit"]),"line-round-limit":new wi(Re.layout_line["line-round-limit"]),"line-sort-key":new Mi(Re.layout_line["line-sort-key"])});var f0={paint:new wn({"line-opacity":new Mi(Re.paint_line["line-opacity"]),"line-color":new Mi(Re.paint_line["line-color"]),"line-translate":new wi(Re.paint_line["line-translate"]),"line-translate-anchor":new wi(Re.paint_line["line-translate-anchor"]),"line-width":new Mi(Re.paint_line["line-width"]),"line-gap-width":new Mi(Re.paint_line["line-gap-width"]),"line-offset":new Mi(Re.paint_line["line-offset"]),"line-blur":new Mi(Re.paint_line["line-blur"]),"line-dasharray":new Hl(Re.paint_line["line-dasharray"]),"line-pattern":new Vl(Re.paint_line["line-pattern"]),"line-gradient":new Mu(Re.paint_line["line-gradient"])}),layout:kE};const m0=new class extends Mi{possiblyEvaluate(o,i){return i=new $r(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(o,i)}evaluate(o,i,l,p){return i=_({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(o,i,l,p)}}(f0.paint.properties["line-width"].specification);function g0(o,i){return i>0?i+2*o:o}m0.useIntegerZoom=!0;const ME=gn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),AE=gn([{name:"a_projected_pos",components:3,type:"Float32"}],4);gn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const PE=gn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);gn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const y0=gn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),IE=gn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function DE(o,i,l){return o.sections.forEach(p=>{p.text=function(E,O,B){const te=O.layout.get("text-transform").evaluate(B,{});return te==="uppercase"?E=E.toLocaleUpperCase():te==="lowercase"&&(E=E.toLocaleLowerCase()),Vs.applyArabicShaping&&(E=Vs.applyArabicShaping(E)),E}(p.text,i,l)}),o}gn([{name:"triangle",components:3,type:"Uint16"}]),gn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),gn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),gn([{type:"Float32",name:"offsetX"}]),gn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Fu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var jn=24,ig=Pr,x0=function(o,i,l,p,E){var O,B,te=8*E-p-1,se=(1<<te)-1,me=se>>1,Se=-7,De=E-1,Be=-1,Ve=o[i+De];for(De+=Be,O=Ve&(1<<-Se)-1,Ve>>=-Se,Se+=te;Se>0;O=256*O+o[i+De],De+=Be,Se-=8);for(B=O&(1<<-Se)-1,O>>=-Se,Se+=p;Se>0;B=256*B+o[i+De],De+=Be,Se-=8);if(O===0)O=1-me;else{if(O===se)return B?NaN:1/0*(Ve?-1:1);B+=Math.pow(2,p),O-=me}return(Ve?-1:1)*B*Math.pow(2,O-p)},b0=function(o,i,l,p,E,O){var B,te,se,me=8*O-E-1,Se=(1<<me)-1,De=Se>>1,Be=E===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ve=0,Ye=1,ct=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(te=isNaN(i)?1:0,B=Se):(B=Math.floor(Math.log(i)/Math.LN2),i*(se=Math.pow(2,-B))<1&&(B--,se*=2),(i+=B+De>=1?Be/se:Be*Math.pow(2,1-De))*se>=2&&(B++,se/=2),B+De>=Se?(te=0,B=Se):B+De>=1?(te=(i*se-1)*Math.pow(2,E),B+=De):(te=i*Math.pow(2,De-1)*Math.pow(2,E),B=0));E>=8;o[l+Ve]=255&te,Ve+=Ye,te/=256,E-=8);for(B=B<<E|te,me+=E;me>0;o[l+Ve]=255&B,Ve+=Ye,B/=256,me-=8);o[l+Ve-Ye]|=128*ct};function Pr(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}Pr.Varint=0,Pr.Fixed64=1,Pr.Bytes=2,Pr.Fixed32=5;var Qa,rg=4294967296,v0=1/rg,_0=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ba(o){return o.type===Pr.Bytes?o.readVarint()+o.pos:o.pos+1}function hh(o,i,l){return l?4294967296*i+(o>>>0):4294967296*(i>>>0)+(o>>>0)}function w0(o,i,l){var p=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));l.realloc(p);for(var E=l.pos-1;E>=o;E--)l.buf[E+p]=l.buf[E]}function LE(o,i){for(var l=0;l<o.length;l++)i.writeVarint(o[l])}function RE(o,i){for(var l=0;l<o.length;l++)i.writeSVarint(o[l])}function OE(o,i){for(var l=0;l<o.length;l++)i.writeFloat(o[l])}function zE(o,i){for(var l=0;l<o.length;l++)i.writeDouble(o[l])}function NE(o,i){for(var l=0;l<o.length;l++)i.writeBoolean(o[l])}function jE(o,i){for(var l=0;l<o.length;l++)i.writeFixed32(o[l])}function BE(o,i){for(var l=0;l<o.length;l++)i.writeSFixed32(o[l])}function FE(o,i){for(var l=0;l<o.length;l++)i.writeFixed64(o[l])}function UE(o,i){for(var l=0;l<o.length;l++)i.writeSFixed64(o[l])}function Lp(o,i){return(o[i]|o[i+1]<<8|o[i+2]<<16)+16777216*o[i+3]}function uh(o,i,l){o[l]=i,o[l+1]=i>>>8,o[l+2]=i>>>16,o[l+3]=i>>>24}function T0(o,i){return(o[i]|o[i+1]<<8|o[i+2]<<16)+(o[i+3]<<24)}function $E(o,i,l){o===1&&l.readMessage(GE,i)}function GE(o,i,l){if(o===3){const{id:p,bitmap:E,width:O,height:B,left:te,top:se,advance:me}=l.readMessage(VE,{});i.push({id:p,bitmap:new Lu({width:O+6,height:B+6},E),metrics:{width:O,height:B,left:te,top:se,advance:me}})}}function VE(o,i,l){o===1?i.id=l.readVarint():o===2?i.bitmap=l.readBytes():o===3?i.width=l.readVarint():o===4?i.height=l.readVarint():o===5?i.left=l.readSVarint():o===6?i.top=l.readSVarint():o===7&&(i.advance=l.readVarint())}function E0(o){let i=0,l=0;for(const B of o)i+=B.w*B.h,l=Math.max(l,B.w);o.sort((B,te)=>te.h-B.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),l),h:1/0}];let E=0,O=0;for(const B of o)for(let te=p.length-1;te>=0;te--){const se=p[te];if(!(B.w>se.w||B.h>se.h)){if(B.x=se.x,B.y=se.y,O=Math.max(O,B.y+B.h),E=Math.max(E,B.x+B.w),B.w===se.w&&B.h===se.h){const me=p.pop();te<p.length&&(p[te]=me)}else B.h===se.h?(se.x+=B.w,se.w-=B.w):B.w===se.w?(se.y+=B.h,se.h-=B.h):(p.push({x:se.x+B.w,y:se.y,w:se.w-B.w,h:B.h}),se.y+=B.h,se.h-=B.h);break}}return{w:E,h:O,fill:i/(E*O)||0}}Pr.prototype={destroy:function(){this.buf=null},readFields:function(o,i,l){for(l=l||this.length;this.pos<l;){var p=this.readVarint(),E=p>>3,O=this.pos;this.type=7&p,o(E,i,this),this.pos===O&&this.skip(p)}return i},readMessage:function(o,i){return this.readFields(o,i,this.readVarint()+this.pos)},readFixed32:function(){var o=Lp(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=T0(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=Lp(this.buf,this.pos)+Lp(this.buf,this.pos+4)*rg;return this.pos+=8,o},readSFixed64:function(){var o=Lp(this.buf,this.pos)+T0(this.buf,this.pos+4)*rg;return this.pos+=8,o},readFloat:function(){var o=x0(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=x0(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var i,l,p=this.buf;return i=127&(l=p[this.pos++]),l<128?i:(i|=(127&(l=p[this.pos++]))<<7,l<128?i:(i|=(127&(l=p[this.pos++]))<<14,l<128?i:(i|=(127&(l=p[this.pos++]))<<21,l<128?i:function(E,O,B){var te,se,me=B.buf;if(te=(112&(se=me[B.pos++]))>>4,se<128||(te|=(127&(se=me[B.pos++]))<<3,se<128)||(te|=(127&(se=me[B.pos++]))<<10,se<128)||(te|=(127&(se=me[B.pos++]))<<17,se<128)||(te|=(127&(se=me[B.pos++]))<<24,se<128)||(te|=(1&(se=me[B.pos++]))<<31,se<128))return hh(E,te,O);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(l=p[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var o=this.readVarint()+this.pos,i=this.pos;return this.pos=o,o-i>=12&&_0?function(l,p,E){return _0.decode(l.subarray(p,E))}(this.buf,i,o):function(l,p,E){for(var O="",B=p;B<E;){var te,se,me,Se=l[B],De=null,Be=Se>239?4:Se>223?3:Se>191?2:1;if(B+Be>E)break;Be===1?Se<128&&(De=Se):Be===2?(192&(te=l[B+1]))==128&&(De=(31&Se)<<6|63&te)<=127&&(De=null):Be===3?(se=l[B+2],(192&(te=l[B+1]))==128&&(192&se)==128&&((De=(15&Se)<<12|(63&te)<<6|63&se)<=2047||De>=55296&&De<=57343)&&(De=null)):Be===4&&(se=l[B+2],me=l[B+3],(192&(te=l[B+1]))==128&&(192&se)==128&&(192&me)==128&&((De=(15&Se)<<18|(63&te)<<12|(63&se)<<6|63&me)<=65535||De>=1114112)&&(De=null)),De===null?(De=65533,Be=1):De>65535&&(De-=65536,O+=String.fromCharCode(De>>>10&1023|55296),De=56320|1023&De),O+=String.fromCharCode(De),B+=Be}return O}(this.buf,i,o)},readBytes:function(){var o=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,o);return this.pos=o,i},readPackedVarint:function(o,i){if(this.type!==Pr.Bytes)return o.push(this.readVarint(i));var l=ba(this);for(o=o||[];this.pos<l;)o.push(this.readVarint(i));return o},readPackedSVarint:function(o){if(this.type!==Pr.Bytes)return o.push(this.readSVarint());var i=ba(this);for(o=o||[];this.pos<i;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==Pr.Bytes)return o.push(this.readBoolean());var i=ba(this);for(o=o||[];this.pos<i;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==Pr.Bytes)return o.push(this.readFloat());var i=ba(this);for(o=o||[];this.pos<i;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==Pr.Bytes)return o.push(this.readDouble());var i=ba(this);for(o=o||[];this.pos<i;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==Pr.Bytes)return o.push(this.readFixed32());var i=ba(this);for(o=o||[];this.pos<i;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==Pr.Bytes)return o.push(this.readSFixed32());var i=ba(this);for(o=o||[];this.pos<i;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==Pr.Bytes)return o.push(this.readFixed64());var i=ba(this);for(o=o||[];this.pos<i;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==Pr.Bytes)return o.push(this.readSFixed64());var i=ba(this);for(o=o||[];this.pos<i;)o.push(this.readSFixed64());return o},skip:function(o){var i=7&o;if(i===Pr.Varint)for(;this.buf[this.pos++]>127;);else if(i===Pr.Bytes)this.pos=this.readVarint()+this.pos;else if(i===Pr.Fixed32)this.pos+=4;else{if(i!==Pr.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(o,i){this.writeVarint(o<<3|i)},realloc:function(o){for(var i=this.length||16;i<this.pos+o;)i*=2;if(i!==this.length){var l=new Uint8Array(i);l.set(this.buf),this.buf=l,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),uh(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),uh(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),uh(this.buf,-1&o,this.pos),uh(this.buf,Math.floor(o*v0),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),uh(this.buf,-1&o,this.pos),uh(this.buf,Math.floor(o*v0),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(i,l){var p,E;if(i>=0?(p=i%4294967296|0,E=i/4294967296|0):(E=~(-i/4294967296),4294967295^(p=~(-i%4294967296))?p=p+1|0:(p=0,E=E+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(O,B,te){te.buf[te.pos++]=127&O|128,O>>>=7,te.buf[te.pos++]=127&O|128,O>>>=7,te.buf[te.pos++]=127&O|128,O>>>=7,te.buf[te.pos++]=127&O|128,te.buf[te.pos]=127&(O>>>=7)}(p,0,l),function(O,B){var te=(7&O)<<4;B.buf[B.pos++]|=te|((O>>>=3)?128:0),O&&(B.buf[B.pos++]=127&O|((O>>>=7)?128:0),O&&(B.buf[B.pos++]=127&O|((O>>>=7)?128:0),O&&(B.buf[B.pos++]=127&O|((O>>>=7)?128:0),O&&(B.buf[B.pos++]=127&O|((O>>>=7)?128:0),O&&(B.buf[B.pos++]=127&O)))))}(E,l)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(!!o)},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var i=this.pos;this.pos=function(p,E,O){for(var B,te,se=0;se<E.length;se++){if((B=E.charCodeAt(se))>55295&&B<57344){if(!te){B>56319||se+1===E.length?(p[O++]=239,p[O++]=191,p[O++]=189):te=B;continue}if(B<56320){p[O++]=239,p[O++]=191,p[O++]=189,te=B;continue}B=te-55296<<10|B-56320|65536,te=null}else te&&(p[O++]=239,p[O++]=191,p[O++]=189,te=null);B<128?p[O++]=B:(B<2048?p[O++]=B>>6|192:(B<65536?p[O++]=B>>12|224:(p[O++]=B>>18|240,p[O++]=B>>12&63|128),p[O++]=B>>6&63|128),p[O++]=63&B|128)}return O}(this.buf,o,this.pos);var l=this.pos-i;l>=128&&w0(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeFloat:function(o){this.realloc(4),b0(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),b0(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var i=o.length;this.writeVarint(i),this.realloc(i);for(var l=0;l<i;l++)this.buf[this.pos++]=o[l]},writeRawMessage:function(o,i){this.pos++;var l=this.pos;o(i,this);var p=this.pos-l;p>=128&&w0(l,p,this),this.pos=l-1,this.writeVarint(p),this.pos+=p},writeMessage:function(o,i,l){this.writeTag(o,Pr.Bytes),this.writeRawMessage(i,l)},writePackedVarint:function(o,i){i.length&&this.writeMessage(o,LE,i)},writePackedSVarint:function(o,i){i.length&&this.writeMessage(o,RE,i)},writePackedBoolean:function(o,i){i.length&&this.writeMessage(o,NE,i)},writePackedFloat:function(o,i){i.length&&this.writeMessage(o,OE,i)},writePackedDouble:function(o,i){i.length&&this.writeMessage(o,zE,i)},writePackedFixed32:function(o,i){i.length&&this.writeMessage(o,jE,i)},writePackedSFixed32:function(o,i){i.length&&this.writeMessage(o,BE,i)},writePackedFixed64:function(o,i){i.length&&this.writeMessage(o,FE,i)},writePackedSFixed64:function(o,i){i.length&&this.writeMessage(o,UE,i)},writeBytesField:function(o,i){this.writeTag(o,Pr.Bytes),this.writeBytes(i)},writeFixed32Field:function(o,i){this.writeTag(o,Pr.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(o,i){this.writeTag(o,Pr.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(o,i){this.writeTag(o,Pr.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(o,i){this.writeTag(o,Pr.Fixed64),this.writeSFixed64(i)},writeVarintField:function(o,i){this.writeTag(o,Pr.Varint),this.writeVarint(i)},writeSVarintField:function(o,i){this.writeTag(o,Pr.Varint),this.writeSVarint(i)},writeStringField:function(o,i){this.writeTag(o,Pr.Bytes),this.writeString(i)},writeFloatField:function(o,i){this.writeTag(o,Pr.Fixed32),this.writeFloat(i)},writeDoubleField:function(o,i){this.writeTag(o,Pr.Fixed64),this.writeDouble(i)},writeBooleanField:function(o,i){this.writeVarintField(o,!!i)}};class ng{constructor(i,{pixelRatio:l,version:p,stretchX:E,stretchY:O,content:B}){this.paddedRect=i,this.pixelRatio=l,this.stretchX=E,this.stretchY=O,this.content=B,this.version=p}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class C0{constructor(i,l){const p={},E={};this.haveRenderCallbacks=[];const O=[];this.addImages(i,p,O),this.addImages(l,E,O);const{w:B,h:te}=E0(O),se=new ro({width:B||1,height:te||1});for(const me in i){const Se=i[me],De=p[me].paddedRect;ro.copy(Se.data,se,{x:0,y:0},{x:De.x+1,y:De.y+1},Se.data)}for(const me in l){const Se=l[me],De=E[me].paddedRect,Be=De.x+1,Ve=De.y+1,Ye=Se.data.width,ct=Se.data.height;ro.copy(Se.data,se,{x:0,y:0},{x:Be,y:Ve},Se.data),ro.copy(Se.data,se,{x:0,y:ct-1},{x:Be,y:Ve-1},{width:Ye,height:1}),ro.copy(Se.data,se,{x:0,y:0},{x:Be,y:Ve+ct},{width:Ye,height:1}),ro.copy(Se.data,se,{x:Ye-1,y:0},{x:Be-1,y:Ve},{width:1,height:ct}),ro.copy(Se.data,se,{x:0,y:0},{x:Be+Ye,y:Ve},{width:1,height:ct})}this.image=se,this.iconPositions=p,this.patternPositions=E}addImages(i,l,p){for(const E in i){const O=i[E],B={x:0,y:0,w:O.data.width+2,h:O.data.height+2};p.push(B),l[E]=new ng(B,O),O.hasRenderCallback&&this.haveRenderCallbacks.push(E)}}patchUpdatedImages(i,l){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in i.updatedImages)this.patchUpdatedImage(this.iconPositions[p],i.getImage(p),l),this.patchUpdatedImage(this.patternPositions[p],i.getImage(p),l)}patchUpdatedImage(i,l,p){if(!i||!l||i.version===l.version)return;i.version=l.version;const[E,O]=i.tl;p.update(l.data,void 0,{x:E,y:O})}}di("ImagePosition",ng),di("ImageAtlas",C0),s.WritingMode=void 0,(Qa=s.WritingMode||(s.WritingMode={}))[Qa.none=0]="none",Qa[Qa.horizontal=1]="horizontal",Qa[Qa.vertical=2]="vertical",Qa[Qa.horizontalOnly=3]="horizontalOnly";const Rp=-17;class Uu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,l){const p=new Uu;return p.scale=i||1,p.fontStack=l,p}static forImage(i){const l=new Uu;return l.imageName=i,l}}class dh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,l){const p=new dh;for(let E=0;E<i.sections.length;E++){const O=i.sections[E];O.image?p.addImageSection(O):p.addTextSection(O,l)}return p}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let l="";for(let p=0;p<i.length;p++){const E=i.charCodeAt(p+1)||null,O=i.charCodeAt(p-1)||null;l+=E&&xp(E)&&!Fu[i[p+1]]||O&&xp(O)&&!Fu[i[p-1]]||!Fu[i[p]]?i[p]:Fu[i[p]]}return l}(this.text)}trim(){let i=0;for(let p=0;p<this.text.length&&zp[this.text.charCodeAt(p)];p++)i++;let l=this.text.length;for(let p=this.text.length-1;p>=0&&p>=i&&zp[this.text.charCodeAt(p)];p--)l--;this.text=this.text.substring(i,l),this.sectionIndex=this.sectionIndex.slice(i,l)}substring(i,l){const p=new dh;return p.text=this.text.substring(i,l),p.sectionIndex=this.sectionIndex.slice(i,l),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,l)=>Math.max(i,this.sections[l].scale),0)}addTextSection(i,l){this.text+=i.text,this.sections.push(Uu.forText(i.scale,i.fontStack||l));const p=this.sections.length-1;for(let E=0;E<i.text.length;++E)this.sectionIndex.push(p)}addImageSection(i){const l=i.image?i.image.name:"";if(l.length===0)return void w("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(Uu.forImage(l)),this.sectionIndex.push(this.sections.length-1)):w("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Op(o,i,l,p,E,O,B,te,se,me,Se,De,Be,Ve,Ye,ct){const ot=dh.fromFeature(o,E);let bt;De===s.WritingMode.vertical&&ot.verticalizePunctuation();const{processBidirectionalText:Pt,processStyledBidirectionalText:yt}=Vs;if(Pt&&ot.sections.length===1){bt=[];const Bt=Pt(ot.toString(),sg(ot,me,O,i,p,Ve,Ye));for(const fi of Bt){const vi=new dh;vi.text=fi,vi.sections=ot.sections;for(let Jt=0;Jt<fi.length;Jt++)vi.sectionIndex.push(0);bt.push(vi)}}else if(yt){bt=[];const Bt=yt(ot.text,ot.sectionIndex,sg(ot,me,O,i,p,Ve,Ye));for(const fi of Bt){const vi=new dh;vi.text=fi[0],vi.sectionIndex=fi[1],vi.sections=ot.sections,bt.push(vi)}}else bt=function(Bt,fi){const vi=[],Jt=Bt.text;let Xt=0;for(const Yt of fi)vi.push(Bt.substring(Xt,Yt)),Xt=Yt;return Xt<Jt.length&&vi.push(Bt.substring(Xt,Jt.length)),vi}(ot,sg(ot,me,O,i,p,Ve,Ye));const Mt=[],Ft={positionedLines:Mt,text:ot.toString(),top:Se[1],bottom:Se[1],left:Se[0],right:Se[0],writingMode:De,iconsInText:!1,verticalizable:!1};return function(Bt,fi,vi,Jt,Xt,Yt,ei,Kt,$t,Ci,Ti,tr){let Fr=0,Vr=Rp,En=0,so=0;const Wn=Kt==="right"?1:Kt==="left"?0:.5;let xn=0;for(const bn of Xt){bn.trim();const qn=bn.getMaxScale(),es=(qn-1)*jn,bs={positionedGlyphs:[],lineOffset:0};Bt.positionedLines[xn]=bs;const Ms=bs.positionedGlyphs;let As=0;if(!bn.length()){Vr+=Yt,++xn;continue}for(let In=0;In<bn.length();In++){const sr=bn.getSection(In),Ws=bn.getSectionIndex(In),Xn=bn.getCharCode(In);let ts=0,xo=null,Mo=null,Ao=null,_a=jn;const bo=!($t===s.WritingMode.horizontal||!Ti&&!Gl(Xn)||Ti&&(zp[Xn]||(Pn=Xn,Qt.Arabic(Pn)||Qt["Arabic Supplement"](Pn)||Qt["Arabic Extended-A"](Pn)||Qt["Arabic Presentation Forms-A"](Pn)||Qt["Arabic Presentation Forms-B"](Pn))));if(sr.imageName){const oo=Jt[sr.imageName];if(!oo)continue;Ao=sr.imageName,Bt.iconsInText=Bt.iconsInText||!0,Mo=oo.paddedRect;const Ps=oo.displaySize;sr.scale=sr.scale*jn/tr,xo={width:Ps[0],height:Ps[1],left:1,top:-3,advance:bo?Ps[1]:Ps[0]},ts=es+(jn-Ps[1]*sr.scale),_a=xo.advance;const wa=bo?Ps[0]*sr.scale-jn*qn:Ps[1]*sr.scale-jn*qn;wa>0&&wa>As&&(As=wa)}else{const oo=vi[sr.fontStack],Ps=oo&&oo[Xn];if(Ps&&Ps.rect)Mo=Ps.rect,xo=Ps.metrics;else{const wa=fi[sr.fontStack],Vu=wa&&wa[Xn];if(!Vu)continue;xo=Vu.metrics}ts=(qn-sr.scale)*jn}bo?(Bt.verticalizable=!0,Ms.push({glyph:Xn,imageName:Ao,x:Fr,y:Vr+ts,vertical:bo,scale:sr.scale,fontStack:sr.fontStack,sectionIndex:Ws,metrics:xo,rect:Mo}),Fr+=_a*sr.scale+Ci):(Ms.push({glyph:Xn,imageName:Ao,x:Fr,y:Vr+ts,vertical:bo,scale:sr.scale,fontStack:sr.fontStack,sectionIndex:Ws,metrics:xo,rect:Mo}),Fr+=xo.advance*sr.scale+Ci)}Ms.length!==0&&(En=Math.max(Fr-Ci,En),YE(Ms,0,Ms.length-1,Wn,As)),Fr=0;const Xr=Yt*qn+As;bs.lineOffset=Math.max(As,es),Vr+=Xr,so=Math.max(Xr,so),++xn}var Pn;const Yn=Vr-Rp,{horizontalAlign:Jn,verticalAlign:ks}=og(ei);(function(bn,qn,es,bs,Ms,As,Xr,In,sr){const Ws=(qn-es)*Ms;let Xn=0;Xn=As!==Xr?-In*bs-Rp:(-bs*sr+.5)*Xr;for(const ts of bn)for(const xo of ts.positionedGlyphs)xo.x+=Ws,xo.y+=Xn})(Bt.positionedLines,Wn,Jn,ks,En,so,Yt,Yn,Xt.length),Bt.top+=-ks*Yn,Bt.bottom=Bt.top+Yn,Bt.left+=-Jn*En,Bt.right=Bt.left+En}(Ft,i,l,p,bt,B,te,se,De,me,Be,ct),!function(Bt){for(const fi of Bt)if(fi.positionedGlyphs.length!==0)return!1;return!0}(Mt)&&Ft}const zp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},HE={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function S0(o,i,l,p,E,O){if(i.imageName){const B=p[i.imageName];return B?B.displaySize[0]*i.scale*jn/O+E:0}{const B=l[i.fontStack],te=B&&B[o];return te?te.metrics.advance*i.scale+E:0}}function k0(o,i,l,p){const E=Math.pow(o-i,2);return p?o<i?E/2:2*E:E+Math.abs(l)*l}function WE(o,i,l){let p=0;return o===10&&(p-=1e4),l&&(p+=150),o!==40&&o!==65288||(p+=50),i!==41&&i!==65289||(p+=50),p}function M0(o,i,l,p,E,O){let B=null,te=k0(i,l,E,O);for(const se of p){const me=k0(i-se.x,l,E,O)+se.badness;me<=te&&(B=se,te=me)}return{index:o,x:i,priorBreak:B,badness:te}}function A0(o){return o?A0(o.priorBreak).concat(o.index):[]}function sg(o,i,l,p,E,O,B){if(O!=="point")return[];if(!o)return[];const te=[],se=function(Be,Ve,Ye,ct,ot,bt){let Pt=0;for(let yt=0;yt<Be.length();yt++){const Mt=Be.getSection(yt);Pt+=S0(Be.getCharCode(yt),Mt,ct,ot,Ve,bt)}return Pt/Math.max(1,Math.ceil(Pt/Ye))}(o,i,l,p,E,B),me=o.text.indexOf("​")>=0;let Se=0;for(let Be=0;Be<o.length();Be++){const Ve=o.getSection(Be),Ye=o.getCharCode(Be);if(zp[Ye]||(Se+=S0(Ye,Ve,p,E,i,B)),Be<o.length()-1){const ct=!((De=Ye)<11904||!(Qt["Bopomofo Extended"](De)||Qt.Bopomofo(De)||Qt["CJK Compatibility Forms"](De)||Qt["CJK Compatibility Ideographs"](De)||Qt["CJK Compatibility"](De)||Qt["CJK Radicals Supplement"](De)||Qt["CJK Strokes"](De)||Qt["CJK Symbols and Punctuation"](De)||Qt["CJK Unified Ideographs Extension A"](De)||Qt["CJK Unified Ideographs"](De)||Qt["Enclosed CJK Letters and Months"](De)||Qt["Halfwidth and Fullwidth Forms"](De)||Qt.Hiragana(De)||Qt["Ideographic Description Characters"](De)||Qt["Kangxi Radicals"](De)||Qt["Katakana Phonetic Extensions"](De)||Qt.Katakana(De)||Qt["Vertical Forms"](De)||Qt["Yi Radicals"](De)||Qt["Yi Syllables"](De)));(HE[Ye]||ct||Ve.imageName)&&te.push(M0(Be+1,Se,se,te,WE(Ye,o.getCharCode(Be+1),ct&&me),!1))}}var De;return A0(M0(o.length(),Se,se,te,0,!0))}function og(o){let i=.5,l=.5;switch(o){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:i,verticalAlign:l}}function YE(o,i,l,p,E){if(!p&&!E)return;const O=o[l],B=(o[l].x+O.metrics.advance*O.scale)*p;for(let te=i;te<=l;te++)o[te].x-=B,o[te].y+=E}function qE(o,i,l){const{horizontalAlign:p,verticalAlign:E}=og(l),O=i[0]-o.displaySize[0]*p,B=i[1]-o.displaySize[1]*E;return{image:o,top:B,bottom:B+o.displaySize[1],left:O,right:O+o.displaySize[0]}}function P0(o,i,l,p,E,O){const B=o.image;let te;if(B.content){const ot=B.content,bt=B.pixelRatio||1;te=[ot[0]/bt,ot[1]/bt,B.displaySize[0]-ot[2]/bt,B.displaySize[1]-ot[3]/bt]}const se=i.left*O,me=i.right*O;let Se,De,Be,Ve;l==="width"||l==="both"?(Ve=E[0]+se-p[3],De=E[0]+me+p[1]):(Ve=E[0]+(se+me-B.displaySize[0])/2,De=Ve+B.displaySize[0]);const Ye=i.top*O,ct=i.bottom*O;return l==="height"||l==="both"?(Se=E[1]+Ye-p[0],Be=E[1]+ct+p[2]):(Se=E[1]+(Ye+ct-B.displaySize[1])/2,Be=Se+B.displaySize[1]),{image:B,top:Se,right:De,bottom:Be,left:Ve,collisionPadding:te}}const va=128;function I0(o,i){const{expression:l}=i;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new $r(o+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:E}=l;let O=0;for(;O<p.length&&p[O]<=o;)O++;O=Math.max(0,O-1);let B=O;for(;B<p.length&&p[B]<o+1;)B++;B=Math.min(p.length-1,B);const te=p[O],se=p[B];return l.kind==="composite"?{kind:"composite",minZoom:te,maxZoom:se,interpolationType:E}:{kind:"camera",minZoom:te,maxZoom:se,minSize:l.evaluate(new $r(te)),maxSize:l.evaluate(new $r(se)),interpolationType:E}}}class Ja extends G{constructor(i,l,p,E){super(i,l),this.angle=p,E!==void 0&&(this.segment=E)}clone(){return new Ja(this.x,this.y,this.angle,this.segment)}}function D0(o,i,l,p,E){if(i.segment===void 0)return!0;let O=i,B=i.segment+1,te=0;for(;te>-l/2;){if(B--,B<0)return!1;te-=o[B].dist(O),O=o[B]}te+=o[B].dist(o[B+1]),B++;const se=[];let me=0;for(;te<l/2;){const Se=o[B],De=o[B+1];if(!De)return!1;let Be=o[B-1].angleTo(Se)-Se.angleTo(De);for(Be=Math.abs((Be+3*Math.PI)%(2*Math.PI)-Math.PI),se.push({distance:te,angleDelta:Be}),me+=Be;te-se[0].distance>p;)me-=se.shift().angleDelta;if(me>E)return!1;B++,te+=Se.dist(De)}return!0}function L0(o){let i=0;for(let l=0;l<o.length-1;l++)i+=o[l].dist(o[l+1]);return i}function R0(o,i,l){return o?.6*i*l:0}function O0(o,i){return Math.max(o?o.right-o.left:0,i?i.right-i.left:0)}function XE(o,i,l,p,E,O){const B=R0(l,E,O),te=O0(l,p)*O;let se=0;const me=L0(o)/2;for(let Se=0;Se<o.length-1;Se++){const De=o[Se],Be=o[Se+1],Ve=De.dist(Be);if(se+Ve>me){const Ye=(me-se)/Ve,ct=Yr(De.x,Be.x,Ye),ot=Yr(De.y,Be.y,Ye),bt=new Ja(ct,ot,Be.angleTo(De),Se);return bt._round(),!B||D0(o,bt,te,B,i)?bt:void 0}se+=Ve}}function ZE(o,i,l,p,E,O,B,te,se){const me=R0(p,O,B),Se=O0(p,E),De=Se*B,Be=o[0].x===0||o[0].x===se||o[0].y===0||o[0].y===se;return i-De<i/4&&(i=De+i/4),z0(o,Be?i/2*te%i:(Se/2+2*O)*B*te%i,i,me,l,De,Be,!1,se)}function z0(o,i,l,p,E,O,B,te,se){const me=O/2,Se=L0(o);let De=0,Be=i-l,Ve=[];for(let Ye=0;Ye<o.length-1;Ye++){const ct=o[Ye],ot=o[Ye+1],bt=ct.dist(ot),Pt=ot.angleTo(ct);for(;Be+l<De+bt;){Be+=l;const yt=(Be-De)/bt,Mt=Yr(ct.x,ot.x,yt),Ft=Yr(ct.y,ot.y,yt);if(Mt>=0&&Mt<se&&Ft>=0&&Ft<se&&Be-me>=0&&Be+me<=Se){const Bt=new Ja(Mt,Ft,Pt,Ye);Bt._round(),p&&!D0(o,Bt,O,p,E)||Ve.push(Bt)}}De+=bt}return te||Ve.length||B||(Ve=z0(o,De/2,l,p,E,O,B,!0,se)),Ve}function N0(o,i,l,p,E){const O=[];for(let B=0;B<o.length;B++){const te=o[B];let se;for(let me=0;me<te.length-1;me++){let Se=te[me],De=te[me+1];Se.x<i&&De.x<i||(Se.x<i?Se=new G(i,Se.y+(i-Se.x)/(De.x-Se.x)*(De.y-Se.y))._round():De.x<i&&(De=new G(i,Se.y+(i-Se.x)/(De.x-Se.x)*(De.y-Se.y))._round()),Se.y<l&&De.y<l||(Se.y<l?Se=new G(Se.x+(l-Se.y)/(De.y-Se.y)*(De.x-Se.x),l)._round():De.y<l&&(De=new G(Se.x+(l-Se.y)/(De.y-Se.y)*(De.x-Se.x),l)._round()),Se.x>=p&&De.x>=p||(Se.x>=p?Se=new G(p,Se.y+(p-Se.x)/(De.x-Se.x)*(De.y-Se.y))._round():De.x>=p&&(De=new G(p,Se.y+(p-Se.x)/(De.x-Se.x)*(De.y-Se.y))._round()),Se.y>=E&&De.y>=E||(Se.y>=E?Se=new G(Se.x+(E-Se.y)/(De.y-Se.y)*(De.x-Se.x),E)._round():De.y>=E&&(De=new G(Se.x+(E-Se.y)/(De.y-Se.y)*(De.x-Se.x),E)._round()),se&&Se.equals(se[se.length-1])||(se=[Se],O.push(se)),se.push(De)))))}}return O}function j0(o,i,l,p){const E=[],O=o.image,B=O.pixelRatio,te=O.paddedRect.w-2,se=O.paddedRect.h-2,me=o.right-o.left,Se=o.bottom-o.top,De=O.stretchX||[[0,te]],Be=O.stretchY||[[0,se]],Ve=(Yt,ei)=>Yt+ei[1]-ei[0],Ye=De.reduce(Ve,0),ct=Be.reduce(Ve,0),ot=te-Ye,bt=se-ct;let Pt=0,yt=Ye,Mt=0,Ft=ct,Bt=0,fi=ot,vi=0,Jt=bt;if(O.content&&p){const Yt=O.content;Pt=Np(De,0,Yt[0]),Mt=Np(Be,0,Yt[1]),yt=Np(De,Yt[0],Yt[2]),Ft=Np(Be,Yt[1],Yt[3]),Bt=Yt[0]-Pt,vi=Yt[1]-Mt,fi=Yt[2]-Yt[0]-yt,Jt=Yt[3]-Yt[1]-Ft}const Xt=(Yt,ei,Kt,$t)=>{const Ci=jp(Yt.stretch-Pt,yt,me,o.left),Ti=Bp(Yt.fixed-Bt,fi,Yt.stretch,Ye),tr=jp(ei.stretch-Mt,Ft,Se,o.top),Fr=Bp(ei.fixed-vi,Jt,ei.stretch,ct),Vr=jp(Kt.stretch-Pt,yt,me,o.left),En=Bp(Kt.fixed-Bt,fi,Kt.stretch,Ye),so=jp($t.stretch-Mt,Ft,Se,o.top),Wn=Bp($t.fixed-vi,Jt,$t.stretch,ct),xn=new G(Ci,tr),Pn=new G(Vr,tr),Yn=new G(Vr,so),Jn=new G(Ci,so),ks=new G(Ti/B,Fr/B),bn=new G(En/B,Wn/B),qn=i*Math.PI/180;if(qn){const Ms=Math.sin(qn),As=Math.cos(qn),Xr=[As,-Ms,Ms,As];xn._matMult(Xr),Pn._matMult(Xr),Jn._matMult(Xr),Yn._matMult(Xr)}const es=Yt.stretch+Yt.fixed,bs=ei.stretch+ei.fixed;return{tl:xn,tr:Pn,bl:Jn,br:Yn,tex:{x:O.paddedRect.x+1+es,y:O.paddedRect.y+1+bs,w:Kt.stretch+Kt.fixed-es,h:$t.stretch+$t.fixed-bs},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ks,pixelOffsetBR:bn,minFontScaleX:fi/B/me,minFontScaleY:Jt/B/Se,isSDF:l}};if(p&&(O.stretchX||O.stretchY)){const Yt=B0(De,ot,Ye),ei=B0(Be,bt,ct);for(let Kt=0;Kt<Yt.length-1;Kt++){const $t=Yt[Kt],Ci=Yt[Kt+1];for(let Ti=0;Ti<ei.length-1;Ti++)E.push(Xt($t,ei[Ti],Ci,ei[Ti+1]))}}else E.push(Xt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:te+1},{fixed:0,stretch:se+1}));return E}function Np(o,i,l){let p=0;for(const E of o)p+=Math.max(i,Math.min(l,E[1]))-Math.max(i,Math.min(l,E[0]));return p}function B0(o,i,l){const p=[{fixed:-1,stretch:0}];for(const[E,O]of o){const B=p[p.length-1];p.push({fixed:E-B.stretch,stretch:B.stretch}),p.push({fixed:E-B.stretch,stretch:B.stretch+(O-E)})}return p.push({fixed:i+1,stretch:l}),p}function jp(o,i,l,p){return o/i*l+p}function Bp(o,i,l,p){return o-i*l/p}di("Anchor",Ja);class Fp{constructor(i,l,p,E,O,B,te,se,me,Se){if(this.boxStartIndex=i.length,me){let De=B.top,Be=B.bottom;const Ve=B.collisionPadding;Ve&&(De-=Ve[1],Be+=Ve[3]);let Ye=Be-De;Ye>0&&(Ye=Math.max(10,Ye),this.circleDiameter=Ye)}else{let De=B.top*te-se[0],Be=B.bottom*te+se[2],Ve=B.left*te-se[3],Ye=B.right*te+se[1];const ct=B.collisionPadding;if(ct&&(Ve-=ct[0]*te,De-=ct[1]*te,Ye+=ct[2]*te,Be+=ct[3]*te),Se){const ot=new G(Ve,De),bt=new G(Ye,De),Pt=new G(Ve,Be),yt=new G(Ye,Be),Mt=Se*Math.PI/180;ot._rotate(Mt),bt._rotate(Mt),Pt._rotate(Mt),yt._rotate(Mt),Ve=Math.min(ot.x,bt.x,Pt.x,yt.x),Ye=Math.max(ot.x,bt.x,Pt.x,yt.x),De=Math.min(ot.y,bt.y,Pt.y,yt.y),Be=Math.max(ot.y,bt.y,Pt.y,yt.y)}i.emplaceBack(l.x,l.y,Ve,De,Ye,Be,p,E,O)}this.boxEndIndex=i.length}}class KE{constructor(i=[],l=QE){if(this.data=i,this.length=this.data.length,this.compare=l,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:l,compare:p}=this,E=l[i];for(;i>0;){const O=i-1>>1,B=l[O];if(p(E,B)>=0)break;l[i]=B,i=O}l[i]=E}_down(i){const{data:l,compare:p}=this,E=this.length>>1,O=l[i];for(;i<E;){let B=1+(i<<1),te=l[B];const se=B+1;if(se<this.length&&p(l[se],te)<0&&(B=se,te=l[se]),p(te,O)>=0)break;l[i]=te,i=B}l[i]=O}}function QE(o,i){return o<i?-1:o>i?1:0}function JE(o,i=1,l=!1){let p=1/0,E=1/0,O=-1/0,B=-1/0;const te=o[0];for(let Ve=0;Ve<te.length;Ve++){const Ye=te[Ve];(!Ve||Ye.x<p)&&(p=Ye.x),(!Ve||Ye.y<E)&&(E=Ye.y),(!Ve||Ye.x>O)&&(O=Ye.x),(!Ve||Ye.y>B)&&(B=Ye.y)}const se=Math.min(O-p,B-E);let me=se/2;const Se=new KE([],e2);if(se===0)return new G(p,E);for(let Ve=p;Ve<O;Ve+=se)for(let Ye=E;Ye<B;Ye+=se)Se.push(new ph(Ve+me,Ye+me,me,o));let De=function(Ve){let Ye=0,ct=0,ot=0;const bt=Ve[0];for(let Pt=0,yt=bt.length,Mt=yt-1;Pt<yt;Mt=Pt++){const Ft=bt[Pt],Bt=bt[Mt],fi=Ft.x*Bt.y-Bt.x*Ft.y;ct+=(Ft.x+Bt.x)*fi,ot+=(Ft.y+Bt.y)*fi,Ye+=3*fi}return new ph(ct/Ye,ot/Ye,0,Ve)}(o),Be=Se.length;for(;Se.length;){const Ve=Se.pop();(Ve.d>De.d||!De.d)&&(De=Ve,l&&console.log("found best %d after %d probes",Math.round(1e4*Ve.d)/1e4,Be)),Ve.max-De.d<=i||(me=Ve.h/2,Se.push(new ph(Ve.p.x-me,Ve.p.y-me,me,o)),Se.push(new ph(Ve.p.x+me,Ve.p.y-me,me,o)),Se.push(new ph(Ve.p.x-me,Ve.p.y+me,me,o)),Se.push(new ph(Ve.p.x+me,Ve.p.y+me,me,o)),Be+=4)}return l&&(console.log(`num probes: ${Be}`),console.log(`best distance: ${De.d}`)),De.p}function e2(o,i){return i.max-o.max}function ph(o,i,l,p){this.p=new G(o,i),this.h=l,this.d=function(E,O){let B=!1,te=1/0;for(let se=0;se<O.length;se++){const me=O[se];for(let Se=0,De=me.length,Be=De-1;Se<De;Be=Se++){const Ve=me[Se],Ye=me[Be];Ve.y>E.y!=Ye.y>E.y&&E.x<(Ye.x-Ve.x)*(E.y-Ve.y)/(Ye.y-Ve.y)+Ve.x&&(B=!B),te=Math.min(te,Yx(E,Ve,Ye))}}return(B?1:-1)*Math.sqrt(te)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}const ag=Number.POSITIVE_INFINITY;function F0(o,i){return i[1]!==ag?function(l,p,E){let O=0,B=0;switch(p=Math.abs(p),E=Math.abs(E),l){case"top-right":case"top-left":case"top":B=E-7;break;case"bottom-right":case"bottom-left":case"bottom":B=7-E}switch(l){case"top-right":case"bottom-right":case"right":O=-p;break;case"top-left":case"bottom-left":case"left":O=p}return[O,B]}(o,i[0],i[1]):function(l,p){let E=0,O=0;p<0&&(p=0);const B=p/Math.sqrt(2);switch(l){case"top-right":case"top-left":O=B-7;break;case"bottom-right":case"bottom-left":O=7-B;break;case"bottom":O=7-p;break;case"top":O=p-7}switch(l){case"top-right":case"bottom-right":E=-B;break;case"top-left":case"bottom-left":E=B;break;case"left":E=p;break;case"right":E=-p}return[E,O]}(o,i[0])}function lg(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function t2(o,i,l,p,E,O,B,te,se,me,Se){let De=O.textMaxSize.evaluate(i,{});De===void 0&&(De=B);const Be=o.layers[0].layout,Ve=Be.get("icon-offset").evaluate(i,{},Se),Ye=$0(l.horizontal),ct=B/24,ot=o.tilePixelRatio*ct,bt=o.tilePixelRatio*De/24,Pt=o.tilePixelRatio*te,yt=o.tilePixelRatio*Be.get("symbol-spacing"),Mt=Be.get("text-padding")*o.tilePixelRatio,Ft=function($t,Ci,Ti,tr=1){const Fr=$t.get("icon-padding").evaluate(Ci,{},Ti),Vr=Fr&&Fr.values;return[Vr[0]*tr,Vr[1]*tr,Vr[2]*tr,Vr[3]*tr]}(Be,i,Se,o.tilePixelRatio),Bt=Be.get("text-max-angle")/180*Math.PI,fi=Be.get("text-rotation-alignment")!=="viewport"&&Be.get("symbol-placement")!=="point",vi=Be.get("icon-rotation-alignment")==="map"&&Be.get("symbol-placement")!=="point",Jt=Be.get("symbol-placement"),Xt=yt/2,Yt=Be.get("icon-text-fit");let ei;p&&Yt!=="none"&&(o.allowVerticalPlacement&&l.vertical&&(ei=P0(p,l.vertical,Yt,Be.get("icon-text-fit-padding"),Ve,ct)),Ye&&(p=P0(p,Ye,Yt,Be.get("icon-text-fit-padding"),Ve,ct)));const Kt=($t,Ci)=>{Ci.x<0||Ci.x>=Tn||Ci.y<0||Ci.y>=Tn||function(Ti,tr,Fr,Vr,En,so,Wn,xn,Pn,Yn,Jn,ks,bn,qn,es,bs,Ms,As,Xr,In,sr,Ws,Xn,ts,xo){const Mo=Ti.addToLineVertexArray(tr,Fr);let Ao,_a,bo,oo,Ps=0,wa=0,Vu=0,nb=0,xg=-1,bg=-1;const Ta={};let sb=yn.exports(""),vg=0,_g=0;if(xn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[vg,_g]=xn.layout.get("text-offset").evaluate(sr,{},ts).map(Is=>Is*jn):(vg=xn.layout.get("text-radial-offset").evaluate(sr,{},ts)*jn,_g=ag),Ti.allowVerticalPlacement&&Vr.vertical){const Is=xn.layout.get("text-rotate").evaluate(sr,{},ts)+90;bo=new Fp(Pn,tr,Yn,Jn,ks,Vr.vertical,bn,qn,es,Is),Wn&&(oo=new Fp(Pn,tr,Yn,Jn,ks,Wn,Ms,As,es,Is))}if(En){const Is=xn.layout.get("icon-rotate").evaluate(sr,{}),Vo=xn.layout.get("icon-text-fit")!=="none",Hu=j0(En,Is,Xn,Vo),Wu=Wn?j0(Wn,Is,Xn,Vo):void 0;_a=new Fp(Pn,tr,Yn,Jn,ks,En,Ms,As,!1,Is),Ps=4*Hu.length;const lb=Ti.iconSizeData;let ec=null;lb.kind==="source"?(ec=[va*xn.layout.get("icon-size").evaluate(sr,{})],ec[0]>el&&w(`${Ti.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):lb.kind==="composite"&&(ec=[va*Ws.compositeIconSizes[0].evaluate(sr,{},ts),va*Ws.compositeIconSizes[1].evaluate(sr,{},ts)],(ec[0]>el||ec[1]>el)&&w(`${Ti.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ti.addSymbols(Ti.icon,Hu,ec,In,Xr,sr,s.WritingMode.none,tr,Mo.lineStartIndex,Mo.lineLength,-1,ts),xg=Ti.icon.placedSymbolArray.length-1,Wu&&(wa=4*Wu.length,Ti.addSymbols(Ti.icon,Wu,ec,In,Xr,sr,s.WritingMode.vertical,tr,Mo.lineStartIndex,Mo.lineLength,-1,ts),bg=Ti.icon.placedSymbolArray.length-1)}const ob=Object.keys(Vr.horizontal);for(const Is of ob){const Vo=Vr.horizontal[Is];if(!Ao){sb=yn.exports(Vo.text);const Wu=xn.layout.get("text-rotate").evaluate(sr,{},ts);Ao=new Fp(Pn,tr,Yn,Jn,ks,Vo,bn,qn,es,Wu)}const Hu=Vo.positionedLines.length===1;if(Vu+=U0(Ti,tr,Vo,so,xn,es,sr,bs,Mo,Vr.vertical?s.WritingMode.horizontal:s.WritingMode.horizontalOnly,Hu?ob:[Is],Ta,xg,Ws,ts),Hu)break}Vr.vertical&&(nb+=U0(Ti,tr,Vr.vertical,so,xn,es,sr,bs,Mo,s.WritingMode.vertical,["vertical"],Ta,bg,Ws,ts));const f2=Ao?Ao.boxStartIndex:Ti.collisionBoxArray.length,m2=Ao?Ao.boxEndIndex:Ti.collisionBoxArray.length,g2=bo?bo.boxStartIndex:Ti.collisionBoxArray.length,y2=bo?bo.boxEndIndex:Ti.collisionBoxArray.length,x2=_a?_a.boxStartIndex:Ti.collisionBoxArray.length,b2=_a?_a.boxEndIndex:Ti.collisionBoxArray.length,v2=oo?oo.boxStartIndex:Ti.collisionBoxArray.length,_2=oo?oo.boxEndIndex:Ti.collisionBoxArray.length;let Po=-1;const Hp=(Is,Vo)=>Is&&Is.circleDiameter?Math.max(Is.circleDiameter,Vo):Vo;Po=Hp(Ao,Po),Po=Hp(bo,Po),Po=Hp(_a,Po),Po=Hp(oo,Po);const ab=Po>-1?1:0;ab&&(Po*=xo/jn),Ti.glyphOffsetArray.length>=fh.MAX_GLYPHS&&w("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),sr.sortKey!==void 0&&Ti.addToSortKeyRanges(Ti.symbolInstances.length,sr.sortKey),Ti.symbolInstances.emplaceBack(tr.x,tr.y,Ta.right>=0?Ta.right:-1,Ta.center>=0?Ta.center:-1,Ta.left>=0?Ta.left:-1,Ta.vertical||-1,xg,bg,sb,f2,m2,g2,y2,x2,b2,v2,_2,Yn,Vu,nb,Ps,wa,ab,0,bn,vg,_g,Po)}(o,Ci,$t,l,p,E,ei,o.layers[0],o.collisionBoxArray,i.index,i.sourceLayerIndex,o.index,ot,[Mt,Mt,Mt,Mt],fi,se,Pt,Ft,vi,Ve,i,O,me,Se,B)};if(Jt==="line")for(const $t of N0(i.geometry,0,0,Tn,Tn)){const Ci=ZE($t,yt,Bt,l.vertical||Ye,p,24,bt,o.overscaling,Tn);for(const Ti of Ci){const tr=Ye;tr&&i2(o,tr.text,Xt,Ti)||Kt($t,Ti)}}else if(Jt==="line-center"){for(const $t of i.geometry)if($t.length>1){const Ci=XE($t,Bt,l.vertical||Ye,p,24,bt);Ci&&Kt($t,Ci)}}else if(i.type==="Polygon")for(const $t of Xm(i.geometry,0)){const Ci=JE($t,16);Kt($t[0],new Ja(Ci.x,Ci.y,0))}else if(i.type==="LineString")for(const $t of i.geometry)Kt($t,new Ja($t[0].x,$t[0].y,0));else if(i.type==="Point")for(const $t of i.geometry)for(const Ci of $t)Kt([Ci],new Ja(Ci.x,Ci.y,0))}const el=32640;function U0(o,i,l,p,E,O,B,te,se,me,Se,De,Be,Ve,Ye){const ct=function(Pt,yt,Mt,Ft,Bt,fi,vi,Jt){const Xt=Ft.layout.get("text-rotate").evaluate(fi,{})*Math.PI/180,Yt=[];for(const ei of yt.positionedLines)for(const Kt of ei.positionedGlyphs){if(!Kt.rect)continue;const $t=Kt.rect||{};let Ci=4,Ti=!0,tr=1,Fr=0;const Vr=(Bt||Jt)&&Kt.vertical,En=Kt.metrics.advance*Kt.scale/2;if(Jt&&yt.verticalizable){const Xr=(Kt.scale-1)*jn,In=(jn-Kt.metrics.width*Kt.scale)/2;Fr=ei.lineOffset/2-(Kt.imageName?-In:Xr)}if(Kt.imageName){const Xr=vi[Kt.imageName];Ti=Xr.sdf,tr=Xr.pixelRatio,Ci=1/tr}const so=Bt?[Kt.x+En,Kt.y]:[0,0];let Wn=Bt?[0,0]:[Kt.x+En+Mt[0],Kt.y+Mt[1]-Fr],xn=[0,0];Vr&&(xn=Wn,Wn=[0,0]);const Pn=(Kt.metrics.left-Ci)*Kt.scale-En+Wn[0],Yn=(-Kt.metrics.top-Ci)*Kt.scale+Wn[1],Jn=Pn+$t.w*Kt.scale/tr,ks=Yn+$t.h*Kt.scale/tr,bn=new G(Pn,Yn),qn=new G(Jn,Yn),es=new G(Pn,ks),bs=new G(Jn,ks);if(Vr){const Xr=new G(-En,En-Rp),In=-Math.PI/2,sr=12-En,Ws=new G(22-sr,-(Kt.imageName?sr:0)),Xn=new G(...xn);bn._rotateAround(In,Xr)._add(Ws)._add(Xn),qn._rotateAround(In,Xr)._add(Ws)._add(Xn),es._rotateAround(In,Xr)._add(Ws)._add(Xn),bs._rotateAround(In,Xr)._add(Ws)._add(Xn)}if(Xt){const Xr=Math.sin(Xt),In=Math.cos(Xt),sr=[In,-Xr,Xr,In];bn._matMult(sr),qn._matMult(sr),es._matMult(sr),bs._matMult(sr)}const Ms=new G(0,0),As=new G(0,0);Yt.push({tl:bn,tr:qn,bl:es,br:bs,tex:$t,writingMode:yt.writingMode,glyphOffset:so,sectionIndex:Kt.sectionIndex,isSDF:Ti,pixelOffsetTL:Ms,pixelOffsetBR:As,minFontScaleX:0,minFontScaleY:0})}return Yt}(0,l,te,E,O,B,p,o.allowVerticalPlacement),ot=o.textSizeData;let bt=null;ot.kind==="source"?(bt=[va*E.layout.get("text-size").evaluate(B,{})],bt[0]>el&&w(`${o.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ot.kind==="composite"&&(bt=[va*Ve.compositeTextSizes[0].evaluate(B,{},Ye),va*Ve.compositeTextSizes[1].evaluate(B,{},Ye)],(bt[0]>el||bt[1]>el)&&w(`${o.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),o.addSymbols(o.text,ct,bt,te,O,B,me,i,se.lineStartIndex,se.lineLength,Be,Ye);for(const Pt of Se)De[Pt]=o.text.placedSymbolArray.length-1;return 4*ct.length}function $0(o){for(const i in o)return o[i];return null}function i2(o,i,l,p){const E=o.compareText;if(i in E){const O=E[i];for(let B=O.length-1;B>=0;B--)if(p.dist(O[B])<l)return!0}else E[i]=[];return E[i].push(p),!1}const r2=Ka.VectorTileFeature.types,n2=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Up(o,i,l,p,E,O,B,te,se,me,Se,De,Be){const Ve=te?Math.min(el,Math.round(te[0])):0,Ye=te?Math.min(el,Math.round(te[1])):0;o.emplaceBack(i,l,Math.round(32*p),Math.round(32*E),O,B,(Ve<<1)+(se?1:0),Ye,16*me,16*Se,256*De,256*Be)}function cg(o,i,l){o.emplaceBack(i.x,i.y,l),o.emplaceBack(i.x,i.y,l),o.emplaceBack(i.x,i.y,l),o.emplaceBack(i.x,i.y,l)}function s2(o){for(const i of o.sections)if(Om(i.text))return!0;return!1}class hg{constructor(i){this.layoutVertexArray=new Ss,this.indexArray=new Nn,this.programConfigurations=i,this.segments=new fr,this.dynamicLayoutVertexArray=new yo,this.opacityVertexArray=new Js,this.placedSymbolArray=new zt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,l,p,E){this.isEmpty()||(p&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ME.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,AE.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,n2,!0),this.opacityVertexBuffer.itemSize=1),(p||E)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}di("SymbolBuffers",hg);class ug{constructor(i,l,p){this.layoutVertexArray=new i,this.layoutAttributes=l,this.indexArray=new p,this.segments=new fr,this.collisionVertexArray=new ga}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,PE.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}di("CollisionBuffers",ug);class fh{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(B=>B.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Gm([]),this.placementViewportMatrix=Gm([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=I0(this.zoom,l["text-size"]),this.iconSizeData=I0(this.zoom,l["icon-size"]);const p=this.layers[0].layout,E=p.get("symbol-sort-key"),O=p.get("symbol-z-order");this.canOverlap=pg(p,"text-overlap","text-allow-overlap")!=="never"||pg(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=O!=="viewport-y"&&!E.isConstant(),this.sortFeaturesByY=(O==="viewport-y"||O==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(B=>s.WritingMode[B])),this.stateDependentLayerIds=this.layers.filter(B=>B.isStateDependent()).map(B=>B.id),this.sourceID=i.sourceID}createArrays(){this.text=new hg(new Xl(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new hg(new Xl(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new ni,this.lineVertexArray=new qt,this.symbolInstances=new Dt}calculateGlyphDependencies(i,l,p,E,O){for(let B=0;B<i.length;B++)if(l[i.charCodeAt(B)]=!0,(p||E)&&O){const te=Fu[i.charAt(B)];te&&(l[te.charCodeAt(0)]=!0)}}populate(i,l,p){const E=this.layers[0],O=E.layout,B=O.get("text-font"),te=O.get("text-field"),se=O.get("icon-image"),me=(te.value.kind!=="constant"||te.value.value instanceof lt&&!te.value.value.isEmpty()||te.value.value.toString().length>0)&&(B.value.kind!=="constant"||B.value.value.length>0),Se=se.value.kind!=="constant"||!!se.value.value||Object.keys(se.parameters).length>0,De=O.get("symbol-sort-key");if(this.features=[],!me&&!Se)return;const Be=l.iconDependencies,Ve=l.glyphDependencies,Ye=l.availableImages,ct=new $r(this.zoom);for(const{feature:ot,id:bt,index:Pt,sourceLayerIndex:yt}of i){const Mt=E._featureFilter.needGeometry,Ft=Kl(ot,Mt);if(!E._featureFilter.filter(ct,Ft,p))continue;let Bt,fi;if(Mt||(Ft.geometry=Zl(ot)),me){const Jt=E.getValueAndResolveTokens("text-field",Ft,p,Ye),Xt=lt.factory(Jt);s2(Xt)&&(this.hasRTLText=!0),(!this.hasRTLText||Su()==="unavailable"||this.hasRTLText&&Vs.isParsed())&&(Bt=DE(Xt,E,Ft))}if(Se){const Jt=E.getValueAndResolveTokens("icon-image",Ft,p,Ye);fi=Jt instanceof tt?Jt:tt.fromString(Jt)}if(!Bt&&!fi)continue;const vi=this.sortFeaturesByKey?De.evaluate(Ft,{},p):void 0;if(this.features.push({id:bt,text:Bt,icon:fi,index:Pt,sourceLayerIndex:yt,geometry:Ft.geometry,properties:ot.properties,type:r2[ot.type],sortKey:vi}),fi&&(Be[fi.name]=!0),Bt){const Jt=B.evaluate(Ft,{},p).join(","),Xt=O.get("text-rotation-alignment")!=="viewport"&&O.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(s.WritingMode.vertical)>=0;for(const Yt of Bt.sections)if(Yt.image)Be[Yt.image.name]=!0;else{const ei=_u(Bt.toString()),Kt=Yt.fontStack||Jt,$t=Ve[Kt]=Ve[Kt]||{};this.calculateGlyphDependencies(Yt.text,$t,Xt,this.allowVerticalPlacement,ei)}}}O.get("symbol-placement")==="line"&&(this.features=function(ot){const bt={},Pt={},yt=[];let Mt=0;function Ft(Jt){yt.push(ot[Jt]),Mt++}function Bt(Jt,Xt,Yt){const ei=Pt[Jt];return delete Pt[Jt],Pt[Xt]=ei,yt[ei].geometry[0].pop(),yt[ei].geometry[0]=yt[ei].geometry[0].concat(Yt[0]),ei}function fi(Jt,Xt,Yt){const ei=bt[Xt];return delete bt[Xt],bt[Jt]=ei,yt[ei].geometry[0].shift(),yt[ei].geometry[0]=Yt[0].concat(yt[ei].geometry[0]),ei}function vi(Jt,Xt,Yt){const ei=Yt?Xt[0][Xt[0].length-1]:Xt[0][0];return`${Jt}:${ei.x}:${ei.y}`}for(let Jt=0;Jt<ot.length;Jt++){const Xt=ot[Jt],Yt=Xt.geometry,ei=Xt.text?Xt.text.toString():null;if(!ei){Ft(Jt);continue}const Kt=vi(ei,Yt),$t=vi(ei,Yt,!0);if(Kt in Pt&&$t in bt&&Pt[Kt]!==bt[$t]){const Ci=fi(Kt,$t,Yt),Ti=Bt(Kt,$t,yt[Ci].geometry);delete bt[Kt],delete Pt[$t],Pt[vi(ei,yt[Ti].geometry,!0)]=Ti,yt[Ci].geometry=null}else Kt in Pt?Bt(Kt,$t,Yt):$t in bt?fi(Kt,$t,Yt):(Ft(Jt),bt[Kt]=Mt-1,Pt[$t]=Mt-1)}return yt.filter(Jt=>Jt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ot,bt)=>ot.sortKey-bt.sortKey)}update(i,l,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,l,this.layers,p),this.icon.programConfigurations.updatePaintArrays(i,l,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,l){const p=this.lineVertexArray.length;if(i.segment!==void 0){let E=i.dist(l[i.segment+1]),O=i.dist(l[i.segment]);const B={};for(let te=i.segment+1;te<l.length;te++)B[te]={x:l[te].x,y:l[te].y,tileUnitDistanceFromAnchor:E},te<l.length-1&&(E+=l[te+1].dist(l[te]));for(let te=i.segment||0;te>=0;te--)B[te]={x:l[te].x,y:l[te].y,tileUnitDistanceFromAnchor:O},te>0&&(O+=l[te-1].dist(l[te]));for(let te=0;te<l.length;te++){const se=B[te];this.lineVertexArray.emplaceBack(se.x,se.y,se.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(i,l,p,E,O,B,te,se,me,Se,De,Be){const Ve=i.indexArray,Ye=i.layoutVertexArray,ct=i.segments.prepareSegment(4*l.length,Ye,Ve,this.canOverlap?B.sortKey:void 0),ot=this.glyphOffsetArray.length,bt=ct.vertexLength,Pt=this.allowVerticalPlacement&&te===s.WritingMode.vertical?Math.PI/2:0,yt=B.text&&B.text.sections;for(let Mt=0;Mt<l.length;Mt++){const{tl:Ft,tr:Bt,bl:fi,br:vi,tex:Jt,pixelOffsetTL:Xt,pixelOffsetBR:Yt,minFontScaleX:ei,minFontScaleY:Kt,glyphOffset:$t,isSDF:Ci,sectionIndex:Ti}=l[Mt],tr=ct.vertexLength,Fr=$t[1];Up(Ye,se.x,se.y,Ft.x,Fr+Ft.y,Jt.x,Jt.y,p,Ci,Xt.x,Xt.y,ei,Kt),Up(Ye,se.x,se.y,Bt.x,Fr+Bt.y,Jt.x+Jt.w,Jt.y,p,Ci,Yt.x,Xt.y,ei,Kt),Up(Ye,se.x,se.y,fi.x,Fr+fi.y,Jt.x,Jt.y+Jt.h,p,Ci,Xt.x,Yt.y,ei,Kt),Up(Ye,se.x,se.y,vi.x,Fr+vi.y,Jt.x+Jt.w,Jt.y+Jt.h,p,Ci,Yt.x,Yt.y,ei,Kt),cg(i.dynamicLayoutVertexArray,se,Pt),Ve.emplaceBack(tr,tr+1,tr+2),Ve.emplaceBack(tr+1,tr+2,tr+3),ct.vertexLength+=4,ct.primitiveLength+=2,this.glyphOffsetArray.emplaceBack($t[0]),Mt!==l.length-1&&Ti===l[Mt+1].sectionIndex||i.programConfigurations.populatePaintArrays(Ye.length,B,B.index,{},Be,yt&&yt[Ti])}i.placedSymbolArray.emplaceBack(se.x,se.y,ot,this.glyphOffsetArray.length-ot,bt,me,Se,se.segment,p?p[0]:0,p?p[1]:0,E[0],E[1],te,0,!1,0,De)}_addCollisionDebugVertex(i,l,p,E,O,B){return l.emplaceBack(0,0),i.emplaceBack(p.x,p.y,E,O,Math.round(B.x),Math.round(B.y))}addCollisionDebugVertices(i,l,p,E,O,B,te){const se=O.segments.prepareSegment(4,O.layoutVertexArray,O.indexArray),me=se.vertexLength,Se=O.layoutVertexArray,De=O.collisionVertexArray,Be=te.anchorX,Ve=te.anchorY;this._addCollisionDebugVertex(Se,De,B,Be,Ve,new G(i,l)),this._addCollisionDebugVertex(Se,De,B,Be,Ve,new G(p,l)),this._addCollisionDebugVertex(Se,De,B,Be,Ve,new G(p,E)),this._addCollisionDebugVertex(Se,De,B,Be,Ve,new G(i,E)),se.vertexLength+=4;const Ye=O.indexArray;Ye.emplaceBack(me,me+1),Ye.emplaceBack(me+1,me+2),Ye.emplaceBack(me+2,me+3),Ye.emplaceBack(me+3,me),se.primitiveLength+=4}addDebugCollisionBoxes(i,l,p,E){for(let O=i;O<l;O++){const B=this.collisionBoxArray.get(O);this.addCollisionDebugVertices(B.x1,B.y1,B.x2,B.y2,E?this.textCollisionBox:this.iconCollisionBox,B.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ug(eo,y0.members,to),this.iconCollisionBox=new ug(eo,y0.members,to);for(let i=0;i<this.symbolInstances.length;i++){const l=this.symbolInstances.get(i);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(i,l,p,E,O,B,te,se,me){const Se={};for(let De=l;De<p;De++){const Be=i.get(De);Se.textBox={x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,anchorPointX:Be.anchorPointX,anchorPointY:Be.anchorPointY},Se.textFeatureIndex=Be.featureIndex;break}for(let De=E;De<O;De++){const Be=i.get(De);Se.verticalTextBox={x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,anchorPointX:Be.anchorPointX,anchorPointY:Be.anchorPointY},Se.verticalTextFeatureIndex=Be.featureIndex;break}for(let De=B;De<te;De++){const Be=i.get(De);Se.iconBox={x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,anchorPointX:Be.anchorPointX,anchorPointY:Be.anchorPointY},Se.iconFeatureIndex=Be.featureIndex;break}for(let De=se;De<me;De++){const Be=i.get(De);Se.verticalIconBox={x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,anchorPointX:Be.anchorPointX,anchorPointY:Be.anchorPointY},Se.verticalIconFeatureIndex=Be.featureIndex;break}return Se}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const p=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,l){const p=i.placedSymbolArray.get(l),E=p.vertexStartIndex+4*p.numGlyphs;for(let O=p.vertexStartIndex;O<E;O+=4)i.indexArray.emplaceBack(O,O+1,O+2),i.indexArray.emplaceBack(O+1,O+2,O+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(i),p=Math.cos(i),E=[],O=[],B=[];for(let te=0;te<this.symbolInstances.length;++te){B.push(te);const se=this.symbolInstances.get(te);E.push(0|Math.round(l*se.anchorX+p*se.anchorY)),O.push(se.featureIndex)}return B.sort((te,se)=>E[te]-E[se]||O[se]-O[te]),B}addToSortKeyRanges(i,l){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===l?p.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const p=this.symbolInstances.get(l);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((E,O,B)=>{E>=0&&B.indexOf(E)===O&&this.addIndicesForPlacedSymbol(this.text,E)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}di("SymbolBucket",fh,{omit:["layers","collisionBoxArray","features","compareText"]}),fh.MAX_GLYPHS=65535,fh.addDynamicAttributes=cg;const o2=new wn({"symbol-placement":new wi(Re.layout_symbol["symbol-placement"]),"symbol-spacing":new wi(Re.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wi(Re.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Mi(Re.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wi(Re.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new wi(Re.layout_symbol["icon-allow-overlap"]),"icon-overlap":new wi(Re.layout_symbol["icon-overlap"]),"icon-ignore-placement":new wi(Re.layout_symbol["icon-ignore-placement"]),"icon-optional":new wi(Re.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wi(Re.layout_symbol["icon-rotation-alignment"]),"icon-size":new Mi(Re.layout_symbol["icon-size"]),"icon-text-fit":new wi(Re.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wi(Re.layout_symbol["icon-text-fit-padding"]),"icon-image":new Mi(Re.layout_symbol["icon-image"]),"icon-rotate":new Mi(Re.layout_symbol["icon-rotate"]),"icon-padding":new Mi(Re.layout_symbol["icon-padding"]),"icon-keep-upright":new wi(Re.layout_symbol["icon-keep-upright"]),"icon-offset":new Mi(Re.layout_symbol["icon-offset"]),"icon-anchor":new Mi(Re.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wi(Re.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wi(Re.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wi(Re.layout_symbol["text-rotation-alignment"]),"text-field":new Mi(Re.layout_symbol["text-field"]),"text-font":new Mi(Re.layout_symbol["text-font"]),"text-size":new Mi(Re.layout_symbol["text-size"]),"text-max-width":new Mi(Re.layout_symbol["text-max-width"]),"text-line-height":new wi(Re.layout_symbol["text-line-height"]),"text-letter-spacing":new Mi(Re.layout_symbol["text-letter-spacing"]),"text-justify":new Mi(Re.layout_symbol["text-justify"]),"text-radial-offset":new Mi(Re.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wi(Re.layout_symbol["text-variable-anchor"]),"text-anchor":new Mi(Re.layout_symbol["text-anchor"]),"text-max-angle":new wi(Re.layout_symbol["text-max-angle"]),"text-writing-mode":new wi(Re.layout_symbol["text-writing-mode"]),"text-rotate":new Mi(Re.layout_symbol["text-rotate"]),"text-padding":new wi(Re.layout_symbol["text-padding"]),"text-keep-upright":new wi(Re.layout_symbol["text-keep-upright"]),"text-transform":new Mi(Re.layout_symbol["text-transform"]),"text-offset":new Mi(Re.layout_symbol["text-offset"]),"text-allow-overlap":new wi(Re.layout_symbol["text-allow-overlap"]),"text-overlap":new wi(Re.layout_symbol["text-overlap"]),"text-ignore-placement":new wi(Re.layout_symbol["text-ignore-placement"]),"text-optional":new wi(Re.layout_symbol["text-optional"])});var dg={paint:new wn({"icon-opacity":new Mi(Re.paint_symbol["icon-opacity"]),"icon-color":new Mi(Re.paint_symbol["icon-color"]),"icon-halo-color":new Mi(Re.paint_symbol["icon-halo-color"]),"icon-halo-width":new Mi(Re.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Mi(Re.paint_symbol["icon-halo-blur"]),"icon-translate":new wi(Re.paint_symbol["icon-translate"]),"icon-translate-anchor":new wi(Re.paint_symbol["icon-translate-anchor"]),"text-opacity":new Mi(Re.paint_symbol["text-opacity"]),"text-color":new Mi(Re.paint_symbol["text-color"],{runtimeType:ri,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new Mi(Re.paint_symbol["text-halo-color"]),"text-halo-width":new Mi(Re.paint_symbol["text-halo-width"]),"text-halo-blur":new Mi(Re.paint_symbol["text-halo-blur"]),"text-translate":new wi(Re.paint_symbol["text-translate"]),"text-translate-anchor":new wi(Re.paint_symbol["text-translate-anchor"])}),layout:o2};class G0{constructor(i){if(i.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:Rt,this.defaultValue=i}evaluate(i){if(i.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(i.formattedSection))return l.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}di("FormatSectionOverride",G0,{omit:["defaultValue"]});class $p extends ms{constructor(i){super(i,dg)}recalculate(i,l){if(super.recalculate(i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const E=[];for(const O of p)E.indexOf(O)<0&&E.push(O);this.layout._values["text-writing-mode"]=E}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,l,p,E){const O=this.layout.get(i).evaluate(l,{},p,E),B=this._unevaluatedLayout._values[i];return B.isDataDriven()||Ll(B.value)||!O?O:function(te,se){return se.replace(/{([^{}]+)}/g,(me,Se)=>Se in te?String(te[Se]):"")}(l.properties,O)}createBucket(i){return new fh(i)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const i of dg.paint.overridableProperties){if(!$p.hasPaintOverride(this.layout,i))continue;const l=this.paint.get(i),p=new G0(l),E=new mu(p,l.property.specification);let O=null;O=l.value.kind==="constant"||l.value.kind==="source"?new Uc("source",E):new Ol("composite",E,l.value.zoomStops),this.paint._values[i]=new go(l.property,O,l.parameters)}}_handleOverridablePaintPropertyUpdate(i,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&$p.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,l){const p=i.get("text-field"),E=dg.paint.properties[l];let O=!1;const B=te=>{for(const se of te)if(E.overrides&&E.overrides.hasOverride(se))return void(O=!0)};if(p.value.kind==="constant"&&p.value.value instanceof lt)B(p.value.value.sections);else if(p.value.kind==="source"){const te=me=>{O||(me instanceof si&&Lt(me.value)===Vi?B(me.value.sections):me instanceof Fc?B(me.sections):me.eachChild(te))},se=p.value;se._styleExpression&&te(se._styleExpression.expression)}return O}}function pg(o,i,l){let p="never";const E=o.get(i);return E?p=E:o.get(l)&&(p="always"),p}var a2={paint:new wn({"background-color":new wi(Re.paint_background["background-color"]),"background-pattern":new Hl(Re.paint_background["background-pattern"]),"background-opacity":new wi(Re.paint_background["background-opacity"])})},l2={paint:new wn({"raster-opacity":new wi(Re.paint_raster["raster-opacity"]),"raster-hue-rotate":new wi(Re.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wi(Re.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wi(Re.paint_raster["raster-brightness-max"]),"raster-saturation":new wi(Re.paint_raster["raster-saturation"]),"raster-contrast":new wi(Re.paint_raster["raster-contrast"]),"raster-resampling":new wi(Re.paint_raster["raster-resampling"]),"raster-fade-duration":new wi(Re.paint_raster["raster-fade-duration"])})};class c2 extends ms{constructor(i){super(i,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const h2={circle:class extends ms{constructor(o){super(o,$T)}createBucket(o){return new Fm(o)}queryRadius(o){const i=o;return Iu("circle-radius",this,i)+Iu("circle-stroke-width",this,i)+Cp(this.paint.get("circle-translate"))}queryIntersectsFeature(o,i,l,p,E,O,B,te){const se=Sp(o,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),O.angle,B),me=this.paint.get("circle-radius").evaluate(i,l)+this.paint.get("circle-stroke-width").evaluate(i,l),Se=this.paint.get("circle-pitch-alignment")==="map",De=Se?se:function(Ve,Ye){return Ve.map(ct=>e0(ct,Ye))}(se,te),Be=Se?me*B:me;for(const Ve of p)for(const Ye of Ve){const ct=Se?Ye:e0(Ye,te);let ot=Be;const bt=kp([],[Ye.x,Ye.y,0,1],te);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ot*=bt[3]/O.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ot*=O.cameraToCenterDistance/bt[3]),NT(De,ct,ot))return!0}return!1}},heatmap:class extends ms{constructor(o){super(o,VT),this._updateColorRamp()}createBucket(o){return new t0(o)}_handleSpecialPaintPropertyUpdate(o){o==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=r0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends ms{constructor(o){super(o,HT)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends ms{constructor(o){super(o,oE)}recalculate(o,i){super.recalculate(o,i);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(o){return new Qm(o)}queryRadius(){return Cp(this.paint.get("fill-translate"))}queryIntersectsFeature(o,i,l,p,E,O,B){return Wx(Sp(o,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),O.angle,B),p)}isTileClipped(){return!0}},"fill-extrusion":class extends ms{constructor(o){super(o,vE)}createBucket(o){return new eg(o)}queryRadius(){return Cp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(o,i,l,p,E,O,B,te){const se=Sp(o,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),O.angle,B),me=this.paint.get("fill-extrusion-height").evaluate(i,l),Se=this.paint.get("fill-extrusion-base").evaluate(i,l),De=function(Ve,Ye,ct,ot){const bt=[];for(const Pt of Ve){const yt=[Pt.x,Pt.y,0,1];kp(yt,yt,Ye),bt.push(new G(yt[0]/yt[3],yt[1]/yt[3]))}return bt}(se,te),Be=function(Ve,Ye,ct,ot){const bt=[],Pt=[],yt=ot[8]*Ye,Mt=ot[9]*Ye,Ft=ot[10]*Ye,Bt=ot[11]*Ye,fi=ot[8]*ct,vi=ot[9]*ct,Jt=ot[10]*ct,Xt=ot[11]*ct;for(const Yt of Ve){const ei=[],Kt=[];for(const $t of Yt){const Ci=$t.x,Ti=$t.y,tr=ot[0]*Ci+ot[4]*Ti+ot[12],Fr=ot[1]*Ci+ot[5]*Ti+ot[13],Vr=ot[2]*Ci+ot[6]*Ti+ot[14],En=ot[3]*Ci+ot[7]*Ti+ot[15],so=Vr+Ft,Wn=En+Bt,xn=tr+fi,Pn=Fr+vi,Yn=Vr+Jt,Jn=En+Xt,ks=new G((tr+yt)/Wn,(Fr+Mt)/Wn);ks.z=so/Wn,ei.push(ks);const bn=new G(xn/Jn,Pn/Jn);bn.z=Yn/Jn,Kt.push(bn)}bt.push(ei),Pt.push(Kt)}return[bt,Pt]}(p,Se,me,te);return function(Ve,Ye,ct){let ot=1/0;Wx(ct,Ye)&&(ot=d0(ct,Ye[0]));for(let bt=0;bt<Ye.length;bt++){const Pt=Ye[bt],yt=Ve[bt];for(let Mt=0;Mt<Pt.length-1;Mt++){const Ft=Pt[Mt],Bt=[Ft,Pt[Mt+1],yt[Mt+1],yt[Mt],Ft];Hx(ct,Bt)&&(ot=Math.min(ot,d0(ct,Bt)))}}return ot!==1/0&&ot}(Be[0],Be[1],De)}},line:class extends ms{constructor(o){super(o,f0),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(o){o==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Al,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(o,i){super.recalculate(o,i),this.paint._values["line-floorwidth"]=m0.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,o)}createBucket(o){return new tg(o)}queryRadius(o){const i=o,l=g0(Iu("line-width",this,i),Iu("line-gap-width",this,i)),p=Iu("line-offset",this,i);return l/2+Math.abs(p)+Cp(this.paint.get("line-translate"))}queryIntersectsFeature(o,i,l,p,E,O,B){const te=Sp(o,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),O.angle,B),se=B/2*g0(this.paint.get("line-width").evaluate(i,l),this.paint.get("line-gap-width").evaluate(i,l)),me=this.paint.get("line-offset").evaluate(i,l);return me&&(p=function(Se,De){const Be=[];for(let Ve=0;Ve<Se.length;Ve++){const Ye=Se[Ve],ct=[];for(let ot=0;ot<Ye.length;ot++){const bt=Ye[ot-1],Pt=Ye[ot],yt=Ye[ot+1],Mt=ot===0?new G(0,0):Pt.sub(bt)._unit()._perp(),Ft=ot===Ye.length-1?new G(0,0):yt.sub(Pt)._unit()._perp(),Bt=Mt._add(Ft)._unit(),fi=Bt.x*Ft.x+Bt.y*Ft.y;fi!==0&&Bt._mult(1/fi),ct.push(Bt._mult(De)._add(Pt))}Be.push(ct)}return Be}(p,me*B)),function(Se,De,Be){for(let Ve=0;Ve<De.length;Ve++){const Ye=De[Ve];if(Se.length>=3){for(let ct=0;ct<Ye.length;ct++)if(ah(Se,Ye[ct]))return!0}if(jT(Se,Ye,Be))return!0}return!1}(te,p,se)}isTileClipped(){return!0}},symbol:$p,background:class extends ms{constructor(o){super(o,a2)}},raster:class extends ms{constructor(o){super(o,l2)}}};class u2{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const V0=63710088e-1;class rn{constructor(i,l){if(isNaN(i)||isNaN(l))throw new Error(`Invalid LngLat object: (${i}, ${l})`);if(this.lng=+i,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new rn(P(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const l=Math.PI/180,p=this.lat*l,E=i.lat*l,O=Math.sin(p)*Math.sin(E)+Math.cos(p)*Math.cos(E)*Math.cos((i.lng-this.lng)*l);return V0*Math.acos(Math.min(O,1))}toBounds(i=0){const l=360*i/40075017,p=l/Math.cos(Math.PI/180*this.lat);return new Jl(new rn(this.lng-p,this.lat-l),new rn(this.lng+p,this.lat+l))}static convert(i){if(i instanceof rn)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new rn(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new rn(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Jl{constructor(i,l){i&&(l?this.setSouthWest(i).setNorthEast(l):i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof rn?new rn(i.lng,i.lat):rn.convert(i),this}setSouthWest(i){return this._sw=i instanceof rn?new rn(i.lng,i.lat):rn.convert(i),this}extend(i){const l=this._sw,p=this._ne;let E,O;if(i instanceof rn)E=i,O=i;else{if(!(i instanceof Jl))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(Jl.convert(i)):this.extend(rn.convert(i)):this;if(E=i._sw,O=i._ne,!E||!O)return this}return l||p?(l.lng=Math.min(E.lng,l.lng),l.lat=Math.min(E.lat,l.lat),p.lng=Math.max(O.lng,p.lng),p.lat=Math.max(O.lat,p.lat)):(this._sw=new rn(E.lng,E.lat),this._ne=new rn(O.lng,O.lat)),this}getCenter(){return new rn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new rn(this.getWest(),this.getNorth())}getSouthEast(){return new rn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:l,lat:p}=rn.convert(i);let E=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(E=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&E}static convert(i){return i instanceof Jl?i:i&&new Jl(i)}}const H0=2*Math.PI*V0;function W0(o){return H0*Math.cos(o*Math.PI/180)}function Y0(o){return(180+o)/360}function q0(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function X0(o,i){return o/W0(i)}function fg(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}class Gp{constructor(i,l,p=0){this.x=+i,this.y=+l,this.z=+p}static fromLngLat(i,l=0){const p=rn.convert(i);return new Gp(Y0(p.lng),q0(p.lat),X0(l,p.lat))}toLngLat(){return new rn(360*this.x-180,fg(this.y))}toAltitude(){return this.z*W0(fg(this.y))}meterInMercatorCoordinateUnits(){return 1/H0*(i=fg(this.y),1/Math.cos(i*Math.PI/180));var i}}function Z0(o,i,l){var p=2*Math.PI*6378137/256/Math.pow(2,l);return[o*p-2*Math.PI*6378137/2,i*p-2*Math.PI*6378137/2]}class mg{constructor(i,l,p){if(i<0||i>25||p<0||p>=Math.pow(2,i)||l<0||l>=Math.pow(2,i))throw new Error(`x=${l}, y=${p}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);this.z=i,this.x=l,this.y=p,this.key=$u(0,i,i,l,p)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,l,p){const E=(B=this.y,te=this.z,se=Z0(256*(O=this.x),256*(B=Math.pow(2,te)-B-1),te),me=Z0(256*(O+1),256*(B+1),te),se[0]+","+se[1]+","+me[0]+","+me[1]);var O,B,te,se,me;const Se=function(De,Be,Ve){let Ye,ct="";for(let ot=De;ot>0;ot--)Ye=1<<ot-1,ct+=(Be&Ye?1:0)+(Ve&Ye?2:0);return ct}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,Se).replace(/{bbox-epsg-3857}/g,E)}isChildOf(i){const l=this.z-i.z;return l>0&&i.x===this.x>>l&&i.y===this.y>>l}getTilePoint(i){const l=Math.pow(2,this.z);return new G((i.x*l-this.x)*Tn,(i.y*l-this.y)*Tn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class K0{constructor(i,l){this.wrap=i,this.canonical=l,this.key=$u(i,l.z,l.z,l.x,l.y)}}class no{constructor(i,l,p,E,O){if(i<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${p}`);this.overscaledZ=i,this.wrap=l,this.canonical=new mg(p,+E,+O),this.key=$u(l,i,p,E,O)}clone(){return new no(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-i;return i>this.canonical.z?new no(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new no(i,this.wrap,i,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(i,l){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-i;return i>this.canonical.z?$u(this.wrap*+l,i,this.canonical.z,this.canonical.x,this.canonical.y):$u(this.wrap*+l,i,i,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(i){if(i.wrap!==this.wrap)return!1;const l=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>l&&i.canonical.y===this.canonical.y>>l}children(i){if(this.overscaledZ>=i)return[new no(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,p=2*this.canonical.x,E=2*this.canonical.y;return[new no(l,this.wrap,l,p,E),new no(l,this.wrap,l,p+1,E),new no(l,this.wrap,l,p,E+1),new no(l,this.wrap,l,p+1,E+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new no(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new no(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new K0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new Gp(i.x-this.wrap,i.y))}}function $u(o,i,l,p,E){(o*=2)<0&&(o=-1*o-1);const O=1<<l;return(O*O*o+O*E+p).toString(36)+l.toString(36)+i.toString(36)}di("CanonicalTileID",mg),di("OverscaledTileID",no,{omit:["posMatrix"]});class Q0{constructor(i,l,p){if(this.uid=i,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(p&&p!=="mapbox"&&p!=="terrarium")return void w(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const E=this.dim=l.height-2;this.data=new Uint32Array(l.data.buffer),this.encoding=p||"mapbox";for(let O=0;O<E;O++)this.data[this._idx(-1,O)]=this.data[this._idx(0,O)],this.data[this._idx(E,O)]=this.data[this._idx(E-1,O)],this.data[this._idx(O,-1)]=this.data[this._idx(O,0)],this.data[this._idx(O,E)]=this.data[this._idx(O,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let O=0;O<E;O++)for(let B=0;B<E;B++){const te=this.get(O,B);te>this.max&&(this.max=te),te<this.min&&(this.min=te)}}get(i,l){const p=new Uint8Array(this.data.buffer),E=4*this._idx(i,l);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(p[E],p[E+1],p[E+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(i,l){if(i<-1||i>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(i+1)}_unpackMapbox(i,l,p){return(256*i*256+256*l+p)/10-1e4}_unpackTerrarium(i,l,p){return 256*i+l+p/256-32768}getPixels(){return new ro({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,l,p){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let E=l*this.dim,O=l*this.dim+this.dim,B=p*this.dim,te=p*this.dim+this.dim;switch(l){case-1:E=O-1;break;case 1:O=E+1}switch(p){case-1:B=te-1;break;case 1:te=B+1}const se=-l*this.dim,me=-p*this.dim;for(let Se=B;Se<te;Se++)for(let De=E;De<O;De++)this.data[this._idx(De,Se)]=i.data[this._idx(De+se,Se+me)]}}di("DEMData",Q0);class J0{constructor(i){this._stringToNumber={},this._numberToString=[];for(let l=0;l<i.length;l++){const p=i[l];this._stringToNumber[p]=l,this._numberToString[l]=p}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class eb{constructor(i,l,p,E,O){this.type="Feature",this._vectorTileFeature=i,i._z=l,i._x=p,i._y=E,this.properties=i.properties,this.id=O}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(i[l]=this[l]);return i}}class tb{constructor(i,l){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new pa(Tn,16,0),this.grid3D=new pa(Tn,16,0),this.featureIndexArray=new Hi,this.promoteId=l}insert(i,l,p,E,O,B){const te=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,E,O);const se=B?this.grid3D:this.grid;for(let me=0;me<l.length;me++){const Se=l[me],De=[1/0,1/0,-1/0,-1/0];for(let Be=0;Be<Se.length;Be++){const Ve=Se[Be];De[0]=Math.min(De[0],Ve.x),De[1]=Math.min(De[1],Ve.y),De[2]=Math.max(De[2],Ve.x),De[3]=Math.max(De[3],Ve.y)}De[0]<Tn&&De[1]<Tn&&De[2]>=0&&De[3]>=0&&se.insert(te,De[0],De[1],De[2],De[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ka.VectorTile(new ig(this.rawTileData)).layers,this.sourceLayerCoder=new J0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,l,p,E){this.loadVTLayers();const O=i.params||{},B=Tn/i.tileSize/i.scale,te=yu(O.filter),se=i.queryGeometry,me=i.queryPadding*B,Se=rb(se),De=this.grid.query(Se.minX-me,Se.minY-me,Se.maxX+me,Se.maxY+me),Be=rb(i.cameraQueryGeometry),Ve=this.grid3D.query(Be.minX-me,Be.minY-me,Be.maxX+me,Be.maxY+me,(ot,bt,Pt,yt)=>function(Mt,Ft,Bt,fi,vi){for(const Xt of Mt)if(Ft<=Xt.x&&Bt<=Xt.y&&fi>=Xt.x&&vi>=Xt.y)return!0;const Jt=[new G(Ft,Bt),new G(Ft,vi),new G(fi,vi),new G(fi,Bt)];if(Mt.length>2){for(const Xt of Jt)if(ah(Mt,Xt))return!0}for(let Xt=0;Xt<Mt.length-1;Xt++)if(FT(Mt[Xt],Mt[Xt+1],Jt))return!0;return!1}(i.cameraQueryGeometry,ot-me,bt-me,Pt+me,yt+me));for(const ot of Ve)De.push(ot);De.sort(d2);const Ye={};let ct;for(let ot=0;ot<De.length;ot++){const bt=De[ot];if(bt===ct)continue;ct=bt;const Pt=this.featureIndexArray.get(bt);let yt=null;this.loadMatchingFeature(Ye,Pt.bucketIndex,Pt.sourceLayerIndex,Pt.featureIndex,te,O.layers,O.availableImages,l,p,E,(Mt,Ft,Bt)=>(yt||(yt=Zl(Mt)),Ft.queryIntersectsFeature(se,Mt,Bt,yt,this.z,i.transform,B,i.pixelPosMatrix)))}return Ye}loadMatchingFeature(i,l,p,E,O,B,te,se,me,Se,De){const Be=this.bucketLayerIDs[l];if(B&&!function(ot,bt){for(let Pt=0;Pt<ot.length;Pt++)if(bt.indexOf(ot[Pt])>=0)return!0;return!1}(B,Be))return;const Ve=this.sourceLayerCoder.decode(p),Ye=this.vtLayers[Ve].feature(E);if(O.needGeometry){const ot=Kl(Ye,!0);if(!O.filter(new $r(this.tileID.overscaledZ),ot,this.tileID.canonical))return}else if(!O.filter(new $r(this.tileID.overscaledZ),Ye))return;const ct=this.getId(Ye,Ve);for(let ot=0;ot<Be.length;ot++){const bt=Be[ot];if(B&&B.indexOf(bt)<0)continue;const Pt=se[bt];if(!Pt)continue;let yt={};ct&&Se&&(yt=Se.getState(Pt.sourceLayer||"_geojsonTileLayer",ct));const Mt=_({},me[bt]);Mt.paint=ib(Mt.paint,Pt.paint,Ye,yt,te),Mt.layout=ib(Mt.layout,Pt.layout,Ye,yt,te);const Ft=!De||De(Ye,Pt,yt);if(!Ft)continue;const Bt=new eb(Ye,this.z,this.x,this.y,ct);Bt.layer=Mt;let fi=i[bt];fi===void 0&&(fi=i[bt]=[]),fi.push({featureIndex:E,feature:Bt,intersectionZ:Ft})}}lookupSymbolFeatures(i,l,p,E,O,B,te,se){const me={};this.loadVTLayers();const Se=yu(O);for(const De of i)this.loadMatchingFeature(me,p,E,De,Se,B,te,se,l);return me}hasLayer(i){for(const l of this.bucketLayerIDs)for(const p of l)if(i===p)return!0;return!1}getId(i,l){let p=i.id;return this.promoteId&&(p=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof p=="boolean"&&(p=Number(p))),p}}function ib(o,i,l,p,E){return A(o,(O,B)=>{const te=i instanceof eh?i.get(B):null;return te&&te.evaluate?te.evaluate(l,p,E):te})}function rb(o){let i=1/0,l=1/0,p=-1/0,E=-1/0;for(const O of o)i=Math.min(i,O.x),l=Math.min(l,O.y),p=Math.max(p,O.x),E=Math.max(E,O.y);return{minX:i,minY:l,maxX:p,maxY:E}}function d2(o,i){return i-o}var gg;di("FeatureIndex",tb,{omit:["rawTileData","sourceLayerCoder"]}),s.PerformanceMarkers=void 0,(gg=s.PerformanceMarkers||(s.PerformanceMarkers={})).create="create",gg.load="load",gg.fullLoad="fullLoad";let Vp=null,Gu=[];const yg=1e3/30,p2={mark(o){performance.mark(o)},frame(o){const i=o;Vp!=null&&Gu.push(i-Vp),Vp=i},clearMetrics(){Vp=null,Gu=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const o in s.PerformanceMarkers)performance.clearMarks(s.PerformanceMarkers[o])},getPerformanceMetrics(){performance.measure("loadTime",s.PerformanceMarkers.create,s.PerformanceMarkers.load),performance.measure("fullLoadTime",s.PerformanceMarkers.create,s.PerformanceMarkers.fullLoad);const o=performance.getEntriesByName("loadTime")[0].duration,i=performance.getEntriesByName("fullLoadTime")[0].duration,l=Gu.length,p=1/(Gu.reduce((O,B)=>O+B,0)/l/1e3),E=Gu.filter(O=>O>yg).reduce((O,B)=>O+(B-yg)/yg,0);return{loadTime:o,fullLoadTime:i,fps:p,percentDroppedFrames:E/(l+E)*100}}};s.AJAXError=J,s.ARRAY_TYPE=xs,s.Actor=class{constructor(o,i,l){this.target=o,this.parent=i,this.mapId=l,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},k(["receive","process"],this),this.invoker=new u2(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Y()?o:window}send(o,i,l,p,E=!1){const O=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(this.callbacks[O]=l);const B=$(this.globalScope)?void 0:[];return this.target.postMessage({id:O,type:o,hasCallback:!!l,targetMapId:p,mustQueue:E,sourceMapId:this.mapId,data:Ul(i,B)},B),{cancel:()=>{l&&delete this.callbacks[O],this.target.postMessage({id:O,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(o){const i=o.data,l=i.id;if(l&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){delete this.tasks[l];const p=this.cancelCallbacks[l];delete this.cancelCallbacks[l],p&&p()}else Y()||i.mustQueue?(this.tasks[l]=i,this.taskQueue.push(l),this.invoker.trigger()):this.processTask(l,i)}process(){if(!this.taskQueue.length)return;const o=this.taskQueue.shift(),i=this.tasks[o];delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),i&&this.processTask(o,i)}processTask(o,i){if(i.type==="<response>"){const l=this.callbacks[o];delete this.callbacks[o],l&&(i.error?l(fa(i.error)):l(null,fa(i.data)))}else{let l=!1;const p=$(this.globalScope)?void 0:[],E=i.hasCallback?(te,se)=>{l=!0,delete this.cancelCallbacks[o],this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:te?Ul(te):null,data:Ul(se,p)},p)}:te=>{l=!0};let O=null;const B=fa(i.data);if(this.parent[i.type])O=this.parent[i.type](i.sourceMapId,B,E);else if(this.parent.getWorkerSource){const te=i.type.split(".");O=this.parent.getWorkerSource(i.sourceMapId,te[0],B.source)[te[1]](B,E)}else E(new Error(`Could not find function ${i.type}`));!l&&O&&O.cancel&&(this.cancelCallbacks[o]=O.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.AlphaImage=Lu,s.CanonicalTileID=mg,s.CollisionBoxArray=_t,s.CollisionCircleLayoutArray=class extends be{},s.Color=Ne,s.DEMData=Q0,s.DataConstantProperty=wi,s.DictionaryCoder=J0,s.EXTENT=Tn,s.ErrorEvent=Ie,s.EvaluationParameters=$r,s.Event=Ee,s.Evented=Oe,s.FeatureIndex=tb,s.FillBucket=Qm,s.FillExtrusionBucket=eg,s.GeoJSONFeature=eb,s.ImageAtlas=C0,s.ImagePosition=ng,s.LineBucket=tg,s.LineStripIndexArray=class extends vt{},s.LngLat=rn,s.LngLatBounds=Jl,s.MercatorCoordinate=Gp,s.ONE_EM=jn,s.OverscaledTileID=no,s.PerformanceUtils=p2,s.PosArray=er,s.Properties=wn,s.QuadTriangleArray=class extends ze{},s.RGBAImage=ro,s.RasterBoundsArray=class extends Yl{},s.RequestPerformance=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return o.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},s.ResourceType=ye,s.SegmentVector=fr,s.SymbolBucket=fh,s.Transitionable=ku,s.TriangleIndexArray=Nn,s.Uniform1f=nh,s.Uniform1i=class extends io{constructor(o,i){super(o,i),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},s.Uniform2f=class extends io{constructor(o,i){super(o,i),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},s.Uniform3f=class extends io{constructor(o,i){super(o,i),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},s.Uniform4f=ql,s.UniformColor=sh,s.UniformMatrix4f=class extends io{constructor(o,i){super(o,i),this.current=OT}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let i=1;i<16;i++)if(o[i]!==this.current[i]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},s.UnwrappedTileID=K0,s.ValidationError=Fe,s.ZoomHistory=$l,s.add=function(o,i,l){return o[0]=i[0]+l[0],o[1]=i[1]+l[1],o[2]=i[2]+l[2],o},s.addDynamicAttributes=cg,s.asyncAll=function(o,i,l){if(!o.length)return l(null,[]);let p=o.length;const E=new Array(o.length);let O=null;o.forEach((B,te)=>{i(B,(se,me)=>{se&&(O=se),E[te]=me,--p==0&&l(O,E)})})},s.bezier=x,s.bindAll=k,s.cacheEntryPossiblyAdded=function(o){oe++,oe>ue&&(o.getActor().send("enforceCacheSizeLimit",ne),oe=0)},s.clamp=g,s.clearTileCache=function(o){const i=caches.delete(H);o&&i.catch(o).then(()=>o())},s.clipLine=N0,s.clone=function(o){var i=new xs(16);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i[8]=o[8],i[9]=o[9],i[10]=o[10],i[11]=o[11],i[12]=o[12],i[13]=o[13],i[14]=o[14],i[15]=o[15],i},s.clone$1=I,s.clone$2=function(o){var i=new xs(3);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i},s.collisionCircleLayout=IE,s.config=F,s.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[4]=i[4],o[5]=i[5],o[6]=i[6],o[7]=i[7],o[8]=i[8],o[9]=i[9],o[10]=i[10],o[11]=i[11],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15],o},s.create=function(){var o=new xs(16);return xs!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},s.create$1=Xx,s.createExpression=Rl,s.createFilter=yu,s.createLayout=gn,s.createStyleLayer=function(o){return o.type==="custom"?new c2(o):new h2[o.type](o)},s.cross=function(o,i,l){var p=i[0],E=i[1],O=i[2],B=l[0],te=l[1],se=l[2];return o[0]=E*se-O*te,o[1]=O*B-p*se,o[2]=p*te-E*B,o},s.dot=function(o,i){return o[0]*i[0]+o[1]*i[1]+o[2]*i[2]},s.dot$1=function(o,i){return o[0]*i[0]+o[1]*i[1]+o[2]*i[2]+o[3]*i[3]},s.ease=v,s.emitValidationErrors=gp,s.enforceCacheSizeLimit=function(o){ie(),W&&W.then(i=>{i.keys().then(l=>{for(let p=0;p<l.length-o;p++)i.delete(l[p])})})},s.equals=function(o,i){var l=o[0],p=o[1],E=o[2],O=o[3],B=o[4],te=o[5],se=o[6],me=o[7],Se=o[8],De=o[9],Be=o[10],Ve=o[11],Ye=o[12],ct=o[13],ot=o[14],bt=o[15],Pt=i[0],yt=i[1],Mt=i[2],Ft=i[3],Bt=i[4],fi=i[5],vi=i[6],Jt=i[7],Xt=i[8],Yt=i[9],ei=i[10],Kt=i[11],$t=i[12],Ci=i[13],Ti=i[14],tr=i[15];return Math.abs(l-Pt)<=ys*Math.max(1,Math.abs(l),Math.abs(Pt))&&Math.abs(p-yt)<=ys*Math.max(1,Math.abs(p),Math.abs(yt))&&Math.abs(E-Mt)<=ys*Math.max(1,Math.abs(E),Math.abs(Mt))&&Math.abs(O-Ft)<=ys*Math.max(1,Math.abs(O),Math.abs(Ft))&&Math.abs(B-Bt)<=ys*Math.max(1,Math.abs(B),Math.abs(Bt))&&Math.abs(te-fi)<=ys*Math.max(1,Math.abs(te),Math.abs(fi))&&Math.abs(se-vi)<=ys*Math.max(1,Math.abs(se),Math.abs(vi))&&Math.abs(me-Jt)<=ys*Math.max(1,Math.abs(me),Math.abs(Jt))&&Math.abs(Se-Xt)<=ys*Math.max(1,Math.abs(Se),Math.abs(Xt))&&Math.abs(De-Yt)<=ys*Math.max(1,Math.abs(De),Math.abs(Yt))&&Math.abs(Be-ei)<=ys*Math.max(1,Math.abs(Be),Math.abs(ei))&&Math.abs(Ve-Kt)<=ys*Math.max(1,Math.abs(Ve),Math.abs(Kt))&&Math.abs(Ye-$t)<=ys*Math.max(1,Math.abs(Ye),Math.abs($t))&&Math.abs(ct-Ci)<=ys*Math.max(1,Math.abs(ct),Math.abs(Ci))&&Math.abs(ot-Ti)<=ys*Math.max(1,Math.abs(ot),Math.abs(Ti))&&Math.abs(bt-tr)<=ys*Math.max(1,Math.abs(bt),Math.abs(tr))},s.evaluateSizeForFeature=function(o,{uSize:i,uSizeT:l},{lowerSize:p,upperSize:E}){return o.kind==="source"?p/va:o.kind==="composite"?Yr(p/va,E/va,l):i},s.evaluateSizeForZoom=function(o,i){let l=0,p=0;if(o.kind==="constant")p=o.layoutSize;else if(o.kind!=="source"){const{interpolationType:E,minZoom:O,maxZoom:B}=o,te=E?g(Es.interpolationFactor(E,i,O,B),0,1):0;o.kind==="camera"?p=Yr(o.minSize,o.maxSize,te):l=te}return{uSizeT:l,uSize:p}},s.evaluateVariableOffset=F0,s.evented=Wa,s.exported=L,s.exported$1=Te,s.extend=_,s.filterObject=y,s.fromRotation=function(o,i){var l=Math.sin(i),p=Math.cos(i);return o[0]=p,o[1]=l,o[2]=0,o[3]=-l,o[4]=p,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},s.fromScaling=function(o,i){return o[0]=i[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=i[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},s.getAnchorAlignment=og,s.getAnchorJustification=lg,s.getArrayBuffer=xe,s.getImage=Ue,s.getJSON=function(o,i){return pe(_(o,{type:"json"}),i)},s.getOverlapMode=pg,s.getRTLTextPluginStatus=Su,s.getReferrer=re,s.getVideo=function(o,i){const l=window.document.createElement("video");l.muted=!0,l.onloadstart=function(){i(null,l)};for(let p=0;p<o.length;p++){const E=window.document.createElement("source");Me(o[p])||(l.crossOrigin="Anonymous"),E.src=o[p],l.appendChild(E)}return{cancel:()=>{}}},s.identity=Gm,s.invert=function(o,i){var l=i[0],p=i[1],E=i[2],O=i[3],B=i[4],te=i[5],se=i[6],me=i[7],Se=i[8],De=i[9],Be=i[10],Ve=i[11],Ye=i[12],ct=i[13],ot=i[14],bt=i[15],Pt=l*te-p*B,yt=l*se-E*B,Mt=l*me-O*B,Ft=p*se-E*te,Bt=p*me-O*te,fi=E*me-O*se,vi=Se*ct-De*Ye,Jt=Se*ot-Be*Ye,Xt=Se*bt-Ve*Ye,Yt=De*ot-Be*ct,ei=De*bt-Ve*ct,Kt=Be*bt-Ve*ot,$t=Pt*Kt-yt*ei+Mt*Yt+Ft*Xt-Bt*Jt+fi*vi;return $t?(o[0]=(te*Kt-se*ei+me*Yt)*($t=1/$t),o[1]=(E*ei-p*Kt-O*Yt)*$t,o[2]=(ct*fi-ot*Bt+bt*Ft)*$t,o[3]=(Be*Bt-De*fi-Ve*Ft)*$t,o[4]=(se*Xt-B*Kt-me*Jt)*$t,o[5]=(l*Kt-E*Xt+O*Jt)*$t,o[6]=(ot*Mt-Ye*fi-bt*yt)*$t,o[7]=(Se*fi-Be*Mt+Ve*yt)*$t,o[8]=(B*ei-te*Xt+me*vi)*$t,o[9]=(p*Xt-l*ei-O*vi)*$t,o[10]=(Ye*Bt-ct*Mt+bt*Pt)*$t,o[11]=(De*Mt-Se*Bt-Ve*Pt)*$t,o[12]=(te*Jt-B*Yt-se*vi)*$t,o[13]=(l*Yt-p*Jt+E*vi)*$t,o[14]=(ct*yt-Ye*Ft-ot*Pt)*$t,o[15]=(Se*Ft-De*yt+Be*Pt)*$t,o):null},s.isImageBitmap=R,s.isSafari=$,s.isWorker=Y,s.keysDifference=function(o,i){const l=[];for(const p in o)p in i||l.push(p);return l},s.lazyLoadRTLTextPlugin=function(){Vs.isLoading()||Vs.isLoaded()||Su()!=="deferred"||Kc()},s.makeRequest=pe,s.mapObject=A,s.mercatorXfromLng=Y0,s.mercatorYfromLat=q0,s.mercatorZfromAltitude=X0,s.mul=GT,s.mul$1=function(o,i,l){return o[0]=i[0]*l[0],o[1]=i[1]*l[1],o[2]=i[2]*l[2],o[3]=i[3]*l[3],o},s.multiply=Zx,s.nextPowerOfTwo=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},s.normalize=function(o,i){var l=i[0],p=i[1],E=i[2],O=l*l+p*p+E*E;return O>0&&(O=1/Math.sqrt(O)),o[0]=i[0]*O,o[1]=i[1]*O,o[2]=i[2]*O,o},s.number=Yr,s.ortho=function(o,i,l,p,E,O,B){var te=1/(i-l),se=1/(p-E),me=1/(O-B);return o[0]=-2*te,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*se,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*me,o[11]=0,o[12]=(i+l)*te,o[13]=(E+p)*se,o[14]=(B+O)*me,o[15]=1,o},s.parseCacheControl=X,s.parseGlyphPbf=function(o){return new ig(o).readFields($E,[])},s.pbf=ig,s.performSymbolLayout=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=Tn/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;const i=o.bucket.layers[0].layout,l=o.bucket.layers[0]._unevaluatedLayout._values,p={layoutIconSize:l["icon-size"].possiblyEvaluate(new $r(o.bucket.zoom+1),o.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new $r(o.bucket.zoom+1),o.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new $r(18))};if(o.bucket.textSizeData.kind==="composite"){const{minZoom:se,maxZoom:me}=o.bucket.textSizeData;p.compositeTextSizes=[l["text-size"].possiblyEvaluate(new $r(se),o.canonical),l["text-size"].possiblyEvaluate(new $r(me),o.canonical)]}if(o.bucket.iconSizeData.kind==="composite"){const{minZoom:se,maxZoom:me}=o.bucket.iconSizeData;p.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new $r(se),o.canonical),l["icon-size"].possiblyEvaluate(new $r(me),o.canonical)]}const E=i.get("text-line-height")*jn,O=i.get("text-rotation-alignment")!=="viewport"&&i.get("symbol-placement")!=="point",B=i.get("text-keep-upright"),te=i.get("text-size");for(const se of o.bucket.features){const me=i.get("text-font").evaluate(se,{},o.canonical).join(","),Se=te.evaluate(se,{},o.canonical),De=p.layoutTextSize.evaluate(se,{},o.canonical),Be=p.layoutIconSize.evaluate(se,{},o.canonical),Ve={horizontal:{},vertical:void 0},Ye=se.text;let ct,ot=[0,0];if(Ye){const yt=Ye.toString(),Mt=i.get("text-letter-spacing").evaluate(se,{},o.canonical)*jn,Ft=yp(yt)?Mt:0,Bt=i.get("text-anchor").evaluate(se,{},o.canonical),fi=i.get("text-variable-anchor");if(!fi){const ei=i.get("text-radial-offset").evaluate(se,{},o.canonical);ot=ei?F0(Bt,[ei*jn,ag]):i.get("text-offset").evaluate(se,{},o.canonical).map(Kt=>Kt*jn)}let vi=O?"center":i.get("text-justify").evaluate(se,{},o.canonical);const Jt=i.get("symbol-placement"),Xt=Jt==="point"?i.get("text-max-width").evaluate(se,{},o.canonical)*jn:0,Yt=()=>{o.bucket.allowVerticalPlacement&&_u(yt)&&(Ve.vertical=Op(Ye,o.glyphMap,o.glyphPositions,o.imagePositions,me,Xt,E,Bt,"left",Ft,ot,s.WritingMode.vertical,!0,Jt,De,Se))};if(!O&&fi){const ei=vi==="auto"?fi.map($t=>lg($t)):[vi];let Kt=!1;for(let $t=0;$t<ei.length;$t++){const Ci=ei[$t];if(!Ve.horizontal[Ci])if(Kt)Ve.horizontal[Ci]=Ve.horizontal[0];else{const Ti=Op(Ye,o.glyphMap,o.glyphPositions,o.imagePositions,me,Xt,E,"center",Ci,Ft,ot,s.WritingMode.horizontal,!1,Jt,De,Se);Ti&&(Ve.horizontal[Ci]=Ti,Kt=Ti.positionedLines.length===1)}}Yt()}else{vi==="auto"&&(vi=lg(Bt));const ei=Op(Ye,o.glyphMap,o.glyphPositions,o.imagePositions,me,Xt,E,Bt,vi,Ft,ot,s.WritingMode.horizontal,!1,Jt,De,Se);ei&&(Ve.horizontal[vi]=ei),Yt(),_u(yt)&&O&&B&&(Ve.vertical=Op(Ye,o.glyphMap,o.glyphPositions,o.imagePositions,me,Xt,E,Bt,vi,Ft,ot,s.WritingMode.vertical,!1,Jt,De,Se))}}let bt=!1;if(se.icon&&se.icon.name){const yt=o.imageMap[se.icon.name];yt&&(ct=qE(o.imagePositions[se.icon.name],i.get("icon-offset").evaluate(se,{},o.canonical),i.get("icon-anchor").evaluate(se,{},o.canonical)),bt=!!yt.sdf,o.bucket.sdfIcons===void 0?o.bucket.sdfIcons=bt:o.bucket.sdfIcons!==bt&&w("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(yt.pixelRatio!==o.bucket.pixelRatio||i.get("icon-rotate").constantOr(1)!==0)&&(o.bucket.iconsNeedLinear=!0))}const Pt=$0(Ve.horizontal)||Ve.vertical;o.bucket.iconsInText=!!Pt&&Pt.iconsInText,(Pt||ct)&&t2(o.bucket,se,Ve,ct,o.imageMap,p,De,Be,ot,bt,o.canonical)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},s.perspective=function(o,i,l,p,E){var O,B=1/Math.tan(i/2);return o[0]=B/l,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=B,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,E!=null&&E!==1/0?(o[10]=(E+p)*(O=1/(p-E)),o[14]=2*E*p*O):(o[10]=-1,o[14]=-2*p),o},s.pick=function(o,i){const l={};for(let p=0;p<i.length;p++){const E=i[p];E in o&&(l[E]=o[E])}return l},s.plugin=Vs,s.pointGeometry=G,s.polygonIntersectsPolygon=Hx,s.potpack=E0,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.register=di,s.registerForPluginStateChange=function(o){return o({pluginStatus:fs,pluginURL:Go}),Wa.on("pluginStateChange",o),o},s.renderColorRamp=r0,s.rotateX=function(o,i,l){var p=Math.sin(l),E=Math.cos(l),O=i[4],B=i[5],te=i[6],se=i[7],me=i[8],Se=i[9],De=i[10],Be=i[11];return i!==o&&(o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o[4]=O*E+me*p,o[5]=B*E+Se*p,o[6]=te*E+De*p,o[7]=se*E+Be*p,o[8]=me*E-O*p,o[9]=Se*E-B*p,o[10]=De*E-te*p,o[11]=Be*E-se*p,o},s.rotateZ=function(o,i,l){var p=Math.sin(l),E=Math.cos(l),O=i[0],B=i[1],te=i[2],se=i[3],me=i[4],Se=i[5],De=i[6],Be=i[7];return i!==o&&(o[8]=i[8],o[9]=i[9],o[10]=i[10],o[11]=i[11],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o[0]=O*E+me*p,o[1]=B*E+Se*p,o[2]=te*E+De*p,o[3]=se*E+Be*p,o[4]=me*E-O*p,o[5]=Se*E-B*p,o[6]=De*E-te*p,o[7]=Be*E-se*p,o},s.scale=function(o,i,l){var p=l[0],E=l[1],O=l[2];return o[0]=i[0]*p,o[1]=i[1]*p,o[2]=i[2]*p,o[3]=i[3]*p,o[4]=i[4]*E,o[5]=i[5]*E,o[6]=i[6]*E,o[7]=i[7]*E,o[8]=i[8]*O,o[9]=i[9]*O,o[10]=i[10]*O,o[11]=i[11]*O,o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15],o},s.scale$1=function(o,i,l){return o[0]=i[0]*l,o[1]=i[1]*l,o[2]=i[2]*l,o},s.setCacheLimits=function(o,i){ne=o,ue=i},s.setRTLTextPlugin=function(o,i,l=!1){if(fs===Zc||fs===wu||fs===Tu)throw new Error("setRTLTextPlugin cannot be called multiple times.");Go=L.resolveURL(o),fs=Zc,Eu=i,Cu(),l||Kc()},s.spec=Re,s.sphericalToCartesian=function([o,i,l]){return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:o*Math.cos(i)*Math.sin(l),y:o*Math.sin(i)*Math.sin(l),z:o*Math.cos(l)}},s.sqrLen=function(o){var i=o[0],l=o[1];return i*i+l*l},s.sub=function(o,i,l){return o[0]=i[0]-l[0],o[1]=i[1]-l[1],o[2]=i[2]-l[2],o},s.toEvaluationFeature=Kl,s.transformMat3=function(o,i,l){var p=i[0],E=i[1],O=i[2];return o[0]=p*l[0]+E*l[3]+O*l[6],o[1]=p*l[1]+E*l[4]+O*l[7],o[2]=p*l[2]+E*l[5]+O*l[8],o},s.transformMat4=kp,s.transformMat4$1=function(o,i,l){var p=i[0],E=i[1];return o[0]=l[0]*p+l[4]*E+l[12],o[1]=l[1]*p+l[5]*E+l[13],o},s.translate=function(o,i,l){var p,E,O,B,te,se,me,Se,De,Be,Ve,Ye,ct=l[0],ot=l[1],bt=l[2];return i===o?(o[12]=i[0]*ct+i[4]*ot+i[8]*bt+i[12],o[13]=i[1]*ct+i[5]*ot+i[9]*bt+i[13],o[14]=i[2]*ct+i[6]*ot+i[10]*bt+i[14],o[15]=i[3]*ct+i[7]*ot+i[11]*bt+i[15]):(E=i[1],O=i[2],B=i[3],te=i[4],se=i[5],me=i[6],Se=i[7],De=i[8],Be=i[9],Ve=i[10],Ye=i[11],o[0]=p=i[0],o[1]=E,o[2]=O,o[3]=B,o[4]=te,o[5]=se,o[6]=me,o[7]=Se,o[8]=De,o[9]=Be,o[10]=Ve,o[11]=Ye,o[12]=p*ct+te*ot+De*bt+i[12],o[13]=E*ct+se*ot+Be*bt+i[13],o[14]=O*ct+me*ot+Ve*bt+i[14],o[15]=B*ct+Se*ot+Ye*bt+i[15]),o},s.triggerPluginCompletionEvent=vp,s.unicodeBlockLookup=Qt,s.uniqueId=function(){return S++},s.validateCustomStyleLayer=function(o){const i=[],l=o.id;return l===void 0&&i.push({message:`layers.${l}: missing required property "id"`}),o.render===void 0&&i.push({message:`layers.${l}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&i.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),i},s.validateLight=Im,s.validateStyle=da,s.vectorTile=Ka,s.warnOnce=w,s.wrap=P}),h(["./shared"],function(s){function f($e){const fe=typeof $e;if(fe==="number"||fe==="boolean"||fe==="string"||$e==null)return JSON.stringify($e);if(Array.isArray($e)){let qe="[";for(const it of $e)qe+=`${f(it)},`;return`${qe}]`}const ke=Object.keys($e).sort();let Ne="{";for(let qe=0;qe<ke.length;qe++)Ne+=`${JSON.stringify(ke[qe])}:${f($e[ke[qe]])},`;return`${Ne}}`}function b($e){let fe="";for(const ke of s.refProperties)fe+=`/${f($e[ke])}`;return fe}class x{constructor(fe){this.keyCache={},fe&&this.replace(fe)}replace(fe){this._layerConfigs={},this._layers={},this.update(fe,[])}update(fe,ke){for(const qe of fe){this._layerConfigs[qe.id]=qe;const it=this._layers[qe.id]=s.createStyleLayer(qe);it._featureFilter=s.createFilter(it.filter),this.keyCache[qe.id]&&delete this.keyCache[qe.id]}for(const qe of ke)delete this.keyCache[qe],delete this._layerConfigs[qe],delete this._layers[qe];this.familiesBySource={};const Ne=function(qe,it){const lt={};for(let tt=0;tt<qe.length;tt++){const ft=it&&it[qe[tt].id]||b(qe[tt]);it&&(it[qe[tt].id]=ft);let St=lt[ft];St||(St=lt[ft]=[]),St.push(qe[tt])}const st=[];for(const tt in lt)st.push(lt[tt]);return st}(Object.values(this._layerConfigs),this.keyCache);for(const qe of Ne){const it=qe.map(Lt=>this._layers[Lt.id]),lt=it[0];if(lt.visibility==="none")continue;const st=lt.source||"";let tt=this.familiesBySource[st];tt||(tt=this.familiesBySource[st]={});const ft=lt.sourceLayer||"_geojsonTileLayer";let St=tt[ft];St||(St=tt[ft]=[]),St.push(it)}}}class v{constructor(fe){const ke={},Ne=[];for(const st in fe){const tt=fe[st],ft=ke[st]={};for(const St in tt){const Lt=tt[+St];if(!Lt||Lt.bitmap.width===0||Lt.bitmap.height===0)continue;const It={x:0,y:0,w:Lt.bitmap.width+2,h:Lt.bitmap.height+2};Ne.push(It),ft[St]={rect:It,metrics:Lt.metrics}}}const{w:qe,h:it}=s.potpack(Ne),lt=new s.AlphaImage({width:qe||1,height:it||1});for(const st in fe){const tt=fe[st];for(const ft in tt){const St=tt[+ft];if(!St||St.bitmap.width===0||St.bitmap.height===0)continue;const Lt=ke[st][ft].rect;s.AlphaImage.copy(St.bitmap,lt,{x:0,y:0},{x:Lt.x+1,y:Lt.y+1},St.bitmap)}}this.image=lt,this.positions=ke}}s.register("GlyphAtlas",v);class g{constructor(fe){this.tileID=new s.OverscaledTileID(fe.tileID.overscaledZ,fe.tileID.wrap,fe.tileID.canonical.z,fe.tileID.canonical.x,fe.tileID.canonical.y),this.uid=fe.uid,this.zoom=fe.zoom,this.pixelRatio=fe.pixelRatio,this.tileSize=fe.tileSize,this.source=fe.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=fe.showCollisionBoxes,this.collectResourceTiming=!!fe.collectResourceTiming,this.returnDependencies=!!fe.returnDependencies,this.promoteId=fe.promoteId}parse(fe,ke,Ne,qe,it){this.status="parsing",this.data=fe,this.collisionBoxArray=new s.CollisionBoxArray;const lt=new s.DictionaryCoder(Object.keys(fe.layers).sort()),st=new s.FeatureIndex(this.tileID,this.promoteId);st.bucketLayerIDs=[];const tt={},ft={featureIndex:st,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Ne},St=ke.familiesBySource[this.source];for(const Si in St){const Ni=fe.layers[Si];if(!Ni)continue;Ni.version===1&&s.warnOnce(`Vector tile source "${this.source}" layer "${Si}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Li=lt.encode(Si),rr=[];for(let Ar=0;Ar<Ni.length;Ar++){const Jr=Ni.feature(Ar),_n=st.getId(Jr,Si);rr.push({feature:Jr,id:_n,index:Ar,sourceLayerIndex:Li})}for(const Ar of St[Si]){const Jr=Ar[0];Jr.source!==this.source&&s.warnOnce(`layer.source = ${Jr.source} does not equal this.source = ${this.source}`),Jr.minzoom&&this.zoom<Math.floor(Jr.minzoom)||Jr.maxzoom&&this.zoom>=Jr.maxzoom||Jr.visibility!=="none"&&(P(Ar,this.zoom,Ne),(tt[Jr.id]=Jr.createBucket({index:st.bucketLayerIDs.length,layers:Ar,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Li,sourceID:this.source})).populate(rr,ft,this.tileID.canonical),st.bucketLayerIDs.push(Ar.map(_n=>_n.id)))}}let Lt,It,si,Zt;const ui=s.mapObject(ft.glyphDependencies,Si=>Object.keys(Si).map(Number));Object.keys(ui).length?qe.send("getGlyphs",{uid:this.uid,stacks:ui},(Si,Ni)=>{Lt||(Lt=Si,It=Ni,yi.call(this))}):It={};const gi=Object.keys(ft.iconDependencies);gi.length?qe.send("getImages",{icons:gi,source:this.source,tileID:this.tileID,type:"icons"},(Si,Ni)=>{Lt||(Lt=Si,si=Ni,yi.call(this))}):si={};const zi=Object.keys(ft.patternDependencies);function yi(){if(Lt)return it(Lt);if(It&&si&&Zt){const Si=new v(It),Ni=new s.ImageAtlas(si,Zt);for(const Li in tt){const rr=tt[Li];rr instanceof s.SymbolBucket?(P(rr.layers,this.zoom,Ne),s.performSymbolLayout({bucket:rr,glyphMap:It,glyphPositions:Si.positions,imageMap:si,imagePositions:Ni.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):rr.hasPattern&&(rr instanceof s.LineBucket||rr instanceof s.FillBucket||rr instanceof s.FillExtrusionBucket)&&(P(rr.layers,this.zoom,Ne),rr.addFeatures(ft,this.tileID.canonical,Ni.patternPositions))}this.status="done",it(null,{buckets:Object.values(tt).filter(Li=>!Li.isEmpty()),featureIndex:st,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Si.image,imageAtlas:Ni,glyphMap:this.returnDependencies?It:null,iconMap:this.returnDependencies?si:null,glyphPositions:this.returnDependencies?Si.positions:null})}}zi.length?qe.send("getImages",{icons:zi,source:this.source,tileID:this.tileID,type:"patterns"},(Si,Ni)=>{Lt||(Lt=Si,Zt=Ni,yi.call(this))}):Zt={},yi.call(this)}}function P($e,fe,ke){const Ne=new s.EvaluationParameters(fe);for(const qe of $e)qe.recalculate(Ne,ke)}function _($e,fe){const ke=s.getArrayBuffer($e.request,(Ne,qe,it,lt)=>{Ne?fe(Ne):qe&&fe(null,{vectorTile:new s.vectorTile.VectorTile(new s.pbf(qe)),rawData:qe,cacheControl:it,expires:lt})});return()=>{ke.cancel(),fe()}}class S{constructor(fe,ke,Ne,qe){this.actor=fe,this.layerIndex=ke,this.availableImages=Ne,this.loadVectorData=qe||_,this.loading={},this.loaded={}}loadTile(fe,ke){const Ne=fe.uid;this.loading||(this.loading={});const qe=!!(fe&&fe.request&&fe.request.collectResourceTiming)&&new s.RequestPerformance(fe.request),it=this.loading[Ne]=new g(fe);it.abort=this.loadVectorData(fe,(lt,st)=>{if(delete this.loading[Ne],lt||!st)return it.status="done",this.loaded[Ne]=it,ke(lt);const tt=st.rawData,ft={};st.expires&&(ft.expires=st.expires),st.cacheControl&&(ft.cacheControl=st.cacheControl);const St={};if(qe){const Lt=qe.finish();Lt&&(St.resourceTiming=JSON.parse(JSON.stringify(Lt)))}it.vectorTile=st.vectorTile,it.parse(st.vectorTile,this.layerIndex,this.availableImages,this.actor,(Lt,It)=>{if(Lt||!It)return ke(Lt);ke(null,s.extend({rawTileData:tt.slice(0)},It,ft,St))}),this.loaded=this.loaded||{},this.loaded[Ne]=it})}reloadTile(fe,ke){const Ne=this.loaded,qe=fe.uid,it=this;if(Ne&&Ne[qe]){const lt=Ne[qe];lt.showCollisionBoxes=fe.showCollisionBoxes;const st=(tt,ft)=>{const St=lt.reloadCallback;St&&(delete lt.reloadCallback,lt.parse(lt.vectorTile,it.layerIndex,this.availableImages,it.actor,St)),ke(tt,ft)};lt.status==="parsing"?lt.reloadCallback=st:lt.status==="done"&&(lt.vectorTile?lt.parse(lt.vectorTile,this.layerIndex,this.availableImages,this.actor,st):st())}}abortTile(fe,ke){const Ne=this.loading,qe=fe.uid;Ne&&Ne[qe]&&Ne[qe].abort&&(Ne[qe].abort(),delete Ne[qe]),ke()}removeTile(fe,ke){const Ne=this.loaded,qe=fe.uid;Ne&&Ne[qe]&&delete Ne[qe],ke()}}class k{constructor(){this.loaded={}}loadTile(fe,ke){const{uid:Ne,encoding:qe,rawImageData:it}=fe,lt=s.isImageBitmap(it)?this.getImageData(it):it,st=new s.DEMData(Ne,lt,qe);this.loaded=this.loaded||{},this.loaded[Ne]=st,ke(null,st)}getImageData(fe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(fe.width,fe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=fe.width,this.offscreenCanvas.height=fe.height,this.offscreenCanvasContext.drawImage(fe,0,0,fe.width,fe.height);const ke=this.offscreenCanvasContext.getImageData(-1,-1,fe.width+2,fe.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new s.RGBAImage({width:ke.width,height:ke.height},ke.data)}removeTile(fe){const ke=this.loaded,Ne=fe.uid;ke&&ke[Ne]&&delete ke[Ne]}}var A=function $e(fe,ke){var Ne,qe=fe&&fe.type;if(qe==="FeatureCollection")for(Ne=0;Ne<fe.features.length;Ne++)$e(fe.features[Ne],ke);else if(qe==="GeometryCollection")for(Ne=0;Ne<fe.geometries.length;Ne++)$e(fe.geometries[Ne],ke);else if(qe==="Feature")$e(fe.geometry,ke);else if(qe==="Polygon")y(fe.coordinates,ke);else if(qe==="MultiPolygon")for(Ne=0;Ne<fe.coordinates.length;Ne++)y(fe.coordinates[Ne],ke);return fe};function y($e,fe){if($e.length!==0){I($e[0],fe);for(var ke=1;ke<$e.length;ke++)I($e[ke],!1)}}function I($e,fe){for(var ke=0,Ne=0,qe=0,it=$e.length,lt=it-1;qe<it;lt=qe++){var st=($e[qe][0]-$e[lt][0])*($e[lt][1]+$e[qe][1]),tt=ke+st;Ne+=Math.abs(ke)>=Math.abs(st)?ke-tt+st:st-tt+ke,ke=tt}ke+Ne>=0!=!!fe&&$e.reverse()}const D=s.vectorTile.VectorTileFeature.prototype.toGeoJSON;class w{constructor(fe){this._feature=fe,this.extent=s.EXTENT,this.type=fe.type,this.properties=fe.tags,"id"in fe&&!isNaN(fe.id)&&(this.id=parseInt(fe.id,10))}loadGeometry(){if(this._feature.type===1){const fe=[];for(const ke of this._feature.geometry)fe.push([new s.pointGeometry(ke[0],ke[1])]);return fe}{const fe=[];for(const ke of this._feature.geometry){const Ne=[];for(const qe of ke)Ne.push(new s.pointGeometry(qe[0],qe[1]));fe.push(Ne)}return fe}}toGeoJSON(fe,ke,Ne){return D.call(this,fe,ke,Ne)}}class M{constructor(fe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=fe.length,this._features=fe}feature(fe){return new w(this._features[fe])}}var z={exports:{}},Y=s.pointGeometry,X=s.vectorTile.VectorTileFeature,Z=j;function j($e,fe){this.options=fe||{},this.features=$e,this.length=$e.length}function V($e,fe){this.id=typeof $e.id=="number"?$e.id:void 0,this.type=$e.type,this.rawGeometry=$e.type===1?[$e.geometry]:$e.geometry,this.properties=$e.tags,this.extent=fe||4096}j.prototype.feature=function($e){return new V(this.features[$e],this.options.extent)},V.prototype.loadGeometry=function(){var $e=this.rawGeometry;this.geometry=[];for(var fe=0;fe<$e.length;fe++){for(var ke=$e[fe],Ne=[],qe=0;qe<ke.length;qe++)Ne.push(new Y(ke[qe][0],ke[qe][1]));this.geometry.push(Ne)}return this.geometry},V.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var $e=this.geometry,fe=1/0,ke=-1/0,Ne=1/0,qe=-1/0,it=0;it<$e.length;it++)for(var lt=$e[it],st=0;st<lt.length;st++){var tt=lt[st];fe=Math.min(fe,tt.x),ke=Math.max(ke,tt.x),Ne=Math.min(Ne,tt.y),qe=Math.max(qe,tt.y)}return[fe,Ne,ke,qe]},V.prototype.toGeoJSON=X.prototype.toGeoJSON;var $=s.pbf,R=Z;function L($e){var fe=new $;return function(ke,Ne){for(var qe in ke.layers)Ne.writeMessage(3,G,ke.layers[qe])}($e,fe),fe.finish()}function G($e,fe){var ke;fe.writeVarintField(15,$e.version||1),fe.writeStringField(1,$e.name||""),fe.writeVarintField(5,$e.extent||4096);var Ne={keys:[],values:[],keycache:{},valuecache:{}};for(ke=0;ke<$e.length;ke++)Ne.feature=$e.feature(ke),fe.writeMessage(2,U,Ne);var qe=Ne.keys;for(ke=0;ke<qe.length;ke++)fe.writeStringField(3,qe[ke]);var it=Ne.values;for(ke=0;ke<it.length;ke++)fe.writeMessage(4,ue,it[ke])}function U($e,fe){var ke=$e.feature;ke.id!==void 0&&fe.writeVarintField(1,ke.id),fe.writeMessage(2,F,$e),fe.writeVarintField(3,ke.type),fe.writeMessage(4,ne,ke)}function F($e,fe){var ke=$e.feature,Ne=$e.keys,qe=$e.values,it=$e.keycache,lt=$e.valuecache;for(var st in ke.properties){var tt=ke.properties[st],ft=it[st];if(tt!==null){ft===void 0&&(Ne.push(st),it[st]=ft=Ne.length-1),fe.writeVarint(ft);var St=typeof tt;St!=="string"&&St!=="boolean"&&St!=="number"&&(tt=JSON.stringify(tt));var Lt=St+":"+tt,It=lt[Lt];It===void 0&&(qe.push(tt),lt[Lt]=It=qe.length-1),fe.writeVarint(It)}}}function H($e,fe){return(fe<<3)+(7&$e)}function W($e){return $e<<1^$e>>31}function ne($e,fe){for(var ke=$e.loadGeometry(),Ne=$e.type,qe=0,it=0,lt=ke.length,st=0;st<lt;st++){var tt=ke[st],ft=1;Ne===1&&(ft=tt.length),fe.writeVarint(H(1,ft));for(var St=Ne===3?tt.length-1:tt.length,Lt=0;Lt<St;Lt++){Lt===1&&Ne!==1&&fe.writeVarint(H(2,St-1));var It=tt[Lt].x-qe,si=tt[Lt].y-it;fe.writeVarint(W(It)),fe.writeVarint(W(si)),qe+=It,it+=si}Ne===3&&fe.writeVarint(H(7,1))}}function ue($e,fe){var ke=typeof $e;ke==="string"?fe.writeStringField(1,$e):ke==="boolean"?fe.writeBooleanField(7,$e):ke==="number"&&($e%1!=0?fe.writeDoubleField(3,$e):$e<0?fe.writeSVarintField(6,$e):fe.writeVarintField(5,$e))}function ie($e,fe,ke,Ne,qe,it){if(qe-Ne<=ke)return;const lt=Ne+qe>>1;oe($e,fe,lt,Ne,qe,it%2),ie($e,fe,ke,Ne,lt-1,it+1),ie($e,fe,ke,lt+1,qe,it+1)}function oe($e,fe,ke,Ne,qe,it){for(;qe>Ne;){if(qe-Ne>600){const ft=qe-Ne+1,St=ke-Ne+1,Lt=Math.log(ft),It=.5*Math.exp(2*Lt/3),si=.5*Math.sqrt(Lt*It*(ft-It)/ft)*(St-ft/2<0?-1:1);oe($e,fe,ke,Math.max(Ne,Math.floor(ke-St*It/ft+si)),Math.min(qe,Math.floor(ke+(ft-St)*It/ft+si)),it)}const lt=fe[2*ke+it];let st=Ne,tt=qe;for(Te($e,fe,Ne,ke),fe[2*qe+it]>lt&&Te($e,fe,Ne,qe);st<tt;){for(Te($e,fe,st,tt),st++,tt--;fe[2*st+it]<lt;)st++;for(;fe[2*tt+it]>lt;)tt--}fe[2*Ne+it]===lt?Te($e,fe,Ne,tt):(tt++,Te($e,fe,tt,qe)),tt<=ke&&(Ne=tt+1),ke<=tt&&(qe=tt-1)}}function Te($e,fe,ke,Ne){ge($e,ke,Ne),ge(fe,2*ke,2*Ne),ge(fe,2*ke+1,2*Ne+1)}function ge($e,fe,ke){const Ne=$e[fe];$e[fe]=$e[ke],$e[ke]=Ne}function we($e,fe,ke,Ne){const qe=$e-ke,it=fe-Ne;return qe*qe+it*it}z.exports=L,z.exports.fromVectorTileJs=L,z.exports.fromGeojsonVt=function($e,fe){fe=fe||{};var ke={};for(var Ne in $e)ke[Ne]=new R($e[Ne].features,fe),ke[Ne].name=Ne,ke[Ne].version=fe.version,ke[Ne].extent=fe.extent;return L({layers:ke})},z.exports.GeoJSONWrapper=R;const K=$e=>$e[0],Q=$e=>$e[1];class ae{constructor(fe,ke=K,Ne=Q,qe=64,it=Float64Array){this.nodeSize=qe,this.points=fe;const lt=fe.length<65536?Uint16Array:Uint32Array,st=this.ids=new lt(fe.length),tt=this.coords=new it(2*fe.length);for(let ft=0;ft<fe.length;ft++)st[ft]=ft,tt[2*ft]=ke(fe[ft]),tt[2*ft+1]=Ne(fe[ft]);ie(st,tt,qe,0,st.length-1,0)}range(fe,ke,Ne,qe){return function(it,lt,st,tt,ft,St,Lt){const It=[0,it.length-1,0],si=[];let Zt,ui;for(;It.length;){const gi=It.pop(),zi=It.pop(),yi=It.pop();if(zi-yi<=Lt){for(let Li=yi;Li<=zi;Li++)Zt=lt[2*Li],ui=lt[2*Li+1],Zt>=st&&Zt<=ft&&ui>=tt&&ui<=St&&si.push(it[Li]);continue}const Si=Math.floor((yi+zi)/2);Zt=lt[2*Si],ui=lt[2*Si+1],Zt>=st&&Zt<=ft&&ui>=tt&&ui<=St&&si.push(it[Si]);const Ni=(gi+1)%2;(gi===0?st<=Zt:tt<=ui)&&(It.push(yi),It.push(Si-1),It.push(Ni)),(gi===0?ft>=Zt:St>=ui)&&(It.push(Si+1),It.push(zi),It.push(Ni))}return si}(this.ids,this.coords,fe,ke,Ne,qe,this.nodeSize)}within(fe,ke,Ne){return function(qe,it,lt,st,tt,ft){const St=[0,qe.length-1,0],Lt=[],It=tt*tt;for(;St.length;){const si=St.pop(),Zt=St.pop(),ui=St.pop();if(Zt-ui<=ft){for(let Ni=ui;Ni<=Zt;Ni++)we(it[2*Ni],it[2*Ni+1],lt,st)<=It&&Lt.push(qe[Ni]);continue}const gi=Math.floor((ui+Zt)/2),zi=it[2*gi],yi=it[2*gi+1];we(zi,yi,lt,st)<=It&&Lt.push(qe[gi]);const Si=(si+1)%2;(si===0?lt-tt<=zi:st-tt<=yi)&&(St.push(ui),St.push(gi-1),St.push(Si)),(si===0?lt+tt>=zi:st+tt>=yi)&&(St.push(gi+1),St.push(Zt),St.push(Si))}return Lt}(this.ids,this.coords,fe,ke,Ne,this.nodeSize)}}const ye={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:$e=>$e},J=Math.fround||(re=new Float32Array(1),$e=>(re[0]=+$e,re[0]));var re;class ce{constructor(fe){this.options=Xe(Object.create(ye),fe),this.trees=new Array(this.options.maxZoom+1)}load(fe){const{log:ke,minZoom:Ne,maxZoom:qe,nodeSize:it}=this.options;ke&&console.time("total time");const lt=`prepare ${fe.length} points`;ke&&console.time(lt),this.points=fe;let st=[];for(let tt=0;tt<fe.length;tt++)fe[tt].geometry&&st.push(xe(fe[tt],tt));this.trees[qe+1]=new ae(st,Pe,Ee,it,Float32Array),ke&&console.timeEnd(lt);for(let tt=qe;tt>=Ne;tt--){const ft=+Date.now();st=this._cluster(st,tt),this.trees[tt]=new ae(st,Pe,Ee,it,Float32Array),ke&&console.log("z%d: %d clusters in %dms",tt,st.length,+Date.now()-ft)}return ke&&console.timeEnd("total time"),this}getClusters(fe,ke){let Ne=((fe[0]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,fe[1]));let it=fe[2]===180?180:((fe[2]+180)%360+360)%360-180;const lt=Math.max(-90,Math.min(90,fe[3]));if(fe[2]-fe[0]>=360)Ne=-180,it=180;else if(Ne>it){const St=this.getClusters([Ne,qe,180,lt],ke),Lt=this.getClusters([-180,qe,it,lt],ke);return St.concat(Lt)}const st=this.trees[this._limitZoom(ke)],tt=st.range(Ce(Ne),Le(lt),Ce(it),Le(qe)),ft=[];for(const St of tt){const Lt=st.points[St];ft.push(Lt.numPoints?Me(Lt):this.points[Lt.index])}return ft}getChildren(fe){const ke=this._getOriginId(fe),Ne=this._getOriginZoom(fe),qe="No cluster with the specified id.",it=this.trees[Ne];if(!it)throw new Error(qe);const lt=it.points[ke];if(!lt)throw new Error(qe);const st=this.options.radius/(this.options.extent*Math.pow(2,Ne-1)),tt=it.within(lt.x,lt.y,st),ft=[];for(const St of tt){const Lt=it.points[St];Lt.parentId===fe&&ft.push(Lt.numPoints?Me(Lt):this.points[Lt.index])}if(ft.length===0)throw new Error(qe);return ft}getLeaves(fe,ke,Ne){const qe=[];return this._appendLeaves(qe,fe,ke=ke||10,Ne=Ne||0,0),qe}getTile(fe,ke,Ne){const qe=this.trees[this._limitZoom(fe)],it=Math.pow(2,fe),{extent:lt,radius:st}=this.options,tt=st/lt,ft=(Ne-tt)/it,St=(Ne+1+tt)/it,Lt={features:[]};return this._addTileFeatures(qe.range((ke-tt)/it,ft,(ke+1+tt)/it,St),qe.points,ke,Ne,it,Lt),ke===0&&this._addTileFeatures(qe.range(1-tt/it,ft,1,St),qe.points,it,Ne,it,Lt),ke===it-1&&this._addTileFeatures(qe.range(0,ft,tt/it,St),qe.points,-1,Ne,it,Lt),Lt.features.length?Lt:null}getClusterExpansionZoom(fe){let ke=this._getOriginZoom(fe)-1;for(;ke<=this.options.maxZoom;){const Ne=this.getChildren(fe);if(ke++,Ne.length!==1)break;fe=Ne[0].properties.cluster_id}return ke}_appendLeaves(fe,ke,Ne,qe,it){const lt=this.getChildren(ke);for(const st of lt){const tt=st.properties;if(tt&&tt.cluster?it+tt.point_count<=qe?it+=tt.point_count:it=this._appendLeaves(fe,tt.cluster_id,Ne,qe,it):it<qe?it++:fe.push(st),fe.length===Ne)break}return it}_addTileFeatures(fe,ke,Ne,qe,it,lt){for(const st of fe){const tt=ke[st],ft=tt.numPoints;let St,Lt,It;if(ft)St=_e(tt),Lt=tt.x,It=tt.y;else{const ui=this.points[tt.index];St=ui.properties,Lt=Ce(ui.geometry.coordinates[0]),It=Le(ui.geometry.coordinates[1])}const si={type:1,geometry:[[Math.round(this.options.extent*(Lt*it-Ne)),Math.round(this.options.extent*(It*it-qe))]],tags:St};let Zt;ft?Zt=tt.id:this.options.generateId?Zt=tt.index:this.points[tt.index].id&&(Zt=this.points[tt.index].id),Zt!==void 0&&(si.id=Zt),lt.features.push(si)}}_limitZoom(fe){return Math.max(this.options.minZoom,Math.min(Math.floor(+fe),this.options.maxZoom+1))}_cluster(fe,ke){const Ne=[],{radius:qe,extent:it,reduce:lt,minPoints:st}=this.options,tt=qe/(it*Math.pow(2,ke));for(let ft=0;ft<fe.length;ft++){const St=fe[ft];if(St.zoom<=ke)continue;St.zoom=ke;const Lt=this.trees[ke+1],It=Lt.within(St.x,St.y,tt),si=St.numPoints||1;let Zt=si;for(const ui of It){const gi=Lt.points[ui];gi.zoom>ke&&(Zt+=gi.numPoints||1)}if(Zt>si&&Zt>=st){let ui=St.x*si,gi=St.y*si,zi=lt&&si>1?this._map(St,!0):null;const yi=(ft<<5)+(ke+1)+this.points.length;for(const Si of It){const Ni=Lt.points[Si];if(Ni.zoom<=ke)continue;Ni.zoom=ke;const Li=Ni.numPoints||1;ui+=Ni.x*Li,gi+=Ni.y*Li,Ni.parentId=yi,lt&&(zi||(zi=this._map(St,!0)),lt(zi,this._map(Ni)))}St.parentId=yi,Ne.push(pe(ui/Zt,gi/Zt,yi,Zt,zi))}else if(Ne.push(St),Zt>1)for(const ui of It){const gi=Lt.points[ui];gi.zoom<=ke||(gi.zoom=ke,Ne.push(gi))}}return Ne}_getOriginId(fe){return fe-this.points.length>>5}_getOriginZoom(fe){return(fe-this.points.length)%32}_map(fe,ke){if(fe.numPoints)return ke?Xe({},fe.properties):fe.properties;const Ne=this.points[fe.index].properties,qe=this.options.map(Ne);return ke&&qe===Ne?Xe({},qe):qe}}function pe($e,fe,ke,Ne,qe){return{x:J($e),y:J(fe),zoom:1/0,id:ke,parentId:-1,numPoints:Ne,properties:qe}}function xe($e,fe){const[ke,Ne]=$e.geometry.coordinates;return{x:J(Ce(ke)),y:J(Le(Ne)),zoom:1/0,index:fe,parentId:-1}}function Me($e){return{type:"Feature",id:$e.id,properties:_e($e),geometry:{type:"Point",coordinates:[(fe=$e.x,360*(fe-.5)),Ue($e.y)]}};var fe}function _e($e){const fe=$e.numPoints,ke=fe>=1e4?`${Math.round(fe/1e3)}k`:fe>=1e3?Math.round(fe/100)/10+"k":fe;return Xe(Xe({},$e.properties),{cluster:!0,cluster_id:$e.id,point_count:fe,point_count_abbreviated:ke})}function Ce($e){return $e/360+.5}function Le($e){const fe=Math.sin($e*Math.PI/180),ke=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return ke<0?0:ke>1?1:ke}function Ue($e){const fe=(180-360*$e)*Math.PI/180;return 360*Math.atan(Math.exp(fe))/Math.PI-90}function Xe($e,fe){for(const ke in fe)$e[ke]=fe[ke];return $e}function Pe($e){return $e.x}function Ee($e){return $e.y}function Ie($e,fe,ke,Ne){for(var qe,it=Ne,lt=ke-fe>>1,st=ke-fe,tt=$e[fe],ft=$e[fe+1],St=$e[ke],Lt=$e[ke+1],It=fe+3;It<ke;It+=3){var si=Oe($e[It],$e[It+1],tt,ft,St,Lt);if(si>it)qe=It,it=si;else if(si===it){var Zt=Math.abs(It-lt);Zt<st&&(qe=It,st=Zt)}}it>Ne&&(qe-fe>3&&Ie($e,fe,qe,Ne),$e[qe+2]=it,ke-qe>3&&Ie($e,qe,ke,Ne))}function Oe($e,fe,ke,Ne,qe,it){var lt=qe-ke,st=it-Ne;if(lt!==0||st!==0){var tt=(($e-ke)*lt+(fe-Ne)*st)/(lt*lt+st*st);tt>1?(ke=qe,Ne=it):tt>0&&(ke+=lt*tt,Ne+=st*tt)}return(lt=$e-ke)*lt+(st=fe-Ne)*st}function Re($e,fe,ke,Ne){var qe={id:$e===void 0?null:$e,type:fe,geometry:ke,tags:Ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(it){var lt=it.geometry,st=it.type;if(st==="Point"||st==="MultiPoint"||st==="LineString")Fe(it,lt);else if(st==="Polygon"||st==="MultiLineString")for(var tt=0;tt<lt.length;tt++)Fe(it,lt[tt]);else if(st==="MultiPolygon")for(tt=0;tt<lt.length;tt++)for(var ft=0;ft<lt[tt].length;ft++)Fe(it,lt[tt][ft])}(qe),qe}function Fe($e,fe){for(var ke=0;ke<fe.length;ke+=3)$e.minX=Math.min($e.minX,fe[ke]),$e.minY=Math.min($e.minY,fe[ke+1]),$e.maxX=Math.max($e.maxX,fe[ke]),$e.maxY=Math.max($e.maxY,fe[ke+1])}function Ke($e,fe,ke,Ne){if(fe.geometry){var qe=fe.geometry.coordinates,it=fe.geometry.type,lt=Math.pow(ke.tolerance/((1<<ke.maxZoom)*ke.extent),2),st=[],tt=fe.id;if(ke.promoteId?tt=fe.properties[ke.promoteId]:ke.generateId&&(tt=Ne||0),it==="Point")rt(qe,st);else if(it==="MultiPoint")for(var ft=0;ft<qe.length;ft++)rt(qe[ft],st);else if(it==="LineString")at(qe,st,lt,!1);else if(it==="MultiLineString"){if(ke.lineMetrics){for(ft=0;ft<qe.length;ft++)at(qe[ft],st=[],lt,!1),$e.push(Re(tt,"LineString",st,fe.properties));return}ut(qe,st,lt,!1)}else if(it==="Polygon")ut(qe,st,lt,!0);else{if(it!=="MultiPolygon"){if(it==="GeometryCollection"){for(ft=0;ft<fe.geometry.geometries.length;ft++)Ke($e,{id:tt,geometry:fe.geometry.geometries[ft],properties:fe.properties},ke,Ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ft=0;ft<qe.length;ft++){var St=[];ut(qe[ft],St,lt,!0),st.push(St)}}$e.push(Re(tt,it,st,fe.properties))}}function rt($e,fe){fe.push(mt($e[0])),fe.push(Tt($e[1])),fe.push(0)}function at($e,fe,ke,Ne){for(var qe,it,lt=0,st=0;st<$e.length;st++){var tt=mt($e[st][0]),ft=Tt($e[st][1]);fe.push(tt),fe.push(ft),fe.push(0),st>0&&(lt+=Ne?(qe*ft-tt*it)/2:Math.sqrt(Math.pow(tt-qe,2)+Math.pow(ft-it,2))),qe=tt,it=ft}var St=fe.length-3;fe[2]=1,Ie(fe,0,St,ke),fe[St+2]=1,fe.size=Math.abs(lt),fe.start=0,fe.end=fe.size}function ut($e,fe,ke,Ne){for(var qe=0;qe<$e.length;qe++){var it=[];at($e[qe],it,ke,Ne),fe.push(it)}}function mt($e){return $e/360+.5}function Tt($e){var fe=Math.sin($e*Math.PI/180),ke=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return ke<0?0:ke>1?1:ke}function Rt($e,fe,ke,Ne,qe,it,lt,st){if(Ne/=fe,it>=(ke/=fe)&&lt<Ne)return $e;if(lt<ke||it>=Ne)return null;for(var tt=[],ft=0;ft<$e.length;ft++){var St=$e[ft],Lt=St.geometry,It=St.type,si=qe===0?St.minX:St.minY,Zt=qe===0?St.maxX:St.maxY;if(si>=ke&&Zt<Ne)tt.push(St);else if(!(Zt<ke||si>=Ne)){var ui=[];if(It==="Point"||It==="MultiPoint")pt(Lt,ui,ke,Ne,qe);else if(It==="LineString")Ct(Lt,ui,ke,Ne,qe,!1,st.lineMetrics);else if(It==="MultiLineString")ri(Lt,ui,ke,Ne,qe,!1);else if(It==="Polygon")ri(Lt,ui,ke,Ne,qe,!0);else if(It==="MultiPolygon")for(var gi=0;gi<Lt.length;gi++){var zi=[];ri(Lt[gi],zi,ke,Ne,qe,!0),zi.length&&ui.push(zi)}if(ui.length){if(st.lineMetrics&&It==="LineString"){for(gi=0;gi<ui.length;gi++)tt.push(Re(St.id,It,ui[gi],St.tags));continue}It!=="LineString"&&It!=="MultiLineString"||(ui.length===1?(It="LineString",ui=ui[0]):It="MultiLineString"),It!=="Point"&&It!=="MultiPoint"||(It=ui.length===3?"Point":"MultiPoint"),tt.push(Re(St.id,It,ui,St.tags))}}}return tt.length?tt:null}function pt($e,fe,ke,Ne,qe){for(var it=0;it<$e.length;it+=3){var lt=$e[it+qe];lt>=ke&&lt<=Ne&&(fe.push($e[it]),fe.push($e[it+1]),fe.push($e[it+2]))}}function Ct($e,fe,ke,Ne,qe,it,lt){for(var st,tt,ft=Et($e),St=qe===0?Vt:Ji,Lt=$e.start,It=0;It<$e.length-3;It+=3){var si=$e[It],Zt=$e[It+1],ui=$e[It+2],gi=$e[It+3],zi=$e[It+4],yi=qe===0?si:Zt,Si=qe===0?gi:zi,Ni=!1;lt&&(st=Math.sqrt(Math.pow(si-gi,2)+Math.pow(Zt-zi,2))),yi<ke?Si>ke&&(tt=St(ft,si,Zt,gi,zi,ke),lt&&(ft.start=Lt+st*tt)):yi>Ne?Si<Ne&&(tt=St(ft,si,Zt,gi,zi,Ne),lt&&(ft.start=Lt+st*tt)):ci(ft,si,Zt,ui),Si<ke&&yi>=ke&&(tt=St(ft,si,Zt,gi,zi,ke),Ni=!0),Si>Ne&&yi<=Ne&&(tt=St(ft,si,Zt,gi,zi,Ne),Ni=!0),!it&&Ni&&(lt&&(ft.end=Lt+st*tt),fe.push(ft),ft=Et($e)),lt&&(Lt+=st)}var Li=$e.length-3;si=$e[Li],Zt=$e[Li+1],ui=$e[Li+2],(yi=qe===0?si:Zt)>=ke&&yi<=Ne&&ci(ft,si,Zt,ui),Li=ft.length-3,it&&Li>=3&&(ft[Li]!==ft[0]||ft[Li+1]!==ft[1])&&ci(ft,ft[0],ft[1],ft[2]),ft.length&&fe.push(ft)}function Et($e){var fe=[];return fe.size=$e.size,fe.start=$e.start,fe.end=$e.end,fe}function ri($e,fe,ke,Ne,qe,it){for(var lt=0;lt<$e.length;lt++)Ct($e[lt],fe,ke,Ne,qe,it,!1)}function ci($e,fe,ke,Ne){$e.push(fe),$e.push(ke),$e.push(Ne)}function Vt($e,fe,ke,Ne,qe,it){var lt=(it-fe)/(Ne-fe);return $e.push(it),$e.push(ke+(qe-ke)*lt),$e.push(1),lt}function Ji($e,fe,ke,Ne,qe,it){var lt=(it-ke)/(qe-ke);return $e.push(fe+(Ne-fe)*lt),$e.push(it),$e.push(1),lt}function Vi($e,fe){for(var ke=[],Ne=0;Ne<$e.length;Ne++){var qe,it=$e[Ne],lt=it.type;if(lt==="Point"||lt==="MultiPoint"||lt==="LineString")qe=ar(it.geometry,fe);else if(lt==="MultiLineString"||lt==="Polygon"){qe=[];for(var st=0;st<it.geometry.length;st++)qe.push(ar(it.geometry[st],fe))}else if(lt==="MultiPolygon")for(qe=[],st=0;st<it.geometry.length;st++){for(var tt=[],ft=0;ft<it.geometry[st].length;ft++)tt.push(ar(it.geometry[st][ft],fe));qe.push(tt)}ke.push(Re(it.id,lt,qe,it.tags))}return ke}function ar($e,fe){var ke=[];ke.size=$e.size,$e.start!==void 0&&(ke.start=$e.start,ke.end=$e.end);for(var Ne=0;Ne<$e.length;Ne+=3)ke.push($e[Ne]+fe,$e[Ne+1],$e[Ne+2]);return ke}function Tr($e,fe){if($e.transformed)return $e;var ke,Ne,qe,it=1<<$e.z,lt=$e.x,st=$e.y;for(ke=0;ke<$e.features.length;ke++){var tt=$e.features[ke],ft=tt.geometry,St=tt.type;if(tt.geometry=[],St===1)for(Ne=0;Ne<ft.length;Ne+=2)tt.geometry.push(Xi(ft[Ne],ft[Ne+1],fe,it,lt,st));else for(Ne=0;Ne<ft.length;Ne++){var Lt=[];for(qe=0;qe<ft[Ne].length;qe+=2)Lt.push(Xi(ft[Ne][qe],ft[Ne][qe+1],fe,it,lt,st));tt.geometry.push(Lt)}}return $e.transformed=!0,$e}function Xi($e,fe,ke,Ne,qe,it){return[Math.round(ke*($e*Ne-qe)),Math.round(ke*(fe*Ne-it))]}function ht($e,fe,ke,Ne,qe){for(var it=fe===qe.maxZoom?0:qe.tolerance/((1<<fe)*qe.extent),lt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ke,y:Ne,z:fe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},st=0;st<$e.length;st++){lt.numFeatures++,xt(lt,$e[st],it,qe);var tt=$e[st].minX,ft=$e[st].minY,St=$e[st].maxX,Lt=$e[st].maxY;tt<lt.minX&&(lt.minX=tt),ft<lt.minY&&(lt.minY=ft),St>lt.maxX&&(lt.maxX=St),Lt>lt.maxY&&(lt.maxY=Lt)}return lt}function xt($e,fe,ke,Ne){var qe=fe.geometry,it=fe.type,lt=[];if(it==="Point"||it==="MultiPoint")for(var st=0;st<qe.length;st+=3)lt.push(qe[st]),lt.push(qe[st+1]),$e.numPoints++,$e.numSimplified++;else if(it==="LineString")At(lt,qe,$e,ke,!1,!1);else if(it==="MultiLineString"||it==="Polygon")for(st=0;st<qe.length;st++)At(lt,qe[st],$e,ke,it==="Polygon",st===0);else if(it==="MultiPolygon")for(var tt=0;tt<qe.length;tt++){var ft=qe[tt];for(st=0;st<ft.length;st++)At(lt,ft[st],$e,ke,!0,st===0)}if(lt.length){var St=fe.tags||null;if(it==="LineString"&&Ne.lineMetrics){for(var Lt in St={},fe.tags)St[Lt]=fe.tags[Lt];St.mapbox_clip_start=qe.start/qe.size,St.mapbox_clip_end=qe.end/qe.size}var It={geometry:lt,type:it==="Polygon"||it==="MultiPolygon"?3:it==="LineString"||it==="MultiLineString"?2:1,tags:St};fe.id!==null&&(It.id=fe.id),$e.features.push(It)}}function At($e,fe,ke,Ne,qe,it){var lt=Ne*Ne;if(Ne>0&&fe.size<(qe?lt:Ne))ke.numPoints+=fe.length/3;else{for(var st=[],tt=0;tt<fe.length;tt+=3)(Ne===0||fe[tt+2]>lt)&&(ke.numSimplified++,st.push(fe[tt]),st.push(fe[tt+1])),ke.numPoints++;qe&&function(ft,St){for(var Lt=0,It=0,si=ft.length,Zt=si-2;It<si;Zt=It,It+=2)Lt+=(ft[It]-ft[Zt])*(ft[It+1]+ft[Zt+1]);if(Lt>0===St)for(It=0,si=ft.length;It<si/2;It+=2){var ui=ft[It],gi=ft[It+1];ft[It]=ft[si-2-It],ft[It+1]=ft[si-1-It],ft[si-2-It]=ui,ft[si-1-It]=gi}}(st,it),$e.push(st)}}function Nt($e,fe){var ke=(fe=this.options=function(qe,it){for(var lt in it)qe[lt]=it[lt];return qe}(Object.create(this.options),fe)).debug;if(ke&&console.time("preprocess data"),fe.maxZoom<0||fe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(fe.promoteId&&fe.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ne=function(qe,it){var lt=[];if(qe.type==="FeatureCollection")for(var st=0;st<qe.features.length;st++)Ke(lt,qe.features[st],it,st);else Ke(lt,qe.type==="Feature"?qe:{geometry:qe},it);return lt}($e,fe);this.tiles={},this.tileCoords=[],ke&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",fe.indexMaxZoom,fe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ne=function(qe,it){var lt=it.buffer/it.extent,st=qe,tt=Rt(qe,1,-1-lt,lt,0,-1,2,it),ft=Rt(qe,1,1-lt,2+lt,0,-1,2,it);return(tt||ft)&&(st=Rt(qe,1,-lt,1+lt,0,-1,2,it)||[],tt&&(st=Vi(tt,1).concat(st)),ft&&(st=st.concat(Vi(ft,-1)))),st}(Ne,fe),Ne.length&&this.splitTile(Ne,0,0,0),ke&&(Ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Wt($e,fe,ke){return 32*((1<<$e)*ke+fe)+$e}function mi($e,fe){const ke=$e.tileID.canonical;if(!this._geoJSONIndex)return fe(null,null);const Ne=this._geoJSONIndex.getTile(ke.z,ke.x,ke.y);if(!Ne)return fe(null,null);const qe=new M(Ne.features);let it=z.exports(qe);it.byteOffset===0&&it.byteLength===it.buffer.byteLength||(it=new Uint8Array(it)),fe(null,{vectorTile:qe,rawData:it.buffer})}Nt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Nt.prototype.splitTile=function($e,fe,ke,Ne,qe,it,lt){for(var st=[$e,fe,ke,Ne],tt=this.options,ft=tt.debug;st.length;){Ne=st.pop(),ke=st.pop(),fe=st.pop(),$e=st.pop();var St=1<<fe,Lt=Wt(fe,ke,Ne),It=this.tiles[Lt];if(!It&&(ft>1&&console.time("creation"),It=this.tiles[Lt]=ht($e,fe,ke,Ne,tt),this.tileCoords.push({z:fe,x:ke,y:Ne}),ft)){ft>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",fe,ke,Ne,It.numFeatures,It.numPoints,It.numSimplified),console.timeEnd("creation"));var si="z"+fe;this.stats[si]=(this.stats[si]||0)+1,this.total++}if(It.source=$e,qe){if(fe===tt.maxZoom||fe===qe)continue;var Zt=1<<qe-fe;if(ke!==Math.floor(it/Zt)||Ne!==Math.floor(lt/Zt))continue}else if(fe===tt.indexMaxZoom||It.numPoints<=tt.indexMaxPoints)continue;if(It.source=null,$e.length!==0){ft>1&&console.time("clipping");var ui,gi,zi,yi,Si,Ni,Li=.5*tt.buffer/tt.extent,rr=.5-Li,Ar=.5+Li,Jr=1+Li;ui=gi=zi=yi=null,Si=Rt($e,St,ke-Li,ke+Ar,0,It.minX,It.maxX,tt),Ni=Rt($e,St,ke+rr,ke+Jr,0,It.minX,It.maxX,tt),$e=null,Si&&(ui=Rt(Si,St,Ne-Li,Ne+Ar,1,It.minY,It.maxY,tt),gi=Rt(Si,St,Ne+rr,Ne+Jr,1,It.minY,It.maxY,tt),Si=null),Ni&&(zi=Rt(Ni,St,Ne-Li,Ne+Ar,1,It.minY,It.maxY,tt),yi=Rt(Ni,St,Ne+rr,Ne+Jr,1,It.minY,It.maxY,tt),Ni=null),ft>1&&console.timeEnd("clipping"),st.push(ui||[],fe+1,2*ke,2*Ne),st.push(gi||[],fe+1,2*ke,2*Ne+1),st.push(zi||[],fe+1,2*ke+1,2*Ne),st.push(yi||[],fe+1,2*ke+1,2*Ne+1)}}},Nt.prototype.getTile=function($e,fe,ke){var Ne=this.options,qe=Ne.extent,it=Ne.debug;if($e<0||$e>24)return null;var lt=1<<$e,st=Wt($e,fe=(fe%lt+lt)%lt,ke);if(this.tiles[st])return Tr(this.tiles[st],qe);it>1&&console.log("drilling down to z%d-%d-%d",$e,fe,ke);for(var tt,ft=$e,St=fe,Lt=ke;!tt&&ft>0;)ft--,St=Math.floor(St/2),Lt=Math.floor(Lt/2),tt=this.tiles[Wt(ft,St,Lt)];return tt&&tt.source?(it>1&&console.log("found parent tile z%d-%d-%d",ft,St,Lt),it>1&&console.time("drilling down"),this.splitTile(tt.source,ft,St,Lt,$e,fe,ke),it>1&&console.timeEnd("drilling down"),this.tiles[st]?Tr(this.tiles[st],qe):null):null};class Di extends S{constructor(fe,ke,Ne,qe){super(fe,ke,Ne,mi),qe&&(this.loadGeoJSON=qe)}loadData(fe,ke){var Ne;(Ne=this._pendingRequest)===null||Ne===void 0||Ne.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const qe=!!(fe&&fe.request&&fe.request.collectResourceTiming)&&new s.RequestPerformance(fe.request);this._pendingCallback=ke,this._pendingRequest=this.loadGeoJSON(fe,(it,lt)=>{if(delete this._pendingCallback,delete this._pendingRequest,it||!lt)return ke(it);if(typeof lt!="object")return ke(new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`));{A(lt,!0);try{if(fe.filter){const tt=s.createExpression(fe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(tt.result==="error")throw new Error(tt.value.map(St=>`${St.key}: ${St.message}`).join(", "));lt={type:"FeatureCollection",features:lt.features.filter(St=>tt.value.evaluate({zoom:0},St))}}this._geoJSONIndex=fe.cluster?new ce(function({superclusterOptions:tt,clusterProperties:ft}){if(!ft||!tt)return tt;const St={},Lt={},It={accumulated:null,zoom:0},si={properties:null},Zt=Object.keys(ft);for(const ui of Zt){const[gi,zi]=ft[ui],yi=s.createExpression(zi),Si=s.createExpression(typeof gi=="string"?[gi,["accumulated"],["get",ui]]:gi);St[ui]=yi.value,Lt[ui]=Si.value}return tt.map=ui=>{si.properties=ui;const gi={};for(const zi of Zt)gi[zi]=St[zi].evaluate(It,si);return gi},tt.reduce=(ui,gi)=>{si.properties=gi;for(const zi of Zt)It.accumulated=ui[zi],ui[zi]=Lt[zi].evaluate(It,si)},tt}(fe)).load(lt.features):function(tt,ft){return new Nt(tt,ft)}(lt,fe.geojsonVtOptions)}catch(tt){return ke(tt)}this.loaded={};const st={};if(qe){const tt=qe.finish();tt&&(st.resourceTiming={},st.resourceTiming[fe.source]=JSON.parse(JSON.stringify(tt)))}ke(null,st)}})}reloadTile(fe,ke){const Ne=this.loaded;return Ne&&Ne[fe.uid]?super.reloadTile(fe,ke):this.loadTile(fe,ke)}loadGeoJSON(fe,ke){if(fe.request)return s.getJSON(fe.request,ke);if(typeof fe.data=="string")try{ke(null,JSON.parse(fe.data))}catch{ke(new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`))}else ke(new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(fe,ke){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ke()}getClusterExpansionZoom(fe,ke){try{ke(null,this._geoJSONIndex.getClusterExpansionZoom(fe.clusterId))}catch(Ne){ke(Ne)}}getClusterChildren(fe,ke){try{ke(null,this._geoJSONIndex.getChildren(fe.clusterId))}catch(Ne){ke(Ne)}}getClusterLeaves(fe,ke){try{ke(null,this._geoJSONIndex.getLeaves(fe.clusterId,fe.limit,fe.offset))}catch(Ne){ke(Ne)}}}class hi{constructor(fe){this.self=fe,this.actor=new s.Actor(fe,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:S,geojson:Di},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ke,Ne)=>{if(this.workerSourceTypes[ke])throw new Error(`Worker source with name "${ke}" already registered.`);this.workerSourceTypes[ke]=Ne},this.self.registerRTLTextPlugin=ke=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=ke.applyArabicShaping,s.plugin.processBidirectionalText=ke.processBidirectionalText,s.plugin.processStyledBidirectionalText=ke.processStyledBidirectionalText}}setReferrer(fe,ke){this.referrer=ke}setImages(fe,ke,Ne){this.availableImages[fe]=ke;for(const qe in this.workerSources[fe]){const it=this.workerSources[fe][qe];for(const lt in it)it[lt].availableImages=ke}Ne()}setLayers(fe,ke,Ne){this.getLayerIndex(fe).replace(ke),Ne()}updateLayers(fe,ke,Ne){this.getLayerIndex(fe).update(ke.layers,ke.removedIds),Ne()}loadTile(fe,ke,Ne){this.getWorkerSource(fe,ke.type,ke.source).loadTile(ke,Ne)}loadDEMTile(fe,ke,Ne){this.getDEMWorkerSource(fe,ke.source).loadTile(ke,Ne)}reloadTile(fe,ke,Ne){this.getWorkerSource(fe,ke.type,ke.source).reloadTile(ke,Ne)}abortTile(fe,ke,Ne){this.getWorkerSource(fe,ke.type,ke.source).abortTile(ke,Ne)}removeTile(fe,ke,Ne){this.getWorkerSource(fe,ke.type,ke.source).removeTile(ke,Ne)}removeDEMTile(fe,ke){this.getDEMWorkerSource(fe,ke.source).removeTile(ke)}removeSource(fe,ke,Ne){if(!this.workerSources[fe]||!this.workerSources[fe][ke.type]||!this.workerSources[fe][ke.type][ke.source])return;const qe=this.workerSources[fe][ke.type][ke.source];delete this.workerSources[fe][ke.type][ke.source],qe.removeSource!==void 0?qe.removeSource(ke,Ne):Ne()}loadWorkerSource(fe,ke,Ne){try{this.self.importScripts(ke.url),Ne()}catch(qe){Ne(qe.toString())}}syncRTLPluginState(fe,ke,Ne){try{s.plugin.setState(ke);const qe=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&qe!=null){this.self.importScripts(qe);const it=s.plugin.isParsed();Ne(it?void 0:new Error(`RTL Text Plugin failed to import scripts from ${qe}`),it)}}catch(qe){Ne(qe.toString())}}getAvailableImages(fe){let ke=this.availableImages[fe];return ke||(ke=[]),ke}getLayerIndex(fe){let ke=this.layerIndexes[fe];return ke||(ke=this.layerIndexes[fe]=new x),ke}getWorkerSource(fe,ke,Ne){if(this.workerSources[fe]||(this.workerSources[fe]={}),this.workerSources[fe][ke]||(this.workerSources[fe][ke]={}),!this.workerSources[fe][ke][Ne]){const qe={send:(it,lt,st)=>{this.actor.send(it,lt,st,fe)}};this.workerSources[fe][ke][Ne]=new this.workerSourceTypes[ke](qe,this.getLayerIndex(fe),this.getAvailableImages(fe))}return this.workerSources[fe][ke][Ne]}getDEMWorkerSource(fe,ke){return this.demWorkerSources[fe]||(this.demWorkerSources[fe]={}),this.demWorkerSources[fe][ke]||(this.demWorkerSources[fe][ke]=new k),this.demWorkerSources[fe][ke]}enforceCacheSizeLimit(fe,ke){s.enforceCacheSizeLimit(ke)}}return s.isWorker()&&(self.worker=new hi(self)),hi}),h(["./shared"],function(s){var f=b;function b(T){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var m,C,N=new Blob([""],{type:"text/javascript"}),ee=URL.createObjectURL(N);try{C=new Worker(ee),m=!0}catch{m=!1}return C&&C.terminate(),URL.revokeObjectURL(ee),m}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var m=document.createElement("canvas");m.width=m.height=1;var C=m.getContext("2d");if(!C)return!1;var N=C.getImageData(0,0,1,1);return N&&N.width===m.width}()?(x[u=r&&r.failIfMajorPerformanceCaveat]===void 0&&(x[u]=function(m){var C,N=function(ee){var le=document.createElement("canvas"),de=Object.create(b.webGLContextAttributes);return de.failIfMajorPerformanceCaveat=ee,le.getContext("webgl",de)||le.getContext("experimental-webgl",de)}(m);if(!N)return!1;try{C=N.createShader(N.VERTEX_SHADER)}catch{return!1}return!(!C||N.isContextLost())&&(N.shaderSource(C,"void main() {}"),N.compileShader(C),N.getShaderParameter(C,N.COMPILE_STATUS)===!0)}(u)),x[u]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var u}(T)}var x={};function v(T,r){if(Array.isArray(T)){if(!Array.isArray(r)||T.length!==r.length)return!1;for(let u=0;u<T.length;u++)if(!v(T[u],r[u]))return!1;return!0}if(typeof T=="object"&&T!==null&&r!==null){if(typeof r!="object"||Object.keys(T).length!==Object.keys(r).length)return!1;for(const u in T)if(!v(T[u],r[u]))return!1;return!0}return T===r}b.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class g{static testProp(r){if(!g.docStyle)return r[0];for(let u=0;u<r.length;u++)if(r[u]in g.docStyle)return r[u];return r[0]}static create(r,u,m){const C=window.document.createElement(r);return u!==void 0&&(C.className=u),m&&m.appendChild(C),C}static createNS(r,u){return window.document.createElementNS(r,u)}static disableDrag(){g.docStyle&&g.selectProp&&(g.userSelect=g.docStyle[g.selectProp],g.docStyle[g.selectProp]="none")}static enableDrag(){g.docStyle&&g.selectProp&&(g.docStyle[g.selectProp]=g.userSelect)}static setTransform(r,u){r.style[g.transformProp]=u}static addEventListener(r,u,m,C={}){r.addEventListener(u,m,"passive"in C?C:C.capture)}static removeEventListener(r,u,m,C={}){r.removeEventListener(u,m,"passive"in C?C:C.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",g.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",g.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",g.suppressClickInternal,!0)},0)}static mousePos(r,u){const m=r.getBoundingClientRect();return new s.pointGeometry(u.clientX-m.left-r.clientLeft,u.clientY-m.top-r.clientTop)}static touchPos(r,u){const m=r.getBoundingClientRect(),C=[];for(let N=0;N<u.length;N++)C.push(new s.pointGeometry(u[N].clientX-m.left-r.clientLeft,u[N].clientY-m.top-r.clientTop));return C}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}}g.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,g.selectProp=g.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),g.transformProp=g.testProp(["transform","WebkitTransform"]);class P{constructor(r){this._transformRequestFn=r}transformRequest(r,u){return this._transformRequestFn&&this._transformRequestFn(r,u)||{url:r}}normalizeSpriteURL(r,u,m){const C=function(N){const ee=N.match(_);if(!ee)throw new Error(`Unable to parse URL "${N}"`);return{protocol:ee[1],authority:ee[2],path:ee[3]||"/",params:ee[4]?ee[4].split("&"):[]}}(r);return C.path+=`${u}${m}`,function(N){const ee=N.params.length?`?${N.params.join("&")}`:"";return`${N.protocol}://${N.authority}${N.path}${ee}`}(C)}setTransformRequest(r){this._transformRequestFn=r}}const _=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class S{constructor(r,u,m,C){this.context=r,this.format=m,this.texture=r.gl.createTexture(),this.update(u,C)}update(r,u,m){const{width:C,height:N}=r,ee=!(this.size&&this.size[0]===C&&this.size[1]===N||m),{context:le}=this,{gl:de}=le;if(this.useMipmap=!!(u&&u.useMipmap),de.bindTexture(de.TEXTURE_2D,this.texture),le.pixelStoreUnpackFlipY.set(!1),le.pixelStoreUnpack.set(1),le.pixelStoreUnpackPremultiplyAlpha.set(this.format===de.RGBA&&(!u||u.premultiply!==!1)),ee)this.size=[C,N],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||s.isImageBitmap(r)?de.texImage2D(de.TEXTURE_2D,0,this.format,this.format,de.UNSIGNED_BYTE,r):de.texImage2D(de.TEXTURE_2D,0,this.format,C,N,0,this.format,de.UNSIGNED_BYTE,r.data);else{const{x:be,y:Ae}=m||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||s.isImageBitmap(r)?de.texSubImage2D(de.TEXTURE_2D,0,be,Ae,de.RGBA,de.UNSIGNED_BYTE,r):de.texSubImage2D(de.TEXTURE_2D,0,be,Ae,C,N,de.RGBA,de.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&de.generateMipmap(de.TEXTURE_2D)}bind(r,u,m){const{context:C}=this,{gl:N}=C;N.bindTexture(N.TEXTURE_2D,this.texture),m!==N.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(m=N.LINEAR),r!==this.filter&&(N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,r),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,m||r),this.filter=r),u!==this.wrap&&(N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_S,u),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}function k(T){const{userImage:r}=T;return!!(r&&r.render&&r.render())&&(T.data.replace(new Uint8Array(r.data.buffer)),!0)}class A extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:u,callback:m}of this.requestors)this._notify(u,m);this.requestors=[]}}getImage(r){return this.images[r]}addImage(r,u){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,u)&&(this.images[r]=u)}_validate(r,u){let m=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),m=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),m=!1),this._validateContent(u.content,u)||(this.fire(new s.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),m=!1),m}_validateStretch(r,u){if(!r)return!0;let m=0;for(const C of r){if(C[0]<m||C[1]<C[0]||u<C[1])return!1;m=C[1]}return!0}_validateContent(r,u){return!(r&&(r.length!==4||r[0]<0||u.data.width<r[0]||r[1]<0||u.data.height<r[1]||r[2]<0||u.data.width<r[2]||r[3]<0||u.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,u){const m=this.images[r];if(m.data.width!==u.data.width||m.data.height!==u.data.height)throw new Error(`size mismatch between old image (${m.data.width}x${m.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=m.version+1,this.images[r]=u,this.updatedImages[r]=!0}removeImage(r){const u=this.images[r];delete this.images[r],delete this.patterns[r],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,u){let m=!0;if(!this.isLoaded())for(const C of r)this.images[C]||(m=!1);this.isLoaded()||m?this._notify(r,u):this.requestors.push({ids:r,callback:u})}_notify(r,u){const m={};for(const C of r){this.images[C]||this.fire(new s.Event("styleimagemissing",{id:C}));const N=this.images[C];N?m[C]={data:N.data.clone(),pixelRatio:N.pixelRatio,sdf:N.sdf,version:N.version,stretchX:N.stretchX,stretchY:N.stretchY,content:N.content,hasRenderCallback:!!(N.userImage&&N.userImage.render)}:s.warnOnce(`Image "${C}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,m)}getPixelSize(){const{width:r,height:u}=this.atlasImage;return{width:r,height:u}}getPattern(r){const u=this.patterns[r],m=this.getImage(r);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{const C={w:m.data.width+2,h:m.data.height+2,x:0,y:0},N=new s.ImagePosition(C,m);this.patterns[r]={bin:C,position:N}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const u=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new S(r,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const N in this.patterns)r.push(this.patterns[N].bin);const{w:u,h:m}=s.potpack(r),C=this.atlasImage;C.resize({width:u||1,height:m||1});for(const N in this.patterns){const{bin:ee}=this.patterns[N],le=ee.x+1,de=ee.y+1,be=this.images[N].data,Ae=be.width,ze=be.height;s.RGBAImage.copy(be,C,{x:0,y:0},{x:le,y:de},{width:Ae,height:ze}),s.RGBAImage.copy(be,C,{x:0,y:ze-1},{x:le,y:de-1},{width:Ae,height:1}),s.RGBAImage.copy(be,C,{x:0,y:0},{x:le,y:de+ze},{width:Ae,height:1}),s.RGBAImage.copy(be,C,{x:Ae-1,y:0},{x:le-1,y:de},{width:1,height:ze}),s.RGBAImage.copy(be,C,{x:0,y:0},{x:le+Ae,y:de},{width:1,height:ze})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const u of r){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const m=this.images[u];m||s.warnOnce(`Image with ID: "${u}" was not found`),k(m)&&this.updateImage(u,m)}}}const y=1e20;function I(T,r,u,m,C,N,ee,le,de){for(let be=r;be<r+m;be++)D(T,u*N+be,N,C,ee,le,de);for(let be=u;be<u+C;be++)D(T,be*N+r,1,m,ee,le,de)}function D(T,r,u,m,C,N,ee){N[0]=0,ee[0]=-1e20,ee[1]=y,C[0]=T[r];for(let le=1,de=0,be=0;le<m;le++){C[le]=T[r+le*u];const Ae=le*le;do{const ze=N[de];be=(C[le]-C[ze]+Ae-ze*ze)/(le-ze)/2}while(be<=ee[de]&&--de>-1);de++,N[de]=le,ee[de]=be,ee[de+1]=y}for(let le=0,de=0;le<m;le++){for(;ee[de+1]<le;)de++;const be=N[de],Ae=le-be;T[r+le*u]=C[be]+Ae*Ae}}class w{constructor(r,u){this.requestManager=r,this.localIdeographFontFamily=u,this.entries={}}setURL(r){this.url=r}getGlyphs(r,u){const m=[];for(const C in r)for(const N of r[C])m.push({stack:C,id:N});s.asyncAll(m,({stack:C,id:N},ee)=>{let le=this.entries[C];le||(le=this.entries[C]={glyphs:{},requests:{},ranges:{}});let de=le.glyphs[N];if(de!==void 0)return void ee(null,{stack:C,id:N,glyph:de});if(de=this._tinySDF(le,C,N),de)return le.glyphs[N]=de,void ee(null,{stack:C,id:N,glyph:de});const be=Math.floor(N/256);if(256*be>65535)return void ee(new Error("glyphs > 65535 not supported"));if(le.ranges[be])return void ee(null,{stack:C,id:N,glyph:de});let Ae=le.requests[be];Ae||(Ae=le.requests[be]=[],w.loadGlyphRange(C,be,this.url,this.requestManager,(ze,Ge)=>{if(Ge){for(const et in Ge)this._doesCharSupportLocalGlyph(+et)||(le.glyphs[+et]=Ge[+et]);le.ranges[be]=!0}for(const et of Ae)et(ze,Ge);delete le.requests[be]})),Ae.push((ze,Ge)=>{ze?ee(ze):Ge&&ee(null,{stack:C,id:N,glyph:Ge[N]||null})})},(C,N)=>{if(C)u(C);else if(N){const ee={};for(const{stack:le,id:de,glyph:be}of N)(ee[le]||(ee[le]={}))[de]=be&&{id:be.id,bitmap:be.bitmap.clone(),metrics:be.metrics};u(null,ee)}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&(s.unicodeBlockLookup["CJK Unified Ideographs"](r)||s.unicodeBlockLookup["Hangul Syllables"](r)||s.unicodeBlockLookup.Hiragana(r)||s.unicodeBlockLookup.Katakana(r))}_tinySDF(r,u,m){const C=this.localIdeographFontFamily;if(!C||!this._doesCharSupportLocalGlyph(m))return;let N=r.tinySDF;if(!N){let le="400";/bold/i.test(u)?le="900":/medium/i.test(u)?le="500":/light/i.test(u)&&(le="200"),N=r.tinySDF=new w.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:C,fontWeight:le})}const ee=N.draw(String.fromCharCode(m));return{id:m,bitmap:new s.AlphaImage({width:ee.width||30,height:ee.height||30},ee.data),metrics:{width:ee.glyphWidth||24,height:ee.glyphHeight||24,left:ee.glyphLeft||0,top:ee.glyphTop-27||-8,advance:ee.glyphAdvance||24}}}}w.loadGlyphRange=function(T,r,u,m,C){const N=256*r,ee=N+255,le=m.transformRequest(u.replace("{fontstack}",T).replace("{range}",`${N}-${ee}`),s.ResourceType.Glyphs);s.getArrayBuffer(le,(de,be)=>{if(de)C(de);else if(be){const Ae={};for(const ze of s.parseGlyphPbf(be))Ae[ze.id]=ze;C(null,Ae)}})},w.TinySDF=class{constructor({fontSize:T=24,buffer:r=3,radius:u=8,cutoff:m=.25,fontFamily:C="sans-serif",fontWeight:N="normal",fontStyle:ee="normal"}={}){this.buffer=r,this.cutoff=m,this.radius=u;const le=this.size=T+4*r,de=this._createCanvas(le),be=this.ctx=de.getContext("2d",{willReadFrequently:!0});be.font=`${ee} ${N} ${T}px ${C}`,be.textBaseline="alphabetic",be.textAlign="left",be.fillStyle="black",this.gridOuter=new Float64Array(le*le),this.gridInner=new Float64Array(le*le),this.f=new Float64Array(le),this.z=new Float64Array(le+1),this.v=new Uint16Array(le)}_createCanvas(T){const r=document.createElement("canvas");return r.width=r.height=T,r}draw(T){const{width:r,actualBoundingBoxAscent:u,actualBoundingBoxDescent:m,actualBoundingBoxLeft:C,actualBoundingBoxRight:N}=this.ctx.measureText(T),ee=Math.ceil(u),le=Math.min(this.size-this.buffer,Math.ceil(N-C)),de=Math.min(this.size-this.buffer,ee+Math.ceil(m)),be=le+2*this.buffer,Ae=de+2*this.buffer,ze=Math.max(be*Ae,0),Ge=new Uint8ClampedArray(ze),et={data:Ge,width:be,height:Ae,glyphWidth:le,glyphHeight:de,glyphTop:ee,glyphLeft:0,glyphAdvance:r};if(le===0||de===0)return et;const{ctx:Qe,buffer:Je,gridInner:dt,gridOuter:gt}=this;Qe.clearRect(Je,Je,le,de),Qe.fillText(T,Je,Je+ee);const vt=Qe.getImageData(Je,Je,le,de);gt.fill(y,0,ze),dt.fill(0,0,ze);for(let nt=0;nt<de;nt++)for(let kt=0;kt<le;kt++){const _t=vt.data[4*(nt*le+kt)+3]/255;if(_t===0)continue;const Ot=(nt+Je)*be+kt+Je;if(_t===1)gt[Ot]=0,dt[Ot]=y;else{const zt=.5-_t;gt[Ot]=zt>0?zt*zt:0,dt[Ot]=zt<0?zt*zt:0}}I(gt,0,0,be,Ae,be,this.f,this.v,this.z),I(dt,Je,Je,le,de,be,this.f,this.v,this.z);for(let nt=0;nt<ze;nt++){const kt=Math.sqrt(gt[nt])-Math.sqrt(dt[nt]);Ge[nt]=Math.round(255-255*(kt/this.radius+this.cutoff))}return et}};const M=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(T,r){return s.sphericalToCartesian(T.expression.evaluate(r))}interpolate(T,r,u){return{x:s.number(T.x,r.x,u),y:s.number(T.y,r.y,u),z:s.number(T.z,r.z,u)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),z="-transition";class Y extends s.Evented{constructor(r){super(),this._transitionable=new s.Transitionable(M),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,u={}){if(!this._validate(s.validateLight,r,u))for(const m in r){const C=r[m];m.endsWith(z)?this._transitionable.setTransition(m.slice(0,-z.length),C):this._transitionable.setValue(m,C)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,m){return(!m||m.validate!==!1)&&s.emitValidationErrors(this,r.call(s.validateStyle,s.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class X{constructor(r,u){this.width=r,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,u){const m=r.join(",")+String(u);return this.dashEntry[m]||(this.dashEntry[m]=this.addDash(r,u)),this.dashEntry[m]}getDashRanges(r,u,m){const C=[];let N=r.length%2==1?-r[r.length-1]*m:0,ee=r[0]*m,le=!0;C.push({left:N,right:ee,isDash:le,zeroLength:r[0]===0});let de=r[0];for(let be=1;be<r.length;be++){le=!le;const Ae=r[be];N=de*m,de+=Ae,ee=de*m,C.push({left:N,right:ee,isDash:le,zeroLength:Ae===0})}return C}addRoundDash(r,u,m){const C=u/2;for(let N=-m;N<=m;N++){const ee=this.width*(this.nextRow+m+N);let le=0,de=r[le];for(let be=0;be<this.width;be++){be/de.right>1&&(de=r[++le]);const Ae=Math.abs(be-de.left),ze=Math.abs(be-de.right),Ge=Math.min(Ae,ze);let et;const Qe=N/m*(C+1);if(de.isDash){const Je=C-Math.abs(Qe);et=Math.sqrt(Ge*Ge+Je*Je)}else et=C-Math.sqrt(Ge*Ge+Qe*Qe);this.data[ee+be]=Math.max(0,Math.min(255,et+128))}}}addRegularDash(r){for(let le=r.length-1;le>=0;--le){const de=r[le],be=r[le+1];de.zeroLength?r.splice(le,1):be&&be.isDash===de.isDash&&(be.left=de.left,r.splice(le,1))}const u=r[0],m=r[r.length-1];u.isDash===m.isDash&&(u.left=m.left-this.width,m.right=u.right+this.width);const C=this.width*this.nextRow;let N=0,ee=r[N];for(let le=0;le<this.width;le++){le/ee.right>1&&(ee=r[++N]);const de=Math.abs(le-ee.left),be=Math.abs(le-ee.right),Ae=Math.min(de,be);this.data[C+le]=Math.max(0,Math.min(255,(ee.isDash?Ae:-Ae)+128))}}addDash(r,u){const m=u?7:0,C=2*m+1;if(this.nextRow+C>this.height)return s.warnOnce("LineAtlas out of space"),null;let N=0;for(let le=0;le<r.length;le++)N+=r[le];if(N!==0){const le=this.width/N,de=this.getDashRanges(r,this.width,le);u?this.addRoundDash(de,le,m):this.addRegularDash(de)}const ee={y:(this.nextRow+m+.5)/this.height,height:2*m/this.height,width:N};return this.nextRow+=C,this.dirty=!0,ee}bind(r){const u=r.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}class Z{constructor(r,u){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const m=this.workerPool.acquire(this.id);for(let C=0;C<m.length;C++){const N=new Z.Actor(m[C],u,this.id);N.name=`Worker ${C}`,this.actors.push(N)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,u,m){s.asyncAll(this.actors,(C,N)=>{C.send(r,u,N)},m=m||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function j(T,r,u){const m=function(C,N){if(C)return u(C);if(N){const ee=s.pick(s.extend(N,T),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);N.vector_layers&&(ee.vectorLayers=N.vector_layers,ee.vectorLayerIds=ee.vectorLayers.map(le=>le.id)),u(null,ee)}};return T.url?s.getJSON(r.transformRequest(T.url,s.ResourceType.Source),m):s.exported.frame(()=>m(null,T))}Z.Actor=s.Actor;class V{constructor(r,u,m){this.bounds=s.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=u||0,this.maxzoom=m||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const u=Math.pow(2,r.z),m=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*u),C=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*u),N=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*u),ee=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*u);return r.x>=m&&r.x<N&&r.y>=C&&r.y<ee}}class $ extends s.Evented{constructor(r,u,m,C){if(super(),this.id=r,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(u,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C)}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=j(this._options,this.map._requestManager,(r,u)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),r?this.fire(new s.ErrorEvent(r)):u&&(s.extend(this,u),u.bounds&&(this.tileBounds=new V(u.bounds,this.minzoom,this.maxzoom)),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.cancel(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}loadTile(r,u){const m=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),C={request:this.map._requestManager.transformRequest(m,s.ResourceType.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function N(ee,le){return delete r.request,r.aborted?u(null):ee&&ee.status!==404?u(ee):(le&&le.resourceTiming&&(r.resourceTiming=le.resourceTiming),this.map._refreshExpiredTiles&&le&&r.setExpiryData(le),r.loadVectorData(le,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}C.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired"?r.state==="loading"?r.reloadCallback=u:r.request=r.actor.send("reloadTile",C,N.bind(this)):(r.actor=this.dispatcher.getActor(),r.request=r.actor.send("loadTile",C,N.bind(this)))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id},void 0)}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class R extends s.Evented{constructor(r,u,m,C){super(),this.id=r,this.dispatcher=m,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},u),s.extend(this,s.pick(u,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=j(this._options,this.map._requestManager,(r,u)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new s.ErrorEvent(r)):u&&(s.extend(this,u),u.bounds&&(this.tileBounds=new V(u.bounds,this.minzoom,this.maxzoom)),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,u){const m=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.request=s.getImage(this.map._requestManager.transformRequest(m,s.ResourceType.Tile),(C,N,ee)=>{if(delete r.request,r.aborted)r.state="unloaded",u(null);else if(C)r.state="errored",u(C);else if(N){this.map._refreshExpiredTiles&&r.setExpiryData(ee);const le=this.map.painter.context,de=le.gl;r.texture=this.map.painter.getTileTexture(N.width),r.texture?r.texture.update(N,{useMipmap:!0}):(r.texture=new S(le,N,de.RGBA,{useMipmap:!0}),r.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE,de.LINEAR_MIPMAP_NEAREST),le.extTextureFilterAnisotropic&&de.texParameterf(de.TEXTURE_2D,le.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,le.extTextureFilterAnisotropicMax)),r.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),u(null)}})}abortTile(r,u){r.request&&(r.request.cancel(),delete r.request),u()}unloadTile(r,u){r.texture&&this.map.painter.saveTileTexture(r.texture),u()}hasTransition(){return!1}}let L;class G extends R{constructor(r,u,m,C){super(r,u,m,C),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(r,u){const m=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function C(N,ee){N&&(r.state="errored",u(N)),ee&&(r.dem=ee,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded",u(null))}r.request=s.getImage(this.map._requestManager.transformRequest(m,s.ResourceType.Tile),(function(N,ee){if(delete r.request,r.aborted)r.state="unloaded",u(null);else if(N)r.state="errored",u(N);else if(ee){this.map._refreshExpiredTiles&&r.setExpiryData(ee),delete ee.cacheControl,delete ee.expires;const le=s.isImageBitmap(ee)&&(L==null&&(L=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),L)?ee:s.exported.getImageData(ee,1),de={uid:r.uid,coord:r.tileID,source:this.id,rawImageData:le,encoding:this.encoding};r.actor&&r.state!=="expired"||(r.actor=this.dispatcher.getActor(),r.actor.send("loadDEMTile",de,C.bind(this)))}}).bind(this)),r.neighboringTiles=this._getNeighboringTiles(r.tileID)}_getNeighboringTiles(r){const u=r.canonical,m=Math.pow(2,u.z),C=(u.x-1+m)%m,N=u.x===0?r.wrap-1:r.wrap,ee=(u.x+1+m)%m,le=u.x+1===m?r.wrap+1:r.wrap,de={};return de[new s.OverscaledTileID(r.overscaledZ,N,u.z,C,u.y).key]={backfilled:!1},de[new s.OverscaledTileID(r.overscaledZ,le,u.z,ee,u.y).key]={backfilled:!1},u.y>0&&(de[new s.OverscaledTileID(r.overscaledZ,N,u.z,C,u.y-1).key]={backfilled:!1},de[new s.OverscaledTileID(r.overscaledZ,r.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},de[new s.OverscaledTileID(r.overscaledZ,le,u.z,ee,u.y-1).key]={backfilled:!1}),u.y+1<m&&(de[new s.OverscaledTileID(r.overscaledZ,N,u.z,C,u.y+1).key]={backfilled:!1},de[new s.OverscaledTileID(r.overscaledZ,r.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},de[new s.OverscaledTileID(r.overscaledZ,le,u.z,ee,u.y+1).key]={backfilled:!1}),de}unloadTile(r){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&r.actor.send("removeDEMTile",{uid:r.uid,source:this.id})}}class U extends s.Evented{constructor(r,u,m,C){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=m.getActor(),this.setEventedParent(C),this._data=u.data,this._options=s.extend({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const N=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*N,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*N,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:s.EXTENT,radius:(u.clusterRadius||50)*N,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._updateWorkerData("content"),this}getClusterExpansionZoom(r,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:r,source:this.id},u),this}getClusterChildren(r,u){return this.actor.send("geojson.getClusterChildren",{clusterId:r,source:this.id},u),this}getClusterLeaves(r,u,m,C){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:r,limit:u,offset:m},C),this}_updateWorkerData(r){const u=s.extend({},this.workerOptions),m=this._data;typeof m=="string"?(u.request=this.map._requestManager.transformRequest(s.exported.resolveURL(m),s.ResourceType.Source),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(m),this._pendingLoads++,this.fire(new s.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,u,(C,N)=>{if(this._pendingLoads--,this._removed||N&&N.abandoned)return void this.fire(new s.Event("dataabort",{dataType:"source",sourceDataType:r}));let ee=null;if(N&&N.resourceTiming&&N.resourceTiming[this.id]&&(ee=N.resourceTiming[this.id].slice(0)),C)return void this.fire(new s.ErrorEvent(C));const le={dataType:"source",sourceDataType:r};this._collectResourceTiming&&ee&&ee.length>0&&s.extend(le,{resourceTiming:ee}),this.fire(new s.Event("data",le))})}loaded(){return this._pendingLoads===0}loadTile(r,u){const m=r.actor?"reloadTile":"loadTile";r.actor=this.actor;const C={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request=this.actor.send(m,C,(N,ee)=>(delete r.request,r.unloadVectorData(),r.aborted?u(null):N?u(N):(r.loadVectorData(ee,this.map.painter,m==="reloadTile"),u(null))))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.aborted=!0}unloadTile(r){r.unloadVectorData(),this.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var F=s.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class H extends s.Evented{constructor(r,u,m,C){super(),this.id=r,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=u}load(r,u){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(m,C)=>{this._loaded=!0,m?this.fire(new s.ErrorEvent(m)):C&&(this.image=C,r&&(this.coordinates=r),u&&u(),this._finishLoading())})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this.options.url=r.url,this.load(r.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}setCoordinates(r){this.coordinates=r;const u=r.map(s.MercatorCoordinate.fromLngLat);this.tileID=function(C){let N=1/0,ee=1/0,le=-1/0,de=-1/0;for(const Ge of C)N=Math.min(N,Ge.x),ee=Math.min(ee,Ge.y),le=Math.max(le,Ge.x),de=Math.max(de,Ge.y);const be=Math.max(le-N,de-ee),Ae=Math.max(0,Math.floor(-Math.log(be)/Math.LN2)),ze=Math.pow(2,Ae);return new s.CanonicalTileID(Ae,Math.floor((N+le)/2*ze),Math.floor((ee+de)/2*ze))}(u),this.minzoom=this.maxzoom=this.tileID.z;const m=u.map(C=>this.tileID.getTilePoint(C)._round());return this._boundsArray=new s.RasterBoundsArray,this._boundsArray.emplaceBack(m[0].x,m[0].y,0,0),this._boundsArray.emplaceBack(m[1].x,m[1].y,s.EXTENT,0),this._boundsArray.emplaceBack(m[3].x,m[3].y,0,s.EXTENT),this._boundsArray.emplaceBack(m[2].x,m[2].y,s.EXTENT,s.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,u=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,F.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new S(r,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));for(const m in this.tiles){const C=this.tiles[m];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture)}}loadTile(r,u){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},u(null)):(r.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class W extends H{constructor(r,u,m,C){super(r,u,m,C),this.roundZoom=!0,this.type="video",this.options=u}load(){this._loaded=!1;const r=this.options;this.urls=[];for(const u of r.urls)this.urls.push(this.map._requestManager.transformRequest(u,s.ResourceType.Source).url);s.getVideo(this.urls,(u,m)=>{this._loaded=!0,u?this.fire(new s.ErrorEvent(u)):m&&(this.video=m,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const u=this.video.seekable;r<u.start(0)||r>u.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const r=this.map.painter.context,u=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,F.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new S(r,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));for(const m in this.tiles){const C=this.tiles[m];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ne extends H{constructor(r,u,m,C){super(r,u,m,C),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(N=>!Array.isArray(N)||N.length!==2||N.some(ee=>typeof ee!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${r}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${r}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,m=u.gl;this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,F.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(r||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new S(u,this.canvas,m.RGBA,{premultiply:!0});for(const C in this.tiles){const N=this.tiles[C];N.state!=="loaded"&&(N.state="loaded",N.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const ue={vector:$,raster:R,"raster-dem":G,geojson:U,video:W,image:H,canvas:ne};function ie(T,r){const u=s.create();return s.translate(u,u,[1,1,0]),s.scale(u,u,[.5*T.width,.5*T.height,1]),s.multiply(u,u,T.calculatePosMatrix(r.toUnwrapped()))}function oe(T,r,u,m,C,N){const ee=function(ze,Ge,et){if(ze)for(const Qe of ze){const Je=Ge[Qe];if(Je&&Je.source===et&&Je.type==="fill-extrusion")return!0}else for(const Qe in Ge){const Je=Ge[Qe];if(Je.source===et&&Je.type==="fill-extrusion")return!0}return!1}(C&&C.layers,r,T.id),le=N.maxPitchScaleFactor(),de=T.tilesIn(m,le,ee);de.sort(Te);const be=[];for(const ze of de)be.push({wrappedTileID:ze.tileID.wrapped().key,queryResults:ze.tile.queryRenderedFeatures(r,u,T._state,ze.queryGeometry,ze.cameraQueryGeometry,ze.scale,C,N,le,ie(T.transform,ze.tileID))});const Ae=function(ze){const Ge={},et={};for(const Qe of ze){const Je=Qe.queryResults,dt=Qe.wrappedTileID,gt=et[dt]=et[dt]||{};for(const vt in Je){const nt=Je[vt],kt=gt[vt]=gt[vt]||{},_t=Ge[vt]=Ge[vt]||[];for(const Ot of nt)kt[Ot.featureIndex]||(kt[Ot.featureIndex]=!0,_t.push(Ot))}}return Ge}(be);for(const ze in Ae)Ae[ze].forEach(Ge=>{const et=Ge.feature,Qe=T.getFeatureState(et.layer["source-layer"],et.id);et.source=et.layer.source,et.layer["source-layer"]&&(et.sourceLayer=et.layer["source-layer"]),et.state=Qe});return Ae}function Te(T,r){const u=T.tileID,m=r.tileID;return u.overscaledZ-m.overscaledZ||u.canonical.y-m.canonical.y||u.wrap-m.wrap||u.canonical.x-m.canonical.x}class ge{constructor(r,u){this.tileID=r,this.uid=s.uniqueId(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const u=r+this.timeAdded;u<s.exported.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.textures.forEach(u=>r.saveTileTexture(u)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(r,u,m){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(C,N){const ee={};if(!N)return ee;for(const le of C){const de=le.layerIds.map(be=>N.getLayer(be)).filter(Boolean);if(de.length!==0){le.layers=de,le.stateDependentLayerIds&&(le.stateDependentLayers=le.stateDependentLayerIds.map(be=>de.filter(Ae=>Ae.id===be)[0]));for(const be of de)ee[be.id]=le}}return ee}(r.buckets,u.style),this.hasSymbolBuckets=!1;for(const C in this.buckets){const N=this.buckets[C];if(N instanceof s.SymbolBucket){if(this.hasSymbolBuckets=!0,!m)break;N.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const C in this.buckets){const N=this.buckets[C];if(N instanceof s.SymbolBucket&&N.hasRTLText){this.hasRTLText=!0,s.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const C in this.buckets){const N=this.buckets[C];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(C).queryRadius(N))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new s.CollisionBoxArray}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const m in this.buckets){const C=this.buckets[m];C.uploadPending()&&C.upload(r)}const u=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new S(r,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new S(r,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,u,m,C,N,ee,le,de,be,Ae){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:C,cameraQueryGeometry:N,scale:ee,tileSize:this.tileSize,pixelPosMatrix:Ae,transform:de,params:le,queryPadding:this.queryPadding*be},r,u,m):{}}querySourceFeatures(r,u){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const C=m.loadVTLayers(),N=u?u.sourceLayer:"",ee=C._geojsonTileLayer||C[N];if(!ee)return;const le=s.createFilter(u&&u.filter),{z:de,x:be,y:Ae}=this.tileID.canonical,ze={z:de,x:be,y:Ae};for(let Ge=0;Ge<ee.length;Ge++){const et=ee.feature(Ge);if(le.needGeometry){const dt=s.toEvaluationFeature(et,!0);if(!le.filter(new s.EvaluationParameters(this.tileID.overscaledZ),dt,this.tileID.canonical))continue}else if(!le.filter(new s.EvaluationParameters(this.tileID.overscaledZ),et))continue;const Qe=m.getId(et,N),Je=new s.GeoJSONFeature(et,de,be,Ae,Qe);Je.tile=ze,r.push(Je)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const u=this.expirationTime;if(r.cacheControl){const m=s.parseCacheControl(r.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const m=Date.now();let C=!1;if(this.expirationTime>m)C=!1;else if(u)if(this.expirationTime<u)C=!0;else{const N=this.expirationTime-u;N?this.expirationTime=m+Math.max(N,3e4):C=!0}else C=!0;C?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const m=this.latestFeatureIndex.loadVTLayers();for(const C in this.buckets){if(!u.style.hasLayer(C))continue;const N=this.buckets[C],ee=N.layers[0].sourceLayer||"_geojsonTileLayer",le=m[ee],de=r[ee];if(!le||!de||Object.keys(de).length===0)continue;N.update(de,le,this.imageAtlas&&this.imageAtlas.patternPositions||{});const be=u&&u.style&&u.style.getLayer(C);be&&(this.queryPadding=Math.max(this.queryPadding,be.queryRadius(N)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<s.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=s.exported.now()+r}setDependencies(r,u){const m={};for(const C of u)m[C]=!0;this.dependencies[r]=m}hasDependency(r,u){for(const m of r){const C=this.dependencies[m];if(C){for(const N of u)if(C[N])return!0}}return!1}}class we{constructor(r,u){this.max=r,this.onRemove=u,this.reset()}reset(){for(const r in this.data)for(const u of this.data[r])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(r,u,m){const C=r.wrapped().key;this.data[C]===void 0&&(this.data[C]=[]);const N={value:u,timeout:void 0};if(m!==void 0&&(N.timeout=setTimeout(()=>{this.remove(r,N)},m)),this.data[C].push(N),this.order.push(C),this.order.length>this.max){const ee=this._getAndRemoveByKey(this.order[0]);ee&&this.onRemove(ee)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const u=this.data[r].shift();return u.timeout&&clearTimeout(u.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),u.value}getByKey(r){const u=this.data[r];return u?u[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,u){if(!this.has(r))return this;const m=r.wrapped().key,C=u===void 0?0:this.data[m].indexOf(u),N=this.data[m][C];return this.data[m].splice(C,1),N.timeout&&clearTimeout(N.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(N.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(r){const u=[];for(const m in this.data)for(const C of this.data[m])r(C.value)||u.push(C);for(const m of u)this.remove(m.value.tileID,m)}}class K{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,u,m){const C=String(u);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][C]=this.stateChanges[r][C]||{},s.extend(this.stateChanges[r][C],m),this.deletedStates[r]===null){this.deletedStates[r]={};for(const N in this.state[r])N!==C&&(this.deletedStates[r][N]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][C]===null){this.deletedStates[r][C]={};for(const N in this.state[r][C])m[N]||(this.deletedStates[r][C][N]=null)}else for(const N in m)this.deletedStates[r]&&this.deletedStates[r][C]&&this.deletedStates[r][C][N]===null&&delete this.deletedStates[r][C][N]}removeFeatureState(r,u,m){if(this.deletedStates[r]===null)return;const C=String(u);if(this.deletedStates[r]=this.deletedStates[r]||{},m&&u!==void 0)this.deletedStates[r][C]!==null&&(this.deletedStates[r][C]=this.deletedStates[r][C]||{},this.deletedStates[r][C][m]=null);else if(u!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][C])for(m in this.deletedStates[r][C]={},this.stateChanges[r][C])this.deletedStates[r][C][m]=null;else this.deletedStates[r][C]=null;else this.deletedStates[r]=null}getState(r,u){const m=String(u),C=s.extend({},(this.state[r]||{})[m],(this.stateChanges[r]||{})[m]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const N=this.deletedStates[r][u];if(N===null)return{};for(const ee in N)delete C[ee]}return C}initializeTileState(r,u){r.setFeatureState(this.state,u)}coalesceChanges(r,u){const m={};for(const C in this.stateChanges){this.state[C]=this.state[C]||{};const N={};for(const ee in this.stateChanges[C])this.state[C][ee]||(this.state[C][ee]={}),s.extend(this.state[C][ee],this.stateChanges[C][ee]),N[ee]=this.state[C][ee];m[C]=N}for(const C in this.deletedStates){this.state[C]=this.state[C]||{};const N={};if(this.deletedStates[C]===null)for(const ee in this.state[C])N[ee]={},this.state[C][ee]={};else for(const ee in this.deletedStates[C]){if(this.deletedStates[C][ee]===null)this.state[C][ee]={};else for(const le of Object.keys(this.deletedStates[C][ee]))delete this.state[C][ee][le];N[ee]=this.state[C][ee]}m[C]=m[C]||{},s.extend(m[C],N)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const C in r)r[C].setFeatureState(m,u)}}class Q extends s.Evented{constructor(r,u,m){super(),this.id=r,this.dispatcher=m,this.on("data",C=>{C.dataType==="source"&&C.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&C.dataType==="source"&&C.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(C,N,ee,le){const de=new ue[N.type](C,N,ee,le);if(de.id!==C)throw new Error(`Expected Source id to be ${C} instead of ${de.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],de),de}(r,u,m,this),this._tiles={},this._cache=new we(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new K}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const u=this._tiles[r];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,u){return this._source.loadTile(r,u)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){this._source.abortTile&&this._source.abortTile(r,()=>{}),this._source.fire(new s.Event("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const m=this._tiles[u];m.upload(r),m.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(ae).map(r=>r.key)}getRenderableIds(r){const u=[];for(const m in this._tiles)this._isIdRenderable(m,r)&&u.push(this._tiles[m]);return r?u.sort((m,C)=>{const N=m.tileID,ee=C.tileID,le=new s.pointGeometry(N.canonical.x,N.canonical.y)._rotate(this.transform.angle),de=new s.pointGeometry(ee.canonical.x,ee.canonical.y)._rotate(this.transform.angle);return N.overscaledZ-ee.overscaledZ||de.y-le.y||de.x-le.x}).map(m=>m.tileID.key):u.map(m=>m.tileID).sort(ae).map(m=>m.key)}hasRenderableParent(r){const u=this.findLoadedParent(r,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(r,u){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(u||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(r,u){const m=this._tiles[r];m&&(m.state!=="loading"&&(m.state=u),this._loadTile(m,this._tileLoaded.bind(this,m,r,u)))}_tileLoaded(r,u,m,C){if(C)return r.state="errored",void(C.status!==404?this._source.fire(new s.ErrorEvent(C,{tile:r})):this.update(this.transform,this.terrain));r.timeAdded=s.exported.now(),m==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(u,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new s.Event("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const u=this.getRenderableIds();for(let C=0;C<u.length;C++){const N=u[C];if(r.neighboringTiles&&r.neighboringTiles[N]){const ee=this.getTileByID(N);m(r,ee),m(ee,r)}}function m(C,N){C.needsHillshadePrepare=!0,C.needsTerrainPrepare=!0;let ee=N.tileID.canonical.x-C.tileID.canonical.x;const le=N.tileID.canonical.y-C.tileID.canonical.y,de=Math.pow(2,C.tileID.canonical.z),be=N.tileID.key;ee===0&&le===0||Math.abs(le)>1||(Math.abs(ee)>1&&(Math.abs(ee+de)===1?ee+=de:Math.abs(ee-de)===1&&(ee-=de)),N.dem&&C.dem&&(C.dem.backfillBorder(N.dem,ee,le),C.neighboringTiles&&C.neighboringTiles[be]&&(C.neighboringTiles[be].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,u,m,C){for(const N in this._tiles){let ee=this._tiles[N];if(C[N]||!ee.hasData()||ee.tileID.overscaledZ<=u||ee.tileID.overscaledZ>m)continue;let le=ee.tileID;for(;ee&&ee.tileID.overscaledZ>u+1;){const be=ee.tileID.scaledTo(ee.tileID.overscaledZ-1);ee=this._tiles[be.key],ee&&ee.hasData()&&(le=be)}let de=le;for(;de.overscaledZ>u;)if(de=de.scaledTo(de.overscaledZ-1),r[de.key]){C[le.key]=le;break}}}findLoadedParent(r,u){if(r.key in this._loadedParentTiles){const m=this._loadedParentTiles[r.key];return m&&m.tileID.overscaledZ>=u?m:null}for(let m=r.overscaledZ-1;m>=u;m--){const C=r.scaledTo(m),N=this._getLoadedTile(C);if(N)return N}}_getLoadedTile(r){const u=this._tiles[r.key];return u&&u.hasData()?u:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const u=Math.ceil(r.width/this._source.tileSize)+1,m=Math.ceil(r.height/this._source.tileSize)+1,C=Math.floor(u*m*5),N=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(N)}handleWrapJump(r){const u=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,u){const m={};for(const C in this._tiles){const N=this._tiles[C];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+u),m[N.tileID.key]=N}this._tiles=m;for(const C in this._timers)clearTimeout(this._timers[C]),delete this._timers[C];for(const C in this._tiles)this._setTileReloadTimer(C,this._tiles[C])}}update(r,u){if(this.transform=r,this.terrain=u,!this._sourceLoaded||this._paused)return;let m;this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(be=>new s.OverscaledTileID(be.canonical.z,be.wrap,be.canonical.z,be.canonical.x,be.canonical.y)):(m=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u}),this._source.hasTile&&(m=m.filter(be=>this._source.hasTile(be)))):m=[];const C=r.coveringZoomLevel(this._source),N=Math.max(C-Q.maxOverzooming,this._source.minzoom),ee=Math.max(C+Q.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const be={};for(const Ae of m)if(Ae.canonical.z>this._source.minzoom){const ze=Ae.scaledTo(Ae.canonical.z-1);be[ze.key]=ze;const Ge=Ae.scaledTo(Math.max(this._source.minzoom,Math.min(Ae.canonical.z,5)));be[Ge.key]=Ge}m=m.concat(Object.values(be))}const le=this._updateRetainedTiles(m,C);if(ye(this._source.type)){const be={},Ae={},ze=Object.keys(le);for(const Ge of ze){const et=le[Ge],Qe=this._tiles[Ge];if(!Qe||Qe.fadeEndTime&&Qe.fadeEndTime<=s.exported.now())continue;const Je=this.findLoadedParent(et,N);Je&&(this._addTile(Je.tileID),be[Je.tileID.key]=Je.tileID),Ae[Ge]=et}this._retainLoadedChildren(Ae,C,ee,le);for(const Ge in be)le[Ge]||(this._coveredTiles[Ge]=!0,le[Ge]=be[Ge]);if(u){const Ge={},et={};for(const Qe of m)this._tiles[Qe.key].hasData()?Ge[Qe.key]=Qe:et[Qe.key]=Qe;for(const Qe in et){const Je=et[Qe].children(this._source.maxzoom);this._tiles[Je[0].key]&&this._tiles[Je[1].key]&&this._tiles[Je[2].key]&&this._tiles[Je[3].key]&&(Ge[Je[0].key]=le[Je[0].key]=Je[0],Ge[Je[1].key]=le[Je[1].key]=Je[1],Ge[Je[2].key]=le[Je[2].key]=Je[2],Ge[Je[3].key]=le[Je[3].key]=Je[3],delete et[Qe])}for(const Qe in et){const Je=this.findLoadedParent(et[Qe],this._source.minzoom);if(Je){Ge[Je.tileID.key]=le[Je.tileID.key]=Je.tileID;for(const dt in Ge)Ge[dt].isChildOf(Je.tileID)&&delete Ge[dt]}}for(const Qe in this._tiles)Ge[Qe]||(this._coveredTiles[Qe]=!0)}}for(const be in le)this._tiles[be].clearFadeHold();const de=s.keysDifference(this._tiles,le);for(const be of de){const Ae=this._tiles[be];Ae.hasSymbolBuckets&&!Ae.holdingForFade()?Ae.setHoldDuration(this.map._fadeDuration):Ae.hasSymbolBuckets&&!Ae.symbolFadeFinished()||this._removeTile(be)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,u){const m={},C={},N=Math.max(u-Q.maxOverzooming,this._source.minzoom),ee=Math.max(u+Q.maxUnderzooming,this._source.minzoom),le={};for(const de of r){const be=this._addTile(de);m[de.key]=de,be.hasData()||u<this._source.maxzoom&&(le[de.key]=de)}this._retainLoadedChildren(le,u,ee,m);for(const de of r){let be=this._tiles[de.key];if(be.hasData())continue;if(u+1>this._source.maxzoom){const ze=de.children(this._source.maxzoom)[0],Ge=this.getTile(ze);if(Ge&&Ge.hasData()){m[ze.key]=ze;continue}}else{const ze=de.children(this._source.maxzoom);if(m[ze[0].key]&&m[ze[1].key]&&m[ze[2].key]&&m[ze[3].key])continue}let Ae=be.wasRequested();for(let ze=de.overscaledZ-1;ze>=N;--ze){const Ge=de.scaledTo(ze);if(C[Ge.key]||(C[Ge.key]=!0,be=this.getTile(Ge),!be&&Ae&&(be=this._addTile(Ge)),be&&(m[Ge.key]=Ge,Ae=be.wasRequested(),be.hasData())))break}}return m}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const u=[];let m,C=this._tiles[r].tileID;for(;C.overscaledZ>0;){if(C.key in this._loadedParentTiles){m=this._loadedParentTiles[C.key];break}u.push(C.key);const N=C.scaledTo(C.overscaledZ-1);if(m=this._getLoadedTile(N),m)break;C=N}for(const N of u)this._loadedParentTiles[N]=m}}_addTile(r){let u=this._tiles[r.key];if(u)return u;u=this._cache.getAndRemove(r),u&&(this._setTileReloadTimer(r.key,u),u.tileID=r,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,u)));const m=u;return u||(u=new ge(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,r.key,u.state))),u.uses++,this._tiles[r.key]=u,m||this._source.fire(new s.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(r,u){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const m=u.getExpiryTimeout();m&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},m))}_removeTile(r){const u=this._tiles[r];u&&(u.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,u,m){const C=[],N=this.transform;if(!N)return C;const ee=m?N.getCameraQueryGeometry(r):r,le=r.map(Qe=>N.pointCoordinate(Qe,this.terrain)),de=ee.map(Qe=>N.pointCoordinate(Qe,this.terrain)),be=this.getIds();let Ae=1/0,ze=1/0,Ge=-1/0,et=-1/0;for(const Qe of de)Ae=Math.min(Ae,Qe.x),ze=Math.min(ze,Qe.y),Ge=Math.max(Ge,Qe.x),et=Math.max(et,Qe.y);for(let Qe=0;Qe<be.length;Qe++){const Je=this._tiles[be[Qe]];if(Je.holdingForFade())continue;const dt=Je.tileID,gt=Math.pow(2,N.zoom-Je.tileID.overscaledZ),vt=u*Je.queryPadding*s.EXTENT/Je.tileSize/gt,nt=[dt.getTilePoint(new s.MercatorCoordinate(Ae,ze)),dt.getTilePoint(new s.MercatorCoordinate(Ge,et))];if(nt[0].x-vt<s.EXTENT&&nt[0].y-vt<s.EXTENT&&nt[1].x+vt>=0&&nt[1].y+vt>=0){const kt=le.map(Ot=>dt.getTilePoint(Ot)),_t=de.map(Ot=>dt.getTilePoint(Ot));C.push({tile:Je,tileID:dt,queryGeometry:kt,cameraQueryGeometry:_t,scale:gt})}}return C}getVisibleCoordinates(r){const u=this.getRenderableIds(r).map(m=>this._tiles[m].tileID);for(const m of u)m.posMatrix=this.transform.calculatePosMatrix(m.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(ye(this._source.type))for(const r in this._tiles){const u=this._tiles[r];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=s.exported.now())return!0}return!1}setFeatureState(r,u,m){this._state.updateState(r=r||"_geojsonTileLayer",u,m)}removeFeatureState(r,u,m){this._state.removeFeatureState(r=r||"_geojsonTileLayer",u,m)}getFeatureState(r,u){return this._state.getState(r=r||"_geojsonTileLayer",u)}setDependencies(r,u,m){const C=this._tiles[r];C&&C.setDependencies(u,m)}reloadTilesForDependencies(r,u){for(const m in this._tiles)this._tiles[m].hasDependency(r,u)&&this._reloadTile(m,"reloading");this._cache.filter(m=>!m.hasDependency(r,u))}}function ae(T,r){const u=Math.abs(2*T.wrap)-+(T.wrap<0),m=Math.abs(2*r.wrap)-+(r.wrap<0);return T.overscaledZ-r.overscaledZ||m-u||r.canonical.y-T.canonical.y||r.canonical.x-T.canonical.x}function ye(T){return T==="raster"||T==="image"||T==="video"}Q.maxOverzooming=10,Q.maxUnderzooming=3;const J="mapboxgl_preloaded_worker_pool";class re{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<re.workerCount;)this.workers.push(new Worker(Yl.workerUrl));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[J]}numActive(){return Object.keys(this.active).length}}const ce=Math.floor(s.exported.hardwareConcurrency/2);let pe;function xe(){return pe||(pe=new re),pe}function Me(T,r){const u={};for(const m in T)m!=="ref"&&(u[m]=T[m]);return s.refProperties.forEach(m=>{m in r&&(u[m]=r[m])}),u}function _e(T){T=T.slice();const r=Object.create(null);for(let u=0;u<T.length;u++)r[T[u].id]=T[u];for(let u=0;u<T.length;u++)"ref"in T[u]&&(T[u]=Me(T[u],r[T[u].ref]));return T}re.workerCount=Math.max(Math.min(ce,6),1);const Ce={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Le(T,r,u){u.push({command:Ce.addSource,args:[T,r[T]]})}function Ue(T,r,u){r.push({command:Ce.removeSource,args:[T]}),u[T]=!0}function Xe(T,r,u,m){Ue(T,u,m),Le(T,r,u)}function Pe(T,r,u){let m;for(m in T[u])if(Object.prototype.hasOwnProperty.call(T[u],m)&&m!=="data"&&!v(T[u][m],r[u][m]))return!1;for(m in r[u])if(Object.prototype.hasOwnProperty.call(r[u],m)&&m!=="data"&&!v(T[u][m],r[u][m]))return!1;return!0}function Ee(T,r,u,m,C,N){let ee;for(ee in r=r||{},T=T||{})Object.prototype.hasOwnProperty.call(T,ee)&&(v(T[ee],r[ee])||u.push({command:N,args:[m,ee,r[ee],C]}));for(ee in r)Object.prototype.hasOwnProperty.call(r,ee)&&!Object.prototype.hasOwnProperty.call(T,ee)&&(v(T[ee],r[ee])||u.push({command:N,args:[m,ee,r[ee],C]}))}function Ie(T){return T.id}function Oe(T,r){return T[r.id]=r,T}class Re{constructor(r,u){this.reset(r,u)}reset(r,u){this.points=r||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=s.clamp(r,0,1);let u=1,m=this._distances[u];const C=r*this.paddedLength+this.padding;for(;m<C&&u<this._distances.length;)m=this._distances[++u];const N=u-1,ee=this._distances[N],le=m-ee,de=le>0?(C-ee)/le:0;return this.points[N].mult(1-de).add(this.points[u].mult(de))}}function Fe(T,r){let u=!0;return T==="always"||T!=="never"&&r!=="never"||(u=!1),u}class Ke{constructor(r,u,m){const C=this.boxCells=[],N=this.circleCells=[];this.xCellCount=Math.ceil(r/m),this.yCellCount=Math.ceil(u/m);for(let ee=0;ee<this.xCellCount*this.yCellCount;ee++)C.push([]),N.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=u,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,u,m,C,N){this._forEachCell(u,m,C,N,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(C),this.bboxes.push(N)}insertCircle(r,u,m,C){this._forEachCell(u-C,m-C,u+C,m+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(u),this.circles.push(m),this.circles.push(C)}_insertBoxCell(r,u,m,C,N,ee){this.boxCells[N].push(ee)}_insertCircleCell(r,u,m,C,N,ee){this.circleCells[N].push(ee)}_query(r,u,m,C,N,ee,le){if(m<0||r>this.width||C<0||u>this.height)return[];const de=[];if(r<=0&&u<=0&&this.width<=m&&this.height<=C){if(N)return[{key:null,x1:r,y1:u,x2:m,y2:C}];for(let be=0;be<this.boxKeys.length;be++)de.push({key:this.boxKeys[be],x1:this.bboxes[4*be],y1:this.bboxes[4*be+1],x2:this.bboxes[4*be+2],y2:this.bboxes[4*be+3]});for(let be=0;be<this.circleKeys.length;be++){const Ae=this.circles[3*be],ze=this.circles[3*be+1],Ge=this.circles[3*be+2];de.push({key:this.circleKeys[be],x1:Ae-Ge,y1:ze-Ge,x2:Ae+Ge,y2:ze+Ge})}}else this._forEachCell(r,u,m,C,this._queryCell,de,{hitTest:N,overlapMode:ee,seenUids:{box:{},circle:{}}},le);return de}query(r,u,m,C){return this._query(r,u,m,C,!1,null)}hitTest(r,u,m,C,N,ee){return this._query(r,u,m,C,!0,N,ee).length>0}hitTestCircle(r,u,m,C,N){const ee=r-m,le=r+m,de=u-m,be=u+m;if(le<0||ee>this.width||be<0||de>this.height)return!1;const Ae=[];return this._forEachCell(ee,de,le,be,this._queryCellCircle,Ae,{hitTest:!0,overlapMode:C,circle:{x:r,y:u,radius:m},seenUids:{box:{},circle:{}}},N),Ae.length>0}_queryCell(r,u,m,C,N,ee,le,de){const{seenUids:be,hitTest:Ae,overlapMode:ze}=le,Ge=this.boxCells[N];if(Ge!==null){const Qe=this.bboxes;for(const Je of Ge)if(!be.box[Je]){be.box[Je]=!0;const dt=4*Je,gt=this.boxKeys[Je];if(r<=Qe[dt+2]&&u<=Qe[dt+3]&&m>=Qe[dt+0]&&C>=Qe[dt+1]&&(!de||de(gt))&&(!Ae||!Fe(ze,gt.overlapMode))&&(ee.push({key:gt,x1:Qe[dt],y1:Qe[dt+1],x2:Qe[dt+2],y2:Qe[dt+3]}),Ae))return!0}}const et=this.circleCells[N];if(et!==null){const Qe=this.circles;for(const Je of et)if(!be.circle[Je]){be.circle[Je]=!0;const dt=3*Je,gt=this.circleKeys[Je];if(this._circleAndRectCollide(Qe[dt],Qe[dt+1],Qe[dt+2],r,u,m,C)&&(!de||de(gt))&&(!Ae||!Fe(ze,gt.overlapMode))){const vt=Qe[dt],nt=Qe[dt+1],kt=Qe[dt+2];if(ee.push({key:gt,x1:vt-kt,y1:nt-kt,x2:vt+kt,y2:nt+kt}),Ae)return!0}}}return!1}_queryCellCircle(r,u,m,C,N,ee,le,de){const{circle:be,seenUids:Ae,overlapMode:ze}=le,Ge=this.boxCells[N];if(Ge!==null){const Qe=this.bboxes;for(const Je of Ge)if(!Ae.box[Je]){Ae.box[Je]=!0;const dt=4*Je,gt=this.boxKeys[Je];if(this._circleAndRectCollide(be.x,be.y,be.radius,Qe[dt+0],Qe[dt+1],Qe[dt+2],Qe[dt+3])&&(!de||de(gt))&&!Fe(ze,gt.overlapMode))return ee.push(!0),!0}}const et=this.circleCells[N];if(et!==null){const Qe=this.circles;for(const Je of et)if(!Ae.circle[Je]){Ae.circle[Je]=!0;const dt=3*Je,gt=this.circleKeys[Je];if(this._circlesCollide(Qe[dt],Qe[dt+1],Qe[dt+2],be.x,be.y,be.radius)&&(!de||de(gt))&&!Fe(ze,gt.overlapMode))return ee.push(!0),!0}}}_forEachCell(r,u,m,C,N,ee,le,de){const be=this._convertToXCellCoord(r),Ae=this._convertToYCellCoord(u),ze=this._convertToXCellCoord(m),Ge=this._convertToYCellCoord(C);for(let et=be;et<=ze;et++)for(let Qe=Ae;Qe<=Ge;Qe++)if(N.call(this,r,u,m,C,this.xCellCount*Qe+et,ee,le,de))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,u,m,C,N,ee){const le=C-r,de=N-u,be=m+ee;return be*be>le*le+de*de}_circleAndRectCollide(r,u,m,C,N,ee,le){const de=(ee-C)/2,be=Math.abs(r-(C+de));if(be>de+m)return!1;const Ae=(le-N)/2,ze=Math.abs(u-(N+Ae));if(ze>Ae+m)return!1;if(be<=de||ze<=Ae)return!0;const Ge=be-de,et=ze-Ae;return Ge*Ge+et*et<=m*m}}function rt(T,r,u,m,C){const N=s.create();return r?(s.scale(N,N,[1/C,1/C,1]),u||s.rotateZ(N,N,m.angle)):s.multiply(N,m.labelPlaneMatrix,T),N}function at(T,r,u,m,C){if(r){const N=s.clone(T);return s.scale(N,N,[C,C,1]),u||s.rotateZ(N,N,-m.angle),N}return m.glCoordMatrix}function ut(T,r,u){let m;u?(m=[T.x,T.y,u(T.x,T.y),1],s.transformMat4(m,m,r)):(m=[T.x,T.y,0,1],Vi(m,m,r));const C=m[3];return{point:new s.pointGeometry(m[0]/C,m[1]/C),signedDistanceFromCamera:C}}function mt(T,r){return .5+T/r*.5}function Tt(T,r){const u=T[0]/T[3],m=T[1]/T[3];return u>=-r[0]&&u<=r[0]&&m>=-r[1]&&m<=r[1]}function Rt(T,r,u,m,C,N,ee,le,de,be){const Ae=m?T.textSizeData:T.iconSizeData,ze=s.evaluateSizeForZoom(Ae,u.transform.zoom),Ge=[256/u.width*2+1,256/u.height*2+1],et=m?T.text.dynamicLayoutVertexArray:T.icon.dynamicLayoutVertexArray;et.clear();const Qe=T.lineVertexArray,Je=m?T.text.placedSymbolArray:T.icon.placedSymbolArray,dt=u.transform.width/u.transform.height;let gt=!1;for(let vt=0;vt<Je.length;vt++){const nt=Je.get(vt);if(nt.hidden||nt.writingMode===s.WritingMode.vertical&&!gt){Ji(nt.numGlyphs,et);continue}let kt;if(gt=!1,be?(kt=[nt.anchorX,nt.anchorY,be(nt.anchorX,nt.anchorY),1],s.transformMat4(kt,kt,r)):(kt=[nt.anchorX,nt.anchorY,0,1],Vi(kt,kt,r)),!Tt(kt,Ge)){Ji(nt.numGlyphs,et);continue}const _t=mt(u.transform.cameraToCenterDistance,kt[3]),Ot=s.evaluateSizeForFeature(Ae,ze,nt),zt=ee?Ot/_t:Ot*_t,Ut=new s.pointGeometry(nt.anchorX,nt.anchorY),Dt=ut(Ut,C,be).point,ni={},qt=Et(nt,zt,!1,le,r,C,N,T.glyphOffsetArray,Qe,et,Dt,Ut,ni,dt,de,be);gt=qt.useVertical,(qt.notEnoughRoom||gt||qt.needsFlipping&&Et(nt,zt,!0,le,r,C,N,T.glyphOffsetArray,Qe,et,Dt,Ut,ni,dt,de,be).notEnoughRoom)&&Ji(nt.numGlyphs,et)}m?T.text.dynamicLayoutVertexBuffer.updateData(et):T.icon.dynamicLayoutVertexBuffer.updateData(et)}function pt(T,r,u,m,C,N,ee,le,de,be,Ae,ze,Ge){const et=le.glyphStartIndex+le.numGlyphs,Qe=le.lineStartIndex,Je=le.lineStartIndex+le.lineLength,dt=r.getoffsetX(le.glyphStartIndex),gt=r.getoffsetX(et-1),vt=ci(T*dt,u,m,C,N,ee,le.segment,Qe,Je,de,be,Ae,ze,Ge);if(!vt)return null;const nt=ci(T*gt,u,m,C,N,ee,le.segment,Qe,Je,de,be,Ae,ze,Ge);return nt?{first:vt,last:nt}:null}function Ct(T,r,u,m){return T===s.WritingMode.horizontal&&Math.abs(u.y-r.y)>Math.abs(u.x-r.x)*m?{useVertical:!0}:(T===s.WritingMode.vertical?r.y<u.y:r.x>u.x)?{needsFlipping:!0}:null}function Et(T,r,u,m,C,N,ee,le,de,be,Ae,ze,Ge,et,Qe,Je){const dt=r/24,gt=T.lineOffsetX*dt,vt=T.lineOffsetY*dt;let nt;if(T.numGlyphs>1){const kt=T.glyphStartIndex+T.numGlyphs,_t=T.lineStartIndex,Ot=T.lineStartIndex+T.lineLength,zt=pt(dt,le,gt,vt,u,Ae,ze,T,de,N,Ge,Qe,Je);if(!zt)return{notEnoughRoom:!0};const Ut=ut(zt.first.point,ee,Je).point,Dt=ut(zt.last.point,ee,Je).point;if(m&&!u){const ni=Ct(T.writingMode,Ut,Dt,et);if(ni)return ni}nt=[zt.first];for(let ni=T.glyphStartIndex+1;ni<kt-1;ni++)nt.push(ci(dt*le.getoffsetX(ni),gt,vt,u,Ae,ze,T.segment,_t,Ot,de,N,Ge,Qe,Je));nt.push(zt.last)}else{if(m&&!u){const _t=ut(ze,C,Je).point,Ot=T.lineStartIndex+T.segment+1,zt=new s.pointGeometry(de.getx(Ot),de.gety(Ot)),Ut=ut(zt,C,Je),Dt=Ut.signedDistanceFromCamera>0?Ut.point:ri(ze,zt,_t,1,C,Je),ni=Ct(T.writingMode,_t,Dt,et);if(ni)return ni}const kt=ci(dt*le.getoffsetX(T.glyphStartIndex),gt,vt,u,Ae,ze,T.segment,T.lineStartIndex,T.lineStartIndex+T.lineLength,de,N,Ge,Qe,Je);if(!kt)return{notEnoughRoom:!0};nt=[kt]}for(const kt of nt)s.addDynamicAttributes(be,kt.point,kt.angle);return{}}function ri(T,r,u,m,C,N){const ee=ut(T.add(T.sub(r)._unit()),C,N).point,le=u.sub(ee);return u.add(le._mult(m/le.mag()))}function ci(T,r,u,m,C,N,ee,le,de,be,Ae,ze,Ge,et){const Qe=m?T-r:T+r;let Je=Qe>0?1:-1,dt=0;m&&(Je*=-1,dt=Math.PI),Je<0&&(dt+=Math.PI);let gt=Je>0?le+ee:le+ee+1,vt=C,nt=C,kt=0,_t=0;const Ot=Math.abs(Qe),zt=[];for(;kt+_t<=Ot;){if(gt+=Je,gt<le||gt>=de)return null;if(nt=vt,zt.push(vt),vt=ze[gt],vt===void 0){const oi=new s.pointGeometry(be.getx(gt),be.gety(gt)),Hi=ut(oi,Ae,et);if(Hi.signedDistanceFromCamera>0)vt=ze[gt]=Hi.point;else{const er=gt-Je;vt=ri(kt===0?N:new s.pointGeometry(be.getx(er),be.gety(er)),oi,nt,Ot-kt+1,Ae,et)}}kt+=_t,_t=nt.dist(vt)}const Ut=(Ot-kt)/_t,Dt=vt.sub(nt),ni=Dt.mult(Ut)._add(nt);ni._add(Dt._unit()._perp()._mult(u*Je));const qt=dt+Math.atan2(vt.y-nt.y,vt.x-nt.x);return zt.push(ni),{point:ni,angle:Ge?qt:0,path:zt}}const Vt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ji(T,r){for(let u=0;u<T;u++){const m=r.length;r.resize(m+4),r.float32.set(Vt,3*m)}}function Vi(T,r,u){const m=r[0],C=r[1];return T[0]=u[0]*m+u[4]*C+u[12],T[1]=u[1]*m+u[5]*C+u[13],T[3]=u[3]*m+u[7]*C+u[15],T}const ar=100;class Tr{constructor(r,u=new Ke(r.width+200,r.height+200,25),m=new Ke(r.width+200,r.height+200,25)){this.transform=r,this.grid=u,this.ignoredGrid=m,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+ar,this.screenBottomBoundary=r.height+ar,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,u,m,C,N,ee){const le=this.projectAndGetPerspectiveRatio(C,r.anchorPointX,r.anchorPointY,ee),de=m*le.perspectiveRatio,be=r.x1*de+le.point.x,Ae=r.y1*de+le.point.y,ze=r.x2*de+le.point.x,Ge=r.y2*de+le.point.y;return!this.isInsideGrid(be,Ae,ze,Ge)||u!=="always"&&this.grid.hitTest(be,Ae,ze,Ge,u,N)||le.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[be,Ae,ze,Ge],offscreen:this.isOffscreen(be,Ae,ze,Ge)}}placeCollisionCircles(r,u,m,C,N,ee,le,de,be,Ae,ze,Ge,et,Qe){const Je=[],dt=new s.pointGeometry(u.anchorX,u.anchorY),gt=ut(dt,ee,Qe),vt=mt(this.transform.cameraToCenterDistance,gt.signedDistanceFromCamera),nt=(Ae?N/vt:N*vt)/s.ONE_EM,kt=ut(dt,le,Qe).point,_t=pt(nt,C,u.lineOffsetX*nt,u.lineOffsetY*nt,!1,kt,dt,u,m,le,{},!1,Qe);let Ot=!1,zt=!1,Ut=!0;if(_t){const Dt=.5*Ge*vt+et,ni=new s.pointGeometry(-100,-100),qt=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),oi=new Re,Hi=_t.first,er=_t.last;let ki=[];for(let lr=Hi.path.length-1;lr>=1;lr--)ki.push(Hi.path[lr]);for(let lr=1;lr<er.path.length;lr++)ki.push(er.path[lr]);const Cr=2.5*Dt;if(de){const lr=ki.map(hr=>ut(hr,de,Qe));ki=lr.some(hr=>hr.signedDistanceFromCamera<=0)?[]:lr.map(hr=>hr.point)}let Sr=[];if(ki.length>0){const lr=ki[0].clone(),hr=ki[0].clone();for(let pr=1;pr<ki.length;pr++)lr.x=Math.min(lr.x,ki[pr].x),lr.y=Math.min(lr.y,ki[pr].y),hr.x=Math.max(hr.x,ki[pr].x),hr.y=Math.max(hr.y,ki[pr].y);Sr=lr.x>=ni.x&&hr.x<=qt.x&&lr.y>=ni.y&&hr.y<=qt.y?[ki]:hr.x<ni.x||lr.x>qt.x||hr.y<ni.y||lr.y>qt.y?[]:s.clipLine([ki],ni.x,ni.y,qt.x,qt.y)}for(const lr of Sr){oi.reset(lr,.25*Dt);let hr=0;hr=oi.length<=.5*Dt?1:Math.ceil(oi.paddedLength/Cr)+1;for(let pr=0;pr<hr;pr++){const Ss=pr/Math.max(hr-1,1),yo=oi.lerp(Ss),Js=yo.x+ar,eo=yo.y+ar;Je.push(Js,eo,Dt,0);const ga=Js-Dt,Nn=eo-Dt,to=Js+Dt,ya=eo+Dt;if(Ut=Ut&&this.isOffscreen(ga,Nn,to,ya),zt=zt||this.isInsideGrid(ga,Nn,to,ya),r!=="always"&&this.grid.hitTestCircle(Js,eo,Dt,r,ze)&&(Ot=!0,!be))return{circles:[],offscreen:!1,collisionDetected:Ot}}}}return{circles:!be&&Ot||!zt||vt<this.perspectiveRatioCutoff?[]:Je,offscreen:Ut,collisionDetected:Ot}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let m=1/0,C=1/0,N=-1/0,ee=-1/0;for(const Ae of r){const ze=new s.pointGeometry(Ae.x+ar,Ae.y+ar);m=Math.min(m,ze.x),C=Math.min(C,ze.y),N=Math.max(N,ze.x),ee=Math.max(ee,ze.y),u.push(ze)}const le=this.grid.query(m,C,N,ee).concat(this.ignoredGrid.query(m,C,N,ee)),de={},be={};for(const Ae of le){const ze=Ae.key;if(de[ze.bucketInstanceId]===void 0&&(de[ze.bucketInstanceId]={}),de[ze.bucketInstanceId][ze.featureIndex])continue;const Ge=[new s.pointGeometry(Ae.x1,Ae.y1),new s.pointGeometry(Ae.x2,Ae.y1),new s.pointGeometry(Ae.x2,Ae.y2),new s.pointGeometry(Ae.x1,Ae.y2)];s.polygonIntersectsPolygon(u,Ge)&&(de[ze.bucketInstanceId][ze.featureIndex]=!0,be[ze.bucketInstanceId]===void 0&&(be[ze.bucketInstanceId]=[]),be[ze.bucketInstanceId].push(ze.featureIndex))}return be}insertCollisionBox(r,u,m,C,N,ee){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:N,collisionGroupID:ee,overlapMode:u},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,u,m,C,N,ee){const le=m?this.ignoredGrid:this.grid,de={bucketInstanceId:C,featureIndex:N,collisionGroupID:ee,overlapMode:u};for(let be=0;be<r.length;be+=4)le.insertCircle(de,r[be],r[be+1],r[be+2])}projectAndGetPerspectiveRatio(r,u,m,C){let N;return C?(N=[u,m,C(u,m),1],s.transformMat4(N,N,r)):(N=[u,m,0,1],Vi(N,N,r)),{point:new s.pointGeometry((N[0]/N[3]+1)/2*this.transform.width+ar,(-N[1]/N[3]+1)/2*this.transform.height+ar),perspectiveRatio:.5+this.transform.cameraToCenterDistance/N[3]*.5}}isOffscreen(r,u,m,C){return m<ar||r>=this.screenRightBoundary||C<ar||u>this.screenBottomBoundary}isInsideGrid(r,u,m,C){return m>=0&&r<this.gridRightBoundary&&C>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const r=s.identity([]);return s.translate(r,r,[-100,-100,0]),r}}function Xi(T,r,u){return r*(s.EXTENT/(T.tileSize*Math.pow(2,u-T.tileID.overscaledZ)))}class ht{constructor(r,u,m,C){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?u:-u))):C&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class xt{constructor(r,u,m,C,N){this.text=new ht(r?r.text:null,u,m,N),this.icon=new ht(r?r.icon:null,u,C,N)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class At{constructor(r,u,m){this.text=r,this.icon=u,this.skipFade=m}}class Nt{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Wt{constructor(r,u,m,C,N){this.bucketInstanceId=r,this.featureIndex=u,this.sourceLayerIndex=m,this.bucketIndex=C,this.tileID=N}}class mi{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const u=++this.maxGroupID;this.collisionGroups[r]={ID:u,predicate:m=>m.collisionGroupID===u}}return this.collisionGroups[r]}}function Di(T,r,u,m,C){const{horizontalAlign:N,verticalAlign:ee}=s.getAnchorAlignment(T),le=-(N-.5)*r,de=-(ee-.5)*u,be=s.evaluateVariableOffset(T,m);return new s.pointGeometry(le+be[0]*C,de+be[1]*C)}function hi(T,r,u,m,C,N){const{x1:ee,x2:le,y1:de,y2:be,anchorPointX:Ae,anchorPointY:ze}=T,Ge=new s.pointGeometry(r,u);return m&&Ge._rotate(C?N:-N),{x1:ee+Ge.x,y1:de+Ge.y,x2:le+Ge.x,y2:be+Ge.y,anchorPointX:Ae,anchorPointY:ze}}class $e{constructor(r,u,m,C,N){this.transform=r.clone(),this.terrain=u,this.collisionIndex=new Tr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new mi(C),this.collisionCircleArrays={},this.prevPlacement=N,N&&(N.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,u,m,C){const N=m.getBucket(u),ee=m.latestFeatureIndex;if(!N||!ee||u.id!==N.layerIds[0])return;const le=m.collisionBoxArray,de=N.layers[0].layout,be=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),Ae=m.tileSize/s.EXTENT,ze=this.transform.calculatePosMatrix(m.tileID.toUnwrapped()),Ge=de.get("text-pitch-alignment")==="map",et=de.get("text-rotation-alignment")==="map",Qe=Xi(m,1,this.transform.zoom),Je=rt(ze,Ge,et,this.transform,Qe);let dt=null;if(Ge){const vt=at(ze,Ge,et,this.transform,Qe);dt=s.multiply([],this.transform.labelPlaneMatrix,vt)}this.retainedQueryData[N.bucketInstanceId]=new Wt(N.bucketInstanceId,ee,N.sourceLayerIndex,N.index,m.tileID);const gt={bucket:N,layout:de,posMatrix:ze,textLabelPlaneMatrix:Je,labelToScreenMatrix:dt,scale:be,textPixelRatio:Ae,holdingForFade:m.holdingForFade(),collisionBoxArray:le,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(N.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(N.sourceID)};if(C)for(const vt of N.sortKeyRanges){const{sortKey:nt,symbolInstanceStart:kt,symbolInstanceEnd:_t}=vt;r.push({sortKey:nt,symbolInstanceStart:kt,symbolInstanceEnd:_t,parameters:gt})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:N.symbolInstances.length,parameters:gt})}attemptAnchorPlacement(r,u,m,C,N,ee,le,de,be,Ae,ze,Ge,et,Qe,Je,dt){const gt=[Ge.textOffset0,Ge.textOffset1],vt=Di(r,m,C,gt,N),nt=this.collisionIndex.placeCollisionBox(hi(u,vt.x,vt.y,ee,le,this.transform.angle),ze,de,be,Ae.predicate,dt);if((!Je||this.collisionIndex.placeCollisionBox(hi(Je,vt.x,vt.y,ee,le,this.transform.angle),ze,de,be,Ae.predicate,dt).box.length!==0)&&nt.box.length>0){let kt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ge.crossTileID]&&this.prevPlacement.placements[Ge.crossTileID]&&this.prevPlacement.placements[Ge.crossTileID].text&&(kt=this.prevPlacement.variableOffsets[Ge.crossTileID].anchor),Ge.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Ge.crossTileID]={textOffset:gt,width:m,height:C,anchor:r,textBoxScale:N,prevAnchor:kt},this.markUsedJustification(et,r,Ge,Qe),et.allowVerticalPlacement&&(this.markUsedOrientation(et,Qe,Ge),this.placedOrientations[Ge.crossTileID]=Qe),{shift:vt,placedGlyphBoxes:nt}}}placeLayerBucketPart(r,u,m){const{bucket:C,layout:N,posMatrix:ee,textLabelPlaneMatrix:le,labelToScreenMatrix:de,textPixelRatio:be,holdingForFade:Ae,collisionBoxArray:ze,partiallyEvaluatedTextSize:Ge,collisionGroup:et}=r.parameters,Qe=N.get("text-optional"),Je=N.get("icon-optional"),dt=s.getOverlapMode(N,"text-overlap","text-allow-overlap"),gt=dt==="always",vt=s.getOverlapMode(N,"icon-overlap","icon-allow-overlap"),nt=vt==="always",kt=N.get("text-rotation-alignment")==="map",_t=N.get("text-pitch-alignment")==="map",Ot=N.get("icon-text-fit")!=="none",zt=N.get("symbol-z-order")==="viewport-y",Ut=gt&&(nt||!C.hasIconData()||Je),Dt=nt&&(gt||!C.hasTextData()||Qe);!C.collisionArrays&&ze&&C.deserializeCollisionBoxes(ze);const ni=(qt,oi)=>{if(u[qt.crossTileID])return;if(Ae)return void(this.placements[qt.crossTileID]=new At(!1,!1,!1));let Hi=!1,er=!1,ki=!0,Cr=null,Sr={box:null,offscreen:null},lr={box:null,offscreen:null},hr=null,pr=null,Ss=null,yo=0,Js=0,eo=0;oi.textFeatureIndex?yo=oi.textFeatureIndex:qt.useRuntimeCollisionCircles&&(yo=qt.featureIndex),oi.verticalTextFeatureIndex&&(Js=oi.verticalTextFeatureIndex);const ga=this.retainedQueryData[C.bucketInstanceId].tileID,Nn=this.terrain?(fr,Br)=>this.terrain.getElevation(ga,fr,Br):null;for(const fr of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const Br=oi[fr];Br&&(Br.elevation=Nn?Nn(Br.anchorPointX,Br.anchorPointY):0)}const to=oi.textBox;if(to){const fr=gr=>{let yn=s.WritingMode.horizontal;if(C.allowVerticalPlacement&&!gr&&this.prevPlacement){const gs=this.prevPlacement.placedOrientations[qt.crossTileID];gs&&(this.placedOrientations[qt.crossTileID]=gs,yn=gs,this.markUsedOrientation(C,yn,qt))}return yn},Br=(gr,yn)=>{if(C.allowVerticalPlacement&&qt.numVerticalGlyphVertices>0&&oi.verticalTextBox){for(const gs of C.writingModes)if(gs===s.WritingMode.vertical?(Sr=yn(),lr=Sr):Sr=gr(),Sr&&Sr.box&&Sr.box.length)break}else Sr=gr()};if(N.get("text-variable-anchor")){let gr=N.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[qt.crossTileID]){const Gr=this.prevPlacement.variableOffsets[qt.crossTileID];gr.indexOf(Gr.anchor)>0&&(gr=gr.filter(Hs=>Hs!==Gr.anchor),gr.unshift(Gr.anchor))}const yn=(Gr,Hs,qa)=>{const Xa=Gr.x2-Gr.x1,ih=Gr.y2-Gr.y1,Au=qt.textBoxScale,rh=Ot&&vt==="never"?Hs:null;let io={box:[],offscreen:!1};const nh=dt!=="never"?2*gr.length:gr.length;for(let ql=0;ql<nh;++ql){const sh=this.attemptAnchorPlacement(gr[ql%gr.length],Gr,Xa,ih,Au,kt,_t,be,ee,et,ql>=gr.length?dt:"never",qt,C,qa,rh,Nn);if(sh&&(io=sh.placedGlyphBoxes,io&&io.box&&io.box.length)){Hi=!0,Cr=sh.shift;break}}return io};Br(()=>yn(to,oi.iconBox,s.WritingMode.horizontal),()=>{const Gr=oi.verticalTextBox;return C.allowVerticalPlacement&&!(Sr&&Sr.box&&Sr.box.length)&&qt.numVerticalGlyphVertices>0&&Gr?yn(Gr,oi.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null}}),Sr&&(Hi=Sr.box,ki=Sr.offscreen);const gs=fr(Sr&&Sr.box);if(!Hi&&this.prevPlacement){const Gr=this.prevPlacement.variableOffsets[qt.crossTileID];Gr&&(this.variableOffsets[qt.crossTileID]=Gr,this.markUsedJustification(C,Gr.anchor,qt,gs))}}else{const gr=(yn,gs)=>{const Gr=this.collisionIndex.placeCollisionBox(yn,dt,be,ee,et.predicate,Nn);return Gr&&Gr.box&&Gr.box.length&&(this.markUsedOrientation(C,gs,qt),this.placedOrientations[qt.crossTileID]=gs),Gr};Br(()=>gr(to,s.WritingMode.horizontal),()=>{const yn=oi.verticalTextBox;return C.allowVerticalPlacement&&qt.numVerticalGlyphVertices>0&&yn?gr(yn,s.WritingMode.vertical):{box:null,offscreen:null}}),fr(Sr&&Sr.box&&Sr.box.length)}}if(hr=Sr,Hi=hr&&hr.box&&hr.box.length>0,ki=hr&&hr.offscreen,qt.useRuntimeCollisionCircles){const fr=C.text.placedSymbolArray.get(qt.centerJustifiedTextSymbolIndex),Br=s.evaluateSizeForFeature(C.textSizeData,Ge,fr),gr=N.get("text-padding");pr=this.collisionIndex.placeCollisionCircles(dt,fr,C.lineVertexArray,C.glyphOffsetArray,Br,ee,le,de,m,_t,et.predicate,qt.collisionCircleDiameter,gr,Nn),pr.circles.length&&pr.collisionDetected&&!m&&s.warnOnce("Collisions detected, but collision boxes are not shown"),Hi=gt||pr.circles.length>0&&!pr.collisionDetected,ki=ki&&pr.offscreen}if(oi.iconFeatureIndex&&(eo=oi.iconFeatureIndex),oi.iconBox){const fr=Br=>{const gr=Ot&&Cr?hi(Br,Cr.x,Cr.y,kt,_t,this.transform.angle):Br;return this.collisionIndex.placeCollisionBox(gr,vt,be,ee,et.predicate,Nn)};lr&&lr.box&&lr.box.length&&oi.verticalIconBox?(Ss=fr(oi.verticalIconBox),er=Ss.box.length>0):(Ss=fr(oi.iconBox),er=Ss.box.length>0),ki=ki&&Ss.offscreen}const ya=Qe||qt.numHorizontalGlyphVertices===0&&qt.numVerticalGlyphVertices===0,th=Je||qt.numIconVertices===0;if(ya||th?th?ya||(er=er&&Hi):Hi=er&&Hi:er=Hi=er&&Hi,Hi&&hr&&hr.box&&this.collisionIndex.insertCollisionBox(hr.box,dt,N.get("text-ignore-placement"),C.bucketInstanceId,lr&&lr.box&&Js?Js:yo,et.ID),er&&Ss&&this.collisionIndex.insertCollisionBox(Ss.box,vt,N.get("icon-ignore-placement"),C.bucketInstanceId,eo,et.ID),pr&&(Hi&&this.collisionIndex.insertCollisionCircles(pr.circles,dt,N.get("text-ignore-placement"),C.bucketInstanceId,yo,et.ID),m)){const fr=C.bucketInstanceId;let Br=this.collisionCircleArrays[fr];Br===void 0&&(Br=this.collisionCircleArrays[fr]=new Nt);for(let gr=0;gr<pr.circles.length;gr+=4)Br.circles.push(pr.circles[gr+0]),Br.circles.push(pr.circles[gr+1]),Br.circles.push(pr.circles[gr+2]),Br.circles.push(pr.collisionDetected?1:0)}if(qt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(C.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[qt.crossTileID]=new At(Hi||Ut,er||Dt,ki||C.justReloaded),u[qt.crossTileID]=!0};if(zt){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const qt=C.getSortedSymbolIndexes(this.transform.angle);for(let oi=qt.length-1;oi>=0;--oi){const Hi=qt[oi];ni(C.symbolInstances.get(Hi),C.collisionArrays[Hi])}}else for(let qt=r.symbolInstanceStart;qt<r.symbolInstanceEnd;qt++)ni(C.symbolInstances.get(qt),C.collisionArrays[qt]);if(m&&C.bucketInstanceId in this.collisionCircleArrays){const qt=this.collisionCircleArrays[C.bucketInstanceId];s.invert(qt.invProjMatrix,ee),qt.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(r,u,m,C){let N;N=C===s.WritingMode.vertical?m.verticalPlacedTextSymbolIndex:{left:m.leftJustifiedTextSymbolIndex,center:m.centerJustifiedTextSymbolIndex,right:m.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(u)];const ee=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex,m.verticalPlacedTextSymbolIndex];for(const le of ee)le>=0&&(r.text.placedSymbolArray.get(le).crossTileID=N>=0&&le!==N?0:m.crossTileID)}markUsedOrientation(r,u,m){const C=u===s.WritingMode.horizontal||u===s.WritingMode.horizontalOnly?u:0,N=u===s.WritingMode.vertical?u:0,ee=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex];for(const le of ee)r.text.placedSymbolArray.get(le).placedOrientation=C;m.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).placedOrientation=N)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let m=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const C=u?u.symbolFadeChange(r):1,N=u?u.opacities:{},ee=u?u.variableOffsets:{},le=u?u.placedOrientations:{};for(const de in this.placements){const be=this.placements[de],Ae=N[de];Ae?(this.opacities[de]=new xt(Ae,C,be.text,be.icon),m=m||be.text!==Ae.text.placed||be.icon!==Ae.icon.placed):(this.opacities[de]=new xt(null,C,be.text,be.icon,be.skipFade),m=m||be.text||be.icon)}for(const de in N){const be=N[de];if(!this.opacities[de]){const Ae=new xt(be,C,!1,!1);Ae.isHidden()||(this.opacities[de]=Ae,m=m||be.text.placed||be.icon.placed)}}for(const de in ee)this.variableOffsets[de]||!this.opacities[de]||this.opacities[de].isHidden()||(this.variableOffsets[de]=ee[de]);for(const de in le)this.placedOrientations[de]||!this.opacities[de]||this.opacities[de].isHidden()||(this.placedOrientations[de]=le[de]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");m?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:r)}updateLayerOpacities(r,u){const m={};for(const C of u){const N=C.getBucket(r);N&&C.latestFeatureIndex&&r.id===N.layerIds[0]&&this.updateBucketOpacities(N,m,C.collisionBoxArray)}}updateBucketOpacities(r,u,m){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const C=r.layers[0].layout,N=new xt(null,0,!1,!1,!0),ee=C.get("text-allow-overlap"),le=C.get("icon-allow-overlap"),de=C.get("text-variable-anchor"),be=C.get("text-rotation-alignment")==="map",Ae=C.get("text-pitch-alignment")==="map",ze=C.get("icon-text-fit")!=="none",Ge=new xt(null,0,ee&&(le||!r.hasIconData()||C.get("icon-optional")),le&&(ee||!r.hasTextData()||C.get("text-optional")),!0);!r.collisionArrays&&m&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(m);const et=(Qe,Je,dt)=>{for(let gt=0;gt<Je/4;gt++)Qe.opacityVertexArray.emplaceBack(dt)};for(let Qe=0;Qe<r.symbolInstances.length;Qe++){const Je=r.symbolInstances.get(Qe),{numHorizontalGlyphVertices:dt,numVerticalGlyphVertices:gt,crossTileID:vt}=Je;let nt=this.opacities[vt];u[vt]?nt=N:nt||(nt=Ge,this.opacities[vt]=nt),u[vt]=!0;const kt=Je.numIconVertices>0,_t=this.placedOrientations[Je.crossTileID],Ot=_t===s.WritingMode.vertical,zt=_t===s.WritingMode.horizontal||_t===s.WritingMode.horizontalOnly;if(dt>0||gt>0){const Ut=ft(nt.text);et(r.text,dt,Ot?St:Ut),et(r.text,gt,zt?St:Ut);const Dt=nt.text.isHidden();[Je.rightJustifiedTextSymbolIndex,Je.centerJustifiedTextSymbolIndex,Je.leftJustifiedTextSymbolIndex].forEach(oi=>{oi>=0&&(r.text.placedSymbolArray.get(oi).hidden=Dt||Ot?1:0)}),Je.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(Je.verticalPlacedTextSymbolIndex).hidden=Dt||zt?1:0);const ni=this.variableOffsets[Je.crossTileID];ni&&this.markUsedJustification(r,ni.anchor,Je,_t);const qt=this.placedOrientations[Je.crossTileID];qt&&(this.markUsedJustification(r,"left",Je,qt),this.markUsedOrientation(r,qt,Je))}if(kt){const Ut=ft(nt.icon),Dt=!(ze&&Je.verticalPlacedIconSymbolIndex&&Ot);Je.placedIconSymbolIndex>=0&&(et(r.icon,Je.numIconVertices,Dt?Ut:St),r.icon.placedSymbolArray.get(Je.placedIconSymbolIndex).hidden=nt.icon.isHidden()),Je.verticalPlacedIconSymbolIndex>=0&&(et(r.icon,Je.numVerticalIconVertices,Dt?St:Ut),r.icon.placedSymbolArray.get(Je.verticalPlacedIconSymbolIndex).hidden=nt.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Ut=r.collisionArrays[Qe];if(Ut){let Dt=new s.pointGeometry(0,0);if(Ut.textBox||Ut.verticalTextBox){let qt=!0;if(de){const oi=this.variableOffsets[vt];oi?(Dt=Di(oi.anchor,oi.width,oi.height,oi.textOffset,oi.textBoxScale),be&&Dt._rotate(Ae?this.transform.angle:-this.transform.angle)):qt=!1}Ut.textBox&&fe(r.textCollisionBox.collisionVertexArray,nt.text.placed,!qt||Ot,Dt.x,Dt.y),Ut.verticalTextBox&&fe(r.textCollisionBox.collisionVertexArray,nt.text.placed,!qt||zt,Dt.x,Dt.y)}const ni=!!(!zt&&Ut.verticalIconBox);Ut.iconBox&&fe(r.iconCollisionBox.collisionVertexArray,nt.icon.placed,ni,ze?Dt.x:0,ze?Dt.y:0),Ut.verticalIconBox&&fe(r.iconCollisionBox.collisionVertexArray,nt.icon.placed,!ni,ze?Dt.x:0,ze?Dt.y:0)}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){const Qe=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=Qe.invProjMatrix,r.placementViewportMatrix=Qe.viewportMatrix,r.collisionCircleArray=Qe.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,u){const m=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*m>r}setStale(){this.stale=!0}}function fe(T,r,u,m,C){T.emplaceBack(r?1:0,u?1:0,m||0,C||0),T.emplaceBack(r?1:0,u?1:0,m||0,C||0),T.emplaceBack(r?1:0,u?1:0,m||0,C||0),T.emplaceBack(r?1:0,u?1:0,m||0,C||0)}const ke=Math.pow(2,25),Ne=Math.pow(2,24),qe=Math.pow(2,17),it=Math.pow(2,16),lt=Math.pow(2,9),st=Math.pow(2,8),tt=Math.pow(2,1);function ft(T){if(T.opacity===0&&!T.placed)return 0;if(T.opacity===1&&T.placed)return 4294967295;const r=T.placed?1:0,u=Math.floor(127*T.opacity);return u*ke+r*Ne+u*qe+r*it+u*lt+r*st+u*tt+r}const St=0;class Lt{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,u,m,C,N){const ee=this._bucketParts;for(;this._currentTileIndex<r.length;)if(u.getBucketParts(ee,C,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,N())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,ee.sort((le,de)=>le.sortKey-de.sortKey));this._currentPartIndex<ee.length;)if(u.placeLayerBucketPart(ee[this._currentPartIndex],this._seenCrossTileIDs,m),this._currentPartIndex++,N())return!0;return!1}}class It{constructor(r,u,m,C,N,ee,le,de){this.placement=new $e(r,u,ee,le,de),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=N,this._done=!1}isDone(){return this._done}continuePlacement(r,u,m){const C=s.exported.now(),N=()=>{const ee=s.exported.now()-C;return!this._forceFullPlacement&&ee>2};for(;this._currentPlacementIndex>=0;){const ee=u[r[this._currentPlacementIndex]],le=this.placement.collisionIndex.transform.zoom;if(ee.type==="symbol"&&(!ee.minzoom||ee.minzoom<=le)&&(!ee.maxzoom||ee.maxzoom>le)){if(this._inProgressLayer||(this._inProgressLayer=new Lt(ee)),this._inProgressLayer.continuePlacement(m[ee.source],this.placement,this._showCollisionBoxes,ee,N))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const si=512/s.EXTENT/2;class Zt{constructor(r,u,m){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=m;for(let C=0;C<u.length;C++){const N=u.get(C),ee=N.key;this.indexedSymbolInstances[ee]||(this.indexedSymbolInstances[ee]=[]),this.indexedSymbolInstances[ee].push({crossTileID:N.crossTileID,coord:this.getScaledCoordinates(N,r)})}}getScaledCoordinates(r,u){const m=si/Math.pow(2,u.canonical.z-this.tileID.canonical.z);return{x:Math.floor((u.canonical.x*s.EXTENT+r.anchorX)*m),y:Math.floor((u.canonical.y*s.EXTENT+r.anchorY)*m)}}findMatches(r,u,m){const C=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let N=0;N<r.length;N++){const ee=r.get(N);if(ee.crossTileID)continue;const le=this.indexedSymbolInstances[ee.key];if(!le)continue;const de=this.getScaledCoordinates(ee,u);for(const be of le)if(Math.abs(be.coord.x-de.x)<=C&&Math.abs(be.coord.y-de.y)<=C&&!m[be.crossTileID]){m[be.crossTileID]=!0,ee.crossTileID=be.crossTileID;break}}}}class ui{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class gi{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const u=Math.round((r-this.lng)/360);if(u!==0)for(const m in this.indexes){const C=this.indexes[m],N={};for(const ee in C){const le=C[ee];le.tileID=le.tileID.unwrapTo(le.tileID.wrap+u),N[le.tileID.key]=le}this.indexes[m]=N}this.lng=r}addBucket(r,u,m){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let N=0;N<u.symbolInstances.length;N++)u.symbolInstances.get(N).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const C=this.usedCrossTileIDs[r.overscaledZ];for(const N in this.indexes){const ee=this.indexes[N];if(Number(N)>r.overscaledZ)for(const le in ee){const de=ee[le];de.tileID.isChildOf(r)&&de.findMatches(u.symbolInstances,r,C)}else{const le=ee[r.scaledTo(Number(N)).key];le&&le.findMatches(u.symbolInstances,r,C)}}for(let N=0;N<u.symbolInstances.length;N++){const ee=u.symbolInstances.get(N);ee.crossTileID||(ee.crossTileID=m.generate(),C[ee.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Zt(r,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(r,u){for(const m in u.indexedSymbolInstances)for(const C of u.indexedSymbolInstances[m])delete this.usedCrossTileIDs[r][C.crossTileID]}removeStaleBuckets(r){let u=!1;for(const m in this.indexes){const C=this.indexes[m];for(const N in C)r[C[N].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,C[N]),delete C[N],u=!0)}return u}}class zi{constructor(){this.layerIndexes={},this.crossTileIDs=new ui,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,u,m){let C=this.layerIndexes[r.id];C===void 0&&(C=this.layerIndexes[r.id]=new gi);let N=!1;const ee={};C.handleWrapJump(m);for(const le of u){const de=le.getBucket(r);de&&r.id===de.layerIds[0]&&(de.bucketInstanceId||(de.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(le.tileID,de,this.crossTileIDs)&&(N=!0),ee[de.bucketInstanceId]=!0)}return C.removeStaleBuckets(ee)&&(N=!0),N}pruneUnusedLayers(r){const u={};r.forEach(m=>{u[m]=!0});for(const m in this.layerIndexes)u[m]||delete this.layerIndexes[m]}}var yi=s.createLayout([{name:"a_pos",type:"Int16",components:2}]);class Si extends s.Evented{constructor(r){super(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=r._cache.max,r.usedForTerrain=!0,r.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const r in this._tiles){const u=this._tiles[r];u.textures.forEach(m=>m.destroy()),u.textures=[]}}update(r,u){this.sourceCache.update(r,u),this._renderableTilesKeys=[];for(const m of r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u}))this._renderableTilesKeys.push(m.key),this._tiles[m.key]||(m.posMatrix=new Float64Array(16),s.ortho(m.posMatrix,0,s.EXTENT,0,s.EXTENT,0,1),this._tiles[m.key]=new ge(m,this.tileSize))}removeOutdated(r){const u={};this.renderHistory=this.renderHistory.filter((m,C)=>this.renderHistory.indexOf(m)===C).slice(0,this.renderHistorySize);for(const m of this._renderableTilesKeys)u[m]=!0;for(const m of this.renderHistory)u[m]=!0;for(const m in this._tiles)u[m]||(this._tiles[m].clearTextures(r),delete this._tiles[m])}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r){const u={};for(const m of this._renderableTilesKeys){const C=this._tiles[m].tileID;if(C.canonical.equals(r.canonical)){const N=r.clone();N.posMatrix=new Float64Array(16),s.ortho(N.posMatrix,0,s.EXTENT,0,s.EXTENT,0,1),u[m]=N}else if(C.canonical.isChildOf(r.canonical)){const N=r.clone();N.posMatrix=new Float64Array(16);const ee=C.canonical.z-r.canonical.z,le=C.canonical.x-(C.canonical.x>>ee<<ee),de=C.canonical.y-(C.canonical.y>>ee<<ee),be=s.EXTENT>>ee;s.ortho(N.posMatrix,0,be,0,be,0,1),s.translate(N.posMatrix,N.posMatrix,[-le*be,-de*be,0]),u[m]=N}else if(r.canonical.isChildOf(C.canonical)){const N=r.clone();N.posMatrix=new Float64Array(16);const ee=r.canonical.z-C.canonical.z,le=r.canonical.x-(r.canonical.x>>ee<<ee),de=r.canonical.y-(r.canonical.y>>ee<<ee),be=s.EXTENT>>ee;s.ortho(N.posMatrix,0,s.EXTENT,0,s.EXTENT,0,1),s.translate(N.posMatrix,N.posMatrix,[le*be,de*be,0]),s.scale(N.posMatrix,N.posMatrix,[1/2**ee,1/2**ee,0]),u[m]=N}}return u}getSourceTile(r,u){const m=this.sourceCache._source;let C=r.overscaledZ-this.deltaZoom;if(C>m.maxzoom&&(C=m.maxzoom),C<m.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(C).key);let N=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!N||!N.dem)&&u)for(;C>=m.minzoom&&(!N||!N.dem);)N=this.sourceCache.getTileByID(r.scaledTo(C--).key);return N}tilesAfterTime(r=Date.now()){return Object.values(this._tiles).filter(u=>u.timeLoaded>=r)}}class Ni{constructor(r,u,m){this.style=r,this.sourceCache=new Si(u),this.options=m,this.exaggeration=typeof m.exaggeration=="number"?m.exaggeration:1,this.elevationOffset=typeof m.elevationOffset=="number"?m.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(r,u,m,C=s.EXTENT){if(!(u>=0&&u<C&&m>=0&&m<C))return this.elevationOffset;let N=0;const ee=this.getTerrainData(r);if(ee.tile&&ee.tile.dem){const le=s.transformMat4$1([],[u/C*s.EXTENT,m/C*s.EXTENT],ee.u_terrain_matrix),de=[le[0]*ee.tile.dem.dim,le[1]*ee.tile.dem.dim],be=[Math.floor(de[0]),Math.floor(de[1])],Ae=ee.tile.dem.get(be[0],be[1]),ze=ee.tile.dem.get(be[0],be[1]+1),Ge=ee.tile.dem.get(be[0]+1,be[1]),et=ee.tile.dem.get(be[0]+1,be[1]+1);N=s.number(s.number(Ae,ze,de[0]-be[0]),s.number(Ge,et,de[0]-be[0]),de[1]-be[1])}return N}rememberForRerender(r,u){for(const m in this.sourceCache._tiles){const C=this.sourceCache._tiles[m];(C.tileID.equals(u)||C.tileID.isChildOf(u))&&(r===this.sourceCache.sourceCache.id&&(C.timeLoaded=Date.now()),this._rerender[r]=this._rerender[r]||{},this._rerender[r][C.tileID.key]=!0)}}needsRerender(r,u){return this._rerender[r]&&this._rerender[r][u.key]}clearRerenderCache(){this._rerender={}}getElevation(r,u,m,C=s.EXTENT){return(this.getDEMElevation(r,u,m,C)+this.elevationOffset)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const C=this.style.map.painter.context,N=new s.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new S(C,N,C.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new S(C,new s.RGBAImage({width:1,height:1}),C.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.identity([])}const u=this.sourceCache.getSourceTile(r,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const C=this.style.map.painter.context;u.demTexture=this.style.map.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new S(C,u.dem.getPixels(),C.gl.RGBA,{premultiply:!1}),u.demTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const m=u&&u+u.tileID.key+r.key;if(m&&!this._demMatrixCache[m]){const C=this.sourceCache.sourceCache._source.maxzoom;let N=r.canonical.z-u.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=C?N=r.canonical.z-C:s.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const ee=r.canonical.x-(r.canonical.x>>N<<N),le=r.canonical.y-(r.canonical.y>>N<<N),de=s.fromScaling(new Float64Array(16),[1/(s.EXTENT<<N),1/(s.EXTENT<<N),0]);s.translate(de,de,[ee*s.EXTENT,le*s.EXTENT,0]),this._demMatrixCache[r.key]={matrix:de,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:m?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getRTTFramebuffer(){const r=this.style.map.painter;if(!this._rttFramebuffer){const u=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=r.context.createFramebuffer(u,u,!0),this._rttFramebuffer.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,u,u))}return this._rttFramebuffer}getFramebuffer(r){const u=this.style.map.painter,m=u.width/devicePixelRatio,C=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===m&&this._fbo.height===C||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new S(u.context,{width:m,height:C,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new S(u.context,{width:m,height:C,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(m,C,!0),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,m,C))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let N=0,ee=0;N<this._coordsTextureSize;N++)for(let le=0;le<this._coordsTextureSize;le++,ee+=4)u[ee+0]=255&le,u[ee+1]=255&N,u[ee+2]=le>>8<<4|N>>8,u[ee+3]=0;const m=new s.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),C=new S(r,m,r.gl.RGBA,{premultiply:!1});return C.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=C,C}pointCoordinate(r){const u=new Uint8Array(4),m=this.style.map.painter,C=m.context,N=C.gl;C.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),N.readPixels(r.x,m.height/devicePixelRatio-r.y-1,1,1,N.RGBA,N.UNSIGNED_BYTE,u),C.bindFramebuffer.set(null);const ee=u[0]+(u[2]>>4<<8),le=u[1]+((15&u[2])<<8),de=this.coordsIndex[255-u[3]],be=de&&this.sourceCache.getTileByID(de);if(!be)return null;const Ae=this._coordsTextureSize,ze=(1<<be.tileID.canonical.z)*Ae;return new s.MercatorCoordinate((be.tileID.canonical.x*Ae+ee)/ze,(be.tileID.canonical.y*Ae+le)/ze,this.getElevation(be.tileID,ee,le,Ae))}getTerrainMesh(){if(this._mesh)return this._mesh;const r=this.style.map.painter.context,u=new s.PosArray,m=new s.TriangleIndexArray,C=this.meshSize,N=s.EXTENT/C,ee=C*C;for(let le=0;le<=C;le++)for(let de=0;de<=C;de++)u.emplaceBack(de*N,le*N);for(let le=0;le<ee;le+=C+1)for(let de=0;de<C;de++)m.emplaceBack(de+le,C+de+le+1,C+de+le+2),m.emplaceBack(de+le,C+de+le+2,de+le+1);return this._mesh={indexBuffer:r.createIndexBuffer(m),vertexBuffer:r.createVertexBuffer(u,yi.members),segments:s.SegmentVector.simpleSegment(0,0,u.length,m.length)},this._mesh}getMinMaxElevation(r){const u=this.getTerrainData(r).tile,m={minElevation:null,maxElevation:null};return u&&u.dem&&(m.minElevation=(u.dem.min+this.elevationOffset)*this.exaggeration,m.maxElevation=(u.dem.max+this.elevationOffset)*this.exaggeration),m}}const Li=(T,r)=>s.emitValidationErrors(T,r&&r.filter(u=>u.identifier!=="source.canvas")),rr=s.pick(Ce,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ar=s.pick(Ce,["setCenter","setZoom","setBearing","setPitch"]),Jr=function(){const T={},r=s.spec.$version;for(const u in s.spec.$root){const m=s.spec.$root[u];if(m.required){let C=null;C=u==="version"?r:m.type==="array"?[]:{},C!=null&&(T[u]=C)}}return T}();class _n extends s.Evented{constructor(r,u={}){super(),this.map=r,this.dispatcher=new Z(xe(),this),this.imageManager=new A,this.imageManager.setEventedParent(this),this.glyphManager=new w(r._requestManager,u.localIdeographFontFamily),this.lineAtlas=new X(256,512),this.crossTileSymbolIndex=new zi,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const m=this;this._rtlTextPluginCallback=_n.registerForPluginStateChange(C=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:C.pluginStatus,pluginURL:C.pluginURL},(N,ee)=>{if(s.triggerPluginCompletionEvent(N),ee&&ee.every(le=>le))for(const le in m.sourceCaches)m.sourceCaches[le].reload()})}),this.on("data",C=>{if(C.dataType!=="source"||C.sourceDataType!=="metadata")return;const N=this.sourceCaches[C.sourceId];if(!N)return;const ee=N.getSource();if(ee&&ee.vectorLayerIds)for(const le in this._layers){const de=this._layers[le];de.source===ee.id&&this._validateLayer(de)}})}loadURL(r,u={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const m=typeof u.validate!="boolean"||u.validate,C=this.map._requestManager.transformRequest(r,s.ResourceType.Style);this._request=s.getJSON(C,(N,ee)=>{this._request=null,N?this.fire(new s.ErrorEvent(N)):ee&&this._load(ee,m)})}loadJSON(r,u={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(r,u.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Jr,!1)}_load(r,u){if(u&&Li(this,s.validateStyle(r)))return;this._loaded=!0,this.stylesheet=r;for(const C in r.sources)this.addSource(C,r.sources[C],{validate:!1});r.sprite?this._loadSprite(r.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(r.glyphs);const m=_e(this.stylesheet.layers);this._order=m.map(C=>C.id),this._layers={},this._serializedLayers={};for(let C of m)C=s.createStyleLayer(C),C.setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Y(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}_loadSprite(r){this._spriteRequest=function(u,m,C,N){let ee,le,de;const be=C>1?"@2x":"";let Ae=s.getJSON(m.transformRequest(m.normalizeSpriteURL(u,be,".json"),s.ResourceType.SpriteJSON),(et,Qe)=>{Ae=null,de||(de=et,ee=Qe,Ge())}),ze=s.getImage(m.transformRequest(m.normalizeSpriteURL(u,be,".png"),s.ResourceType.SpriteImage),(et,Qe)=>{ze=null,de||(de=et,le=Qe,Ge())});function Ge(){if(de)N(de);else if(ee&&le){const et=s.exported.getImageData(le),Qe={};for(const Je in ee){const{width:dt,height:gt,x:vt,y:nt,sdf:kt,pixelRatio:_t,stretchX:Ot,stretchY:zt,content:Ut}=ee[Je],Dt=new s.RGBAImage({width:dt,height:gt});s.RGBAImage.copy(et,Dt,{x:vt,y:nt},{x:0,y:0},{width:dt,height:gt}),Qe[Je]={data:Dt,pixelRatio:_t,sdf:kt,stretchX:Ot,stretchY:zt,content:Ut}}N(null,Qe)}}return{cancel(){Ae&&(Ae.cancel(),Ae=null),ze&&(ze.cancel(),ze=null)}}}(r,this.map._requestManager,this.map.getPixelRatio(),(u,m)=>{if(this._spriteRequest=null,u)this.fire(new s.ErrorEvent(u));else if(m)for(const C in m)this.imageManager.addImage(C,m[C]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(r){const u=this.sourceCaches[r.source];if(!u)return;const m=r.sourceLayer;if(!m)return;const C=u.getSource();(C.type==="geojson"||C.vectorLayerIds&&C.vectorLayerIds.indexOf(m)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${m}" does not exist on source "${C.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const u=[];for(const m of r){const C=this._layers[m];C.type!=="custom"&&u.push(C.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const u=this._changed;if(this._changed){const C=Object.keys(this._updatedLayers),N=Object.keys(this._removedLayers);(C.length||N.length)&&this._updateWorkerLayers(C,N);for(const ee in this._updatedSources){const le=this._updatedSources[ee];if(le==="reload")this._reloadSource(ee);else{if(le!=="clear")throw new Error(`Invalid action ${le}`);this._clearSource(ee)}}this._updateTilesForChangedImages();for(const ee in this._updatedPaintProps)this._layers[ee].updateTransitions(r);this.light.updateTransitions(r),this._resetUpdates()}const m={};for(const C in this.sourceCaches){const N=this.sourceCaches[C];m[C]=N.used,N.used=!1}for(const C of this._order){const N=this._layers[C];N.recalculate(r,this._availableImages),!N.isHidden(r.zoom)&&N.source&&(this.sourceCaches[N.source].used=!0)}for(const C in m){const N=this.sourceCaches[C];m[C]!==N.used&&N.fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:C}))}this.light.recalculate(r),this.z=r.zoom,u&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(r){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),r){const u=this.sourceCaches[r.source];if(!u)throw new Error(`cannot load terrain, because there exists no source with ID: ${r.source}`);this.terrain=new Ni(this,u,r),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=m=>{m.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=m=>{m.tile&&(m.sourceId===r.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(m.sourceId,m.tile.tileID)):m.source.type==="geojson"&&this.terrain.rememberForRerender(m.sourceId,m.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new s.Event("terrain",{terrain:r}))}setState(r){if(this._checkLoaded(),Li(this,s.validateStyle(r)))return!1;(r=s.clone$1(r)).layers=_e(r.layers);const u=function(C,N){if(!C)return[{command:Ce.setStyle,args:[N]}];let ee=[];try{if(!v(C.version,N.version))return[{command:Ce.setStyle,args:[N]}];v(C.center,N.center)||ee.push({command:Ce.setCenter,args:[N.center]}),v(C.zoom,N.zoom)||ee.push({command:Ce.setZoom,args:[N.zoom]}),v(C.bearing,N.bearing)||ee.push({command:Ce.setBearing,args:[N.bearing]}),v(C.pitch,N.pitch)||ee.push({command:Ce.setPitch,args:[N.pitch]}),v(C.sprite,N.sprite)||ee.push({command:Ce.setSprite,args:[N.sprite]}),v(C.glyphs,N.glyphs)||ee.push({command:Ce.setGlyphs,args:[N.glyphs]}),v(C.transition,N.transition)||ee.push({command:Ce.setTransition,args:[N.transition]}),v(C.light,N.light)||ee.push({command:Ce.setLight,args:[N.light]});const le={},de=[];(function(Ae,ze,Ge,et){let Qe;for(Qe in ze=ze||{},Ae=Ae||{})Object.prototype.hasOwnProperty.call(Ae,Qe)&&(Object.prototype.hasOwnProperty.call(ze,Qe)||Ue(Qe,Ge,et));for(Qe in ze)Object.prototype.hasOwnProperty.call(ze,Qe)&&(Object.prototype.hasOwnProperty.call(Ae,Qe)?v(Ae[Qe],ze[Qe])||(Ae[Qe].type==="geojson"&&ze[Qe].type==="geojson"&&Pe(Ae,ze,Qe)?Ge.push({command:Ce.setGeoJSONSourceData,args:[Qe,ze[Qe].data]}):Xe(Qe,ze,Ge,et)):Le(Qe,ze,Ge))})(C.sources,N.sources,de,le);const be=[];C.layers&&C.layers.forEach(Ae=>{le[Ae.source]?ee.push({command:Ce.removeLayer,args:[Ae.id]}):be.push(Ae)}),ee=ee.concat(de),function(Ae,ze,Ge){ze=ze||[];const et=(Ae=Ae||[]).map(Ie),Qe=ze.map(Ie),Je=Ae.reduce(Oe,{}),dt=ze.reduce(Oe,{}),gt=et.slice(),vt=Object.create(null);let nt,kt,_t,Ot,zt,Ut,Dt;for(nt=0,kt=0;nt<et.length;nt++)_t=et[nt],Object.prototype.hasOwnProperty.call(dt,_t)?kt++:(Ge.push({command:Ce.removeLayer,args:[_t]}),gt.splice(gt.indexOf(_t,kt),1));for(nt=0,kt=0;nt<Qe.length;nt++)_t=Qe[Qe.length-1-nt],gt[gt.length-1-nt]!==_t&&(Object.prototype.hasOwnProperty.call(Je,_t)?(Ge.push({command:Ce.removeLayer,args:[_t]}),gt.splice(gt.lastIndexOf(_t,gt.length-kt),1)):kt++,Ut=gt[gt.length-nt],Ge.push({command:Ce.addLayer,args:[dt[_t],Ut]}),gt.splice(gt.length-nt,0,_t),vt[_t]=!0);for(nt=0;nt<Qe.length;nt++)if(_t=Qe[nt],Ot=Je[_t],zt=dt[_t],!vt[_t]&&!v(Ot,zt))if(v(Ot.source,zt.source)&&v(Ot["source-layer"],zt["source-layer"])&&v(Ot.type,zt.type)){for(Dt in Ee(Ot.layout,zt.layout,Ge,_t,null,Ce.setLayoutProperty),Ee(Ot.paint,zt.paint,Ge,_t,null,Ce.setPaintProperty),v(Ot.filter,zt.filter)||Ge.push({command:Ce.setFilter,args:[_t,zt.filter]}),v(Ot.minzoom,zt.minzoom)&&v(Ot.maxzoom,zt.maxzoom)||Ge.push({command:Ce.setLayerZoomRange,args:[_t,zt.minzoom,zt.maxzoom]}),Ot)Object.prototype.hasOwnProperty.call(Ot,Dt)&&Dt!=="layout"&&Dt!=="paint"&&Dt!=="filter"&&Dt!=="metadata"&&Dt!=="minzoom"&&Dt!=="maxzoom"&&(Dt.indexOf("paint.")===0?Ee(Ot[Dt],zt[Dt],Ge,_t,Dt.slice(6),Ce.setPaintProperty):v(Ot[Dt],zt[Dt])||Ge.push({command:Ce.setLayerProperty,args:[_t,Dt,zt[Dt]]}));for(Dt in zt)Object.prototype.hasOwnProperty.call(zt,Dt)&&!Object.prototype.hasOwnProperty.call(Ot,Dt)&&Dt!=="layout"&&Dt!=="paint"&&Dt!=="filter"&&Dt!=="metadata"&&Dt!=="minzoom"&&Dt!=="maxzoom"&&(Dt.indexOf("paint.")===0?Ee(Ot[Dt],zt[Dt],Ge,_t,Dt.slice(6),Ce.setPaintProperty):v(Ot[Dt],zt[Dt])||Ge.push({command:Ce.setLayerProperty,args:[_t,Dt,zt[Dt]]}))}else Ge.push({command:Ce.removeLayer,args:[_t]}),Ut=gt[gt.lastIndexOf(_t)+1],Ge.push({command:Ce.addLayer,args:[zt,Ut]})}(be,N.layers,ee)}catch(le){console.warn("Unable to compute style diff:",le),ee=[{command:Ce.setStyle,args:[N]}]}return ee}(this.serialize(),r).filter(C=>!(C.command in Ar));if(u.length===0)return!1;const m=u.filter(C=>!(C.command in rr));if(m.length>0)throw new Error(`Unimplemented: ${m.map(C=>C.command).join(", ")}.`);return u.forEach(C=>{C.command!=="setTransition"&&this[C.command].apply(this,C.args)}),this.stylesheet=r,!0}addImage(r,u){if(this.getImage(r))return this.fire(new s.ErrorEvent(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,u),this._afterImageUpdated(r)}updateImage(r,u){this.imageManager.updateImage(r,u)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new s.ErrorEvent(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,u,m={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(s.validateStyle.source,`sources.${r}`,u,null,m))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const C=this.sourceCaches[r]=new Q(r,u,this.dispatcher);C.style=this,C.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:C.serialize(),sourceId:r})),C.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const m in this._layers)if(this._layers[m].source===r)return this.fire(new s.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${m}" is using it.`)));const u=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],u.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,u){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const m=this.sourceCaches[r].getSource();if(m.type!=="geojson")throw new Error(`geojsonSource.type is ${m.type}, which is !== 'geojson`);m.setData(u),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,u,m={}){this._checkLoaded();const C=r.id;if(this.getLayer(C))return void this.fire(new s.ErrorEvent(new Error(`Layer "${C}" already exists on this map.`)));let N;if(r.type==="custom"){if(Li(this,s.validateCustomStyleLayer(r)))return;N=s.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(C,r.source),r=s.clone$1(r),r=s.extend(r,{source:C})),this._validate(s.validateStyle.layer,`layers.${C}`,r,{arrayIndex:-1},m))return;N=s.createStyleLayer(r),this._validateLayer(N),N.setEventedParent(this,{layer:{id:C}}),this._serializedLayers[N.id]=N.serialize()}const ee=u?this._order.indexOf(u):this._order.length;if(u&&ee===-1)this.fire(new s.ErrorEvent(new Error(`Cannot add layer "${C}" before non-existing layer "${u}".`)));else{if(this._order.splice(ee,0,C),this._layerOrderChanged=!0,this._layers[C]=N,this._removedLayers[C]&&N.source&&N.type!=="custom"){const le=this._removedLayers[C];delete this._removedLayers[C],le.type!==N.type?this._updatedSources[N.source]="clear":(this._updatedSources[N.source]="reload",this.sourceCaches[N.source].pause())}this._updateLayer(N),N.onAdd&&N.onAdd(this.map)}}moveLayer(r,u){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new s.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===u)return;const m=this._order.indexOf(r);this._order.splice(m,1);const C=u?this._order.indexOf(u):this._order.length;u&&C===-1?this.fire(new s.ErrorEvent(new Error(`Cannot move layer "${r}" before non-existing layer "${u}".`))):(this._order.splice(C,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const u=this._layers[r];if(!u)return void this.fire(new s.ErrorEvent(new Error(`Cannot remove non-existing layer "${r}".`)));u.setEventedParent(null);const m=this._order.indexOf(r);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=u,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],u.onRemove&&u.onRemove(this.map)}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,u,m){this._checkLoaded();const C=this.getLayer(r);C?C.minzoom===u&&C.maxzoom===m||(u!=null&&(C.minzoom=u),m!=null&&(C.maxzoom=m),this._updateLayer(C)):this.fire(new s.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,u,m={}){this._checkLoaded();const C=this.getLayer(r);if(C){if(!v(C.filter,u))return u==null?(C.filter=void 0,void this._updateLayer(C)):void(this._validate(s.validateStyle.filter,`layers.${C.id}.filter`,u,null,m)||(C.filter=s.clone$1(u),this._updateLayer(C)))}else this.fire(new s.ErrorEvent(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return s.clone$1(this.getLayer(r).filter)}setLayoutProperty(r,u,m,C={}){this._checkLoaded();const N=this.getLayer(r);N?v(N.getLayoutProperty(u),m)||(N.setLayoutProperty(u,m,C),this._updateLayer(N)):this.fire(new s.ErrorEvent(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,u){const m=this.getLayer(r);if(m)return m.getLayoutProperty(u);this.fire(new s.ErrorEvent(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,u,m,C={}){this._checkLoaded();const N=this.getLayer(r);N?v(N.getPaintProperty(u),m)||(N.setPaintProperty(u,m,C)&&this._updateLayer(N),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new s.ErrorEvent(new Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(r,u){return this.getLayer(r).getPaintProperty(u)}setFeatureState(r,u){this._checkLoaded();const m=r.source,C=r.sourceLayer,N=this.sourceCaches[m];if(N===void 0)return void this.fire(new s.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const ee=N.getSource().type;ee==="geojson"&&C?this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):ee!=="vector"||C?(r.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),N.setFeatureState(C,r.id,u)):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,u){this._checkLoaded();const m=r.source,C=this.sourceCaches[m];if(C===void 0)return void this.fire(new s.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const N=C.getSource().type,ee=N==="vector"?r.sourceLayer:void 0;N!=="vector"||ee?u&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):C.removeFeatureState(ee,r.id,u):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const u=r.source,m=r.sourceLayer,C=this.sourceCaches[u];if(C!==void 0)return C.getSource().type!=="vector"||m?(r.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),C.getFeatureState(m,r.id)):void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:s.mapObject(this.sourceCaches,r=>r.serialize()),layers:this._serializeLayers(this._order)},r=>r!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(r){const u=ee=>this._layers[ee].type==="fill-extrusion",m={},C=[];for(let ee=this._order.length-1;ee>=0;ee--){const le=this._order[ee];if(u(le)){m[le]=ee;for(const de of r){const be=de[le];if(be)for(const Ae of be)C.push(Ae)}}}C.sort((ee,le)=>le.intersectionZ-ee.intersectionZ);const N=[];for(let ee=this._order.length-1;ee>=0;ee--){const le=this._order[ee];if(u(le))for(let de=C.length-1;de>=0;de--){const be=C[de].feature;if(m[be.layer.id]<ee)break;N.push(be),C.pop()}else for(const de of r){const be=de[le];if(be)for(const Ae of be)N.push(Ae.feature)}}return N}queryRenderedFeatures(r,u,m){u&&u.filter&&this._validate(s.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);const C={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const ee of u.layers){const le=this._layers[ee];if(!le)return this.fire(new s.ErrorEvent(new Error(`The layer '${ee}' does not exist in the map's style and cannot be queried for features.`))),[];C[le.source]=!0}}const N=[];u.availableImages=this._availableImages;for(const ee in this.sourceCaches)u.layers&&!C[ee]||N.push(oe(this.sourceCaches[ee],this._layers,this._serializedLayers,r,u,m));return this.placement&&N.push(function(ee,le,de,be,Ae,ze,Ge){const et={},Qe=ze.queryRenderedSymbols(be),Je=[];for(const dt of Object.keys(Qe).map(Number))Je.push(Ge[dt]);Je.sort(Te);for(const dt of Je){const gt=dt.featureIndex.lookupSymbolFeatures(Qe[dt.bucketInstanceId],le,dt.bucketIndex,dt.sourceLayerIndex,Ae.filter,Ae.layers,Ae.availableImages,ee);for(const vt in gt){const nt=et[vt]=et[vt]||[],kt=gt[vt];kt.sort((_t,Ot)=>{const zt=dt.featureSortOrder;if(zt){const Ut=zt.indexOf(_t.featureIndex);return zt.indexOf(Ot.featureIndex)-Ut}return Ot.featureIndex-_t.featureIndex});for(const _t of kt)nt.push(_t)}}for(const dt in et)et[dt].forEach(gt=>{const vt=gt.feature,nt=de[ee[dt].source].getFeatureState(vt.layer["source-layer"],vt.id);vt.source=vt.layer.source,vt.layer["source-layer"]&&(vt.sourceLayer=vt.layer["source-layer"]),vt.state=nt});return et}(this._layers,this._serializedLayers,this.sourceCaches,r,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(N)}querySourceFeatures(r,u){u&&u.filter&&this._validate(s.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);const m=this.sourceCaches[r];return m?function(C,N){const ee=C.getRenderableIds().map(be=>C.getTileByID(be)),le=[],de={};for(let be=0;be<ee.length;be++){const Ae=ee[be],ze=Ae.tileID.canonical.key;de[ze]||(de[ze]=!0,Ae.querySourceFeatures(le,N))}return le}(m,u):[]}addSourceType(r,u,m){return _n.getSourceType(r)?m(new Error(`A source type called "${r}" already exists.`)):(_n.setSourceType(r,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:u.workerSourceURL},m):m(null,null))}getLight(){return this.light.getLight()}setLight(r,u={}){this._checkLoaded();const m=this.light.getLight();let C=!1;for(const ee in r)if(!v(r[ee],m[ee])){C=!0;break}if(!C)return;const N={now:s.exported.now(),transition:s.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,u),this.light.updateTransitions(N)}_validate(r,u,m,C,N={}){return(!N||N.validate!==!1)&&Li(this,r.call(s.validateStyle,s.extend({key:u,style:this.serialize(),value:m,styleSpec:s.spec},C)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const u=this.sourceCaches[r];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const u in this.sourceCaches)this.sourceCaches[u].update(r,this.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,u,m,C,N=!1){let ee=!1,le=!1;const de={};for(const be of this._order){const Ae=this._layers[be];if(Ae.type!=="symbol")continue;if(!de[Ae.source]){const Ge=this.sourceCaches[Ae.source];de[Ae.source]=Ge.getRenderableIds(!0).map(et=>Ge.getTileByID(et)).sort((et,Qe)=>Qe.tileID.overscaledZ-et.tileID.overscaledZ||(et.tileID.isLessThan(Qe.tileID)?-1:1))}const ze=this.crossTileSymbolIndex.addLayer(Ae,de[Ae.source],r.center.lng);ee=ee||ze}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((N=N||this._layerOrderChanged||m===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),r.zoom))&&(this.pauseablePlacement=new It(r,this.terrain,this._order,N,u,m,C,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,de),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),le=!0),ee&&this.pauseablePlacement.placement.setStale()),le||ee)for(const be of this._order){const Ae=this._layers[be];Ae.type==="symbol"&&this.placement.updateLayerOpacities(Ae,de[Ae.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,u,m){this.imageManager.getImages(u.icons,m),this._updateTilesForChangedImages();const C=this.sourceCaches[u.source];C&&C.setDependencies(u.tileID.key,u.type,u.icons)}getGlyphs(r,u,m){this.glyphManager.getGlyphs(u.stacks,m)}getResource(r,u,m){return s.makeRequest(u,m)}}_n.getSourceType=function(T){return ue[T]},_n.setSourceType=function(T,r){ue[T]=r},_n.registerForPluginStateChange=s.registerForPluginStateChange;var qh="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const Sl={prelude:Er(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Er(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Er(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Er(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Er("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Er(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Er(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Er("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Er("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Er("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Er(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Er(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Er(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Er(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Er(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Er(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Er(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Er(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Er(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Er(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Er(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Er("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",qh),terrainDepth:Er("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",qh),terrainCoords:Er("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",qh)};function Er(T,r){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=r.match(/attribute ([\w]+) ([\w]+)/g),C=T.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),N=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),ee=N?N.concat(C):C,le={};return{fragmentSource:T=T.replace(u,(de,be,Ae,ze,Ge)=>(le[Ge]=!0,be==="define"?`
#ifndef HAS_UNIFORM_u_${Ge}
varying ${Ae} ${ze} ${Ge};
#else
uniform ${Ae} ${ze} u_${Ge};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Ge}
    ${Ae} ${ze} ${Ge} = u_${Ge};
#endif
`)),vertexSource:r=r.replace(u,(de,be,Ae,ze,Ge)=>{const et=ze==="float"?"vec2":"vec4",Qe=Ge.match(/color/)?"color":et;return le[Ge]?be==="define"?`
#ifndef HAS_UNIFORM_u_${Ge}
uniform lowp float u_${Ge}_t;
attribute ${Ae} ${et} a_${Ge};
varying ${Ae} ${ze} ${Ge};
#else
uniform ${Ae} ${ze} u_${Ge};
#endif
`:Qe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Ge}
    ${Ge} = a_${Ge};
#else
    ${Ae} ${ze} ${Ge} = u_${Ge};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Ge}
    ${Ge} = unpack_mix_${Qe}(a_${Ge}, u_${Ge}_t);
#else
    ${Ae} ${ze} ${Ge} = u_${Ge};
#endif
`:be==="define"?`
#ifndef HAS_UNIFORM_u_${Ge}
uniform lowp float u_${Ge}_t;
attribute ${Ae} ${et} a_${Ge};
#else
uniform ${Ae} ${ze} u_${Ge};
#endif
`:Qe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Ge}
    ${Ae} ${ze} ${Ge} = a_${Ge};
#else
    ${Ae} ${ze} ${Ge} = u_${Ge};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Ge}
    ${Ae} ${ze} ${Ge} = unpack_mix_${Qe}(a_${Ge}, u_${Ge}_t);
#else
    ${Ae} ${ze} ${Ge} = u_${Ge};
#endif
`}),staticAttributes:m,staticUniforms:ee}}class ym{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,u,m,C,N,ee,le,de,be){this.context=r;let Ae=this.boundPaintVertexBuffers.length!==C.length;for(let ze=0;!Ae&&ze<C.length;ze++)this.boundPaintVertexBuffers[ze]!==C[ze]&&(Ae=!0);r.extVertexArrayObject&&this.vao&&this.boundProgram===u&&this.boundLayoutVertexBuffer===m&&!Ae&&this.boundIndexBuffer===N&&this.boundVertexOffset===ee&&this.boundDynamicVertexBuffer===le&&this.boundDynamicVertexBuffer2===de&&this.boundDynamicVertexBuffer3===be?(r.bindVertexArrayOES.set(this.vao),le&&le.bind(),N&&N.dynamicDraw&&N.bind(),de&&de.bind(),be&&be.bind()):this.freshBind(u,m,C,N,ee,le,de,be)}freshBind(r,u,m,C,N,ee,le,de){let be;const Ae=r.numAttributes,ze=this.context,Ge=ze.gl;if(ze.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ze.extVertexArrayObject.createVertexArrayOES(),ze.bindVertexArrayOES.set(this.vao),be=0,this.boundProgram=r,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=C,this.boundVertexOffset=N,this.boundDynamicVertexBuffer=ee,this.boundDynamicVertexBuffer2=le,this.boundDynamicVertexBuffer3=de;else{be=ze.currentNumAttributes||0;for(let et=Ae;et<be;et++)Ge.disableVertexAttribArray(et)}u.enableAttributes(Ge,r);for(const et of m)et.enableAttributes(Ge,r);ee&&ee.enableAttributes(Ge,r),le&&le.enableAttributes(Ge,r),de&&de.enableAttributes(Ge,r),u.bind(),u.setVertexAttribPointers(Ge,r,N);for(const et of m)et.bind(),et.setVertexAttribPointers(Ge,r,N);ee&&(ee.bind(),ee.setVertexAttribPointers(Ge,r,N)),C&&C.bind(),le&&(le.bind(),le.setVertexAttribPointers(Ge,r,N)),de&&(de.bind(),de.setVertexAttribPointers(Ge,r,N)),ze.currentNumAttributes=Ae}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Pc(T){const r=[];for(let u=0;u<T.length;u++){if(T[u]===null)continue;const m=T[u].split(" ");r.push(m.pop())}return r}class xm{constructor(r,u,m,C,N,ee,le){const de=r.gl;this.program=de.createProgram();const be=Pc(m.staticAttributes),Ae=C?C.getBinderAttributes():[],ze=be.concat(Ae),Ge=Sl.prelude.staticUniforms?Pc(Sl.prelude.staticUniforms):[],et=m.staticUniforms?Pc(m.staticUniforms):[],Qe=C?C.getBinderUniforms():[],Je=Ge.concat(et).concat(Qe),dt=[];for(const zt of Je)dt.indexOf(zt)<0&&dt.push(zt);const gt=C?C.defines():[];ee&&gt.push("#define OVERDRAW_INSPECTOR;"),le&&gt.push("#define TERRAIN3D;");const vt=gt.concat(Sl.prelude.fragmentSource,m.fragmentSource).join(`
`),nt=gt.concat(Sl.prelude.vertexSource,m.vertexSource).join(`
`),kt=de.createShader(de.FRAGMENT_SHADER);if(de.isContextLost())return void(this.failedToCreate=!0);de.shaderSource(kt,vt),de.compileShader(kt),de.attachShader(this.program,kt);const _t=de.createShader(de.VERTEX_SHADER);if(de.isContextLost())return void(this.failedToCreate=!0);de.shaderSource(_t,nt),de.compileShader(_t),de.attachShader(this.program,_t),this.attributes={};const Ot={};this.numAttributes=ze.length;for(let zt=0;zt<this.numAttributes;zt++)ze[zt]&&(de.bindAttribLocation(this.program,zt,ze[zt]),this.attributes[ze[zt]]=zt);de.linkProgram(this.program),de.deleteShader(_t),de.deleteShader(kt);for(let zt=0;zt<dt.length;zt++){const Ut=dt[zt];if(Ut&&!Ot[Ut]){const Dt=de.getUniformLocation(this.program,Ut);Dt&&(Ot[Ut]=Dt)}}this.fixedUniforms=N(r,Ot),this.terrainUniforms=((zt,Ut)=>({u_depth:new s.Uniform1i(zt,Ut.u_depth),u_terrain:new s.Uniform1i(zt,Ut.u_terrain),u_terrain_dim:new s.Uniform1f(zt,Ut.u_terrain_dim),u_terrain_matrix:new s.UniformMatrix4f(zt,Ut.u_terrain_matrix),u_terrain_unpack:new s.Uniform4f(zt,Ut.u_terrain_unpack),u_terrain_offset:new s.Uniform1f(zt,Ut.u_terrain_offset),u_terrain_exaggeration:new s.Uniform1f(zt,Ut.u_terrain_exaggeration)}))(r,Ot),this.binderUniforms=C?C.getUniforms(r,Ot):[]}draw(r,u,m,C,N,ee,le,de,be,Ae,ze,Ge,et,Qe,Je,dt,gt,vt){const nt=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(m),r.setStencilMode(C),r.setColorMode(N),r.setCullFace(ee),de){r.activeTexture.set(nt.TEXTURE2),nt.bindTexture(nt.TEXTURE_2D,de.depthTexture),r.activeTexture.set(nt.TEXTURE3),nt.bindTexture(nt.TEXTURE_2D,de.texture);for(const _t in this.terrainUniforms)this.terrainUniforms[_t].set(de[_t])}for(const _t in this.fixedUniforms)this.fixedUniforms[_t].set(le[_t]);Je&&Je.setUniforms(r,this.binderUniforms,et,{zoom:Qe});let kt=0;switch(u){case nt.LINES:kt=2;break;case nt.TRIANGLES:kt=3;break;case nt.LINE_STRIP:kt=1}for(const _t of Ge.get()){const Ot=_t.vaos||(_t.vaos={});(Ot[be]||(Ot[be]=new ym)).bind(r,this,Ae,Je?Je.getPaintVertexBuffers():[],ze,_t.vertexOffset,dt,gt,vt),nt.drawElements(u,_t.primitiveLength*kt,nt.UNSIGNED_SHORT,_t.primitiveOffset*kt*2)}}}function Xh(T,r,u){const m=1/Xi(u,1,r.transform.tileZoom),C=Math.pow(2,u.tileID.overscaledZ),N=u.tileSize*Math.pow(2,r.transform.tileZoom)/C,ee=N*(u.tileID.canonical.x+u.tileID.wrap*C),le=N*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[m,T.fromScale,T.toScale],u_fade:T.t,u_pixel_coord_upper:[ee>>16,le>>16],u_pixel_coord_lower:[65535&ee,65535&le]}}const Hd=(T,r,u,m)=>{const C=r.style.light,N=C.properties.get("position"),ee=[N.x,N.y,N.z],le=s.create$1();C.properties.get("anchor")==="viewport"&&s.fromRotation(le,-r.transform.angle),s.transformMat3(ee,ee,le);const de=C.properties.get("color");return{u_matrix:T,u_lightpos:ee,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[de.r,de.g,de.b],u_vertical_gradient:+u,u_opacity:m}},Zh=(T,r,u,m,C,N,ee)=>s.extend(Hd(T,r,u,m),Xh(N,r,ee),{u_height_factor:-Math.pow(2,C.overscaledZ)/ee.tileSize/8}),Kh=T=>({u_matrix:T}),Qh=(T,r,u,m)=>s.extend(Kh(T),Xh(u,r,m)),Wd=(T,r)=>({u_matrix:T,u_world:r}),Yd=(T,r,u,m,C)=>s.extend(Qh(T,r,u,m),{u_world:C}),ca=(T,r,u,m)=>{const C=T.transform;let N,ee;if(m.paint.get("circle-pitch-alignment")==="map"){const le=Xi(u,1,C.zoom);N=!0,ee=[le,le]}else N=!1,ee=C.pixelsToGLUnits;return{u_camera_to_center_distance:C.cameraToCenterDistance,u_scale_with_map:+(m.paint.get("circle-pitch-scale")==="map"),u_matrix:T.translatePosMatrix(r.posMatrix,u,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_pitch_with_map:+N,u_device_pixel_ratio:T.pixelRatio,u_extrude_scale:ee}},Ic=(T,r,u)=>{const m=Xi(u,1,r.zoom),C=Math.pow(2,r.zoom-u.tileID.overscaledZ),N=u.tileID.overscaleFactor();return{u_matrix:T,u_camera_to_center_distance:r.cameraToCenterDistance,u_pixels_to_tile_units:m,u_extrude_scale:[r.pixelsToGLUnits[0]/(m*C),r.pixelsToGLUnits[1]/(m*C)],u_overscale_factor:N}},ja=(T,r,u=1)=>({u_matrix:T,u_color:r,u_overlay:0,u_overlay_scale:u}),kl=T=>({u_matrix:T}),Dc=(T,r,u,m)=>({u_matrix:T,u_extrude_scale:Xi(r,1,u),u_intensity:m});function Lc(T,r){const u=Math.pow(2,r.canonical.z),m=r.canonical.y;return[new s.MercatorCoordinate(0,m/u).toLngLat().lat,new s.MercatorCoordinate(0,(m+1)/u).toLngLat().lat]}const Ml=(T,r,u,m)=>{const C=T.transform;return{u_matrix:Jh(T,r,u,m),u_ratio:1/Xi(r,1,C.zoom),u_device_pixel_ratio:T.pixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},Rc=(T,r,u,m,C)=>s.extend(Ml(T,r,u,C),{u_image:0,u_image_height:m}),Al=(T,r,u,m,C)=>{const N=T.transform,ee=Pl(r,N);return{u_matrix:Jh(T,r,u,C),u_texsize:r.imageAtlasTexture.size,u_ratio:1/Xi(r,1,N.zoom),u_device_pixel_ratio:T.pixelRatio,u_image:0,u_scale:[ee,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/N.pixelsToGLUnits[0],1/N.pixelsToGLUnits[1]]}},Yr=(T,r,u,m,C,N)=>{const ee=T.lineAtlas,le=Pl(r,T.transform),de=u.layout.get("line-cap")==="round",be=ee.getDash(m.from,de),Ae=ee.getDash(m.to,de),ze=be.width*C.fromScale,Ge=Ae.width*C.toScale;return s.extend(Ml(T,r,u,N),{u_patternscale_a:[le/ze,-be.height/2],u_patternscale_b:[le/Ge,-Ae.height/2],u_sdfgamma:ee.width/(256*Math.min(ze,Ge)*T.pixelRatio)/2,u_image:0,u_tex_y_a:be.y,u_tex_y_b:Ae.y,u_mix:C.t})};function Pl(T,r){return 1/Xi(T,1,r.tileZoom)}function Jh(T,r,u,m){return T.translatePosMatrix(m?m.posMatrix:r.tileID.posMatrix,r,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const qd=(T,r,u,m,C)=>{return{u_matrix:T,u_tl_parent:r,u_scale_parent:u,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*C.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:C.paint.get("raster-brightness-min"),u_brightness_high:C.paint.get("raster-brightness-max"),u_saturation_factor:(ee=C.paint.get("raster-saturation"),ee>0?1-1/(1.001-ee):-ee),u_contrast_factor:(N=C.paint.get("raster-contrast"),N>0?1/(1-N):1+N),u_spin_weights:Xd(C.paint.get("raster-hue-rotate"))};var N,ee};function Xd(T){T*=Math.PI/180;const r=Math.sin(T),u=Math.cos(T);return[(2*u+1)/3,(-Math.sqrt(3)*r-u+1)/3,(Math.sqrt(3)*r-u+1)/3]}const Oc=(T,r,u,m,C,N,ee,le,de,be)=>{const Ae=C.transform;return{u_is_size_zoom_constant:+(T==="constant"||T==="source"),u_is_size_feature_constant:+(T==="constant"||T==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:Ae.cameraToCenterDistance,u_pitch:Ae.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:Ae.width/Ae.height,u_fade_change:C.options.fadeDuration?C.symbolFadeChange:1,u_matrix:N,u_label_plane_matrix:ee,u_coord_matrix:le,u_is_text:+de,u_pitch_with_map:+m,u_texsize:be,u_texture:0}},eu=(T,r,u,m,C,N,ee,le,de,be,Ae)=>{const ze=C.transform;return s.extend(Oc(T,r,u,m,C,N,ee,le,de,be),{u_gamma_scale:m?Math.cos(ze._pitch)*ze.cameraToCenterDistance:1,u_device_pixel_ratio:C.pixelRatio,u_is_halo:1})},bm=(T,r,u,m,C,N,ee,le,de,be)=>s.extend(eu(T,r,u,m,C,N,ee,le,!0,de),{u_texsize_icon:be,u_texture_icon:1}),vm=(T,r,u)=>({u_matrix:T,u_opacity:r,u_color:u}),tu=(T,r,u,m,C,N)=>s.extend(function(ee,le,de,be){const Ae=de.imageManager.getPattern(ee.from.toString()),ze=de.imageManager.getPattern(ee.to.toString()),{width:Ge,height:et}=de.imageManager.getPixelSize(),Qe=Math.pow(2,be.tileID.overscaledZ),Je=be.tileSize*Math.pow(2,de.transform.tileZoom)/Qe,dt=Je*(be.tileID.canonical.x+be.tileID.wrap*Qe),gt=Je*be.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Ae.tl,u_pattern_br_a:Ae.br,u_pattern_tl_b:ze.tl,u_pattern_br_b:ze.br,u_texsize:[Ge,et],u_mix:le.t,u_pattern_size_a:Ae.displaySize,u_pattern_size_b:ze.displaySize,u_scale_a:le.fromScale,u_scale_b:le.toScale,u_tile_units_to_pixels:1/Xi(be,1,de.transform.tileZoom),u_pixel_coord_upper:[dt>>16,gt>>16],u_pixel_coord_lower:[65535&dt,65535&gt]}}(m,N,u,C),{u_matrix:T,u_opacity:r}),iu={fillExtrusion:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_lightpos:new s.Uniform3f(T,r.u_lightpos),u_lightintensity:new s.Uniform1f(T,r.u_lightintensity),u_lightcolor:new s.Uniform3f(T,r.u_lightcolor),u_vertical_gradient:new s.Uniform1f(T,r.u_vertical_gradient),u_opacity:new s.Uniform1f(T,r.u_opacity)}),fillExtrusionPattern:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_lightpos:new s.Uniform3f(T,r.u_lightpos),u_lightintensity:new s.Uniform1f(T,r.u_lightintensity),u_lightcolor:new s.Uniform3f(T,r.u_lightcolor),u_vertical_gradient:new s.Uniform1f(T,r.u_vertical_gradient),u_height_factor:new s.Uniform1f(T,r.u_height_factor),u_image:new s.Uniform1i(T,r.u_image),u_texsize:new s.Uniform2f(T,r.u_texsize),u_pixel_coord_upper:new s.Uniform2f(T,r.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(T,r.u_pixel_coord_lower),u_scale:new s.Uniform3f(T,r.u_scale),u_fade:new s.Uniform1f(T,r.u_fade),u_opacity:new s.Uniform1f(T,r.u_opacity)}),fill:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix)}),fillPattern:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_image:new s.Uniform1i(T,r.u_image),u_texsize:new s.Uniform2f(T,r.u_texsize),u_pixel_coord_upper:new s.Uniform2f(T,r.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(T,r.u_pixel_coord_lower),u_scale:new s.Uniform3f(T,r.u_scale),u_fade:new s.Uniform1f(T,r.u_fade)}),fillOutline:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_world:new s.Uniform2f(T,r.u_world)}),fillOutlinePattern:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_world:new s.Uniform2f(T,r.u_world),u_image:new s.Uniform1i(T,r.u_image),u_texsize:new s.Uniform2f(T,r.u_texsize),u_pixel_coord_upper:new s.Uniform2f(T,r.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(T,r.u_pixel_coord_lower),u_scale:new s.Uniform3f(T,r.u_scale),u_fade:new s.Uniform1f(T,r.u_fade)}),circle:(T,r)=>({u_camera_to_center_distance:new s.Uniform1f(T,r.u_camera_to_center_distance),u_scale_with_map:new s.Uniform1i(T,r.u_scale_with_map),u_pitch_with_map:new s.Uniform1i(T,r.u_pitch_with_map),u_extrude_scale:new s.Uniform2f(T,r.u_extrude_scale),u_device_pixel_ratio:new s.Uniform1f(T,r.u_device_pixel_ratio),u_matrix:new s.UniformMatrix4f(T,r.u_matrix)}),collisionBox:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_camera_to_center_distance:new s.Uniform1f(T,r.u_camera_to_center_distance),u_pixels_to_tile_units:new s.Uniform1f(T,r.u_pixels_to_tile_units),u_extrude_scale:new s.Uniform2f(T,r.u_extrude_scale),u_overscale_factor:new s.Uniform1f(T,r.u_overscale_factor)}),collisionCircle:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_inv_matrix:new s.UniformMatrix4f(T,r.u_inv_matrix),u_camera_to_center_distance:new s.Uniform1f(T,r.u_camera_to_center_distance),u_viewport_size:new s.Uniform2f(T,r.u_viewport_size)}),debug:(T,r)=>({u_color:new s.UniformColor(T,r.u_color),u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_overlay:new s.Uniform1i(T,r.u_overlay),u_overlay_scale:new s.Uniform1f(T,r.u_overlay_scale)}),clippingMask:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix)}),heatmap:(T,r)=>({u_extrude_scale:new s.Uniform1f(T,r.u_extrude_scale),u_intensity:new s.Uniform1f(T,r.u_intensity),u_matrix:new s.UniformMatrix4f(T,r.u_matrix)}),heatmapTexture:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_world:new s.Uniform2f(T,r.u_world),u_image:new s.Uniform1i(T,r.u_image),u_color_ramp:new s.Uniform1i(T,r.u_color_ramp),u_opacity:new s.Uniform1f(T,r.u_opacity)}),hillshade:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_image:new s.Uniform1i(T,r.u_image),u_latrange:new s.Uniform2f(T,r.u_latrange),u_light:new s.Uniform2f(T,r.u_light),u_shadow:new s.UniformColor(T,r.u_shadow),u_highlight:new s.UniformColor(T,r.u_highlight),u_accent:new s.UniformColor(T,r.u_accent)}),hillshadePrepare:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_image:new s.Uniform1i(T,r.u_image),u_dimension:new s.Uniform2f(T,r.u_dimension),u_zoom:new s.Uniform1f(T,r.u_zoom),u_unpack:new s.Uniform4f(T,r.u_unpack)}),line:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_ratio:new s.Uniform1f(T,r.u_ratio),u_device_pixel_ratio:new s.Uniform1f(T,r.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(T,r.u_units_to_pixels)}),lineGradient:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_ratio:new s.Uniform1f(T,r.u_ratio),u_device_pixel_ratio:new s.Uniform1f(T,r.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(T,r.u_units_to_pixels),u_image:new s.Uniform1i(T,r.u_image),u_image_height:new s.Uniform1f(T,r.u_image_height)}),linePattern:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_texsize:new s.Uniform2f(T,r.u_texsize),u_ratio:new s.Uniform1f(T,r.u_ratio),u_device_pixel_ratio:new s.Uniform1f(T,r.u_device_pixel_ratio),u_image:new s.Uniform1i(T,r.u_image),u_units_to_pixels:new s.Uniform2f(T,r.u_units_to_pixels),u_scale:new s.Uniform3f(T,r.u_scale),u_fade:new s.Uniform1f(T,r.u_fade)}),lineSDF:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_ratio:new s.Uniform1f(T,r.u_ratio),u_device_pixel_ratio:new s.Uniform1f(T,r.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(T,r.u_units_to_pixels),u_patternscale_a:new s.Uniform2f(T,r.u_patternscale_a),u_patternscale_b:new s.Uniform2f(T,r.u_patternscale_b),u_sdfgamma:new s.Uniform1f(T,r.u_sdfgamma),u_image:new s.Uniform1i(T,r.u_image),u_tex_y_a:new s.Uniform1f(T,r.u_tex_y_a),u_tex_y_b:new s.Uniform1f(T,r.u_tex_y_b),u_mix:new s.Uniform1f(T,r.u_mix)}),raster:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_tl_parent:new s.Uniform2f(T,r.u_tl_parent),u_scale_parent:new s.Uniform1f(T,r.u_scale_parent),u_buffer_scale:new s.Uniform1f(T,r.u_buffer_scale),u_fade_t:new s.Uniform1f(T,r.u_fade_t),u_opacity:new s.Uniform1f(T,r.u_opacity),u_image0:new s.Uniform1i(T,r.u_image0),u_image1:new s.Uniform1i(T,r.u_image1),u_brightness_low:new s.Uniform1f(T,r.u_brightness_low),u_brightness_high:new s.Uniform1f(T,r.u_brightness_high),u_saturation_factor:new s.Uniform1f(T,r.u_saturation_factor),u_contrast_factor:new s.Uniform1f(T,r.u_contrast_factor),u_spin_weights:new s.Uniform3f(T,r.u_spin_weights)}),symbolIcon:(T,r)=>({u_is_size_zoom_constant:new s.Uniform1i(T,r.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(T,r.u_is_size_feature_constant),u_size_t:new s.Uniform1f(T,r.u_size_t),u_size:new s.Uniform1f(T,r.u_size),u_camera_to_center_distance:new s.Uniform1f(T,r.u_camera_to_center_distance),u_pitch:new s.Uniform1f(T,r.u_pitch),u_rotate_symbol:new s.Uniform1i(T,r.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(T,r.u_aspect_ratio),u_fade_change:new s.Uniform1f(T,r.u_fade_change),u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(T,r.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(T,r.u_coord_matrix),u_is_text:new s.Uniform1i(T,r.u_is_text),u_pitch_with_map:new s.Uniform1i(T,r.u_pitch_with_map),u_texsize:new s.Uniform2f(T,r.u_texsize),u_texture:new s.Uniform1i(T,r.u_texture)}),symbolSDF:(T,r)=>({u_is_size_zoom_constant:new s.Uniform1i(T,r.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(T,r.u_is_size_feature_constant),u_size_t:new s.Uniform1f(T,r.u_size_t),u_size:new s.Uniform1f(T,r.u_size),u_camera_to_center_distance:new s.Uniform1f(T,r.u_camera_to_center_distance),u_pitch:new s.Uniform1f(T,r.u_pitch),u_rotate_symbol:new s.Uniform1i(T,r.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(T,r.u_aspect_ratio),u_fade_change:new s.Uniform1f(T,r.u_fade_change),u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(T,r.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(T,r.u_coord_matrix),u_is_text:new s.Uniform1i(T,r.u_is_text),u_pitch_with_map:new s.Uniform1i(T,r.u_pitch_with_map),u_texsize:new s.Uniform2f(T,r.u_texsize),u_texture:new s.Uniform1i(T,r.u_texture),u_gamma_scale:new s.Uniform1f(T,r.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(T,r.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(T,r.u_is_halo)}),symbolTextAndIcon:(T,r)=>({u_is_size_zoom_constant:new s.Uniform1i(T,r.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(T,r.u_is_size_feature_constant),u_size_t:new s.Uniform1f(T,r.u_size_t),u_size:new s.Uniform1f(T,r.u_size),u_camera_to_center_distance:new s.Uniform1f(T,r.u_camera_to_center_distance),u_pitch:new s.Uniform1f(T,r.u_pitch),u_rotate_symbol:new s.Uniform1i(T,r.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(T,r.u_aspect_ratio),u_fade_change:new s.Uniform1f(T,r.u_fade_change),u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(T,r.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(T,r.u_coord_matrix),u_is_text:new s.Uniform1i(T,r.u_is_text),u_pitch_with_map:new s.Uniform1i(T,r.u_pitch_with_map),u_texsize:new s.Uniform2f(T,r.u_texsize),u_texsize_icon:new s.Uniform2f(T,r.u_texsize_icon),u_texture:new s.Uniform1i(T,r.u_texture),u_texture_icon:new s.Uniform1i(T,r.u_texture_icon),u_gamma_scale:new s.Uniform1f(T,r.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(T,r.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(T,r.u_is_halo)}),background:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_opacity:new s.Uniform1f(T,r.u_opacity),u_color:new s.UniformColor(T,r.u_color)}),backgroundPattern:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_opacity:new s.Uniform1f(T,r.u_opacity),u_image:new s.Uniform1i(T,r.u_image),u_pattern_tl_a:new s.Uniform2f(T,r.u_pattern_tl_a),u_pattern_br_a:new s.Uniform2f(T,r.u_pattern_br_a),u_pattern_tl_b:new s.Uniform2f(T,r.u_pattern_tl_b),u_pattern_br_b:new s.Uniform2f(T,r.u_pattern_br_b),u_texsize:new s.Uniform2f(T,r.u_texsize),u_mix:new s.Uniform1f(T,r.u_mix),u_pattern_size_a:new s.Uniform2f(T,r.u_pattern_size_a),u_pattern_size_b:new s.Uniform2f(T,r.u_pattern_size_b),u_scale_a:new s.Uniform1f(T,r.u_scale_a),u_scale_b:new s.Uniform1f(T,r.u_scale_b),u_pixel_coord_upper:new s.Uniform2f(T,r.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(T,r.u_pixel_coord_lower),u_tile_units_to_pixels:new s.Uniform1f(T,r.u_tile_units_to_pixels)}),terrain:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_texture:new s.Uniform1i(T,r.u_texture)}),terrainDepth:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix)}),terrainCoords:(T,r)=>({u_matrix:new s.UniformMatrix4f(T,r.u_matrix),u_texture:new s.Uniform1i(T,r.u_texture),u_terrain_coords_id:new s.Uniform1f(T,r.u_terrain_coords_id)})};class ru{constructor(r,u,m){this.context=r;const C=r.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const nu={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Zd{constructor(r,u,m,C){this.length=u.length,this.attributes=m,this.itemSize=u.bytesPerElement,this.dynamicDraw=C,this.context=r;const N=r.gl;this.buffer=N.createBuffer(),r.bindVertexBuffer.set(this.buffer),N.bufferData(N.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?N.DYNAMIC_DRAW:N.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,u){for(let m=0;m<this.attributes.length;m++){const C=u.attributes[this.attributes[m].name];C!==void 0&&r.enableVertexAttribArray(C)}}setVertexAttribPointers(r,u,m){for(let C=0;C<this.attributes.length;C++){const N=this.attributes[C],ee=u.attributes[N.name];ee!==void 0&&r.vertexAttribPointer(ee,N.components,r[nu[N.type]],!1,this.itemSize,N.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class xr{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class _m extends xr{getDefault(){return s.Color.transparent}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Il extends xr{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Dl extends xr{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Kd extends xr{getDefault(){return[!0,!0,!0,!0]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Es extends xr{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class su extends xr{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class zc extends xr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const u=this.current;(r.func!==u.func||r.ref!==u.ref||r.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Nc extends xr{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class ou extends xr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=r,this.dirty=!1}}class au extends xr{getDefault(){return[0,1]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class jc extends xr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=r,this.dirty=!1}}class lu extends xr{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class cu extends xr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.BLEND):u.disable(u.BLEND),this.current=r,this.dirty=!1}}class Bc extends xr{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class Qd extends xr{getDefault(){return s.Color.transparent}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Jd extends xr{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Ba extends xr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=r,this.dirty=!1}}class wm extends xr{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Tm extends xr{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class Em extends xr{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Cm extends xr{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Sm extends xr{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class km extends xr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class hu extends xr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Fc extends xr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class uu extends xr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class du extends xr{getDefault(){return null}set(r){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Fa extends xr{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class ep extends xr{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class tp extends xr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class pu extends xr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Bo extends xr{constructor(r,u){super(r),this.context=r,this.parent=u}getDefault(){return null}}class ip extends Bo{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Ua extends Bo{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class $a{constructor(r,u,m,C){this.context=r,this.width=u,this.height=m;const N=r.gl,ee=this.framebuffer=N.createFramebuffer();if(this.colorAttachment=new ip(r,ee),C&&(this.depthAttachment=new Ua(r,ee)),N.checkFramebufferStatus(N.FRAMEBUFFER)!==N.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const r=this.context.gl,u=this.colorAttachment.get();if(u&&r.deleteTexture(u),this.depthAttachment){const m=this.depthAttachment.get();m&&r.deleteRenderbuffer(m)}r.deleteFramebuffer(this.framebuffer)}}class tn{constructor(r,u,m){this.blendFunction=r,this.blendColor=u,this.mask=m}}tn.Replace=[1,0],tn.disabled=new tn(tn.Replace,s.Color.transparent,[!1,!1,!1,!1]),tn.unblended=new tn(tn.Replace,s.Color.transparent,[!0,!0,!0,!0]),tn.alphaBlended=new tn([1,771],s.Color.transparent,[!0,!0,!0,!0]);class fu{constructor(r){this.gl=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new _m(this),this.clearDepth=new Il(this),this.clearStencil=new Dl(this),this.colorMask=new Kd(this),this.depthMask=new Es(this),this.stencilMask=new su(this),this.stencilFunc=new zc(this),this.stencilOp=new Nc(this),this.stencilTest=new ou(this),this.depthRange=new au(this),this.depthTest=new jc(this),this.depthFunc=new lu(this),this.blend=new cu(this),this.blendFunc=new Bc(this),this.blendColor=new Qd(this),this.blendEquation=new Jd(this),this.cullFace=new Ba(this),this.cullFaceSide=new wm(this),this.frontFace=new Tm(this),this.program=new Em(this),this.activeTexture=new Cm(this),this.viewport=new Sm(this),this.bindFramebuffer=new km(this),this.bindRenderbuffer=new hu(this),this.bindTexture=new Fc(this),this.bindVertexBuffer=new uu(this),this.bindElementBuffer=new du(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Fa(this),this.pixelStoreUnpack=new ep(this),this.pixelStoreUnpackPremultiplyAlpha=new tp(this),this.pixelStoreUnpackFlipY=new pu(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=r.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(r.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,u){return new ru(this,r,u)}createVertexBuffer(r,u,m){return new Zd(this,r,u,m)}createRenderbuffer(r,u,m){const C=this.gl,N=C.createRenderbuffer();return this.bindRenderbuffer.set(N),C.renderbufferStorage(C.RENDERBUFFER,r,u,m),this.bindRenderbuffer.set(null),N}createFramebuffer(r,u,m){return new $a(this,r,u,m)}clear({color:r,depth:u}){const m=this.gl;let C=0;r&&(C|=m.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(C|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),m.clear(C)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){v(r.blendFunction,tn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class bi{constructor(r,u,m){this.func=r,this.mask=u,this.range=m}}bi.ReadOnly=!1,bi.ReadWrite=!0,bi.disabled=new bi(519,bi.ReadOnly,[0,1]);const Ga=7680;class qr{constructor(r,u,m,C,N,ee){this.test=r,this.ref=u,this.mask=m,this.fail=C,this.depthFail=N,this.pass=ee}}qr.disabled=new qr({func:519,mask:0},0,0,Ga,Ga,Ga);class Nr{constructor(r,u,m){this.enable=r,this.mode=u,this.frontFace=m}}let Fo;function rp(T,r,u,m,C,N,ee){const le=T.context,de=le.gl,be=T.useProgram("collisionBox"),Ae=[];let ze=0,Ge=0;for(let nt=0;nt<m.length;nt++){const kt=m[nt],_t=r.getTile(kt),Ot=_t.getBucket(u);if(!Ot)continue;let zt=kt.posMatrix;C[0]===0&&C[1]===0||(zt=T.translatePosMatrix(kt.posMatrix,_t,C,N));const Ut=ee?Ot.textCollisionBox:Ot.iconCollisionBox,Dt=Ot.collisionCircleArray;if(Dt.length>0){const ni=s.create(),qt=zt;s.mul(ni,Ot.placementInvProjMatrix,T.transform.glCoordMatrix),s.mul(ni,ni,Ot.placementViewportMatrix),Ae.push({circleArray:Dt,circleOffset:Ge,transform:qt,invTransform:ni,coord:kt}),ze+=Dt.length/4,Ge=ze}Ut&&be.draw(le,de.LINES,bi.disabled,qr.disabled,T.colorModeForRenderPass(),Nr.disabled,Ic(zt,T.transform,_t),T.style.terrain&&T.style.terrain.getTerrainData(kt),u.id,Ut.layoutVertexBuffer,Ut.indexBuffer,Ut.segments,null,T.transform.zoom,null,null,Ut.collisionVertexBuffer)}if(!ee||!Ae.length)return;const et=T.useProgram("collisionCircle"),Qe=new s.CollisionCircleLayoutArray;Qe.resize(4*ze),Qe._trim();let Je=0;for(const nt of Ae)for(let kt=0;kt<nt.circleArray.length/4;kt++){const _t=4*kt,Ot=nt.circleArray[_t+0],zt=nt.circleArray[_t+1],Ut=nt.circleArray[_t+2],Dt=nt.circleArray[_t+3];Qe.emplace(Je++,Ot,zt,Ut,Dt,0),Qe.emplace(Je++,Ot,zt,Ut,Dt,1),Qe.emplace(Je++,Ot,zt,Ut,Dt,2),Qe.emplace(Je++,Ot,zt,Ut,Dt,3)}(!Fo||Fo.length<2*ze)&&(Fo=function(nt){const kt=2*nt,_t=new s.QuadTriangleArray;_t.resize(kt),_t._trim();for(let Ot=0;Ot<kt;Ot++){const zt=6*Ot;_t.uint16[zt+0]=4*Ot+0,_t.uint16[zt+1]=4*Ot+1,_t.uint16[zt+2]=4*Ot+2,_t.uint16[zt+3]=4*Ot+2,_t.uint16[zt+4]=4*Ot+3,_t.uint16[zt+5]=4*Ot+0}return _t}(ze));const dt=le.createIndexBuffer(Fo,!0),gt=le.createVertexBuffer(Qe,s.collisionCircleLayout.members,!0);for(const nt of Ae){const kt={u_matrix:nt.transform,u_inv_matrix:nt.invTransform,u_camera_to_center_distance:(vt=T.transform).cameraToCenterDistance,u_viewport_size:[vt.width,vt.height]};et.draw(le,de.TRIANGLES,bi.disabled,qr.disabled,T.colorModeForRenderPass(),Nr.disabled,kt,T.style.terrain&&T.style.terrain.getTerrainData(nt.coord),u.id,gt,dt,s.SegmentVector.simpleSegment(0,2*nt.circleOffset,nt.circleArray.length,nt.circleArray.length/2),null,T.transform.zoom,null,null,null)}var vt;gt.destroy(),dt.destroy()}Nr.disabled=new Nr(!1,1029,2305),Nr.backCCW=new Nr(!0,1029,2305);const Mm=s.identity(new Float32Array(16));function np(T,r,u,m,C,N){const{horizontalAlign:ee,verticalAlign:le}=s.getAnchorAlignment(T),de=-(ee-.5)*r,be=-(le-.5)*u,Ae=s.evaluateVariableOffset(T,m);return new s.pointGeometry((de/C+Ae[0])*N,(be/C+Ae[1])*N)}function Am(T,r,u,m,C,N,ee,le,de,be,Ae){const ze=T.text.placedSymbolArray,Ge=T.text.dynamicLayoutVertexArray,et=T.icon.dynamicLayoutVertexArray,Qe={};Ge.clear();for(let Je=0;Je<ze.length;Je++){const dt=ze.get(Je),gt=T.allowVerticalPlacement&&!dt.placedOrientation,vt=dt.hidden||!dt.crossTileID||gt?null:m[dt.crossTileID];if(vt){const nt=new s.pointGeometry(dt.anchorX,dt.anchorY),kt=ut(nt,u?ee:N,Ae),_t=mt(C.cameraToCenterDistance,kt.signedDistanceFromCamera);let Ot=s.evaluateSizeForFeature(T.textSizeData,de,dt)*_t/s.ONE_EM;u&&(Ot*=T.tilePixelRatio/le);const{width:zt,height:Ut,anchor:Dt,textOffset:ni,textBoxScale:qt}=vt,oi=np(Dt,zt,Ut,ni,qt,Ot),Hi=u?ut(nt.add(oi),N,Ae).point:kt.point.add(r?oi.rotate(-C.angle):oi),er=T.allowVerticalPlacement&&dt.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let ki=0;ki<dt.numGlyphs;ki++)s.addDynamicAttributes(Ge,Hi,er);be&&dt.associatedIconIndex>=0&&(Qe[dt.associatedIconIndex]={shiftedAnchor:Hi,angle:er})}else Ji(dt.numGlyphs,Ge)}if(be){et.clear();const Je=T.icon.placedSymbolArray;for(let dt=0;dt<Je.length;dt++){const gt=Je.get(dt);if(gt.hidden)Ji(gt.numGlyphs,et);else{const vt=Qe[dt];if(vt)for(let nt=0;nt<gt.numGlyphs;nt++)s.addDynamicAttributes(et,vt.shiftedAnchor,vt.angle);else Ji(gt.numGlyphs,et)}}T.icon.dynamicLayoutVertexBuffer.updateData(et)}T.text.dynamicLayoutVertexBuffer.updateData(Ge)}function mu(T,r,u){return u.iconsInText&&r?"symbolTextAndIcon":T?"symbolSDF":"symbolIcon"}function Ll(T,r,u,m,C,N,ee,le,de,be,Ae,ze){const Ge=T.context,et=Ge.gl,Qe=T.transform,Je=le==="map",dt=de==="map",gt=le!=="viewport"&&u.layout.get("symbol-placement")!=="point",vt=Je&&!dt&&!gt,nt=!u.layout.get("symbol-sort-key").isConstant();let kt=!1;const _t=T.depthModeForSublayer(0,bi.ReadOnly),Ot=u.layout.get("text-variable-anchor"),zt=[];for(const Ut of m){const Dt=r.getTile(Ut),ni=Dt.getBucket(u);if(!ni)continue;const qt=C?ni.text:ni.icon;if(!qt||!qt.segments.get().length)continue;const oi=qt.programConfigurations.get(u.id),Hi=C||ni.sdfIcons,er=C?ni.textSizeData:ni.iconSizeData,ki=dt||Qe.pitch!==0,Cr=T.useProgram(mu(Hi,C,ni),oi),Sr=s.evaluateSizeForZoom(er,Qe.zoom),lr=T.style.terrain&&T.style.terrain.getTerrainData(Ut);let hr,pr,Ss,yo,Js=[0,0],eo=null;if(C){if(pr=Dt.glyphAtlasTexture,Ss=et.LINEAR,hr=Dt.glyphAtlasTexture.size,ni.iconsInText){Js=Dt.imageAtlasTexture.size,eo=Dt.imageAtlasTexture;const Hs=er.kind==="composite"||er.kind==="camera";yo=ki||T.options.rotating||T.options.zooming||Hs?et.LINEAR:et.NEAREST}}else{const Hs=u.layout.get("icon-size").constantOr(0)!==1||ni.iconsNeedLinear;pr=Dt.imageAtlasTexture,Ss=Hi||T.options.rotating||T.options.zooming||Hs||ki?et.LINEAR:et.NEAREST,hr=Dt.imageAtlasTexture.size}const ga=Xi(Dt,1,T.transform.zoom),Nn=rt(Ut.posMatrix,dt,Je,T.transform,ga),to=at(Ut.posMatrix,dt,Je,T.transform,ga),ya=Ot&&ni.hasTextData(),th=u.layout.get("icon-text-fit")!=="none"&&ya&&ni.hasIconData();if(gt){const Hs=T.style.terrain?(Xa,ih)=>T.style.terrain.getElevation(Ut,Xa,ih):null,qa=u.layout.get("text-rotation-alignment")==="map";Rt(ni,Ut.posMatrix,T,C,Nn,to,dt,be,qa,Hs)}const fr=T.translatePosMatrix(Ut.posMatrix,Dt,N,ee),Br=gt||C&&Ot||th?Mm:Nn,gr=T.translatePosMatrix(to,Dt,N,ee,!0),yn=Hi&&u.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let gs;gs=Hi?ni.iconsInText?bm(er.kind,Sr,vt,dt,T,fr,Br,gr,hr,Js):eu(er.kind,Sr,vt,dt,T,fr,Br,gr,C,hr):Oc(er.kind,Sr,vt,dt,T,fr,Br,gr,C,hr);const Gr={program:Cr,buffers:qt,uniformValues:gs,atlasTexture:pr,atlasTextureIcon:eo,atlasInterpolation:Ss,atlasInterpolationIcon:yo,isSDF:Hi,hasHalo:yn};if(nt&&ni.canOverlap){kt=!0;const Hs=qt.segments.get();for(const qa of Hs)zt.push({segments:new s.SegmentVector([qa]),sortKey:qa.sortKey,state:Gr,terrainData:lr})}else zt.push({segments:qt.segments,sortKey:0,state:Gr,terrainData:lr})}kt&&zt.sort((Ut,Dt)=>Ut.sortKey-Dt.sortKey);for(const Ut of zt){const Dt=Ut.state;if(Ge.activeTexture.set(et.TEXTURE0),Dt.atlasTexture.bind(Dt.atlasInterpolation,et.CLAMP_TO_EDGE),Dt.atlasTextureIcon&&(Ge.activeTexture.set(et.TEXTURE1),Dt.atlasTextureIcon&&Dt.atlasTextureIcon.bind(Dt.atlasInterpolationIcon,et.CLAMP_TO_EDGE)),Dt.isSDF){const ni=Dt.uniformValues;Dt.hasHalo&&(ni.u_is_halo=1,Rl(Dt.buffers,Ut.segments,u,T,Dt.program,_t,Ae,ze,ni,Ut.terrainData)),ni.u_is_halo=0}Rl(Dt.buffers,Ut.segments,u,T,Dt.program,_t,Ae,ze,Dt.uniformValues,Ut.terrainData)}}function Rl(T,r,u,m,C,N,ee,le,de,be){const Ae=m.context;C.draw(Ae,Ae.gl.TRIANGLES,N,ee,le,Nr.disabled,de,be,u.id,T.layoutVertexBuffer,T.indexBuffer,r,u.paint,m.transform.zoom,T.programConfigurations.get(u.id),T.dynamicLayoutVertexBuffer,T.opacityVertexBuffer)}function Uc(T,r,u,m,C,N,ee){const le=T.context.gl,de=u.paint.get("fill-pattern"),be=de&&de.constantOr(1),Ae=u.getCrossfadeParameters();let ze,Ge,et,Qe,Je;ee?(Ge=be&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ze=le.LINES):(Ge=be?"fillPattern":"fill",ze=le.TRIANGLES);for(const dt of m){const gt=r.getTile(dt);if(be&&!gt.patternsLoaded())continue;const vt=gt.getBucket(u);if(!vt)continue;const nt=vt.programConfigurations.get(u.id),kt=T.useProgram(Ge,nt),_t=T.style.terrain&&T.style.terrain.getTerrainData(dt);be&&(T.context.activeTexture.set(le.TEXTURE0),gt.imageAtlasTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),nt.updatePaintBuffers(Ae));const Ot=de.constantOr(null);if(Ot&&gt.imageAtlas){const Dt=gt.imageAtlas,ni=Dt.patternPositions[Ot.to.toString()],qt=Dt.patternPositions[Ot.from.toString()];ni&&qt&&nt.setConstantPatternPositions(ni,qt)}const zt=_t?dt:null,Ut=T.translatePosMatrix(zt?zt.posMatrix:dt.posMatrix,gt,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(ee){Qe=vt.indexBuffer2,Je=vt.segments2;const Dt=[le.drawingBufferWidth,le.drawingBufferHeight];et=Ge==="fillOutlinePattern"&&be?Yd(Ut,T,Ae,gt,Dt):Wd(Ut,Dt)}else Qe=vt.indexBuffer,Je=vt.segments,et=be?Qh(Ut,T,Ae,gt):Kh(Ut);kt.draw(T.context,ze,C,T.stencilModeForClipping(dt),N,Nr.disabled,et,_t,u.id,vt.layoutVertexBuffer,Qe,Je,u.paint,T.transform.zoom,nt)}}function Ol(T,r,u,m,C,N,ee){const le=T.context,de=le.gl,be=u.paint.get("fill-extrusion-pattern"),Ae=be.constantOr(1),ze=u.getCrossfadeParameters(),Ge=u.paint.get("fill-extrusion-opacity");for(const et of m){const Qe=r.getTile(et),Je=Qe.getBucket(u);if(!Je)continue;const dt=T.style.terrain&&T.style.terrain.getTerrainData(et),gt=Je.programConfigurations.get(u.id),vt=T.useProgram(Ae?"fillExtrusionPattern":"fillExtrusion",gt);Ae&&(T.context.activeTexture.set(de.TEXTURE0),Qe.imageAtlasTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE),gt.updatePaintBuffers(ze));const nt=be.constantOr(null);if(nt&&Qe.imageAtlas){const zt=Qe.imageAtlas,Ut=zt.patternPositions[nt.to.toString()],Dt=zt.patternPositions[nt.from.toString()];Ut&&Dt&&gt.setConstantPatternPositions(Ut,Dt)}const kt=T.translatePosMatrix(et.posMatrix,Qe,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),_t=u.paint.get("fill-extrusion-vertical-gradient"),Ot=Ae?Zh(kt,T,_t,Ge,et,ze,Qe):Hd(kt,T,_t,Ge);vt.draw(le,le.gl.TRIANGLES,C,N,ee,Nr.backCCW,Ot,dt,u.id,Je.layoutVertexBuffer,Je.indexBuffer,Je.segments,u.paint,T.transform.zoom,gt,T.style.terrain&&Je.centroidVertexBuffer)}}function sp(T,r,u,m,C,N,ee){const le=T.context,de=le.gl,be=u.fbo;if(!be)return;const Ae=T.useProgram("hillshade"),ze=T.style.terrain&&T.style.terrain.getTerrainData(r);le.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,be.colorAttachment.get()),Ae.draw(le,de.TRIANGLES,C,N,ee,Nr.disabled,((Ge,et,Qe,Je)=>{const dt=Qe.paint.get("hillshade-shadow-color"),gt=Qe.paint.get("hillshade-highlight-color"),vt=Qe.paint.get("hillshade-accent-color");let nt=Qe.paint.get("hillshade-illumination-direction")*(Math.PI/180);Qe.paint.get("hillshade-illumination-anchor")==="viewport"&&(nt-=Ge.transform.angle);const kt=!Ge.options.moving;return{u_matrix:Je?Je.posMatrix:Ge.transform.calculatePosMatrix(et.tileID.toUnwrapped(),kt),u_image:0,u_latrange:Lc(0,et.tileID),u_light:[Qe.paint.get("hillshade-exaggeration"),nt],u_shadow:dt,u_highlight:gt,u_accent:vt}})(T,u,m,ze?r:null),ze,m.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments)}function $c(T,r,u,m,C,N){const ee=T.context,le=ee.gl,de=r.dem;if(de&&de.data){const be=de.dim,Ae=de.stride,ze=de.getPixels();if(ee.activeTexture.set(le.TEXTURE1),ee.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||T.getTileTexture(Ae),r.demTexture){const et=r.demTexture;et.update(ze,{premultiply:!1}),et.bind(le.NEAREST,le.CLAMP_TO_EDGE)}else r.demTexture=new S(ee,ze,le.RGBA,{premultiply:!1}),r.demTexture.bind(le.NEAREST,le.CLAMP_TO_EDGE);ee.activeTexture.set(le.TEXTURE0);let Ge=r.fbo;if(!Ge){const et=new S(ee,{width:be,height:be,data:null},le.RGBA);et.bind(le.LINEAR,le.CLAMP_TO_EDGE),Ge=r.fbo=ee.createFramebuffer(be,be,!0),Ge.colorAttachment.set(et.texture)}ee.bindFramebuffer.set(Ge.framebuffer),ee.viewport.set([0,0,be,be]),T.useProgram("hillshadePrepare").draw(ee,le.TRIANGLES,m,C,N,Nr.disabled,((et,Qe)=>{const Je=Qe.stride,dt=s.create();return s.ortho(dt,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(dt,dt,[0,-s.EXTENT,0]),{u_matrix:dt,u_image:1,u_dimension:[Je,Je],u_zoom:et.overscaledZ,u_unpack:Qe.getUnpackVector()}})(r.tileID,de),null,u.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function Gc(T,r,u,m,C,N){const ee=m.paint.get("raster-fade-duration");if(!N&&ee>0){const le=s.exported.now(),de=(le-T.timeAdded)/ee,be=r?(le-r.timeAdded)/ee:-1,Ae=u.getSource(),ze=C.coveringZoomLevel({tileSize:Ae.tileSize,roundZoom:Ae.roundZoom}),Ge=!r||Math.abs(r.tileID.overscaledZ-ze)>Math.abs(T.tileID.overscaledZ-ze),et=Ge&&T.refreshedUponExpiration?1:s.clamp(Ge?de:1-be,0,1);return T.refreshedUponExpiration&&de>=1&&(T.refreshedUponExpiration=!1),r?{opacity:1,mix:1-et}:{opacity:et,mix:0}}return{opacity:1,mix:0}}const Qs=new s.Color(1,0,0,1),op=new s.Color(0,1,0,1),gu=new s.Color(0,0,1,1),ap=new s.Color(1,0,1,1),Va=new s.Color(0,1,1,1);function zl(T,r,u,m){Hc(T,0,r+u/2,T.transform.width,u,m)}function Vc(T,r,u,m){Hc(T,r-u/2,0,u,T.transform.height,m)}function Hc(T,r,u,m,C,N){const ee=T.context,le=ee.gl;le.enable(le.SCISSOR_TEST),le.scissor(r*T.pixelRatio,u*T.pixelRatio,m*T.pixelRatio,C*T.pixelRatio),ee.clear({color:N}),le.disable(le.SCISSOR_TEST)}function yu(T,r,u){const m=T.context,C=m.gl,N=u.posMatrix,ee=T.useProgram("debug"),le=bi.disabled,de=qr.disabled,be=T.colorModeForRenderPass(),Ae="$debug",ze=T.style.terrain&&T.style.terrain.getTerrainData(u);m.activeTexture.set(C.TEXTURE0),T.emptyTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE);const Ge=r.getTileByID(u.key).latestRawTileData,et=Math.floor((Ge&&Ge.byteLength||0)/1024),Qe=r.getTile(u).tileSize,Je=512/Math.min(Qe,512)*(u.overscaledZ/T.transform.zoom)*.5;let dt=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(dt+=` => ${u.overscaledZ}`),function(gt,vt){gt.initDebugOverlayCanvas();const nt=gt.debugOverlayCanvas,kt=gt.context.gl,_t=gt.debugOverlayCanvas.getContext("2d");_t.clearRect(0,0,nt.width,nt.height),_t.shadowColor="white",_t.shadowBlur=2,_t.lineWidth=1.5,_t.strokeStyle="white",_t.textBaseline="top",_t.font="bold 36px Open Sans, sans-serif",_t.fillText(vt,5,5),_t.strokeText(vt,5,5),gt.debugOverlayTexture.update(nt),gt.debugOverlayTexture.bind(kt.LINEAR,kt.CLAMP_TO_EDGE)}(T,`${dt} ${et}kB`),ee.draw(m,C.TRIANGLES,le,de,tn.alphaBlended,Nr.disabled,ja(N,s.Color.transparent,Je),null,Ae,T.debugBuffer,T.quadTriangleIndexBuffer,T.debugSegments),ee.draw(m,C.LINE_STRIP,le,de,be,Nr.disabled,ja(N,s.Color.red),ze,Ae,T.debugBuffer,T.tileBorderIndexBuffer,T.debugSegments)}function lp(T,r,u){const m=T.context,C=m.gl,N=T.colorModeForRenderPass(),ee=new bi(C.LEQUAL,bi.ReadWrite,T.depthRangeFor3D),le=T.useProgram("terrain"),de=r.getTerrainMesh(),be=r.getTerrainData(u.tileID);m.bindFramebuffer.set(null),m.viewport.set([0,0,T.width,T.height]),m.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,r.getRTTFramebuffer().colorAttachment.get());const Ae=T.transform.calculatePosMatrix(u.tileID.toUnwrapped());le.draw(m,C.TRIANGLES,ee,qr.disabled,N,Nr.backCCW,{u_matrix:Ae,u_texture:0},be,"terrain",de.vertexBuffer,de.indexBuffer,de.segments)}function xu(T,r,u,m){const C=T.context,N=u.tileSize*r.qualityFactor;u.textures[m]||(u.textures[m]=T.getTileTexture(N)||new S(C,{width:N,height:N,data:null},C.gl.RGBA),u.textures[m].bind(C.gl.LINEAR,C.gl.CLAMP_TO_EDGE),m===0&&r.sourceCache.renderHistory.unshift(u.tileID.key));const ee=r.getRTTFramebuffer();ee.colorAttachment.set(u.textures[m].texture),C.bindFramebuffer.set(ee.framebuffer),C.viewport.set([0,0,N,N])}class Wc{constructor(r){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=r,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=r.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const r=this.painter.style,u=r.terrain;for(const m in r.sourceCaches){this._coordsDescendingInv[m]={};const C=r.sourceCaches[m].getVisibleCoordinates();for(const N of C){const ee=u.sourceCache.getTerrainCoords(N);for(const le in ee)this._coordsDescendingInv[m][le]||(this._coordsDescendingInv[m][le]=[]),this._coordsDescendingInv[m][le].push(ee[le])}}for(const m of r._order){const C=r._layers[m],N=C.source;if(this._renderToTexture[C.type]&&!this._coordsDescendingInvStr[N]){this._coordsDescendingInvStr[N]={};for(const ee in this._coordsDescendingInv[N])this._coordsDescendingInvStr[N][ee]=this._coordsDescendingInv[N][ee].map(le=>le.key).sort().join()}}return this._renderableTiles.forEach(m=>{for(const C in this._coordsDescendingInvStr){const N=this._coordsDescendingInvStr[C][m.tileID.key];N&&N!==m.textureCoords[C]&&m.clearTextures(this.painter),u.needsRerender(C,m.tileID)&&m.clearTextures(this.painter)}this._rerender[m.tileID.key]=!m.textures.length}),u.clearRerenderCache(),u.sourceCache.removeOutdated(this.painter),this}renderLayer(r){const u=r.type,m=this.painter,C=m.style._order,N=m.currentLayer,ee=N+1===C.length;if(this._renderToTexture[u]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(C[N]),!ee))return!0;if(this._renderToTexture[this._prevType]||u==="hillshade"||this._renderToTexture[u]&&ee){this._prevType=u;const le=this._stacks.length-1,de=this._stacks[le]||[];for(const be of this._renderableTiles){if(xu(m,m.style.terrain,be,le),this._rerender[be.tileID.key]){m.context.clear({color:s.Color.transparent});for(let Ae=0;Ae<de.length;Ae++){const ze=m.style._layers[de[Ae]],Ge=ze.source?this._coordsDescendingInv[ze.source][be.tileID.key]:[be.tileID];m._renderTileClippingMasks(ze,Ge),m.renderLayer(m,m.style.sourceCaches[ze.source],ze,Ge),ze.source&&(be.textureCoords[ze.source]=this._coordsDescendingInvStr[ze.source][be.tileID.key])}}lp(m,m.style.terrain,be)}if(u==="hillshade"){this._stacks.push([C[N]]);for(const be of this._renderableTiles){const Ae=this._coordsDescendingInv[r.source][be.tileID.key];xu(m,m.style.terrain,be,this._stacks.length-1),m.context.clear({color:s.Color.transparent}),m._renderTileClippingMasks(r,Ae),m.renderLayer(m,m.style.sourceCaches[r.source],r,Ae),lp(m,m.style.terrain,be)}return!0}return this._renderToTexture[u]}return!1}}const Yc={symbol:function(T,r,u,m,C){if(T.renderPass!=="translucent")return;const N=qr.disabled,ee=T.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(le,de,be,Ae,ze,Ge,et){const Qe=de.transform,Je=ze==="map",dt=Ge==="map";for(const gt of le){const vt=Ae.getTile(gt),nt=vt.getBucket(be);if(!nt||!nt.text||!nt.text.segments.get().length)continue;const kt=s.evaluateSizeForZoom(nt.textSizeData,Qe.zoom),_t=Xi(vt,1,de.transform.zoom),Ot=rt(gt.posMatrix,dt,Je,de.transform,_t),zt=be.layout.get("icon-text-fit")!=="none"&&nt.hasIconData();if(kt){const Ut=Math.pow(2,Qe.zoom-vt.tileID.overscaledZ);Am(nt,Je,dt,et,Qe,Ot,gt.posMatrix,Ut,kt,zt,de.style.terrain?(Dt,ni)=>de.style.terrain.getElevation(gt,Dt,ni):null)}}}(m,T,u,r,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),C),u.paint.get("icon-opacity").constantOr(1)!==0&&Ll(T,r,u,m,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),N,ee),u.paint.get("text-opacity").constantOr(1)!==0&&Ll(T,r,u,m,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),N,ee),r.map.showCollisionBoxes&&(rp(T,r,u,m,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),rp(T,r,u,m,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(T,r,u,m){if(T.renderPass!=="translucent")return;const C=u.paint.get("circle-opacity"),N=u.paint.get("circle-stroke-width"),ee=u.paint.get("circle-stroke-opacity"),le=!u.layout.get("circle-sort-key").isConstant();if(C.constantOr(1)===0&&(N.constantOr(1)===0||ee.constantOr(1)===0))return;const de=T.context,be=de.gl,Ae=T.depthModeForSublayer(0,bi.ReadOnly),ze=qr.disabled,Ge=T.colorModeForRenderPass(),et=[];for(let Qe=0;Qe<m.length;Qe++){const Je=m[Qe],dt=r.getTile(Je),gt=dt.getBucket(u);if(!gt)continue;const vt=gt.programConfigurations.get(u.id),nt=T.useProgram("circle",vt),kt=gt.layoutVertexBuffer,_t=gt.indexBuffer,Ot=T.style.terrain&&T.style.terrain.getTerrainData(Je),zt={programConfiguration:vt,program:nt,layoutVertexBuffer:kt,indexBuffer:_t,uniformValues:ca(T,Je,dt,u),terrainData:Ot};if(le){const Ut=gt.segments.get();for(const Dt of Ut)et.push({segments:new s.SegmentVector([Dt]),sortKey:Dt.sortKey,state:zt})}else et.push({segments:gt.segments,sortKey:0,state:zt})}le&&et.sort((Qe,Je)=>Qe.sortKey-Je.sortKey);for(const Qe of et){const{programConfiguration:Je,program:dt,layoutVertexBuffer:gt,indexBuffer:vt,uniformValues:nt,terrainData:kt}=Qe.state;dt.draw(de,be.TRIANGLES,Ae,ze,Ge,Nr.disabled,nt,kt,u.id,gt,vt,Qe.segments,u.paint,T.transform.zoom,Je)}},heatmap:function(T,r,u,m){if(u.paint.get("heatmap-opacity")!==0)if(T.renderPass==="offscreen"){const C=T.context,N=C.gl,ee=qr.disabled,le=new tn([N.ONE,N.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(de,be,Ae){const ze=de.gl;de.activeTexture.set(ze.TEXTURE1),de.viewport.set([0,0,be.width/4,be.height/4]);let Ge=Ae.heatmapFbo;if(Ge)ze.bindTexture(ze.TEXTURE_2D,Ge.colorAttachment.get()),de.bindFramebuffer.set(Ge.framebuffer);else{const et=ze.createTexture();ze.bindTexture(ze.TEXTURE_2D,et),ze.texParameteri(ze.TEXTURE_2D,ze.TEXTURE_WRAP_S,ze.CLAMP_TO_EDGE),ze.texParameteri(ze.TEXTURE_2D,ze.TEXTURE_WRAP_T,ze.CLAMP_TO_EDGE),ze.texParameteri(ze.TEXTURE_2D,ze.TEXTURE_MIN_FILTER,ze.LINEAR),ze.texParameteri(ze.TEXTURE_2D,ze.TEXTURE_MAG_FILTER,ze.LINEAR),Ge=Ae.heatmapFbo=de.createFramebuffer(be.width/4,be.height/4,!1),function(Qe,Je,dt,gt){const vt=Qe.gl;vt.texImage2D(vt.TEXTURE_2D,0,vt.RGBA,Je.width/4,Je.height/4,0,vt.RGBA,Qe.extRenderToTextureHalfFloat?Qe.extTextureHalfFloat.HALF_FLOAT_OES:vt.UNSIGNED_BYTE,null),gt.colorAttachment.set(dt)}(de,be,et,Ge)}})(C,T,u),C.clear({color:s.Color.transparent});for(let de=0;de<m.length;de++){const be=m[de];if(r.hasRenderableParent(be))continue;const Ae=r.getTile(be),ze=Ae.getBucket(u);if(!ze)continue;const Ge=ze.programConfigurations.get(u.id),et=T.useProgram("heatmap",Ge),{zoom:Qe}=T.transform;et.draw(C,N.TRIANGLES,bi.disabled,ee,le,Nr.disabled,Dc(be.posMatrix,Ae,Qe,u.paint.get("heatmap-intensity")),null,u.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,u.paint,T.transform.zoom,Ge)}C.viewport.set([0,0,T.width,T.height])}else T.renderPass==="translucent"&&(T.context.setColorMode(T.colorModeForRenderPass()),function(C,N){const ee=C.context,le=ee.gl,de=N.heatmapFbo;if(!de)return;ee.activeTexture.set(le.TEXTURE0),le.bindTexture(le.TEXTURE_2D,de.colorAttachment.get()),ee.activeTexture.set(le.TEXTURE1);let be=N.colorRampTexture;be||(be=N.colorRampTexture=new S(ee,N.colorRamp,le.RGBA)),be.bind(le.LINEAR,le.CLAMP_TO_EDGE),C.useProgram("heatmapTexture").draw(ee,le.TRIANGLES,bi.disabled,qr.disabled,C.colorModeForRenderPass(),Nr.disabled,((Ae,ze,Ge,et)=>{const Qe=s.create();s.ortho(Qe,0,Ae.width,Ae.height,0,0,1);const Je=Ae.context.gl;return{u_matrix:Qe,u_world:[Je.drawingBufferWidth,Je.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ze.paint.get("heatmap-opacity")}})(C,N),null,N.id,C.viewportBuffer,C.quadTriangleIndexBuffer,C.viewportSegments,N.paint,C.transform.zoom)}(T,u))},line:function(T,r,u,m){if(T.renderPass!=="translucent")return;const C=u.paint.get("line-opacity"),N=u.paint.get("line-width");if(C.constantOr(1)===0||N.constantOr(1)===0)return;const ee=T.depthModeForSublayer(0,bi.ReadOnly),le=T.colorModeForRenderPass(),de=u.paint.get("line-dasharray"),be=u.paint.get("line-pattern"),Ae=be.constantOr(1),ze=u.paint.get("line-gradient"),Ge=u.getCrossfadeParameters(),et=Ae?"linePattern":de?"lineSDF":ze?"lineGradient":"line",Qe=T.context,Je=Qe.gl;let dt=!0;for(const gt of m){const vt=r.getTile(gt);if(Ae&&!vt.patternsLoaded())continue;const nt=vt.getBucket(u);if(!nt)continue;const kt=nt.programConfigurations.get(u.id),_t=T.context.program.get(),Ot=T.useProgram(et,kt),zt=dt||Ot.program!==_t,Ut=T.style.terrain&&T.style.terrain.getTerrainData(gt),Dt=be.constantOr(null);if(Dt&&vt.imageAtlas){const oi=vt.imageAtlas,Hi=oi.patternPositions[Dt.to.toString()],er=oi.patternPositions[Dt.from.toString()];Hi&&er&&kt.setConstantPatternPositions(Hi,er)}const ni=Ut?gt:null,qt=Ae?Al(T,vt,u,Ge,ni):de?Yr(T,vt,u,de,Ge,ni):ze?Rc(T,vt,u,nt.lineClipsArray.length,ni):Ml(T,vt,u,ni);if(Ae)Qe.activeTexture.set(Je.TEXTURE0),vt.imageAtlasTexture.bind(Je.LINEAR,Je.CLAMP_TO_EDGE),kt.updatePaintBuffers(Ge);else if(de&&(zt||T.lineAtlas.dirty))Qe.activeTexture.set(Je.TEXTURE0),T.lineAtlas.bind(Qe);else if(ze){const oi=nt.gradients[u.id];let Hi=oi.texture;if(u.gradientVersion!==oi.version){let er=256;if(u.stepInterpolant){const ki=r.getSource().maxzoom,Cr=gt.canonical.z===ki?Math.ceil(1<<T.transform.maxZoom-gt.canonical.z):1;er=s.clamp(s.nextPowerOfTwo(nt.maxLineLength/s.EXTENT*1024*Cr),256,Qe.maxTextureSize)}oi.gradient=s.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:er,image:oi.gradient||void 0,clips:nt.lineClipsArray}),oi.texture?oi.texture.update(oi.gradient):oi.texture=new S(Qe,oi.gradient,Je.RGBA),oi.version=u.gradientVersion,Hi=oi.texture}Qe.activeTexture.set(Je.TEXTURE0),Hi.bind(u.stepInterpolant?Je.NEAREST:Je.LINEAR,Je.CLAMP_TO_EDGE)}Ot.draw(Qe,Je.TRIANGLES,ee,T.stencilModeForClipping(gt),le,Nr.disabled,qt,Ut,u.id,nt.layoutVertexBuffer,nt.indexBuffer,nt.segments,u.paint,T.transform.zoom,kt,nt.layoutVertexBuffer2),dt=!1}},fill:function(T,r,u,m){const C=u.paint.get("fill-color"),N=u.paint.get("fill-opacity");if(N.constantOr(1)===0)return;const ee=T.colorModeForRenderPass(),le=u.paint.get("fill-pattern"),de=T.opaquePassEnabledForLayer()&&!le.constantOr(1)&&C.constantOr(s.Color.transparent).a===1&&N.constantOr(0)===1?"opaque":"translucent";if(T.renderPass===de){const be=T.depthModeForSublayer(1,T.renderPass==="opaque"?bi.ReadWrite:bi.ReadOnly);Uc(T,r,u,m,be,ee,!1)}if(T.renderPass==="translucent"&&u.paint.get("fill-antialias")){const be=T.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,bi.ReadOnly);Uc(T,r,u,m,be,ee,!0)}},"fill-extrusion":function(T,r,u,m){const C=u.paint.get("fill-extrusion-opacity");if(C!==0&&T.renderPass==="translucent"){const N=new bi(T.context.gl.LEQUAL,bi.ReadWrite,T.depthRangeFor3D);if(C!==1||u.paint.get("fill-extrusion-pattern").constantOr(1))Ol(T,r,u,m,N,qr.disabled,tn.disabled),Ol(T,r,u,m,N,T.stencilModeFor3D(),T.colorModeForRenderPass());else{const ee=T.colorModeForRenderPass();Ol(T,r,u,m,N,qr.disabled,ee)}}},hillshade:function(T,r,u,m){if(T.renderPass!=="offscreen"&&T.renderPass!=="translucent")return;const C=T.context,N=T.depthModeForSublayer(0,bi.ReadOnly),ee=T.colorModeForRenderPass(),[le,de]=T.renderPass==="translucent"?T.stencilConfigForOverlap(m):[{},m];for(const be of de){const Ae=r.getTile(be);Ae.needsHillshadePrepare!==void 0&&Ae.needsHillshadePrepare&&T.renderPass==="offscreen"?$c(T,Ae,u,N,qr.disabled,ee):T.renderPass==="translucent"&&sp(T,be,Ae,u,N,le[be.overscaledZ],ee)}C.viewport.set([0,0,T.width,T.height])},raster:function(T,r,u,m){if(T.renderPass!=="translucent"||u.paint.get("raster-opacity")===0||!m.length)return;const C=T.context,N=C.gl,ee=r.getSource(),le=T.useProgram("raster"),de=T.colorModeForRenderPass(),[be,Ae]=ee instanceof H?[{},m]:T.stencilConfigForOverlap(m),ze=Ae[Ae.length-1].overscaledZ,Ge=!T.options.moving;for(const et of Ae){const Qe=T.depthModeForSublayer(et.overscaledZ-ze,u.paint.get("raster-opacity")===1?bi.ReadWrite:bi.ReadOnly,N.LESS),Je=r.getTile(et);Je.registerFadeDuration(u.paint.get("raster-fade-duration"));const dt=r.findLoadedParent(et,0),gt=Gc(Je,dt,r,u,T.transform,T.style.terrain);let vt,nt;const kt=u.paint.get("raster-resampling")==="nearest"?N.NEAREST:N.LINEAR;C.activeTexture.set(N.TEXTURE0),Je.texture.bind(kt,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST),C.activeTexture.set(N.TEXTURE1),dt?(dt.texture.bind(kt,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST),vt=Math.pow(2,dt.tileID.overscaledZ-Je.tileID.overscaledZ),nt=[Je.tileID.canonical.x*vt%1,Je.tileID.canonical.y*vt%1]):Je.texture.bind(kt,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST);const _t=T.style.terrain&&T.style.terrain.getTerrainData(et),Ot=_t?et:null,zt=Ot?Ot.posMatrix:T.transform.calculatePosMatrix(et.toUnwrapped(),Ge),Ut=qd(zt,nt||[0,0],vt||1,gt,u);ee instanceof H?le.draw(C,N.TRIANGLES,Qe,qr.disabled,de,Nr.disabled,Ut,_t,u.id,ee.boundsBuffer,T.quadTriangleIndexBuffer,ee.boundsSegments):le.draw(C,N.TRIANGLES,Qe,be[et.overscaledZ],de,Nr.disabled,Ut,_t,u.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments)}},background:function(T,r,u,m){const C=u.paint.get("background-color"),N=u.paint.get("background-opacity");if(N===0)return;const ee=T.context,le=ee.gl,de=T.transform,be=de.tileSize,Ae=u.paint.get("background-pattern");if(T.isPatternMissing(Ae))return;const ze=!Ae&&C.a===1&&N===1&&T.opaquePassEnabledForLayer()?"opaque":"translucent";if(T.renderPass!==ze)return;const Ge=qr.disabled,et=T.depthModeForSublayer(0,ze==="opaque"?bi.ReadWrite:bi.ReadOnly),Qe=T.colorModeForRenderPass(),Je=T.useProgram(Ae?"backgroundPattern":"background"),dt=m||de.coveringTiles({tileSize:be,terrain:T.style.terrain});Ae&&(ee.activeTexture.set(le.TEXTURE0),T.imageManager.bind(T.context));const gt=u.getCrossfadeParameters();for(const vt of dt){const nt=m?vt.posMatrix:T.transform.calculatePosMatrix(vt.toUnwrapped()),kt=Ae?tu(nt,N,T,Ae,{tileID:vt,tileSize:be},gt):vm(nt,N,C),_t=T.style.terrain&&T.style.terrain.getTerrainData(vt);Je.draw(ee,le.TRIANGLES,et,Ge,Qe,Nr.disabled,kt,_t,u.id,T.tileExtentBuffer,T.quadTriangleIndexBuffer,T.tileExtentSegments)}},debug:function(T,r,u){for(let m=0;m<u.length;m++)yu(T,r,u[m])},custom:function(T,r,u){const m=T.context,C=u.implementation;if(T.renderPass==="offscreen"){const N=C.prerender;N&&(T.setCustomLayerDefaults(),m.setColorMode(T.colorModeForRenderPass()),N.call(C,m.gl,T.transform.customLayerMatrix()),m.setDirty(),T.setBaseState())}else if(T.renderPass==="translucent"){T.setCustomLayerDefaults(),m.setColorMode(T.colorModeForRenderPass()),m.setStencilMode(qr.disabled);const N=C.renderingMode==="3d"?new bi(T.context.gl.LEQUAL,bi.ReadWrite,T.depthRangeFor3D):T.depthModeForSublayer(0,bi.ReadOnly);m.setDepthMode(N),C.render(m.gl,T.transform.customLayerMatrix()),m.setDirty(),T.setBaseState(),m.bindFramebuffer.set(null)}}};class cp{constructor(r,u){this.context=new fu(r),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.create(),renderTime:0},this.setup(),this.numSublayers=Q.maxUnderzooming+Q.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new zi,this.gpuTimers={}}resize(r,u,m){if(this.width=r*m,this.height=u*m,this.pixelRatio=m,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const C of this.style._order)this.style._layers[C].resize()}setup(){const r=this.context,u=new s.PosArray;u.emplaceBack(0,0),u.emplaceBack(s.EXTENT,0),u.emplaceBack(0,s.EXTENT),u.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(u,yi.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const m=new s.PosArray;m.emplaceBack(0,0),m.emplaceBack(s.EXTENT,0),m.emplaceBack(0,s.EXTENT),m.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=r.createVertexBuffer(m,yi.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const C=new s.RasterBoundsArray;C.emplaceBack(0,0,0,0),C.emplaceBack(s.EXTENT,0,s.EXTENT,0),C.emplaceBack(0,s.EXTENT,0,s.EXTENT),C.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.rasterBoundsBuffer=r.createVertexBuffer(C,F.members),this.rasterBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const N=new s.PosArray;N.emplaceBack(0,0),N.emplaceBack(1,0),N.emplaceBack(0,1),N.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(N,yi.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const ee=new s.LineStripIndexArray;ee.emplaceBack(0),ee.emplaceBack(1),ee.emplaceBack(3),ee.emplaceBack(2),ee.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(ee);const le=new s.TriangleIndexArray;le.emplaceBack(0,1,2),le.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(le),this.emptyTexture=new S(r,{width:1,height:1,data:new Uint8Array([0,0,0,0])},r.gl.RGBA);const de=this.context.gl;this.stencilClearMode=new qr({func:de.ALWAYS,mask:0},0,255,de.ZERO,de.ZERO,de.ZERO)}clearStencil(){const r=this.context,u=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const m=s.create();s.ortho(m,0,this.width,this.height,0,0,1),s.scale(m,m,[u.drawingBufferWidth,u.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,u.TRIANGLES,bi.disabled,this.stencilClearMode,tn.disabled,Nr.disabled,kl(m),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,u){if(this.currentStencilSource===r.source||!r.isTileClipped()||!u||!u.length)return;this.currentStencilSource=r.source;const m=this.context,C=m.gl;this.nextStencilID+u.length>256&&this.clearStencil(),m.setColorMode(tn.disabled),m.setDepthMode(bi.disabled);const N=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const ee of u){const le=this._tileClippingMaskIDs[ee.key]=this.nextStencilID++,de=this.style.terrain&&this.style.terrain.getTerrainData(ee);N.draw(m,C.TRIANGLES,bi.disabled,new qr({func:C.ALWAYS,mask:0},le,255,C.KEEP,C.KEEP,C.REPLACE),tn.disabled,Nr.disabled,kl(ee.posMatrix),de,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,u=this.context.gl;return new qr({func:u.NOTEQUAL,mask:255},r,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(r){const u=this.context.gl;return new qr({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(r){const u=this.context.gl,m=r.sort((ee,le)=>le.overscaledZ-ee.overscaledZ),C=m[m.length-1].overscaledZ,N=m[0].overscaledZ-C+1;if(N>1){this.currentStencilSource=void 0,this.nextStencilID+N>256&&this.clearStencil();const ee={};for(let le=0;le<N;le++)ee[le+C]=new qr({func:u.GEQUAL,mask:255},le+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=N,[ee,m]}return[{[C]:qr.disabled},m]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new tn([r.CONSTANT_COLOR,r.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?tn.unblended:tn.alphaBlended}depthModeForSublayer(r,u,m){if(!this.opaquePassEnabledForLayer())return bi.disabled;const C=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new bi(m||this.context.gl.LEQUAL,u,[C,C])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,u){this.style=r,this.options=u,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const m=this.style._order,C=this.style.sourceCaches,N=this.style.terrain&&new Wc(this);for(const be in C){const Ae=C[be];Ae.used&&Ae.prepare(this.context)}const ee={},le={},de={};for(const be in C){const Ae=C[be];ee[be]=Ae.getVisibleCoordinates(),le[be]=ee[be].slice().reverse(),de[be]=Ae.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let be=0;be<m.length;be++)if(this.style._layers[m[be]].is3D()){this.opaquePassCutoff=be;break}if(N){this.opaquePassCutoff=0;const be=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!s.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||be.length)&&(s.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(Ae,ze){const Ge=Ae.context,et=Ge.gl,Qe=tn.unblended,Je=new bi(et.LEQUAL,bi.ReadWrite,[0,1]),dt=ze.getTerrainMesh(),gt=ze.sourceCache.getRenderableTiles(),vt=Ae.useProgram("terrainDepth");Ge.bindFramebuffer.set(ze.getFramebuffer("depth").framebuffer),Ge.viewport.set([0,0,Ae.width/devicePixelRatio,Ae.height/devicePixelRatio]),Ge.clear({color:s.Color.transparent,depth:1});for(const nt of gt){const kt=ze.getTerrainData(nt.tileID),_t=Ae.transform.calculatePosMatrix(nt.tileID.toUnwrapped());vt.draw(Ge,et.TRIANGLES,Je,qr.disabled,Qe,Nr.backCCW,{u_matrix:_t},kt,"terrain",dt.vertexBuffer,dt.indexBuffer,dt.segments)}Ge.bindFramebuffer.set(null),Ge.viewport.set([0,0,Ae.width,Ae.height])}(this,this.style.terrain),function(Ae,ze){const Ge=Ae.context,et=Ge.gl,Qe=tn.unblended,Je=new bi(et.LEQUAL,bi.ReadWrite,[0,1]),dt=ze.getTerrainMesh(),gt=ze.getCoordsTexture(),vt=ze.sourceCache.getRenderableTiles(),nt=Ae.useProgram("terrainCoords");Ge.bindFramebuffer.set(ze.getFramebuffer("coords").framebuffer),Ge.viewport.set([0,0,Ae.width/devicePixelRatio,Ae.height/devicePixelRatio]),Ge.clear({color:s.Color.transparent,depth:1}),ze.coordsIndex=[];for(const kt of vt){const _t=ze.getTerrainData(kt.tileID);Ge.activeTexture.set(et.TEXTURE0),et.bindTexture(et.TEXTURE_2D,gt.texture);const Ot=Ae.transform.calculatePosMatrix(kt.tileID.toUnwrapped());nt.draw(Ge,et.TRIANGLES,Je,qr.disabled,Qe,Nr.backCCW,{u_matrix:Ot,u_terrain_coords_id:(255-ze.coordsIndex.length)/255,u_texture:0},_t,"terrain",dt.vertexBuffer,dt.indexBuffer,dt.segments),ze.coordsIndex.push(kt.tileID.key)}Ge.bindFramebuffer.set(null),Ge.viewport.set([0,0,Ae.width,Ae.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const be of m){const Ae=this.style._layers[be];if(!Ae.hasOffscreenPass()||Ae.isHidden(this.transform.zoom))continue;const ze=le[Ae.source];(Ae.type==="custom"||ze.length)&&this.renderLayer(this,C[Ae.source],Ae,ze)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!N)for(this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const be=this.style._layers[m[this.currentLayer]],Ae=C[be.source],ze=ee[be.source];this._renderTileClippingMasks(be,ze),this.renderLayer(this,Ae,be,ze)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const be=this.style._layers[m[this.currentLayer]],Ae=C[be.source];if(N&&N.renderLayer(be))continue;const ze=(be.type==="symbol"?de:le)[be.source];this._renderTileClippingMasks(be,ee[be.source]),this.renderLayer(this,Ae,be,ze)}if(this.options.showTileBoundaries){let be,Ae;Object.values(this.style._layers).forEach(ze=>{ze.source&&!ze.isHidden(this.transform.zoom)&&(ze.source!==(Ae&&Ae.id)&&(Ae=this.style.sourceCaches[ze.source]),(!be||be.getSource().maxzoom<Ae.getSource().maxzoom)&&(be=Ae))}),be&&Yc.debug(this,be,be.getVisibleCoordinates())}this.options.showPadding&&function(be){const Ae=be.transform.padding;zl(be,be.transform.height-(Ae.top||0),3,Qs),zl(be,Ae.bottom||0,3,op),Vc(be,Ae.left||0,3,gu),Vc(be,be.transform.width-(Ae.right||0),3,ap);const ze=be.transform.centerPoint;(function(Ge,et,Qe,Je){Hc(Ge,et-1,Qe-10,2,20,Je),Hc(Ge,et-10,Qe-1,20,2,Je)})(be,ze.x,be.transform.height-ze.y,Va)}(this),this.context.setDefault()}renderLayer(r,u,m,C){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="custom"||(C||[]).length)&&(this.id=m.id,this.gpuTimingStart(m),Yc[m.type](r,u,m,C,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let m=this.gpuTimers[r.id];m||(m=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),m.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,m.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}queryGpuTimers(r){const u={};for(const m in r){const C=r[m],N=this.context.extTimerQuery,ee=N.getQueryObjectEXT(C.query,N.QUERY_RESULT_EXT)/1e6;N.deleteQueryEXT(C.query),u[m]=ee}return u}translatePosMatrix(r,u,m,C,N){if(!m[0]&&!m[1])return r;const ee=N?C==="map"?this.transform.angle:0:C==="viewport"?-this.transform.angle:0;if(ee){const be=Math.sin(ee),Ae=Math.cos(ee);m=[m[0]*Ae-m[1]*be,m[0]*be+m[1]*Ae]}const le=[N?m[0]:Xi(u,m[0],this.transform.zoom),N?m[1]:Xi(u,m[1],this.transform.zoom),0],de=new Float32Array(16);return s.translate(de,r,le),de}saveTileTexture(r){const u=this._tileTextures[r.size[0]];u?u.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const u=this._tileTextures[r];return u&&u.length>0?u.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const u=this.imageManager.getPattern(r.from.toString()),m=this.imageManager.getPattern(r.to.toString());return!u||!m}useProgram(r,u){this.cache=this.cache||{};const m=r+(u?u.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[m]||(this.cache[m]=new xm(this.context,r,Sl[r],u,iu[r],this._showOverdrawInspector,this.style.terrain)),this.cache[m]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new S(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class qc{constructor(r,u){this.points=r,this.planes=u}static fromInvProjectionMatrix(r,u,m){const C=Math.pow(2,m),N=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(le=>{const de=1/(le=s.transformMat4([],le,r))[3]/u*C;return s.mul$1(le,le,[de,de,1/le[3],de])}),ee=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(le=>{const de=s.sub([],N[le[0]],N[le[1]]),be=s.sub([],N[le[2]],N[le[1]]),Ae=s.normalize([],s.cross([],de,be)),ze=-s.dot(Ae,N[le[1]]);return Ae.concat(ze)});return new qc(N,ee)}}class ha{constructor(r,u){this.min=r,this.max=u,this.center=s.scale$1([],s.add([],this.min,this.max),.5)}quadrant(r){const u=[r%2==0,r<2],m=s.clone$2(this.min),C=s.clone$2(this.max);for(let N=0;N<u.length;N++)m[N]=u[N]?this.min[N]:this.center[N],C[N]=u[N]?this.center[N]:this.max[N];return C[2]=this.max[2],new ha(m,C)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersects(r){const u=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let m=!0;for(let C=0;C<r.planes.length;C++){const N=r.planes[C];let ee=0;for(let le=0;le<u.length;le++)s.dot$1(N,u[le])>=0&&ee++;if(ee===0)return 0;ee!==u.length&&(m=!1)}if(m)return 2;for(let C=0;C<3;C++){let N=Number.MAX_VALUE,ee=-Number.MAX_VALUE;for(let le=0;le<r.points.length;le++){const de=r.points[le][C]-this.min[C];N=Math.min(N,de),ee=Math.max(ee,de)}if(ee<0||N>this.max[C]-this.min[C])return 0}return 1}}class Nl{constructor(r=0,u=0,m=0,C=0){if(isNaN(r)||r<0||isNaN(u)||u<0||isNaN(m)||m<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=u,this.left=m,this.right=C}interpolate(r,u,m){return u.top!=null&&r.top!=null&&(this.top=s.number(r.top,u.top,m)),u.bottom!=null&&r.bottom!=null&&(this.bottom=s.number(r.bottom,u.bottom,m)),u.left!=null&&r.left!=null&&(this.left=s.number(r.left,u.left,m)),u.right!=null&&r.right!=null&&(this.right=s.number(r.right,u.right,m)),this}getCenter(r,u){const m=s.clamp((this.left+r-this.right)/2,0,r),C=s.clamp((this.top+u-this.bottom)/2,0,u);return new s.pointGeometry(m,C)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Nl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Xc{constructor(r,u,m,C,N){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=N===void 0||!!N,this._minZoom=r||0,this._maxZoom=u||22,this._minPitch=m??0,this._maxPitch=C??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Nl,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const r=new Xc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.tileSize=this.tileSize,r.latRange=this.latRange,r.width=this.width,r.height=this.height,r._center=this._center,r._elevation=this._elevation,r.zoom=this.zoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._calcMatrices(),r}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){const u=-s.wrap(r,-180,180)*Math.PI/180;var m;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(m=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m),function(C,N,ee){var le=N[0],de=N[1],be=N[2],Ae=N[3],ze=Math.sin(ee),Ge=Math.cos(ee);C[0]=le*Ge+be*ze,C[1]=de*Ge+Ae*ze,C[2]=le*-ze+be*Ge,C[3]=de*-ze+Ae*Ge}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const u=s.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(r){const u=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this.scale=this.zoomScale(u),this.tileZoom=Math.floor(u),this.zoomFraction=u-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,u,m){this._unmodified=!1,this._edgeInsets.interpolate(r,u,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const u=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(r){const u=[new s.UnwrappedTileID(0,r)];if(this._renderWorldCopies){const m=this.pointCoordinate(new s.pointGeometry(0,0)),C=this.pointCoordinate(new s.pointGeometry(this.width,0)),N=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),ee=this.pointCoordinate(new s.pointGeometry(0,this.height)),le=Math.floor(Math.min(m.x,C.x,N.x,ee.x)),de=Math.floor(Math.max(m.x,C.x,N.x,ee.x)),be=1;for(let Ae=le-be;Ae<=de+be;Ae++)Ae!==0&&u.push(new s.UnwrappedTileID(Ae,r))}return u}coveringTiles(r){var u,m;let C=this.coveringZoomLevel(r);const N=C;if(r.minzoom!==void 0&&C<r.minzoom)return[];r.maxzoom!==void 0&&C>r.maxzoom&&(C=r.maxzoom);const ee=this.pointCoordinate(this.getCameraPoint()),le=s.MercatorCoordinate.fromLngLat(this.center),de=Math.pow(2,C),be=[de*ee.x,de*ee.y,0],Ae=[de*le.x,de*le.y,0],ze=qc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,C);let Ge=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(Ge=C);const et=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,Qe=nt=>({aabb:new ha([nt*de,0,0],[(nt+1)*de,de,0]),zoom:0,x:0,y:0,wrap:nt,fullyVisible:!1}),Je=[],dt=[],gt=C,vt=r.reparseOverscaled?N:C;if(this._renderWorldCopies)for(let nt=1;nt<=3;nt++)Je.push(Qe(-nt)),Je.push(Qe(nt));for(Je.push(Qe(0));Je.length>0;){const nt=Je.pop(),kt=nt.x,_t=nt.y;let Ot=nt.fullyVisible;if(!Ot){const oi=nt.aabb.intersects(ze);if(oi===0)continue;Ot=oi===2}const zt=r.terrain?be:Ae,Ut=nt.aabb.distanceX(zt),Dt=nt.aabb.distanceY(zt),ni=Math.max(Math.abs(Ut),Math.abs(Dt)),qt=et+(1<<gt-nt.zoom)-2;if(nt.zoom===gt||ni>qt&&nt.zoom>=Ge){const oi=gt-nt.zoom,Hi=be[0]-.5-(kt<<oi),er=be[1]-.5-(_t<<oi);dt.push({tileID:new s.OverscaledTileID(nt.zoom===gt?vt:nt.zoom,nt.wrap,nt.zoom,kt,_t),distanceSq:s.sqrLen([Ae[0]-.5-kt,Ae[1]-.5-_t]),tileDistanceToCamera:Math.sqrt(Hi*Hi+er*er)})}else for(let oi=0;oi<4;oi++){const Hi=(kt<<1)+oi%2,er=(_t<<1)+(oi>>1),ki=nt.zoom+1;let Cr=nt.aabb.quadrant(oi);if(r.terrain){const Sr=new s.OverscaledTileID(ki,nt.wrap,ki,Hi,er),lr=r.terrain.getMinMaxElevation(Sr),hr=(u=lr.minElevation)!==null&&u!==void 0?u:this.elevation,pr=(m=lr.maxElevation)!==null&&m!==void 0?m:this.elevation;Cr=new ha([Cr.min[0],Cr.min[1],hr],[Cr.max[0],Cr.max[1],pr])}Je.push({aabb:Cr,zoom:ki,x:Hi,y:er,wrap:nt.wrap,fullyVisible:Ot})}}return dt.sort((nt,kt)=>nt.distanceSq-kt.distanceSq).map(nt=>nt.tileID)}resize(r,u){this.width=r,this.height=u,this.pixelsToGLUnits=[2/r,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const u=s.clamp(r.lat,-this.maxValidLatitude,this.maxValidLatitude);return new s.pointGeometry(s.mercatorXfromLng(r.lng)*this.worldSize,s.mercatorYfromLat(u)*this.worldSize)}unproject(r){return new s.MercatorCoordinate(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(r){this.freezeElevation||(this.elevation=r?this.getElevation(this._center,r):0)}getElevation(r,u){const m=s.MercatorCoordinate.fromLngLat(r),C=(1<<this.tileZoom)*s.EXTENT,N=m.x*C,ee=m.y*C,le=Math.floor(N/s.EXTENT),de=Math.floor(ee/s.EXTENT),be=new s.OverscaledTileID(this.tileZoom,0,this.tileZoom,le,de);return u.getElevation(be,N%s.EXTENT,ee%s.EXTENT,s.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){const u=this.pointLocation(this.centerPoint,r),m=this.getElevation(u,r);if(!(this.elevation-m))return;const C=this.getCameraPosition(),N=s.MercatorCoordinate.fromLngLat(C.lngLat,C.altitude),ee=s.MercatorCoordinate.fromLngLat(u,m),le=N.x-ee.x,de=N.y-ee.y,be=N.z-ee.z,Ae=Math.sqrt(le*le+de*de+be*be),ze=this.scaleZoom(this.cameraToCenterDistance/Ae/this.tileSize);this._elevation=m,this._center=u,this.zoom=ze}setLocationAtPoint(r,u){const m=this.pointCoordinate(u),C=this.pointCoordinate(this.centerPoint),N=this.locationCoordinate(r),ee=new s.MercatorCoordinate(N.x-(m.x-C.x),N.y-(m.y-C.y));this.center=this.coordinateLocation(ee),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r,u){return u?this.coordinatePoint(this.locationCoordinate(r),this.getElevation(r,u),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(r))}pointLocation(r,u){return this.coordinateLocation(this.pointCoordinate(r,u))}locationCoordinate(r){return s.MercatorCoordinate.fromLngLat(r)}coordinateLocation(r){return r&&r.toLngLat()}pointCoordinate(r,u){if(u){const Ge=u.pointCoordinate(r);if(Ge!=null)return Ge}const m=[r.x,r.y,0,1],C=[r.x,r.y,1,1];s.transformMat4(m,m,this.pixelMatrixInverse),s.transformMat4(C,C,this.pixelMatrixInverse);const N=m[3],ee=C[3],le=m[1]/N,de=C[1]/ee,be=m[2]/N,Ae=C[2]/ee,ze=be===Ae?0:(0-be)/(Ae-be);return new s.MercatorCoordinate(s.number(m[0]/N,C[0]/ee,ze)/this.worldSize,s.number(le,de,ze)/this.worldSize)}coordinatePoint(r,u=0,m=this.pixelMatrix){const C=[r.x*this.worldSize,r.y*this.worldSize,u,1];return s.transformMat4(C,C,m),new s.pointGeometry(C[0]/C[3],C[1]/C[3])}getBounds(){const r=Math.max(0,this.height/2-this.getHorizon());return new s.LngLatBounds().extend(this.pointLocation(new s.pointGeometry(0,r))).extend(this.pointLocation(new s.pointGeometry(this.width,r))).extend(this.pointLocation(new s.pointGeometry(this.width,this.height))).extend(this.pointLocation(new s.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new s.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(r,u=!1){const m=r.key,C=u?this._alignedPosMatrixCache:this._posMatrixCache;if(C[m])return C[m];const N=r.canonical,ee=this.worldSize/this.zoomScale(N.z),le=N.x+Math.pow(2,N.z)*r.wrap,de=s.identity(new Float64Array(16));return s.translate(de,de,[le*ee,N.y*ee,0]),s.scale(de,de,[ee/s.EXTENT,ee/s.EXTENT,1]),s.multiply(de,u?this.alignedProjMatrix:this.projMatrix,de),C[m]=new Float32Array(de),C[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let r,u,m,C,N=-90,ee=90,le=-180,de=180;const be=this.size,Ae=this._unmodified;if(this.latRange){const et=this.latRange;N=s.mercatorYfromLat(et[1])*this.worldSize,ee=s.mercatorYfromLat(et[0])*this.worldSize,r=ee-N<be.y?be.y/(ee-N):0}if(this.lngRange){const et=this.lngRange;le=s.wrap(s.mercatorXfromLng(et[0])*this.worldSize,0,this.worldSize),de=s.wrap(s.mercatorXfromLng(et[1])*this.worldSize,0,this.worldSize),de<le&&(de+=this.worldSize),u=de-le<be.x?be.x/(de-le):0}const ze=this.point,Ge=Math.max(u||0,r||0);if(Ge)return this.center=this.unproject(new s.pointGeometry(u?(de+le)/2:ze.x,r?(ee+N)/2:ze.y)),this.zoom+=this.scaleZoom(Ge),this._unmodified=Ae,void(this._constraining=!1);if(this.latRange){const et=ze.y,Qe=be.y/2;et-Qe<N&&(C=N+Qe),et+Qe>ee&&(C=ee-Qe)}if(this.lngRange){const et=(le+de)/2,Qe=s.wrap(ze.x,et-this.worldSize/2,et+this.worldSize/2),Je=be.x/2;Qe-Je<le&&(m=le+Je),Qe+Je>de&&(m=de-Je)}m===void 0&&C===void 0||(this.center=this.unproject(new s.pointGeometry(m!==void 0?m:ze.x,C!==void 0?C:ze.y)).wrap()),this._unmodified=Ae,this._constraining=!1}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,u=this.point.x,m=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=s.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let C=s.identity(new Float64Array(16));s.scale(C,C,[this.width/2,-this.height/2,1]),s.translate(C,C,[1,-1,0]),this.labelPlaneMatrix=C,C=s.identity(new Float64Array(16)),s.scale(C,C,[1,-1,1]),s.translate(C,C,[-1,-1,0]),s.scale(C,C,[2/this.width,2/this.height,1]),this.glCoordMatrix=C,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const N=Math.PI/2+this._pitch,ee=this._fov*(.5+r.y/this.height),le=Math.sin(ee)*this.cameraToSeaLevelDistance/Math.sin(s.clamp(Math.PI-N-ee,.01,Math.PI-.01)),de=this.getHorizon(),be=2*Math.atan(de/this.cameraToCenterDistance)*(.5+r.y/(2*de)),Ae=Math.sin(be)*this.cameraToSeaLevelDistance/Math.sin(s.clamp(Math.PI-N-be,.01,Math.PI-.01)),ze=Math.cos(Math.PI/2-this._pitch)*le+this.cameraToSeaLevelDistance,Ge=Math.cos(Math.PI/2-this._pitch)*Ae+this.cameraToSeaLevelDistance,et=1.01*Math.min(ze,Ge),Qe=this.height/50;C=new Float64Array(16),s.perspective(C,this._fov,this.width/this.height,Qe,et),C[8]=2*-r.x/this.width,C[9]=2*r.y/this.height,s.scale(C,C,[1,-1,1]),s.translate(C,C,[0,0,-this.cameraToCenterDistance]),s.rotateX(C,C,this._pitch),s.rotateZ(C,C,this.angle),s.translate(C,C,[-u,-m,0]),this.mercatorMatrix=s.scale([],C,[this.worldSize,this.worldSize,this.worldSize]),s.scale(C,C,[1,1,this._pixelPerMeter]),this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,C),s.translate(C,C,[0,0,-this.elevation]),this.projMatrix=C,this.invProjMatrix=s.invert([],C),this.pixelMatrix3D=s.multiply(new Float64Array(16),this.labelPlaneMatrix,C);const Je=this.width%2/2,dt=this.height%2/2,gt=Math.cos(this.angle),vt=Math.sin(this.angle),nt=u-Math.round(u)+gt*Je+vt*dt,kt=m-Math.round(m)+gt*dt+vt*Je,_t=new Float64Array(C);if(s.translate(_t,_t,[nt>.5?nt-1:nt,kt>.5?kt-1:kt,0]),this.alignedProjMatrix=_t,C=s.invert(new Float64Array(16),this.pixelMatrix),!C)throw new Error("failed to invert matrix");this.pixelMatrixInverse=C,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const r=this.pointCoordinate(new s.pointGeometry(0,0)),u=[r.x*this.worldSize,r.y*this.worldSize,0,1];return s.transformMat4(u,u,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,r))}getCameraQueryGeometry(r){const u=this.getCameraPoint();if(r.length===1)return[r[0],u];{let m=u.x,C=u.y,N=u.x,ee=u.y;for(const le of r)m=Math.min(m,le.x),C=Math.min(C,le.y),N=Math.max(N,le.x),ee=Math.max(ee,le.y);return[new s.pointGeometry(m,C),new s.pointGeometry(N,C),new s.pointGeometry(N,ee),new s.pointGeometry(m,ee),new s.pointGeometry(m,C)]}}}class hp{constructor(r){this._hashName=r&&encodeURIComponent(r),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(u,m){let C=!1,N=null;const ee=()=>{N=null,C&&(u(),N=setTimeout(ee,300),C=!1)};return()=>(C=!0,N||ee(),N)}(this._updateHashUnthrottled.bind(this))}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(r){const u=this._map.getCenter(),m=Math.round(100*this._map.getZoom())/100,C=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),N=Math.pow(10,C),ee=Math.round(u.lng*N)/N,le=Math.round(u.lat*N)/N,de=this._map.getBearing(),be=this._map.getPitch();let Ae="";if(Ae+=r?`/${ee}/${le}/${m}`:`${m}/${le}/${ee}`,(de||be)&&(Ae+="/"+Math.round(10*de)/10),be&&(Ae+=`/${Math.round(be)}`),this._hashName){const ze=this._hashName;let Ge=!1;const et=window.location.hash.slice(1).split("&").map(Qe=>{const Je=Qe.split("=")[0];return Je===ze?(Ge=!0,`${Je}=${Ae}`):Qe}).filter(Qe=>Qe);return Ge||et.push(`${ze}=${Ae}`),`#${et.join("&")}`}return`#${Ae}`}_getCurrentHash(){const r=window.location.hash.replace("#","");if(this._hashName){let u;return r.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(u=m)}),(u&&u[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._getCurrentHash();if(r.length>=3&&!r.some(u=>isNaN(u))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:u,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,r)}catch{}}}const jl={linearity:.3,easing:s.bezier(0,0,.3,1)},up=s.extend({deceleration:2500,maxSpeed:1400},jl),dp=s.extend({deceleration:20,maxSpeed:1400},jl),Ha=s.extend({deceleration:1e3,maxSpeed:360},jl),pp=s.extend({deceleration:1e3,maxSpeed:90},jl);class fp{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,u=s.exported.now();for(;r.length>0&&u-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:N}of this._inertiaBuffer)u.zoom+=N.zoomDelta||0,u.bearing+=N.bearingDelta||0,u.pitch+=N.pitchDelta||0,N.panDelta&&u.pan._add(N.panDelta),N.around&&(u.around=N.around),N.pinchAround&&(u.pinchAround=N.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(u.pan.mag()){const N=Fl(u.pan.mag(),m,s.extend({},up,r||{}));C.offset=u.pan.mult(N.amount/u.pan.mag()),C.center=this._map.transform.center,Bl(C,N)}if(u.zoom){const N=Fl(u.zoom,m,dp);C.zoom=this._map.transform.zoom+N.amount,Bl(C,N)}if(u.bearing){const N=Fl(u.bearing,m,Ha);C.bearing=this._map.transform.bearing+s.clamp(N.amount,-179,179),Bl(C,N)}if(u.pitch){const N=Fl(u.pitch,m,pp);C.pitch=this._map.transform.pitch+N.amount,Bl(C,N)}if(C.zoom||C.bearing){const N=u.pinchAround===void 0?u.around:u.pinchAround;C.around=N?this._map.unproject(N):this._map.getCenter()}return this.clear(),s.extend(C,{noMoveStart:!0})}}function Bl(T,r){(!T.duration||T.duration<r.duration)&&(T.duration=r.duration,T.easing=r.easing)}function Fl(T,r,u){const{maxSpeed:m,linearity:C,deceleration:N}=u,ee=s.clamp(T*C/(r/1e3),-m,m),le=Math.abs(ee)/(N*C);return{easing:u.easing,duration:1e3*le,amount:ee*(le/2)}}class Cs extends s.Event{constructor(r,u,m,C={}){const N=g.mousePos(u.getCanvasContainer(),m),ee=u.unproject(N);super(r,s.extend({point:N,lngLat:ee,originalEvent:m},C)),this._defaultPrevented=!1,this.target=u}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Hn extends s.Event{constructor(r,u,m){const C=r==="touchend"?m.changedTouches:m.touches,N=g.touchPos(u.getCanvasContainer(),C),ee=N.map(de=>u.unproject(de)),le=N.reduce((de,be,Ae,ze)=>de.add(be.div(ze.length)),new s.pointGeometry(0,0));super(r,{points:N,point:le,lngLats:ee,lngLat:u.unproject(le),originalEvent:m}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Pm extends s.Event{constructor(r,u,m){super(r,{originalEvent:m}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Uo{constructor(r,u){this._map=r,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new Pm(r.type,this._map,r))}mousedown(r,u){return this._mousedownPos=u,this._firePreventable(new Cs(r.type,this._map,r))}mouseup(r){this._map.fire(new Cs(r.type,this._map,r))}click(r,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Cs(r.type,this._map,r))}dblclick(r){return this._firePreventable(new Cs(r.type,this._map,r))}mouseover(r){this._map.fire(new Cs(r.type,this._map,r))}mouseout(r){this._map.fire(new Cs(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Hn(r.type,this._map,r))}touchmove(r){this._map.fire(new Hn(r.type,this._map,r))}touchend(r){this._map.fire(new Hn(r.type,this._map,r))}touchcancel(r){this._map.fire(new Hn(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class mp{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new Cs(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Cs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new Cs(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ua{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,u){this.isEnabled()&&r.shiftKey&&r.button===0&&(g.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(r,u){if(!this._active)return;const m=u;if(this._lastPos.equals(m)||!this._box&&m.dist(this._startPos)<this._clickTolerance)return;const C=this._startPos;this._lastPos=m,this._box||(this._box=g.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const N=Math.min(C.x,m.x),ee=Math.max(C.x,m.x),le=Math.min(C.y,m.y),de=Math.max(C.y,m.y);g.setTransform(this._box,`translate(${N}px,${le}px)`),this._box.style.width=ee-N+"px",this._box.style.height=de-le+"px"}mouseupWindow(r,u){if(!this._active||r.button!==0)return;const m=this._startPos,C=u;if(this.reset(),g.suppressClick(),m.x!==C.x||m.y!==C.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:N=>N.fitScreenCoordinates(m,C,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(g.remove(this._box),this._box=null),g.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,u){return this._map.fire(new s.Event(r,{originalEvent:u}))}}function da(T,r){if(T.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${T.length}, points ${r.length}`);const u={};for(let m=0;m<T.length;m++)u[T[m].identifier]=r[m];return u}class Im{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,u,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),m.length===this.numTouches&&(this.centroid=function(C){const N=new s.pointGeometry(0,0);for(const ee of C)N._add(ee);return N.div(C.length)}(u),this.touches=da(m,u)))}touchmove(r,u,m){if(this.aborted||!this.centroid)return;const C=da(m,u);for(const N in this.touches){const ee=this.touches[N],le=C[N];(!le||le.dist(ee)>30)&&(this.aborted=!0)}}touchend(r,u,m){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class bu{constructor(r){this.singleTap=new Im(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,u,m){this.singleTap.touchstart(r,u,m)}touchmove(r,u,m){this.singleTap.touchmove(r,u,m)}touchend(r,u,m){const C=this.singleTap.touchend(r,u,m);if(C){const N=r.timeStamp-this.lastTime<500,ee=!this.lastTap||this.lastTap.dist(C)<30;if(N&&ee||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class Dm{constructor(){this._zoomIn=new bu({numTouches:1,numTaps:2}),this._zoomOut=new bu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,u,m){this._zoomIn.touchstart(r,u,m),this._zoomOut.touchstart(r,u,m)}touchmove(r,u,m){this._zoomIn.touchmove(r,u,m),this._zoomOut.touchmove(r,u,m)}touchend(r,u,m){const C=this._zoomIn.touchend(r,u,m),N=this._zoomOut.touchend(r,u,m);return C?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:ee=>ee.easeTo({duration:300,zoom:ee.getZoom()+1,around:ee.unproject(C)},{originalEvent:r})}):N?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:ee=>ee.easeTo({duration:300,zoom:ee.getZoom()-1,around:ee.unproject(N)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const gp={0:1,2:2};class pa{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(r,u){return!1}_move(r,u){return{}}mousedown(r,u){if(this._lastPoint)return;const m=g.mouseButton(r);this._correctButton(r,m)&&(this._lastPoint=u,this._eventButton=m)}mousemoveWindow(r,u){const m=this._lastPoint;if(m){if(r.preventDefault(),function(C,N){const ee=gp[N];return C.buttons===void 0||(C.buttons&ee)!==ee}(r,this._eventButton))this.reset();else if(this._moved||!(u.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(m,u)}}mouseupWindow(r){this._lastPoint&&g.mouseButton(r)===this._eventButton&&(this._moved&&g.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $o extends pa{mousedown(r,u){super.mousedown(r,u),this._lastPoint&&(this._active=!0)}_correctButton(r,u){return u===0&&!r.ctrlKey}_move(r,u){return{around:u,panDelta:u.sub(r)}}}class di extends pa{_correctButton(r,u){return u===0&&r.ctrlKey||u===2}_move(r,u){const m=.8*(u.x-r.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(r){r.preventDefault()}}class vu extends pa{_correctButton(r,u){return u===0&&r.ctrlKey||u===2}_move(r,u){const m=-.5*(u.y-r.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(r){r.preventDefault()}}class Ul{constructor(r,u){this._minTouches=r.cooperativeGestures?2:1,this._clickTolerance=r.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(r,u,m){return this._calculateTransform(r,u,m)}touchmove(r,u,m){if(this._map._cooperativeGestures&&(this._minTouches===2&&m.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(r,!1,m.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(m.length<this._minTouches))return r.preventDefault(),this._calculateTransform(r,u,m)}touchend(r,u,m){this._calculateTransform(r,u,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,u,m){m.length>0&&(this._active=!0);const C=da(m,u),N=new s.pointGeometry(0,0),ee=new s.pointGeometry(0,0);let le=0;for(const be in C){const Ae=C[be],ze=this._touches[be];ze&&(N._add(Ae),ee._add(Ae.sub(ze)),le++,C[be]=Ae)}if(this._touches=C,le<this._minTouches||!ee.mag())return;const de=ee.div(le);return this._sum._add(de),this._sum.mag()<this._clickTolerance?void 0:{around:N.div(le),panDelta:de}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fa{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(r){}_move(r,u,m){return{}}touchstart(r,u,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([u[0],u[1]]))}touchmove(r,u,m){if(!this._firstTwoTouches)return;r.preventDefault();const[C,N]=this._firstTwoTouches,ee=$l(m,u,C),le=$l(m,u,N);if(!ee||!le)return;const de=this._aroundCenter?null:ee.add(le).div(2);return this._move([ee,le],de,r)}touchend(r,u,m){if(!this._firstTwoTouches)return;const[C,N]=this._firstTwoTouches,ee=$l(m,u,C),le=$l(m,u,N);ee&&le||(this._active&&g.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function $l(T,r,u){for(let m=0;m<T.length;m++)if(T[m].identifier===u)return r[m]}function Qt(T,r){return Math.log(T/r)/Math.LN2}class _u extends fa{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,u){const m=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Qt(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qt(this._distance,m),pinchAround:u}}}function yp(T,r){return 180*T.angleWith(r)/Math.PI}class Lm extends fa{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,u){const m=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:yp(this._vector,m),pinchAround:u}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const u=25/(Math.PI*this._minDiameter)*360,m=yp(r,this._startVector);return Math.abs(m)<u}}function Gl(T){return Math.abs(T.y)>Math.abs(T.x)}class xp extends fa{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,u,m){super.touchstart(r,u,m),this._currentTouchCount=m.length}_start(r){this._lastPoints=r,Gl(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,u,m){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const C=r[0].sub(this._lastPoints[0]),N=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(C,N,m.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(C.y+N.y)/2*-.5}):void 0}gestureBeginsVertically(r,u,m){if(this._valid!==void 0)return this._valid;const C=r.mag()>=2,N=u.mag()>=2;if(!C&&!N)return;if(!C||!N)return this._firstMove===void 0&&(this._firstMove=m),m-this._firstMove<100&&void 0;const ee=r.y>0==u.y>0;return Gl(r)&&Gl(u)&&ee}}const bp={panStep:100,bearingStep:15,pitchStep:10};class Rm{constructor(){const r=bp;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let u=0,m=0,C=0,N=0,ee=0;switch(r.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:r.shiftKey?m=-1:(r.preventDefault(),N=-1);break;case 39:r.shiftKey?m=1:(r.preventDefault(),N=1);break;case 38:r.shiftKey?C=1:(r.preventDefault(),ee=-1);break;case 40:r.shiftKey?C=-1:(r.preventDefault(),ee=1);break;default:return}return this._rotationDisabled&&(m=0,C=0),{cameraAnimation:le=>{const de=le.getZoom();le.easeTo({duration:300,easeId:"keyboardHandler",easing:Om,zoom:u?Math.round(de)+u*(r.shiftKey?2:1):de,bearing:le.getBearing()+m*this._bearingStep,pitch:le.getPitch()+C*this._pitchStep,offset:[-N*this._panStep,-ee*this._panStep],center:le.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Om(T){return T*(2-T)}const Zc=4.000244140625;class wu{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;r.preventDefault()}let u=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const m=s.exported.now(),C=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,u!==0&&u%Zc==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(C*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),r.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=r,this._delta-=u,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=g.mousePos(this._el,r);this._around=s.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(u)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;if(this._delta!==0){const le=this._type==="wheel"&&Math.abs(this._delta)>Zc?this._wheelZoomRate:this._defaultZoomRate;let de=2/(1+Math.exp(-Math.abs(this._delta*le)));this._delta<0&&de!==0&&(de=1/de);const be=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(be*de))),this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom=="number"?this._targetZoom:r.zoom,m=this._startZoom,C=this._easing;let N,ee=!1;if(this._type==="wheel"&&m&&C){const le=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),de=C(le);N=s.number(m,u,de),le<1?this._frameId||(this._frameId=!0):ee=!0}else N=u,ee=!0;return this._active=!0,ee&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!ee,zoomDelta:N-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let u=s.ease;if(this._prevEase){const m=this._prevEase,C=(s.exported.now()-m.start)/m.duration,N=m.easing(C+.01)-m.easing(C),ee=.27/Math.sqrt(N*N+1e-4)*.01,le=Math.sqrt(.0729-ee*ee);u=s.bezier(ee,le,.25,1)}return this._prevEase={start:s.exported.now(),duration:r,easing:u},u}reset(){this._active=!1}}class Tu{constructor(r,u){this._clickZoom=r,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Eu{constructor(){this.reset()}reset(){this._active=!1}dblclick(r,u){return r.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(r.shiftKey?-1:1),around:m.unproject(u)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fs{constructor(){this._tap=new bu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(r,u,m){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=u[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(r,u,m))}touchmove(r,u,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const C=u[0],N=C.y-this._swipePoint.y;return this._swipePoint=C,r.preventDefault(),this._active=!0,{zoomDelta:N/128}}}else this._tap.touchmove(r,u,m)}touchend(r,u,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(r,u,m)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Go{constructor(r,u,m){this._el=r,this._mousePan=u,this._touchPan=m}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class vp{constructor(r,u,m){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=u,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Cu{constructor(r,u,m,C){this._el=r,this._touchZoom=u,this._touchRotate=m,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Wa=T=>T.zoom||T.drag||T.pitch||T.rotate;class Su extends s.Event{}function Kc(T){return T.panDelta&&T.panDelta.mag()||T.zoomDelta||T.bearingDelta||T.pitchDelta}class Vs{constructor(r,u){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new fp(r),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u),s.bindAll(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[C,N,ee]of this._listeners)g.addEventListener(C,N,C===document?this.handleWindowEvent:this.handleEvent,ee)}destroy(){for(const[r,u,m]of this._listeners)g.removeEventListener(r,u,r===document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(r){const u=this._map,m=u.getCanvasContainer();this._add("mapEvent",new Uo(u,r));const C=u.boxZoom=new ua(u,r);this._add("boxZoom",C);const N=new Dm,ee=new Eu;u.doubleClickZoom=new Tu(ee,N),this._add("tapZoom",N),this._add("clickZoom",ee);const le=new fs;this._add("tapDragZoom",le);const de=u.touchPitch=new xp(u);this._add("touchPitch",de);const be=new di(r),Ae=new vu(r);u.dragRotate=new vp(r,be,Ae),this._add("mouseRotate",be,["mousePitch"]),this._add("mousePitch",Ae,["mouseRotate"]);const ze=new $o(r),Ge=new Ul(r,u);u.dragPan=new Go(m,ze,Ge),this._add("mousePan",ze),this._add("touchPan",Ge,["touchZoom","touchRotate"]);const et=new Lm,Qe=new _u;u.touchZoomRotate=new Cu(m,Qe,et,le),this._add("touchRotate",et,["touchPan","touchZoom"]),this._add("touchZoom",Qe,["touchPan","touchRotate"]);const Je=u.scrollZoom=new wu(u,this);this._add("scrollZoom",Je,["mousePan"]);const dt=u.keyboard=new Rm;this._add("keyboard",dt),this._add("blockableMapEvent",new mp(u));for(const gt of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[gt]&&u[gt].enable(r[gt])}_add(r,u,m){this._handlers.push({handlerName:r,handler:u,allowed:m}),this._handlersById[r]=u}stop(r){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Wa(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,u,m){for(const C in r)if(C!==m&&(!u||u.indexOf(C)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const u=[];for(const m of r)this._el.contains(m.target)&&u.push(m);return u}handleEvent(r,u){if(r.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const m=r.type==="renderFrame"?void 0:r,C={needsRenderFrame:!1},N={},ee={},le=r.touches,de=le?this._getMapTouches(le):void 0,be=de?g.touchPos(this._el,de):g.mousePos(this._el,r);for(const{handlerName:Ge,handler:et,allowed:Qe}of this._handlers){if(!et.isEnabled())continue;let Je;this._blockedByActive(ee,Qe,Ge)?et.reset():et[u||r.type]&&(Je=et[u||r.type](r,be,de),this.mergeHandlerResult(C,N,Je,Ge,m),Je&&Je.needsRenderFrame&&this._triggerRenderFrame()),(Je||et.isActive())&&(ee[Ge]=et)}const Ae={};for(const Ge in this._previousActiveHandlers)ee[Ge]||(Ae[Ge]=m);this._previousActiveHandlers=ee,(Object.keys(Ae).length||Kc(C))&&(this._changes.push([C,N,Ae]),this._triggerRenderFrame()),(Object.keys(ee).length||Kc(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ze}=C;ze&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ze(this._map))}mergeHandlerResult(r,u,m,C,N){if(!m)return;s.extend(r,m);const ee={handlerName:C,originalEvent:m.originalEvent||N};m.zoomDelta!==void 0&&(u.zoom=ee),m.panDelta!==void 0&&(u.drag=ee),m.pitchDelta!==void 0&&(u.pitch=ee),m.bearingDelta!==void 0&&(u.rotate=ee)}_applyChanges(){const r={},u={},m={};for(const[C,N,ee]of this._changes)C.panDelta&&(r.panDelta=(r.panDelta||new s.pointGeometry(0,0))._add(C.panDelta)),C.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+C.pitchDelta),C.around!==void 0&&(r.around=C.around),C.pinchAround!==void 0&&(r.pinchAround=C.pinchAround),C.noInertia&&(r.noInertia=C.noInertia),s.extend(u,N),s.extend(m,ee);this._updateMapTransform(r,u,m),this._changes=[]}_updateMapTransform(r,u,m){const C=this._map,N=C.transform,ee=C.style&&C.style.terrain;if(!(Kc(r)||ee&&this._drag))return this._fireEvents(u,m,!0);let{panDelta:le,zoomDelta:de,bearingDelta:be,pitchDelta:Ae,around:ze,pinchAround:Ge}=r;Ge!==void 0&&(ze=Ge),C._stop(!0),ze=ze||C.transform.centerPoint;const et=N.pointLocation(le?ze.sub(le):ze);be&&(N.bearing+=be),Ae&&(N.pitch+=Ae),de&&(N.zoom+=de),ee?u.drag&&!this._drag?(this._drag={center:N.centerPoint,lngLat:N.pointLocation(ze),point:ze,handlerName:u.drag.handlerName},C.fire(new s.Event("freezeElevation",{freeze:!0}))):this._drag&&m[this._drag.handlerName]?(C.fire(new s.Event("freezeElevation",{freeze:!1})),this._drag=null):u.drag&&this._drag&&(N.center=N.pointLocation(N.centerPoint.sub(le))):N.setLocationAtPoint(et,ze),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(u,m,!0)}_fireEvents(r,u,m){const C=Wa(this._eventsInProgress),N=Wa(r),ee={};for(const Ae in r){const{originalEvent:ze}=r[Ae];this._eventsInProgress[Ae]||(ee[`${Ae}start`]=ze),this._eventsInProgress[Ae]=r[Ae]}!C&&N&&this._fireEvent("movestart",N.originalEvent);for(const Ae in ee)this._fireEvent(Ae,ee[Ae]);N&&this._fireEvent("move",N.originalEvent);for(const Ae in r){const{originalEvent:ze}=r[Ae];this._fireEvent(Ae,ze)}const le={};let de;for(const Ae in this._eventsInProgress){const{handlerName:ze,originalEvent:Ge}=this._eventsInProgress[Ae];this._handlersById[ze].isActive()||(delete this._eventsInProgress[Ae],de=u[ze]||Ge,le[`${Ae}end`]=de)}for(const Ae in le)this._fireEvent(Ae,le[Ae]);const be=Wa(this._eventsInProgress);if(m&&(C||N)&&!be){this._updatingCamera=!0;const Ae=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ze=Ge=>Ge!==0&&-this._bearingSnap<Ge&&Ge<this._bearingSnap;Ae?(ze(Ae.bearing||this._map.getBearing())&&(Ae.bearing=0),this._map.easeTo(Ae,{originalEvent:de})):(this._map.fire(new s.Event("moveend",{originalEvent:de})),ze(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,u){this._map.fire(new s.Event(r,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new Su("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const $r={extend:(T,...r)=>s.extend(T,...r),run(T){T()},logToElement(T,r=!1,u="log"){const m=window.document.getElementById(u);m&&(r&&(m.innerHTML=""),m.innerHTML+=`<br>${T}`)}};class Qc extends s.Evented{constructor(r,u){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=u.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,u){return this.jumpTo({center:r},u)}panBy(r,u,m){return r=s.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,s.extend({offset:r},u),m)}panTo(r,u,m){return this.easeTo(s.extend({center:r},u),m)}getZoom(){return this.transform.zoom}setZoom(r,u){return this.jumpTo({zoom:r},u),this}zoomTo(r,u,m){return this.easeTo(s.extend({zoom:r},u),m)}zoomIn(r,u){return this.zoomTo(this.getZoom()+1,r,u),this}zoomOut(r,u){return this.zoomTo(this.getZoom()-1,r,u),this}getBearing(){return this.transform.bearing}setBearing(r,u){return this.jumpTo({bearing:r},u),this}getPadding(){return this.transform.padding}setPadding(r,u){return this.jumpTo({padding:r},u),this}rotateTo(r,u,m){return this.easeTo(s.extend({bearing:r},u),m)}resetNorth(r,u){return this.rotateTo(0,s.extend({duration:1e3},r),u),this}resetNorthPitch(r,u){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},r),u),this}snapToNorth(r,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,u):this}getPitch(){return this.transform.pitch}setPitch(r,u){return this.jumpTo({pitch:r},u),this}cameraForBounds(r,u){r=s.LngLatBounds.convert(r);const m=u&&u.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),m,u)}_cameraForBoxAndBearing(r,u,m,C){const N={top:0,bottom:0,right:0,left:0};if(typeof(C=s.extend({padding:N,offset:[0,0],maxZoom:this.transform.maxZoom},C)).padding=="number"){const _t=C.padding;C.padding={top:_t,bottom:_t,right:_t,left:_t}}C.padding=s.extend(N,C.padding);const ee=this.transform,le=ee.padding,de=ee.project(s.LngLat.convert(r)),be=ee.project(s.LngLat.convert(u)),Ae=de.rotate(-m*Math.PI/180),ze=be.rotate(-m*Math.PI/180),Ge=new s.pointGeometry(Math.max(Ae.x,ze.x),Math.max(Ae.y,ze.y)),et=new s.pointGeometry(Math.min(Ae.x,ze.x),Math.min(Ae.y,ze.y)),Qe=Ge.sub(et),Je=(ee.width-(le.left+le.right+C.padding.left+C.padding.right))/Qe.x,dt=(ee.height-(le.top+le.bottom+C.padding.top+C.padding.bottom))/Qe.y;if(dt<0||Je<0)return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const gt=Math.min(ee.scaleZoom(ee.scale*Math.min(Je,dt)),C.maxZoom),vt=s.pointGeometry.convert(C.offset),nt=new s.pointGeometry((C.padding.left-C.padding.right)/2,(C.padding.top-C.padding.bottom)/2).rotate(m*Math.PI/180),kt=vt.add(nt).mult(ee.scale/ee.zoomScale(gt));return{center:ee.unproject(de.add(be).div(2).sub(kt)),zoom:gt,bearing:m}}fitBounds(r,u,m){return this._fitInternal(this.cameraForBounds(r,u),u,m)}fitScreenCoordinates(r,u,m,C,N){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(s.pointGeometry.convert(r)),this.transform.pointLocation(s.pointGeometry.convert(u)),m,C),C,N)}_fitInternal(r,u,m){return r?(delete(u=s.extend(r,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this}jumpTo(r,u){this.stop();const m=this.transform;let C=!1,N=!1,ee=!1;return"zoom"in r&&m.zoom!==+r.zoom&&(C=!0,m.zoom=+r.zoom),r.center!==void 0&&(m.center=s.LngLat.convert(r.center)),"bearing"in r&&m.bearing!==+r.bearing&&(N=!0,m.bearing=+r.bearing),"pitch"in r&&m.pitch!==+r.pitch&&(ee=!0,m.pitch=+r.pitch),r.padding==null||m.isPaddingEqual(r.padding)||(m.padding=r.padding),this.fire(new s.Event("movestart",u)).fire(new s.Event("move",u)),C&&this.fire(new s.Event("zoomstart",u)).fire(new s.Event("zoom",u)).fire(new s.Event("zoomend",u)),N&&this.fire(new s.Event("rotatestart",u)).fire(new s.Event("rotate",u)).fire(new s.Event("rotateend",u)),ee&&this.fire(new s.Event("pitchstart",u)).fire(new s.Event("pitch",u)).fire(new s.Event("pitchend",u)),this.fire(new s.Event("moveend",u))}calculateCameraOptionsFromTo(r,u,m,C=0){const N=s.MercatorCoordinate.fromLngLat(r,u),ee=s.MercatorCoordinate.fromLngLat(m,C),le=ee.x-N.x,de=ee.y-N.y,be=ee.z-N.z,Ae=Math.hypot(le,de,be);if(Ae===0)throw new Error("Can't calculate camera options with same From and To");const ze=Math.hypot(le,de),Ge=this.transform.scaleZoom(this.transform.cameraToCenterDistance/Ae/this.transform.tileSize),et=180*Math.atan2(le,-de)/Math.PI;let Qe=180*Math.acos(ze/Ae)/Math.PI;return Qe=be<0?90-Qe:90+Qe,{center:ee.toLngLat(),zoom:Ge,pitch:Qe,bearing:et}}easeTo(r,u){this._stop(!1,r.easeId),((r=s.extend({offset:[0,0],duration:500,easing:s.ease},r)).animate===!1||!r.essential&&s.exported.prefersReducedMotion)&&(r.duration=0);const m=this.transform,C=this.getZoom(),N=this.getBearing(),ee=this.getPitch(),le=this.getPadding(),de="zoom"in r?+r.zoom:C,be="bearing"in r?this._normalizeBearing(r.bearing,N):N,Ae="pitch"in r?+r.pitch:ee,ze="padding"in r?r.padding:m.padding,Ge=s.pointGeometry.convert(r.offset);let et=m.centerPoint.add(Ge);const Qe=m.pointLocation(et),Je=s.LngLat.convert(r.center||Qe);this._normalizeCenter(Je);const dt=m.project(Qe),gt=m.project(Je).sub(dt),vt=m.zoomScale(de-C);let nt,kt;r.around&&(nt=s.LngLat.convert(r.around),kt=m.locationPoint(nt));const _t={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||de!==C,this._rotating=this._rotating||N!==be,this._pitching=this._pitching||Ae!==ee,this._padding=!m.isPaddingEqual(ze),this._easeId=r.easeId,this._prepareEase(u,r.noMoveStart,_t),this._ease(Ot=>{if(this._zooming&&(m.zoom=s.number(C,de,Ot)),this._rotating&&(m.bearing=s.number(N,be,Ot)),this._pitching&&(m.pitch=s.number(ee,Ae,Ot)),this._padding&&(m.interpolatePadding(le,ze,Ot),et=m.centerPoint.add(Ge)),nt)m.setLocationAtPoint(nt,kt);else{const zt=m.zoomScale(m.zoom-C),Ut=de>C?Math.min(2,vt):Math.max(.5,vt),Dt=Math.pow(Ut,1-Ot),ni=m.unproject(dt.add(gt.mult(Ot*Dt)).mult(zt));m.setLocationAtPoint(m.renderWorldCopies?ni.wrap():ni,et)}this._fireMoveEvents(u)},Ot=>{this._afterEase(u,Ot)},r),this}_prepareEase(r,u,m={}){this._moving=!0,this.fire(new s.Event("freezeElevation",{freeze:!0})),u||m.moving||this.fire(new s.Event("movestart",r)),this._zooming&&!m.zooming&&this.fire(new s.Event("zoomstart",r)),this._rotating&&!m.rotating&&this.fire(new s.Event("rotatestart",r)),this._pitching&&!m.pitching&&this.fire(new s.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new s.Event("move",r)),this._zooming&&this.fire(new s.Event("zoom",r)),this._rotating&&this.fire(new s.Event("rotate",r)),this._pitching&&this.fire(new s.Event("pitch",r))}_afterEase(r,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId,this.fire(new s.Event("freezeElevation",{freeze:!1}));const m=this._zooming,C=this._rotating,N=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new s.Event("zoomend",r)),C&&this.fire(new s.Event("rotateend",r)),N&&this.fire(new s.Event("pitchend",r)),this.fire(new s.Event("moveend",r))}flyTo(r,u){if(!r.essential&&s.exported.prefersReducedMotion){const ki=s.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ki,u)}this.stop(),r=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},r);const m=this.transform,C=this.getZoom(),N=this.getBearing(),ee=this.getPitch(),le=this.getPadding(),de="zoom"in r?s.clamp(+r.zoom,m.minZoom,m.maxZoom):C,be="bearing"in r?this._normalizeBearing(r.bearing,N):N,Ae="pitch"in r?+r.pitch:ee,ze="padding"in r?r.padding:m.padding,Ge=m.zoomScale(de-C),et=s.pointGeometry.convert(r.offset);let Qe=m.centerPoint.add(et);const Je=m.pointLocation(Qe),dt=s.LngLat.convert(r.center||Je);this._normalizeCenter(dt);const gt=m.project(Je),vt=m.project(dt).sub(gt);let nt=r.curve;const kt=Math.max(m.width,m.height),_t=kt/Ge,Ot=vt.mag();if("minZoom"in r){const ki=s.clamp(Math.min(r.minZoom,C,de),m.minZoom,m.maxZoom),Cr=kt/m.zoomScale(ki-C);nt=Math.sqrt(Cr/Ot*2)}const zt=nt*nt;function Ut(ki){const Cr=(_t*_t-kt*kt+(ki?-1:1)*zt*zt*Ot*Ot)/(2*(ki?_t:kt)*zt*Ot);return Math.log(Math.sqrt(Cr*Cr+1)-Cr)}function Dt(ki){return(Math.exp(ki)-Math.exp(-ki))/2}function ni(ki){return(Math.exp(ki)+Math.exp(-ki))/2}const qt=Ut(0);let oi=function(ki){return ni(qt)/ni(qt+nt*ki)},Hi=function(ki){return kt*((ni(qt)*(Dt(Cr=qt+nt*ki)/ni(Cr))-Dt(qt))/zt)/Ot;var Cr},er=(Ut(1)-qt)/nt;if(Math.abs(Ot)<1e-6||!isFinite(er)){if(Math.abs(kt-_t)<1e-6)return this.easeTo(r,u);const ki=_t<kt?-1:1;er=Math.abs(Math.log(_t/kt))/nt,Hi=function(){return 0},oi=function(Cr){return Math.exp(ki*nt*Cr)}}return r.duration="duration"in r?+r.duration:1e3*er/("screenSpeed"in r?+r.screenSpeed/nt:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=N!==be,this._pitching=Ae!==ee,this._padding=!m.isPaddingEqual(ze),this._prepareEase(u,!1),this._ease(ki=>{const Cr=ki*er,Sr=1/oi(Cr);m.zoom=ki===1?de:C+m.scaleZoom(Sr),this._rotating&&(m.bearing=s.number(N,be,ki)),this._pitching&&(m.pitch=s.number(ee,Ae,ki)),this._padding&&(m.interpolatePadding(le,ze,ki),Qe=m.centerPoint.add(et));const lr=ki===1?dt:m.unproject(gt.add(vt.mult(Hi(Cr))).mult(Sr));m.setLocationAtPoint(m.renderWorldCopies?lr.wrap():lr,Qe),this._fireMoveEvents(u)},()=>this._afterEase(u),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,u)}if(!r){const m=this.handlers;m&&m.stop(!1)}return this}_ease(r,u,m){m.animate===!1||m.duration===0?(r(1),u()):(this._easeStart=s.exported.now(),this._easeOptions=m,this._onEaseFrame=r,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,u){r=s.wrap(r,-180,180);const m=Math.abs(r-u);return Math.abs(r-360-u)<m&&(r-=360),Math.abs(r+360-u)<m&&(r+=360),r}_normalizeCenter(r){const u=this.transform;if(!u.renderWorldCopies||u.lngRange)return;const m=r.lng-u.center.lng;r.lng+=m>180?-360:m<-180?360:0}}class Jc{constructor(r={}){this.options=r,s.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options&&this.options.compact,this._container=g.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=g.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=g.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){g.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,u){const m=this._map._getUIString(`AttributionControl.${u}`);r.title=m,r.setAttribute("aria-label",m)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(C=>typeof C!="string"?"":C)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}const u=this._map.style.sourceCaches;for(const C in u){const N=u[C];if(N.used||N.usedForTerrain){const ee=N.getSource();ee.attribution&&r.indexOf(ee.attribution)<0&&r.push(ee.attribution)}}r=r.filter(C=>String(C).trim()),r.sort((C,N)=>C.length-N.length),r=r.filter((C,N)=>{for(let ee=N+1;ee<r.length;ee++)if(r[ee].indexOf(C)>=0)return!1;return!0});const m=r.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,r.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class ku{constructor(r={}){this.options=r,s.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=g.create("div","maplibregl-ctrl mapboxgl-ctrl");const u=g.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){g.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const r=this._container.children;if(r.length){const u=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact","mapboxgl-compact"):u.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class _p{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const u=++this._id;return this._queue.push({callback:r,id:u,cancelled:!1}),u}remove(r){const u=this._currentlyRunning,m=u?this._queue.concat(u):this._queue;for(const C of m)if(C.id===r)return void(C.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const m of u)if(!m.cancelled&&(m.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const wp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},zm={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},go={showCompass:!0,showZoom:!0,visualizePitch:!1};class eh{constructor(r,u,m=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new di({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,m&&(this.mousePitch=new vu({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),g.addEventListener(u,"mousedown",this.mousedown),g.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),g.addEventListener(u,"touchmove",this.touchmove),g.addEventListener(u,"touchend",this.touchend),g.addEventListener(u,"touchcancel",this.reset)}down(r,u){this.mouseRotate.mousedown(r,u),this.mousePitch&&this.mousePitch.mousedown(r,u),g.disableDrag()}move(r,u){const m=this.map,C=this.mouseRotate.mousemoveWindow(r,u);if(C&&C.bearingDelta&&m.setBearing(m.getBearing()+C.bearingDelta),this.mousePitch){const N=this.mousePitch.mousemoveWindow(r,u);N&&N.pitchDelta&&m.setPitch(m.getPitch()+N.pitchDelta)}}off(){const r=this.element;g.removeEventListener(r,"mousedown",this.mousedown),g.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),g.removeEventListener(r,"touchmove",this.touchmove),g.removeEventListener(r,"touchend",this.touchend),g.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){g.enableDrag(),g.removeEventListener(window,"mousemove",this.mousemove),g.removeEventListener(window,"mouseup",this.mouseup)}mousedown(r){this.down(s.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),g.mousePos(this.element,r)),g.addEventListener(window,"mousemove",this.mousemove),g.addEventListener(window,"mouseup",this.mouseup)}mousemove(r){this.move(r,g.mousePos(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=g.touchPos(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=g.touchPos(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function wi(T,r,u){if(T=new s.LngLat(T.lng,T.lat),r){const m=new s.LngLat(T.lng-360,T.lat),C=new s.LngLat(T.lng+360,T.lat),N=u.locationPoint(T).distSqr(r);u.locationPoint(m).distSqr(r)<N?T=m:u.locationPoint(C).distSqr(r)<N&&(T=C)}for(;Math.abs(T.lng-u.center.lng)>180;){const m=u.locationPoint(T);if(m.x>=0&&m.y>=0&&m.x<=u.width&&m.y<=u.height)break;T.lng>u.center.lng?T.lng-=360:T.lng+=360}return T}const Mi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Vl(T,r,u){const m=T.classList;for(const C in Mi)m.remove(`maplibregl-${u}-anchor-${C}`,`mapboxgl-${u}-anchor-${C}`);m.add(`maplibregl-${u}-anchor-${r}`,`mapboxgl-${u}-anchor-${r}`)}class Hl extends s.Evented{constructor(r,u){if(super(),(r instanceof HTMLElement||u)&&(r=s.extend({element:r},u)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=s.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=g.create("div"),this._element.setAttribute("aria-label","Map marker");const m=g.createNS("http://www.w3.org/2000/svg","svg"),C=41,N=27;m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height",`${C}px`),m.setAttributeNS(null,"width",`${N}px`),m.setAttributeNS(null,"viewBox",`0 0 ${N} ${C}`);const ee=g.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"stroke","none"),ee.setAttributeNS(null,"stroke-width","1"),ee.setAttributeNS(null,"fill","none"),ee.setAttributeNS(null,"fill-rule","evenodd");const le=g.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"fill-rule","nonzero");const de=g.createNS("http://www.w3.org/2000/svg","g");de.setAttributeNS(null,"transform","translate(3.0, 29.0)"),de.setAttributeNS(null,"fill","#000000");const be=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const vt of be){const nt=g.createNS("http://www.w3.org/2000/svg","ellipse");nt.setAttributeNS(null,"opacity","0.04"),nt.setAttributeNS(null,"cx","10.5"),nt.setAttributeNS(null,"cy","5.80029008"),nt.setAttributeNS(null,"rx",vt.rx),nt.setAttributeNS(null,"ry",vt.ry),de.appendChild(nt)}const Ae=g.createNS("http://www.w3.org/2000/svg","g");Ae.setAttributeNS(null,"fill",this._color);const ze=g.createNS("http://www.w3.org/2000/svg","path");ze.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Ae.appendChild(ze);const Ge=g.createNS("http://www.w3.org/2000/svg","g");Ge.setAttributeNS(null,"opacity","0.25"),Ge.setAttributeNS(null,"fill","#000000");const et=g.createNS("http://www.w3.org/2000/svg","path");et.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ge.appendChild(et);const Qe=g.createNS("http://www.w3.org/2000/svg","g");Qe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Qe.setAttributeNS(null,"fill","#FFFFFF");const Je=g.createNS("http://www.w3.org/2000/svg","g");Je.setAttributeNS(null,"transform","translate(8.0, 8.0)");const dt=g.createNS("http://www.w3.org/2000/svg","circle");dt.setAttributeNS(null,"fill","#000000"),dt.setAttributeNS(null,"opacity","0.25"),dt.setAttributeNS(null,"cx","5.5"),dt.setAttributeNS(null,"cy","5.5"),dt.setAttributeNS(null,"r","5.4999962");const gt=g.createNS("http://www.w3.org/2000/svg","circle");gt.setAttributeNS(null,"fill","#FFFFFF"),gt.setAttributeNS(null,"cx","5.5"),gt.setAttributeNS(null,"cy","5.5"),gt.setAttributeNS(null,"r","5.4999962"),Je.appendChild(dt),Je.appendChild(gt),le.appendChild(de),le.appendChild(Ae),le.appendChild(Ge),le.appendChild(Qe),le.appendChild(Je),m.appendChild(le),m.setAttributeNS(null,"height",C*this._scale+"px"),m.setAttributeNS(null,"width",N*this._scale+"px"),this._element.appendChild(m),this._offset=s.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",m=>{m.preventDefault()}),this._element.addEventListener("mousedown",m=>{m.preventDefault()}),Vl(this._element,this._anchor,"marker"),this._popup=null}addTo(r){return this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),g.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=s.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const C=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(38.1-13.5+C)],"bottom-right":[-C,-1*(38.1-13.5+C)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(r){const u=r.code,m=r.charCode||r.keyCode;u!=="Space"&&u!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(r){const u=r.originalEvent.target,m=this._element;this._popup&&(u===m||m.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?r.remove():r.addTo(this._map),this):this}_update(r){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=wi(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(u=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let m="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?m="rotateX(0deg)":this._pitchAlignment==="map"&&(m=`rotateX(${this._map.getPitch()}deg)`),r&&r.type!=="moveend"||(this._pos=this._pos.round()),g.setTransform(this._element,`${Mi[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${m} ${u}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const C=this._map.unproject(this._pos),N=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=C.distanceTo(this._lngLat)>20*N?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(r){return this._offset=s.pointGeometry.convert(r),this._update(),this}_onMove(r){if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(r){this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Mu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let wn,ma=0,ms=!1;const Nm={maxWidth:100,unit:"metric"};function Wl(T,r,u){const m=u&&u.maxWidth||100,C=T._container.clientHeight/2,N=T.unproject([0,C]),ee=T.unproject([m,C]),le=N.distanceTo(ee);if(u&&u.unit==="imperial"){const de=3.2808*le;de>5280?jr(r,m,de/5280,T._getUIString("ScaleControl.Miles")):jr(r,m,de,T._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?jr(r,m,le/1852,T._getUIString("ScaleControl.NauticalMiles")):le>=1e3?jr(r,m,le/1e3,T._getUIString("ScaleControl.Kilometers")):jr(r,m,le,T._getUIString("ScaleControl.Meters"))}function jr(T,r,u,m){const C=function(N){const ee=Math.pow(10,`${Math.floor(N)}`.length-1);let le=N/ee;return le=le>=10?10:le>=5?5:le>=3?3:le>=2?2:le>=1?1:function(de){const be=Math.pow(10,Math.ceil(-Math.log(de)/Math.LN10));return Math.round(de*be)/be}(le),ee*le}(u);T.style.width=r*(C/u)+"px",T.innerHTML=`${C}&nbsp;${m}`}const gn={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Tp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ya(T){if(T){if(typeof T=="number"){const r=Math.round(Math.sqrt(.5*Math.pow(T,2)));return{center:new s.pointGeometry(0,0),top:new s.pointGeometry(0,T),"top-left":new s.pointGeometry(r,r),"top-right":new s.pointGeometry(-r,r),bottom:new s.pointGeometry(0,-T),"bottom-left":new s.pointGeometry(r,-r),"bottom-right":new s.pointGeometry(-r,-r),left:new s.pointGeometry(T,0),right:new s.pointGeometry(-T,0)}}if(T instanceof s.pointGeometry||Array.isArray(T)){const r=s.pointGeometry.convert(T);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:s.pointGeometry.convert(T.center||[0,0]),top:s.pointGeometry.convert(T.top||[0,0]),"top-left":s.pointGeometry.convert(T["top-left"]||[0,0]),"top-right":s.pointGeometry.convert(T["top-right"]||[0,0]),bottom:s.pointGeometry.convert(T.bottom||[0,0]),"bottom-left":s.pointGeometry.convert(T["bottom-left"]||[0,0]),"bottom-right":s.pointGeometry.convert(T["bottom-right"]||[0,0]),left:s.pointGeometry.convert(T.left||[0,0]),right:s.pointGeometry.convert(T.right||[0,0])}}return Ya(new s.pointGeometry(0,0))}const Yl={supported:f,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends Qc{constructor(T){var r;if(s.PerformanceUtils.mark(s.PerformanceMarkers.create),(T=s.extend({},zm,T)).minZoom!=null&&T.maxZoom!=null&&T.minZoom>T.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(T.minPitch!=null&&T.maxPitch!=null&&T.minPitch>T.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(T.minPitch!=null&&T.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(T.maxPitch!=null&&T.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Xc(T.minZoom,T.maxZoom,T.minPitch,T.maxPitch,T.renderWorldCopies),{bearingSnap:T.bearingSnap}),this._interactive=T.interactive,this._cooperativeGestures=T.cooperativeGestures,this._maxTileCacheSize=T.maxTileCacheSize,this._failIfMajorPerformanceCaveat=T.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=T.preserveDrawingBuffer,this._antialias=T.antialias,this._trackResize=T.trackResize,this._bearingSnap=T.bearingSnap,this._refreshExpiredTiles=T.refreshExpiredTiles,this._fadeDuration=T.fadeDuration,this._crossSourceCollisions=T.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=T.collectResourceTiming,this._renderTaskQueue=new _p,this._controls=[],this._mapId=s.uniqueId(),this._locale=s.extend({},wp,T.locale),this._clickTolerance=T.clickTolerance,this._pixelRatio=(r=T.pixelRatio)!==null&&r!==void 0?r:devicePixelRatio,this._requestManager=new P(T.transformRequest),typeof T.container=="string"){if(this._container=document.getElementById(T.container),!this._container)throw new Error(`Container '${T.container}' not found.`)}else{if(!(T.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=T.container}if(T.maxBounds&&this.setMaxBounds(T.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Vs(this,T),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=T.hash&&new hp(typeof T.hash=="string"&&T.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:T.center,zoom:T.zoom,bearing:T.bearing,pitch:T.pitch}),T.bounds&&(this.resize(),this.fitBounds(T.bounds,s.extend({},T.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=T.localIdeographFontFamily,T.style&&this.setStyle(T.style,{localIdeographFontFamily:T.localIdeographFontFamily}),T.attributionControl&&this.addControl(new Jc({customAttribution:T.customAttribution})),T.maplibreLogo&&this.addControl(new ku,T.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new s.Event(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new s.Event(`${u.dataType}dataloading`,u))}),this.on("dataabort",u=>{this.fire(new s.Event("sourcedataabort",u))})}_getMapId(){return this._mapId}addControl(T,r){if(r===void 0&&(r=T.getDefaultPosition?T.getDefaultPosition():"top-right"),!T||!T.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=T.onAdd(this);this._controls.push(T);const m=this._controlPositions[r];return r.indexOf("bottom")!==-1?m.insertBefore(u,m.firstChild):m.appendChild(u),this}removeControl(T){if(!T||!T.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(T);return r>-1&&this._controls.splice(r,1),T.onRemove(this),this}hasControl(T){return this._controls.indexOf(T)>-1}calculateCameraOptionsFromTo(T,r,u,m){return m==null&&this.style.terrain&&(m=this.transform.getElevation(u,this.style.terrain)),super.calculateCameraOptionsFromTo(T,r,u,m)}resize(T){const r=this._containerDimensions(),u=r[0],m=r[1];this._resizeCanvas(u,m,this.getPixelRatio()),this.transform.resize(u,m),this.painter.resize(u,m,this.getPixelRatio());const C=!this._moving;return C&&(this.stop(),this.fire(new s.Event("movestart",T)).fire(new s.Event("move",T))),this.fire(new s.Event("resize",T)),C&&this.fire(new s.Event("moveend",T)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(T){const[r,u]=this._containerDimensions();this._pixelRatio=T,this._resizeCanvas(r,u,T),this.painter.resize(r,u,T)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(T){return this.transform.setMaxBounds(s.LngLatBounds.convert(T)),this._update()}setMinZoom(T){if((T=T??-2)>=-2&&T<=this.transform.maxZoom)return this.transform.minZoom=T,this._update(),this.getZoom()<T&&this.setZoom(T),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(T){if((T=T??22)>=this.transform.minZoom)return this.transform.maxZoom=T,this._update(),this.getZoom()>T&&this.setZoom(T),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(T){if((T=T??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(T>=0&&T<=this.transform.maxPitch)return this.transform.minPitch=T,this._update(),this.getPitch()<T&&this.setPitch(T),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(T){if((T=T??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(T>=this.transform.minPitch)return this.transform.maxPitch=T,this._update(),this.getPitch()>T&&this.setPitch(T),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(T){return this.transform.renderWorldCopies=T,this._update()}project(T){return this.transform.locationPoint(s.LngLat.convert(T),this.style&&this.style.terrain)}unproject(T){return this.transform.pointLocation(s.pointGeometry.convert(T),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(T,r,u){if(T==="mouseenter"||T==="mouseover"){let m=!1;return{layer:r,listener:u,delegates:{mousemove:N=>{const ee=this.getLayer(r)?this.queryRenderedFeatures(N.point,{layers:[r]}):[];ee.length?m||(m=!0,u.call(this,new Cs(T,this,N.originalEvent,{features:ee}))):m=!1},mouseout:()=>{m=!1}}}}if(T==="mouseleave"||T==="mouseout"){let m=!1;return{layer:r,listener:u,delegates:{mousemove:ee=>{(this.getLayer(r)?this.queryRenderedFeatures(ee.point,{layers:[r]}):[]).length?m=!0:m&&(m=!1,u.call(this,new Cs(T,this,ee.originalEvent)))},mouseout:ee=>{m&&(m=!1,u.call(this,new Cs(T,this,ee.originalEvent)))}}}}{const m=C=>{const N=this.getLayer(r)?this.queryRenderedFeatures(C.point,{layers:[r]}):[];N.length&&(C.features=N,u.call(this,C),delete C.features)};return{layer:r,listener:u,delegates:{[T]:m}}}}on(T,r,u){if(u===void 0)return super.on(T,r);const m=this._createDelegatedListener(T,r,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[T]=this._delegatedListeners[T]||[],this._delegatedListeners[T].push(m);for(const C in m.delegates)this.on(C,m.delegates[C]);return this}once(T,r,u){if(u===void 0)return super.once(T,r);const m=this._createDelegatedListener(T,r,u);for(const C in m.delegates)this.once(C,m.delegates[C]);return this}off(T,r,u){return u===void 0?super.off(T,r):(this._delegatedListeners&&this._delegatedListeners[T]&&(m=>{const C=this._delegatedListeners[T];for(let N=0;N<C.length;N++){const ee=C[N];if(ee.layer===r&&ee.listener===u){for(const le in ee.delegates)this.off(le,ee.delegates[le]);return C.splice(N,1),this}}})(),this)}queryRenderedFeatures(T,r){if(!this.style)return[];let u;if(r!==void 0||T===void 0||T instanceof s.pointGeometry||Array.isArray(T)||(r=T,T=void 0),r=r||{},(T=T||[[0,0],[this.transform.width,this.transform.height]])instanceof s.pointGeometry||typeof T[0]=="number")u=[s.pointGeometry.convert(T)];else{const m=s.pointGeometry.convert(T[0]),C=s.pointGeometry.convert(T[1]);u=[m,new s.pointGeometry(C.x,m.y),C,new s.pointGeometry(m.x,C.y),m]}return this.style.queryRenderedFeatures(u,r,this.transform)}querySourceFeatures(T,r){return this.style.querySourceFeatures(T,r)}setStyle(T,r){return(r=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&T?(this._diffStyle(T,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(T,r))}setTransformRequest(T){return this._requestManager.setTransformRequest(T),this}_getUIString(T){const r=this._locale[T];if(r==null)throw new Error(`Missing UI string '${T}'`);return r}_updateStyle(T,r){return this.style&&(this.style.setEventedParent(null),this.style._remove()),T?(this.style=new _n(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof T=="string"?this.style.loadURL(T):this.style.loadJSON(T),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new _n(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(T,r){if(typeof T=="string"){const u=this._requestManager.transformRequest(T,s.ResourceType.Style);s.getJSON(u,(m,C)=>{m?this.fire(new s.ErrorEvent(m)):C&&this._updateDiff(C,r)})}else typeof T=="object"&&this._updateDiff(T,r)}_updateDiff(T,r){try{this.style.setState(T)&&this._update(!0)}catch(u){s.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(T,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.warnOnce("There is no style added to the map.")}addSource(T,r){return this._lazyInitEmptyStyle(),this.style.addSource(T,r),this._update(!0)}isSourceLoaded(T){const r=this.style&&this.style.sourceCaches[T];if(r!==void 0)return r.loaded();this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${T}'`)))}setTerrain(T){return this.style.setTerrain(T),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const T=this.style&&this.style.sourceCaches;for(const r in T){const u=T[r]._tiles;for(const m in u){const C=u[m];if(C.state!=="loaded"&&C.state!=="errored")return!1}}return!0}addSourceType(T,r,u){return this._lazyInitEmptyStyle(),this.style.addSourceType(T,r,u)}removeSource(T){return this.style.removeSource(T),this._update(!0)}getSource(T){return this.style.getSource(T)}addImage(T,r,{pixelRatio:u=1,sdf:m=!1,stretchX:C,stretchY:N,content:ee}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||s.isImageBitmap(r)){const{width:le,height:de,data:be}=s.exported.getImageData(r);this.style.addImage(T,{data:new s.RGBAImage({width:le,height:de},be),pixelRatio:u,stretchX:C,stretchY:N,content:ee,sdf:m,version:0})}else{if(r.width===void 0||r.height===void 0)return this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:le,height:de,data:be}=r,Ae=r;this.style.addImage(T,{data:new s.RGBAImage({width:le,height:de},new Uint8Array(be)),pixelRatio:u,stretchX:C,stretchY:N,content:ee,sdf:m,version:0,userImage:Ae}),Ae.onAdd&&Ae.onAdd(this,T)}}}updateImage(T,r){const u=this.style.getImage(T);if(!u)return this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=r instanceof HTMLImageElement||s.isImageBitmap(r)?s.exported.getImageData(r):r,{width:C,height:N,data:ee}=m;if(C===void 0||N===void 0)return this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(C!==u.data.width||N!==u.data.height)return this.fire(new s.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const le=!(r instanceof HTMLImageElement||s.isImageBitmap(r));u.data.replace(ee,le),this.style.updateImage(T,u)}hasImage(T){return T?!!this.style.getImage(T):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(T){this.style.removeImage(T)}loadImage(T,r){s.getImage(this._requestManager.transformRequest(T,s.ResourceType.Image),r)}listImages(){return this.style.listImages()}addLayer(T,r){return this._lazyInitEmptyStyle(),this.style.addLayer(T,r),this._update(!0)}moveLayer(T,r){return this.style.moveLayer(T,r),this._update(!0)}removeLayer(T){return this.style.removeLayer(T),this._update(!0)}getLayer(T){return this.style.getLayer(T)}setLayerZoomRange(T,r,u){return this.style.setLayerZoomRange(T,r,u),this._update(!0)}setFilter(T,r,u={}){return this.style.setFilter(T,r,u),this._update(!0)}getFilter(T){return this.style.getFilter(T)}setPaintProperty(T,r,u,m={}){return this.style.setPaintProperty(T,r,u,m),this._update(!0)}getPaintProperty(T,r){return this.style.getPaintProperty(T,r)}setLayoutProperty(T,r,u,m={}){return this.style.setLayoutProperty(T,r,u,m),this._update(!0)}getLayoutProperty(T,r){return this.style.getLayoutProperty(T,r)}setLight(T,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(T,r),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(T,r){return this.style.setFeatureState(T,r),this._update()}removeFeatureState(T,r){return this.style.removeFeatureState(T,r),this._update()}getFeatureState(T){return this.style.getFeatureState(T)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let T=0,r=0;return this._container&&(T=this._container.clientWidth||400,r=this._container.clientHeight||300),[T,r]}_setupContainer(){const T=this._container;T.classList.add("maplibregl-map","mapboxgl-map");const r=this._canvasContainer=g.create("div","maplibregl-canvas-container mapboxgl-canvas-container",T);this._interactive&&r.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=g.create("canvas","maplibregl-canvas mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const u=this._containerDimensions();this._resizeCanvas(u[0],u[1],this.getPixelRatio());const m=this._controlContainer=g.create("div","maplibregl-control-container mapboxgl-control-container",T),C=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(N=>{C[N]=g.create("div",`maplibregl-ctrl-${N} mapboxgl-ctrl-${N}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const T=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=g.create("div","maplibregl-cooperative-gesture-screen",T);let r="Control",u=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(u=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map",r="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${u}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",m=>{m.key===r&&(this._metaPress=!0)}),document.addEventListener("keyup",m=>{m.key===r&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",m=>{this._onCooperativeGesture(m,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(T,r,u){this._canvas.width=u*T,this._canvas.height=u*r,this._canvas.style.width=`${T}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const T=s.extend({},f.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",T)||this._canvas.getContext("experimental-webgl",T);r?(this.painter=new cp(r,this.transform),s.exported$1.testSupport(r)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(T){T.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:T}))}_contextRestored(T){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:T}))}_onMapScroll(T){if(T.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(T,r,u){return!r&&u<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(T){return this.style?(this._styleDirty=this._styleDirty||T,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(T){return this._update(),this._renderTaskQueue.add(T)}_cancelRenderFrame(T){this._renderTaskQueue.remove(T)}_render(T){let r,u=0;const m=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(r=m.createQueryEXT(),m.beginQueryEXT(m.TIME_ELAPSED_EXT,r),u=s.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(T),this._removed)return;let C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const ee=this.transform.zoom,le=s.exported.now();this.style.zoomHistory.update(ee,le);const de=new s.EvaluationParameters(ee,{now:le,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),be=de.crossFadingFactor();be===1&&be===this._crossFadingFactor||(C=!0,this._crossFadingFactor=be),this.style.update(de)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.PerformanceUtils.mark(s.PerformanceMarkers.load),this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const ee=s.exported.now()-u;m.endQueryEXT(m.TIME_ELAPSED_EXT,r),setTimeout(()=>{const le=m.getQueryObjectEXT(r,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(r),this.fire(new s.Event("gpu-timing-frame",{cpuTime:ee,gpuTime:le}))},50)}if(this.listens("gpu-timing-layer")){const ee=this.painter.collectGpuTimers();setTimeout(()=>{const le=this.painter.queryGpuTimers(ee);this.fire(new s.Event("gpu-timing-layer",{layerTimes:le}))},50)}const N=this._sourcesDirty||this._styleDirty||this._placementDirty;return N||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.Event("idle")),!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,s.PerformanceUtils.mark(s.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const T=this.painter.context.gl.getExtension("WEBGL_lose_context");T&&T.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),g.remove(this._canvasContainer),g.remove(this._controlContainer),this._cooperativeGestures&&g.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),s.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=s.exported.frame(T=>{s.PerformanceUtils.frame(T),this._frame=null,this._render(T)}))}_onWindowOnline(){this._update()}_onWindowResize(T){this._trackResize&&this.resize({originalEvent:T})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(T){this._showTileBoundaries!==T&&(this._showTileBoundaries=T,this._update())}get showPadding(){return!!this._showPadding}set showPadding(T){this._showPadding!==T&&(this._showPadding=T,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(T){this._showCollisionBoxes!==T&&(this._showCollisionBoxes=T,T?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(T){this._showOverdrawInspector!==T&&(this._showOverdrawInspector=T,this._update())}get repaint(){return!!this._repaint}set repaint(T){this._repaint!==T&&(this._repaint=T,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(T){this._vertices=T,this._update()}_setCacheLimits(T,r){s.setCacheLimits(T,r)}get version(){return"2.4.0"}},NavigationControl:class{constructor(T){this.options=s.extend({},go,T),this._container=g.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),g.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),g.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=g.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const T=this._map.getZoom(),r=T===this._map.getMaxZoom(),u=T===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())}_rotateCompassArrow(){const T=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=T}onAdd(T){return this._map=T,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new eh(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){g.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(T,r){const u=g.create("button",T,this._container);return u.type="button",u.addEventListener("click",r),u}_setButtonTitle(T,r){const u=this._map._getUIString(`NavigationControl.${r}`);T.title=u,T.setAttribute("aria-label",u)}},GeolocateControl:class extends s.Evented{constructor(T){super(),this.options=s.extend({},Mu,T),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(T){var r;return this._map=T,this._container=g.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,wn!==void 0?r(wn):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(u=>{wn=u.state!=="denied",r(wn)}):(wn=!!window.navigator.geolocation,r(wn)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),g.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ma=0,ms=!1}_isOutOfMapMaxBounds(T){const r=this._map.getMaxBounds(),u=T.coords;return r&&(u.longitude<r.getWest()||u.longitude>r.getEast()||u.latitude<r.getSouth()||u.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(T){if(this._map){if(this._isOutOfMapMaxBounds(T))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",T)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=T,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(T),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(T),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",T)),this._finish()}}_updateCamera(T){const r=new s.LngLat(T.coords.longitude,T.coords.latitude),u=T.coords.accuracy,m=this._map.getBearing(),C=s.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(u),C,{geolocateSource:!0})}_updateMarker(T){if(T){const r=new s.LngLat(T.coords.longitude,T.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=T.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const T=this._map._container.clientHeight/2,r=this._map.unproject([0,T]),u=this._map.unproject([1,T]),m=r.distanceTo(u),C=Math.ceil(2*this._accuracy/m);this._circleElement.style.width=`${C}px`,this._circleElement.style.height=`${C}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(T){if(this._map){if(this.options.trackUserLocation)if(T.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(T.code===3&&ms)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",T)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(T){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=g.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),g.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",T===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=g.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Hl(this._dotElement),this._circleElement=g.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Hl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ma--,ms=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let T;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ma++,ma>1?(T={maximumAge:6e5,timeout:0},ms=!0):(T=this.options.positionOptions,ms=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,T)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Jc,LogoControl:ku,ScaleControl:class{constructor(T){this.options=s.extend({},Nm,T),s.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Wl(this._map,this._container,this.options)}onAdd(T){return this._map=T,this._container=g.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",T.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){g.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(T){this.options.unit=T,Wl(this._map,this._container,this.options)}},FullscreenControl:class{constructor(T){this._fullscreen=!1,T&&T.container&&(T.container instanceof HTMLElement?this._container=T.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(T){return this._map=T,this._container||(this._container=this._map.getContainer()),this._controlContainer=g.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){g.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const T=this._fullscreenButton=g.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);g.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",T).setAttribute("aria-hidden","true"),T.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const T=this._getTitle();this._fullscreenButton.setAttribute("aria-label",T),this._fullscreenButton.title=T}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(T){this.options=T,s.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(T){return this._map=T,this._container=g.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=g.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),g.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){g.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends s.Evented{constructor(T){super(),this.options=s.extend(Object.create(gn),T),s.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(T){return this._map&&this.remove(),this._map=T,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&g.remove(this._content),this._container&&(g.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(T){return this._lngLat=s.LngLat.convert(T),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(T){return this.setDOMContent(document.createTextNode(T))}setHTML(T){const r=document.createDocumentFragment(),u=document.createElement("body");let m;for(u.innerHTML=T;m=u.firstChild,m;)r.appendChild(m);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(T){return this.options.maxWidth=T,this._update(),this}setDOMContent(T){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=g.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(T),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(T){this._container&&this._container.classList.add(T)}removeClassName(T){this._container&&this._container.classList.remove(T)}setOffset(T){return this.options.offset=T,this._update(),this}toggleClassName(T){if(this._container)return this._container.classList.toggle(T)}_createCloseButton(){this.options.closeButton&&(this._closeButton=g.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(T){this._update(T.point)}_onMouseMove(T){this._update(T.point)}_onDrag(T){this._update(T.point)}_update(T){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=g.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=g.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(N=>this._container.classList.add(N)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=wi(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!T))return;const r=this._pos=this._trackPointer&&T?T:this._map.project(this._lngLat);let u=this.options.anchor;const m=Ya(this.options.offset);if(!u){const N=this._container.offsetWidth,ee=this._container.offsetHeight;let le;le=r.y+m.bottom.y<ee?["top"]:r.y>this._map.transform.height-ee?["bottom"]:[],r.x<N/2?le.push("left"):r.x>this._map.transform.width-N/2&&le.push("right"),u=le.length===0?"bottom":le.join("-")}const C=r.add(m[u]).round();g.setTransform(this._container,`${Mi[u]} translate(${C.x}px,${C.y}px)`),Vl(this._container,u,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const T=this._container.querySelector(Tp);T&&T.focus()}_onClose(){this.remove()}},Marker:Hl,Style:_n,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,Evented:s.Evented,AJAXError:s.AJAXError,config:s.config,CanvasSource:ne,GeoJSONSource:U,ImageSource:H,RasterDEMTileSource:G,RasterTileSource:R,VectorTileSource:$,VideoSource:W,prewarm:function(){xe().acquire(J)},clearPrewarmedResources:function(){const T=pe;T&&(T.isPreloaded()&&T.numActive()===1?(T.release(J),pe=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return re.workerCount},set workerCount(T){re.workerCount=T},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(T){s.config.MAX_PARALLEL_IMAGE_REQUESTS=T},clearStorage(T){s.clearTileCache(T)},workerUrl:"",addProtocol(T,r){s.config.REGISTERED_PROTOCOLS[T]=r},removeProtocol(T){delete s.config.REGISTERED_PROTOCOLS[T]}};return $r.extend(Yl,{isSafari:s.isSafari,getPerformanceMetrics:s.PerformanceUtils.getPerformanceMetrics}),Yl});var d=a;return d})})(wO);var CT={exports:{}};class TO{constructor(e=[],t=EO){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:c}=this,a=t[e];for(;e>0;){const h=e-1>>1,d=t[h];if(c(a,d)>=0)break;t[e]=d,e=h}t[e]=a}_down(e){const{data:t,compare:c}=this,a=this.length>>1,h=t[e];for(;e<a;){let d=(e<<1)+1,s=t[d];const f=d+1;if(f<this.length&&c(t[f],s)<0&&(d=f,s=t[f]),c(s,h)>=0)break;t[e]=s,e=d}t[e]=h}}function EO(n,e){return n<e?-1:n>e?1:0}const CO=Object.freeze(Object.defineProperty({__proto__:null,default:TO},Symbol.toStringTag,{value:"Module"})),SO=R2(CO);var mf=SO;mf.default&&(mf=mf.default);CT.exports=ST;CT.exports.default=ST;function ST(n,e,t){e=e||1;for(var c,a,h,d,s=0;s<n[0].length;s++){var f=n[0][s];(!s||f[0]<c)&&(c=f[0]),(!s||f[1]<a)&&(a=f[1]),(!s||f[0]>h)&&(h=f[0]),(!s||f[1]>d)&&(d=f[1])}var b=h-c,x=d-a,v=Math.min(b,x),g=v/2;if(v===0){var P=[c,a];return P.distance=0,P}for(var _=new mf(void 0,kO),S=c;S<h;S+=v)for(var k=a;k<d;k+=v)_.push(new sl(S+g,k+g,g,n));var A=AO(n),y=new sl(c+b/2,a+x/2,0,n);y.d>A.d&&(A=y);for(var I=_.length;_.length;){var D=_.pop();D.d>A.d&&(A=D,t&&console.log("found best %d after %d probes",Math.round(1e4*D.d)/1e4,I)),!(D.max-A.d<=e)&&(g=D.h/2,_.push(new sl(D.x-g,D.y-g,g,n)),_.push(new sl(D.x+g,D.y-g,g,n)),_.push(new sl(D.x-g,D.y+g,g,n)),_.push(new sl(D.x+g,D.y+g,g,n)),I+=4)}t&&(console.log("num probes: "+I),console.log("best distance: "+A.d));var w=[A.x,A.y];return w.distance=A.d,w}function kO(n,e){return e.max-n.max}function sl(n,e,t,c){this.x=n,this.y=e,this.h=t,this.d=MO(n,e,c),this.max=this.d+this.h*Math.SQRT2}function MO(n,e,t){for(var c=!1,a=1/0,h=0;h<t.length;h++)for(var d=t[h],s=0,f=d.length,b=f-1;s<f;b=s++){var x=d[s],v=d[b];x[1]>e!=v[1]>e&&n<(v[0]-x[0])*(e-x[1])/(v[1]-x[1])+x[0]&&(c=!c),a=Math.min(a,PO(n,e,x,v))}return a===0?0:(c?1:-1)*Math.sqrt(a)}function AO(n){for(var e=0,t=0,c=0,a=n[0],h=0,d=a.length,s=d-1;h<d;s=h++){var f=a[h],b=a[s],x=f[0]*b[1]-b[0]*f[1];t+=(f[0]+b[0])*x,c+=(f[1]+b[1])*x,e+=x*3}return e===0?new sl(a[0][0],a[0][1],0,n):new sl(t/e,c/e,0,n)}function PO(n,e,t,c){var a=t[0],h=t[1],d=c[0]-a,s=c[1]-h;if(d!==0||s!==0){var f=((n-a)*d+(e-h)*s)/(d*d+s*s);f>1?(a=c[0],h=c[1]):f>0&&(a+=d*f,h+=s*f)}return d=n-a,s=e-h,d*d+s*s}var IO=typeof lo=="object"&&lo&&lo.Object===Object&&lo,DO=typeof self=="object"&&self&&self.Object===Object&&self;IO||DO||Function("return this")();var LO={exports:{}};(function(n,e){var t=function(){var c={},a=Math.PI/180,h=180/Math.PI,d=6378137,s=20037508342789244e-9;function f(x){return Number(x)===x&&x%1!==0}function b(x){if(x=x||{},this.size=x.size||256,this.expansion=x.antimeridian===!0?2:1,!c[this.size]){var v=this.size,g=c[this.size]={};g.Bc=[],g.Cc=[],g.zc=[],g.Ac=[];for(var P=0;P<30;P++)g.Bc.push(v/360),g.Cc.push(v/(2*Math.PI)),g.zc.push(v/2),g.Ac.push(v),v*=2}this.Bc=c[this.size].Bc,this.Cc=c[this.size].Cc,this.zc=c[this.size].zc,this.Ac=c[this.size].Ac}return b.prototype.px=function(x,v){if(f(v)){var g=this.size*Math.pow(2,v),P=g/2,_=g/360,S=g/(2*Math.PI),k=g,A=Math.min(Math.max(Math.sin(a*x[1]),-.9999),.9999),y=P+x[0]*_,I=P+.5*Math.log((1+A)/(1-A))*-S;return y>k*this.expansion&&(y=k*this.expansion),I>k&&(I=k),[y,I]}else{var P=this.zc[v],A=Math.min(Math.max(Math.sin(a*x[1]),-.9999),.9999),y=Math.round(P+x[0]*this.Bc[v]),I=Math.round(P+.5*Math.log((1+A)/(1-A))*-this.Cc[v]);return y>this.Ac[v]*this.expansion&&(y=this.Ac[v]*this.expansion),I>this.Ac[v]&&(I=this.Ac[v]),[y,I]}},b.prototype.ll=function(x,v){if(f(v)){var g=this.size*Math.pow(2,v),P=g/360,_=g/(2*Math.PI),S=g/2,k=(x[1]-S)/-_,A=(x[0]-S)/P,y=h*(2*Math.atan(Math.exp(k))-.5*Math.PI);return[A,y]}else{var k=(x[1]-this.zc[v])/-this.Cc[v],A=(x[0]-this.zc[v])/this.Bc[v],y=h*(2*Math.atan(Math.exp(k))-.5*Math.PI);return[A,y]}},b.prototype.bbox=function(x,v,g,P,_){P&&(v=Math.pow(2,g)-1-v);var S=[x*this.size,(+v+1)*this.size],k=[(+x+1)*this.size,v*this.size],A=this.ll(S,g).concat(this.ll(k,g));return _==="900913"?this.convert(A,"900913"):A},b.prototype.xyz=function(x,v,g,P){P==="900913"&&(x=this.convert(x,"WGS84"));var _=[x[0],x[1]],S=[x[2],x[3]],k=this.px(_,v),A=this.px(S,v),y=[Math.floor(k[0]/this.size),Math.floor((A[0]-1)/this.size)],I=[Math.floor(A[1]/this.size),Math.floor((k[1]-1)/this.size)],D={minX:Math.min.apply(Math,y)<0?0:Math.min.apply(Math,y),minY:Math.min.apply(Math,I)<0?0:Math.min.apply(Math,I),maxX:Math.max.apply(Math,y),maxY:Math.max.apply(Math,I)};if(g){var w={minY:Math.pow(2,v)-1-D.maxY,maxY:Math.pow(2,v)-1-D.minY};D.minY=w.minY,D.maxY=w.maxY}return D},b.prototype.convert=function(x,v){return v==="900913"?this.forward(x.slice(0,2)).concat(this.forward(x.slice(2,4))):this.inverse(x.slice(0,2)).concat(this.inverse(x.slice(2,4)))},b.prototype.forward=function(x){var v=[d*x[0]*a,d*Math.log(Math.tan(Math.PI*.25+.5*x[1]*a))];return v[0]>s&&(v[0]=s),v[0]<-20037508342789244e-9&&(v[0]=-20037508342789244e-9),v[1]>s&&(v[1]=s),v[1]<-20037508342789244e-9&&(v[1]=-20037508342789244e-9),v},b.prototype.inverse=function(x){return[x[0]*h/d,(Math.PI*.5-2*Math.atan(Math.exp(-x[1]/d)))*h]},b}();n.exports=t})(LO);var Vv={exports:{}};(function(n,e){(function(t,c){c(e,n)})(lo,function(t,c){var a={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function h(){return"jsonp_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function d(b){try{delete window[b]}catch{window[b]=void 0}}function s(b){var x=document.getElementById(b);x&&document.getElementsByTagName("head")[0].removeChild(x)}function f(b){var x=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],v=b,g=x.timeout||a.timeout,P=x.jsonpCallback||a.jsonpCallback,_=void 0;return new Promise(function(S,k){var A=x.jsonpCallbackFunction||h(),y=P+"_"+A;window[A]=function(D){S({ok:!0,json:function(){return Promise.resolve(D)}}),_&&clearTimeout(_),s(y),d(A)},v+=v.indexOf("?")===-1?"?":"&";var I=document.createElement("script");I.setAttribute("src",""+v+P+"="+A),x.charset&&I.setAttribute("charset",x.charset),x.nonce&&I.setAttribute("nonce",x.nonce),x.referrerPolicy&&I.setAttribute("referrerPolicy",x.referrerPolicy),x.crossorigin&&I.setAttribute("crossorigin","true"),I.id=y,document.getElementsByTagName("head")[0].appendChild(I),_=setTimeout(function(){k(new Error("JSONP request to "+b+" timed out")),d(A),s(y),window[A]=function(){d(A)}},g),I.onerror=function(){k(new Error("JSONP request to "+b+" failed")),d(A),s(y),_&&clearTimeout(_)}})}c.exports=f})})(Vv,Vv.exports);var RO=zO,OO=Object.prototype.hasOwnProperty;function zO(){for(var n={},e=0;e<arguments.length;e++){var t=arguments[e];for(var c in t)OO.call(t,c)&&(n[c]=t[c])}return n}var kT={exports:{}};(function(n,e){(function(){var t={};n.exports=t,t.simpleFilter=function(c,a){return a.filter(function(h){return t.test(c,h)})},t.test=function(c,a){return t.match(c,a)!==null},t.match=function(c,a,h){h=h||{};var d=0,s=[],f=a.length,b=0,x=0,v=h.pre||"",g=h.post||"",P=h.caseSensitive&&a||a.toLowerCase(),_;c=h.caseSensitive&&c||c.toLowerCase();for(var S=0;S<f;S++)_=a[S],P[S]===c[d]?(_=v+_+g,d+=1,x+=1+x):x=0,b+=x,s[s.length]=_;return d===c.length?(b=P===c?1/0:b,{rendered:s.join(""),score:b}):null},t.filter=function(c,a,h){return!a||a.length===0?[]:typeof c!="string"?a:(h=h||{},a.reduce(function(d,s,f,b){var x=s;h.extract&&(x=h.extract(s));var v=t.match(c,x,h);return v!=null&&(d[d.length]={string:v.rendered,score:v.score,index:f,original:s}),d},[]).sort(function(d,s){var f=s.score-d.score;return f||d.index-s.index}))}})()})(kT);var NO=kT.exports,Ks=function(n){return this.component=n,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,n.el.parentNode.insertBefore(this.wrapper,n.el.nextSibling),this};Ks.prototype.show=function(){this.element.style.display="block"};Ks.prototype.hide=function(){this.element.style.display="none"};Ks.prototype.add=function(n){this.items.push(n)};Ks.prototype.clear=function(){this.items=[],this.active=0};Ks.prototype.isEmpty=function(){return!this.items.length};Ks.prototype.isVisible=function(){return this.element.style.display==="block"};Ks.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var n=0;n<this.items.length;n++)this.drawItem(this.items[n],this.active===n);this.show()};Ks.prototype.drawItem=function(n,e){var t=document.createElement("li"),c=document.createElement("a");e&&(t.className+=" active"),c.innerHTML=n.string,t.appendChild(c),this.element.appendChild(t),t.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),t.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,n)}).bind(this))};Ks.prototype.handleMouseUp=function(n){this.selectingListItem=!1,this.component.value(n.original),this.clear(),this.draw()};Ks.prototype.move=function(n){this.active=n,this.draw()};Ks.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)};Ks.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)};Ks.prototype.drawError=function(n){var e=document.createElement("li");e.innerHTML=n,this.element.appendChild(e),this.show()};var jO=Ks,BO=RO,FO=NO,UO=jO,Ts=function(n,e,t){return t=t||{},this.options=BO({minLength:2,limit:5,filter:!0,hideOnBlur:!0},t),this.el=n,this.data=e||[],this.list=new UO(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(c){this.handleKeyUp(c.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(c){this.handleKeyDown(c)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(c){this.handlePaste(c)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};Ts.prototype.handleKeyUp=function(n){n===40||n===38||n===27||n===13||n===9||this.handleInputChange(this.el.value)};Ts.prototype.handleKeyDown=function(n){switch(n.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&n.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};Ts.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};Ts.prototype.handlePaste=function(n){if(n.clipboardData)this.handleInputChange(n.clipboardData.getData("Text"));else{var e=this;setTimeout(function(){e.handleInputChange(n.target.value)},100)}};Ts.prototype.handleInputChange=function(n){if(this.query=this.normalize(n),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(e){for(var t=0;t<e.length&&(this.list.add(e[t]),t!==this.options.limit-1);t++);this.list.draw()}).bind(this))};Ts.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};Ts.prototype.update=function(n){this.data=n,this.handleKeyUp()};Ts.prototype.clear=function(){this.data=[],this.list.clear()};Ts.prototype.normalize=function(n){return n=n.toLowerCase(),n};Ts.prototype.match=function(n,e){return n.indexOf(e)>-1};Ts.prototype.value=function(n){if(this.selected=n,this.el.value=this.getItemValue(n),document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1),this.el.dispatchEvent(e)}else this.el.fireEvent("onchange")};Ts.prototype.getCandidates=function(n){var e={pre:"<strong>",post:"</strong>",extract:(function(c){return this.getItemValue(c)}).bind(this)},t;this.options.filter?(t=FO.filter(this.query,this.data,e),t=t.map((function(c){return{original:c.original,string:this.render(c.original,c.string)}}).bind(this))):t=this.data.map((function(c){var a=this.render(c);return{original:c,string:a}}).bind(this)),n(t)};Ts.prototype.getItemValue=function(n){return n};Ts.prototype.render=function(n,e){if(e)return e;for(var t=n.original?this.getItemValue(n.original):this.getItemValue(n),c=this.normalize(t),a=c.lastIndexOf(this.query);a>-1;){var h=a+this.query.length;t=t.slice(0,a)+"<strong>"+t.slice(a,h)+"</strong>"+t.slice(h),a=c.slice(0,a).lastIndexOf(this.query)}return t};Ts.prototype.renderError=function(n){this.list.drawError(n)};var $O=Ts,GO=$O;typeof window<"u"&&(window.Suggestions=GO);We.createContext(null);var MT={exports:{}};(function(n,e){(function(t,c){c()})(lo,function(){function t(b,x){return typeof x>"u"?x={autoBom:!1}:typeof x!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),x={autoBom:!x}),x.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(b.type)?new Blob(["\uFEFF",b],{type:b.type}):b}function c(b,x,v){var g=new XMLHttpRequest;g.open("GET",b),g.responseType="blob",g.onload=function(){f(g.response,x,v)},g.onerror=function(){console.error("could not download file")},g.send()}function a(b){var x=new XMLHttpRequest;x.open("HEAD",b,!1);try{x.send()}catch{}return 200<=x.status&&299>=x.status}function h(b){try{b.dispatchEvent(new MouseEvent("click"))}catch{var x=document.createEvent("MouseEvents");x.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),b.dispatchEvent(x)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof lo=="object"&&lo.global===lo?lo:void 0,s=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),f=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(b,x,v){var g=d.URL||d.webkitURL,P=document.createElement("a");x=x||b.name||"download",P.download=x,P.rel="noopener",typeof b=="string"?(P.href=b,P.origin===location.origin?h(P):a(P.href)?c(b,x,v):h(P,P.target="_blank")):(P.href=g.createObjectURL(b),setTimeout(function(){g.revokeObjectURL(P.href)},4e4),setTimeout(function(){h(P)},0))}:"msSaveOrOpenBlob"in navigator?function(b,x,v){if(x=x||b.name||"download",typeof b!="string")navigator.msSaveOrOpenBlob(t(b,v),x);else if(a(b))c(b,x,v);else{var g=document.createElement("a");g.href=b,g.target="_blank",setTimeout(function(){h(g)})}}:function(b,x,v,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),typeof b=="string")return c(b,x,v);var P=b.type==="application/octet-stream",_=/constructor/i.test(d.HTMLElement)||d.safari,S=/CriOS\/[\d]+/.test(navigator.userAgent);if((S||P&&_||s)&&typeof FileReader<"u"){var k=new FileReader;k.onloadend=function(){var I=k.result;I=S?I:I.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=I:location=I,g=null},k.readAsDataURL(b)}else{var A=d.URL||d.webkitURL,y=A.createObjectURL(b);g?g.location=y:location.href=y,g=null,setTimeout(function(){A.revokeObjectURL(y)},4e4)}});d.saveAs=f.saveAs=f,n.exports=f})})(MT);var VO=MT.exports;const HO=jh(VO),WO="_errorChap_1v22m_1",YO="_errorBar_1v22m_6",qO="_errorHeader_1v22m_16",XO="_detailedError_1v22m_23",ZO="_scrollMissingData_1v22m_29",KO="_notFoundDataTable_1v22m_34",vh={errorChap:WO,errorBar:YO,errorHeader:qO,detailedError:XO,scrollMissingData:ZO,notFoundDataTable:KO},QO="_buttons_1a7lz_1",JO="_text_1a7lz_7",Hv={buttons:QO,text:JO},ez=({startDownload:n,isSendingDataToChap:e,formValid:t,orgUnits:c,onClickDownloadOrPostData:a,onButtonSendAction:h})=>{const d=()=>{if(c.length===0)return!0;const b=c[0].path.split("/").length;return c.every(x=>x.path.split("/").length===b)},s=h==="predict"?"Send prediction":"Create dataset",f=h==="predict"?ve.jsx($f,{}):ve.jsx(Iy,{});return ve.jsxs("div",{children:[ve.jsxs("div",{className:Hv.buttons,children:[ve.jsx(en,{icon:ve.jsx(h1,{}),loading:n.startDownload&&n.action==="download",disabled:!t||n.startDownload||!d(),onClick:()=>a("download"),children:"Download data"}),ve.jsx(en,{icon:f,primary:!0,loading:n.startDownload&&n.action===h||e,disabled:!t||n.startDownload||!d(),onClick:()=>a(h),children:s})]}),e&&ve.jsx("p",{className:Hv.text,children:"Sending data.."})]})},AT=({onSendAction:n,onDrawerSubmit:e,selectedModel:t,name:c,selectedPeriodItems:a,selectedOrgUnits:h,orgUnitLevel:d,dataLayers:s})=>{const[f,b]=We.useState({action:"download",startDownload:!1}),[x,v]=We.useState(!1),[g,P]=We.useState(void 0),[_,S]=We.useState(),[k,A]=We.useState({}),y=s.filter(ue=>ue.origin==="dataItem"),[I,D]=We.useState([]),[w,M]=We.useState([]),[z,Y]=We.useState(""),X=()=>!(d===void 0||h.length==0||a.length==0||c===""||a.length==0||s.length==0||s.some(ue=>ue.feature===""||ue.dataSource===""||ue.origin==="")),Z=ue=>{P(void 0),S(void 0),M([]),b({action:ue,startDownload:!0})};We.useEffect(()=>{if(g&&_){if(Y(""),b(ue=>({...ue,startDownload:!1})),f.action==="download"){ne();return}if(V(g))return;f.action==="predict"&&W(),f.action==="new-dataset"&&H()}},[g,_]);const j=(ue,ie,oe,Te)=>{var K;const ge=[],we=[...new Set(ue.map(Q=>Q.orgUnit))];a.forEach(Q=>{we.forEach(ae=>{var J;let ye=!0;ue.filter(re=>re.featureName===oe).forEach(re=>{if(Q.id==re.period){ye=!1;return}}),ye&&ge.push({covariate:Te,orgUnitName:((J=k[ae])==null?void 0:J.name)||"",period:Q.id})})}),ge.length>0&&ie.push({title:Te+" is missing for the following orgUnit and time periods: ",description:ve.jsxs("div",{children:[ve.jsxs("p",{children:["Total missing: ",ge.length," | Use the"," ",ve.jsx("a",{target:"_blank",href:((K=$==null?void 0:$.systemInfo)==null?void 0:K.contextPath)+"/api/apps/climate-data/index.html#/import",children:"Climate App"})," ","to import climate data."]}),ve.jsx("div",{className:vh.scrollMissingData,children:ve.jsxs("table",{className:vh.notFoundDataTable,children:[ve.jsx("thead",{children:ve.jsxs("tr",{children:[ve.jsx("th",{children:"Organisation unit:"}),ve.jsx("th",{children:"Time period:"})]})}),ve.jsx("tbody",{children:ge.map(Q=>ve.jsxs("tr",{children:[ve.jsx("td",{children:Q.orgUnitName}),ve.jsx("td",{children:Mx({periodId:Q.period,calendar:"gregory"}).displayName})]}))})]})})]})})},V=ue=>{let ie=[];return s.filter(oe=>oe.origin=="dataItem").forEach(oe=>{var Te;if(((Te=ue.filter(ge=>ge.featureName===oe.feature))==null?void 0:Te.length)===0){const ge='Thes selected data item for covarate "'+oe.feature+'" returned no data.';ie.push({description:"Ensure you have exported the analytics tables in DHIS2.",title:ge})}}),s.find(oe=>oe.feature==="rainfall"&&oe.origin=="dataItem")&&j(ue,ie,"rainfall","Rainfall"),s.find(oe=>oe.feature==="mean_temperature"&&oe.origin=="dataItem")&&j(ue,ie,"mean_temperature","Mean Temperature"),ie.length>0?(M([...w,...ie]),!0):!1},$=zh(),R=()=>{var ue,ie,oe;return{userId:((ue=$==null?void 0:$.systemInfo)==null?void 0:ue.systemId)||"Unknown",appVersion:((ie=$==null?void 0:$.appVersion)==null?void 0:ie.full)||"Unknown",dhis2Version:((oe=$==null?void 0:$.systemInfo)==null?void 0:oe.version)||"Unknown",dataItemMapper:I}},L=()=>({name:c,dataToBeFetched:F(),metaData:R(),providedData:g,geojson:_}),G=()=>L(),U=()=>({type:"predict",modelId:t==null?void 0:t.name,...L()}),F=()=>s.filter(ue=>ue.origin==="CHAP").map(ue=>({dataSourceName:ue.dataSource,featureName:ue.feature})),H=async()=>{let ue=G();v(!0),await Rh.makeDatasetAnalyticsMakeDatasetPost(ue).then(ie=>{Y(""),e()}).catch(ie=>{var oe,Te;(oe=ie==null?void 0:ie.body)!=null&&oe.detail?Y(JSON.stringify((Te=ie==null?void 0:ie.body)==null?void 0:Te.detail)):Y("An error occured while sending the request to CHAP Core.")}).finally(()=>{v(!1)})},W=async()=>{let ue=U();v(!0),await Rh.makePredictionAnalyticsMakePredictionPost(ue).then(ie=>{e()}).catch(ie=>{var oe,Te;(oe=ie==null?void 0:ie.body)!=null&&oe.detail?Y(JSON.stringify((Te=ie==null?void 0:ie.body)==null?void 0:Te.detail)):Y("An error occured while sending the request to CHAP Core.")}).finally(()=>{v(!1)})},ne=()=>{let ue={};n==="predict"&&(ue=U()),n==="new-dataset"&&(ue=G());var ie=new Blob([JSON.stringify(ue,null,2)],{type:"application/json"});const oe=new Date;HO(ie,n.replaceAll("-","_")+"_chap_request_data_"+oe.toJSON()+".json")};return ve.jsxs("div",{children:[ve.jsx(ez,{formValid:X(),onButtonSendAction:n,onClickDownloadOrPostData:Z,orgUnits:h,isSendingDataToChap:x,startDownload:f}),ve.jsx("p",{className:vh.errorChap,children:z}),f.startDownload&&X()&&ve.jsx(R3,{setAnalyticsMetaData:A,setFeatureDataItemMapper:D,model_id:t==null?void 0:t.name,setObservations:P,setGeoJSon:S,analyticsDataLayers:y,startDownload:f,setStartDownload:b,selectedPeriodItems:a,setErrorMessages:M,selectedOrgUnits:h,orgUnitLevel:d}),w.map((ue,ie)=>ve.jsxs("div",{className:vh.errorBar,children:[ve.jsxs("div",{className:vh.errorHeader,children:[ve.jsx(u1,{}),ve.jsx("span",{children:ue.title})]}),ve.jsx("span",{className:vh.detailedError,children:ue.description})]},ie))]})},tz="_dataLineWrapper_epwpx_1",iz="_selectField_epwpx_9",rz="_buttonRight_epwpx_13",nz="_selectDataLineWrapper_epwpx_19",sz="_predictLabel_epwpx_27",Ju={dataLineWrapper:tz,selectField:iz,buttonRight:rz,selectDataLineWrapper:nz,predictLabel:sz},oz="_searchSelectField_fpa7s_1",az="_inputField_fpa7s_6",lz="_input_fpa7s_6",cz="_dropDown_fpa7s_33",hz="_dropDownItem_fpa7s_50",uz="_rightDropDownItem_fpa7s_60",dz="_label_fpa7s_69",pz="_infoSearchItem_fpa7s_75",ka={searchSelectField:oz,inputField:az,input:lz,dropDown:cz,dropDownItem:hz,rightDropDownItem:uz,label:dz,infoSearchItem:pz},fz=n=>({results:{resource:"dataItems",params:{filter:"displayName:ilike:"+n,fields:"id,displayName,dimensionItemType",order:"displayName:asc",page:1,pageSize:20}}}),mz=({feature:n,onChangeSearchSelectField:e})=>{const[t,c]=We.useState(""),a=t1(),[h,d]=We.useState([]),[s,f]=We.useState(!1),b=async()=>{try{const y=await a.query(fz(t));d(y.results.dataItems)}catch(y){console.error("Error fetching data:",y)}finally{f(!1)}};We.useEffect(()=>{if(t.length===0){d([]);return}f(!0);const y=setTimeout(()=>{b()},300);return()=>{clearTimeout(y)}},[t]);const[x,v]=We.useState(!1),g=y=>{v(!0);const I=y.target.value;c(I)},P=y=>{c(y.displayName),e(n,y.id,y.displayName),v(!1)},_=We.useRef(null),S=y=>y.replaceAll("_"," ").split(" ").map(I=>I.charAt(0).toUpperCase()+I.slice(1).toLowerCase()).join(" "),k=y=>{_.current&&!_.current.contains(y.target)&&v(!1)},A=()=>s?ve.jsx("li",{className:ka.infoSearchItem,children:"Loading..."}):h.length==0&&t.length==0?ve.jsx("li",{className:ka.infoSearchItem,children:"Start to search by typing"}):h.length==0?ve.jsx("li",{className:ka.infoSearchItem,children:"No match found"}):ve.jsx(ve.Fragment,{children:h.map(y=>ve.jsxs("li",{onClick:()=>P(y),className:ka.dropDownItem,children:[ve.jsx("div",{children:y.displayName}),ve.jsx("div",{className:ka.rightDropDownItem,children:S(y.dimensionItemType)??""})]},y.id))});return We.useEffect(()=>(document.addEventListener("mousedown",k),()=>{document.removeEventListener("mousedown",k)}),[]),ve.jsxs("div",{ref:_,className:ka.searchSelectField,children:[ve.jsx("label",{className:ka.label,children:ve.jsx("span",{children:S(n.name??"")})}),ve.jsx("input",{type:"search",value:t,onChange:g,placeholder:"Search for indicators, Data Elements, Data Sets, Event Data Items, Program Indicators...",className:ka.inputField}),x&&ve.jsx("ul",{className:ka.dropDown,children:A()})]})},PT=({datasetLayers:n,setDataLayers:e,predictMode:t})=>{const[c,a]=We.useState([]),h=async()=>{await Rh.getDataSourcesAnalyticsDataSourcesGet().then(f=>{a(f)})};We.useEffect(()=>{h()},[]);const d=(f,b,x)=>{let v=[...n];f.selected!=null&&(v[x][b]=f.selected,e(v))},s=(f,b)=>{d({selected:f},"dataSource",b)};return ve.jsxs("div",{children:[ve.jsx("h3",{children:"Covariates"}),ve.jsx("div",{className:Ju.selectDataLineWrapper,children:n.map((f,b)=>{var x,v,g;return ve.jsx("div",{children:ve.jsxs("div",{className:Ju.dataLineWrapper,children:[t?ve.jsx("div",{className:Ju.predictLabel,children:((x=gf.filter(P=>P.id===f.feature)[0])==null?void 0:x.name)+":"}):ve.jsx("div",{className:Ju.predictLabel,children:((v=gf.filter(P=>P.id===f.feature)[0])==null?void 0:v.name)+":"}),ve.jsxs("div",{className:Ju.selectField,children:[(f.origin==="CHAP"||f.origin==="")&&ve.jsx(Os,{disabled:f.origin==="",label:"Data Element",onChange:P=>d(P,"dataSource",b),selected:f.dataSource,children:c.map(P=>P.supportedFeatures.includes(f.feature)&&ve.jsx(yc,{label:`${P.dataset.toUpperCase()} - ${P.displayName}`,value:P.dataset},P.name))}),f.origin==="dataItem"&&ve.jsx(mz,{feature:{name:(g=gf.filter(P=>P.id===f.feature)[0])==null?void 0:g.name,id:f.feature,description:""},onChangeSearchSelectField:(P,_)=>s(_,b)})]})]})},b)})})]})},gf=[{id:"rainfall",name:"Rainfall",description:"The amount of rainfall in mm",optional:!0},{id:"mean_temperature",name:"Mean Temperature",description:"The average temperature in degrees Celsius",optional:!0},{id:"population",name:"Population",description:"The population of the area",optional:!1},{name:"Disease cases",id:"disease_cases",description:"Feature 5"}],gz=()=>gf.map(e=>({feature:e.id,origin:"dataItem",dataSource:""})),yz=({onDrawerSubmit:n})=>{const[e,t]=We.useState(gz()),[c,a]=We.useState([]),[h,d]=We.useState([]),[s,f]=We.useState(void 0),[b,x]=We.useState("");return ve.jsx(ve.Fragment,{children:ve.jsxs("div",{className:e3.formWrapper,children:[ve.jsx(Nh,{autoComplete:"",label:"Dataset name",value:b,onChange:v=>x(v.value),helpText:"Name your dataset",placeholder:"Example: Monthly malaria cases, ERA5 climate data, all districts"}),ve.jsx(PT,{setDataLayers:t,datasetLayers:e}),ve.jsx(ww,{setTimePeriods:d}),ve.jsx(Tw,{orgUnits:c,setOrgUnits:a,orgUnitLevel:s,setOrgUnitLevel:f}),ve.jsx(AT,{onDrawerSubmit:n,name:b,dataLayers:e,onSendAction:"new-dataset",orgUnitLevel:s,selectedPeriodItems:h,selectedOrgUnits:c})]})})},xz="_newDatasetWrapper_1jun0_1",bz="_newEvaluationDatasetTitle_1jun0_5",vz="_navFooterOuter_1jun0_12",_z="_navFooter_1jun0_12",Wv={newDatasetWrapper:xz,newEvaluationDatasetTitle:bz,navFooterOuter:vz,navFooter:_z},wz=({onDrawerClose:n,onDrawerSubmit:e})=>ve.jsx(ve.Fragment,{children:ve.jsxs("div",{className:Wv.newDatasetWrapper,children:[ve.jsxs("div",{className:Wv.newEvaluationDatasetTitle,children:[ve.jsx("h2",{children:"New evaluation dataset"}),ve.jsx(en,{icon:ve.jsx(Py,{}),onClick:n})]}),ve.jsx(yz,{onDrawerSubmit:e})]})}),Tz=({isOpen:n,onDrawerSubmit:e,onDrawerClose:t})=>{const c=window.innerWidth<900?"100vw":"1000px";return ve.jsx("div",{children:ve.jsx(Ex,{open:n,onClose:t,direction:"right",size:c,children:ve.jsx("div",{className:KP.drawerWrapper,children:ve.jsx(wz,{onDrawerClose:t,onDrawerSubmit:e})})})})},Ez="_pageHeader_1or2f_1",Cz="_pageDescription_1or2f_8",Yv={pageHeader:Ez,pageDescription:Cz},Cy=({pageTitle:n,pageDescription:e,setDrawerOpen:t,setDrawerOpenText:c})=>ve.jsxs("div",{className:Yv.pageHeader,children:[ve.jsxs("div",{children:[ve.jsx("h2",{children:n}),ve.jsx("p",{className:Yv.pageDescription,children:e})]}),t&&c&&ve.jsx(en,{onClick:()=>t(!0),icon:ve.jsx(r1,{}),primary:!0,children:c})]}),Sz="_jobResultPanelContainer_16af9_1",kz="_boxPanel_16af9_9",Mz="_flexMedium_16af9_17",Az="_flexItemRight_16af9_21",Pz="_inProgress_16af9_26",Iz="_notStarted_16af9_31",Dz="_completed_16af9_36",Lz="_failed_16af9_41",Rz="_resultTextHeader_16af9_46",Oz="_evaluationModal_16af9_53",zz="_jobLogsModal_16af9_58",ol={jobResultPanelContainer:Sz,boxPanel:kz,flexMedium:Mz,flexItemRight:Az,inProgress:Pz,notStarted:Iz,completed:Dz,failed:Lz,resultTextHeader:Rz,evaluationModal:Oz,jobLogsModal:zz},Nz="_modal_1k0a4_1",jz={modal:Nz},Bz="_container_mngpy_1",Fz="_innerContainer_mngpy_6",Uz="_prediction_mngpy_21",$z="_warning_mngpy_26",Gz="_footer_mngpy_31",Vz="_post_mngpy_36",Hz="_redText_mngpy_40",Wz="_greenText_mngpy_45",il={container:Bz,innerContainer:Fz,prediction:Uz,warning:$z,footer:Gz,post:Vz,redText:Hz,greenText:Wz},Yz={orgUnits:{resource:"organisationUnits",params:{paging:!1,fields:["id","displayName"]}}},IT=()=>{const{loading:n,error:e,data:t}=mo(Yz);return{orgUnits:t==null?void 0:t.orgUnits,error:e,loading:n}},qz=({prediction:n,qLowDataElementId:e,qMedianDataElementId:t,qHighDataElementId:c,setPostHttpError:a,setPostStatus:h})=>{const d=_=>{if(_==="quantile_low")return e;if(_==="median")return t;if(_==="quantile_high")return c},s=_=>_.dataValues.map(S=>({dataElement:d(S.dataElement),period:S.period,orgUnit:S.orgUnit,value:S.value})),f=_=>({resource:"dataValueSets",type:"create",data:{dataValues:_}}),[b,{error:x,loading:v,called:g}]=Pf(f(s(n))),P=async()=>{await b()};return We.useEffect(()=>{P()},[]),We.useEffect(()=>{g&&(v||(x&&(a("Something went wrong when posting the prediction."),h("error")),x||(a(""),h("finish"))))},[v]),null},Xz="_selectWrapper_8vdsv_1",Zz="_select_8vdsv_1",qv={selectWrapper:Xz,select:Zz},Gg=({value:n,onChange:e,label:t,dataElements:c})=>{const a=d=>{e({displayName:c==null?void 0:c.find(s=>s.id===d.selected).displayName,id:d.selected})},h=(c==null?void 0:c.length)===0&&c!=null;return ve.jsx("div",{children:ve.jsx("div",{children:ve.jsx("div",{className:qv.select,children:ve.jsxs("div",{className:qv.selectWrapper,children:[ve.jsx("span",{children:t}),ve.jsx(Os,{tabIndex:"1",placeholder:jt.t("Select data element"),disabled:h,selected:n?n.id:"",warning:h,onChange:a,children:c==null?void 0:c.map(d=>ve.jsx(yc,{label:d.displayName,value:d.id},d.id))})]})})})})},Kz="_textWarning_3ldzr_1",Qz="_wrapper_3ldzr_6",Jz="_wrapperWarning_3ldzr_14",Vg={textWarning:Kz,wrapper:Qz,wrapperWarning:Jz},eN="_dataValueTables_vzc5s_10",tN="_warning_vzc5s_17",Xv={dataValueTables:eN,warning:tN},iN=({setModalOpen:n,modalOpen:e,predictionTarget:t})=>{const c=zh();return e&&ve.jsx(ld,{large:!0,onClose:()=>n(!1),children:ve.jsxs(O2,{children:[ve.jsx("h2",{children:jt.t("Add required Data Elements")}),ve.jsxs("p",{children:[jt.t("This app requires specific DHIS2 Data Elements to import data into. If you have not already added them, go to the "),ve.jsx("a",{target:"_blank",href:`${c.baseUrl}/dhis-web-maintenance/index.html#/list/dataElementSection/dataElement`,children:"Maintenance"}),jt.t("-app and create the Data Elements listed below.")]}),ve.jsx("p",{className:Xv.warning,children:jt.t("NB! Make sure the CODE property for each data element is exactly the same as below.")}),ve.jsx("p",{children:jt.t("Properties in the new Data Element form not specified in the tables below should have the default value.")}),ve.jsxs("div",{className:Xv.dataValueTables,children:[ve.jsx(Hg,{q:"Low",disease:t}),ve.jsx(Hg,{q:"Median",disease:t}),ve.jsx(Hg,{q:"High",disease:t})]})]})})},Hg=({q:n,disease:e})=>ve.jsx("table",{children:ve.jsxs("tbody",{children:[ve.jsxs("tr",{children:[ve.jsx("th",{children:jt.t("Name")}),ve.jsxs("td",{children:["CHAP",jt.t(` ${e} Quantile ${n}`)]})]}),ve.jsxs("tr",{children:[ve.jsx("th",{children:jt.t("Short name")}),ve.jsxs("td",{children:["CHAP",jt.t(` ${e} Quantile ${n}`)]})]}),ve.jsxs("tr",{children:[ve.jsx("th",{children:jt.t("Code")}),ve.jsx("td",{children:`CHAP_${n.toUpperCase()}_${e.toLocaleUpperCase().replaceAll(" ","_")}`})]}),ve.jsxs("tr",{children:[ve.jsx("th",{children:jt.t("Domain type")}),ve.jsx("td",{children:jt.t("Aggregate")})]}),ve.jsxs("tr",{children:[ve.jsx("th",{children:jt.t("Aggregation levels")}),ve.jsx("td",{children:ve.jsx("em",{children:jt.t("Assign all org unit levels")})})]})]})}),rN=({predictionTarget:n,warning:e})=>{const[t,c]=We.useState(!1);return ve.jsxs(ve.Fragment,{children:[ve.jsxs("div",{className:e?Vg.wrapperWarning:Vg.wrapper,children:[ve.jsx("div",{className:Vg.textWarning,children:e&&ve.jsx(ve.Fragment,{children:ve.jsx("p",{children:jt.t("It seems like you missing Data Elements for CHAP prediction.")})})}),ve.jsx("div",{children:ve.jsx(en,{icon:ve.jsx(Iy,{}),onClick:()=>c(!0),children:jt.t("Add data elements")})})]}),ve.jsx(iN,{modalOpen:t,setModalOpen:c,predictionTarget:n})]})},nN=n=>({dataElements:{resource:"dataElements",params:{paging:!1,fields:["code","displayName","id"],filter:`code:ilike:${n}`}}}),Wg=n=>{const[e,t]=We.useState(),{loading:c,error:a}=mo(nN(n),{onComplete:h=>t(h.dataElements.dataElements)});return{dataElements:e,error:a,loading:c}},sN=n=>({dataItems:{resource:"dataItems",params:{paging:!1,filter:`id:eq:${n}`}}}),oN=n=>{const[e,t]=We.useState(),{loading:c,error:a,engine:h}=mo({});We.useEffect(()=>{n&&d()},[n]);const d=async()=>{const s=await h.query(sN(n));s.dataItems.dataItems.length===0?t("?"):t(s.dataItems.dataItems[0].displayName)};return{displayName:e,error:a,loading:c}},aN=({prediction_unprocessed:n})=>{var G;const e=Na(),[t,c]=We.useState("chart"),[a,h]=We.useState(),[d,s]=We.useState(null),[f,b]=We.useState(null),[x,v]=We.useState(null),g=(U,F)=>{if(!F)return 0;const H=[...F].sort((oe,Te)=>oe-Te),W=H.length,ne=U*(W-1),ue=Math.floor(ne),ie=Math.ceil(ne);return Math.round(ue===ie?H[ue]:H[ue]+(H[ie]-H[ue])*(ne-ue))},P=[{q:.1,name:"quantile_low"},{q:.5,name:"median"},{q:.9,name:"quantile_high"}],_=()=>{var U,F;return((F=(U=n==null?void 0:n.metaData)==null?void 0:U.dataItemMapper)==null?void 0:F.find(H=>H.featureName==="disease_cases").dataItemId)??""},S=()=>({diseaseId:I,dataValues:n.forecasts.flatMap(U=>P.map(F=>({orgUnit:U.orgUnit,value:g(F.q,U.values),displayName:U.orgUnit,dataElement:F.name,period:U.period})))}),{dataElements:k}=Wg("CHAP_LOW"),{dataElements:A}=Wg("CHAP_MEDIAN"),{dataElements:y}=Wg("CHAP_HIGH"),I=_(),{displayName:D}=oN(I),{orgUnits:w,loading:M}=IT(),[z,Y]=We.useState("initial"),[X,Z]=We.useState("");We.useEffect(()=>{w&&V()},[(G=e==null?void 0:e.state)==null?void 0:G.data,w]);const j=()=>(k==null?void 0:k.length)===0||(A==null?void 0:A.length)===0||(y==null?void 0:y.length)===0,V=async U=>{Y("initial")};We.useEffect(()=>{D&&w&&n&&h(R(S()))},[D,w,n]),We.useEffect(()=>{if(k&&A&&y&&D){const U=k.find(W=>W.code===`CHAP_LOW_${D.toLocaleUpperCase().replaceAll(" ","_")}`);U&&s(U);const F=A.find(W=>W.code===`CHAP_MEDIAN_${D.toLocaleUpperCase().replaceAll(" ","_")}`);F&&b(F);const H=y.find(W=>W.code===`CHAP_HIGH_${D.toLocaleUpperCase().replaceAll(" ","_")}`);H&&v(H)}},[k,A,y,D]);const $=()=>!d&&!f&&!x?!1:!!(d&&!(d!=null&&d.displayName.includes(D))||f&&!(f!=null&&f.displayName.includes(D))||x&&!(x!=null&&x.displayName.includes(D))),R=U=>({dataValues:U.dataValues.map(F=>{var H;return{...F,displayName:(H=w==null?void 0:w.organisationUnits.find(W=>W.id===F.orgUnit))==null?void 0:H.displayName}}),diseaseId:U.diseaseId}),L=()=>!!(d&&f&&x);return ve.jsx("div",{className:il.container,children:ve.jsxs("div",{className:il.innerContainer,children:[M&&ve.jsx("p",{children:"Loading metadata from DHIS2.. "}),ve.jsxs("h1",{children:["Prediction: ",n.name]}),a&&ve.jsxs(ve.Fragment,{children:[ve.jsxs(ew,{scrollable:!0,children:[ve.jsx(If,{selected:t==="chart",onClick:()=>c("chart"),children:"Chart"}),ve.jsx(If,{selected:t==="table",onClick:()=>c("table"),children:"Table"})]}),ve.jsx("div",{className:il.prediction,children:{chart:ve.jsx(aL,{predictionTargetName:D,data:a}),table:ve.jsx(_O,{data:a}),map:ve.jsx(ve.Fragment,{})}[t]}),ve.jsx("h3",{children:jt.t("Select which data element prediction should be imported to:")}),ve.jsx(rN,{warning:j(),predictionTarget:D}),ve.jsx(Gg,{label:jt.t("Select data element for low quantile"),dataElements:k,onChange:s,value:d}),ve.jsx(Gg,{label:jt.t("Select data element for median quantile"),dataElements:A,onChange:b,value:f}),ve.jsx(Gg,{label:jt.t("Select data element for high quantile"),dataElements:y,onChange:v,value:x}),$()&&ve.jsx("p",{className:il.warning,children:"Warning: It seems like selected data elements do not match the disease of prediction."}),ve.jsx("div",{className:il.footer,children:ve.jsx(en,{onClick:()=>Y("loading"),loading:z==="loading",disabled:z==="finish"||z==="loading"||!L(),icon:ve.jsx($f,{}),primary:!0,children:jt.t("Import prediction")})}),z==="loading"&&ve.jsx(qz,{setPostHttpError:Z,setPostStatus:Y,prediction:a,qLowDataElementId:d==null?void 0:d.id,qMedianDataElementId:f==null?void 0:f.id,qHighDataElementId:x==null?void 0:x.id}),ve.jsxs("div",{className:il.post,children:[z==="finish"&&ve.jsx("p",{className:il.greenText,children:jt.t("Prediction has been imported.")}),ve.jsx("p",{className:il.redText,children:jt.t(X)})]})]})]})})},lN=({isImportModalOpen:n,setIsImportModalOpen:e,predictionIdToImport:t})=>{const[c,a]=We.useState(),h=async d=>{await Ro.getPredictionCrudPredictionsPredictionIdGet(d).then(s=>{a(s)})};return We.useEffect(()=>{t&&h(Number(t))},[]),ve.jsx("div",{children:n&&ve.jsx(ve.Fragment,{children:ve.jsx(ld,{className:jz.modal,onClose:()=>{e(!1)},children:ve.jsx(ve.Fragment,{children:c&&ve.jsx(aN,{prediction_unprocessed:c})})})})})},cN="_jobResultPanelContainer_8nqrq_1",hN="_boxPanel_8nqrq_9",uN="_flexMedium_8nqrq_17",dN="_flexItemRight_8nqrq_21",pN="_inProgress_8nqrq_29",fN="_notStarted_8nqrq_34",mN="_completed_8nqrq_39",gN="_failed_8nqrq_44",yN="_resultTextHeader_8nqrq_49",xN="_evaluationModal_8nqrq_56",bN="_jobLogsModal_8nqrq_61",vN="_popupMenuDiv_8nqrq_66",Io={jobResultPanelContainer:cN,boxPanel:hN,flexMedium:uN,flexItemRight:dN,inProgress:pN,notStarted:fN,completed:mN,failed:gN,resultTextHeader:yN,evaluationModal:xN,jobLogsModal:bN,popupMenuDiv:vN},_N=(n,e)=>{We.useEffect(()=>{const t=c=>{const a=n.current;!a||a.contains(c.target)||e(c)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}},[n,e])},wN=({i:n,jobResult:e,onClickEvaluateDataset:t,onClickViewEvaluation:c,onClickImport:a,onClickViewLogs:h,onClickRemove:d})=>{const[s,f]=We.useState(!1),b=We.useRef(null),x=We.useRef(null);_N(x,P=>{var _;(_=b.current)!=null&&_.contains(P.target)||f(!1)});const v=P=>{switch(P){case"STARTED":return Io.inProgress;case"PENDING":return Io.notStarted;case"FAILURE":return Io.failed;default:return Io.completed}},g=P=>{switch(P){case"STARTED":return"In progress..";case"PENDING":return"Pending..";case"FAILURE":return"Failed";default:return"Completed"}};return ve.jsx("div",{className:Io.boxPanel,children:ve.jsxs("div",{className:Io.jobResultPanelContainer,children:[ve.jsx("div",{className:Io.flexMedium,children:e.name}),ve.jsx("div",{className:Io.flexMedium,children:e.created.toDateString()+", "+e.created.toLocaleTimeString().slice(0,5)}),ve.jsx("div",{className:Io.flexMedium,children:ve.jsx("span",{className:v(e.status),children:g(e.status)})}),ve.jsxs("div",{className:Io.flexItemRight,children:[{prediction:ve.jsx(ve.Fragment,{children:e.status=="SUCCESS"&&ve.jsx(en,{icon:ve.jsx(d1,{}),onClick:()=>a(e.result),small:!0,children:"Import"})}),dataset:ve.jsx(ve.Fragment,{children:e.status=="SUCCESS"&&ve.jsx(en,{icon:ve.jsx(f1,{}),onClick:()=>t(e.result),small:!0,children:"Evaluate"})}),evaluation:ve.jsx(ve.Fragment,{children:e.status=="SUCCESS"&&ve.jsx(en,{icon:ve.jsx(m1,{}),onClick:()=>c(e.result),small:!0,children:"View"})})}[e.type],e.status!="SUCCESS"&&ve.jsx(en,{icon:ve.jsx(n1,{}),onClick:()=>h(e.id),small:!0,children:"Logs"}),ve.jsx("div",{ref:b,children:ve.jsx(CL,{enabled:e.status==="STARTED",content:jt.t("Job is still running. Please wait until it is finished before doing any actions."),children:ve.jsx(en,{small:!0,icon:ve.jsx(p1,{}),disabled:e.status==="STARTED",onClick:()=>f(P=>!P)})})}),s&&ve.jsx(ky,{reference:b,placement:"top-end",children:ve.jsx("div",{ref:x,className:Io.popupMenuDiv,children:ve.jsx(i1,{children:["SUCCESS","FAILURE"].includes(e.status)&&ve.jsx(My,{label:"Delete",icon:ve.jsx(c1,{}),destructive:!0,onClick:()=>{f(!1),d(e)}})})})})]})]})},n)},TN="_jobLogs_pzpzf_1",EN="_logContent_pzpzf_7",Yg={jobLogs:TN,logContent:EN},DT=(n,e)=>{const t=We.useRef(),c=We.useRef(null),a=()=>{c.current===null&&document.visibilityState==="visible"&&(c.current=setInterval(()=>{t.current&&t.current()},e))},h=()=>{c.current!==null&&(clearInterval(c.current),c.current=null)};We.useEffect(()=>{t.current=n},[n]),We.useEffect(()=>{const d=()=>{document.visibilityState==="visible"?a():h()};return document.addEventListener("visibilitychange",d),document.visibilityState==="visible"&&a(),()=>{h(),document.removeEventListener("visibilitychange",d)}},[e])},CN=({jobId:n})=>{const[e,t]=We.useState(null),[c,a]=We.useState(null),[h,d]=We.useState(!1),s=We.useRef(null),f=async()=>{if(n){console.log("fetching logs");try{const b=await Ix.getLogsJobsJobIdLogsGet(n);t(b)}catch(b){a(b.body.detail)}finally{d(!1)}}};return We.useEffect(()=>{d(!0),a(null),f()},[n]),We.useEffect(()=>{s.current&&(s.current.scrollTop=s.current.scrollHeight)},[e]),DT(f,5e3),n?h?ve.jsx("p",{children:"Loading logs..."}):c?ve.jsxs("p",{className:Yg.error,children:["Error: ",c]}):ve.jsxs("div",{className:Yg.jobLogs,children:[ve.jsx("h2",{children:"Job Logs"}),ve.jsx("pre",{className:Yg.logContent,ref:s,children:e||"<No logs reported for this job>"})]}):ve.jsx("p",{children:"No job ID provided."})},SN="_drawerWrapper_l3raf_1",kN={drawerWrapper:SN},MN="_formWrapper_13v73_1",AN="_newEvaluationTitle_13v73_8",PN="_buttons_13v73_15",IN="_navFooterOuter_13v73_20",DN="_navFooter_13v73_20",qg={formWrapper:MN,newEvaluationTitle:AN,buttons:PN,navFooterOuter:IN,navFooter:DN},Zv=n=>{if(!n)return"NA";if(n.length==4)return n;if(n.length==6){const e=n.slice(0,4),t=n.slice(4,6);return`${["January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(t)-1]} ${e}`}if(n.length==5){const e=n.slice(0,4);return`Week ${n.slice(5,6)} ${e}`}},LN="_datasetDetailsWrapper_dewdk_1",RN="_datasetDetailsRow_dewdk_7",ON="_label_dewdk_13",sc={datasetDetailsWrapper:LN,datasetDetailsRow:RN,label:ON},zN=({datasetId:n})=>{var f;const[e,t]=We.useState(null),[c,a]=We.useState(""),[h,d]=We.useState(!0);We.useState([]);const s=b=>{const x=b.observations.map(A=>A.period),v=Array.from(new Set(x)).sort(),g=v[0],P=v[v.length-1],S=Array.from(new Set(x)).length,k=Array.from(new Set(b.observations.map(A=>A.featureName).filter(A=>A!=="disease_cases")));return{name:b.name,created:b.created,startPeriod:g,endPeriod:P,orgUnitCount:S,covariates:k}};return We.useEffect(()=>{if(console.log("datasetid",n),!n)return;(async()=>{try{console.log("fetching dataset",n);const x=await Ro.getDatasetCrudDatasetsDatasetIdGet(n);console.log("dataset loaded",x);const v=s(x);t(v)}catch(x){a(x)}finally{d(!1)}})()},[n]),h?ve.jsxs("div",{className:sc.datasetLoader,children:[ve.jsx(Td,{}),ve.jsx("span",{children:"Loading dataset"})]}):c?ve.jsxs("p",{children:["Error: ",c]}):ve.jsxs(ve.Fragment,{children:[ve.jsx("h3",{children:"Evaluation Dataset"}),ve.jsx(z2,{children:ve.jsxs("div",{className:sc.datasetDetailsWrapper,children:[ve.jsxs("div",{children:[ve.jsx("span",{className:sc.label,children:"Name: "}),ve.jsx("span",{children:e.name})]}),ve.jsxs("div",{children:[ve.jsx("span",{className:sc.label,children:"Org Units: "}),ve.jsx("span",{children:e.orgUnitCount})]}),ve.jsxs("div",{children:[ve.jsx("span",{className:sc.label,children:"Time period: "}),ve.jsxs("span",{children:[Zv(e.startPeriod)," to ",Zv(e.endPeriod)]})]}),ve.jsxs("div",{children:[ve.jsx("span",{className:sc.label,children:"Covariates: "}),ve.jsx("span",{children:((f=e==null?void 0:e.covariates)==null?void 0:f.join(", "))||"None"})]}),ve.jsxs("div",{children:[ve.jsx("span",{className:sc.label,children:"Created: "}),ve.jsx("span",{children:e.created})]})]})})]})},NN="_modelDetailsContainer_mnj31_1",jN="_loadingText_mnj31_5",BN="_selectedModelDetails_mnj31_10",FN="_modelAuthor_mnj31_17",UN="_modelAuthorLogo_mnj31_25",$N="_modelAuthorName_mnj31_32",GN="_modelHumanName_mnj31_36",VN="_modelEmail_mnj31_42",HN="_modelDescription_mnj31_47",WN="_modelDescriptionText_mnj31_52",YN="_modelCovariates_mnj31_57",qN="_modelCovariatesList_mnj31_62",XN="_modelCovariateItem_mnj31_71",ZN="_modelCitation_mnj31_75",KN="_modelCitationText_mnj31_80",QN="_modelLink_mnj31_86",Ds={modelDetailsContainer:NN,loadingText:jN,selectedModelDetails:BN,modelAuthor:FN,modelAuthorLogo:UN,modelAuthorName:$N,modelHumanName:GN,modelEmail:VN,modelDescription:HN,modelDescriptionText:WN,modelCovariates:YN,modelCovariatesList:qN,modelCovariateItem:XN,modelCitation:ZN,modelCitationText:KN,modelLink:QN},JN=({selectedModel:n,onChangeModel:e})=>ve.jsx("div",{className:Ds.modelDetailsContainer,children:ve.jsxs("div",{className:Ds.selectedModelDetails,children:[ve.jsx("h3",{className:Ds.modelHumanName,children:n.displayName}),ve.jsxs("div",{className:Ds.modelAuthor,children:[ve.jsx("img",{src:n.organizationLogoUrl||"/public/default-model-logo.png",alt:n.name+" logo",className:Ds.modelAuthorLogo}),ve.jsxs("span",{className:Ds.modelAuthorName,children:[n.author," - ",n.organization]})]}),ve.jsxs("p",{className:Ds.modelDescription,children:[ve.jsx("div",{children:"Description:"}),ve.jsx("div",{className:Ds.modelDescriptionText,children:n.description||"Coming soon..."})]}),ve.jsxs("div",{className:Ds.modelCovariates,children:[ve.jsx("span",{children:"Model inputs:"}),ve.jsx("ul",{className:Ds.modelCovariatesList,children:n.covariates.map((t,c)=>ve.jsxs("li",{className:Ds.modelCovariateItem,children:["✔ ",t.name]},c))})]}),ve.jsxs("div",{className:Ds.modelCitation,children:[ve.jsx("span",{children:"Attribution:"}),ve.jsx("pre",{className:Ds.modelCitationText,children:n.citationInfo||"Coming soon..."})]}),ve.jsxs("p",{className:Ds.modelLink,children:["External link: ",ve.jsx("a",{href:n.sourceUrl||"",target:"_blank",children:n.sourceUrl||"http://example.com"})]}),ve.jsxs("p",{className:Ds.modelEmail,children:["Contact email: ",n.contactEmail||"Coming soon..."]}),e&&ve.jsx("div",{children:ve.jsx(en,{onClick:e,primary:!0,children:"Change Model"})})]},n.name)}),ej="_modelSelectContainer_1u7s7_1",tj="_loadingText_1u7s7_5",ij="_modelGrid_1u7s7_10",rj="_modelCard_1u7s7_17",nj="_selectedModelCard_1u7s7_31",sj="_selectedModelDetails_1u7s7_35",oj="_modelAuthor_1u7s7_42",aj="_modelAuthorLogo_1u7s7_50",lj="_modelAuthorName_1u7s7_57",cj="_modelHumanName_1u7s7_61",hj="_modelEmail_1u7s7_67",uj="_modelDescription_1u7s7_72",dj="_modelDescriptionText_1u7s7_77",pj="_modelCovariates_1u7s7_82",fj="_modelCovariatesList_1u7s7_87",mj="_modelCovariateItem_1u7s7_96",gj="_modelCitation_1u7s7_100",yj="_modelCitationText_1u7s7_105",xj="_modelLink_1u7s7_111",Yo={modelSelectContainer:ej,loadingText:tj,modelGrid:ij,modelCard:rj,selectedModelCard:nj,selectedModelDetails:sj,modelAuthor:oj,modelAuthorLogo:aj,modelAuthorName:lj,modelHumanName:cj,modelEmail:hj,modelDescription:uj,modelDescriptionText:dj,modelCovariates:pj,modelCovariatesList:fj,modelCovariateItem:mj,modelCitation:gj,modelCitationText:yj,modelLink:xj},Kv={name:"Download data (CHAP is offline)",id:0,description:"Download data from the CHAP API",covariates:[],target:{name:"target",description:"target",displayName:""}},LT=({selectedModel:n,setSelectedModel:e})=>{const[t,c]=We.useState([]),[a,h]=We.useState(!0),[d,s]=We.useState(!0),f=async()=>{await Ro.listModelsCrudModelsGet().then(x=>{let v=x.map(g=>(g.covariates=g.covariates.concat(g.target),g));h(!1),c(v)}).catch(x=>{c([Kv]),e(Kv),h(!1)})},b=x=>{e(x),s(!1)};return We.useEffect(()=>{f()},[]),ve.jsx("div",{className:Yo.modelSelectContainer,children:a?ve.jsx("p",{children:"Loading models..."}):ve.jsxs(ve.Fragment,{children:[ve.jsx("h3",{children:"Prediction Model"}),!d&&n&&ve.jsx("div",{children:ve.jsx(JN,{selectedModel:n,onChangeModel:()=>s(!0)})}),d&&ve.jsx("div",{children:ve.jsx("div",{className:Yo.modelGrid,children:t.map(x=>ve.jsxs("div",{className:`${Yo.modelCard} ${(n==null?void 0:n.name)===x.name?Yo.selectedModelCard:""}`,children:[ve.jsx("h3",{className:Yo.modelHumanName,children:x.displayName}),ve.jsxs("div",{className:Yo.modelAuthor,children:[ve.jsx("img",{src:x.organizationLogoUrl||"/public/default-model-logo.png",alt:x.name+" logo",className:Yo.modelAuthorLogo}),ve.jsxs("span",{className:Yo.modelAuthorName,children:[x.author," - ",x.organization]})]}),ve.jsx("ul",{className:Yo.modelCovariatesList,children:x.covariates.map((v,g)=>ve.jsxs("li",{className:Yo.modelCovariateItem,children:["✔ ",v.name]},g))}),ve.jsx(en,{onClick:()=>b(x),primary:!0,children:(n==null?void 0:n.name)===x.name?"Selected":"Select Model"})]},x.name))})})]})})},bj=({onDrawerClose:n,datasetIdToEvaluate:e})=>{const[t,c]=We.useState(""),[a,h]=We.useState(void 0),d=t&&e&&a,s=()=>{if(console.log("should evaluate",t,e,a),d)try{const f=Rh.createBacktestAnalyticsCreateBacktestPost({nPeriods:3,nSplits:10,stride:1,name:t,datasetId:e,modelId:a.name});console.log("evaluate response",f)}catch{alert("There was an unknown error creating the evaluation")}finally{n()}};return ve.jsx(ve.Fragment,{children:ve.jsxs("div",{className:qg.formWrapper,children:[ve.jsxs("div",{className:qg.newEvaluationTitle,children:[ve.jsx("h2",{children:"New model evaluation"}),ve.jsx(en,{icon:ve.jsx(Py,{}),onClick:n})]}),ve.jsx(Nh,{autoComplete:"",label:"Evaluation name",value:t,onChange:f=>c(f.value),helpText:"Name your evaluation",placeholder:"Example: EWARS evaluation, 2020-2024"}),ve.jsx(zN,{datasetId:e}),ve.jsx(LT,{selectedModel:a,setSelectedModel:h}),ve.jsx("div",{className:qg.buttons,children:ve.jsx(en,{primary:!0,icon:ve.jsx($f,{}),onClick:s,disabled:!d,children:"Evaluate"})})]})})},vj=({isOpen:n,setIsOpen:e,datasetIdToEvaluate:t})=>{const c=window.innerWidth<900?"100vw":"1000px";return ve.jsx("div",{children:ve.jsx(Ex,{open:n,onClose:()=>e(!1),direction:"right",size:c,children:ve.jsx("div",{className:kN.drawerWrapper,children:ve.jsx(bj,{onDrawerClose:()=>e(!1),datasetIdToEvaluate:t})})})})},_j=({evaluationId:n})=>{const[e,t]=We.useState(""),[c,a]=We.useState([]),[h,d]=We.useState(),[s,f]=We.useState(),[b,x]=We.useState(""),[v,g]=We.useState(""),[P,_]=We.useState(!1),{orgUnits:S,error:k,loading:A}=IT();We.useEffect(()=>{if(S&&s){const w=wL(s.predictions,s.actualCases.data,"");w.forEach(M=>{M.evaluation.forEach(z=>{const Y=S==null?void 0:S.organisationUnits.find(X=>X.id===z.orgUnitId);Y&&(z.orgUnitName=Y.displayName)})}),d(w),a(EL(s.predictions))}},[S,s]);const y=async w=>{const M=await Ro.getBacktestsCrudBacktestsGet();let z;return M.forEach(Y=>{Y.id==w&&(z=Y)}),z},I=async w=>{const M=await Ro.listModelsCrudModelsGet();let z;return M.forEach(Y=>{Y.name==w&&(z=Y)}),z},D=async()=>{_(!0);const w=[.1,.25,.5,.75,.9];try{const[M,z,Y]=await Promise.all([y(n),Rh.getEvaluationEntriesAnalyticsEvaluationEntryGet(n,w),Rh.getActualCasesAnalyticsActualCasesBacktestIdGet(n)]);x(M.name);const X=await I(M.modelId);g(X.displayName),f({predictions:z,actualCases:Y})}catch(M){t(M.toString())}finally{_(!1)}};return We.useEffect(()=>{D()},[]),ve.jsxs("div",{children:[e&&ve.jsx("p",{children:"Not available"}),P&&ve.jsx("p",{children:"Loading.."}),h&&ve.jsx(pO,{evaluationName:b,modelName:v,evaluations:h,splitPeriods:c})]})},wj=({jobResults:n})=>{const[e,t]=We.useState(!1),[c,a]=We.useState(void 0),[h,d]=We.useState(!1),[s,f]=We.useState(!1),[b,x]=We.useState(void 0),[v,g]=We.useState(void 0),[P,_]=We.useState(!1),[S,k]=We.useState(void 0),A=M=>{t(!0),a(M)},y=M=>{f(!0),x(M)},I=M=>{_(!0),k(M)},D=M=>{if(confirm("Are you sure you want to permanently remove this item? Any data entries that depend on this item will also be deleted.")==!0){console.log("Should remove item");let Y=M.result;if(Y)M.type=="dataset"?Ro.deleteDatasetCrudDatasetsDatasetIdDelete(parseInt(Y)):M.type=="evaluation"?Ro.deleteBacktestCrudBacktestsBacktestIdDelete(parseInt(Y)):M.type=="prediction"&&Ro.deletePredictionCrudPredictionsPredictionIdDelete(parseInt(Y));else{let X=M.id;Ix.deleteJobJobsJobIdDelete(X)}}},w=M=>{console.log("clicked evaluate dataset id",M),g(M),d(!0)};return ve.jsxs(ve.Fragment,{children:[n.map((M,z)=>ve.jsx(wN,{i:z,jobResult:M,onClickEvaluateDataset:w,onClickViewEvaluation:y,onClickImport:A,onClickRemove:D,onClickViewLogs:I})),e&&ve.jsx(lN,{setIsImportModalOpen:t,isImportModalOpen:e,predictionIdToImport:c}),ve.jsx(vj,{isOpen:h,setIsOpen:d,datasetIdToEvaluate:v}),s&&ve.jsx(ld,{className:ol.evaluationModal,onClose:()=>{f(!1)},children:ve.jsx(_j,{evaluationId:b})}),P&&ve.jsx(ld,{className:ol.jobLogsModal,onClose:()=>{_(!1)},children:ve.jsx(CN,{jobId:S})})]})},Tj=()=>ve.jsx("div",{children:ve.jsxs("div",{className:[ol.jobResultPanelContainer,ol.resultTextHeader].join(" "),children:[ve.jsx("div",{className:ol.flexMedium,children:"Name:"}),ve.jsx("div",{className:ol.flexMedium,children:"Created:"}),ve.jsx("div",{className:ol.flexMedium,children:"Status:"}),ve.jsx("div",{className:ol.flexItemRight})]})}),Ej="_noticeBox_18bg1_1",Cj="_details_18bg1_8",Sj="_button_18bg1_14",Xg={noticeBox:Ej,details:Cj,button:Sj},Qv=({error:n,type:e})=>{const[t,c]=We.useState(!1);return n==null?ve.jsx(ve.Fragment,{}):ve.jsx("div",{children:ve.jsxs(Ay,{error:!0,title:`Unable to retrieve ${e}s. Please try again later.`,className:Xg.noticeBox,children:[ve.jsx("div",{className:Xg.button,children:ve.jsx(en,{small:!0,onClick:()=>c(!t),children:t?"Hide details":"See details"})}),t&&ve.jsx("div",{className:Xg.details,children:ve.jsx("div",{children:n})})]})})},kj="_loaderWrapper_iu471_1",Mj="_textLoad_iu471_8",Aj="_loader_iu471_1",Zg={loaderWrapper:kj,textLoad:Mj,loader:Aj},Pj=({type:n})=>ve.jsxs(ve.Fragment,{children:[ve.jsx("div",{className:Zg.loaderWrapper,children:ve.jsx("div",{className:Zg.loader,children:ve.jsx(Td,{})})}),ve.jsx("p",{className:Zg.textLoad,children:ve.jsxs("i",{children:["Loading ",n]})})]}),Ij="_text_3x5i9_1",Dj={text:Ij},Lj=({type:n})=>ve.jsxs("div",{className:Dj.text,children:["No ",n," found"]}),Sy=({type:n})=>{const[e,t]=We.useState([]),[c,a]=We.useState([]),[h,d]=We.useState([]),[s,f]=We.useState([]),[b,x]=We.useState([]),[v,g]=We.useState(),[P,_]=We.useState(),[S,k]=We.useState(!0),A=async M=>{for(let z=0;z<5;z++)try{const Y=await M;return _(void 0),Y}catch(Y){if(z===4)return _((Y==null?void 0:Y.message)??`Couldn't fetch ${n}`),[]}},y=()=>{switch(n){case"predictions":return A(Ro.getPredictionsCrudPredictionsGet()).then(M=>a(M));case"datasets":return A(Ro.getDatasetsCrudDatasetsGet()).then(M=>d(M));case"evaluations":return A(Ro.getBacktestsCrudBacktestsGet()).then(M=>f(M))}},I=async()=>{let M=[];for(let z=0;z<6;z++)try{M=await Ix.listJobsJobsGet();break}catch(Y){if(z===2)return g((Y==null?void 0:Y.message)??"Couldn't fetch jobs"),[]}return g(void 0),M},D=()=>{const M=[];h.filter(X=>X.type=="evaluation").forEach(X=>{M.push({id:"Unknown",name:X.name,created:new Date(X.created??""),type:"dataset",status:"SUCCESS",result:X.id.toString()})}),s.forEach(X=>{M.push({id:"Unknown",name:X.name??"",created:new Date(X.created??""),type:"evaluation",status:"SUCCESS",result:X.id.toString()})}),c.forEach(X=>{M.push({id:"Unknown",name:X.name,created:new Date(X.created),type:"prediction",status:"SUCCESS",result:X.id.toString(),datasetId:X.datasetId,estimatorId:X.modelId,nPeriods:X.nPeriods})});const z={predictions:"create_prediction",datasets:"create_dataset",evaluations:"create_backtest"},Y={predictions:"prediction",datasets:"dataset",evaluations:"evaluation"};return e.filter(X=>X.status!="SUCCESS"&&X.type==z[n]).forEach(X=>{M.push({id:X.id,name:X.name,created:new Date(X.start_time),type:Y[n],status:X.status})}),M.sort((X,Z)=>Z.created.getTime()-X.created.getTime()),M},w=async()=>{await y();const M=await I();t(M),k(!1)};return We.useEffect(()=>{w()},[]),DT(w,5e3),We.useEffect(()=>{x(D())},[e,c,s,h]),ve.jsxs("div",{children:[ve.jsx(Qv,{error:v,type:"job"}),ve.jsx(Qv,{error:P,type:n}),S&&ve.jsx(Pj,{type:n}),b.length>0&&ve.jsx(Tj,{}),b.length==0&&!S&&ve.jsx(Lj,{type:n}),ve.jsx(wj,{jobResults:b})]})},Rj=()=>{const[n,e]=We.useState(!1),t=()=>{e(!1)};return ve.jsxs("div",{children:[ve.jsx(Cy,{pageTitle:"Evaluation Datasets",pageDescription:"Historical data used to evaluate the accuracy of predictive models, combining DHIS2 and climate data sources.",setDrawerOpenText:"New Dataset",setDrawerOpen:e}),ve.jsx(Sy,{type:"datasets"}),ve.jsx(Tz,{isOpen:n,onDrawerClose:()=>e(!1),onDrawerSubmit:t}),ve.jsx(Cy,{pageTitle:"Model Evaluations",pageDescription:"Evaluates the accuracy of a predictive model using historical data. Compares actual outcomes with predicted values to assess model performance."}),ve.jsx(Sy,{type:"evaluations"})]})},Oj=()=>ve.jsx(Rj,{}),zj="_drawerWrapper_g5ang_1",Nj={drawerWrapper:zj},jj="_formWrapper_1wb8p_1",Bj="_newPredictionForm_1wb8p_8",Fj="_newPredictionTitle_1wb8p_12",Kg={formWrapper:jj,newPredictionForm:Bj,newPredictionTitle:Fj},Uj=({onDrawerClose:n,onDrawerSubmit:e})=>{const[t,c]=We.useState([]),[a,h]=We.useState([]),[d,s]=We.useState([]),[f,b]=We.useState(void 0),[x,v]=We.useState(""),[g,P]=We.useState(void 0);return We.useEffect(()=>{if(g==null)return;const _=g.covariates.map(S=>({feature:S.name,origin:"dataItem",dataSource:""}));c(_)},[g]),ve.jsx(ve.Fragment,{children:ve.jsxs("div",{className:Kg.newPredictionForm,children:[ve.jsxs("div",{className:Kg.newPredictionTitle,children:[ve.jsx("h2",{children:"New prediction"}),ve.jsx(en,{icon:ve.jsx(Py,{}),onClick:n})]}),ve.jsxs("div",{className:Kg.formWrapper,children:[ve.jsx(Nh,{autoComplete:"",label:"Name of prediction",value:x,onChange:_=>v(_.value),placeholder:jt.t("Prediction for Northern Province")}),ve.jsx(LT,{selectedModel:g,setSelectedModel:P}),ve.jsx(PT,{setDataLayers:c,datasetLayers:t,predictMode:!0}),ve.jsx(ww,{setTimePeriods:s}),ve.jsx(Tw,{orgUnits:a,setOrgUnits:h,orgUnitLevel:f,setOrgUnitLevel:b}),ve.jsx(AT,{onDrawerSubmit:e,selectedModel:g,name:x,dataLayers:t,onSendAction:"predict",orgUnitLevel:f,selectedPeriodItems:d,selectedOrgUnits:a})]})]})})},$j=({onDrawerClose:n,isOpen:e,onDrawerSubmit:t})=>{const c=window.innerWidth<900?"100vw":"1000px";return ve.jsx("div",{children:ve.jsx(Ex,{open:e,onClose:n,direction:"right",size:c,children:ve.jsx("div",{className:Nj.drawerWrapper,children:ve.jsx(Uj,{onDrawerClose:n,onDrawerSubmit:t})})})})},Gj=()=>{const[n,e]=We.useState(!1),[t,c]=We.useState(!1),a=()=>{c(!1),e(!1)};return We.useEffect(()=>{c(!0)},[t]),ve.jsxs("div",{children:[ve.jsx(Cy,{setDrawerOpen:e,pageTitle:"Predictions",pageDescription:"Forecasted disease trends generated by applying a predictive model to current data. These can be reviewed and imported into DHIS2 to support decision-making in the field.",setDrawerOpenText:"New prediction"}),ve.jsx($j,{isOpen:n,onDrawerClose:()=>e(!1),onDrawerSubmit:a}),t&&ve.jsx(Sy,{type:"predictions"})]})},Vj=n=>({request:{resource:`dataStore/modeling/${n}`}}),RT=n=>{var s;const{data:e,loading:t,error:c,fetching:a,engine:h,refetch:d}=mo(Vj(n));return{url:(s=e==null?void 0:e.request)==null?void 0:s.url,error:c,loading:t,fetching:a,refetch:d}},Hj=({setIsLoadingRouteConfig:n})=>{const{error:e,loading:t,url:c}=RT("backend-url"),a=zh();return We.useEffect(()=>{var h;t||((!c||((h=URL.parse(c))==null?void 0:h.origin)===a.baseUrl)&&(console.log("Adding credentials to OpenAPI"),Ri.WITH_CREDENTIALS=!0),c?(console.log("Setting OpenAPI url to:",c),Ri.BASE=c):Ri.BASE=a.baseUrl+"/api/routes/chap/run",n(!1))},[t,c,a.baseUrl,n]),t?ve.jsx(ve.Fragment,{children:"Loading..."}):ve.jsx(ve.Fragment,{})},Wj="_status_ok_1tnof_1",Yj="_status_not_ok_1tnof_5",qj="_errorContainer_1tnof_9",Xj="_container_1tnof_15",Zj="_settingsTable_1tnof_20",Kj="_tableWrapper_1tnof_27",Qj="_cellTable_1tnof_36",Jj="_cellTableLarge_1tnof_42",vo={status_ok:Wj,status_not_ok:Yj,errorContainer:qj,container:Xj,settingsTable:Zj,tableWrapper:Kj,cellTable:Qj,cellTableLarge:Jj},eB="_footer_18ayc_1",tB="_title_18ayc_7",Jv={footer:eB,title:tB},iB=(n,e,t)=>({resource:`dataStore/modeling/${e}`,type:t,id:"",data:n}),rB=(n,e,t)=>{const[c,{error:a,loading:h,called:d}]=Pf(iB(n,e,t));return{error:a,loading:h,called:d,mutate:c}},nB=({baseURL:n,existingUrl:e,setIsOpen:t})=>{const c=n.endsWith("/")?n.slice(0,-1):n,{called:a,error:h,loading:d,mutate:s}=rB({url:c},"backend-url",e==null?"create":"update"),f=async()=>{await s(),window.location.reload()};return We.useEffect(()=>{f()},[]),ve.jsx("p",{children:"Saving.."})},sB=({setOpen:n,existingUrl:e,loading:t,fetching:c})=>{const[a,h]=We.useState(""),s=zh().baseUrl+"/api/routes/chap/run",[f,b]=We.useState(!1),x=g=>{h(g)},v=()=>{b(!0)};return We.useEffect(()=>{e&&!t&&!c&&h(e)},[t,e,c]),ve.jsx(ve.Fragment,{children:ve.jsxs(ld,{children:[ve.jsx("div",{className:Jv.title,children:"Edit url to CHAP-Core backend server"}),ve.jsxs("p",{children:["Use this setting when you do not have CHAP installed as a backend server, but have a running instance of CHAP Core on the local machine. If not set, Modeling App use the default value: ",ve.jsx("i",{children:s})]}),ve.jsx(Nh,{disabled:c,value:a,onChange:g=>x(g.value),placeholder:c?"Loading..":""}),ve.jsxs("div",{className:Jv.footer,children:[ve.jsx(en,{onClick:()=>n(!1),children:"Close"}),ve.jsx(en,{icon:ve.jsx(Dy,{}),onClick:v,primary:!0,children:"Save"})]}),f&&ve.jsx(nB,{setIsOpen:n,baseURL:a,existingUrl:e})]})})},oB=()=>{const[n,e]=We.useState(void 0),[t,c]=We.useState(void 0),[a,h]=We.useState(!1),[d,s]=We.useState(!1),{route:f,loading:b,error:x}=bw(),{error:v,loading:g,url:P,fetching:_}=RT("backend-url"),[S,k]=We.useState(!1),A=()=>f!=null&&f.url?(f.url.endsWith("**")?f.url.slice(0,-2):f.url)+"docs":"",y=async()=>{c(""),e(void 0),k(!0),await vL.systemInfoSystemInfoGet().catch(X=>{c({body:X==null?void 0:X.body,status:X==null?void 0:X.status,statusText:X==null?void 0:X.statusText,r:X==null?void 0:X.request,message:X==null?void 0:X.message,name:X==null?void 0:X.name,url:X==null?void 0:X.url}),k(!1)}).then(X=>{e(X),k(!1)})};We.useEffect(()=>{y()},[]);const I=()=>{window.location.replace("#/route/create-route")},D=()=>ve.jsx(ve.Fragment,{children:ve.jsx("table",{children:ve.jsxs("tbody",{children:[ve.jsxs("tr",{children:[ve.jsx("td",{children:"name"}),ve.jsx("td",{children:f==null?void 0:f.name})]}),ve.jsxs("tr",{children:[ve.jsx("td",{children:"url"}),ve.jsx("td",{children:f==null?void 0:f.url})]}),ve.jsxs("tr",{children:[ve.jsx("td",{children:"id"}),ve.jsx("td",{children:f==null?void 0:f.id})]}),ve.jsxs("tr",{children:[ve.jsx("td",{children:"headers"}),ve.jsx("td",{children:JSON.stringify(f==null?void 0:f.headers)})]}),ve.jsxs("tr",{children:[ve.jsx("td",{children:"code"}),ve.jsx("td",{children:f==null?void 0:f.code})]})]})})}),[w,M]=We.useState(!1);We.useEffect(()=>{f&&z().then(X=>{M(X)})},[f]);const z=async()=>{if(!(f!=null&&f.url))return!1;try{return(await fetch(A(),{method:"HEAD"})).ok}catch(X){return console.error("Error pinging Chap URL:",X),!1}},Y=zh();return ve.jsxs("div",{className:vo.container,children:[ve.jsx("h2",{children:"Settings"}),f&&w&&ve.jsxs(Ay,{error:!0,title:"Chap Core is public",children:["Your chap server is publicly available. This allows anyone in the world to access your data from"," ",ve.jsx("a",{href:A(),children:A()})," without authentication. Ensure you have proper security measures in place to protect sensitive information."]}),ve.jsx("table",{className:vo.settingsTable,children:ve.jsxs("tbody",{children:[ve.jsxs("tr",{style:{display:"none"},children:[ve.jsx("td",{className:vo.cellTable,children:ve.jsxs("b",{children:[Y==null?void 0:Y.appName," is connecting to Chap Core via:"]})}),ve.jsx("td",{className:vo.cellTable,children:Ri==null?void 0:Ri.BASE}),ve.jsx("td",{className:vo.cellTable}),ve.jsx("td",{className:vo.cellTableLarge,children:ve.jsx(en,{small:!0,primary:!0,loading:g,onClick:()=>s(!0),children:"Edit Chap core URL ➔"})})]}),ve.jsxs("tr",{children:[ve.jsx("td",{className:vo.cellTable,children:ve.jsx("b",{children:"DHIS2 is connecting to Chap Core through:"})}),ve.jsxs("td",{className:vo.cellTable,children:[f==null?void 0:f.url," ",ve.jsx("br",{})]}),ve.jsxs("td",{className:vo.cellTableLarge,children:[ve.jsx(en,{small:!0,onClick:()=>h(!a),children:a?"Hide route details":"Show route details"}),a&&D()]}),ve.jsx("td",{className:vo.cellTable,children:ve.jsx(en,{small:!0,primary:!0,onClick:I,children:"Create/edit route ➔"})})]})]})}),ve.jsx("h3",{children:"System info:"}),S&&ve.jsx("p",{children:"Loading..."}),n&&ve.jsx("div",{className:vo.status_ok,children:n&&ve.jsx("pre",{children:JSON.stringify(n,null,2)})}),t&&ve.jsxs("div",{className:vo.errorContainer,children:[ve.jsxs("h3",{children:["Error:"," ",t&&"Unable to establish connection with Chap Core."]}),ve.jsx("p",{children:ve.jsx("pre",{children:JSON.stringify(t,null,2)})})]}),d&&ve.jsx(sB,{existingUrl:P,fetching:_,loading:g,setOpen:s})]})},aB=dP([{path:"route",errorElement:ve.jsx(pv,{}),children:[{path:"create-route",element:ve.jsx(zP,{})}]},{path:"",errorElement:ve.jsx(pv,{}),children:[{path:"/",element:ve.jsx(UA,{to:"/evaluate",replace:!0})},{path:"/evaluate",element:ve.jsx(Rg,{component:ve.jsx(Oj,{})})},{path:"/predict",element:ve.jsx(Rg,{component:ve.jsx(Gj,{})})},{path:"/settings",element:ve.jsx(Rg,{component:ve.jsx(oB,{})})}]}]),uB=()=>{const[n,e]=We.useState(!0);return ve.jsxs(ve.Fragment,{children:[ve.jsx(Hj,{setIsLoadingRouteConfig:e}),!n&&ve.jsx(EP,{router:aB})]})};export{uB as default};
